<!DOCTYPE html>
<html style="height:100%;">
<head>
    <title></title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="jquery-3.2.1.min.js"></script>
    <script src="three.js"></script>
    <script src="TweenMax.min.js"></script>
    <script src="objects.js?dd=1"></script>
    <script src="main.js"></script>
</head>
<body style="height:100%;">
    <div style="width:100%;height:10%;background-color:cornflowerblue;">
        <table>
            <tr>
                <td><button class="module-button" type="button" id="btn_wolf">狼</button></td>
                <td><button class="module-button" type="button" id="btn_rabbit">兔子</button></td>
                <td><button class="module-button" type="button" id="btn_dragon">龙</button></td>
                <td><button class="module-button" type="button" id="btn_lion">狮子</button></td>
                <td><button class="module-button" type="button" id="btn_cat">猫</button></td>
                <td><button class="module-button" type="button" id="btn_bird">鸟</button></td>
                <td><button class="module-button" type="button" id="btn_carrot">胡萝卜</button></td>
                <td><button class="module-button" type="button" id="btn_hedgehog">刺猬</button></td>
                <td><button class="module-button" type="button" id="btn_mouse">老鼠</button></td>
                <td><button class="module-button" type="button" id="btn_pac">PACMan</button></td>
                <td>Rate<input type="text" id="rateout" value="1" size="5" />/<input type="text" id="ratein" value="3" size="5" /></td>
                <td>Input<input type="text" id="input" size="5" /></td>
                <td>Outpu<input type="text" id="output" size="5" /></td>
            </tr>
            <tr>
                <td><button type="button" id="btn_turnrightY">延Y轴右转</button></td>
                <td><button type="button" id="btn_turnleftY">延Y轴左转</button></td>
                <td><button type="button" id="btn_turnupY">延Y轴上移</button></td>
                <td><button type="button" id="btn_turndownY">延Y轴下移</button></td>
                <td><select id="rolepart"></select></td>
                <td>X<input type="text" id="sizevalue_x" size="5" /></td>
                <td>Y<input type="text" id="sizevalue_y" size="5" /></td>
                <td>Z<input type="text" id="sizevalue_z" size="5" /></td>
            </tr>
        </table>
    </div>
    <div id="game_container" style="width:100%;height:100%;background-color:darkgray;">
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
            //var canvas = $('canvas');
            //var container = canvas.parent();
            //canvas.attr('width', container.width());
            //canvas.attr('height', container.height());
            $('.module-button').on('click', function (eventObj) {
                changeModule(eventObj);
            });

            $('#input').on('change', function (eventObj) {
                $('#output').val(parseFloat($('#input').val()) * parseFloat($('#rateout').val()) / parseFloat($('#ratein').val()));
            });

            $('#btn_turnleftY').on('click', function (eventObj) {
                roleModule.mesh.rotation.y -= 5 * Math.PI / 180;
            });

            $('#btn_turnrightY').on('click', function (eventObj) {
                roleModule.mesh.rotation.y += 5 * Math.PI / 180;
            });

            $('#btn_turnupY').on('click', function (eventObj) {
                roleModule.mesh.position.y += 5;
            });

            $('#btn_turndownY').on('click', function (eventObj) {
                roleModule.mesh.position.y -= 5;
            });

            $('#sizevalue_x').on('click', function (eventObj) {
                roleModule[$('#rolepart').val()].position.x = parseInt($('#sizevalue_x').val());
            });

            $('#sizevalue_y').on('click', function (eventObj) {
                roleModule[$('#rolepart').val()].position.y = parseInt($('#sizevalue_y').val());
            });

            $('#sizevalue_z').on('click', function (eventObj) {
                roleModule[$('#rolepart').val()].position.z = parseInt($('#sizevalue_z').val());
            });

            $('#rolepart').on('change', function (eventObj) {
                $('#sizevalue_x').val(roleModule[$('#rolepart').val()].position.x);
                $('#sizevalue_y').val(roleModule[$('#rolepart').val()].position.y);
                $('#sizevalue_z').val(roleModule[$('#rolepart').val()].position.z);
            });


            initGame();
        });

        var moduleType = 'mouse';
        var roleModule = null;
        function changeModule(eventObj) {
            moduleType = eventObj.target.id.split('_')[1];
            createRole();
        }

        function createRole() {
            if (roleModule) {
                scene.remove(roleModule.mesh);
            }

            var newRoleModule = null;
            switch (moduleType) {
                case 'cat':
                    newRoleModule = new Cat();
                    break;
                case 'lion':
                    newRoleModule = new Lion();
                    break;
                case 'dragon':
                    newRoleModule = new Dragon();
                    break;
                case 'bird':
                    newRoleModule = new Bird();
                    break;
                case 'mouse':
                    newRoleModule = new Mouse();
                    break;
                case 'rabbit':
                    newRoleModule = new Hero();
                    break;
                case 'wolf':
                    newRoleModule = new Monster();
                    break;
                case 'carrot':
                    newRoleModule = new Carrot();
                    break;
                case 'hedgehog':
                    newRoleModule = new Hedgehog();
                    break;
                case 'pac':
                    newRoleModule = new PacMan();
                    break;

            }

            scene.add(newRoleModule.mesh);
            roleModule = null;
            roleModule = newRoleModule;
            for (var key in roleModule) {
                if (roleModule[key].position && roleModule[key].rotation) {
                    $('#rolepart').append('<option>' + key + '</option>');
                }
            }
        }

        function initGame() {
            initScreenAnd3D();
            createLights();
            createRole();
            initUI();
            loop();
        }

        function loop() {
            roleModule.status = "pause";
            roleModule.mesh.visible = true;
            delta = clock.getDelta();
            render();
            requestAnimationFrame(loop);
        }
    </script>
</body>
</html>
