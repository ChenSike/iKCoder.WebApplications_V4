/*
 MIT License, http://www.opensource.org/licenses/MIT



 SoundManager 2: JavaScript Sound for the Web
 ----------------------------------------------
 http://schillmania.com/projects/soundmanager2/

 Copyright (c) 2007, Scott Schiller. All rights reserved.
 Code provided under the BSD License:
 http://schillmania.com/projects/soundmanager2/license.txt

 V2.97a.20150601
 Use it if you like it
*/
var JSON;JSON||(JSON={});
(function(){function b(b){return 10>b?"0"+b:b}function c(b){f.lastIndex=0;return f.test(b)?'"'+b.replace(f,function(b){var c=j[b];return"string"===typeof c?c:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function d(b,e){var f,j,p,s,r=g,o,t=e[b];t&&"object"===typeof t&&"function"===typeof t.toJSON&&(t=t.toJSON(b));"function"===typeof k&&(t=k.call(e,b,t));switch(typeof t){case "string":return c(t);case "number":return isFinite(t)?""+t:"null";case "boolean":case "null":return""+t;
case "object":if(!t)return"null";g+=h;o=[];if("[object Array]"===Object.prototype.toString.apply(t)){s=t.length;for(f=0;f<s;f+=1)o[f]=d(f,t)||"null";p=0===o.length?"[]":g?"[\n"+g+o.join(",\n"+g)+"\n"+r+"]":"["+o.join(",")+"]";g=r;return p}if(k&&"object"===typeof k){s=k.length;for(f=0;f<s;f+=1)"string"===typeof k[f]&&(j=k[f],(p=d(j,t))&&o.push(c(j)+(g?": ":":")+p))}else for(j in t)Object.prototype.hasOwnProperty.call(t,j)&&(p=d(j,t))&&o.push(c(j)+(g?": ":":")+p);p=0===o.length?"{}":g?"{\n"+g+o.join(",\n"+
g)+"\n"+r+"}":"{"+o.join(",")+"}";g=r;return p}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,h,j={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,c,e){var f;h=g="";if("number"===typeof e)for(f=0;f<e;f+=1)h+=" ";else"string"===typeof e&&(h=e);if((k=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return d("",
{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(b,c){function d(b,e){var f,j,g=b[e];if(g&&"object"===typeof g)for(f in g)Object.prototype.hasOwnProperty.call(g,f)&&(j=d(g,f),void 0!==j?g[f]=j:delete g[f]);return c.call(b,e,g)}var f,b=""+b;e.lastIndex=0;e.test(b)&&(b=b.replace(e,function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return f=eval("("+b+")"),"function"===typeof c?d({"":f},""):f;throw new SyntaxError("JSON.parse");})})();
!function(b,c){"object"==typeof module&&"object"==typeof module.exports?module.exports=b.document?c(b,!0):function(b){if(!b.document)throw Error("jQuery requires a window with a document");return c(b)}:c(b)}("undefined"!=typeof window?window:this,function(b,c){function d(b){var c=!!b&&"length"in b&&b.length,d=v.type(b);return"function"===d||v.isWindow(b)?!1:"array"===d||0===c||"number"==typeof c&&0<c&&c-1 in b}function e(b,c,d){if(v.isFunction(c))return v.grep(b,function(b,e){return!!c.call(b,e,b)!==
d});if(c.nodeType)return v.grep(b,function(b){return b===c!==d});if("string"==typeof c){if(xb.test(c))return v.filter(c,b,d);c=v.filter(c,b)}return v.grep(b,function(b){return-1<v.inArray(b,c)!==d})}function f(b,c){do b=b[c];while(b&&1!==b.nodeType);return b}function g(b){var c={};return v.each(b.match(Aa)||[],function(b,d){c[d]=!0}),c}function h(){V.addEventListener?(V.removeEventListener("DOMContentLoaded",j),b.removeEventListener("load",j)):(V.detachEvent("onreadystatechange",j),b.detachEvent("onload",
j))}function j(){(V.addEventListener||"load"===b.event.type||"complete"===V.readyState)&&(h(),v.ready())}function k(b,c,d){if(void 0===d&&1===b.nodeType){var e="data-"+c.replace(Ma,"-$1").toLowerCase();if(d=b.getAttribute(e),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:qb.test(d)?v.parseJSON(d):d}catch(f){}v.data(b,c,d)}else d=void 0}return d}function l(b){for(var c in b)if(("data"!==c||!v.isEmptyObject(b[c]))&&"toJSON"!==c)return!1;return!0}function m(b,c,d,
e){if(Ia(b)){var f,j,g=v.expando,k=b.nodeType,h=k?v.cache:b,l=k?b[g]:b[g]&&g;if(l&&h[l]&&(e||h[l].data)||void 0!==d||"string"!=typeof c)return l||(l=k?b[g]=pa.pop()||v.guid++:g),h[l]||(h[l]=k?{}:{toJSON:v.noop}),("object"==typeof c||"function"==typeof c)&&(e?h[l]=v.extend(h[l],c):h[l].data=v.extend(h[l].data,c)),j=h[l],e||(j.data||(j.data={}),j=j.data),void 0!==d&&(j[v.camelCase(c)]=d),"string"==typeof c?(f=j[c],null==f&&(f=j[v.camelCase(c)])):f=j,f}}function n(b,c,d){if(Ia(b)){var e,f,j=b.nodeType,
g=j?v.cache:b,k=j?b[v.expando]:v.expando;if(g[k]){if(c&&(e=d?g[k]:g[k].data)){v.isArray(c)?c=c.concat(v.map(c,v.camelCase)):c in e?c=[c]:(c=v.camelCase(c),c=c in e?[c]:c.split(" "));for(f=c.length;f--;)delete e[c[f]];if(d?!l(e):!v.isEmptyObject(e))return}(d||(delete g[k].data,l(g[k])))&&(j?v.cleanData([b],!0):R.deleteExpando||g!=g.window?delete g[k]:g[k]=void 0)}}}function q(b,c,d,e){var f,j=1,g=20,k=e?function(){return e.cur()}:function(){return v.css(b,c,"")},h=k(),l=d&&d[3]||(v.cssNumber[c]?"":
"px"),m=(v.cssNumber[c]||"px"!==l&&+h)&&gb.exec(v.css(b,c));if(m&&m[3]!==l){l=l||m[3];d=d||[];m=+h||1;do j=j||".5",m/=j,v.style(b,c,m+l);while(j!==(j=k()/h)&&1!==j&&--g)}return d&&(m=+m||+h||0,f=d[1]?m+(d[1]+1)*d[2]:+d[2],e&&(e.unit=l,e.start=m,e.end=f)),f}function p(b){var c=yb.split("|"),b=b.createDocumentFragment();if(b.createElement)for(;c.length;)b.createElement(c.pop());return b}function s(b,c){var d,e,f=0,j="undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(c||"*"):"undefined"!=
typeof b.querySelectorAll?b.querySelectorAll(c||"*"):void 0;if(!j){j=[];for(d=b.childNodes||b;null!=(e=d[f]);f++)!c||v.nodeName(e,c)?j.push(e):v.merge(j,s(e,c))}return void 0===c||c&&v.nodeName(b,c)?v.merge([b],j):j}function r(b,c){for(var d,e=0;null!=(d=b[e]);e++)v._data(d,"globalEval",!c||v._data(c[e],"globalEval"))}function o(b){ua.test(b.type)&&(b.defaultChecked=b.checked)}function t(b,c,d,e,f){for(var j,g,k,h,l,m,n,q=b.length,u=p(c),t=[],L=0;q>L;L++)if(g=b[L],g||0===g)if("object"===v.type(g))v.merge(t,
g.nodeType?[g]:g);else if(Fb.test(g)){h=h||u.appendChild(c.createElement("div"));l=(hb.exec(g)||["",""])[1].toLowerCase();n=na[l]||na._default;h.innerHTML=n[1]+v.htmlPrefilter(g)+n[2];for(j=n[0];j--;)h=h.lastChild;if(!R.leadingWhitespace&&Pa.test(g)&&t.push(c.createTextNode(Pa.exec(g)[0])),!R.tbody)for(j=(g="table"!==l||Ja.test(g)?"<table>"!==n[1]||Ja.test(g)?0:h:h.firstChild)&&g.childNodes.length;j--;)v.nodeName(m=g.childNodes[j],"tbody")&&!m.childNodes.length&&g.removeChild(m);v.merge(t,h.childNodes);
for(h.textContent="";h.firstChild;)h.removeChild(h.firstChild);h=u.lastChild}else t.push(c.createTextNode(g));h&&u.removeChild(h);R.appendChecked||v.grep(s(t,"input"),o);for(L=0;g=t[L++];)if(e&&-1<v.inArray(g,e))f&&f.push(g);else if(k=v.contains(g.ownerDocument,g),h=s(u.appendChild(g),"script"),k&&r(h),d)for(j=0;g=h[j++];)Ka.test(g.type||"")&&d.push(g);return u}function u(){return!0}function w(){return!1}function z(){try{return V.activeElement}catch(b){}}function A(b,c,d,e,f,j){var g,k;if("object"==
typeof c){"string"!=typeof d&&(e=e||d,d=void 0);for(k in c)A(b,k,d,e,c[k],j);return b}if(null==e&&null==f?(f=d,e=d=void 0):null==f&&("string"==typeof d?(f=e,e=void 0):(f=e,e=d,d=void 0)),!1===f)f=w;else if(!f)return b;return 1===j&&(g=f,f=function(b){return v().off(b),g.apply(this,arguments)},f.guid=g.guid||(g.guid=v.guid++)),b.each(function(){v.event.add(this,c,f,e,d)})}function C(b,c){return v.nodeName(b,"table")&&v.nodeName(11!==c.nodeType?c:c.firstChild,"tr")?b.getElementsByTagName("tbody")[0]||
b.appendChild(b.ownerDocument.createElement("tbody")):b}function G(b){return b.type=(null!==v.find.attr(b,"type"))+"/"+b.type,b}function H(b){var c=$b.exec(b.type);return c?b.type=c[1]:b.removeAttribute("type"),b}function K(b,c){if(1===c.nodeType&&v.hasData(b)){var d,e,f;e=v._data(b);var j=v._data(c,e),g=e.events;if(g)for(d in delete j.handle,j.events={},g){e=0;for(f=g[d].length;f>e;e++)v.event.add(c,d,g[d][e])}j.data&&(j.data=v.extend({},j.data))}}function P(b,c,d,e){var c=ta.apply([],c),f,j,g,k,
h=0,l=b.length,m=l-1,n=c[0],o=v.isFunction(n);if(o||1<l&&"string"==typeof n&&!R.checkClone&&Mb.test(n))return b.each(function(f){var j=b.eq(f);o&&(c[0]=n.call(this,f,j.html()));P(j,c,d,e)});if(l&&(k=t(c,b[0].ownerDocument,!1,b,e),f=k.firstChild,1===k.childNodes.length&&(k=f),f||e)){g=v.map(s(k,"script"),G);for(j=g.length;l>h;h++)f=k,h!==m&&(f=v.clone(f,!0,!0),j&&v.merge(g,s(f,"script"))),d.call(b[h],f,h);if(j){k=g[g.length-1].ownerDocument;v.map(g,H);for(h=0;j>h;h++)f=g[h],Ka.test(f.type||"")&&!v._data(f,
"globalEval")&&v.contains(k,f)&&(f.src?v._evalUrl&&v._evalUrl(f.src):v.globalEval((f.text||f.textContent||f.innerHTML||"").replace(ac,"")))}k=f=null}return b}function T(b,c,d){for(var e=c?v.filter(c,b):b,f=0;null!=(c=e[f]);f++)d||1!==c.nodeType||v.cleanData(s(c)),c.parentNode&&(d&&v.contains(c.ownerDocument,c)&&r(s(c,"script")),c.parentNode.removeChild(c));return b}function D(b,c){var d=v(c.createElement(b)).appendTo(c.body),e=v.css(d[0],"display");return d.detach(),e}function F(b){var c=V,d=bc[b];
return d||(d=D(b,c),"none"!==d&&d||(Ya=(Ya||v("<iframe frameborder='0' width='0' height='0'/>")).appendTo(c.documentElement),c=(Ya[0].contentWindow||Ya[0].contentDocument).document,c.write(),c.close(),d=D(b,c),Ya.detach()),bc[b]=d),d}function I(b,c){return{get:function(){return b()?void delete this.get:(this.get=c).apply(this,arguments)}}}function J(b){if(b in ib)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=vc.length;d--;)if(b=vc[d]+c,b in ib)return b}function N(b,c){for(var d,e,f,j=
[],g=0,k=b.length;k>g;g++)e=b[g],e.style&&(j[g]=v._data(e,"olddisplay"),d=e.style.display,c?(j[g]||"none"!==d||(e.style.display=""),""===e.style.display&&qa(e)&&(j[g]=v._data(e,"olddisplay",F(e.nodeName)))):(f=qa(e),(d&&"none"!==d||!f)&&v._data(e,"olddisplay",f?d:v.css(e,"display"))));for(g=0;k>g;g++)e=b[g],e.style&&(c&&"none"!==e.style.display&&""!==e.style.display||(e.style.display=c?j[g]||"":"none"));return b}function U(b,c,d){return(b=rb.exec(c))?Math.max(0,b[1]-(d||0))+(b[2]||"px"):c}function Q(b,
c,d,e,f){for(var c=d===(e?"border":"content")?4:"width"===c?1:0,j=0;4>c;c+=2)"margin"===d&&(j+=v.css(b,d+Qa[c],!0,f)),e?("content"===d&&(j-=v.css(b,"padding"+Qa[c],!0,f)),"margin"!==d&&(j-=v.css(b,"border"+Qa[c]+"Width",!0,f))):(j+=v.css(b,"padding"+Qa[c],!0,f),"padding"!==d&&(j+=v.css(b,"border"+Qa[c]+"Width",!0,f)));return j}function B(c,d,e){var f=!0,j="width"===d?c.offsetWidth:c.offsetHeight,g=jb(c),k=R.boxSizing&&"border-box"===v.css(c,"boxSizing",!1,g);if(V.msFullscreenElement&&b.top!==b&&c.getClientRects().length&&
(j=Math.round(100*c.getBoundingClientRect()[d])),0>=j||null==j){if(j=sb(c,d,g),(0>j||null==j)&&(j=c.style[d]),Za.test(j))return j;f=k&&(R.boxSizingReliable()||j===c.style[d]);j=parseFloat(j)||0}return j+Q(c,d,e||(k?"border":"content"),f,g)+"px"}function E(b,c,d,e,f){return new E.prototype.init(b,c,d,e,f)}function Z(){return b.setTimeout(function(){$a=void 0}),$a=v.now()}function O(b,c){for(var d,e={height:b},f=0,c=c?1:0;4>f;f+=2-c)d=Qa[f],e["margin"+d]=e["padding"+d]=b;return c&&(e.opacity=e.width=
b),e}function M(b,c,d){for(var e,f=(aa.tweeners[c]||[]).concat(aa.tweeners["*"]),j=0,g=f.length;g>j;j++)if(e=f[j].call(d,c,b))return e}function X(b,c){var d,e,f,j,g;for(d in b)if(e=v.camelCase(d),f=c[e],j=b[d],v.isArray(j)&&(f=j[1],j=b[d]=j[0]),d!==e&&(b[e]=j,delete b[d]),g=v.cssHooks[e],g&&"expand"in g)for(d in j=g.expand(j),delete b[e],j)d in b||(b[d]=j[d],c[d]=f);else c[e]=f}function aa(b,c,d){var e,f=0,j=aa.prefilters.length,g=v.Deferred().always(function(){delete k.elem}),k=function(){if(e)return!1;
for(var c=$a||Z(),c=Math.max(0,h.startTime+h.duration-c),d=1-(c/h.duration||0),f=0,j=h.tweens.length;j>f;f++)h.tweens[f].run(d);return g.notifyWith(b,[h,d,c]),1>d&&j?c:(g.resolveWith(b,[h]),!1)},h=g.promise({elem:b,props:v.extend({},c),opts:v.extend(!0,{specialEasing:{},easing:v.easing._default},d),originalProperties:c,originalOptions:d,startTime:$a||Z(),duration:d.duration,tweens:[],createTween:function(c,d){var e=v.Tween(b,h.opts,c,d,h.opts.specialEasing[c]||h.opts.easing);return h.tweens.push(e),
e},stop:function(c){var d=0,f=c?h.tweens.length:0;if(e)return this;for(e=!0;f>d;d++)h.tweens[d].run(1);return c?(g.notifyWith(b,[h,1,0]),g.resolveWith(b,[h,c])):g.rejectWith(b,[h,c]),this}}),d=h.props;for(X(d,h.opts.specialEasing);j>f;f++)if(c=aa.prefilters[f].call(h,b,d,h.opts))return v.isFunction(c.stop)&&(v._queueHooks(h.elem,h.opts.queue).stop=v.proxy(c.stop,c)),c;return v.map(d,M,h),v.isFunction(h.opts.start)&&h.opts.start.call(b,h),v.fx.timer(v.extend(k,{elem:b,anim:h,queue:h.opts.queue})),
h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function Y(b){return v.attr(b,"class")||""}function ba(b){return function(c,d){"string"!=typeof c&&(d=c,c="*");var e,f=0,j=c.toLowerCase().match(Aa)||[];if(v.isFunction(d))for(;e=j[f++];)"+"===e.charAt(0)?(e=e.slice(1)||"*",(b[e]=b[e]||[]).unshift(d)):(b[e]=b[e]||[]).push(d)}}function da(b,c,d,e){function f(k){var h;return j[k]=!0,v.each(b[k]||[],function(b,k){var l=k(c,d,e);return"string"!=typeof l||
g||j[l]?g?!(h=l):void 0:(c.dataTypes.unshift(l),f(l),!1)}),h}var j={},g=b===wc;return f(c.dataTypes[0])||!j["*"]&&f("*")}function ra(b,c){var d,e,f=v.ajaxSettings.flatOptions||{};for(e in c)void 0!==c[e]&&((f[e]?b:d||(d={}))[e]=c[e]);return d&&v.extend(!0,b,d),b}function x(b,c,d,e){var f;if(v.isArray(c))v.each(c,function(c,f){d||gd.test(b)?e(b,f):x(b+"["+("object"==typeof f&&null!=f?c:"")+"]",f,d,e)});else if(d||"object"!==v.type(c))e(b,c);else for(f in c)x(b+"["+f+"]",c[f],d,e)}function ja(){try{return new b.XMLHttpRequest}catch(c){}}
function ka(){try{return new b.ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}function oa(b){return v.isWindow(b)?b:9===b.nodeType?b.defaultView||b.parentWindow:!1}var pa=[],V=b.document,va=pa.slice,ta=pa.concat,sa=pa.push,Da=pa.indexOf,L={},W=L.toString,fa=L.hasOwnProperty,R={},v=function(b,c){return new v.fn.init(b,c)},Na=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,tb=/^-ms-/,kb=/-([\da-z])/gi,ea=function(b,c){return c.toUpperCase()};v.fn=v.prototype={jquery:"1.12.1",constructor:v,selector:"",length:0,
toArray:function(){return va.call(this)},get:function(b){return null!=b?0>b?this[b+this.length]:this[b]:va.call(this)},pushStack:function(b){b=v.merge(this.constructor(),b);return b.prevObject=this,b.context=this.context,b},each:function(b){return v.each(this,b)},map:function(b){return this.pushStack(v.map(this,function(c,d){return b.call(c,d,c)}))},slice:function(){return this.pushStack(va.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(b){var c=
this.length,b=+b+(0>b?c:0);return this.pushStack(0<=b&&c>b?[this[b]]:[])},end:function(){return this.prevObject||this.constructor()},push:sa,sort:pa.sort,splice:pa.splice};v.extend=v.fn.extend=function(){var b,c,d,e,f,j,g=arguments[0]||{},k=1,h=arguments.length,l=!1;"boolean"==typeof g&&(l=g,g=arguments[k]||{},k++);"object"==typeof g||v.isFunction(g)||(g={});for(k===h&&(g=this,k--);h>k;k++)if(null!=(f=arguments[k]))for(e in f)b=g[e],d=f[e],g!==d&&(l&&d&&(v.isPlainObject(d)||(c=v.isArray(d)))?(c?(c=
!1,j=b&&v.isArray(b)?b:[]):j=b&&v.isPlainObject(b)?b:{},g[e]=v.extend(l,j,d)):void 0!==d&&(g[e]=d));return g};v.extend({expando:"jQuery"+("1.12.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(b){throw Error(b);},noop:function(){},isFunction:function(b){return"function"===v.type(b)},isArray:Array.isArray||function(b){return"array"===v.type(b)},isWindow:function(b){return null!=b&&b==b.window},isNumeric:function(b){var c=b&&b.toString();return!v.isArray(b)&&0<=c-parseFloat(c)+1},isEmptyObject:function(b){for(var c in b)return!1;
return!0},isPlainObject:function(b){var c;if(!b||"object"!==v.type(b)||b.nodeType||v.isWindow(b))return!1;try{if(b.constructor&&!fa.call(b,"constructor")&&!fa.call(b.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}if(!R.ownFirst)for(c in b)return fa.call(b,c);for(c in b);return void 0===c||fa.call(b,c)},type:function(b){return null==b?b+"":"object"==typeof b||"function"==typeof b?L[W.call(b)]||"object":typeof b},globalEval:function(c){c&&v.trim(c)&&(b.execScript||function(c){b.eval.call(b,
c)})(c)},camelCase:function(b){return b.replace(tb,"ms-").replace(kb,ea)},nodeName:function(b,c){return b.nodeName&&b.nodeName.toLowerCase()===c.toLowerCase()},each:function(b,c){var e,f=0;if(d(b))for(e=b.length;e>f&&!1!==c.call(b[f],f,b[f]);f++);else for(f in b)if(!1===c.call(b[f],f,b[f]))break;return b},trim:function(b){return null==b?"":(b+"").replace(Na,"")},makeArray:function(b,c){var e=c||[];return null!=b&&(d(Object(b))?v.merge(e,"string"==typeof b?[b]:b):sa.call(e,b)),e},inArray:function(b,
c,d){var e;if(c){if(Da)return Da.call(c,b,d);e=c.length;for(d=d?0>d?Math.max(0,e+d):d:0;e>d;d++)if(d in c&&c[d]===b)return d}return-1},merge:function(b,c){for(var d=+c.length,e=0,f=b.length;d>e;)b[f++]=c[e++];if(d!==d)for(;void 0!==c[e];)b[f++]=c[e++];return b.length=f,b},grep:function(b,c,d){for(var e=[],f=0,j=b.length,g=!d;j>f;f++)d=!c(b[f],f),d!==g&&e.push(b[f]);return e},map:function(b,c,e){var f,j,g=0,k=[];if(d(b))for(f=b.length;f>g;g++)j=c(b[g],g,e),null!=j&&k.push(j);else for(g in b)j=c(b[g],
g,e),null!=j&&k.push(j);return ta.apply([],k)},guid:1,proxy:function(b,c){var d,e,f;return"string"==typeof c&&(f=b[c],c=b,b=f),v.isFunction(b)?(d=va.call(arguments,2),e=function(){return b.apply(c||this,d.concat(va.call(arguments)))},e.guid=b.guid=b.guid||v.guid++,e):void 0},now:function(){return+new Date},support:R});"function"==typeof Symbol&&(v.fn[Symbol.iterator]=pa[Symbol.iterator]);v.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(b,c){L["[object "+
c+"]"]=c.toLowerCase()});var ma=function(b){function c(b,d,e,f){var j,g,k,h,l,n=d&&d.ownerDocument,s=d?d.nodeType:9;if(e=e||[],"string"!=typeof b||!b||1!==s&&9!==s&&11!==s)return e;if(!f&&((d?d.ownerDocument||d:aa)!==W&&F(d),d=d||W,X)){if(11!==s&&(h=va.exec(b)))if(j=h[1])if(9===s){if(!(g=d.getElementById(j)))return e;if(g.id===j)return e.push(g),e}else{if(n&&(g=n.getElementById(j))&&la(d,g)&&g.id===j)return e.push(g),e}else{if(h[2])return ba.apply(e,d.getElementsByTagName(b)),e;if((j=h[3])&&w.getElementsByClassName&&
d.getElementsByClassName)return ba.apply(e,d.getElementsByClassName(j)),e}if(w.qsa&&!U[b+" "]&&(!J||!J.test(b))){if(1!==s)n=d,l=b;else if("object"!==d.nodeName.toLowerCase()){(k=d.getAttribute("id"))?k=k.replace(ma,"\\$&"):d.setAttribute("id",k=H);h=z(b);j=h.length;for(g=V.test(k)?"#"+k:"[id='"+k+"']";j--;)h[j]=g+" "+o(h[j]);l=h.join(",");n=Na.test(b)&&m(d.parentNode)||d}if(l)try{return ba.apply(e,n.querySelectorAll(l)),e}catch(q){}finally{k===H&&d.removeAttribute("id")}}}return O(b.replace(ta,"$1"),
d,e,f)}function d(){function b(d,e){return c.push(d+" ")>A.cacheLength&&delete b[c.shift()],b[d+" "]=e}var c=[];return b}function e(b){return b[H]=!0,b}function f(b){var c=W.createElement("div");try{return!!b(c)}catch(d){return!1}finally{c.parentNode&&c.parentNode.removeChild(c)}}function j(b,c){for(var d=b.split("|"),e=d.length;e--;)A.attrHandle[d[e]]=c}function g(b,c){var d=c&&b,e=d&&1===b.nodeType&&1===c.nodeType&&(~c.sourceIndex||K)-(~b.sourceIndex||K);if(e)return e;if(d)for(;d=d.nextSibling;)if(d===
c)return-1;return b?1:-1}function k(b){return function(c){return"input"===c.nodeName.toLowerCase()&&c.type===b}}function h(b){return function(c){var d=c.nodeName.toLowerCase();return("input"===d||"button"===d)&&c.type===b}}function l(b){return e(function(c){return c=+c,e(function(d,e){for(var f,j=b([],d.length,c),g=j.length;g--;)d[f=j[g]]&&(d[f]=!(e[f]=d[f]))})})}function m(b){return b&&"undefined"!=typeof b.getElementsByTagName&&b}function n(){}function o(b){for(var c=0,d=b.length,e="";d>c;c++)e+=
b[c].value;return e}function s(b,c,d){var e=c.dir,f=d&&"parentNode"===e,j=Q++;return c.first?function(c,d,j){for(;c=c[e];)if(1===c.nodeType||f)return b(c,d,j)}:function(c,d,g){var k,h,l,m=[N,j];if(g)for(;c=c[e];){if((1===c.nodeType||f)&&b(c,d,g))return!0}else for(;c=c[e];)if(1===c.nodeType||f){if(l=c[H]||(c[H]={}),h=l[c.uniqueID]||(l[c.uniqueID]={}),(k=h[e])&&k[0]===N&&k[1]===j)return m[2]=k[2];if(h[e]=m,m[2]=b(c,d,g))return!0}}}function q(b){return 1<b.length?function(c,d,e){for(var f=b.length;f--;)if(!b[f](c,
d,e))return!1;return!0}:b[0]}function u(b,c,d,e,f){for(var j,g=[],k=0,h=b.length,l=null!=c;h>k;k++)(j=b[k])&&(!d||d(j,e,f))&&(g.push(j),l&&c.push(k));return g}function p(b,d,f,j,g,k){return j&&!j[H]&&(j=p(j)),g&&!g[H]&&(g=p(g,k)),e(function(e,k,h,l){var m,n,o=[],s=[],q=k.length,p;if(!(p=e)){p=d||"*";for(var t=h.nodeType?[h]:h,r=[],L=0,w=t.length;w>L;L++)c(p,t[L],r);p=r}p=!b||!e&&d?p:u(p,o,b,h,l);t=f?g||(e?b:q||j)?[]:k:p;if(f&&f(p,t,h,l),j){m=u(t,s);j(m,[],h,l);for(h=m.length;h--;)(n=m[h])&&(t[s[h]]=
!(p[s[h]]=n))}if(e){if(g||b){if(g){m=[];for(h=t.length;h--;)(n=t[h])&&m.push(p[h]=n);g(null,t=[],m,l)}for(h=t.length;h--;)(n=t[h])&&-1<(m=g?R(e,n):o[h])&&(e[m]=!(k[m]=n))}}else t=u(t===k?t.splice(q,t.length):t),g?g(null,k,t,l):ba.apply(k,t)})}function t(b){var c,d,e,f=b.length,j=A.relative[b[0].type];d=j||A.relative[" "];for(var g=j?1:0,k=s(function(b){return b===c},d,!0),h=s(function(b){return-1<R(c,b)},d,!0),l=[function(b,d,e){b=!j&&(e||d!==C)||((c=d).nodeType?k(b,d,e):h(b,d,e));return c=null,b}];f>
g;g++)if(d=A.relative[b[g].type])l=[s(q(l),d)];else{if(d=A.filter[b[g].type].apply(null,b[g].matches),d[H]){for(e=++g;f>e&&!A.relative[b[e].type];e++);return p(1<g&&q(l),1<g&&o(b.slice(0,g-1).concat({value:" "===b[g-2].type?"*":""})).replace(ta,"$1"),d,e>g&&t(b.slice(g,e)),f>e&&t(b=b.slice(e)),f>e&&o(b))}l.push(d)}return q(l)}function r(b,d){var f=0<d.length,j=0<b.length,g=function(e,g,k,h,l){var m,n,o,s=0,q="0",p=e&&[],t=[],r=C,L=e||j&&A.find.TAG("*",l),w=N+=null==r?1:Math.random()||0.1,D=L.length;
for(l&&(C=g===W||g||l);q!==D&&null!=(m=L[q]);q++){if(j&&m){n=0;for(g||m.ownerDocument===W||(F(m),k=!X);o=b[n++];)if(o(m,g||W,k)){h.push(m);break}l&&(N=w)}f&&((m=!o&&m)&&s--,e&&p.push(m))}if(s+=q,f&&q!==s){for(n=0;o=d[n++];)o(p,t,g,k);if(e){if(0<s)for(;q--;)p[q]||t[q]||(t[q]=Ub.call(h));t=u(t)}ba.apply(h,t);l&&!e&&0<t.length&&1<s+d.length&&c.uniqueSort(h)}return l&&(N=w,C=r),p};return f?e(g):g}var L,w,A,D,B,z,v,O,C,x,E,F,W,M,X,J,I,G,la,H="sizzle"+1*new Date,aa=b.document,N=0,Q=0,Z=d(),fa=d(),U=d(),
da=function(b,c){return b===c&&(E=!0),0},K=-2147483648,Y={}.hasOwnProperty,P=[],Ub=P.pop,ra=P.push,ba=P.push,ja=P.slice,R=function(b,c){for(var d=0,e=b.length;e>d;d++)if(b[d]===c)return d;return-1},T=RegExp("[\\x20\\t\\r\\n\\f]+","g"),ta=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),ka=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Da=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,Vb=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*?)[\\x20\\t\\r\\n\\f]*\\]","g"),sa=RegExp(":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
V=/^(?:\\.|[\w-]|[^\x00-\xa0])+$/,pa={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:/^((?:\\.|[\w-]|[^\x00-\xa0])+|[*])/,ATTR:RegExp("^\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\]"),PSEUDO:RegExp("^:((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)",
"i")},Db=/^(?:input|select|textarea|button)$/i,oa=/^h\d$/i,rb=/^[^{]+\{\s*\[native \w/,va=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Na=/[+~]/,ma=/'|\\/g,La=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),ea=function(b,c,d){b="0x"+c-65536;return b!==b||d?c:0>b?String.fromCharCode(b+65536):String.fromCharCode(b>>10|55296,1023&b|56320)},Wa=function(){F()};try{ba.apply(P=ja.call(aa.childNodes),aa.childNodes),P[aa.childNodes.length].nodeType}catch(Fa){ba={apply:P.length?function(b,
c){ra.apply(b,ja.call(c))}:function(b,c){for(var d=b.length,e=0;b[d++]=c[e++];);b.length=d-1}}}w=c.support={};B=c.isXML=function(b){return(b=b&&(b.ownerDocument||b).documentElement)?"HTML"!==b.nodeName:!1};F=c.setDocument=function(b){var c,d,b=b?b.ownerDocument||b:aa;return b!==W&&9===b.nodeType&&b.documentElement?(W=b,M=W.documentElement,X=!B(W),(d=W.defaultView)&&d.top!==d&&(d.addEventListener?d.addEventListener("unload",Wa,!1):d.attachEvent&&d.attachEvent("onunload",Wa)),w.attributes=f(function(b){return b.className=
"i",!b.getAttribute("className")}),w.getElementsByTagName=f(function(b){return b.appendChild(W.createComment("")),!b.getElementsByTagName("*").length}),w.getElementsByClassName=rb.test(W.getElementsByClassName),w.getById=f(function(b){return M.appendChild(b).id=H,!W.getElementsByName||!W.getElementsByName(H).length}),w.getById?(A.find.ID=function(b,c){if("undefined"!=typeof c.getElementById&&X){var d=c.getElementById(b);return d?[d]:[]}},A.filter.ID=function(b){var c=b.replace(La,ea);return function(b){return b.getAttribute("id")===
c}}):(delete A.find.ID,A.filter.ID=function(b){var c=b.replace(La,ea);return function(b){return(b="undefined"!=typeof b.getAttributeNode&&b.getAttributeNode("id"))&&b.value===c}}),A.find.TAG=w.getElementsByTagName?function(b,c){return"undefined"!=typeof c.getElementsByTagName?c.getElementsByTagName(b):w.qsa?c.querySelectorAll(b):void 0}:function(b,c){var d,e=[],f=0,j=c.getElementsByTagName(b);if("*"===b){for(;d=j[f++];)1===d.nodeType&&e.push(d);return e}return j},A.find.CLASS=w.getElementsByClassName&&
function(b,c){return"undefined"!=typeof c.getElementsByClassName&&X?c.getElementsByClassName(b):void 0},I=[],J=[],(w.qsa=rb.test(W.querySelectorAll))&&(f(function(b){M.appendChild(b).innerHTML="<a id='"+H+"'></a><select id='"+H+"-\r\\' msallowcapture=''><option selected=''></option></select>";b.querySelectorAll("[msallowcapture^='']").length&&J.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");b.querySelectorAll("[selected]").length||J.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");
b.querySelectorAll("[id~="+H+"-]").length||J.push("~=");b.querySelectorAll(":checked").length||J.push(":checked");b.querySelectorAll("a#"+H+"+*").length||J.push(".#.+[+~]")}),f(function(b){var c=W.createElement("input");c.setAttribute("type","hidden");b.appendChild(c).setAttribute("name","D");b.querySelectorAll("[name=d]").length&&J.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");b.querySelectorAll(":enabled").length||J.push(":enabled",":disabled");b.querySelectorAll("*,:x");J.push(",.*:")})),(w.matchesSelector=
rb.test(G=M.matches||M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&f(function(b){w.disconnectedMatch=G.call(b,"div");G.call(b,"[s!='']:x");I.push("!=",":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)")}),
J=J.length&&RegExp(J.join("|")),I=I.length&&RegExp(I.join("|")),c=rb.test(M.compareDocumentPosition),la=c||rb.test(M.contains)?function(b,c){var d=9===b.nodeType?b.documentElement:b,e=c&&c.parentNode;return b===e||!(!e||1!==e.nodeType||!(d.contains?d.contains(e):b.compareDocumentPosition&&16&b.compareDocumentPosition(e)))}:function(b,c){if(c)for(;c=c.parentNode;)if(c===b)return!0;return!1},da=c?function(b,c){if(b===c)return E=!0,0;var d=!b.compareDocumentPosition-!c.compareDocumentPosition;return d?
d:(d=(b.ownerDocument||b)===(c.ownerDocument||c)?b.compareDocumentPosition(c):1,1&d||!w.sortDetached&&c.compareDocumentPosition(b)===d?b===W||b.ownerDocument===aa&&la(aa,b)?-1:c===W||c.ownerDocument===aa&&la(aa,c)?1:x?R(x,b)-R(x,c):0:4&d?-1:1)}:function(b,c){if(b===c)return E=!0,0;var d,e=0;d=b.parentNode;var f=c.parentNode,j=[b],k=[c];if(!d||!f)return b===W?-1:c===W?1:d?-1:f?1:x?R(x,b)-R(x,c):0;if(d===f)return g(b,c);for(d=b;d=d.parentNode;)j.unshift(d);for(d=c;d=d.parentNode;)k.unshift(d);for(;j[e]===
k[e];)e++;return e?g(j[e],k[e]):j[e]===aa?-1:k[e]===aa?1:0},W):W};c.matches=function(b,d){return c(b,null,null,d)};c.matchesSelector=function(b,d){if((b.ownerDocument||b)!==W&&F(b),d=d.replace(Vb,"='$1']"),w.matchesSelector&&X&&!U[d+" "]&&(!I||!I.test(d))&&(!J||!J.test(d)))try{var e=G.call(b,d);if(e||w.disconnectedMatch||b.document&&11!==b.document.nodeType)return e}catch(f){}return 0<c(d,W,null,[b]).length};c.contains=function(b,c){return(b.ownerDocument||b)!==W&&F(b),la(b,c)};c.attr=function(b,
c){(b.ownerDocument||b)!==W&&F(b);var d=A.attrHandle[c.toLowerCase()],d=d&&Y.call(A.attrHandle,c.toLowerCase())?d(b,c,!X):void 0;return void 0!==d?d:w.attributes||!X?b.getAttribute(c):(d=b.getAttributeNode(c))&&d.specified?d.value:null};c.error=function(b){throw Error("Syntax error, unrecognized expression: "+b);};c.uniqueSort=function(b){var c,d=[],e=0,f=0;if(E=!w.detectDuplicates,x=!w.sortStable&&b.slice(0),b.sort(da),E){for(;c=b[f++];)c===b[f]&&(e=d.push(f));for(;e--;)b.splice(d[e],1)}return x=
null,b};D=c.getText=function(b){var c,d="",e=0;if(c=b.nodeType)if(1===c||9===c||11===c){if("string"==typeof b.textContent)return b.textContent;for(b=b.firstChild;b;b=b.nextSibling)d+=D(b)}else{if(3===c||4===c)return b.nodeValue}else for(;c=b[e++];)d+=D(c);return d};A=c.selectors={cacheLength:50,createPseudo:e,match:pa,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(b){return b[1]=
b[1].replace(La,ea),b[3]=(b[3]||b[4]||b[5]||"").replace(La,ea),"~="===b[2]&&(b[3]=" "+b[3]+" "),b.slice(0,4)},CHILD:function(b){return b[1]=b[1].toLowerCase(),"nth"===b[1].slice(0,3)?(b[3]||c.error(b[0]),b[4]=+(b[4]?b[5]+(b[6]||1):2*("even"===b[3]||"odd"===b[3])),b[5]=+(b[7]+b[8]||"odd"===b[3])):b[3]&&c.error(b[0]),b},PSEUDO:function(b){var c,d=!b[6]&&b[2];return pa.CHILD.test(b[0])?null:(b[3]?b[2]=b[4]||b[5]||"":d&&sa.test(d)&&(c=z(d,!0))&&(c=d.indexOf(")",d.length-c)-d.length)&&(b[0]=b[0].slice(0,
c),b[2]=d.slice(0,c)),b.slice(0,3))}},filter:{TAG:function(b){var c=b.replace(La,ea).toLowerCase();return"*"===b?function(){return!0}:function(b){return b.nodeName&&b.nodeName.toLowerCase()===c}},CLASS:function(b){var c=Z[b+" "];return c||(c=RegExp("(^|[\\x20\\t\\r\\n\\f])"+b+"([\\x20\\t\\r\\n\\f]|$)"))&&Z(b,function(b){return c.test("string"==typeof b.className&&b.className||"undefined"!=typeof b.getAttribute&&b.getAttribute("class")||"")})},ATTR:function(b,d,e){return function(f){f=c.attr(f,b);
return null==f?"!="===d:d?(f+="","="===d?f===e:"!="===d?f!==e:"^="===d?e&&0===f.indexOf(e):"*="===d?e&&-1<f.indexOf(e):"$="===d?e&&f.slice(-e.length)===e:"~="===d?-1<(" "+f.replace(T," ")+" ").indexOf(e):"|="===d?f===e||f.slice(0,e.length+1)===e+"-":!1):!0}},CHILD:function(b,c,d,e,f){var j="nth"!==b.slice(0,3),g="last"!==b.slice(-4),k="of-type"===c;return 1===e&&0===f?function(b){return!!b.parentNode}:function(c,d,h){var l,m,n,o,s,q,d=j!==g?"nextSibling":"previousSibling",u=c.parentNode,p=k&&c.nodeName.toLowerCase(),
h=!h&&!k,t=!1;if(u){if(j){for(;d;){for(o=c;o=o[d];)if(k?o.nodeName.toLowerCase()===p:1===o.nodeType)return!1;q=d="only"===b&&!q&&"nextSibling"}return!0}if(q=[g?u.firstChild:u.lastChild],g&&h){o=u;n=o[H]||(o[H]={});m=n[o.uniqueID]||(n[o.uniqueID]={});l=m[b]||[];t=(s=l[0]===N&&l[1])&&l[2];for(o=s&&u.childNodes[s];o=++s&&o&&o[d]||(t=s=0)||q.pop();)if(1===o.nodeType&&++t&&o===c){m[b]=[N,s,t];break}}else if(h&&(o=c,n=o[H]||(o[H]={}),m=n[o.uniqueID]||(n[o.uniqueID]={}),l=m[b]||[],s=l[0]===N&&l[1],t=s),
!1===t)for(;(o=++s&&o&&o[d]||(t=s=0)||q.pop())&&(!(k?o.nodeName.toLowerCase()===p:1===o.nodeType)||!++t||!(h&&(n=o[H]||(o[H]={}),m=n[o.uniqueID]||(n[o.uniqueID]={}),m[b]=[N,t]),o===c)););return t-=f,t===e||0===t%e&&0<=t/e}}},PSEUDO:function(b,d){var f,j=A.pseudos[b]||A.setFilters[b.toLowerCase()]||c.error("unsupported pseudo: "+b);return j[H]?j(d):1<j.length?(f=[b,b,"",d],A.setFilters.hasOwnProperty(b.toLowerCase())?e(function(b,c){for(var e,f=j(b,d),g=f.length;g--;)e=R(b,f[g]),b[e]=!(c[e]=f[g])}):
function(b){return j(b,0,f)}):j}},pseudos:{not:e(function(b){var c=[],d=[],f=v(b.replace(ta,"$1"));return f[H]?e(function(b,c,d,e){for(var j,d=f(b,null,e,[]),e=b.length;e--;)(j=d[e])&&(b[e]=!(c[e]=j))}):function(b,e,j){return c[0]=b,f(c,null,j,d),c[0]=null,!d.pop()}}),has:e(function(b){return function(d){return 0<c(b,d).length}}),contains:e(function(b){return b=b.replace(La,ea),function(c){return-1<(c.textContent||c.innerText||D(c)).indexOf(b)}}),lang:e(function(b){return V.test(b||"")||c.error("unsupported lang: "+
b),b=b.replace(La,ea).toLowerCase(),function(c){var d;do if(d=X?c.lang:c.getAttribute("xml:lang")||c.getAttribute("lang"))return d=d.toLowerCase(),d===b||0===d.indexOf(b+"-");while((c=c.parentNode)&&1===c.nodeType);return!1}}),target:function(c){var d=b.location&&b.location.hash;return d&&d.slice(1)===c.id},root:function(b){return b===M},focus:function(b){return b===W.activeElement&&(!W.hasFocus||W.hasFocus())&&!(!b.type&&!b.href&&!~b.tabIndex)},enabled:function(b){return!1===b.disabled},disabled:function(b){return!0===
b.disabled},checked:function(b){var c=b.nodeName.toLowerCase();return"input"===c&&!!b.checked||"option"===c&&!!b.selected},selected:function(b){return b.parentNode&&b.parentNode.selectedIndex,!0===b.selected},empty:function(b){for(b=b.firstChild;b;b=b.nextSibling)if(6>b.nodeType)return!1;return!0},parent:function(b){return!A.pseudos.empty(b)},header:function(b){return oa.test(b.nodeName)},input:function(b){return Db.test(b.nodeName)},button:function(b){var c=b.nodeName.toLowerCase();return"input"===
c&&"button"===b.type||"button"===c},text:function(b){var c;return"input"===b.nodeName.toLowerCase()&&"text"===b.type&&(null==(c=b.getAttribute("type"))||"text"===c.toLowerCase())},first:l(function(){return[0]}),last:l(function(b,c){return[c-1]}),eq:l(function(b,c,d){return[0>d?d+c:d]}),even:l(function(b,c){for(var d=0;c>d;d+=2)b.push(d);return b}),odd:l(function(b,c){for(var d=1;c>d;d+=2)b.push(d);return b}),lt:l(function(b,c,d){for(c=0>d?d+c:d;0<=--c;)b.push(c);return b}),gt:l(function(b,c,d){for(d=
0>d?d+c:d;++d<c;)b.push(d);return b})}};A.pseudos.nth=A.pseudos.eq;for(L in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})A.pseudos[L]=k(L);for(L in{submit:!0,reset:!0})A.pseudos[L]=h(L);n.prototype=A.filters=A.pseudos;A.setFilters=new n;z=c.tokenize=function(b,d){var e,f,j,g,k,h,l;if(k=fa[b+" "])return d?0:k.slice(0);k=b;h=[];for(l=A.preFilter;k;){(!e||(f=ka.exec(k)))&&(f&&(k=k.slice(f[0].length)||k),h.push(j=[]));e=!1;(f=Da.exec(k))&&(e=f.shift(),j.push({value:e,type:f[0].replace(ta," ")}),
k=k.slice(e.length));for(g in A.filter)!(f=pa[g].exec(k))||l[g]&&!(f=l[g](f))||(e=f.shift(),j.push({value:e,type:g,matches:f}),k=k.slice(e.length));if(!e)break}return d?k.length:k?c.error(b):fa(b,h).slice(0)};return v=c.compile=function(b,c){var d,e=[],f=[],j=U[b+" "];if(!j){c||(c=z(b));for(d=c.length;d--;)j=t(c[d]),j[H]?e.push(j):f.push(j);j=U(b,r(f,e));j.selector=b}return j},O=c.select=function(b,c,d,e){var f,j,g,k,h,l="function"==typeof b&&b,n=!e&&z(b=l.selector||b);if(d=d||[],1===n.length){if(j=
n[0]=n[0].slice(0),2<j.length&&"ID"===(g=j[0]).type&&w.getById&&9===c.nodeType&&X&&A.relative[j[1].type]){if(c=(A.find.ID(g.matches[0].replace(La,ea),c)||[])[0],!c)return d;l&&(c=c.parentNode);b=b.slice(j.shift().value.length)}for(f=pa.needsContext.test(b)?0:j.length;f--&&!(g=j[f],A.relative[k=g.type]);)if((h=A.find[k])&&(e=h(g.matches[0].replace(La,ea),Na.test(j[0].type)&&m(c.parentNode)||c))){if(j.splice(f,1),b=e.length&&o(j),!b)return ba.apply(d,e),d;break}}return(l||v(b,n))(e,c,!X,d,!c||Na.test(b)&&
m(c.parentNode)||c),d},w.sortStable=H.split("").sort(da).join("")===H,w.detectDuplicates=!!E,F(),w.sortDetached=f(function(b){return 1&b.compareDocumentPosition(W.createElement("div"))}),f(function(b){return b.innerHTML="<a href='#'></a>","#"===b.firstChild.getAttribute("href")})||j("type|href|height|width",function(b,c,d){return d?void 0:b.getAttribute(c,"type"===c.toLowerCase()?1:2)}),w.attributes&&f(function(b){return b.innerHTML="<input/>",b.firstChild.setAttribute("value",""),""===b.firstChild.getAttribute("value")})||
j("value",function(b,c,d){return d||"input"!==b.nodeName.toLowerCase()?void 0:b.defaultValue}),f(function(b){return null==b.getAttribute("disabled")})||j("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(b,c,d){var e;return d?void 0:!0===b[c]?c.toLowerCase():(e=b.getAttributeNode(c))&&e.specified?e.value:null}),c}(b);v.find=ma;v.expr=ma.selectors;v.expr[":"]=v.expr.pseudos;v.uniqueSort=v.unique=ma.uniqueSort;v.text=
ma.getText;v.isXMLDoc=ma.isXML;v.contains=ma.contains;var Ca=function(b,c,d){for(var e=[],f=void 0!==d;(b=b[c])&&9!==b.nodeType;)if(1===b.nodeType){if(f&&v(b).is(d))break;e.push(b)}return e},ub=function(b,c){for(var d=[];b;b=b.nextSibling)1===b.nodeType&&b!==c&&d.push(b);return d},Va=v.expr.match.needsContext,nb=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,xb=/^.[^:#\[\.,]*$/;v.filter=function(b,c,d){var e=c[0];return d&&(b=":not("+b+")"),1===c.length&&1===e.nodeType?v.find.matchesSelector(e,b)?[e]:[]:v.find.matches(b,
v.grep(c,function(b){return 1===b.nodeType}))};v.fn.extend({find:function(b){var c,d=[],e=this,f=e.length;if("string"!=typeof b)return this.pushStack(v(b).filter(function(){for(c=0;f>c;c++)if(v.contains(e[c],this))return!0}));for(c=0;f>c;c++)v.find(b,e[c],d);return d=this.pushStack(1<f?v.unique(d):d),d.selector=this.selector?this.selector+" "+b:b,d},filter:function(b){return this.pushStack(e(this,b||[],!1))},not:function(b){return this.pushStack(e(this,b||[],!0))},is:function(b){return!!e(this,"string"==
typeof b&&Va.test(b)?v(b):b||[],!1).length}});var Fa,Sa=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(v.fn.init=function(b,c,d){var e,f;if(!b)return this;if(d=d||Fa,"string"==typeof b){if(e="<"===b.charAt(0)&&">"===b.charAt(b.length-1)&&3<=b.length?[null,b,null]:Sa.exec(b),!e||!e[1]&&c)return!c||c.jquery?(c||d).find(b):this.constructor(c).find(b);if(e[1]){if(c=c instanceof v?c[0]:c,v.merge(this,v.parseHTML(e[1],c&&c.nodeType?c.ownerDocument||c:V,!0)),nb.test(e[1])&&v.isPlainObject(c))for(e in c)v.isFunction(this[e])?
this[e](c[e]):this.attr(e,c[e]);return this}if(f=V.getElementById(e[2]),f&&f.parentNode){if(f.id!==e[2])return Fa.find(b);this.length=1;this[0]=f}return this.context=V,this.selector=b,this}return b.nodeType?(this.context=this[0]=b,this.length=1,this):v.isFunction(b)?"undefined"!=typeof d.ready?d.ready(b):b(v):(void 0!==b.selector&&(this.selector=b.selector,this.context=b.context),v.makeArray(b,this))}).prototype=v.fn;Fa=v(V);var bb=/^(?:parents|prev(?:Until|All))/,Ta={children:!0,contents:!0,next:!0,
prev:!0};v.fn.extend({has:function(b){var c,d=v(b,this),e=d.length;return this.filter(function(){for(c=0;e>c;c++)if(v.contains(this,d[c]))return!0})},closest:function(b,c){for(var d,e=0,f=this.length,j=[],g=Va.test(b)||"string"!=typeof b?v(b,c||this.context):0;f>e;e++)for(d=this[e];d&&d!==c;d=d.parentNode)if(11>d.nodeType&&(g?-1<g.index(d):1===d.nodeType&&v.find.matchesSelector(d,b))){j.push(d);break}return this.pushStack(1<j.length?v.uniqueSort(j):j)},index:function(b){return b?"string"==typeof b?
v.inArray(this[0],v(b)):v.inArray(b.jquery?b[0]:b,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(b,c){return this.pushStack(v.uniqueSort(v.merge(this.get(),v(b,c))))},addBack:function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))}});v.each({parent:function(b){return(b=b.parentNode)&&11!==b.nodeType?b:null},parents:function(b){return Ca(b,"parentNode")},parentsUntil:function(b,c,d){return Ca(b,"parentNode",d)},next:function(b){return f(b,"nextSibling")},
prev:function(b){return f(b,"previousSibling")},nextAll:function(b){return Ca(b,"nextSibling")},prevAll:function(b){return Ca(b,"previousSibling")},nextUntil:function(b,c,d){return Ca(b,"nextSibling",d)},prevUntil:function(b,c,d){return Ca(b,"previousSibling",d)},siblings:function(b){return ub((b.parentNode||{}).firstChild,b)},children:function(b){return ub(b.firstChild)},contents:function(b){return v.nodeName(b,"iframe")?b.contentDocument||b.contentWindow.document:v.merge([],b.childNodes)}},function(b,
c){v.fn[b]=function(d,e){var f=v.map(this,c,d);return"Until"!==b.slice(-5)&&(e=d),e&&"string"==typeof e&&(f=v.filter(e,f)),1<this.length&&(Ta[b]||(f=v.uniqueSort(f)),bb.test(b)&&(f=f.reverse())),this.pushStack(f)}});var Aa=/\S+/g;v.Callbacks=function(b){var b="string"==typeof b?g(b):v.extend({},b),c,d,e,f,j=[],k=[],h=-1,l=function(){f=b.once;for(e=c=!0;k.length;h=-1)for(d=k.shift();++h<j.length;)!1===j[h].apply(d[0],d[1])&&b.stopOnFalse&&(h=j.length,d=!1);b.memory||(d=!1);c=!1;f&&(j=d?[]:"")},m={add:function(){return j&&
(d&&!c&&(h=j.length-1,k.push(d)),function jc(c){v.each(c,function(c,d){v.isFunction(d)?b.unique&&m.has(d)||j.push(d):d&&d.length&&"string"!==v.type(d)&&jc(d)})}(arguments),d&&!c&&l()),this},remove:function(){return v.each(arguments,function(b,c){for(var d;-1<(d=v.inArray(c,j,d));)j.splice(d,1),h>=d&&h--}),this},has:function(b){return b?-1<v.inArray(b,j):0<j.length},empty:function(){return j&&(j=[]),this},disable:function(){return f=k=[],j=d="",this},disabled:function(){return!j},lock:function(){return f=
!0,d||m.disable(),this},locked:function(){return!!f},fireWith:function(b,d){return f||(d=d||[],d=[b,d.slice?d.slice():d],k.push(d),c||l()),this},fire:function(){return m.fireWith(this,arguments),this},fired:function(){return!!e}};return m};v.extend({Deferred:function(b){var c=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],d="pending",e={state:function(){return d},always:function(){return f.done(arguments).fail(arguments),
this},then:function(){var b=arguments;return v.Deferred(function(d){v.each(c,function(c,j){var g=v.isFunction(b[c])&&b[c];f[j[1]](function(){var b=g&&g.apply(this,arguments);b&&v.isFunction(b.promise)?b.promise().progress(d.notify).done(d.resolve).fail(d.reject):d[j[0]+"With"](this===e?d.promise():this,g?[b]:arguments)})});b=null}).promise()},promise:function(b){return null!=b?v.extend(b,e):e}},f={};return e.pipe=e.then,v.each(c,function(b,j){var g=j[2],k=j[3];e[j[1]]=g.add;k&&g.add(function(){d=
k},c[1^b][2].disable,c[2][2].lock);f[j[0]]=function(){return f[j[0]+"With"](this===f?e:this,arguments),this};f[j[0]+"With"]=g.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(b){var c=0,d=va.call(arguments),e=d.length,f=1!==e||b&&v.isFunction(b.promise)?e:0,j=1===f?b:v.Deferred(),g=function(b,c,d){return function(e){c[b]=this;d[b]=1<arguments.length?va.call(arguments):e;d===k?j.notifyWith(c,d):--f||j.resolveWith(c,d)}},k,h,l;if(1<e){k=Array(e);h=Array(e);for(l=Array(e);e>c;c++)d[c]&&v.isFunction(d[c].promise)?
d[c].promise().progress(g(c,h,k)).done(g(c,l,d)).fail(j.reject):--f}return f||j.resolveWith(l,d),j.promise()}});var xa;v.fn.ready=function(b){return v.ready.promise().done(b),this};v.extend({isReady:!1,readyWait:1,holdReady:function(b){b?v.readyWait++:v.ready(!0)},ready:function(b){(!0===b?--v.readyWait:v.isReady)||(v.isReady=!0,!0!==b&&0<--v.readyWait||(xa.resolveWith(V,[v]),v.fn.triggerHandler&&(v(V).triggerHandler("ready"),v(V).off("ready"))))}});v.ready.promise=function(c){if(!xa)if(xa=v.Deferred(),
"complete"===V.readyState||"loading"!==V.readyState&&!V.documentElement.doScroll)b.setTimeout(v.ready);else if(V.addEventListener)V.addEventListener("DOMContentLoaded",j),b.addEventListener("load",j);else{V.attachEvent("onreadystatechange",j);b.attachEvent("onload",j);var d=!1;try{d=null==b.frameElement&&V.documentElement}catch(e){}d&&d.doScroll&&function Lb(){if(!v.isReady){try{d.doScroll("left")}catch(c){return b.setTimeout(Lb,50)}h();v.ready()}}()}return xa.promise(c)};v.ready.promise();for(var Hb in v(R))break;
R.ownFirst="0"===Hb;R.inlineBlockNeedsLayout=!1;v(function(){var b,c,d,e;(d=V.getElementsByTagName("body")[0])&&d.style&&(c=V.createElement("div"),e=V.createElement("div"),e.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",d.appendChild(e).appendChild(c),"undefined"!=typeof c.style.zoom&&(c.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",R.inlineBlockNeedsLayout=b=3===c.offsetWidth,b&&(d.style.zoom=1)),d.removeChild(e))});(function(){var b=
V.createElement("div");R.deleteExpando=!0;try{delete b.test}catch(c){R.deleteExpando=!1}})();var Ia=function(b){var c=v.noData[(b.nodeName+" ").toLowerCase()],d=+b.nodeType||1;return 1!==d&&9!==d?!1:!c||!0!==c&&b.getAttribute("classid")===c},qb=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ma=/([A-Z])/g;v.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(b){return b=b.nodeType?v.cache[b[v.expando]]:b[v.expando],!!b&&!l(b)},data:function(b,
c,d){return m(b,c,d)},removeData:function(b,c){return n(b,c)},_data:function(b,c,d){return m(b,c,d,!0)},_removeData:function(b,c){return n(b,c,!0)}});v.fn.extend({data:function(b,c){var d,e,f,j=this[0],g=j&&j.attributes;if(void 0===b){if(this.length&&(f=v.data(j),1===j.nodeType&&!v._data(j,"parsedAttrs"))){for(d=g.length;d--;)g[d]&&(e=g[d].name,0===e.indexOf("data-")&&(e=v.camelCase(e.slice(5)),k(j,e,f[e])));v._data(j,"parsedAttrs",!0)}return f}return"object"==typeof b?this.each(function(){v.data(this,
b)}):1<arguments.length?this.each(function(){v.data(this,b,c)}):j?k(j,b,v.data(j,b)):void 0},removeData:function(b){return this.each(function(){v.removeData(this,b)})}});v.extend({queue:function(b,c,d){var e;return b?(c=(c||"fx")+"queue",e=v._data(b,c),d&&(!e||v.isArray(d)?e=v._data(b,c,v.makeArray(d)):e.push(d)),e||[]):void 0},dequeue:function(b,c){var c=c||"fx",d=v.queue(b,c),e=d.length,f=d.shift(),j=v._queueHooks(b,c),g=function(){v.dequeue(b,c)};"inprogress"===f&&(f=d.shift(),e--);f&&("fx"===
c&&d.unshift("inprogress"),delete j.stop,f.call(b,g,j));!e&&j&&j.empty.fire()},_queueHooks:function(b,c){var d=c+"queueHooks";return v._data(b,d)||v._data(b,d,{empty:v.Callbacks("once memory").add(function(){v._removeData(b,c+"queue");v._removeData(b,d)})})}});v.fn.extend({queue:function(b,c){var d=2;return"string"!=typeof b&&(c=b,b="fx",d--),arguments.length<d?v.queue(this[0],b):void 0===c?this:this.each(function(){var d=v.queue(this,b,c);v._queueHooks(this,b);"fx"===b&&"inprogress"!==d[0]&&v.dequeue(this,
b)})},dequeue:function(b){return this.each(function(){v.dequeue(this,b)})},clearQueue:function(b){return this.queue(b||"fx",[])},promise:function(b,c){var d,e=1,f=v.Deferred(),j=this,g=this.length,k=function(){--e||f.resolveWith(j,[j])};"string"!=typeof b&&(c=b,b=void 0);for(b=b||"fx";g--;)(d=v._data(j[g],b+"queueHooks"))&&d.empty&&(e++,d.empty.add(k));return k(),f.promise(c)}});(function(){var b;R.shrinkWrapBlocks=function(){if(null!=b)return b;b=!1;var c,d,e;return d=V.getElementsByTagName("body")[0],
d&&d.style?(c=V.createElement("div"),e=V.createElement("div"),e.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",d.appendChild(e).appendChild(c),"undefined"!=typeof c.style.zoom&&(c.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",c.appendChild(V.createElement("div")).style.width="5px",b=3!==c.offsetWidth),d.removeChild(e),b):void 0}})();var cb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
gb=RegExp("^(?:([+-])=|)("+cb+")([a-z%]*)$","i"),Qa=["Top","Right","Bottom","Left"],qa=function(b,c){return b=c||b,"none"===v.css(b,"display")||!v.contains(b.ownerDocument,b)},za=function(b,c,d,e,f,j,g){var k=0,h=b.length,l=null==d;if("object"===v.type(d))for(k in f=!0,d)za(b,c,k,d[k],!0,j,g);else if(void 0!==e&&(f=!0,v.isFunction(e)||(g=!0),l&&(g?(c.call(b,e),c=null):(l=c,c=function(b,c,d){return l.call(v(b),d)})),c))for(;h>k;k++)c(b[k],d,g?e:e.call(b[k],k,c(b[k],d)));return f?b:l?c.call(b):h?c(b[0],
d):j},ua=/^(?:checkbox|radio)$/i,hb=/<([\w:-]+)/,Ka=/^$|\/(?:java|ecma)script/i,Pa=/^\s+/,yb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";!function(){var b=V.createElement("div"),c=V.createDocumentFragment(),d=V.createElement("input");b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";R.leadingWhitespace=3===b.firstChild.nodeType;
R.tbody=!b.getElementsByTagName("tbody").length;R.htmlSerialize=!!b.getElementsByTagName("link").length;R.html5Clone="<:nav></:nav>"!==V.createElement("nav").cloneNode(!0).outerHTML;d.type="checkbox";d.checked=!0;c.appendChild(d);R.appendChecked=d.checked;b.innerHTML="<textarea>x</textarea>";R.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue;c.appendChild(b);d=V.createElement("input");d.setAttribute("type","radio");d.setAttribute("checked","checked");d.setAttribute("name","t");b.appendChild(d);
R.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked;R.noCloneEvent=!!b.addEventListener;b[v.expando]=1;R.attributes=!b.getAttribute(v.expando)}();var na={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],
_default:R.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};na.optgroup=na.option;na.tbody=na.tfoot=na.colgroup=na.caption=na.thead;na.th=na.td;var Fb=/<|&#?\w+;/,Ja=/<tbody/i;!function(){var c,d,e=V.createElement("div");for(c in{submit:!0,change:!0,focusin:!0})d="on"+c,(R[c]=d in b)||(e.setAttribute(d,"t"),R[c]=!1===e.attributes[d].expando)}();var db=/^(?:input|select|textarea)$/i,Ib=/^key/,Ab=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,vb=/^(?:focusinfocus|focusoutblur)$/,ob=/^([^.]*)(?:\.(.+)|)/;
v.event={global:{},add:function(b,c,d,e,f){var j,g,k,h,l,m,n,o,s,q;if(k=v._data(b)){d.handler&&(h=d,d=h.handler,f=h.selector);d.guid||(d.guid=v.guid++);(g=k.events)||(g=k.events={});(m=k.handle)||(m=k.handle=function(b){return"undefined"==typeof v||b&&v.event.triggered===b.type?void 0:v.event.dispatch.apply(m.elem,arguments)},m.elem=b);c=(c||"").match(Aa)||[""];for(k=c.length;k--;)j=ob.exec(c[k])||[],s=q=j[1],j=(j[2]||"").split(".").sort(),s&&(l=v.event.special[s]||{},s=(f?l.delegateType:l.bindType)||
s,l=v.event.special[s]||{},n=v.extend({type:s,origType:q,data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&v.expr.match.needsContext.test(f),namespace:j.join(".")},h),(o=g[s])||(o=g[s]=[],o.delegateCount=0,l.setup&&!1!==l.setup.call(b,e,j,m)||(b.addEventListener?b.addEventListener(s,m,!1):b.attachEvent&&b.attachEvent("on"+s,m))),l.add&&(l.add.call(b,n),n.handler.guid||(n.handler.guid=d.guid)),f?o.splice(o.delegateCount++,0,n):o.push(n),v.event.global[s]=!0);b=null}},remove:function(b,c,d,e,
f){var j,g,k,h,l,m,n,o,s,q,u,t=v.hasData(b)&&v._data(b);if(t&&(m=t.events)){c=(c||"").match(Aa)||[""];for(l=c.length;l--;)if(k=ob.exec(c[l])||[],s=u=k[1],q=(k[2]||"").split(".").sort(),s){n=v.event.special[s]||{};s=(e?n.delegateType:n.bindType)||s;o=m[s]||[];k=k[2]&&RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)");for(h=j=o.length;j--;)g=o[j],!f&&u!==g.origType||d&&d.guid!==g.guid||k&&!k.test(g.namespace)||e&&e!==g.selector&&("**"!==e||!g.selector)||(o.splice(j,1),g.selector&&o.delegateCount--,
n.remove&&n.remove.call(b,g));h&&!o.length&&(n.teardown&&!1!==n.teardown.call(b,q,t.handle)||v.removeEvent(b,s,t.handle),delete m[s])}else for(s in m)v.event.remove(b,s+c[l],d,e,!0);v.isEmptyObject(m)&&(delete t.handle,v._removeData(b,"events"))}},trigger:function(c,d,e,f){var j,g,k,h,l,m,n=[e||V],o=fa.call(c,"type")?c.type:c;m=fa.call(c,"namespace")?c.namespace.split("."):[];if(k=j=e=e||V,3!==e.nodeType&&8!==e.nodeType&&!vb.test(o+v.event.triggered)&&(-1<o.indexOf(".")&&(m=o.split("."),o=m.shift(),
m.sort()),g=0>o.indexOf(":")&&"on"+o,c=c[v.expando]?c:new v.Event(o,"object"==typeof c&&c),c.isTrigger=f?2:3,c.namespace=m.join("."),c.rnamespace=c.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=void 0,c.target||(c.target=e),d=null==d?[c]:v.makeArray(d,[c]),l=v.event.special[o]||{},f||!l.trigger||!1!==l.trigger.apply(e,d))){if(!f&&!l.noBubble&&!v.isWindow(e)){h=l.delegateType||o;for(vb.test(h+o)||(k=k.parentNode);k;k=k.parentNode)n.push(k),j=k;j===(e.ownerDocument||V)&&
n.push(j.defaultView||j.parentWindow||b)}for(m=0;(k=n[m++])&&!c.isPropagationStopped();)c.type=1<m?h:l.bindType||o,(j=(v._data(k,"events")||{})[c.type]&&v._data(k,"handle"))&&j.apply(k,d),(j=g&&k[g])&&j.apply&&Ia(k)&&(c.result=j.apply(k,d),!1===c.result&&c.preventDefault());if(c.type=o,!f&&!c.isDefaultPrevented()&&(!l._default||!1===l._default.apply(n.pop(),d))&&Ia(e)&&g&&e[o]&&!v.isWindow(e)){(j=e[g])&&(e[g]=null);v.event.triggered=o;try{e[o]()}catch(s){}v.event.triggered=void 0;j&&(e[g]=j)}return c.result}},
dispatch:function(b){var b=v.event.fix(b),c,d,e,f,j,g=[],k=va.call(arguments);c=(v._data(this,"events")||{})[b.type]||[];var h=v.event.special[b.type]||{};if(k[0]=b,b.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,b)){g=v.event.handlers.call(this,b,c);for(c=0;(f=g[c++])&&!b.isPropagationStopped();){b.currentTarget=f.elem;for(d=0;(j=f.handlers[d++])&&!b.isImmediatePropagationStopped();)(!b.rnamespace||b.rnamespace.test(j.namespace))&&(b.handleObj=j,b.data=j.data,e=((v.event.special[j.origType]||
{}).handle||j.handler).apply(f.elem,k),void 0!==e&&!1===(b.result=e)&&(b.preventDefault(),b.stopPropagation()))}return h.postDispatch&&h.postDispatch.call(this,b),b.result}},handlers:function(b,c){var d,e,f,j,g=[],k=c.delegateCount,h=b.target;if(k&&h.nodeType&&("click"!==b.type||isNaN(b.button)||1>b.button))for(;h!=this;h=h.parentNode||this)if(1===h.nodeType&&(!0!==h.disabled||"click"!==b.type)){e=[];for(d=0;k>d;d++)j=c[d],f=j.selector+" ",void 0===e[f]&&(e[f]=j.needsContext?-1<v(f,this).index(h):
v.find(f,this,null,[h]).length),e[f]&&e.push(j);e.length&&g.push({elem:h,handlers:e})}return k<c.length&&g.push({elem:this,handlers:c.slice(k)}),g},fix:function(b){if(b[v.expando])return b;var c,d,e;c=b.type;var f=b,j=this.fixHooks[c];j||(this.fixHooks[c]=j=Ab.test(c)?this.mouseHooks:Ib.test(c)?this.keyHooks:{});e=j.props?this.props.concat(j.props):this.props;b=new v.Event(f);for(c=e.length;c--;)d=e[c],b[d]=f[d];return b.target||(b.target=f.srcElement||V),3===b.target.nodeType&&(b.target=b.target.parentNode),
b.metaKey=!!b.metaKey,j.filter?j.filter(b,f):b},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(b,c){return null==b.which&&(b.which=null!=c.charCode?c.charCode:c.keyCode),b}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(b,c){var d,
e,f,j=c.button,g=c.fromElement;return null==b.pageX&&null!=c.clientX&&(e=b.target.ownerDocument||V,f=e.documentElement,d=e.body,b.pageX=c.clientX+(f&&f.scrollLeft||d&&d.scrollLeft||0)-(f&&f.clientLeft||d&&d.clientLeft||0),b.pageY=c.clientY+(f&&f.scrollTop||d&&d.scrollTop||0)-(f&&f.clientTop||d&&d.clientTop||0)),!b.relatedTarget&&g&&(b.relatedTarget=g===b.target?c.toElement:g),b.which||void 0===j||(b.which=1&j?1:2&j?3:4&j?2:0),b}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==z()&&
this.focus)try{return this.focus(),!1}catch(b){}},delegateType:"focusin"},blur:{trigger:function(){return this===z()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return v.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(b){return v.nodeName(b.target,"a")}},beforeunload:{postDispatch:function(b){void 0!==b.result&&b.originalEvent&&(b.originalEvent.returnValue=b.result)}}},simulate:function(b,c,d){b=v.extend(new v.Event,
d,{type:b,isSimulated:!0});v.event.trigger(b,null,c);b.isDefaultPrevented()&&d.preventDefault()}};v.removeEvent=V.removeEventListener?function(b,c,d){b.removeEventListener&&b.removeEventListener(c,d)}:function(b,c,d){c="on"+c;b.detachEvent&&("undefined"==typeof b[c]&&(b[c]=null),b.detachEvent(c,d))};v.Event=function(b,c){return this instanceof v.Event?(b&&b.type?(this.originalEvent=b,this.type=b.type,this.isDefaultPrevented=b.defaultPrevented||void 0===b.defaultPrevented&&!1===b.returnValue?u:w):
this.type=b,c&&v.extend(this,c),this.timeStamp=b&&b.timeStamp||v.now(),void(this[v.expando]=!0)):new v.Event(b,c)};v.Event.prototype={constructor:v.Event,isDefaultPrevented:w,isPropagationStopped:w,isImmediatePropagationStopped:w,preventDefault:function(){var b=this.originalEvent;this.isDefaultPrevented=u;b&&(b.preventDefault?b.preventDefault():b.returnValue=!1)},stopPropagation:function(){var b=this.originalEvent;this.isPropagationStopped=u;b&&!this.isSimulated&&(b.stopPropagation&&b.stopPropagation(),
b.cancelBubble=!0)},stopImmediatePropagation:function(){var b=this.originalEvent;this.isImmediatePropagationStopped=u;b&&b.stopImmediatePropagation&&b.stopImmediatePropagation();this.stopPropagation()}};v.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(b,c){v.event.special[b]={delegateType:c,bindType:c,handle:function(b){var d,e=b.relatedTarget,f=b.handleObj;return(!e||e!==this&&!v.contains(this,e))&&(b.type=f.origType,d=f.handler.apply(this,
arguments),b.type=c),d}}});R.submit||(v.event.special.submit={setup:function(){return v.nodeName(this,"form")?!1:void v.event.add(this,"click._submit keypress._submit",function(b){b=b.target;(b=v.nodeName(b,"input")||v.nodeName(b,"button")?v.prop(b,"form"):void 0)&&!v._data(b,"submit")&&(v.event.add(b,"submit._submit",function(b){b._submitBubble=true}),v._data(b,"submit",true))})},postDispatch:function(b){b._submitBubble&&(delete b._submitBubble,this.parentNode&&!b.isTrigger&&v.event.simulate("submit",
this.parentNode,b))},teardown:function(){return v.nodeName(this,"form")?!1:void v.event.remove(this,"._submit")}});R.change||(v.event.special.change={setup:function(){return db.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(v.event.add(this,"propertychange._change",function(b){"checked"===b.originalEvent.propertyName&&(this._justChanged=!0)}),v.event.add(this,"click._change",function(b){this._justChanged&&!b.isTrigger&&(this._justChanged=!1);v.event.simulate("change",this,b)})),
!1):void v.event.add(this,"beforeactivate._change",function(b){b=b.target;db.test(b.nodeName)&&!v._data(b,"change")&&(v.event.add(b,"change._change",function(b){!this.parentNode||b.isSimulated||b.isTrigger||v.event.simulate("change",this.parentNode,b)}),v._data(b,"change",!0))})},handle:function(b){var c=b.target;return this!==c||b.isSimulated||b.isTrigger||"radio"!==c.type&&"checkbox"!==c.type?b.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return v.event.remove(this,"._change"),
!db.test(this.nodeName)}});R.focusin||v.each({focus:"focusin",blur:"focusout"},function(b,c){var d=function(b){v.event.simulate(c,b.target,v.event.fix(b))};v.event.special[c]={setup:function(){var e=this.ownerDocument||this,f=v._data(e,c);f||e.addEventListener(b,d,!0);v._data(e,c,(f||0)+1)},teardown:function(){var e=this.ownerDocument||this,f=v._data(e,c)-1;f?v._data(e,c,f):(e.removeEventListener(b,d,!0),v._removeData(e,c))}}});v.fn.extend({on:function(b,c,d,e){return A(this,b,c,d,e)},one:function(b,
c,d,e){return A(this,b,c,d,e,1)},off:function(b,c,d){var e,f;if(b&&b.preventDefault&&b.handleObj)return e=b.handleObj,v(b.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof b){for(f in b)this.off(f,c,b[f]);return this}return(!1===c||"function"==typeof c)&&(d=c,c=void 0),!1===d&&(d=w),this.each(function(){v.event.remove(this,b,d,c)})},trigger:function(b,c){return this.each(function(){v.event.trigger(b,c,this)})},triggerHandler:function(b,
c){var d=this[0];return d?v.event.trigger(b,c,d,!0):void 0}});var Ga=/ jQuery\d+="(?:null|\d+)"/g,Ha=RegExp("<(?:"+yb+")[\\s/>]","i"),pb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Rb=/<script|<style|<link/i,Mb=/checked\s*(?:[^=]|=\s*.checked.)/i,$b=/^true\/(.*)/,ac=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Nb=p(V).appendChild(V.createElement("div"));v.extend({htmlPrefilter:function(b){return b.replace(pb,"<$1></$2>")},clone:function(b,c,d){var e,f,j,g,k,h=v.contains(b.ownerDocument,
b);if(R.html5Clone||v.isXMLDoc(b)||!Ha.test("<"+b.nodeName+">")?j=b.cloneNode(!0):(Nb.innerHTML=b.outerHTML,Nb.removeChild(j=Nb.firstChild)),!(R.noCloneEvent&&R.noCloneChecked||1!==b.nodeType&&11!==b.nodeType||v.isXMLDoc(b))){e=s(j);k=s(b);for(g=0;null!=(f=k[g]);++g)if(e[g]){var l=e[g],m=void 0,n=void 0,o=void 0;if(1===l.nodeType){if(m=l.nodeName.toLowerCase(),!R.noCloneEvent&&l[v.expando]){o=v._data(l);for(n in o.events)v.removeEvent(l,n,o.handle);l.removeAttribute(v.expando)}"script"===m&&l.text!==
f.text?(G(l).text=f.text,H(l)):"object"===m?(l.parentNode&&(l.outerHTML=f.outerHTML),R.html5Clone&&f.innerHTML&&!v.trim(l.innerHTML)&&(l.innerHTML=f.innerHTML)):"input"===m&&ua.test(f.type)?(l.defaultChecked=l.checked=f.checked,l.value!==f.value&&(l.value=f.value)):"option"===m?l.defaultSelected=l.selected=f.defaultSelected:("input"===m||"textarea"===m)&&(l.defaultValue=f.defaultValue)}}}if(c)if(d){k=k||s(b);e=e||s(j);for(g=0;null!=(f=k[g]);g++)K(f,e[g])}else K(b,j);return e=s(j,"script"),0<e.length&&
r(e,!h&&s(b,"script")),j},cleanData:function(b,c){for(var d,e,f,j,g=0,k=v.expando,h=v.cache,l=R.attributes,m=v.event.special;null!=(d=b[g]);g++)if((c||Ia(d))&&(f=d[k],j=f&&h[f])){if(j.events)for(e in j.events)m[e]?v.event.remove(d,e):v.removeEvent(d,e,j.handle);h[f]&&(delete h[f],l||"undefined"==typeof d.removeAttribute?d[k]=void 0:d.removeAttribute(k),pa.push(f))}}});v.fn.extend({domManip:P,detach:function(b){return T(this,b,!0)},remove:function(b){return T(this,b)},text:function(b){return za(this,
function(b){return void 0===b?v.text(this):this.empty().append((this[0]&&this[0].ownerDocument||V).createTextNode(b))},null,b,arguments.length)},append:function(){return P(this,arguments,function(b){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&C(this,b).appendChild(b)})},prepend:function(){return P(this,arguments,function(b){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var c=C(this,b);c.insertBefore(b,c.firstChild)}})},before:function(){return P(this,arguments,function(b){this.parentNode&&
this.parentNode.insertBefore(b,this)})},after:function(){return P(this,arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this.nextSibling)})},empty:function(){for(var b,c=0;null!=(b=this[c]);c++){for(1===b.nodeType&&v.cleanData(s(b,!1));b.firstChild;)b.removeChild(b.firstChild);b.options&&v.nodeName(b,"select")&&(b.options.length=0)}return this},clone:function(b,c){return b=null==b?!1:b,c=null==c?b:c,this.map(function(){return v.clone(this,b,c)})},html:function(b){return za(this,
function(b){var c=this[0]||{},d=0,e=this.length;if(void 0===b)return 1===c.nodeType?c.innerHTML.replace(Ga,""):void 0;if("string"==typeof b&&!Rb.test(b)&&(R.htmlSerialize||!Ha.test(b))&&(R.leadingWhitespace||!Pa.test(b))&&!na[(hb.exec(b)||["",""])[1].toLowerCase()]){b=v.htmlPrefilter(b);try{for(;e>d;d++)c=this[d]||{},1===c.nodeType&&(v.cleanData(s(c,!1)),c.innerHTML=b);c=0}catch(f){}}c&&this.empty().append(b)},null,b,arguments.length)},replaceWith:function(){var b=[];return P(this,arguments,function(c){var d=
this.parentNode;0>v.inArray(this,b)&&(v.cleanData(s(this)),d&&d.replaceChild(c,this))},b)}});v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){v.fn[b]=function(b){for(var d=0,e=[],f=v(b),j=f.length-1;j>=d;d++)b=d===j?this:this.clone(!0),v(f[d])[c](b),sa.apply(e,b.get());return this.pushStack(e)}});var Ya,bc={HTML:"block",BODY:"block"},gc=/^margin/,Za=RegExp("^("+cb+")(?!px)[a-z%]+$","i"),Sb=function(b,c,d,e){var f,j={};
for(f in c)j[f]=b.style[f],b.style[f]=c[f];d=d.apply(b,e||[]);for(f in c)b.style[f]=j[f];return d},Tb=V.documentElement;!function(){var c,d,e,f,j,g,k=V.createElement("div"),h=V.createElement("div");if(h.style){h.style.cssText="float:left;opacity:.5";R.opacity="0.5"===h.style.opacity;R.cssFloat=!!h.style.cssFloat;h.style.backgroundClip="content-box";h.cloneNode(!0).style.backgroundClip="";R.clearCloneStyle="content-box"===h.style.backgroundClip;k=V.createElement("div");k.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute";
h.innerHTML="";k.appendChild(h);R.boxSizing=""===h.style.boxSizing||""===h.style.MozBoxSizing||""===h.style.WebkitBoxSizing;v.extend(R,{reliableHiddenOffsets:function(){return null==c&&l(),f},boxSizingReliable:function(){return null==c&&l(),e},pixelMarginRight:function(){return null==c&&l(),d},pixelPosition:function(){return null==c&&l(),c},reliableMarginRight:function(){return null==c&&l(),j},reliableMarginLeft:function(){return null==c&&l(),g}});var l=function(){var l,m,n=V.documentElement;n.appendChild(k);
h.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";c=e=g=!1;d=j=!0;b.getComputedStyle&&(m=b.getComputedStyle(h),c="1%"!==(m||{}).top,g="2px"===(m||{}).marginLeft,e="4px"===(m||{width:"4px"}).width,h.style.marginRight="50%",d="4px"===(m||{marginRight:"4px"}).marginRight,l=h.appendChild(V.createElement("div")),l.style.cssText=h.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",
l.style.marginRight=l.style.width="0",h.style.width="1px",j=!parseFloat((b.getComputedStyle(l)||{}).marginRight),h.removeChild(l));h.style.display="none";(f=0===h.getClientRects().length)&&(h.style.display="",h.innerHTML="<table><tr><td></td><td>t</td></tr></table>",l=h.getElementsByTagName("td"),l[0].style.cssText="margin:0;border:0;padding:0;display:none",f=0===l[0].offsetHeight,f&&(l[0].style.display="",l[1].style.display="none",f=0===l[0].offsetHeight));n.removeChild(k)}}}();var jb,sb,hc=/^(top|right|bottom|left)$/;
b.getComputedStyle?(jb=function(c){var d=c.ownerDocument.defaultView;return d&&d.opener||(d=b),d.getComputedStyle(c)},sb=function(b,c,d){var e,f,j,g,k=b.style;return d=d||jb(b),g=d?d.getPropertyValue(c)||d[c]:void 0,""!==g&&void 0!==g||v.contains(b.ownerDocument,b)||(g=v.style(b,c)),d&&!R.pixelMarginRight()&&Za.test(g)&&gc.test(c)&&(e=k.width,f=k.minWidth,j=k.maxWidth,k.minWidth=k.maxWidth=k.width=g,g=d.width,k.width=e,k.minWidth=f,k.maxWidth=j),void 0===g?g:g+""}):Tb.currentStyle&&(jb=function(b){return b.currentStyle},
sb=function(b,c,d){var e,f,j,g,k=b.style;return d=d||jb(b),g=d?d[c]:void 0,null==g&&k&&k[c]&&(g=k[c]),Za.test(g)&&!hc.test(c)&&(e=k.left,f=b.runtimeStyle,j=f&&f.left,j&&(f.left=b.currentStyle.left),k.left="fontSize"===c?"1em":g,g=k.pixelLeft+"px",k.left=e,j&&(f.left=j)),void 0===g?g:g+""||"auto"});var nc=/alpha\([^)]*\)/i,Ub=/opacity\s*=\s*([^)]*)/i,Vb=/^(none|table(?!-c[ea]).+)/,rb=RegExp("^("+cb+")(.*)$","i"),la={position:"absolute",visibility:"hidden",display:"block"},La={letterSpacing:"0",fontWeight:"400"},
vc=["Webkit","O","Moz","ms"],ib=V.createElement("div").style;v.extend({cssHooks:{opacity:{get:function(b,c){if(c){var d=sb(b,"opacity");return""===d?"1":d}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":R.cssFloat?"cssFloat":"styleFloat"},style:function(b,c,d,e){if(b&&3!==b.nodeType&&8!==b.nodeType&&b.style){var f,j,g,k=v.camelCase(c),h=b.style;
if(c=v.cssProps[k]||(v.cssProps[k]=J(k)||k),g=v.cssHooks[c]||v.cssHooks[k],void 0===d)return g&&"get"in g&&void 0!==(f=g.get(b,!1,e))?f:h[c];if(j=typeof d,"string"===j&&(f=gb.exec(d))&&f[1]&&(d=q(b,c,f),j="number"),null!=d&&d===d&&("number"===j&&(d+=f&&f[3]||(v.cssNumber[k]?"":"px")),R.clearCloneStyle||""!==d||0!==c.indexOf("background")||(h[c]="inherit"),!(g&&"set"in g&&void 0===(d=g.set(b,d,e)))))try{h[c]=d}catch(l){}}},css:function(b,c,d,e){var f,j,g,k=v.camelCase(c);return c=v.cssProps[k]||(v.cssProps[k]=
J(k)||k),g=v.cssHooks[c]||v.cssHooks[k],g&&"get"in g&&(j=g.get(b,!0,d)),void 0===j&&(j=sb(b,c,e)),"normal"===j&&c in La&&(j=La[c]),""===d||d?(f=parseFloat(j),!0===d||isFinite(f)?f||0:j):j}});v.each(["height","width"],function(b,c){v.cssHooks[c]={get:function(b,d,e){return d?Vb.test(v.css(b,"display"))&&0===b.offsetWidth?Sb(b,la,function(){return B(b,c,e)}):B(b,c,e):void 0},set:function(b,d,e){var f=e&&jb(b);return U(b,d,e?Q(b,c,e,R.boxSizing&&"border-box"===v.css(b,"boxSizing",!1,f),f):0)}}});R.opacity||
(v.cssHooks.opacity={get:function(b,c){return Ub.test((c&&b.currentStyle?b.currentStyle.filter:b.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":c?"1":""},set:function(b,c){var d=b.style,e=b.currentStyle,f=v.isNumeric(c)?"alpha(opacity="+100*c+")":"",j=e&&e.filter||d.filter||"";d.zoom=1;(1<=c||""===c)&&""===v.trim(j.replace(nc,""))&&d.removeAttribute&&(d.removeAttribute("filter"),""===c||e&&!e.filter)||(d.filter=nc.test(j)?j.replace(nc,f):j+" "+f)}});v.cssHooks.marginRight=I(R.reliableMarginRight,
function(b,c){return c?Sb(b,{display:"inline-block"},sb,[b,"marginRight"]):void 0});v.cssHooks.marginLeft=I(R.reliableMarginLeft,function(b,c){return c?(parseFloat(sb(b,"marginLeft"))||(v.contains(b.ownerDocument,b)?b.getBoundingClientRect().left-Sb(b,{marginLeft:0},function(){return b.getBoundingClientRect().left}):0))+"px":void 0});v.each({margin:"",padding:"",border:"Width"},function(b,c){v.cssHooks[b+c]={expand:function(d){for(var e=0,f={},d="string"==typeof d?d.split(" "):[d];4>e;e++)f[b+Qa[e]+
c]=d[e]||d[e-2]||d[0];return f}};gc.test(b)||(v.cssHooks[b+c].set=U)});v.fn.extend({css:function(b,c){return za(this,function(b,c,d){var e,f={},j=0;if(v.isArray(c)){d=jb(b);for(e=c.length;e>j;j++)f[c[j]]=v.css(b,c[j],!1,d);return f}return void 0!==d?v.style(b,c,d):v.css(b,c)},b,c,1<arguments.length)},show:function(){return N(this,!0)},hide:function(){return N(this)},toggle:function(b){return"boolean"==typeof b?b?this.show():this.hide():this.each(function(){qa(this)?v(this).show():v(this).hide()})}});
v.Tween=E;E.prototype={constructor:E,init:function(b,c,d,e,f,j){this.elem=b;this.prop=d;this.easing=f||v.easing._default;this.options=c;this.start=this.now=this.cur();this.end=e;this.unit=j||(v.cssNumber[d]?"":"px")},cur:function(){var b=E.propHooks[this.prop];return b&&b.get?b.get(this):E.propHooks._default.get(this)},run:function(b){var c,d=E.propHooks[this.prop];return this.options.duration?this.pos=c=v.easing[this.easing](b,this.options.duration*b,0,1,this.options.duration):this.pos=c=b,this.now=
(this.end-this.start)*c+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),d&&d.set?d.set(this):E.propHooks._default.set(this),this}};E.prototype.init.prototype=E.prototype;E.propHooks={_default:{get:function(b){var c;return 1!==b.elem.nodeType||null!=b.elem[b.prop]&&null==b.elem.style[b.prop]?b.elem[b.prop]:(c=v.css(b.elem,b.prop,""),c&&"auto"!==c?c:0)},set:function(b){v.fx.step[b.prop]?v.fx.step[b.prop](b):1!==b.elem.nodeType||null==b.elem.style[v.cssProps[b.prop]]&&!v.cssHooks[b.prop]?
b.elem[b.prop]=b.now:v.style(b.elem,b.prop,b.now+b.unit)}}};E.propHooks.scrollTop=E.propHooks.scrollLeft={set:function(b){b.elem.nodeType&&b.elem.parentNode&&(b.elem[b.prop]=b.now)}};v.easing={linear:function(b){return b},swing:function(b){return 0.5-Math.cos(b*Math.PI)/2},_default:"swing"};v.fx=E.prototype.init;v.fx.step={};var $a,Jb,Ac=/^(?:toggle|show|hide)$/,Bc=/queueHooks$/;v.Animation=v.extend(aa,{tweeners:{"*":[function(b,c){var d=this.createTween(b,c);return q(d.elem,b,gb.exec(c),d),d}]},
tweener:function(b,c){v.isFunction(b)?(c=b,b=["*"]):b=b.match(Aa);for(var d,e=0,f=b.length;f>e;e++)d=b[e],aa.tweeners[d]=aa.tweeners[d]||[],aa.tweeners[d].unshift(c)},prefilters:[function(b,c,d){var e,f,j,g,k,h,l,m=this,n={},o=b.style,s=b.nodeType&&qa(b),q=v._data(b,"fxshow");d.queue||(g=v._queueHooks(b,"fx"),null==g.unqueued&&(g.unqueued=0,k=g.empty.fire,g.empty.fire=function(){g.unqueued||k()}),g.unqueued++,m.always(function(){m.always(function(){g.unqueued--;v.queue(b,"fx").length||g.empty.fire()})}));
1===b.nodeType&&("height"in c||"width"in c)&&(d.overflow=[o.overflow,o.overflowX,o.overflowY],h=v.css(b,"display"),l="none"===h?v._data(b,"olddisplay")||F(b.nodeName):h,"inline"===l&&"none"===v.css(b,"float")&&(R.inlineBlockNeedsLayout&&"inline"!==F(b.nodeName)?o.zoom=1:o.display="inline-block"));d.overflow&&(o.overflow="hidden",R.shrinkWrapBlocks()||m.always(function(){o.overflow=d.overflow[0];o.overflowX=d.overflow[1];o.overflowY=d.overflow[2]}));for(e in c)if(f=c[e],Ac.exec(f)){if(delete c[e],
j=j||"toggle"===f,f===(s?"hide":"show")){if("show"!==f||!q||void 0===q[e])continue;s=!0}n[e]=q&&q[e]||v.style(b,e)}else h=void 0;if(v.isEmptyObject(n))"inline"===("none"===h?F(b.nodeName):h)&&(o.display=h);else for(e in q?"hidden"in q&&(s=q.hidden):q=v._data(b,"fxshow",{}),j&&(q.hidden=!s),s?v(b).show():m.done(function(){v(b).hide()}),m.done(function(){var c;v._removeData(b,"fxshow");for(c in n)v.style(b,c,n[c])}),n)c=M(s?q[e]:0,e,m),e in q||(q[e]=c.start,s&&(c.end=c.start,c.start="width"===e||"height"===
e?1:0))}],prefilter:function(b,c){c?aa.prefilters.unshift(b):aa.prefilters.push(b)}});v.speed=function(b,c,d){var e=b&&"object"==typeof b?v.extend({},b):{complete:d||!d&&c||v.isFunction(b)&&b,duration:b,easing:d&&c||c&&!v.isFunction(c)&&c};return e.duration=v.fx.off?0:"number"==typeof e.duration?e.duration:e.duration in v.fx.speeds?v.fx.speeds[e.duration]:v.fx.speeds._default,(null==e.queue||!0===e.queue)&&(e.queue="fx"),e.old=e.complete,e.complete=function(){v.isFunction(e.old)&&e.old.call(this);
e.queue&&v.dequeue(this,e.queue)},e};v.fn.extend({fadeTo:function(b,c,d,e){return this.filter(qa).css("opacity",0).show().end().animate({opacity:c},b,d,e)},animate:function(b,c,d,e){var f=v.isEmptyObject(b),j=v.speed(c,d,e),c=function(){var c=aa(this,v.extend({},b),j);(f||v._data(this,"finish"))&&c.stop(!0)};return c.finish=c,f||!1===j.queue?this.each(c):this.queue(j.queue,c)},stop:function(b,c,d){var e=function(b){var c=b.stop;delete b.stop;c(d)};return"string"!=typeof b&&(d=c,c=b,b=void 0),c&&!1!==
b&&this.queue(b||"fx",[]),this.each(function(){var c=!0,f=null!=b&&b+"queueHooks",j=v.timers,g=v._data(this);if(f)g[f]&&g[f].stop&&e(g[f]);else for(f in g)g[f]&&g[f].stop&&Bc.test(f)&&e(g[f]);for(f=j.length;f--;)j[f].elem!==this||null!=b&&j[f].queue!==b||(j[f].anim.stop(d),c=!1,j.splice(f,1));(c||!d)&&v.dequeue(this,b)})},finish:function(b){return!1!==b&&(b=b||"fx"),this.each(function(){var c,d=v._data(this),e=d[b+"queue"];c=d[b+"queueHooks"];var f=v.timers,j=e?e.length:0;d.finish=!0;v.queue(this,
b,[]);c&&c.stop&&c.stop.call(this,!0);for(c=f.length;c--;)f[c].elem===this&&f[c].queue===b&&(f[c].anim.stop(!0),f.splice(c,1));for(c=0;j>c;c++)e[c]&&e[c].finish&&e[c].finish.call(this);delete d.finish})}});v.each(["toggle","show","hide"],function(b,c){var d=v.fn[c];v.fn[c]=function(b,e,f){return null==b||"boolean"==typeof b?d.apply(this,arguments):this.animate(O(c,!0),b,e,f)}});v.each({slideDown:O("show"),slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},
function(b,c){v.fn[b]=function(b,d,e){return this.animate(c,b,d,e)}});v.timers=[];v.fx.tick=function(){var b,c=v.timers,d=0;for($a=v.now();d<c.length;d++)b=c[d],b()||c[d]!==b||c.splice(d--,1);c.length||v.fx.stop();$a=void 0};v.fx.timer=function(b){v.timers.push(b);b()?v.fx.start():v.timers.pop()};v.fx.interval=13;v.fx.start=function(){Jb||(Jb=b.setInterval(v.fx.tick,v.fx.interval))};v.fx.stop=function(){b.clearInterval(Jb);Jb=null};v.fx.speeds={slow:600,fast:200,_default:400};v.fn.delay=function(c,
d){return c=v.fx?v.fx.speeds[c]||c:c,d=d||"fx",this.queue(d,function(d,e){var f=b.setTimeout(d,c);e.stop=function(){b.clearTimeout(f)}})};(function(){var b,c=V.createElement("input"),d=V.createElement("div"),e=V.createElement("select"),f=e.appendChild(V.createElement("option")),d=V.createElement("div");d.setAttribute("className","t");d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";d.getElementsByTagName("a");c.setAttribute("type","checkbox");d.appendChild(c);b=d.getElementsByTagName("a")[0];
b.style.cssText="top:1px";R.getSetAttribute="t"!==d.className;R.style=/top/.test(b.getAttribute("style"));R.hrefNormalized="/a"===b.getAttribute("href");R.checkOn=!!c.value;R.optSelected=f.selected;R.enctype=!!V.createElement("form").enctype;e.disabled=!0;R.optDisabled=!f.disabled;c=V.createElement("input");c.setAttribute("value","");R.input=""===c.getAttribute("value");c.value="t";c.setAttribute("type","radio");R.radioValue="t"===c.value})();var Rc=/\r/g;v.fn.extend({val:function(b){var c,d,e,f=
this[0];if(arguments.length)return e=v.isFunction(b),this.each(function(d){var f;1===this.nodeType&&(f=e?b.call(this,d,v(this).val()):b,null==f?f="":"number"==typeof f?f+="":v.isArray(f)&&(f=v.map(f,function(b){return null==b?"":b+""})),c=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()],c&&"set"in c&&void 0!==c.set(this,f,"value")||(this.value=f))});if(f)return c=v.valHooks[f.type]||v.valHooks[f.nodeName.toLowerCase()],c&&"get"in c&&void 0!==(d=c.get(f,"value"))?d:(d=f.value,"string"==
typeof d?d.replace(Rc,""):null==d?"":d)}});v.extend({valHooks:{option:{get:function(b){var c=v.find.attr(b,"value");return null!=c?c:v.trim(v.text(b))}},select:{get:function(b){for(var c,d=b.options,e=b.selectedIndex,f="select-one"===b.type||0>e,j=f?null:[],g=f?e+1:d.length,k=0>e?g:f?e:0;g>k;k++)if(c=d[k],(c.selected||k===e)&&(R.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!v.nodeName(c.parentNode,"optgroup"))){if(b=v(c).val(),f)return b;j.push(b)}return j},
set:function(b,c){for(var d,e,f=b.options,j=v.makeArray(c),g=f.length;g--;)if(e=f[g],0<=v.inArray(v.valHooks.option.get(e),j))try{e.selected=d=!0}catch(k){e.scrollHeight}else e.selected=!1;return d||(b.selectedIndex=-1),f}}}});v.each(["radio","checkbox"],function(){v.valHooks[this]={set:function(b,c){return v.isArray(c)?b.checked=-1<v.inArray(v(b).val(),c):void 0}};R.checkOn||(v.valHooks[this].get=function(b){return null===b.getAttribute("value")?"on":b.value})});var Bb,Cc,Cb=v.expr.attrHandle,Dc=
/^(?:checked|selected)$/i,eb=R.getSetAttribute,Db=R.input;v.fn.extend({attr:function(b,c){return za(this,v.attr,b,c,1<arguments.length)},removeAttr:function(b){return this.each(function(){v.removeAttr(this,b)})}});v.extend({attr:function(b,c,d){var e,f,j=b.nodeType;if(3!==j&&8!==j&&2!==j)return"undefined"==typeof b.getAttribute?v.prop(b,c,d):(1===j&&v.isXMLDoc(b)||(c=c.toLowerCase(),f=v.attrHooks[c]||(v.expr.match.bool.test(c)?Cc:Bb)),void 0!==d?null===d?void v.removeAttr(b,c):f&&"set"in f&&void 0!==
(e=f.set(b,d,c))?e:(b.setAttribute(c,d+""),d):f&&"get"in f&&null!==(e=f.get(b,c))?e:(e=v.find.attr(b,c),null==e?void 0:e))},attrHooks:{type:{set:function(b,c){if(!R.radioValue&&"radio"===c&&v.nodeName(b,"input")){var d=b.value;return b.setAttribute("type",c),d&&(b.value=d),c}}}},removeAttr:function(b,c){var d,e,f=0,j=c&&c.match(Aa);if(j&&1===b.nodeType)for(;d=j[f++];)e=v.propFix[d]||d,v.expr.match.bool.test(d)?Db&&eb||!Dc.test(d)?b[e]=!1:b[v.camelCase("default-"+d)]=b[e]=!1:v.attr(b,d,""),b.removeAttribute(eb?
d:e)}});Cc={set:function(b,c,d){return!1===c?v.removeAttr(b,d):Db&&eb||!Dc.test(d)?b.setAttribute(!eb&&v.propFix[d]||d,d):b[v.camelCase("default-"+d)]=b[d]=!0,d}};v.each(v.expr.match.bool.source.match(/\w+/g),function(b,c){var d=Cb[c]||v.find.attr;Db&&eb||!Dc.test(c)?Cb[c]=function(b,c,e){var f,j;return e||(j=Cb[c],Cb[c]=f,f=null!=d(b,c,e)?c.toLowerCase():null,Cb[c]=j),f}:Cb[c]=function(b,c,d){return d?void 0:b[v.camelCase("default-"+c)]?c.toLowerCase():null}});Db&&eb||(v.attrHooks.value={set:function(b,
c,d){return v.nodeName(b,"input")?void(b.defaultValue=c):Bb&&Bb.set(b,c,d)}});eb||(Bb={set:function(b,c,d){var e=b.getAttributeNode(d);return e||b.setAttributeNode(e=b.ownerDocument.createAttribute(d)),e.value=c+="","value"===d||c===b.getAttribute(d)?c:void 0}},Cb.id=Cb.name=Cb.coords=function(b,c,d){var e;return d?void 0:(e=b.getAttributeNode(c))&&""!==e.value?e.value:null},v.valHooks.button={get:function(b,c){var d=b.getAttributeNode(c);return d&&d.specified?d.value:void 0},set:Bb.set},v.attrHooks.contenteditable=
{set:function(b,c,d){Bb.set(b,""===c?!1:c,d)}},v.each(["width","height"],function(b,c){v.attrHooks[c]={set:function(b,d){return""===d?(b.setAttribute(c,"auto"),d):void 0}}}));R.style||(v.attrHooks.style={get:function(b){return b.style.cssText||void 0},set:function(b,c){return b.style.cssText=c+""}});var Wa=/^(?:input|select|textarea|button|object)$/i,Sc=/^(?:a|area)$/i;v.fn.extend({prop:function(b,c){return za(this,v.prop,b,c,1<arguments.length)},removeProp:function(b){return b=v.propFix[b]||b,this.each(function(){try{this[b]=
void 0,delete this[b]}catch(c){}})}});v.extend({prop:function(b,c,d){var e,f,j=b.nodeType;if(3!==j&&8!==j&&2!==j)return 1===j&&v.isXMLDoc(b)||(c=v.propFix[c]||c,f=v.propHooks[c]),void 0!==d?f&&"set"in f&&void 0!==(e=f.set(b,d,c))?e:b[c]=d:f&&"get"in f&&null!==(e=f.get(b,c))?e:b[c]},propHooks:{tabIndex:{get:function(b){var c=v.find.attr(b,"tabindex");return c?parseInt(c,10):Wa.test(b.nodeName)||Sc.test(b.nodeName)&&b.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}});R.hrefNormalized||v.each(["href",
"src"],function(b,c){v.propHooks[c]={get:function(b){return b.getAttribute(c,4)}}});R.optSelected||(v.propHooks.selected={get:function(b){b=b.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}});v.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){v.propFix[this.toLowerCase()]=this});R.enctype||(v.propFix.enctype="encoding");var Wb=/[\t\r\n\f]/g;v.fn.extend({addClass:function(b){var c,
d,e,f,j,g,k=0;if(v.isFunction(b))return this.each(function(c){v(this).addClass(b.call(this,c,Y(this)))});if("string"==typeof b&&b)for(c=b.match(Aa)||[];d=this[k++];)if(f=Y(d),e=1===d.nodeType&&(" "+f+" ").replace(Wb," ")){for(g=0;j=c[g++];)0>e.indexOf(" "+j+" ")&&(e+=j+" ");e=v.trim(e);f!==e&&v.attr(d,"class",e)}return this},removeClass:function(b){var c,d,e,f,j,g,k=0;if(v.isFunction(b))return this.each(function(c){v(this).removeClass(b.call(this,c,Y(this)))});if(!arguments.length)return this.attr("class",
"");if("string"==typeof b&&b)for(c=b.match(Aa)||[];d=this[k++];)if(f=Y(d),e=1===d.nodeType&&(" "+f+" ").replace(Wb," ")){for(g=0;j=c[g++];)for(;-1<e.indexOf(" "+j+" ");)e=e.replace(" "+j+" "," ");e=v.trim(e);f!==e&&v.attr(d,"class",e)}return this},toggleClass:function(b,c){var d=typeof b;return"boolean"==typeof c&&"string"===d?c?this.addClass(b):this.removeClass(b):v.isFunction(b)?this.each(function(d){v(this).toggleClass(b.call(this,d,Y(this),c),c)}):this.each(function(){var c,e,f,j;if("string"===
d){e=0;f=v(this);for(j=b.match(Aa)||[];c=j[e++];)f.hasClass(c)?f.removeClass(c):f.addClass(c)}else(void 0===b||"boolean"===d)&&(c=Y(this),c&&v._data(this,"__className__",c),v.attr(this,"class",c||!1===b?"":v._data(this,"__className__")||""))})},hasClass:function(b){for(var c,d=0,b=" "+b+" ";c=this[d++];)if(1===c.nodeType&&-1<(" "+Y(c)+" ").replace(Wb," ").indexOf(b))return!0;return!1}});v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(b,c){v.fn[c]=function(b,d){return arguments.length>0?this.on(c,null,b,d):this.trigger(c)}});v.fn.extend({hover:function(b,c){return this.mouseenter(b).mouseleave(c||b)}});var od=b.location,oc=v.now(),Ba=/\?/,Tc=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;v.parseJSON=function(c){if(b.JSON&&b.JSON.parse)return b.JSON.parse(c+"");var d,e=null,f=v.trim(c+"");return f&&!v.trim(f.replace(Tc,function(b,c,f,j){return d&&
c&&(e=0),0===e?b:(d=f||c,e+=!j-!f,"")}))?Function("return "+f)():v.error("Invalid JSON: "+c)};v.parseXML=function(c){var d,e;if(!c||"string"!=typeof c)return null;try{b.DOMParser?(e=new b.DOMParser,d=e.parseFromString(c,"text/xml")):(d=new b.ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=void 0}return d&&d.documentElement&&!d.getElementsByTagName("parsererror").length||v.error("Invalid XML: "+c),d};var Uc=/#.*$/,Ec=/([?&])_=[^&]*/,Vc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Wc=
/^(?:GET|HEAD)$/,Fc=/^\/\//,Xc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Yc={},wc={},Gc="*/".concat("*"),Hc=od.href,Xb=Xc.exec(Hc.toLowerCase())||[];v.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Hc,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Xb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Gc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",
json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(b,c){return c?ra(ra(b,v.ajaxSettings),c):ra(v.ajaxSettings,b)},ajaxPrefilter:ba(Yc),ajaxTransport:ba(wc),ajax:function(c,d){function e(c,d,f,j){var n,r,L,A,B=d;if(2!==w){w=2;h&&b.clearTimeout(h);
m=void 0;k=j||"";D.readyState=0<c?4:0;j=200<=c&&300>c||304===c;if(f){L=o;for(var z=D,O,C,x,E,W=L.contents,F=L.dataTypes;"*"===F[0];)F.shift(),void 0===C&&(C=L.mimeType||z.getResponseHeader("Content-Type"));if(C)for(E in W)if(W[E]&&W[E].test(C)){F.unshift(E);break}if(F[0]in f)x=F[0];else{for(E in f){if(!F[0]||L.converters[E+" "+F[0]]){x=E;break}O||(O=E)}x=x||O}L=x?(x!==F[0]&&F.unshift(x),f[x]):void 0}var M;a:{f=o;O=L;C=D;x=j;var X,J,I;L={};z=f.dataTypes.slice();if(z[1])for(X in f.converters)L[X.toLowerCase()]=
f.converters[X];for(E=z.shift();E;)if(f.responseFields[E]&&(C[f.responseFields[E]]=O),!I&&x&&f.dataFilter&&(O=f.dataFilter(O,f.dataType)),I=E,E=z.shift())if("*"===E)E=I;else if("*"!==I&&I!==E){if(X=L[I+" "+E]||L["* "+E],!X)for(M in L)if(J=M.split(" "),J[1]===E&&(X=L[I+" "+J[0]]||L["* "+J[0]])){!0===X?X=L[M]:!0!==L[M]&&(E=J[0],z.unshift(J[1]));break}if(!0!==X)if(X&&f["throws"])O=X(O);else try{O=X(O)}catch(G){M={state:"parsererror",error:X?G:"No conversion from "+I+" to "+E};break a}}M={state:"success",
data:O}}L=M;j?(o.ifModified&&(A=D.getResponseHeader("Last-Modified"),A&&(v.lastModified[g]=A),A=D.getResponseHeader("etag"),A&&(v.etag[g]=A)),204===c||"HEAD"===o.type?B="nocontent":304===c?B="notmodified":(B=L.state,n=L.data,r=L.error,j=!r)):(r=B,(c||!B)&&(B="error",0>c&&(c=0)));D.status=c;D.statusText=(d||B)+"";j?u.resolveWith(s,[n,B,D]):u.rejectWith(s,[D,B,r]);D.statusCode(p);p=void 0;l&&q.trigger(j?"ajaxSuccess":"ajaxError",[D,o,j?n:r]);t.fireWith(s,[D,B]);l&&(q.trigger("ajaxComplete",[D,o]),--v.active||
v.event.trigger("ajaxStop"))}}"object"==typeof c&&(d=c,c=void 0);var d=d||{},f,j,g,k,h,l,m,n,o=v.ajaxSetup({},d),s=o.context||o,q=o.context&&(s.nodeType||s.jquery)?v(s):v.event,u=v.Deferred(),t=v.Callbacks("once memory"),p=o.statusCode||{},r={},L={},w=0,A="canceled",D={readyState:0,getResponseHeader:function(b){var c;if(2===w){if(!n)for(n={};c=Vc.exec(k);)n[c[1].toLowerCase()]=c[2];c=n[b.toLowerCase()]}return null==c?null:c},getAllResponseHeaders:function(){return 2===w?k:null},setRequestHeader:function(b,
c){var d=b.toLowerCase();return w||(b=L[d]=L[d]||b,r[b]=c),this},overrideMimeType:function(b){return w||(o.mimeType=b),this},statusCode:function(b){var c;if(b)if(2>w)for(c in b)p[c]=[p[c],b[c]];else D.always(b[D.status]);return this},abort:function(b){b=b||A;return m&&m.abort(b),e(0,b),this}};if(u.promise(D).complete=t.add,D.success=D.done,D.error=D.fail,o.url=((c||o.url||Hc)+"").replace(Uc,"").replace(Fc,Xb[1]+"//"),o.type=d.method||d.type||o.method||o.type,o.dataTypes=v.trim(o.dataType||"*").toLowerCase().match(Aa)||
[""],null==o.crossDomain&&(f=Xc.exec(o.url.toLowerCase()),o.crossDomain=!(!f||f[1]===Xb[1]&&f[2]===Xb[2]&&(f[3]||("http:"===f[1]?"80":"443"))===(Xb[3]||("http:"===Xb[1]?"80":"443")))),o.data&&o.processData&&"string"!=typeof o.data&&(o.data=v.param(o.data,o.traditional)),da(Yc,o,d,D),2===w)return D;(l=v.event&&o.global)&&0===v.active++&&v.event.trigger("ajaxStart");o.type=o.type.toUpperCase();o.hasContent=!Wc.test(o.type);g=o.url;o.hasContent||(o.data&&(g=o.url+=(Ba.test(g)?"&":"?")+o.data,delete o.data),
!1===o.cache&&(o.url=Ec.test(g)?g.replace(Ec,"$1_="+oc++):g+(Ba.test(g)?"&":"?")+"_="+oc++));o.ifModified&&(v.lastModified[g]&&D.setRequestHeader("If-Modified-Since",v.lastModified[g]),v.etag[g]&&D.setRequestHeader("If-None-Match",v.etag[g]));(o.data&&o.hasContent&&!1!==o.contentType||d.contentType)&&D.setRequestHeader("Content-Type",o.contentType);D.setRequestHeader("Accept",o.dataTypes[0]&&o.accepts[o.dataTypes[0]]?o.accepts[o.dataTypes[0]]+("*"!==o.dataTypes[0]?", "+Gc+"; q=0.01":""):o.accepts["*"]);
for(j in o.headers)D.setRequestHeader(j,o.headers[j]);if(o.beforeSend&&(!1===o.beforeSend.call(s,D,o)||2===w))return D.abort();A="abort";for(j in{success:1,error:1,complete:1})D[j](o[j]);if(m=da(wc,o,d,D)){if(D.readyState=1,l&&q.trigger("ajaxSend",[D,o]),2===w)return D;o.async&&0<o.timeout&&(h=b.setTimeout(function(){D.abort("timeout")},o.timeout));try{w=1,m.send(r,e)}catch(B){if(!(2>w))throw B;e(-1,B)}}else e(-1,"No Transport");return D},getJSON:function(b,c,d){return v.get(b,c,d,"json")},getScript:function(b,
c){return v.get(b,void 0,c,"script")}});v.each(["get","post"],function(b,c){v[c]=function(b,d,e,f){return v.isFunction(d)&&(f=f||e,e=d,d=void 0),v.ajax(v.extend({url:b,type:c,dataType:f,data:d,success:e},v.isPlainObject(b)&&b))}});v._evalUrl=function(b){return v.ajax({url:b,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})};v.fn.extend({wrapAll:function(b){if(v.isFunction(b))return this.each(function(c){v(this).wrapAll(b.call(this,c))});if(this[0]){var c=v(b,this[0].ownerDocument).eq(0).clone(!0);
this[0].parentNode&&c.insertBefore(this[0]);c.map(function(){for(var b=this;b.firstChild&&1===b.firstChild.nodeType;)b=b.firstChild;return b}).append(this)}return this},wrapInner:function(b){return v.isFunction(b)?this.each(function(c){v(this).wrapInner(b.call(this,c))}):this.each(function(){var c=v(this),d=c.contents();d.length?d.wrapAll(b):c.append(b)})},wrap:function(b){var c=v.isFunction(b);return this.each(function(d){v(this).wrapAll(c?b.call(this,d):b)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,
"body")||v(this).replaceWith(this.childNodes)}).end()}});v.expr.filters.hidden=function(b){if(R.reliableHiddenOffsets())b=0>=b.offsetWidth&&0>=b.offsetHeight&&!b.getClientRects().length;else a:{for(;b&&1===b.nodeType;){if("none"===(b.style&&b.style.display||v.css(b,"display"))||"hidden"===b.type){b=!0;break a}b=b.parentNode}b=!1}return b};v.expr.filters.visible=function(b){return!v.expr.filters.hidden(b)};var pd=/%20/g,gd=/\[\]$/,Ic=/\r?\n/g,qd=/^(?:submit|button|image|reset|file)$/i,rd=/^(?:input|select|textarea|keygen)/i;
v.param=function(b,c){var d,e=[],f=function(b,c){c=v.isFunction(c)?c():null==c?"":c;e[e.length]=encodeURIComponent(b)+"="+encodeURIComponent(c)};if(void 0===c&&(c=v.ajaxSettings&&v.ajaxSettings.traditional),v.isArray(b)||b.jquery&&!v.isPlainObject(b))v.each(b,function(){f(this.name,this.value)});else for(d in b)x(d,b[d],c,f);return e.join("&").replace(pd,"+")};v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var b=v.prop(this,
"elements");return b?v.makeArray(b):this}).filter(function(){var b=this.type;return this.name&&!v(this).is(":disabled")&&rd.test(this.nodeName)&&!qd.test(b)&&(this.checked||!ua.test(b))}).map(function(b,c){var d=v(this).val();return null==d?null:v.isArray(d)?v.map(d,function(b){return{name:c.name,value:b.replace(Ic,"\r\n")}}):{name:c.name,value:d.replace(Ic,"\r\n")}}).get()}});v.ajaxSettings.xhr=void 0!==b.ActiveXObject?function(){return this.isLocal?ka():8<V.documentMode?ja():/^(get|post|head|put|delete|options)$/i.test(this.type)&&
ja()||ka()}:ja;var sd=0,pc={},qc=v.ajaxSettings.xhr();b.attachEvent&&b.attachEvent("onunload",function(){for(var b in pc)pc[b](void 0,!0)});R.cors=!!qc&&"withCredentials"in qc;(qc=R.ajax=!!qc)&&v.ajaxTransport(function(c){if(!c.crossDomain||R.cors){var d;return{send:function(e,f){var j,g=c.xhr(),k=++sd;if(g.open(c.type,c.url,c.async,c.username,c.password),c.xhrFields)for(j in c.xhrFields)g[j]=c.xhrFields[j];c.mimeType&&g.overrideMimeType&&g.overrideMimeType(c.mimeType);c.crossDomain||e["X-Requested-With"]||
(e["X-Requested-With"]="XMLHttpRequest");for(j in e)void 0!==e[j]&&g.setRequestHeader(j,e[j]+"");g.send(c.hasContent&&c.data||null);d=function(b,e){var j,h,l;if(d&&(e||4===g.readyState))if(delete pc[k],d=void 0,g.onreadystatechange=v.noop,e)4!==g.readyState&&g.abort();else{l={};j=g.status;"string"==typeof g.responseText&&(l.text=g.responseText);try{h=g.statusText}catch(m){h=""}j||!c.isLocal||c.crossDomain?1223===j&&(j=204):j=l.text?200:404}l&&f(j,h,l,g.getAllResponseHeaders())};c.async?4===g.readyState?
b.setTimeout(d):g.onreadystatechange=pc[k]=d:d()},abort:function(){d&&d(void 0,!0)}}}});v.ajaxPrefilter(function(b){b.crossDomain&&(b.contents.script=!1)});v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(b){return v.globalEval(b),b}}});v.ajaxPrefilter("script",function(b){void 0===b.cache&&(b.cache=!1);b.crossDomain&&(b.type="GET",b.global=!1)});
v.ajaxTransport("script",function(b){if(b.crossDomain){var c,d=V.head||v("head")[0]||V.documentElement;return{send:function(e,f){c=V.createElement("script");c.async=!0;b.scriptCharset&&(c.charset=b.scriptCharset);c.src=b.url;c.onload=c.onreadystatechange=function(b,d){(d||!c.readyState||/loaded|complete/.test(c.readyState))&&(c.onload=c.onreadystatechange=null,c.parentNode&&c.parentNode.removeChild(c),c=null,d||f(200,"success"))};d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(void 0,
!0)}}}});var Zc=[],wb=/(=)\?(?=&|$)|\?\?/;v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var b=Zc.pop()||v.expando+"_"+oc++;return this[b]=!0,b}});v.ajaxPrefilter("json jsonp",function(c,d,e){var f,j,g,k=!1!==c.jsonp&&(wb.test(c.url)?"url":"string"==typeof c.data&&0===(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&wb.test(c.data)&&"data");return k||"jsonp"===c.dataTypes[0]?(f=c.jsonpCallback=v.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,k?c[k]=c[k].replace(wb,
"$1"+f):!1!==c.jsonp&&(c.url+=(Ba.test(c.url)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return g||v.error(f+" was not called"),g[0]},c.dataTypes[0]="json",j=b[f],b[f]=function(){g=arguments},e.always(function(){void 0===j?v(b).removeProp(f):b[f]=j;c[f]&&(c.jsonpCallback=d.jsonpCallback,Zc.push(f));g&&v.isFunction(j)&&j(g[0]);g=j=void 0}),"script"):void 0});R.createHTMLDocument=function(){if(!V.implementation.createHTMLDocument)return!1;var b=V.implementation.createHTMLDocument("");
return b.body.innerHTML="<form></form><form></form>",2===b.body.childNodes.length}();v.parseHTML=function(b,c,d){if(!b||"string"!=typeof b)return null;"boolean"==typeof c&&(d=c,c=!1);var c=c||(R.createHTMLDocument?V.implementation.createHTMLDocument(""):V),e=nb.exec(b),d=!d&&[];return e?[c.createElement(e[1])]:(e=t([b],c,d),d&&d.length&&v(d).remove(),v.merge([],e.childNodes))};var rc=v.fn.load;v.fn.load=function(b,c,d){if("string"!=typeof b&&rc)return rc.apply(this,arguments);var e,f,j,g=this,k=b.indexOf(" ");
return-1<k&&(e=v.trim(b.slice(k,b.length)),b=b.slice(0,k)),v.isFunction(c)?(d=c,c=void 0):c&&"object"==typeof c&&(f="POST"),0<g.length&&v.ajax({url:b,type:f||"GET",dataType:"html",data:c}).done(function(b){j=arguments;g.html(e?v("<div>").append(v.parseHTML(b)).find(e):b)}).always(d&&function(b,c){g.each(function(){d.apply(g,j||[b.responseText,c,b])})}),this};v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(b,c){v.fn[c]=function(b){return this.on(c,b)}});
v.expr.filters.animated=function(b){return v.grep(v.timers,function(c){return b===c.elem}).length};v.offset={setOffset:function(b,c,d){var e,f,j,g,k,h,l=v.css(b,"position"),m=v(b),n={};"static"===l&&(b.style.position="relative");k=m.offset();j=v.css(b,"top");h=v.css(b,"left");("absolute"===l||"fixed"===l)&&-1<v.inArray("auto",[j,h])?(e=m.position(),g=e.top,f=e.left):(g=parseFloat(j)||0,f=parseFloat(h)||0);v.isFunction(c)&&(c=c.call(b,d,v.extend({},k)));null!=c.top&&(n.top=c.top-k.top+g);null!=c.left&&
(n.left=c.left-k.left+f);"using"in c?c.using.call(b,n):m.css(n)}};v.fn.extend({offset:function(b){if(arguments.length)return void 0===b?this:this.each(function(c){v.offset.setOffset(this,b,c)});var c,d,e={top:0,left:0},f=this[0],j=f&&f.ownerDocument;if(j)return c=j.documentElement,v.contains(c,f)?("undefined"!=typeof f.getBoundingClientRect&&(e=f.getBoundingClientRect()),d=oa(j),{top:e.top+(d.pageYOffset||c.scrollTop)-(c.clientTop||0),left:e.left+(d.pageXOffset||c.scrollLeft)-(c.clientLeft||0)}):
e},position:function(){if(this[0]){var b,c,d={top:0,left:0},e=this[0];return"fixed"===v.css(e,"position")?c=e.getBoundingClientRect():(b=this.offsetParent(),c=this.offset(),v.nodeName(b[0],"html")||(d=b.offset()),d.top+=v.css(b[0],"borderTopWidth",!0),d.left+=v.css(b[0],"borderLeftWidth",!0)),{top:c.top-d.top-v.css(e,"marginTop",!0),left:c.left-d.left-v.css(e,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var b=this.offsetParent;b&&!v.nodeName(b,"html")&&"static"===v.css(b,
"position");)b=b.offsetParent;return b||Tb})}});v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d=/Y/.test(c);v.fn[b]=function(e){return za(this,function(b,e,f){var j=oa(b);return void 0===f?j?c in j?j[c]:j.document.documentElement[e]:b[e]:void(j?j.scrollTo(d?v(j).scrollLeft():f,d?f:v(j).scrollTop()):b[e]=f)},b,e,arguments.length,null)}});v.each(["top","left"],function(b,c){v.cssHooks[c]=I(R.pixelPosition,function(b,d){return d?(d=sb(b,c),Za.test(d)?v(b).position()[c]+
"px":d):void 0})});v.each({Height:"height",Width:"width"},function(b,c){v.each({padding:"inner"+b,content:c,"":"outer"+b},function(d,e){v.fn[e]=function(e,f){var j=arguments.length&&(d||"boolean"!=typeof e),g=d||(!0===e||!0===f?"margin":"border");return za(this,function(c,d,e){var f;return v.isWindow(c)?c.document.documentElement["client"+b]:9===c.nodeType?(f=c.documentElement,Math.max(c.body["scroll"+b],f["scroll"+b],c.body["offset"+b],f["offset"+b],f["client"+b])):void 0===e?v.css(c,d,g):v.style(c,
d,e,g)},c,j?e:void 0,j,null)}})});v.fn.extend({bind:function(b,c,d){return this.on(b,null,c,d)},unbind:function(b,c){return this.off(b,null,c)},delegate:function(b,c,d,e){return this.on(c,b,d,e)},undelegate:function(b,c,d){return 1===arguments.length?this.off(b,"**"):this.off(c,b||"**",d)}});v.fn.size=function(){return this.length};v.fn.andSelf=v.fn.addBack;"function"==typeof define&&define.amd&&define("jquery",[],function(){return v});var td=b.jQuery,$c=b.$;return v.noConflict=function(c){return b.$===
v&&(b.$=$c),c&&b.jQuery===v&&(b.jQuery=td),v},c||(b.jQuery=b.$=v),v});
(function(b){"function"==typeof define&&define.amd?define(["jquery"],b):b(jQuery)})(function(b){function c(c,e){var f,g,h,q=c.nodeName.toLowerCase();return"area"===q?(f=c.parentNode,g=f.name,c.href&&g&&"map"===f.nodeName.toLowerCase()?(h=b("img[usemap='#"+g+"']")[0],!!h&&d(h)):!1):(/^(input|select|textarea|button|object)$/.test(q)?!c.disabled:"a"===q?c.href||e:e)&&d(c)}function d(c){return b.expr.filters.visible(c)&&!b(c).parents().addBack().filter(function(){return"hidden"===b.css(this,"visibility")}).length}
b.ui=b.ui||{};b.extend(b.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});b.fn.extend({scrollParent:function(c){var d=this.css("position"),e="absolute"===d,f=c?/(auto|scroll|hidden)/:/(auto|scroll)/,c=this.parents().filter(function(){var c=b(this);return e&&"static"===c.css("position")?!1:f.test(c.css("overflow")+c.css("overflow-y")+c.css("overflow-x"))}).eq(0);return"fixed"!==
d&&c.length?c:b(this[0].ownerDocument||document)},uniqueId:function(){var b=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++b)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&b(this).removeAttr("id")})}});b.extend(b.expr[":"],{data:b.expr.createPseudo?b.expr.createPseudo(function(c){return function(d){return!!b.data(d,c)}}):function(c,d,e){return!!b.data(c,e[3])},focusable:function(d){return c(d,!isNaN(b.attr(d,"tabindex")))},
tabbable:function(d){var e=b.attr(d,"tabindex"),f=isNaN(e);return(f||0<=e)&&c(d,!f)}});b("<a>").outerWidth(1).jquery||b.each(["Width","Height"],function(c,d){function e(c,d,j,g){return b.each(f,function(){d-=parseFloat(b.css(c,"padding"+this))||0;j&&(d-=parseFloat(b.css(c,"border"+this+"Width"))||0);g&&(d-=parseFloat(b.css(c,"margin"+this))||0)}),d}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:b.fn.innerWidth,innerHeight:b.fn.innerHeight,outerWidth:b.fn.outerWidth,
outerHeight:b.fn.outerHeight};b.fn["inner"+d]=function(c){return void 0===c?h["inner"+d].call(this):this.each(function(){b(this).css(g,e(this,c)+"px")})};b.fn["outer"+d]=function(c,f){return"number"!=typeof c?h["outer"+d].call(this,c):this.each(function(){b(this).css(g,e(this,c,!0,f)+"px")})}});b.fn.addBack||(b.fn.addBack=function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))});b("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(b.fn.removeData=function(c){return function(d){return arguments.length?
c.call(this,b.camelCase(d)):c.call(this)}}(b.fn.removeData));b.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());b.fn.extend({focus:function(c){return function(d,e){return"number"==typeof d?this.each(function(){var c=this;setTimeout(function(){b(c).focus();e&&e.call(c)},d)}):c.apply(this,arguments)}}(b.fn.focus),disableSelection:function(){var b="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(b+".ui-disableSelection",function(b){b.preventDefault()})}}(),
enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(c){if(void 0!==c)return this.css("zIndex",c);if(this.length)for(var d,e,c=b(this[0]);c.length&&c[0]!==document;){if(d=c.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(c.css("zIndex"),10),!isNaN(e)&&0!==e))return e;c=c.parent()}return 0}});b.ui.plugin={add:function(c,d,e){var f,c=b.ui[c].prototype;for(f in e)c.plugins[f]=c.plugins[f]||[],c.plugins[f].push([d,e[f]])},call:function(b,c,
d,e){if((c=b.plugins[c])&&(e||b.element[0].parentNode&&11!==b.element[0].parentNode.nodeType))for(e=0;c.length>e;e++)b.options[c[e][0]]&&c[e][1].apply(b.element,d)}};var e=0,f=Array.prototype.slice;b.cleanData=function(c){return function(d){var e,f,g;for(g=0;null!=(f=d[g]);g++)try{(e=b._data(f,"events"))&&e.remove&&b(f).triggerHandler("remove")}catch(h){}c(d)}}(b.cleanData);b.widget=function(c,d,e){var f,g,h,p,s={},r=c.split(".")[0];return c=c.split(".")[1],f=r+"-"+c,e||(e=d,d=b.Widget),b.expr[":"][f.toLowerCase()]=
function(c){return!!b.data(c,f)},b[r]=b[r]||{},g=b[r][c],h=b[r][c]=function(b,c){return this._createWidget?(arguments.length&&this._createWidget(b,c),void 0):new h(b,c)},b.extend(h,g,{version:e.version,_proto:b.extend({},e),_childConstructors:[]}),p=new d,p.options=b.widget.extend({},p.options),b.each(e,function(c,e){return b.isFunction(e)?(s[c]=function(){var b=function(){return d.prototype[c].apply(this,arguments)},f=function(b){return d.prototype[c].apply(this,b)};return function(){var c,d=this._super,
j=this._superApply;return this._super=b,this._superApply=f,c=e.apply(this,arguments),this._super=d,this._superApply=j,c}}(),void 0):(s[c]=e,void 0)}),h.prototype=b.widget.extend(p,{widgetEventPrefix:g?p.widgetEventPrefix||c:c},s,{constructor:h,namespace:r,widgetName:c,widgetFullName:f}),g?(b.each(g._childConstructors,function(c,d){var e=d.prototype;b.widget(e.namespace+"."+e.widgetName,h,d._proto)}),delete g._childConstructors):d._childConstructors.push(h),b.widget.bridge(c,h),h};b.widget.extend=
function(c){for(var d,e,g=f.call(arguments,1),h=0,q=g.length;q>h;h++)for(d in g[h])e=g[h][d],g[h].hasOwnProperty(d)&&void 0!==e&&(c[d]=b.isPlainObject(e)?b.isPlainObject(c[d])?b.widget.extend({},c[d],e):b.widget.extend({},e):e);return c};b.widget.bridge=function(c,d){var e=d.prototype.widgetFullName||c;b.fn[c]=function(g){var h="string"==typeof g,q=f.call(arguments,1),p=this;return h?this.each(function(){var d,f=b.data(this,e);return"instance"===g?(p=f,!1):f?b.isFunction(f[g])&&"_"!==g.charAt(0)?
(d=f[g].apply(f,q),d!==f&&void 0!==d?(p=d&&d.jquery?p.pushStack(d.get()):d,!1):void 0):b.error("no such method '"+g+"' for "+c+" widget instance"):b.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):(q.length&&(g=b.widget.extend.apply(null,[g].concat(q))),this.each(function(){var c=b.data(this,e);c?(c.option(g||{}),c._init&&c._init()):b.data(this,e,new d(g,this))})),p}};b.Widget=function(){};b.Widget._childConstructors=[];b.Widget.prototype={widgetName:"widget",
widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(c,d){d=b(d||this.defaultElement||this)[0];this.element=b(d);this.uuid=e++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=b();this.hoverable=b();this.focusable=b();d!==this&&(b.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(b){b.target===d&&this.destroy()}}),this.document=b(d.style?d.ownerDocument:d.document||d),this.window=b(this.document[0].defaultView||
this.document[0].parentWindow));this.options=b.widget.extend({},this.options,this._getCreateOptions(),c);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:b.noop,_getCreateEventData:b.noop,_create:b.noop,_init:b.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(b.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+
"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:b.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return b.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){f=h[c]=b.widget.extend({},this.options[c]);for(g=0;e.length-1>g;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),1===arguments.length)return void 0===
f[c]?null:f[c];f[c]=d}else{if(1===arguments.length)return void 0===this.options[c]?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(b){for(var c in b)this._setOption(c,b[c]);return this},_setOption:function(b,c){return this.options[b]=c,"disabled"===b&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!c),c&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},
disable:function(){return this._setOptions({disabled:!0})},_on:function(c,d,e){var f,g=this;"boolean"!=typeof c&&(e=d,d=c,c=!1);e?(d=f=b(d),this.bindings=this.bindings.add(d)):(e=d,d=this.element,f=this.widget());b.each(e,function(e,h){function l(){return c||!0!==g.options.disabled&&!b(this).hasClass("ui-state-disabled")?("string"==typeof h?g[h]:h).apply(g,arguments):void 0}"string"!=typeof h&&(l.guid=h.guid=h.guid||l.guid||b.guid++);var r=e.match(/^([\w:-]*)\s*(.*)$/),o=r[1]+g.eventNamespace;(r=
r[2])?f.delegate(r,o,l):d.bind(o,l)})},_off:function(c,d){d=(d||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;c.unbind(d).undelegate(d);this.bindings=b(this.bindings.not(c).get());this.focusable=b(this.focusable.not(c).get());this.hoverable=b(this.hoverable.not(c).get())},_delay:function(b,c){var d=this;return setTimeout(function(){return("string"==typeof b?d[b]:b).apply(d,arguments)},c||0)},_hoverable:function(c){this.hoverable=this.hoverable.add(c);this._on(c,{mouseenter:function(c){b(c.currentTarget).addClass("ui-state-hover")},
mouseleave:function(c){b(c.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(c){this.focusable=this.focusable.add(c);this._on(c,{focusin:function(c){b(c.currentTarget).addClass("ui-state-focus")},focusout:function(c){b(c.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(c,d,e){var f,g=this.options[c];if(e=e||{},d=b.Event(d),d.type=(c===this.widgetEventPrefix?c:this.widgetEventPrefix+c).toLowerCase(),d.target=this.element[0],c=d.originalEvent)for(f in c)f in d||
(d[f]=c[f]);return this.element.trigger(d,e),!(b.isFunction(g)&&!1===g.apply(this.element[0],[d].concat(e))||d.isDefaultPrevented())}};b.each({show:"fadeIn",hide:"fadeOut"},function(c,d){b.Widget.prototype["_"+c]=function(e,f,g){"string"==typeof f&&(f={effect:f});var h,p=f?!0===f||"number"==typeof f?d:f.effect||d:c,f=f||{};"number"==typeof f&&(f={duration:f});h=!b.isEmptyObject(f);f.complete=g;f.delay&&e.delay(f.delay);h&&b.effects&&b.effects.effect[p]?e[c](f):p!==c&&e[p]?e[p](f.duration,f.easing,
g):e.queue(function(d){b(this)[c]();g&&g.call(e[0]);d()})}});b.widget;var g=!1;b(document).mouseup(function(){g=!1});b.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var c=this;this.element.bind("mousedown."+this.widgetName,function(b){return c._mouseDown(b)}).bind("click."+this.widgetName,function(d){return!0===b.data(d.target,c.widgetName+".preventClickEvent")?(b.removeData(d.target,c.widgetName+".preventClickEvent"),
d.stopImmediatePropagation(),!1):void 0});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!g){this._mouseMoved=!1;this._mouseStarted&&this._mouseUp(c);this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?b(c.target).closest(this.options.cancel).length:
!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=!1!==this._mouseStart(c),!this._mouseStarted)?(c.preventDefault(),!0):(!0===b.data(c.target,this.widgetName+".preventClickEvent")&&b.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(b){return d._mouseMove(b)},
this._mouseUpDelegate=function(b){return d._mouseUp(b)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),g=!0,!0)):!0}},_mouseMove:function(c){return this._mouseMoved&&(b.ui.ie&&(!document.documentMode||9>document.documentMode)&&!c.button||!c.which)?this._mouseUp(c):((c.which||c.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(c),c.preventDefault()):(this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&
(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,c),this._mouseStarted?this._mouseDrag(c):this._mouseUp(c)),!this._mouseStarted))},_mouseUp:function(c){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,c.target===this._mouseDownEvent.target&&b.data(c.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(c)),g=!1,!1},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-
b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});(function(){function c(b,d,e){return[parseFloat(b[0])*(w.test(b[0])?d/100:1),parseFloat(b[1])*(w.test(b[1])?e/100:1)]}function d(c,e){return parseInt(b.css(c,e),10)||0}function e(c){var d=c[0];return 9===d.nodeType?{width:c.width(),height:c.height(),offset:{top:0,
left:0}}:b.isWindow(d)?{width:c.width(),height:c.height(),offset:{top:c.scrollTop(),left:c.scrollLeft()}}:d.preventDefault?{width:0,height:0,offset:{top:d.pageY,left:d.pageX}}:{width:c.outerWidth(),height:c.outerHeight(),offset:c.offset()}}b.ui=b.ui||{};var f,g,h=Math.max,p=Math.abs,s=Math.round,r=/left|center|right/,o=/top|center|bottom/,t=/[\+\-]\d+(\.[\d]+)?%?/,u=/^\w+/,w=/%$/,z=b.fn.position;b.position={scrollbarWidth:function(){if(void 0!==f)return f;var c,d,e=b("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),
j=e.children()[0];return b("body").append(e),c=j.offsetWidth,e.css("overflow","scroll"),d=j.offsetWidth,c===d&&(d=e[0].clientWidth),e.remove(),f=c-d},getScrollInfo:function(c){var d=c.isWindow||c.isDocument?"":c.element.css("overflow-x"),e=c.isWindow||c.isDocument?"":c.element.css("overflow-y"),d="scroll"===d||"auto"===d&&c.width<c.element[0].scrollWidth;return{width:"scroll"===e||"auto"===e&&c.height<c.element[0].scrollHeight?b.position.scrollbarWidth():0,height:d?b.position.scrollbarWidth():0}},
getWithinInfo:function(c){var c=b(c||window),d=b.isWindow(c[0]),e=!!c[0]&&9===c[0].nodeType;return{element:c,isWindow:d,isDocument:e,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d||e?c.width():c.outerWidth(),height:d||e?c.height():c.outerHeight()}}};b.fn.position=function(f){if(!f||!f.of)return z.apply(this,arguments);var f=b.extend({},f),m,w,H,K,P,T,D=b(f.of),F=b.position.getWithinInfo(f.within),I=b.position.getScrollInfo(F),J=(f.collision||"flip").split(" "),
N={};return T=e(D),D[0].preventDefault&&(f.at="left top"),w=T.width,H=T.height,K=T.offset,P=b.extend({},K),b.each(["my","at"],function(){var b,c,d=(f[this]||"").split(" ");1===d.length&&(d=r.test(d[0])?d.concat(["center"]):o.test(d[0])?["center"].concat(d):["center","center"]);d[0]=r.test(d[0])?d[0]:"center";d[1]=o.test(d[1])?d[1]:"center";b=t.exec(d[0]);c=t.exec(d[1]);N[this]=[b?b[0]:0,c?c[0]:0];f[this]=[u.exec(d[0])[0],u.exec(d[1])[0]]}),1===J.length&&(J[1]=J[0]),"right"===f.at[0]?P.left+=w:"center"===
f.at[0]&&(P.left+=w/2),"bottom"===f.at[1]?P.top+=H:"center"===f.at[1]&&(P.top+=H/2),m=c(N.at,w,H),P.left+=m[0],P.top+=m[1],this.each(function(){var e,l,o=b(this),u=o.outerWidth(),t=o.outerHeight(),r=d(this,"marginLeft"),z=d(this,"marginTop"),X=u+r+d(this,"marginRight")+I.width,aa=t+z+d(this,"marginBottom")+I.height,Y=b.extend({},P),ba=c(N.my,o.outerWidth(),o.outerHeight());"right"===f.my[0]?Y.left-=u:"center"===f.my[0]&&(Y.left-=u/2);"bottom"===f.my[1]?Y.top-=t:"center"===f.my[1]&&(Y.top-=t/2);Y.left+=
ba[0];Y.top+=ba[1];g||(Y.left=s(Y.left),Y.top=s(Y.top));e={marginLeft:r,marginTop:z};b.each(["left","top"],function(c,d){b.ui.position[J[c]]&&b.ui.position[J[c]][d](Y,{targetWidth:w,targetHeight:H,elemWidth:u,elemHeight:t,collisionPosition:e,collisionWidth:X,collisionHeight:aa,offset:[m[0]+ba[0],m[1]+ba[1]],my:f.my,at:f.at,within:F,elem:o})});f.using&&(l=function(b){var c=K.left-Y.left,d=c+w-u,e=K.top-Y.top,j=e+H-t,g={target:{element:D,left:K.left,top:K.top,width:w,height:H},element:{element:o,left:Y.left,
top:Y.top,width:u,height:t},horizontal:0>d?"left":0<c?"right":"center",vertical:0>j?"top":0<e?"bottom":"middle"};u>w&&w>p(c+d)&&(g.horizontal="center");t>H&&H>p(e+j)&&(g.vertical="middle");g.important=h(p(c),p(d))>h(p(e),p(j))?"horizontal":"vertical";f.using.call(this,b,g)});o.offset(b.extend(Y,{using:l}))})};b.ui.position={fit:{left:function(b,c){var d,e=c.within,f=e.isWindow?e.scrollLeft:e.offset.left,e=e.width,j=b.left-c.collisionPosition.marginLeft,g=f-j,k=j+c.collisionWidth-e-f;c.collisionWidth>
e?0<g&&0>=k?(d=b.left+g+c.collisionWidth-e-f,b.left+=g-d):b.left=0<k&&0>=g?f:g>k?f+e-c.collisionWidth:f:0<g?b.left+=g:0<k?b.left-=k:b.left=h(b.left-j,b.left)},top:function(b,c){var d,e=c.within,e=e.isWindow?e.scrollTop:e.offset.top,f=c.within.height,j=b.top-c.collisionPosition.marginTop,g=e-j,k=j+c.collisionHeight-f-e;c.collisionHeight>f?0<g&&0>=k?(d=b.top+g+c.collisionHeight-f-e,b.top+=g-d):b.top=0<k&&0>=g?e:g>k?e+f-c.collisionHeight:e:0<g?b.top+=g:0<k?b.top-=k:b.top=h(b.top-j,b.top)}},flip:{left:function(b,
c){var d,e,f=c.within,j=f.offset.left+f.scrollLeft,g=f.width,f=f.isWindow?f.scrollLeft:f.offset.left,k=b.left-c.collisionPosition.marginLeft,h=k-f,k=k+c.collisionWidth-g-f,l="left"===c.my[0]?-c.elemWidth:"right"===c.my[0]?c.elemWidth:0,m="left"===c.at[0]?c.targetWidth:"right"===c.at[0]?-c.targetWidth:0,n=-2*c.offset[0];0>h?(d=b.left+l+m+n+c.collisionWidth-g-j,(0>d||p(h)>d)&&(b.left+=l+m+n)):0<k&&(e=b.left-c.collisionPosition.marginLeft+l+m+n-f,(0<e||k>p(e))&&(b.left+=l+m+n))},top:function(b,c){var d,
e,f=c.within,j=f.offset.top+f.scrollTop,g=f.height,f=f.isWindow?f.scrollTop:f.offset.top,k=b.top-c.collisionPosition.marginTop,h=k-f,k=k+c.collisionHeight-g-f,l="top"===c.my[1]?-c.elemHeight:"bottom"===c.my[1]?c.elemHeight:0,m="top"===c.at[1]?c.targetHeight:"bottom"===c.at[1]?-c.targetHeight:0,n=-2*c.offset[1];0>h?(e=b.top+l+m+n+c.collisionHeight-g-j,(0>e||p(h)>e)&&(b.top+=l+m+n)):0<k&&(d=b.top-c.collisionPosition.marginTop+l+m+n-f,(0<d||k>p(d))&&(b.top+=l+m+n))}},flipfit:{left:function(){b.ui.position.flip.left.apply(this,
arguments);b.ui.position.fit.left.apply(this,arguments)},top:function(){b.ui.position.flip.top.apply(this,arguments);b.ui.position.fit.top.apply(this,arguments)}}};(function(){var c,d,e,f,j=document.getElementsByTagName("body")[0];e=document.createElement("div");c=document.createElement(j?"div":"body");d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};j&&b.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in d)c.style[f]=d[f];c.appendChild(e);d=j||document.documentElement;
d.insertBefore(c,d.firstChild);e.style.cssText="position: absolute; left: 10.7432222px;";e=b(e).offset().left;g=10<e&&11>e;c.innerHTML="";d.removeChild(c)})()})();b.ui.position;b.widget("ui.draggable",b.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,
scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative();this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._setHandleClassName();this._mouseInit()},_setOption:function(b,c){this._super(b,c);"handle"===b&&(this._removeHandleClassName(),this._setHandleClassName())},
_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(c){var d=this.options;return this._blurActiveElement(c),this.helper||d.disabled||0<b(c.target).closest(".ui-resizable-handle").length?!1:(this.handle=this._getHandle(c),this.handle?(this._blockFrames(!0===d.iframeFix?
"iframe":d.iframeFix),!0):!1)},_blockFrames:function(c){this.iframeBlocks=this.document.find(c).map(function(){var c=b(this);return b("<div>").css("position","absolute").appendTo(c.parent()).outerWidth(c.outerWidth()).outerHeight(c.outerHeight()).offset(c.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(c){var d=this.document[0];if(this.handleElement.is(c.target))try{d.activeElement&&"body"!==d.activeElement.nodeName.toLowerCase()&&
b(d.activeElement).blur()}catch(e){}},_mouseStart:function(c){var d=this.options;return this.helper=this._createHelper(c),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),b.ui.ddmanager&&(b.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===b(this).css("position")}).length,
this.positionAbs=this.element.offset(),this._refreshOffsets(c),this.originalPosition=this.position=this._generatePosition(c,!1),this.originalPageX=c.pageX,this.originalPageY=c.pageY,d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt),this._setContainment(),!1===this._trigger("start",c)?(this._clear(),!1):(this._cacheHelperProportions(),b.ui.ddmanager&&!d.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,c),this._normalizeRightBottom(),this._mouseDrag(c,!0),b.ui.ddmanager&&b.ui.ddmanager.dragStart(this,
c),!0)},_refreshOffsets:function(b){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:b.pageX-this.offset.left,top:b.pageY-this.offset.top}},_mouseDrag:function(c,d){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(c,!0),this.positionAbs=this._convertPositionTo("absolute"),!d){var e=this._uiHash();
if(!1===this._trigger("drag",c,e))return this._mouseUp({}),!1;this.position=e.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",b.ui.ddmanager&&b.ui.ddmanager.drag(this,c),!1},_mouseStop:function(c){var d=this,e=!1;return b.ui.ddmanager&&!this.options.dropBehaviour&&(e=b.ui.ddmanager.drop(this,c)),this.dropped&&(e=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!e||"valid"===this.options.revert&&e||!0===this.options.revert||
b.isFunction(this.options.revert)&&this.options.revert.call(this.element,e)?b(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==d._trigger("stop",c)&&d._clear()}):!1!==this._trigger("stop",c)&&this._clear(),!1},_mouseUp:function(c){return this._unblockFrames(),b.ui.ddmanager&&b.ui.ddmanager.dragStop(this,c),this.handleElement.is(c.target)&&this.element.focus(),b.ui.mouse.prototype._mouseUp.call(this,c)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?
this._mouseUp({}):this._clear(),this},_getHandle:function(c){return this.options.handle?!!b(c.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(c){var d=this.options,e=b.isFunction(d.helper),c=e?b(d.helper.apply(this.element[0],
[c])):"clone"===d.helper?this.element.clone().removeAttr("id"):this.element;return c.parents("body").length||c.appendTo("parent"===d.appendTo?this.element[0].parentNode:d.appendTo),e&&c[0]===this.element[0]&&this._setPositionRelative(),c[0]===this.element[0]||/(fixed|absolute)/.test(c.css("position"))||c.css("position","absolute"),c},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(c){"string"==
typeof c&&(c=c.split(" "));b.isArray(c)&&(c={left:+c[0],top:+c[1]||0});"left"in c&&(this.offset.click.left=c.left+this.margins.left);"right"in c&&(this.offset.click.left=this.helperProportions.width-c.right+this.margins.left);"top"in c&&(this.offset.click.top=c.top+this.margins.top);"bottom"in c&&(this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top)},_isRootNode:function(b){return/(html|body)/i.test(b.tagName)||b===this.document[0]},_getParentOffset:function(){var c=this.offsetParent.offset(),
d=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==d&&b.contains(this.scrollParent[0],this.offsetParent[0])&&(c.left+=this.scrollParent.scrollLeft(),c.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(c={top:0,left:0}),{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var b=
this.element.position(),c=this._isRootNode(this.scrollParent[0]);return{top:b.top-(parseInt(this.helper.css("top"),10)||0)+(c?0:this.scrollParent.scrollTop()),left:b.left-(parseInt(this.helper.css("left"),10)||0)+(c?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||
0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var c,d,e,f=this.options,g=this.document[0];return this.relativeContainer=null,f.containment?"window"===f.containment?(this.containment=[b(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,b(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,b(window).scrollLeft()+b(window).width()-this.helperProportions.width-
this.margins.left,b(window).scrollTop()+(b(window).height()||g.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===f.containment?(this.containment=[0,0,b(g).width()-this.helperProportions.width-this.margins.left,(b(g).height()||g.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):f.containment.constructor===Array?(this.containment=f.containment,void 0):("parent"===f.containment&&(f.containment=this.helper[0].parentNode),
d=b(f.containment),e=d[0],e&&(c=/(scroll|auto)/.test(d.css("overflow")),this.containment=[(parseInt(d.css("borderLeftWidth"),10)||0)+(parseInt(d.css("paddingLeft"),10)||0),(parseInt(d.css("borderTopWidth"),10)||0)+(parseInt(d.css("paddingTop"),10)||0),(c?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(d.css("borderRightWidth"),10)||0)-(parseInt(d.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(c?Math.max(e.scrollHeight,e.offsetHeight):
e.offsetHeight)-(parseInt(d.css("borderBottomWidth"),10)||0)-(parseInt(d.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=d),void 0):(this.containment=null,void 0)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e=this._isRootNode(this.scrollParent[0]);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.offset.scroll.top:e?0:this.offset.scroll.top)*
d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.offset.scroll.left:e?0:this.offset.scroll.left)*d}},_generatePosition:function(b,c){var d,e,f,g,h=this.options,s=this._isRootNode(this.scrollParent[0]),r=b.pageX,o=b.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),c&&(this.containment&&(this.relativeContainer?(e=this.relativeContainer.offset(),d=[this.containment[0]+
e.left,this.containment[1]+e.top,this.containment[2]+e.left,this.containment[3]+e.top]):d=this.containment,b.pageX-this.offset.click.left<d[0]&&(r=d[0]+this.offset.click.left),b.pageY-this.offset.click.top<d[1]&&(o=d[1]+this.offset.click.top),b.pageX-this.offset.click.left>d[2]&&(r=d[2]+this.offset.click.left),b.pageY-this.offset.click.top>d[3]&&(o=d[3]+this.offset.click.top)),h.grid&&(f=h.grid[1]?this.originalPageY+Math.round((o-this.originalPageY)/h.grid[1])*h.grid[1]:this.originalPageY,o=d?f-this.offset.click.top>=
d[1]||f-this.offset.click.top>d[3]?f:f-this.offset.click.top>=d[1]?f-h.grid[1]:f+h.grid[1]:f,g=h.grid[0]?this.originalPageX+Math.round((r-this.originalPageX)/h.grid[0])*h.grid[0]:this.originalPageX,r=d?g-this.offset.click.left>=d[0]||g-this.offset.click.left>d[2]?g:g-this.offset.click.left>=d[0]?g-h.grid[0]:g+h.grid[0]:g),"y"===h.axis&&(r=this.originalPageX),"x"===h.axis&&(o=this.originalPageY)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?
-this.offset.scroll.top:s?0:this.offset.scroll.top),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1;this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&
"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto"));"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(c,d,e){return e=e||this._uiHash(),b.ui.plugin.call(this,c,[d,e,this],!0),/^(drag|start|stop)/.test(c)&&(this.positionAbs=this._convertPositionTo("absolute"),e.offset=this.positionAbs),b.Widget.prototype._trigger.call(this,c,d,e)},plugins:{},
_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});b.ui.plugin.add("draggable","connectToSortable",{start:function(c,d,e){var f=b.extend({},d,{item:e.element});e.sortables=[];b(e.options.connectToSortable).each(function(){var d=b(this).sortable("instance");d&&!d.options.disabled&&(e.sortables.push(d),d.refreshPositions(),d._trigger("activate",c,f))})},stop:function(c,d,e){var f=b.extend({},d,{item:e.element});e.cancelHelperRemoval=
!1;b.each(e.sortables,function(){this.isOver?(this.isOver=0,e.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(c),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",c,f))})},drag:function(c,d,e){b.each(e.sortables,function(){var f=!1,g=this;g.positionAbs=e.positionAbs;g.helperProportions=e.helperProportions;g.offset.click=
e.offset.click;g._intersectsWith(g.containerCache)&&(f=!0,b.each(e.sortables,function(){return this.positionAbs=e.positionAbs,this.helperProportions=e.helperProportions,this.offset.click=e.offset.click,this!==g&&this._intersectsWith(this.containerCache)&&b.contains(g.element[0],this.element[0])&&(f=!1),f}));f?(g.isOver||(g.isOver=1,e._parent=d.helper.parent(),g.currentItem=d.helper.appendTo(g.element).data("ui-sortable-item",!0),g.options._helper=g.options.helper,g.options.helper=function(){return d.helper[0]},
c.target=g.currentItem[0],g._mouseCapture(c,!0),g._mouseStart(c,!0,!0),g.offset.click.top=e.offset.click.top,g.offset.click.left=e.offset.click.left,g.offset.parent.left-=e.offset.parent.left-g.offset.parent.left,g.offset.parent.top-=e.offset.parent.top-g.offset.parent.top,e._trigger("toSortable",c),e.dropped=g.element,b.each(e.sortables,function(){this.refreshPositions()}),e.currentItem=e.element,g.fromOutside=e),g.currentItem&&(g._mouseDrag(c),d.position=g.position)):g.isOver&&(g.isOver=0,g.cancelHelperRemoval=
!0,g.options._revert=g.options.revert,g.options.revert=!1,g._trigger("out",c,g._uiHash(g)),g._mouseStop(c,!0),g.options.revert=g.options._revert,g.options.helper=g.options._helper,g.placeholder&&g.placeholder.remove(),d.helper.appendTo(e._parent),e._refreshOffsets(c),d.position=e._generatePosition(c,!0),e._trigger("fromSortable",c),e.dropped=!1,b.each(e.sortables,function(){this.refreshPositions()}))})}});b.ui.plugin.add("draggable","cursor",{start:function(c,d,e){c=b("body");e=e.options;c.css("cursor")&&
(e._cursor=c.css("cursor"));c.css("cursor",e.cursor)},stop:function(c,d,e){c=e.options;c._cursor&&b("body").css("cursor",c._cursor)}});b.ui.plugin.add("draggable","opacity",{start:function(c,d,e){c=b(d.helper);e=e.options;c.css("opacity")&&(e._opacity=c.css("opacity"));c.css("opacity",e.opacity)},stop:function(c,d,e){c=e.options;c._opacity&&b(d.helper).css("opacity",c._opacity)}});b.ui.plugin.add("draggable","scroll",{start:function(b,c,d){d.scrollParentNotHidden||(d.scrollParentNotHidden=d.helper.scrollParent(!1));
d.scrollParentNotHidden[0]!==d.document[0]&&"HTML"!==d.scrollParentNotHidden[0].tagName&&(d.overflowOffset=d.scrollParentNotHidden.offset())},drag:function(c,d,e){var d=e.options,f=!1,g=e.scrollParentNotHidden[0],h=e.document[0];g!==h&&"HTML"!==g.tagName?(d.axis&&"x"===d.axis||(e.overflowOffset.top+g.offsetHeight-c.pageY<d.scrollSensitivity?g.scrollTop=f=g.scrollTop+d.scrollSpeed:c.pageY-e.overflowOffset.top<d.scrollSensitivity&&(g.scrollTop=f=g.scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(e.overflowOffset.left+
g.offsetWidth-c.pageX<d.scrollSensitivity?g.scrollLeft=f=g.scrollLeft+d.scrollSpeed:c.pageX-e.overflowOffset.left<d.scrollSensitivity&&(g.scrollLeft=f=g.scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(c.pageY-b(h).scrollTop()<d.scrollSensitivity?f=b(h).scrollTop(b(h).scrollTop()-d.scrollSpeed):b(window).height()-(c.pageY-b(h).scrollTop())<d.scrollSensitivity&&(f=b(h).scrollTop(b(h).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(c.pageX-b(h).scrollLeft()<d.scrollSensitivity?f=b(h).scrollLeft(b(h).scrollLeft()-
d.scrollSpeed):b(window).width()-(c.pageX-b(h).scrollLeft())<d.scrollSensitivity&&(f=b(h).scrollLeft(b(h).scrollLeft()+d.scrollSpeed))));!1!==f&&b.ui.ddmanager&&!d.dropBehaviour&&b.ui.ddmanager.prepareOffsets(e,c)}});b.ui.plugin.add("draggable","snap",{start:function(c,d,e){c=e.options;e.snapElements=[];b(c.snap.constructor!==String?c.snap.items||":data(ui-draggable)":c.snap).each(function(){var c=b(this),d=c.offset();this!==e.element[0]&&e.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),
top:d.top,left:d.left})})},drag:function(c,d,e){var f,g,h,p,s,r,o,t,u,w,z=e.options,A=z.snapTolerance,C=d.offset.left,G=C+e.helperProportions.width,H=d.offset.top,K=H+e.helperProportions.height;for(u=e.snapElements.length-1;0<=u;u--)s=e.snapElements[u].left-e.margins.left,r=s+e.snapElements[u].width,o=e.snapElements[u].top-e.margins.top,t=o+e.snapElements[u].height,s-A>G||C>r+A||o-A>K||H>t+A||!b.contains(e.snapElements[u].item.ownerDocument,e.snapElements[u].item)?(e.snapElements[u].snapping&&e.options.snap.release&&
e.options.snap.release.call(e.element,c,b.extend(e._uiHash(),{snapItem:e.snapElements[u].item})),e.snapElements[u].snapping=!1):("inner"!==z.snapMode&&(f=A>=Math.abs(o-K),g=A>=Math.abs(t-H),h=A>=Math.abs(s-G),p=A>=Math.abs(r-C),f&&(d.position.top=e._convertPositionTo("relative",{top:o-e.helperProportions.height,left:0}).top),g&&(d.position.top=e._convertPositionTo("relative",{top:t,left:0}).top),h&&(d.position.left=e._convertPositionTo("relative",{top:0,left:s-e.helperProportions.width}).left),p&&
(d.position.left=e._convertPositionTo("relative",{top:0,left:r}).left)),w=f||g||h||p,"outer"!==z.snapMode&&(f=A>=Math.abs(o-H),g=A>=Math.abs(t-K),h=A>=Math.abs(s-C),p=A>=Math.abs(r-G),f&&(d.position.top=e._convertPositionTo("relative",{top:o,left:0}).top),g&&(d.position.top=e._convertPositionTo("relative",{top:t-e.helperProportions.height,left:0}).top),h&&(d.position.left=e._convertPositionTo("relative",{top:0,left:s}).left),p&&(d.position.left=e._convertPositionTo("relative",{top:0,left:r-e.helperProportions.width}).left)),
!e.snapElements[u].snapping&&(f||g||h||p||w)&&e.options.snap.snap&&e.options.snap.snap.call(e.element,c,b.extend(e._uiHash(),{snapItem:e.snapElements[u].item})),e.snapElements[u].snapping=f||g||h||p||w)}});b.ui.plugin.add("draggable","stack",{start:function(c,d,e){var f,c=b.makeArray(b(e.options.stack)).sort(function(c,d){return(parseInt(b(c).css("zIndex"),10)||0)-(parseInt(b(d).css("zIndex"),10)||0)});c.length&&(f=parseInt(b(c[0]).css("zIndex"),10)||0,b(c).each(function(c){b(this).css("zIndex",f+
c)}),this.css("zIndex",f+c.length))}});b.ui.plugin.add("draggable","zIndex",{start:function(c,d,e){c=b(d.helper);e=e.options;c.css("zIndex")&&(e._zIndex=c.css("zIndex"));c.css("zIndex",e.zIndex)},stop:function(c,d,e){c=e.options;c._zIndex&&b(d.helper).css("zIndex",c._zIndex)}});b.ui.draggable;b.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,
drop:null,out:null,over:null},_create:function(){var c,d=this.options,e=d.accept;this.isover=!1;this.isout=!0;this.accept=b.isFunction(e)?e:function(b){return b.is(e)};this.proportions=function(){return arguments.length?(c=arguments[0],void 0):c?c:c={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}};this._addToManager(d.scope);d.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(c){b.ui.ddmanager.droppables[c]=b.ui.ddmanager.droppables[c]||[];b.ui.ddmanager.droppables[c].push(this)},
_splice:function(b){for(var c=0;b.length>c;c++)b[c]===this&&b.splice(c,1)},_destroy:function(){this._splice(b.ui.ddmanager.droppables[this.options.scope]);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(c,d){"accept"===c?this.accept=b.isFunction(d)?d:function(b){return b.is(d)}:"scope"===c&&(this._splice(b.ui.ddmanager.droppables[this.options.scope]),this._addToManager(d));this._super(c,d)},_activate:function(c){var d=b.ui.ddmanager.current;this.options.activeClass&&
this.element.addClass(this.options.activeClass);d&&this._trigger("activate",c,this.ui(d))},_deactivate:function(c){var d=b.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);d&&this._trigger("deactivate",c,this.ui(d))},_over:function(c){var d=b.ui.ddmanager.current;d&&(d.currentItem||d.element)[0]!==this.element[0]&&this.accept.call(this.element[0],d.currentItem||d.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",
c,this.ui(d)))},_out:function(c){var d=b.ui.ddmanager.current;d&&(d.currentItem||d.element)[0]!==this.element[0]&&this.accept.call(this.element[0],d.currentItem||d.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",c,this.ui(d)))},_drop:function(c,d){var e=d||b.ui.ddmanager.current,f=!1;return e&&(e.currentItem||e.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var d=b(this).droppable("instance");
return d.options.greedy&&!d.options.disabled&&d.options.scope===e.options.scope&&d.accept.call(d.element[0],e.currentItem||e.element)&&b.ui.intersect(e,b.extend(d,{offset:d.element.offset()}),d.options.tolerance,c)?(f=!0,!1):void 0}),f?!1:this.accept.call(this.element[0],e.currentItem||e.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",c,this.ui(e)),this.element):!1):
!1},ui:function(b){return{draggable:b.currentItem||b.element,helper:b.helper,position:b.position,offset:b.positionAbs}}});b.ui.intersect=function(){return function(b,c,d,e){if(!c.offset)return!1;var f=(b.positionAbs||b.position.absolute).left+b.margins.left,g=(b.positionAbs||b.position.absolute).top+b.margins.top,h=f+b.helperProportions.width,s=g+b.helperProportions.height,r=c.offset.left,o=c.offset.top,t=r+c.proportions().width,u=o+c.proportions().height;switch(d){case "fit":return f>=r&&t>=h&&g>=
o&&u>=s;case "intersect":return f+b.helperProportions.width/2>r&&t>h-b.helperProportions.width/2&&g+b.helperProportions.height/2>o&&u>s-b.helperProportions.height/2;case "pointer":b=e.pageY;d=c.proportions().height;if(o=b>=o&&o+d>b)e=e.pageX,c=c.proportions().width,o=e>=r&&r+c>e;return o;case "touch":return(g>=o&&u>=g||s>=o&&u>=s||o>g&&s>u)&&(f>=r&&t>=f||h>=r&&t>=h||r>f&&h>t);default:return!1}}}();b.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(c,d){var e,f,g=b.ui.ddmanager.droppables[c.options.scope]||
[],h=d?d.type:null,p=(c.currentItem||c.element).find(":data(ui-droppable)").addBack();e=0;a:for(;g.length>e;e++)if(!(g[e].options.disabled||c&&!g[e].accept.call(g[e].element[0],c.currentItem||c.element))){for(f=0;p.length>f;f++)if(p[f]===g[e].element[0]){g[e].proportions().height=0;continue a}g[e].visible="none"!==g[e].element.css("display");g[e].visible&&("mousedown"===h&&g[e]._activate.call(g[e],d),g[e].offset=g[e].element.offset(),g[e].proportions({width:g[e].element[0].offsetWidth,height:g[e].element[0].offsetHeight}))}},
drop:function(c,d){var e=!1;return b.each((b.ui.ddmanager.droppables[c.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&b.ui.intersect(c,this,this.options.tolerance,d)&&(e=this._drop.call(this,d)||e),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,d)))}),e},dragStart:function(c,d){c.element.parentsUntil("body").bind("scroll.droppable",function(){c.options.refreshPositions||
b.ui.ddmanager.prepareOffsets(c,d)})},drag:function(c,d){c.options.refreshPositions&&b.ui.ddmanager.prepareOffsets(c,d);b.each(b.ui.ddmanager.droppables[c.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var e,f,g,h=b.ui.intersect(c,this,this.options.tolerance,d);(h=!h&&this.isover?"isout":h&&!this.isover?"isover":null)&&(this.options.greedy&&(f=this.options.scope,g=this.element.parents(":data(ui-droppable)").filter(function(){return b(this).droppable("instance").options.scope===
f}),g.length&&(e=b(g[0]).droppable("instance"),e.greedyChild="isover"===h)),e&&"isover"===h&&(e.isover=!1,e.isout=!0,e._out.call(e,d)),this[h]=!0,this["isout"===h?"isover":"isout"]=!1,this["isover"===h?"_over":"_out"].call(this,d),e&&"isout"===h&&(e.isout=!1,e.isover=!0,e._over.call(e,d)))}})},dragStop:function(c,d){c.element.parentsUntil("body").unbind("scroll.droppable");c.options.refreshPositions||b.ui.ddmanager.prepareOffsets(c,d)}};b.ui.droppable;b.widget("ui.resizable",b.ui.mouse,{version:"1.11.4",
widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(b){return parseInt(b,10)||0},_isNumber:function(b){return!isNaN(parseInt(b,10))},_hasScroll:function(c,d){if("hidden"===b(c).css("overflow"))return!1;var e=d&&"left"===d?"scrollLeft":"scrollTop";return 0<
c[e]?!0:(c[e]=1,c[e]=0,!1)},_create:function(){var c,d,e,f,g,h=this,p=this.options;if(this.element.addClass("ui-resizable"),b.extend(this,{_aspectRatio:!!p.aspectRatio,aspectRatio:p.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:p.helper||p.ghost||p.animate?p.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(b("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),
width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,
marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=p.handles||(b(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",
se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=b(),this.handles.constructor===String){"all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");c=this.handles.split(",");this.handles={};for(d=0;c.length>d;d++)e=b.trim(c[d]),g="ui-resizable-"+e,f=b("<div class='ui-resizable-handle "+g+"'></div>"),f.css({zIndex:p.zIndex}),"se"===e&&f.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[e]=".ui-resizable-"+e,this.element.append(f)}this._renderAxis=
function(c){var d,e,f,g,c=c||this.element;for(d in this.handles)this.handles[d].constructor===String?this.handles[d]=this.element.children(this.handles[d]).first().show():(this.handles[d].jquery||this.handles[d].nodeType)&&(this.handles[d]=b(this.handles[d]),this._on(this.handles[d],{mousedown:h._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(e=b(this.handles[d],this.element),g=/sw|ne|nw|se|n|s/.test(d)?e.outerHeight():e.outerWidth(),
f=["padding",/ne|nw|n/.test(d)?"Top":/se|sw|s/.test(d)?"Bottom":/^e$/.test(d)?"Right":"Left"].join(""),c.css(f,g),this._proportionallyResize()),this._handles=this._handles.add(this.handles[d])};this._renderAxis(this.element);this._handles=this._handles.add(this.element.find(".ui-resizable-handle"));this._handles.disableSelection();this._handles.mouseover(function(){h.resizing||(this.className&&(f=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),h.axis=f&&f[1]?f[1]:"se")});p.autoHide&&
(this._handles.hide(),b(this.element).addClass("ui-resizable-autohide").mouseenter(function(){p.disabled||(b(this).removeClass("ui-resizable-autohide"),h._handles.show())}).mouseleave(function(){p.disabled||h.resizing||(b(this).addClass("ui-resizable-autohide"),h._handles.hide())}));this._mouseInit()},_destroy:function(){this._mouseDestroy();var c,d=function(c){b(c).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};
return this.elementIsWrapper&&(d(this.element),c=this.element,this.originalElement.css({position:c.css("position"),width:c.outerWidth(),height:c.outerHeight(),top:c.css("top"),left:c.css("left")}).insertAfter(c),c.remove()),this.originalElement.css("resize",this.originalResizeStyle),d(this.originalElement),this},_mouseCapture:function(c){var d,e,f=!1;for(d in this.handles)e=b(this.handles[d])[0],(e===c.target||b.contains(e,c.target))&&(f=!0);return!this.options.disabled&&f},_mouseStart:function(c){var d,
e,f,g=this.options,h=this.element;return this.resizing=!0,this._renderProxy(),d=this._num(this.helper.css("left")),e=this._num(this.helper.css("top")),g.containment&&(d+=b(g.containment).scrollLeft()||0,e+=b(g.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:d,top:e},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:h.width(),height:h.height()},this.originalSize=this._helper?{width:h.outerWidth(),height:h.outerHeight()}:{width:h.width(),
height:h.height()},this.sizeDiff={width:h.outerWidth()-h.width(),height:h.outerHeight()-h.height()},this.originalPosition={left:d,top:e},this.originalMousePosition={left:c.pageX,top:c.pageY},this.aspectRatio="number"==typeof g.aspectRatio?g.aspectRatio:this.originalSize.width/this.originalSize.height||1,f=b(".ui-resizable-"+this.axis).css("cursor"),b("body").css("cursor","auto"===f?this.axis+"-resize":f),h.addClass("ui-resizable-resizing"),this._propagate("start",c),!0},_mouseDrag:function(c){var d,
e,f=this.originalMousePosition,g=c.pageX-f.left||0,f=c.pageY-f.top||0,h=this._change[this.axis];return this._updatePrevProperties(),h?(d=h.apply(this,[c,g,f]),this._updateVirtualBoundaries(c.shiftKey),(this._aspectRatio||c.shiftKey)&&(d=this._updateRatio(d,c)),d=this._respectSize(d,c),this._updateCache(d),this._propagate("resize",c),e=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),b.isEmptyObject(e)||(this._updatePrevProperties(),this._trigger("resize",
c,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(c){this.resizing=!1;var d,e,f,g,h,p,s,r=this.options;return this._helper&&(d=this._proportionallyResizeElements,e=d.length&&/textarea/i.test(d[0].nodeName),f=e&&this._hasScroll(d[0],"left")?0:this.sizeDiff.height,g=e?0:this.sizeDiff.width,h={width:this.helper.width()-g,height:this.helper.height()-f},p=parseInt(this.element.css("left"),10)+(this.position.left-this.originalPosition.left)||null,s=parseInt(this.element.css("top"),10)+(this.position.top-
this.originalPosition.top)||null,r.animate||this.element.css(b.extend(h,{top:s,left:p})),this.helper.height(this.size.height),this.helper.width(this.size.width),this._helper&&!r.animate&&this._proportionallyResize()),b("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",c),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left};this.prevSize={width:this.size.width,height:this.size.height}},
_applyChanges:function(){var b={};return this.position.top!==this.prevPosition.top&&(b.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(b.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(b.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(b.height=this.size.height+"px"),this.helper.css(b),b},_updateVirtualBoundaries:function(b){var c,d,e,f,g;g=this.options;g={minWidth:this._isNumber(g.minWidth)?g.minWidth:0,maxWidth:this._isNumber(g.maxWidth)?
g.maxWidth:1/0,minHeight:this._isNumber(g.minHeight)?g.minHeight:0,maxHeight:this._isNumber(g.maxHeight)?g.maxHeight:1/0};(this._aspectRatio||b)&&(c=g.minHeight*this.aspectRatio,e=g.minWidth/this.aspectRatio,d=g.maxHeight*this.aspectRatio,f=g.maxWidth/this.aspectRatio,c>g.minWidth&&(g.minWidth=c),e>g.minHeight&&(g.minHeight=e),g.maxWidth>d&&(g.maxWidth=d),g.maxHeight>f&&(g.maxHeight=f));this._vBoundaries=g},_updateCache:function(b){this.offset=this.helper.offset();this._isNumber(b.left)&&(this.position.left=
b.left);this._isNumber(b.top)&&(this.position.top=b.top);this._isNumber(b.height)&&(this.size.height=b.height);this._isNumber(b.width)&&(this.size.width=b.width)},_updateRatio:function(b){var c=this.position,d=this.size,e=this.axis;return this._isNumber(b.height)?b.width=b.height*this.aspectRatio:this._isNumber(b.width)&&(b.height=b.width/this.aspectRatio),"sw"===e&&(b.left=c.left+(d.width-b.width),b.top=null),"nw"===e&&(b.top=c.top+(d.height-b.height),b.left=c.left+(d.width-b.width)),b},_respectSize:function(b){var c=
this._vBoundaries,d=this.axis,e=this._isNumber(b.width)&&c.maxWidth&&c.maxWidth<b.width,f=this._isNumber(b.height)&&c.maxHeight&&c.maxHeight<b.height,g=this._isNumber(b.width)&&c.minWidth&&c.minWidth>b.width,h=this._isNumber(b.height)&&c.minHeight&&c.minHeight>b.height,s=this.originalPosition.left+this.originalSize.width,r=this.position.top+this.size.height,o=/sw|nw|w/.test(d),d=/nw|ne|n/.test(d);return g&&(b.width=c.minWidth),h&&(b.height=c.minHeight),e&&(b.width=c.maxWidth),f&&(b.height=c.maxHeight),
g&&o&&(b.left=s-c.minWidth),e&&o&&(b.left=s-c.maxWidth),h&&d&&(b.top=r-c.minHeight),f&&d&&(b.top=r-c.maxHeight),b.width||b.height||b.left||!b.top?b.width||b.height||b.top||!b.left||(b.left=null):b.top=null,b},_getPaddingPlusBorderDimensions:function(b){for(var c=0,d=[],e=[b.css("borderTopWidth"),b.css("borderRightWidth"),b.css("borderBottomWidth"),b.css("borderLeftWidth")],b=[b.css("paddingTop"),b.css("paddingRight"),b.css("paddingBottom"),b.css("paddingLeft")];4>c;c++)d[c]=parseInt(e[c],10)||0,d[c]+=
parseInt(b[c],10)||0;return{height:d[0]+d[2],width:d[1]+d[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var b,c=0,d=this.helper||this.element;this._proportionallyResizeElements.length>c;c++)b=this._proportionallyResizeElements[c],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(b)),b.css({height:d.height()-this.outerDimensions.height||0,width:d.width()-this.outerDimensions.width||0})},_renderProxy:function(){var c=this.options;
this.elementOffset=this.element.offset();this._helper?(this.helper=this.helper||b("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(b,c){return{width:this.originalSize.width+c}},w:function(b,c){return{left:this.originalPosition.left+
c,width:this.originalSize.width-c}},n:function(b,c,d){return{top:this.originalPosition.top+d,height:this.originalSize.height-d}},s:function(b,c,d){return{height:this.originalSize.height+d}},se:function(c,d,e){return b.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[c,d,e]))},sw:function(c,d,e){return b.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[c,d,e]))},ne:function(c,d,e){return b.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,
[c,d,e]))},nw:function(c,d,e){return b.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[c,d,e]))}},_propagate:function(c,d){b.ui.plugin.call(this,c,[d,this.ui()]);"resize"!==c&&this._trigger(c,d,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});b.ui.plugin.add("resizable","animate",{stop:function(c){var d=
b(this).resizable("instance"),e=d.options,f=d._proportionallyResizeElements,g=f.length&&/textarea/i.test(f[0].nodeName),h=g&&d._hasScroll(f[0],"left")?0:d.sizeDiff.height,g={width:d.size.width-(g?0:d.sizeDiff.width),height:d.size.height-h},h=parseInt(d.element.css("left"),10)+(d.position.left-d.originalPosition.left)||null,p=parseInt(d.element.css("top"),10)+(d.position.top-d.originalPosition.top)||null;d.element.animate(b.extend(g,p&&h?{top:p,left:h}:{}),{duration:e.animateDuration,easing:e.animateEasing,
step:function(){var e={width:parseInt(d.element.css("width"),10),height:parseInt(d.element.css("height"),10),top:parseInt(d.element.css("top"),10),left:parseInt(d.element.css("left"),10)};f&&f.length&&b(f[0]).css({width:e.width,height:e.height});d._updateCache(e);d._propagate("resize",c)}})}});b.ui.plugin.add("resizable","containment",{start:function(){var c,d,e,f,g,h,p,s=b(this).resizable("instance"),r=s.element,o=s.options.containment;(r=o instanceof b?o.get(0):/parent/.test(o)?r.parent().get(0):
o)&&(s.containerElement=b(r),/document/.test(o)||o===document?(s.containerOffset={left:0,top:0},s.containerPosition={left:0,top:0},s.parentData={element:b(document),left:0,top:0,width:b(document).width(),height:b(document).height()||document.body.parentNode.scrollHeight}):(c=b(r),d=[],b(["Top","Right","Left","Bottom"]).each(function(b,e){d[b]=s._num(c.css("padding"+e))}),s.containerOffset=c.offset(),s.containerPosition=c.position(),s.containerSize={height:c.innerHeight()-d[3],width:c.innerWidth()-
d[1]},e=s.containerOffset,f=s.containerSize.height,g=s.containerSize.width,h=s._hasScroll(r,"left")?r.scrollWidth:g,p=s._hasScroll(r)?r.scrollHeight:f,s.parentData={element:r,left:e.left,top:e.top,width:h,height:p}))},resize:function(c){var d,e,f,g=b(this).resizable("instance");d=g.options;e=g.containerOffset;f=g.position;var c=g._aspectRatio||c.shiftKey,h={top:0,left:0},p=g.containerElement,s=!0;p[0]!==document&&/static/.test(p.css("position"))&&(h=e);f.left<(g._helper?e.left:0)&&(g.size.width+=
g._helper?g.position.left-e.left:g.position.left-h.left,c&&(g.size.height=g.size.width/g.aspectRatio,s=!1),g.position.left=d.helper?e.left:0);f.top<(g._helper?e.top:0)&&(g.size.height+=g._helper?g.position.top-e.top:g.position.top,c&&(g.size.width=g.size.height*g.aspectRatio,s=!1),g.position.top=g._helper?e.top:0);d=g.containerElement.get(0)===g.element.parent().get(0);f=/relative|absolute/.test(g.containerElement.css("position"));d&&f?(g.offset.left=g.parentData.left+g.position.left,g.offset.top=
g.parentData.top+g.position.top):(g.offset.left=g.element.offset().left,g.offset.top=g.element.offset().top);d=Math.abs(g.sizeDiff.width+(g._helper?g.offset.left-h.left:g.offset.left-e.left));e=Math.abs(g.sizeDiff.height+(g._helper?g.offset.top-h.top:g.offset.top-e.top));d+g.size.width>=g.parentData.width&&(g.size.width=g.parentData.width-d,c&&(g.size.height=g.size.width/g.aspectRatio,s=!1));e+g.size.height>=g.parentData.height&&(g.size.height=g.parentData.height-e,c&&(g.size.width=g.size.height*
g.aspectRatio,s=!1));s||(g.position.left=g.prevPosition.left,g.position.top=g.prevPosition.top,g.size.width=g.prevSize.width,g.size.height=g.prevSize.height)},stop:function(){var c=b(this).resizable("instance"),d=c.options,e=c.containerOffset,f=c.containerPosition,g=c.containerElement,h=b(c.helper),p=h.offset(),s=h.outerWidth()-c.sizeDiff.width,h=h.outerHeight()-c.sizeDiff.height;c._helper&&!d.animate&&/relative/.test(g.css("position"))&&b(this).css({left:p.left-f.left-e.left,width:s,height:h});c._helper&&
!d.animate&&/static/.test(g.css("position"))&&b(this).css({left:p.left-f.left-e.left,width:s,height:h})}});b.ui.plugin.add("resizable","alsoResize",{start:function(){var c=b(this).resizable("instance").options;b(c.alsoResize).each(function(){var c=b(this);c.data("ui-resizable-alsoresize",{width:parseInt(c.width(),10),height:parseInt(c.height(),10),left:parseInt(c.css("left"),10),top:parseInt(c.css("top"),10)})})},resize:function(c,d){var e=b(this).resizable("instance"),f=e.originalSize,g=e.originalPosition,
h={height:e.size.height-f.height||0,width:e.size.width-f.width||0,top:e.position.top-g.top||0,left:e.position.left-g.left||0};b(e.options.alsoResize).each(function(){var c=b(this),e=b(this).data("ui-resizable-alsoresize"),f={},g=c.parents(d.originalElement[0]).length?["width","height"]:["width","height","top","left"];b.each(g,function(b,c){var d=(e[c]||0)+(h[c]||0);d&&0<=d&&(f[c]=d||null)});c.css(f)})},stop:function(){b(this).removeData("resizable-alsoresize")}});b.ui.plugin.add("resizable","ghost",
{start:function(){var c=b(this).resizable("instance"),d=c.options,e=c.size;c.ghost=c.originalElement.clone();c.ghost.css({opacity:0.25,display:"block",position:"relative",height:e.height,width:e.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof d.ghost?d.ghost:"");c.ghost.appendTo(c.helper)},resize:function(){var c=b(this).resizable("instance");c.ghost&&c.ghost.css({position:"relative",height:c.size.height,width:c.size.width})},stop:function(){var c=b(this).resizable("instance");
c.ghost&&c.helper&&c.helper.get(0).removeChild(c.ghost.get(0))}});b.ui.plugin.add("resizable","grid",{resize:function(){var c,d=b(this).resizable("instance"),e=d.options,f=d.size,g=d.originalSize,h=d.originalPosition,p=d.axis,s="number"==typeof e.grid?[e.grid,e.grid]:e.grid,r=s[0]||1,o=s[1]||1,t=Math.round((f.width-g.width)/r)*r,f=Math.round((f.height-g.height)/o)*o,u=g.width+t,w=g.height+f,z=e.maxWidth&&u>e.maxWidth,A=e.maxHeight&&w>e.maxHeight,C=e.minWidth&&e.minWidth>u,G=e.minHeight&&e.minHeight>
w;e.grid=s;C&&(u+=r);G&&(w+=o);z&&(u-=r);A&&(w-=o);/^(se|s|e)$/.test(p)?(d.size.width=u,d.size.height=w):/^(ne)$/.test(p)?(d.size.width=u,d.size.height=w,d.position.top=h.top-f):/^(sw)$/.test(p)?(d.size.width=u,d.size.height=w,d.position.left=h.left-t):((0>=w-o||0>=u-r)&&(c=d._getPaddingPlusBorderDimensions(this)),0<w-o?(d.size.height=w,d.position.top=h.top-f):(w=o-c.height,d.size.height=w,d.position.top=h.top+g.height-w),0<u-r?(d.size.width=u,d.position.left=h.left-t):(u=r-c.width,d.size.width=u,
d.position.left=h.left+g.width-u))}});b.ui.resizable;b.widget("ui.selectable",b.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var c,d=this;this.element.addClass("ui-selectable");this.dragged=!1;this.refresh=function(){c=b(d.options.filter,d.element[0]);c.addClass("ui-selectee");c.each(function(){var c=b(this),d=c.offset();b.data(this,"selectable-item",
{element:this,$element:c,left:d.left,top:d.top,right:d.left+c.outerWidth(),bottom:d.top+c.outerHeight(),startselected:!1,selected:c.hasClass("ui-selected"),selecting:c.hasClass("ui-selecting"),unselecting:c.hasClass("ui-unselecting")})})};this.refresh();this.selectees=c.addClass("ui-selectee");this._mouseInit();this.helper=b("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");
this._mouseDestroy()},_mouseStart:function(c){var d=this,e=this.options;this.opos=[c.pageX,c.pageY];this.options.disabled||(this.selectees=b(e.filter,this.element[0]),this._trigger("start",c),b(e.appendTo).append(this.helper),this.helper.css({left:c.pageX,top:c.pageY,width:0,height:0}),e.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var e=b.data(this,"selectable-item");e.startselected=!0;c.metaKey||c.ctrlKey||(e.$element.removeClass("ui-selected"),e.selected=!1,
e.$element.addClass("ui-unselecting"),e.unselecting=!0,d._trigger("unselecting",c,{unselecting:e.element}))}),b(c.target).parents().addBack().each(function(){var e,f=b.data(this,"selectable-item");return f?(e=!c.metaKey&&!c.ctrlKey||!f.$element.hasClass("ui-selected"),f.$element.removeClass(e?"ui-unselecting":"ui-selected").addClass(e?"ui-selecting":"ui-unselecting"),f.unselecting=!e,f.selecting=e,f.selected=e,e?d._trigger("selecting",c,{selecting:f.element}):d._trigger("unselecting",c,{unselecting:f.element}),
!1):void 0}))},_mouseDrag:function(c){if(this.dragged=!0,!this.options.disabled){var d,e=this,f=this.options,g=this.opos[0],h=this.opos[1],p=c.pageX,s=c.pageY;return g>p&&(d=p,p=g,g=d),h>s&&(d=s,s=h,h=d),this.helper.css({left:g,top:h,width:p-g,height:s-h}),this.selectees.each(function(){var d=b.data(this,"selectable-item");d&&d.element!==e.element[0]&&(d.selecting&&((c.metaKey||c.ctrlKey)&&d.startselected?(d.$element.removeClass("ui-selecting"),d.selecting=!1,d.$element.addClass("ui-selected"),d.selected=
!0):(d.$element.removeClass("ui-selecting"),d.selecting=!1,d.startselected&&(d.$element.addClass("ui-unselecting"),d.unselecting=!0),e._trigger("unselecting",c,{unselecting:d.element}))),d.selected&&(c.metaKey||c.ctrlKey||d.startselected||(d.$element.removeClass("ui-selected"),d.selected=!1,d.$element.addClass("ui-unselecting"),d.unselecting=!0,e._trigger("unselecting",c,{unselecting:d.element}))))}),!1}},_mouseStop:function(c){var d=this;return this.dragged=!1,b(".ui-unselecting",this.element[0]).each(function(){var e=
b.data(this,"selectable-item");e.$element.removeClass("ui-unselecting");e.unselecting=!1;e.startselected=!1;d._trigger("unselected",c,{unselected:e.element})}),b(".ui-selecting",this.element[0]).each(function(){var e=b.data(this,"selectable-item");e.$element.removeClass("ui-selecting").addClass("ui-selected");e.selecting=!1;e.selected=!0;e.startselected=!0;d._trigger("selected",c,{selected:e.element})}),this._trigger("stop",c),this.helper.remove(),!1}});b.widget("ui.sortable",b.ui.mouse,{version:"1.11.4",
widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},
_isOverAxis:function(b,c,d){return b>=c&&c+d>b},_isFloating:function(b){return/left|right/.test(b.css("float"))||/inline|table-cell/.test(b.css("display"))},_create:function(){this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=!0},_setOption:function(b,c){this._super(b,c);"handle"===b&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle");
b.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle");this._mouseDestroy();for(var b=this.items.length-1;0<=b;b--)this.items[b].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(c,d){var e=null,f=!1,g=this;return this.reverting?!1:this.options.disabled||
"static"===this.options.type?!1:(this._refreshItems(c),b(c.target).parents().each(function(){return b.data(this,g.widgetName+"-item")===g?(e=b(this),false):void 0}),b.data(c.target,g.widgetName+"-item")===g&&(e=b(c.target)),e?!this.options.handle||d||(b(this.options.handle,e).find("*").addBack().each(function(){this===c.target&&(f=true)}),f)?(this.currentItem=e,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(c,d,e){var f,d=this.options;if(this.currentContainer=this,this.refreshPositions(),
this.helper=this._createHelper(c),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},b.extend(this.offset,{click:{left:c.pageX-this.offset.left,top:c.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=
this._generatePosition(c),this.originalPageX=c.pageX,this.originalPageY=c.pageY,d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),d.containment&&this._setContainment(),d.cursor&&"auto"!==d.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",d.cursor),this.storedStylesheet=b("<style>*{ cursor: "+
d.cursor+" !important; }</style>").appendTo(f)),d.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",d.opacity)),d.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",d.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",c,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),
!e)for(e=this.containers.length-1;0<=e;e--)this.containers[e]._trigger("activate",c,this._uiHash(this));return b.ui.ddmanager&&(b.ui.ddmanager.current=this),b.ui.ddmanager&&!d.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,c),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(c),!0},_mouseDrag:function(c){var d,e,f,g;d=this.options;var h=!1;this.position=this._generatePosition(c);this.positionAbs=this._convertPositionTo("absolute");this.lastPositionAbs||(this.lastPositionAbs=
this.positionAbs);this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-c.pageY<d.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+d.scrollSpeed:c.pageY-this.overflowOffset.top<d.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-d.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-c.pageX<d.scrollSensitivity?
this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+d.scrollSpeed:c.pageX-this.overflowOffset.left<d.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-d.scrollSpeed)):(c.pageY-this.document.scrollTop()<d.scrollSensitivity?h=this.document.scrollTop(this.document.scrollTop()-d.scrollSpeed):this.window.height()-(c.pageY-this.document.scrollTop())<d.scrollSensitivity&&(h=this.document.scrollTop(this.document.scrollTop()+d.scrollSpeed)),c.pageX-this.document.scrollLeft()<
d.scrollSensitivity?h=this.document.scrollLeft(this.document.scrollLeft()-d.scrollSpeed):this.window.width()-(c.pageX-this.document.scrollLeft())<d.scrollSensitivity&&(h=this.document.scrollLeft(this.document.scrollLeft()+d.scrollSpeed))),!1!==h&&b.ui.ddmanager&&!d.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,c));this.positionAbs=this._convertPositionTo("absolute");this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px");this.options.axis&&"x"===this.options.axis||
(this.helper[0].style.top=this.position.top+"px");for(d=this.items.length-1;0<=d;d--)if(e=this.items[d],f=e.item[0],g=this._intersectsWithPointer(e),g&&e.instance===this.currentContainer&&f!==this.currentItem[0]&&this.placeholder[1===g?"next":"prev"]()[0]!==f&&!b.contains(this.placeholder[0],f)&&("semi-dynamic"===this.options.type?!b.contains(this.element[0],f):!0)){if(this.direction=1===g?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(e))break;this._rearrange(c,e);this._trigger("change",
c,this._uiHash());break}return this._contactContainers(c),b.ui.ddmanager&&b.ui.ddmanager.drag(this,c),this._trigger("sort",c,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(c,d){if(c){if(b.ui.ddmanager&&!this.options.dropBehaviour&&b.ui.ddmanager.drop(this,c),this.options.revert){var e=this,f=this.placeholder.offset(),g=this.options.axis,h={};g&&"x"!==g||(h.left=f.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft));
g&&"y"!==g||(h.top=f.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop));this.reverting=!0;b(this.helper).animate(h,parseInt(this.options.revert,10)||500,function(){e._clear(c)})}else this._clear(c,d);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var c=this.containers.length-
1;0<=c;c--)this.containers[c]._trigger("deactivate",null,this._uiHash(this)),this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",null,this._uiHash(this)),this.containers[c].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),b.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),
this.domPosition.prev?b(this.domPosition.prev).after(this.currentItem):b(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(c){var d=this._getItemsAsjQuery(c&&c.connected),e=[];return c=c||{},b(d).each(function(){var d=(b(c.item||this).attr(c.attribute||"id")||"").match(c.expression||/(.+)[\-=_](.+)/);d&&e.push((c.key||d[1]+"[]")+"="+(c.key&&c.expression?d[1]:d[2]))}),!e.length&&c.key&&e.push(c.key+"="),e.join("&")},toArray:function(c){var d=this._getItemsAsjQuery(c&&c.connected),
e=[];return c=c||{},d.each(function(){e.push(b(c.item||this).attr(c.attribute||"id")||"")}),e},_intersectsWith:function(b){var c=this.positionAbs.left,d=c+this.helperProportions.width,e=this.positionAbs.top,f=e+this.helperProportions.height,g=b.left,h=g+b.width,s=b.top,r=s+b.height,o=this.offset.click.top,t=this.offset.click.left,t="y"===this.options.axis||c+t>g&&h>c+t,o=("x"===this.options.axis||e+o>s&&r>e+o)&&t;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==
this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>b[this.floating?"width":"height"]?o:c+this.helperProportions.width/2>g&&h>d-this.helperProportions.width/2&&e+this.helperProportions.height/2>s&&r>f-this.helperProportions.height/2},_intersectsWithPointer:function(b){var c="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height),b="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),
c=c&&b,b=this._getDragVerticalDirection(),d=this._getDragHorizontalDirection();return c?this.floating?d&&"right"===d||"down"===b?2:1:b&&("down"===b?2:1):!1},_intersectsWithSides:function(b){var c=this._isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height),b=this._isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width),d=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?"right"===e&&b||"left"===e&&!b:d&&
("down"===d&&c||"up"===d&&!c)},_getDragVerticalDirection:function(){var b=this.positionAbs.top-this.lastPositionAbs.top;return 0!==b&&(0<b?"down":"up")},_getDragHorizontalDirection:function(){var b=this.positionAbs.left-this.lastPositionAbs.left;return 0!==b&&(0<b?"right":"left")},refresh:function(b){return this._refreshItems(b),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var b=this.options;return b.connectWith.constructor===String?[b.connectWith]:b.connectWith},
_getItemsAsjQuery:function(c){function d(){h.push(this)}var e,f,g,h=[],p=[],s=this._connectWith();if(s&&c)for(c=s.length-1;0<=c;c--){f=b(s[c],this.document[0]);for(e=f.length-1;0<=e;e--)(g=b.data(f[e],this.widgetFullName))&&g!==this&&!g.options.disabled&&p.push([b.isFunction(g.options.items)?g.options.items.call(g.element):b(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g])}p.push([b.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,
item:this.currentItem}):b(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(c=p.length-1;0<=c;c--)p[c][0].each(d);return b(h)},_removeCurrentsFromItems:function(){var c=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=b.grep(this.items,function(b){for(var d=0;c.length>d;d++)if(c[d]===b.item[0])return!1;return!0})},_refreshItems:function(c){this.items=[];this.containers=[this];var d,e,f,g,h,p=this.items,s=[[b.isFunction(this.options.items)?
this.options.items.call(this.element[0],c,{item:this.currentItem}):b(this.options.items,this.element),this]];if((h=this._connectWith())&&this.ready)for(d=h.length-1;0<=d;d--){f=b(h[d],this.document[0]);for(e=f.length-1;0<=e;e--)(g=b.data(f[e],this.widgetFullName))&&g!==this&&!g.options.disabled&&(s.push([b.isFunction(g.options.items)?g.options.items.call(g.element[0],c,{item:this.currentItem}):b(g.options.items,g.element),g]),this.containers.push(g))}for(d=s.length-1;0<=d;d--){c=s[d][1];f=s[d][0];
e=0;for(h=f.length;h>e;e++)g=b(f[e]),g.data(this.widgetName+"-item",c),p.push({item:g,instance:c,width:0,height:0,left:0,top:0})}},refreshPositions:function(c){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1;this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var d,e,f,g;for(d=this.items.length-1;0<=d;d--)e=this.items[d],e.instance!==this.currentContainer&&this.currentContainer&&e.item[0]!==this.currentItem[0]||(f=this.options.toleranceElement?
b(this.options.toleranceElement,e.item):e.item,c||(e.width=f.outerWidth(),e.height=f.outerHeight()),g=f.offset(),e.left=g.left,e.top=g.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(d=this.containers.length-1;0<=d;d--)g=this.containers[d].element.offset(),this.containers[d].containerCache.left=g.left,this.containers[d].containerCache.top=g.top,this.containers[d].containerCache.width=this.containers[d].element.outerWidth(),
this.containers[d].containerCache.height=this.containers[d].element.outerHeight();return this},_createPlaceholder:function(c){var c=c||this,d,e=c.options;e.placeholder&&e.placeholder.constructor!==String||(d=e.placeholder,e.placeholder={element:function(){var e=c.currentItem[0].nodeName.toLowerCase(),f=b("<"+e+">",c.document[0]).addClass(d||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===e?c._createTrPlaceholder(c.currentItem.find("tr").eq(0),
b("<tr>",c.document[0]).appendTo(f)):"tr"===e?c._createTrPlaceholder(c.currentItem,f):"img"===e&&f.attr("src",c.currentItem.attr("src")),d||f.css("visibility","hidden"),f},update:function(b,f){(!d||e.forcePlaceholderSize)&&(f.height()||f.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10)),f.width()||f.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||
0,10)))}});c.placeholder=b(e.placeholder.element.call(c.element,c.currentItem));c.currentItem.after(c.placeholder);e.placeholder.update(c,c.placeholder)},_createTrPlaceholder:function(c,d){var e=this;c.children().each(function(){b("<td>&#160;</td>",e.document[0]).attr("colspan",b(this).attr("colspan")||1).appendTo(d)})},_contactContainers:function(c){var d,e,f,g,h,p,s,r,o=g=null;for(d=this.containers.length-1;0<=d;d--)if(!b.contains(this.currentItem[0],this.containers[d].element[0]))if(this._intersectsWith(this.containers[d].containerCache)){if(!g||
!b.contains(this.containers[d].element[0],g.element[0]))g=this.containers[d],o=d}else this.containers[d].containerCache.over&&(this.containers[d]._trigger("out",c,this._uiHash(this)),this.containers[d].containerCache.over=0);if(g)if(1===this.containers.length)this.containers[o].containerCache.over||(this.containers[o]._trigger("over",c,this._uiHash(this)),this.containers[o].containerCache.over=1);else{d=1E4;f=null;g=(e=g.floating||this._isFloating(this.currentItem))?"left":"top";h=e?"width":"height";
r=e?"clientX":"clientY";for(e=this.items.length-1;0<=e;e--)b.contains(this.containers[o].element[0],this.items[e].item[0])&&this.items[e].item[0]!==this.currentItem[0]&&(p=this.items[e].item.offset()[g],s=!1,c[r]-p>this.items[e][h]/2&&(s=!0),d>Math.abs(c[r]-p)&&(d=Math.abs(c[r]-p),f=this.items[e],this.direction=s?"up":"down"));if(f||this.options.dropOnEmpty){if(this.currentContainer===this.containers[o])return this.currentContainer.containerCache.over||(this.containers[o]._trigger("over",c,this._uiHash()),
this.currentContainer.containerCache.over=1),void 0;f?this._rearrange(c,f,null,!0):this._rearrange(c,null,this.containers[o].element,!0);this._trigger("change",c,this._uiHash());this.containers[o]._trigger("change",c,this._uiHash(this));this.currentContainer=this.containers[o];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[o]._trigger("over",c,this._uiHash(this));this.containers[o].containerCache.over=1}}},_createHelper:function(c){var d=this.options,c=b.isFunction(d.helper)?
b(d.helper.apply(this.element[0],[c,this.currentItem])):"clone"===d.helper?this.currentItem.clone():this.currentItem;return c.parents("body").length||b("parent"!==d.appendTo?d.appendTo:this.currentItem[0].parentNode)[0].appendChild(c[0]),c[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!c[0].style.width||d.forceHelperSize)&&
c.width(this.currentItem.width()),(!c[0].style.height||d.forceHelperSize)&&c.height(this.currentItem.height()),c},_adjustOffsetFromHelper:function(c){"string"==typeof c&&(c=c.split(" "));b.isArray(c)&&(c={left:+c[0],top:+c[1]||0});"left"in c&&(this.offset.click.left=c.left+this.margins.left);"right"in c&&(this.offset.click.left=this.helperProportions.width-c.right+this.margins.left);"top"in c&&(this.offset.click.top=c.top+this.margins.top);"bottom"in c&&(this.offset.click.top=this.helperProportions.height-
c.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var c=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&b.contains(this.scrollParent[0],this.offsetParent[0])&&(c.left+=this.scrollParent.scrollLeft(),c.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&b.ui.ie)&&(c={top:0,left:0}),
{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var b=this.currentItem.position();return{top:b.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),
10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var c,d,e,f=this.options;"parent"===f.containment&&(f.containment=this.helper[0].parentNode);("document"===f.containment||"window"===f.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===f.containment?
this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===f.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]);/^(document|window|parent)$/.test(f.containment)||(c=b(f.containment)[0],d=b(f.containment).offset(),e="hidden"!==b(c).css("overflow"),this.containment=[d.left+(parseInt(b(c).css("borderLeftWidth"),10)||0)+(parseInt(b(c).css("paddingLeft"),10)||
0)-this.margins.left,d.top+(parseInt(b(c).css("borderTopWidth"),10)||0)+(parseInt(b(c).css("paddingTop"),10)||0)-this.margins.top,d.left+(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(b(c).css("borderLeftWidth"),10)||0)-(parseInt(b(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,d.top+(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(b(c).css("borderTopWidth"),10)||0)-(parseInt(b(c).css("paddingBottom"),10)||0)-this.helperProportions.height-
this.margins.top])},_convertPositionTo:function(c,d){d||(d=this.position);var e="absolute"===c?1:-1,f="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,g=/(html|body)/i.test(f[0].tagName);return{top:d.top+this.offset.relative.top*e+this.offset.parent.top*e-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():g?0:f.scrollTop())*e,left:d.left+this.offset.relative.left*e+this.offset.parent.left*
e-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*e}},_generatePosition:function(c){var d,e,f=this.options,g=c.pageX,h=c.pageY,p="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(p[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=
this._getRelativeOffset()),this.originalPosition&&(this.containment&&(c.pageX-this.offset.click.left<this.containment[0]&&(g=this.containment[0]+this.offset.click.left),c.pageY-this.offset.click.top<this.containment[1]&&(h=this.containment[1]+this.offset.click.top),c.pageX-this.offset.click.left>this.containment[2]&&(g=this.containment[2]+this.offset.click.left),c.pageY-this.offset.click.top>this.containment[3]&&(h=this.containment[3]+this.offset.click.top)),f.grid&&(d=this.originalPageY+Math.round((h-
this.originalPageY)/f.grid[1])*f.grid[1],h=this.containment?d-this.offset.click.top>=this.containment[1]&&d-this.offset.click.top<=this.containment[3]?d:d-this.offset.click.top>=this.containment[1]?d-f.grid[1]:d+f.grid[1]:d,e=this.originalPageX+Math.round((g-this.originalPageX)/f.grid[0])*f.grid[0],g=this.containment?e-this.offset.click.left>=this.containment[0]&&e-this.offset.click.left<=this.containment[2]?e:e-this.offset.click.left>=this.containment[0]?e-f.grid[0]:e+f.grid[0]:e)),{top:h-this.offset.click.top-
this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:p.scrollTop()),left:g-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:p.scrollLeft())}},_rearrange:function(b,c,d,e){d?d[0].appendChild(this.placeholder[0]):c.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?c.item[0]:c.item[0].nextSibling);var f=this.counter=this.counter?++this.counter:
1;this._delay(function(){f===this.counter&&this.refreshPositions(!e)})},_clear:function(b,c){function d(b,c,e){return function(d){e._trigger(b,d,c._uiHash(c))}}this.reverting=!1;var e,f=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(e in this._storedCSS)("auto"===this._storedCSS[e]||"static"===this._storedCSS[e])&&(this._storedCSS[e]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();
this.fromOutside&&!c&&f.push(function(b){this._trigger("receive",b,this._uiHash(this.fromOutside))});!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||c||f.push(function(b){this._trigger("update",b,this._uiHash())});this!==this.currentContainer&&(c||(f.push(function(b){this._trigger("remove",b,this._uiHash())}),f.push(function(b){return function(c){b._trigger("receive",c,this._uiHash(this))}}.call(this,
this.currentContainer)),f.push(function(b){return function(c){b._trigger("update",c,this._uiHash(this))}}.call(this,this.currentContainer))));for(e=this.containers.length-1;0<=e;e--)c||f.push(d("deactivate",this,this.containers[e])),this.containers[e].containerCache.over&&(f.push(d("out",this,this.containers[e])),this.containers[e].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",
this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,c||this._trigger("beforeStop",b,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!c){for(e=0;f.length>e;e++)f[e].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===
b.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(c){var d=c||this;return{helper:d.helper,placeholder:d.placeholder||b([]),position:d.position,originalPosition:d.originalPosition,offset:d.positionAbs,item:d.currentItem,sender:c?c.element:null}}});b.widget("ui.slider",b.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},
numPages:5,_create:function(){this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this._calculateNewMax();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=!1},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var c,
d;c=this.options;var e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f=[];d=c.values&&c.values.length||1;e.length>d&&(e.slice(d).remove(),e=e.slice(0,d));for(c=e.length;d>c;c++)f.push("<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>");this.handles=e.add(b(f.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(c){b(this).data("ui-slider-handle-index",c)})},_createRange:function(){var c=this.options,
d="";c.range?(!0===c.range&&(c.values?c.values.length&&2!==c.values.length?c.values=[c.values[0],c.values[0]]:b.isArray(c.values)&&(c.values=c.values.slice(0)):c.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=b("<div></div>").appendTo(this.element),d="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(d+("min"===c.range||"max"===c.range?" ui-slider-range-"+
c.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles);this._on(this.handles,this._handleEvents);this._hoverable(this.handles);this._focusable(this.handles)},_destroy:function(){this.handles.remove();this.range&&this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all");this._mouseDestroy()},_mouseCapture:function(c){var d,e,f,g,h,p,s,r,o=this,t=this.options;return t.disabled?
!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),d={x:c.pageX,y:c.pageY},e=this._normValueFromMouse(d),f=this._valueMax()-this._valueMin()+1,this.handles.each(function(c){var d=Math.abs(e-o.values(c));(f>d||f===d&&(c===o._lastChangedValue||o.values(c)===t.min))&&(f=d,g=b(this),h=c)}),p=this._start(c,h),!1===p?!1:(this._mouseSliding=!0,this._handleIndex=h,g.addClass("ui-state-active").focus(),s=g.offset(),r=!b(c.target).parents().addBack().is(".ui-slider-handle"),
this._clickOffset=r?{left:0,top:0}:{left:c.pageX-s.left-g.width()/2,top:c.pageY-s.top-g.height()/2-(parseInt(g.css("borderTopWidth"),10)||0)-(parseInt(g.css("borderBottomWidth"),10)||0)+(parseInt(g.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(c,h,e),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(b){var c=this._normValueFromMouse({x:b.pageX,y:b.pageY});return this._slide(b,this._handleIndex,c),!1},_mouseStop:function(b){return this.handles.removeClass("ui-state-active"),
this._mouseSliding=!1,this._stop(b,this._handleIndex),this._change(b,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(b){var c,d,e,f,g;return"horizontal"===this.orientation?(c=this.elementSize.width,d=b.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(c=this.elementSize.height,d=b.y-this.elementOffset.top-
(this._clickOffset?this._clickOffset.top:0)),e=d/c,1<e&&(e=1),0>e&&(e=0),"vertical"===this.orientation&&(e=1-e),f=this._valueMax()-this._valueMin(),g=this._valueMin()+e*f,this._trimAlignValue(g)},_start:function(b,c){var d={handle:this.handles[c],value:this.value()};return this.options.values&&this.options.values.length&&(d.value=this.values(c),d.values=this.values()),this._trigger("start",b,d)},_slide:function(b,c,d){var e,f,g;this.options.values&&this.options.values.length?(e=this.values(c?0:1),
2===this.options.values.length&&!0===this.options.range&&(0===c&&d>e||1===c&&e>d)&&(d=e),d!==this.values(c)&&(f=this.values(),f[c]=d,g=this._trigger("slide",b,{handle:this.handles[c],value:d,values:f}),this.values(c?0:1),!1!==g&&this.values(c,d))):d!==this.value()&&(g=this._trigger("slide",b,{handle:this.handles[c],value:d}),!1!==g&&this.value(d))},_stop:function(b,c){var d={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(d.value=this.values(c),d.values=
this.values());this._trigger("stop",b,d)},_change:function(b,c){if(!this._keySliding&&!this._mouseSliding){var d={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(d.value=this.values(c),d.values=this.values());this._lastChangedValue=c;this._trigger("change",b,d)}},value:function(b){return arguments.length?(this.options.value=this._trimAlignValue(b),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(c,d){var e,f,g;if(1<arguments.length)return this.options.values[c]=
this._trimAlignValue(d),this._refreshValue(),this._change(null,c),void 0;if(!arguments.length)return this._values();if(!b.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(c):this.value();e=this.options.values;f=arguments[0];for(g=0;e.length>g;g+=1)e[g]=this._trimAlignValue(f[g]),this._change(null,g);this._refreshValue()},_setOption:function(c,d){var e,f=0;switch("range"===c&&!0===this.options.range&&("min"===d?(this.options.value=this._values(0),this.options.values=
null):"max"===d&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),b.isArray(this.options.values)&&(f=this.options.values.length),"disabled"===c&&this.element.toggleClass("ui-state-disabled",!!d),this._super(c,d),c){case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();this.handles.css("horizontal"===d?"bottom":"left","");break;case "value":this._animateOff=
!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(e=0;f>e;e+=1)this._change(null,e);this._animateOff=!1;break;case "step":case "min":case "max":this._animateOff=!0;this._calculateNewMax();this._refreshValue();this._animateOff=!1;break;case "range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){return this._trimAlignValue(this.options.value)},_values:function(b){var c,d;if(arguments.length)return c=
this.options.values[b],this._trimAlignValue(c);if(this.options.values&&this.options.values.length){c=this.options.values.slice();for(d=0;c.length>d;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(b){if(this._valueMin()>=b)return this._valueMin();if(b>=this._valueMax())return this._valueMax();var c=0<this.options.step?this.options.step:1,d=(b-this._valueMin())%c,b=b-d;return 2*Math.abs(d)>=c&&(b+=0<d?c:-c),parseFloat(b.toFixed(5))},_calculateNewMax:function(){var b=
this.options.max,c=this._valueMin(),d=this.options.step,b=Math.floor(+(b-c).toFixed(this._precision())/d)*d+c;this.max=parseFloat(b.toFixed(this._precision()))},_precision:function(){var b=this._precisionOf(this.options.step);return null!==this.options.min&&(b=Math.max(b,this._precisionOf(this.options.min))),b},_precisionOf:function(b){var b=""+b,c=b.indexOf(".");return-1===c?0:b.length-c-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var c,
d,e,f,g,h=this.options.range,p=this.options,s=this,r=this._animateOff?!1:p.animate,o={};this.options.values&&this.options.values.length?this.handles.each(function(e){d=100*((s.values(e)-s._valueMin())/(s._valueMax()-s._valueMin()));o["horizontal"===s.orientation?"left":"bottom"]=d+"%";b(this).stop(1,1)[r?"animate":"css"](o,p.animate);!0===s.options.range&&("horizontal"===s.orientation?(0===e&&s.range.stop(1,1)[r?"animate":"css"]({left:d+"%"},p.animate),1===e&&s.range[r?"animate":"css"]({width:d-c+
"%"},{queue:!1,duration:p.animate})):(0===e&&s.range.stop(1,1)[r?"animate":"css"]({bottom:d+"%"},p.animate),1===e&&s.range[r?"animate":"css"]({height:d-c+"%"},{queue:!1,duration:p.animate})));c=d}):(e=this.value(),f=this._valueMin(),g=this._valueMax(),d=g!==f?100*((e-f)/(g-f)):0,o["horizontal"===this.orientation?"left":"bottom"]=d+"%",this.handle.stop(1,1)[r?"animate":"css"](o,p.animate),"min"===h&&"horizontal"===this.orientation&&this.range.stop(1,1)[r?"animate":"css"]({width:d+"%"},p.animate),"max"===
h&&"horizontal"===this.orientation&&this.range[r?"animate":"css"]({width:100-d+"%"},{queue:!1,duration:p.animate}),"min"===h&&"vertical"===this.orientation&&this.range.stop(1,1)[r?"animate":"css"]({height:d+"%"},p.animate),"max"===h&&"vertical"===this.orientation&&this.range[r?"animate":"css"]({height:100-d+"%"},{queue:!1,duration:p.animate}))},_handleEvents:{keydown:function(c){var d,e,f,g=b(c.target).data("ui-slider-handle-index");switch(c.keyCode){case b.ui.keyCode.HOME:case b.ui.keyCode.END:case b.ui.keyCode.PAGE_UP:case b.ui.keyCode.PAGE_DOWN:case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:if(c.preventDefault(),
!this._keySliding&&(this._keySliding=!0,b(c.target).addClass("ui-state-active"),d=this._start(c,g),!1===d))return}switch(f=this.options.step,d=e=this.options.values&&this.options.values.length?this.values(g):this.value(),c.keyCode){case b.ui.keyCode.HOME:e=this._valueMin();break;case b.ui.keyCode.END:e=this._valueMax();break;case b.ui.keyCode.PAGE_UP:e=this._trimAlignValue(d+(this._valueMax()-this._valueMin())/this.numPages);break;case b.ui.keyCode.PAGE_DOWN:e=this._trimAlignValue(d-(this._valueMax()-
this._valueMin())/this.numPages);break;case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:if(d===this._valueMax())return;e=this._trimAlignValue(d+f);break;case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:if(d===this._valueMin())return;e=this._trimAlignValue(d-f)}this._slide(c,g,e)},keyup:function(c){var d=b(c.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(c,d),this._change(c,d),b(c.target).removeClass("ui-state-active"))}}});var h=b;b.effects={effect:{}};(function(b,
c){function d(b,c,e){var f=t[c.type]||{};return null==b?e||!c.def?null:c.def:(b=f.floor?~~b:parseFloat(b),isNaN(b)?c.def:f.mod?(b+f.mod)%f.mod:0>b?0:b>f.max?f.max:b)}function e(d){var f=r(),h=f._rgba=[];return d=d.toLowerCase(),z(s,function(b,e){var g,j=e.re.exec(d),j=j&&e.parse(j),l=e.space||"rgba";return j?(g=f[l](j),f[o[l].cache]=g[o[l].cache],h=f._rgba=g._rgba,!1):c}),h.length?("0,0,0,0"===h.join()&&b.extend(h,g.transparent),f):g[d]}function f(b,c,d){return d=(d+1)%1,1>6*d?b+6*(c-b)*d:1>2*d?c:
2>3*d?b+6*(c-b)*(2/3-d):b}var g,h=/^([\-+])=\s*(\d+\.?\d*)/,s=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(b){return[b[1],b[2],b[3],b[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(b){return[2.55*b[1],2.55*b[2],2.55*b[3],b[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(b){return[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]}},
{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(b){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(b){return[b[1],b[2]/100,b[3]/100,b[4]]}}],r=b.Color=function(c,d,e,f){return new b.Color.fn.parse(c,d,e,f)},o={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},
saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},t={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},u=r.support={},w=b("<p>")[0],z=b.each;w.style.cssText="background-color:rgba(1,1,1,.5)";u.rgba=-1<w.style.backgroundColor.indexOf("rgba");z(o,function(b,c){c.cache="_"+b;c.props.alpha={idx:3,type:"percent",def:1}});r.fn=b.extend(r.prototype,{parse:function(f,h,n,s){if(f===c)return this._rgba=[null,null,null,null],this;(f.jquery||f.nodeType)&&(f=b(f).css(h),
h=c);var u=this,t=b.type(f),p=this._rgba=[];return h!==c&&(f=[f,h,n,s],t="array"),"string"===t?this.parse(e(f)||g._default):"array"===t?(z(o.rgba.props,function(b,c){p[c.idx]=d(f[c.idx],c)}),this):"object"===t?(f instanceof r?z(o,function(b,c){f[c.cache]&&(u[c.cache]=f[c.cache].slice())}):z(o,function(c,e){var g=e.cache;z(e.props,function(b,c){if(!u[g]&&e.to){if("alpha"===b||null==f[b])return;u[g]=e.to(u._rgba)}u[g][c.idx]=d(f[b],c,!0)});u[g]&&0>b.inArray(null,u[g].slice(0,3))&&(u[g][3]=1,e.from&&
(u._rgba=e.from(u[g])))}),this):c},is:function(b){var d=r(b),e=!0,f=this;return z(o,function(b,g){var j,h=d[g.cache];return h&&(j=f[g.cache]||g.to&&g.to(f._rgba)||[],z(g.props,function(b,d){return null!=h[d.idx]?e=h[d.idx]===j[d.idx]:c})),e}),e},_space:function(){var b=[],c=this;return z(o,function(d,e){c[e.cache]&&b.push(d)}),b.pop()},transition:function(b,c){var e=r(b),f=e._space(),g=o[f],j=0===this.alpha()?r("transparent"):this,h=j[g.cache]||g.to(j._rgba),k=h.slice();return e=e[g.cache],z(g.props,
function(b,f){var g=f.idx,j=h[g],o=e[g],m=t[f.type]||{};null!==o&&(null===j?k[g]=o:(m.mod&&(o-j>m.mod/2?j+=m.mod:j-o>m.mod/2&&(j-=m.mod)),k[g]=d((o-j)*c+j,f)))}),this[f](k)},blend:function(c){if(1===this._rgba[3])return this;var d=this._rgba.slice(),e=d.pop(),f=r(c)._rgba;return r(b.map(d,function(b,c){return(1-e)*f[c]+e*b}))},toRgbaString:function(){var c="rgba(",d=b.map(this._rgba,function(b,c){return null==b?2<c?1:0:b});return 1===d[3]&&(d.pop(),c="rgb("),c+d.join()+")"},toHslaString:function(){var c=
"hsla(",d=b.map(this.hsla(),function(b,c){return null==b&&(b=2<c?1:0),c&&3>c&&(b=Math.round(100*b)+"%"),b});return 1===d[3]&&(d.pop(),c="hsl("),c+d.join()+")"},toHexString:function(c){var d=this._rgba.slice(),e=d.pop();return c&&d.push(~~(255*e)),"#"+b.map(d,function(b){return b=(b||0).toString(16),1===b.length?"0"+b:b}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}});r.fn.parse.prototype=r.fn;o.hsla.to=function(b){if(null==b[0]||null==b[1]||null==b[2])return[null,
null,null,b[3]];var c,d,e=b[0]/255,f=b[1]/255,g=b[2]/255,b=b[3],j=Math.max(e,f,g),h=Math.min(e,f,g),k=j-h,l=j+h,o=0.5*l;return c=h===j?0:e===j?60*(f-g)/k+360:f===j?60*(g-e)/k+120:60*(e-f)/k+240,d=0===k?0:0.5>=o?k/l:k/(2-l),[Math.round(c)%360,d,o,null==b?1:b]};o.hsla.from=function(b){if(null==b[0]||null==b[1]||null==b[2])return[null,null,null,b[3]];var c=b[0]/360,d=b[1],e=b[2],b=b[3],d=0.5>=e?e*(1+d):e+d-e*d,e=2*e-d;return[Math.round(255*f(e,d,c+1/3)),Math.round(255*f(e,d,c)),Math.round(255*f(e,d,
c-1/3)),b]};z(o,function(e,f){var g=f.props,o=f.cache,m=f.to,n=f.from;r.fn[e]=function(e){if(m&&!this[o]&&(this[o]=m(this._rgba)),e===c)return this[o].slice();var f,h=b.type(e),s="array"===h||"object"===h?e:arguments,u=this[o].slice();return z(g,function(b,c){var e=s["object"===h?b:c.idx];null==e&&(e=u[c.idx]);u[c.idx]=d(e,c)}),n?(f=r(n(u)),f[o]=u,f):r(u)};z(g,function(c,d){r.fn[c]||(r.fn[c]=function(f){var g,k=b.type(f),l="alpha"===c?this._hsla?"hsla":"rgba":e,o=this[l](),m=o[d.idx];return"undefined"===
k?m:("function"===k&&(f=f.call(this,m),k=b.type(f)),null==f&&d.empty?this:("string"===k&&(g=h.exec(f),g&&(f=m+parseFloat(g[2])*("+"===g[1]?1:-1))),o[d.idx]=f,this[l](o)))})})});r.hook=function(c){c=c.split(" ");z(c,function(c,d){b.cssHooks[d]={set:function(c,f){var g,h="";if("transparent"!==f&&("string"!==b.type(f)||(g=e(f)))){if(f=r(g||f),!u.rgba&&1!==f._rgba[3]){for(g="backgroundColor"===d?c.parentNode:c;(""===h||"transparent"===h)&&g&&g.style;)try{h=b.css(g,"backgroundColor"),g=g.parentNode}catch(k){}f=
f.blend(h&&"transparent"!==h?h:"_default")}f=f.toRgbaString()}try{c.style[d]=f}catch(l){}}};b.fx.step[d]=function(c){c.colorInit||(c.start=r(c.elem,d),c.end=r(c.end),c.colorInit=!0);b.cssHooks[d].set(c.elem,c.start.transition(c.end,c.pos))}})};r.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor");b.cssHooks.borderColor={expand:function(b){var c={};return z(["Top","Right","Bottom","Left"],
function(d,e){c["border"+e+"Color"]=b}),c}};g=b.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(h);(function(){function c(d){var e,f=d.ownerDocument.defaultView?d.ownerDocument.defaultView.getComputedStyle(d,null):d.currentStyle,
g={};if(f&&f.length&&f[0]&&f[f[0]])for(d=f.length;d--;)e=f[d],"string"==typeof f[e]&&(g[b.camelCase(e)]=f[e]);else for(e in f)"string"==typeof f[e]&&(g[e]=f[e]);return g}var d=["add","remove","toggle"],e={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};b.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(c,d){b.fx.step[d]=function(b){("none"!==b.end&&!b.setAttr||1===b.pos&&!b.setAttr)&&(h.style(b.elem,
d,b.end),b.setAttr=!0)}});b.fn.addBack||(b.fn.addBack=function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))});b.effects.animateClass=function(f,g,h,p){var s=b.speed(g,h,p);return this.queue(function(){var g,h=b(this),n=h.attr("class")||"",u=s.children?h.find("*").addBack():h,u=u.map(function(){return{el:b(this),start:c(this)}});g=function(){b.each(d,function(b,c){f[c]&&h[c+"Class"](f[c])})};g();u=u.map(function(){this.end=c(this.el[0]);var d=this.start,f=this.end,g,h,k={};
for(g in f)h=f[g],d[g]!==h&&(e[g]||(b.fx.step[g]||!isNaN(parseFloat(h)))&&(k[g]=h));return this.diff=k,this});h.attr("class",n);u=u.map(function(){var c=this,d=b.Deferred();return this.el.animate(this.diff,b.extend({},s,{queue:!1,complete:function(){d.resolve(c)}})),d.promise()});b.when.apply(b,u.get()).done(function(){g();b.each(arguments,function(){var c=this.el;b.each(this.diff,function(b){c.css(b,"")})});s.complete.call(h[0])})})};b.fn.extend({addClass:function(c){return function(d,e,f,g){return e?
b.effects.animateClass.call(this,{add:d},e,f,g):c.apply(this,arguments)}}(b.fn.addClass),removeClass:function(c){return function(d,e,f,g){return 1<arguments.length?b.effects.animateClass.call(this,{remove:d},e,f,g):c.apply(this,arguments)}}(b.fn.removeClass),toggleClass:function(c){return function(d,e,f,g,j){return"boolean"==typeof e||void 0===e?f?b.effects.animateClass.call(this,e?{add:d}:{remove:d},f,g,j):c.apply(this,arguments):b.effects.animateClass.call(this,{toggle:d},e,f,g)}}(b.fn.toggleClass),
switchClass:function(c,d,e,f,g){return b.effects.animateClass.call(this,{add:d,remove:c},e,f,g)}})})();(function(){function c(d,e,f,g){return b.isPlainObject(d)&&(e=d,d=d.effect),d={effect:d},null==e&&(e={}),b.isFunction(e)&&(g=e,f=null,e={}),("number"==typeof e||b.fx.speeds[e])&&(g=f,f=e,e={}),b.isFunction(f)&&(g=f,f=null),e&&b.extend(d,e),f=f||e.duration,d.duration=b.fx.off?0:"number"==typeof f?f:f in b.fx.speeds?b.fx.speeds[f]:b.fx.speeds._default,d.complete=g||e.complete,d}function d(c){return!c||
"number"==typeof c||b.fx.speeds[c]?!0:"string"!=typeof c||b.effects.effect[c]?b.isFunction(c)?!0:"object"!=typeof c||c.effect?!1:!0:!0}b.extend(b.effects,{version:"1.11.4",save:function(b,c){for(var d=0;c.length>d;d++)null!==c[d]&&b.data("ui-effects-"+c[d],b[0].style[c[d]])},restore:function(b,c){var d,e;for(e=0;c.length>e;e++)null!==c[e]&&(d=b.data("ui-effects-"+c[e]),void 0===d&&(d=""),b.css(c[e],d))},setMode:function(b,c){return"toggle"===c&&(c=b.is(":hidden")?"show":"hide"),c},getBaseline:function(b,
c){var d,e;switch(b[0]){case "top":d=0;break;case "middle":d=0.5;break;case "bottom":d=1;break;default:d=b[0]/c.height}switch(b[1]){case "left":e=0;break;case "center":e=0.5;break;case "right":e=1;break;default:e=b[1]/c.width}return{x:e,y:d}},createWrapper:function(c){if(c.parent().is(".ui-effects-wrapper"))return c.parent();var d={width:c.outerWidth(!0),height:c.outerHeight(!0),"float":c.css("float")},e=b("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",
border:"none",margin:0,padding:0}),f={width:c.width(),height:c.height()},g=document.activeElement;try{g.id}catch(j){g=document.body}return c.wrap(e),(c[0]===g||b.contains(c[0],g))&&b(g).focus(),e=c.parent(),"static"===c.css("position")?(e.css({position:"relative"}),c.css({position:"relative"})):(b.extend(d,{position:c.css("position"),zIndex:c.css("z-index")}),b.each(["top","left","bottom","right"],function(b,e){d[e]=c.css(e);isNaN(parseInt(d[e],10))&&(d[e]="auto")}),c.css({position:"relative",top:0,
left:0,right:"auto",bottom:"auto"})),c.css(f),e.css(d).show()},removeWrapper:function(c){var d=document.activeElement;return c.parent().is(".ui-effects-wrapper")&&(c.parent().replaceWith(c),(c[0]===d||b.contains(c[0],d))&&b(d).focus()),c},setTransition:function(c,d,e,f){return f=f||{},b.each(d,function(b,d){var g=c.cssUnit(d);0<g[0]&&(f[d]=g[0]*e+g[1])}),f}});b.fn.extend({effect:function(){function d(c){function f(){b.isFunction(j)&&j.call(g[0]);b.isFunction(c)&&c()}var g=b(this),j=e.complete,k=e.mode;
(g.is(":hidden")?"hide"===k:"show"===k)?(g[k](),f()):h.call(g[0],e,f)}var e=c.apply(this,arguments),f=e.mode,g=e.queue,h=b.effects.effect[e.effect];return b.fx.off||!h?f?this[f](e.duration,e.complete):this.each(function(){e.complete&&e.complete.call(this)}):!1===g?this.each(d):this.queue(g||"fx",d)},show:function(b){return function(e){if(d(e))return b.apply(this,arguments);var f=c.apply(this,arguments);return f.mode="show",this.effect.call(this,f)}}(b.fn.show),hide:function(b){return function(e){if(d(e))return b.apply(this,
arguments);var f=c.apply(this,arguments);return f.mode="hide",this.effect.call(this,f)}}(b.fn.hide),toggle:function(b){return function(e){if(d(e)||"boolean"==typeof e)return b.apply(this,arguments);var f=c.apply(this,arguments);return f.mode="toggle",this.effect.call(this,f)}}(b.fn.toggle),cssUnit:function(c){var d=this.css(c),e=[];return b.each(["em","px","%","pt"],function(b,c){0<d.indexOf(c)&&(e=[parseFloat(d),c])}),e}})})();(function(){var c={};b.each(["Quad","Cubic","Quart","Quint","Expo"],function(b,
d){c[d]=function(c){return Math.pow(c,b+2)}});b.extend(c,{Sine:function(b){return 1-Math.cos(b*Math.PI/2)},Circ:function(b){return 1-Math.sqrt(1-b*b)},Elastic:function(b){return 0===b||1===b?b:-Math.pow(2,8*(b-1))*Math.sin((80*(b-1)-7.5)*Math.PI/15)},Back:function(b){return b*b*(3*b-2)},Bounce:function(b){for(var c,d=4;((c=Math.pow(2,--d))-1)/11>b;);return 1/Math.pow(4,3-d)-7.5625*Math.pow((3*c-2)/22-b,2)}});b.each(c,function(c,d){b.easing["easeIn"+c]=d;b.easing["easeOut"+c]=function(b){return 1-
d(1-b)};b.easing["easeInOut"+c]=function(b){return 0.5>b?d(2*b)/2:1-d(-2*b+2)/2}})})();b.effects;b.effects.effect.blind=function(c,d){var e,f,g,h=b(this),p="position top bottom left right height width".split(" "),s=b.effects.setMode(h,c.mode||"hide");e=c.direction||"up";var r=/up|down|vertical/.test(e),o=r?"height":"width",t=r?"top":"left",u=/up|left|vertical|horizontal/.test(e),w={},z="show"===s;h.parent().is(".ui-effects-wrapper")?b.effects.save(h.parent(),p):b.effects.save(h,p);h.show();e=b.effects.createWrapper(h).css({overflow:"hidden"});
f=e[o]();g=parseFloat(e.css(t))||0;w[o]=z?f:0;u||(h.css(r?"bottom":"right",0).css(r?"top":"left","auto").css({position:"absolute"}),w[t]=z?g:f+g);z&&(e.css(o,0),u||e.css(t,g+f));e.animate(w,{duration:c.duration,easing:c.easing,queue:!1,complete:function(){"hide"===s&&h.hide();b.effects.restore(h,p);b.effects.removeWrapper(h);d()}})};b.effects.effect.bounce=function(c,d){var e,f,g,h=b(this),p="position top bottom left right height width".split(" "),s=b.effects.setMode(h,c.mode||"effect"),r="hide"===
s;e="show"===s;var o=c.direction||"up",s=c.distance,t=c.times||5,u=2*t+(e||r?1:0),w=c.duration/u,z=c.easing,A="up"===o||"down"===o?"top":"left",o="up"===o||"left"===o,C=h.queue(),G=C.length;(e||r)&&p.push("opacity");b.effects.save(h,p);h.show();b.effects.createWrapper(h);s||(s=h["top"===A?"outerHeight":"outerWidth"]()/3);e&&(g={opacity:1},g[A]=0,h.css("opacity",0).css(A,o?2*-s:2*s).animate(g,w,z));r&&(s/=Math.pow(2,t-1));g={};for(e=g[A]=0;t>e;e++)f={},f[A]=(o?"-=":"+=")+s,h.animate(f,w,z).animate(g,
w,z),s=r?2*s:s/2;r&&(f={opacity:0},f[A]=(o?"-=":"+=")+s,h.animate(f,w,z));h.queue(function(){r&&h.hide();b.effects.restore(h,p);b.effects.removeWrapper(h);d()});1<G&&C.splice.apply(C,[1,0].concat(C.splice(G,u+1)));h.dequeue()};b.effects.effect.clip=function(c,d){var e,f,g=b(this),h="position top bottom left right height width".split(" "),p="show"===b.effects.setMode(g,c.mode||"hide"),s="vertical"===(c.direction||"vertical"),r=s?"height":"width",s=s?"top":"left",o={};b.effects.save(g,h);g.show();e=
b.effects.createWrapper(g).css({overflow:"hidden"});e="IMG"===g[0].tagName?e:g;f=e[r]();p&&(e.css(r,0),e.css(s,f/2));o[r]=p?f:0;o[s]=p?0:f/2;e.animate(o,{queue:!1,duration:c.duration,easing:c.easing,complete:function(){p||g.hide();b.effects.restore(g,h);b.effects.removeWrapper(g);d()}})};b.effects.effect.drop=function(c,d){var e,f=b(this),g="position top bottom left right opacity height width".split(" "),h=b.effects.setMode(f,c.mode||"hide"),p="show"===h;e=c.direction||"left";var s="up"===e||"down"===
e?"top":"left",r="up"===e||"left"===e?"pos":"neg",o={opacity:p?1:0};b.effects.save(f,g);f.show();b.effects.createWrapper(f);e=c.distance||f["top"===s?"outerHeight":"outerWidth"](!0)/2;p&&f.css("opacity",0).css(s,"pos"===r?-e:e);o[s]=(p?"pos"===r?"+=":"-=":"pos"===r?"-=":"+=")+e;f.animate(o,{queue:!1,duration:c.duration,easing:c.easing,complete:function(){"hide"===h&&f.hide();b.effects.restore(f,g);b.effects.removeWrapper(f);d()}})};b.effects.effect.explode=function(c,d){function e(){G.push(this);
G.length===o*t&&(u.css({visibility:"visible"}),b(G).remove(),w||u.hide(),d())}var f,g,h,p,s,r,o=c.pieces?Math.round(Math.sqrt(c.pieces)):3,t=o,u=b(this),w="show"===b.effects.setMode(u,c.mode||"hide"),z=u.show().css("visibility","hidden").offset(),A=Math.ceil(u.outerWidth()/t),C=Math.ceil(u.outerHeight()/o),G=[];for(f=0;o>f;f++){p=z.top+f*C;r=f-(o-1)/2;for(g=0;t>g;g++)h=z.left+g*A,s=g-(t-1)/2,u.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-g*A,top:-f*
C}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:A,height:C,left:h+(w?s*A:0),top:p+(w?r*C:0),opacity:w?0:1}).animate({left:h+(w?0:s*A),top:p+(w?0:r*C),opacity:w?1:0},c.duration||500,c.easing,e)}};b.effects.effect.fade=function(c,d){var e=b(this),f=b.effects.setMode(e,c.mode||"toggle");e.animate({opacity:f},{queue:!1,duration:c.duration,easing:c.easing,complete:d})};b.effects.effect.fold=function(c,d){var e,f,g=b(this),h="position top bottom left right height width".split(" ");
e=b.effects.setMode(g,c.mode||"hide");var p="show"===e,s="hide"===e,r=c.size||15,o=/([0-9]+)%/.exec(r),t=!!c.horizFirst,u=(f=p!==t)?["width","height"]:["height","width"],w=c.duration/2,z={},A={};b.effects.save(g,h);g.show();e=b.effects.createWrapper(g).css({overflow:"hidden"});f=f?[e.width(),e.height()]:[e.height(),e.width()];o&&(r=parseInt(o[1],10)/100*f[s?0:1]);p&&e.css(t?{height:0,width:r}:{height:r,width:0});z[u[0]]=p?f[0]:r;A[u[1]]=p?f[1]:0;e.animate(z,w,c.easing).animate(A,w,c.easing,function(){s&&
g.hide();b.effects.restore(g,h);b.effects.removeWrapper(g);d()})};b.effects.effect.highlight=function(c,d){var e=b(this),f=["backgroundImage","backgroundColor","opacity"],g=b.effects.setMode(e,c.mode||"show"),h={backgroundColor:e.css("backgroundColor")};"hide"===g&&(h.opacity=0);b.effects.save(e,f);e.show().css({backgroundImage:"none",backgroundColor:c.color||"#ffff99"}).animate(h,{queue:!1,duration:c.duration,easing:c.easing,complete:function(){"hide"===g&&e.hide();b.effects.restore(e,f);d()}})};
b.effects.effect.size=function(c,d){var e,f,g,h,p,s,r=b(this),o="position top bottom left right width height overflow opacity".split(" ");p="position top bottom left right overflow opacity".split(" ");var t=["width","height","overflow"],u=["fontSize"],w=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],z=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],A=b.effects.setMode(r,c.mode||"effect"),C=c.restore||"effect"!==A,G=c.scale||"both",H=c.origin||["middle","center"],
K=r.css("position"),P=C?o:p,T={height:0,width:0,outerHeight:0,outerWidth:0};"show"===A&&r.show();p={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};"toggle"===c.mode&&"show"===A?(r.from=c.to||T,r.to=c.from||p):(r.from=c.from||("show"===A?T:p),r.to=c.to||("hide"===A?T:p));g=r.from.height/p.height;h=r.from.width/p.width;e=r.to.height/p.height;f=r.to.width/p.width;("box"===G||"both"===G)&&(g!==e&&(P=P.concat(w),r.from=b.effects.setTransition(r,w,g,r.from),r.to=
b.effects.setTransition(r,w,e,r.to)),h!==f&&(P=P.concat(z),r.from=b.effects.setTransition(r,z,h,r.from),r.to=b.effects.setTransition(r,z,f,r.to)));("content"===G||"both"===G)&&g!==e&&(P=P.concat(u).concat(t),r.from=b.effects.setTransition(r,u,g,r.from),r.to=b.effects.setTransition(r,u,e,r.to));b.effects.save(r,P);r.show();b.effects.createWrapper(r);r.css("overflow","hidden").css(r.from);H&&(s=b.effects.getBaseline(H,p),r.from.top=(p.outerHeight-r.outerHeight())*s.y,r.from.left=(p.outerWidth-r.outerWidth())*
s.x,r.to.top=(p.outerHeight-r.to.outerHeight)*s.y,r.to.left=(p.outerWidth-r.to.outerWidth)*s.x);r.css(r.from);("content"===G||"both"===G)&&(w=w.concat(["marginTop","marginBottom"]).concat(u),z=z.concat(["marginLeft","marginRight"]),t=o.concat(w).concat(z),r.find("*[width]").each(function(){var d=b(this),k=d.height(),o=d.width(),s=d.outerHeight(),u=d.outerWidth();C&&b.effects.save(d,t);d.from={height:k*g,width:o*h,outerHeight:s*g,outerWidth:u*h};d.to={height:k*e,width:o*f,outerHeight:k*e,outerWidth:o*
f};g!==e&&(d.from=b.effects.setTransition(d,w,g,d.from),d.to=b.effects.setTransition(d,w,e,d.to));h!==f&&(d.from=b.effects.setTransition(d,z,h,d.from),d.to=b.effects.setTransition(d,z,f,d.to));d.css(d.from);d.animate(d.to,c.duration,c.easing,function(){C&&b.effects.restore(d,t)})}));r.animate(r.to,{queue:!1,duration:c.duration,easing:c.easing,complete:function(){0===r.to.opacity&&r.css("opacity",r.from.opacity);"hide"===A&&r.hide();b.effects.restore(r,P);C||("static"===K?r.css({position:"relative",
top:r.to.top,left:r.to.left}):b.each(["top","left"],function(b,c){r.css(c,function(c,d){var e=parseInt(d,10),f=b?r.to.left:r.to.top;return"auto"===d?f+"px":e+f+"px"})}));b.effects.removeWrapper(r);d()}})};b.effects.effect.scale=function(c,d){var e=b(this),f=b.extend(!0,{},c),g=b.effects.setMode(e,c.mode||"effect"),h=parseInt(c.percent,10)||(0===parseInt(c.percent,10)?0:"hide"===g?0:100),p=c.direction||"both",s=c.origin,r={height:e.height(),width:e.width(),outerHeight:e.outerHeight(),outerWidth:e.outerWidth()},
o="horizontal"!==p?h/100:1,h="vertical"!==p?h/100:1;f.effect="size";f.queue=!1;f.complete=d;"effect"!==g&&(f.origin=s||["middle","center"],f.restore=!0);f.from=c.from||("show"===g?{height:0,width:0,outerHeight:0,outerWidth:0}:r);f.to={height:r.height*o,width:r.width*h,outerHeight:r.outerHeight*o,outerWidth:r.outerWidth*h};f.fade&&("show"===g&&(f.from.opacity=0,f.to.opacity=1),"hide"===g&&(f.from.opacity=1,f.to.opacity=0));e.effect(f)};b.effects.effect.puff=function(c,d){var e=b(this),f=b.effects.setMode(e,
c.mode||"hide"),g="hide"===f,h=parseInt(c.percent,10)||150,p=h/100,s={height:e.height(),width:e.width(),outerHeight:e.outerHeight(),outerWidth:e.outerWidth()};b.extend(c,{effect:"scale",queue:!1,fade:!0,mode:f,complete:d,percent:g?h:100,from:g?s:{height:s.height*p,width:s.width*p,outerHeight:s.outerHeight*p,outerWidth:s.outerWidth*p}});e.effect(c)};b.effects.effect.pulsate=function(c,d){var e,f=b(this),g=b.effects.setMode(f,c.mode||"show");e="show"===g;var h="hide"===g,g=2*(c.times||5)+(e||"hide"===
g?1:0),p=c.duration/g,s=0,r=f.queue(),o=r.length;(e||!f.is(":visible"))&&(f.css("opacity",0).show(),s=1);for(e=1;g>e;e++)f.animate({opacity:s},p,c.easing),s=1-s;f.animate({opacity:s},p,c.easing);f.queue(function(){h&&f.hide();d()});1<o&&r.splice.apply(r,[1,0].concat(r.splice(o,g+1)));f.dequeue()};b.effects.effect.shake=function(c,d){var e,f=b(this),g="position top bottom left right height width".split(" "),h=b.effects.setMode(f,c.mode||"effect"),p=c.direction||"left";e=c.distance||20;var s=c.times||
3,r=2*s+1,o=Math.round(c.duration/r),t="up"===p||"down"===p?"top":"left",u="up"===p||"left"===p,p={},w={},z={},A=f.queue(),C=A.length;b.effects.save(f,g);f.show();b.effects.createWrapper(f);p[t]=(u?"-=":"+=")+e;w[t]=(u?"+=":"-=")+2*e;z[t]=(u?"-=":"+=")+2*e;f.animate(p,o,c.easing);for(e=1;s>e;e++)f.animate(w,o,c.easing).animate(z,o,c.easing);f.animate(w,o,c.easing).animate(p,o/2,c.easing).queue(function(){"hide"===h&&f.hide();b.effects.restore(f,g);b.effects.removeWrapper(f);d()});1<C&&A.splice.apply(A,
[1,0].concat(A.splice(C,r+1)));f.dequeue()};b.effects.effect.slide=function(c,d){var e,f=b(this),g="position top bottom left right width height".split(" "),h=b.effects.setMode(f,c.mode||"show"),p="show"===h;e=c.direction||"left";var s="up"===e||"down"===e?"top":"left",r="up"===e||"left"===e,o={};b.effects.save(f,g);f.show();e=c.distance||f["top"===s?"outerHeight":"outerWidth"](!0);b.effects.createWrapper(f).css({overflow:"hidden"});p&&f.css(s,r?isNaN(e)?"-"+e:-e:e);o[s]=(p?r?"+=":"-=":r?"-=":"+=")+
e;f.animate(o,{queue:!1,duration:c.duration,easing:c.easing,complete:function(){"hide"===h&&f.hide();b.effects.restore(f,g);b.effects.removeWrapper(f);d()}})};b.effects.effect.transfer=function(c,d){var e=b(this),f=b(c.to),g="fixed"===f.css("position"),h=b("body"),p=g?h.scrollTop():0,h=g?h.scrollLeft():0,s=f.offset(),f={top:s.top-p,left:s.left-h,height:f.innerHeight(),width:f.innerWidth()},s=e.offset(),r=b("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(c.className).css({top:s.top-
p,left:s.left-h,height:e.innerHeight(),width:e.innerWidth(),position:g?"fixed":"absolute"}).animate(f,c.duration,c.easing,function(){r.remove();d()})}});
!function(b){var c=null;b.modal=function(d,e){b.modal.close();var f,g;if(this.$body=b("body"),this.options=b.extend({},b.modal.defaults,e),this.options.doFade=!isNaN(parseInt(this.options.fadeDuration,10)),d.is("a"))if(g=d.attr("href"),/^#/.test(g)){if(this.$elm=b(g),1!==this.$elm.length)return null;this.open()}else this.$elm=b("<div>"),this.$body.append(this.$elm),f=function(b,c){c.elm.remove()},this.showSpinner(),d.trigger(b.modal.AJAX_SEND),b.get(g).done(function(e){c&&(d.trigger(b.modal.AJAX_SUCCESS),
c.$elm.empty().append(e).on(b.modal.CLOSE,f),c.hideSpinner(),c.open(),d.trigger(b.modal.AJAX_COMPLETE))}).fail(function(){d.trigger(b.modal.AJAX_FAIL);c.hideSpinner();d.trigger(b.modal.AJAX_COMPLETE)});else this.$elm=d,this.open()};b.modal.prototype={constructor:b.modal,open:function(){var c=this;this.options.doFade?(this.block(),setTimeout(function(){c.show()},this.options.fadeDuration*this.options.fadeDelay)):(this.block(),this.show());this.options.escapeClose&&b(document).on("keydown.modal",function(c){27==
c.which&&b.modal.close()});this.options.clickClose&&this.blocker.click(b.modal.close)},close:function(){this.unblock();this.hide();b(document).off("keydown.modal")},block:function(){var c=this.options.doFade?0:this.options.opacity;this.$elm.trigger(b.modal.BEFORE_BLOCK,[this._ctx()]);this.blocker=b('<div class="jquery-modal blocker"></div>').css({top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",position:"fixed",zIndex:this.options.zIndex,background:this.options.overlay,opacity:c});this.$body.append(this.blocker);
this.options.doFade&&this.blocker.animate({opacity:this.options.opacity},this.options.fadeDuration);this.$elm.trigger(b.modal.BLOCK,[this._ctx()])},unblock:function(){this.options.doFade?this.blocker.fadeOut(this.options.fadeDuration,function(){b(this).remove()}):this.blocker.remove()},show:function(){this.$elm.trigger(b.modal.BEFORE_OPEN,[this._ctx()]);this.options.showClose&&(this.closeButton=b('<a href="#close-modal" rel="modal:close" class="close-modal '+this.options.closeClass+'">'+this.options.closeText+
"</a>"),this.$elm.append(this.closeButton));this.$elm.addClass(this.options.modalClass+" current");this.center();this.options.doFade?this.$elm.fadeIn(this.options.fadeDuration):this.$elm.show();this.$elm.trigger(b.modal.OPEN,[this._ctx()])},hide:function(){this.$elm.trigger(b.modal.BEFORE_CLOSE,[this._ctx()]);this.closeButton&&this.closeButton.remove();this.$elm.removeClass("current");this.options.doFade?this.$elm.fadeOut(this.options.fadeDuration):this.$elm.hide();this.$elm.trigger(b.modal.CLOSE,
[this._ctx()])},showSpinner:function(){this.options.showSpinner&&(this.spinner=this.spinner||b('<div class="'+this.options.modalClass+'-spinner"></div>').append(this.options.spinnerHtml),this.$body.append(this.spinner),this.spinner.show())},hideSpinner:function(){this.spinner&&this.spinner.remove()},center:function(){this.$elm.css({position:"fixed",top:"50%",left:"50%",marginTop:-(this.$elm.outerHeight()/2),marginLeft:-(this.$elm.outerWidth()/2),zIndex:this.options.zIndex+1})},_ctx:function(){return{elm:this.$elm,
blocker:this.blocker,options:this.options}}};b.modal.prototype.resize=b.modal.prototype.center;b.modal.close=function(b){if(c)return b&&b.preventDefault(),c.close(),b=c.$elm,c=null,b};b.modal.resize=function(){c&&c.resize()};b.modal.isActive=function(){return c?!0:!1};b.modal.defaults={overlay:"#000",opacity:0.75,zIndex:1E3,escapeClose:!0,clickClose:!0,closeText:"",closeClass:"",modalClass:"modal",spinnerHtml:null,showSpinner:!0,showClose:!0,fadeDuration:null,fadeDelay:1};b.modal.BEFORE_BLOCK="modal:before-block";
b.modal.BLOCK="modal:block";b.modal.BEFORE_OPEN="modal:before-open";b.modal.OPEN="modal:open";b.modal.BEFORE_CLOSE="modal:before-close";b.modal.CLOSE="modal:close";b.modal.AJAX_SEND="modal:ajax:send";b.modal.AJAX_SUCCESS="modal:ajax:success";b.modal.AJAX_FAIL="modal:ajax:fail";b.modal.AJAX_COMPLETE="modal:ajax:complete";b.fn.modal=function(d){return 1===this.length&&(c=new b.modal(this,d)),this};b(document).on("click.modal",'a[rel="modal:close"]',b.modal.close);b(document).on("click.modal",'a[rel="modal:open"]',
function(c){c.preventDefault();b(this).modal()})}(jQuery);
var swfobject=function(){function b(){if(!Q){try{var b=G.getElementsByTagName("body")[0].appendChild(G.createElement("span"));b.parentNode.removeChild(b)}catch(c){return}Q=!0;for(var b=P.length,d=0;d<b;d++)P[d]()}}function c(b){Q?b():P[P.length]=b}function d(b){if(typeof C.addEventListener!=u)C.addEventListener("load",b,!1);else if(typeof G.addEventListener!=u)G.addEventListener("load",b,!1);else if(typeof C.attachEvent!=u)p(C,"onload",b);else if("function"==typeof C.onload){var c=C.onload;C.onload=
function(){c();b()}}else C.onload=b}function e(){var b=G.getElementsByTagName("body")[0],c=G.createElement(w);c.setAttribute("type",z);var d=b.appendChild(c);if(d){var e=0;(function(){if(typeof d.GetVariable!=u){var g=d.GetVariable("$version");g&&(g=g.split(" ")[1].split(","),M.pv=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)])}else if(10>e){e++;setTimeout(arguments.callee,10);return}b.removeChild(c);d=null;f()})()}else f()}function f(){var b=T.length;if(0<b)for(var c=0;c<b;c++){var d=T[c].id,
e=T[c].callbackFn,f={success:!1,id:d};if(0<M.pv[0]){var l=q(d);if(l)if(s(T[c].swfVersion)&&!(M.wk&&312>M.wk))o(d,!0),e&&(f.success=!0,f.ref=g(d),e(f));else if(T[c].expressInstall&&h()){f={};f.data=T[c].expressInstall;f.width=l.getAttribute("width")||"0";f.height=l.getAttribute("height")||"0";l.getAttribute("class")&&(f.styleclass=l.getAttribute("class"));l.getAttribute("align")&&(f.align=l.getAttribute("align"));for(var m={},l=l.getElementsByTagName("param"),n=l.length,t=0;t<n;t++)"movie"!=l[t].getAttribute("name").toLowerCase()&&
(m[l[t].getAttribute("name")]=l[t].getAttribute("value"));j(f,m,d,e)}else k(l),e&&e(f)}else if(o(d,!0),e){if((d=g(d))&&typeof d.SetVariable!=u)f.success=!0,f.ref=d;e(f)}}}function g(b){var c=null;if((b=q(b))&&"OBJECT"==b.nodeName)typeof b.SetVariable!=u?c=b:(b=b.getElementsByTagName(w)[0])&&(c=b);return c}function h(){return!B&&s("6.0.65")&&(M.win||M.mac)&&!(M.wk&&312>M.wk)}function j(b,c,d,e){B=!0;N=e||null;U={success:!1,id:d};var f=q(d);if(f){"OBJECT"==f.nodeName?(I=l(f),J=null):(I=f,J=d);b.id=
A;if(typeof b.width==u||!/%$/.test(b.width)&&310>parseInt(b.width,10))b.width="310";if(typeof b.height==u||!/%$/.test(b.height)&&137>parseInt(b.height,10))b.height="137";G.title=G.title.slice(0,47)+" - Flash Player Installation";e=M.ie&&M.win?"ActiveX":"PlugIn";e="MMredirectURL="+C.location.toString().replace(/&/g,"%26")+"&MMplayerType="+e+"&MMdoctitle="+G.title;c.flashvars=typeof c.flashvars!=u?c.flashvars+("&"+e):e;M.ie&&(M.win&&4!=f.readyState)&&(e=G.createElement("div"),d+="SWFObjectNew",e.setAttribute("id",
d),f.parentNode.insertBefore(e,f),f.style.display="none",function(){f.readyState==4?f.parentNode.removeChild(f):setTimeout(arguments.callee,10)}());m(b,c,d)}}function k(b){if(M.ie&&M.win&&4!=b.readyState){var c=G.createElement("div");b.parentNode.insertBefore(c,b);c.parentNode.replaceChild(l(b),c);b.style.display="none";(function(){4==b.readyState?b.parentNode.removeChild(b):setTimeout(arguments.callee,10)})()}else b.parentNode.replaceChild(l(b),b)}function l(b){var c=G.createElement("div");if(M.win&&
M.ie)c.innerHTML=b.innerHTML;else if(b=b.getElementsByTagName(w)[0])if(b=b.childNodes)for(var d=b.length,e=0;e<d;e++)!(1==b[e].nodeType&&"PARAM"==b[e].nodeName)&&8!=b[e].nodeType&&c.appendChild(b[e].cloneNode(!0));return c}function m(b,c,d){var e,f=q(d);if(M.wk&&312>M.wk)return e;if(f)if(typeof b.id==u&&(b.id=d),M.ie&&M.win){var g="",h;for(h in b)b[h]!=Object.prototype[h]&&("data"==h.toLowerCase()?c.movie=b[h]:"styleclass"==h.toLowerCase()?g+=' class="'+b[h]+'"':"classid"!=h.toLowerCase()&&(g+=" "+
h+'="'+b[h]+'"'));h="";for(var j in c)c[j]!=Object.prototype[j]&&(h+='<param name="'+j+'" value="'+c[j]+'" />');f.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+g+">"+h+"</object>";D[D.length]=b.id;e=q(b.id)}else{j=G.createElement(w);j.setAttribute("type",z);for(var k in b)b[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",b[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,b[k]));for(g in c)c[g]!=Object.prototype[g]&&"movie"!=g.toLowerCase()&&
(b=j,h=g,k=c[g],d=G.createElement("param"),d.setAttribute("name",h),d.setAttribute("value",k),b.appendChild(d));f.parentNode.replaceChild(j,f);e=j}return e}function n(b){var c=q(b);c&&"OBJECT"==c.nodeName&&(M.ie&&M.win?(c.style.display="none",function(){if(4==c.readyState){var d=q(b);if(d){for(var e in d)"function"==typeof d[e]&&(d[e]=null);d.parentNode.removeChild(d)}}else setTimeout(arguments.callee,10)}()):c.parentNode.removeChild(c))}function q(b){var c=null;try{c=G.getElementById(b)}catch(d){}return c}
function p(b,c,d){b.attachEvent(c,d);F[F.length]=[b,c,d]}function s(b){var c=M.pv,b=b.split(".");b[0]=parseInt(b[0],10);b[1]=parseInt(b[1],10)||0;b[2]=parseInt(b[2],10)||0;return c[0]>b[0]||c[0]==b[0]&&c[1]>b[1]||c[0]==b[0]&&c[1]==b[1]&&c[2]>=b[2]?!0:!1}function r(b,c,d,e){if(!M.ie||!M.mac){var f=G.getElementsByTagName("head")[0];if(f){d=d&&"string"==typeof d?d:"screen";e&&(Z=E=null);if(!E||Z!=d)e=G.createElement("style"),e.setAttribute("type","text/css"),e.setAttribute("media",d),E=f.appendChild(e),
M.ie&&(M.win&&typeof G.styleSheets!=u&&0<G.styleSheets.length)&&(E=G.styleSheets[G.styleSheets.length-1]),Z=d;M.ie&&M.win?E&&typeof E.addRule==w&&E.addRule(b,c):E&&typeof G.createTextNode!=u&&E.appendChild(G.createTextNode(b+" {"+c+"}"))}}}function o(b,c){if(O){var d=c?"visible":"hidden";Q&&q(b)?q(b).style.visibility=d:r("#"+b,"visibility:"+d)}}function t(b){return null!=/[\\\"<>\.;]/.exec(b)&&typeof encodeURIComponent!=u?encodeURIComponent(b):b}var u="undefined",w="object",z="application/x-shockwave-flash",
A="SWFObjectExprInst",C=window,G=document,H=navigator,K=!1,P=[function(){K?e():f()}],T=[],D=[],F=[],I,J,N,U,Q=!1,B=!1,E,Z,O=!0,M=function(){var b=typeof G.getElementById!=u&&typeof G.getElementsByTagName!=u&&typeof G.createElement!=u,c=H.userAgent.toLowerCase(),d=H.platform.toLowerCase(),e=d?/win/.test(d):/win/.test(c),d=d?/mac/.test(d):/mac/.test(c),c=/webkit/.test(c)?parseFloat(c.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,f=!+"\v1",g=[0,0,0],h=null;if(typeof H.plugins!=u&&typeof H.plugins["Shockwave Flash"]==
w){if((h=H.plugins["Shockwave Flash"].description)&&!(typeof H.mimeTypes!=u&&H.mimeTypes[z]&&!H.mimeTypes[z].enabledPlugin))K=!0,f=!1,h=h.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),g[0]=parseInt(h.replace(/^(.*)\..*$/,"$1"),10),g[1]=parseInt(h.replace(/^.*\.(.*)\s.*$/,"$1"),10),g[2]=/[a-zA-Z]/.test(h)?parseInt(h.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof C.ActiveXObject!=u)try{var j=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(j&&(h=j.GetVariable("$version")))f=!0,h=h.split(" ")[1].split(","),
g=[parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10)]}catch(k){}return{w3:b,pv:g,wk:c,ie:f,win:e,mac:d}}();(function(){M.w3&&((typeof G.readyState!=u&&"complete"==G.readyState||typeof G.readyState==u&&(G.getElementsByTagName("body")[0]||G.body))&&b(),Q||(typeof G.addEventListener!=u&&G.addEventListener("DOMContentLoaded",b,!1),M.ie&&M.win&&(G.attachEvent("onreadystatechange",function(){"complete"==G.readyState&&(G.detachEvent("onreadystatechange",arguments.callee),b())}),C==top&&function(){if(!Q){try{G.documentElement.doScroll("left")}catch(c){setTimeout(arguments.callee,
0);return}b()}}()),M.wk&&function(){Q||(/loaded|complete/.test(G.readyState)?b():setTimeout(arguments.callee,0))}(),d(b)))})();(function(){M.ie&&M.win&&window.attachEvent("onunload",function(){for(var b=F.length,c=0;c<b;c++)F[c][0].detachEvent(F[c][1],F[c][2]);b=D.length;for(c=0;c<b;c++)n(D[c]);for(var d in M)M[d]=null;M=null;for(var e in swfobject)swfobject[e]=null;swfobject=null})})();return{registerObject:function(b,c,d,e){if(M.w3&&b&&c){var f={};f.id=b;f.swfVersion=c;f.expressInstall=d;f.callbackFn=
e;T[T.length]=f;o(b,!1)}else e&&e({success:!1,id:b})},getObjectById:function(b){if(M.w3)return g(b)},embedSWF:function(b,d,e,f,g,k,l,n,t,p){var q={success:!1,id:d};M.w3&&!(M.wk&&312>M.wk)&&b&&d&&e&&f&&g?(o(d,!1),c(function(){e+="";f+="";var c={};if(t&&typeof t===w)for(var r in t)c[r]=t[r];c.data=b;c.width=e;c.height=f;r={};if(n&&typeof n===w)for(var A in n)r[A]=n[A];if(l&&typeof l===w)for(var z in l)r.flashvars=typeof r.flashvars!=u?r.flashvars+("&"+z+"="+l[z]):z+"="+l[z];if(s(g))A=m(c,r,d),c.id==
d&&o(d,!0),q.success=!0,q.ref=A;else{if(k&&h()){c.data=k;j(c,r,d,p);return}o(d,!0)}p&&p(q)})):p&&p(q)},switchOffAutoHideShow:function(){O=!1},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]}},hasFlashPlayerVersion:s,createSWF:function(b,c,d){if(M.w3)return m(b,c,d)},showExpressInstall:function(b,c,d,e){M.w3&&h()&&j(b,c,d,e)},removeSWF:function(b){M.w3&&n(b)},createCSS:function(b,c,d,e){M.w3&&r(b,c,d,e)},addDomLoadEvent:c,addLoadEvent:d,getQueryParamValue:function(b){var c=
G.location.search||G.location.hash;if(c){/\?/.test(c)&&(c=c.split("?")[1]);if(null==b)return t(c);for(var c=c.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==b)return t(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(B){var b=q(A);b&&I&&(b.parentNode.replaceChild(I,b),J&&(o(J,!0),M.ie&&M.win&&(I.style.display="block")),N&&N(U));B=!1}}}}(),Wami=window.Wami||{};Wami.clear=function(){Wami._callbacks={};Wami.startRecording=null};
Wami.createID=function(){return"wid"+"10000000000".replace(/[018]/g,function(b){return(b^16*Math.random()>>b/4).toString(16)})};Wami.nameCallback=function(b,c){Wami._callbacks=Wami._callbacks||{};var d=Wami.createID();Wami._callbacks[d]=function(){c&&(Wami._callbacks[d]=null);b.apply(null,arguments)};return"Wami._callbacks['"+d+"']"};
Wami.setup=function(b){function c(){return-1==navigator.platform.indexOf("Linux")}function d(b){j={swfUrl:"Wami.swf",onReady:function(){Wami.hide()},onSecurity:e,onError:function(b){alert(b)}};"undefined"==typeof b&&alert("Need at least an element ID to place the Flash object.");j.id="string"==typeof b?b:b.id;b.swfUrl&&(j.swfUrl=b.swfUrl);b.onReady&&(j.onReady=b.onReady);b.onLoaded&&(j.onLoaded=b.onLoaded);b.onSecurity&&(j.onSecurity=b.onSecurity);b.onError&&(j.onError=b.onError);b=document.createElement("div");
j.cid=Wami.createID();b.setAttribute("id",j.cid);var c=document.createElement("div"),d=Wami.createID();c.setAttribute("id",d);b.appendChild(c);document.getElementById(j.id).appendChild(b);j.id=d}function e(){if(Wami.getSettings().microphone.granted)j.onReady();else Wami.showSecurity("privacy","Wami.show",Wami.nameCallback(j.onSecurity),Wami.nameCallback(j.onError))}function f(b,d){var e={visible:!1,loadedCallback:d},f={allowScriptAccess:"always"};c()&&(f.wmode="transparent");"undefined"!==typeof console&&
(e.console=!0);document.getElementById(b).innerHTML="WAMI requires Flash 10.0.0 or greater<br />https://get.adobe.com/flashplayer/";Wami.swfobject.embedSWF(j.swfUrl,b,214,137,"10.0.0",null,e,f);Wami.swfobject.createCSS("#"+b,"outline:none")}function g(b){var c=Wami.createID(),d=document.createElement("div");d.style.top="-999px";d.style.left="-999px";d.setAttribute("id",c);document.getElementsByTagName("body").item(0).appendChild(d);d=Wami.nameCallback(function(){var d=document.getElementById(c);Wami._remembered=
d.getSettings().microphone.granted;Wami.swfobject.removeSWF(c);eval(b+"()")});f(c,d)}function h(){function b(c){Wami[c]=function(){return d[c].apply(d,arguments)}}var d=document.getElementById(j.id);b("startPlaying");b("stopPlaying");b("startRecording");b("stopRecording");b("startListening");b("stopListening");b("getRecordingLevel");b("getPlayingLevel");b("setSettings");Wami.getSettings=function(){var b=d.getSettings();b.microphone.remembered=Wami._remembered;return b};Wami.showSecurity=function(b,
c,e,f){var h=document.getElementById(j.cid),k=Wami.nameCallback(function(){g(e);h.style.cssText="position: absolute;"});h.style.cssText="position: absolute; z-index: 99999";d.showSecurity(b,c,k,f)};Wami.show=function(){c()||(d.style.visibility="visible")};Wami.hide=function(){c()||(d.style.visibility="hidden")};Wami._remembered=d.getSettings().microphone.granted;if(j.onLoaded)j.onLoaded();j.noSecurityCheck||e()}if(Wami.startRecording){if(b.onReady)b.onReady()}else{Wami.swfobject=Wami.swfobject||swfobject;
Wami.swfobject||alert("Unable to find swfobject to help embed the SWF.");var j;d(b);f(j.id,Wami.nameCallback(h))}};
(function(b){var c=function(b,c){var f=c||{},g=f.bufferLen||4096;this.context=b.context;this.node=this.context.createScriptProcessor(g,2,2);var h=new Worker(f.workerPath||"/ext/recorder/recorderWorker.js");h.postMessage({command:"init",config:{sampleRate:this.context.sampleRate}});var j=!1,k;this.node.onaudioprocess=function(b){var c=b.inputBuffer.getChannelData(0),b=b.inputBuffer.getChannelData(1);f.levelCallback&&f.levelCallback(c,b);j&&h.postMessage({command:"record",buffer:[c,b]})};this.configure=
function(b){for(var c in b)b.hasOwnProperty(c)&&(f[c]=b[c])};this.record=function(){j=!0};this.stop=function(){j=!1};this.isRecording=function(){return j};this.clear=function(){h.postMessage({command:"clear"})};this.getBuffer=function(b){k=b||f.callback;h.postMessage({command:"getBuffer"})};this.exportWAV=function(b,c){k=b||f.callback;c=c||f.type||"audio/wav";if(!k)throw Error("Callback not set");h.postMessage({command:"exportWAV",type:c})};h.onmessage=function(b){k(b.data)};b.connect(this.node);
this.node.connect(this.context.destination)};c.forceDownload=function(c,e){var f=(b.URL||b.webkitURL).createObjectURL(c),g=b.document.createElement("a");g.href=f;g.download=e||"output.wav";f=document.createEvent("Event");f.initEvent("click",!0,!0);g.dispatchEvent(f)};b.Recorder=c})(window);
jQuery&&function(b){function c(c,d){var e=b('<span class="minicolors" />'),f=b.minicolors.defaultSettings;c.data("minicolors-initialized")||(d=b.extend(!0,{},f,d),e.addClass("minicolors-theme-"+d.theme).addClass("minicolors-swatch-position-"+d.swatchPosition).toggleClass("minicolors-swatch-left","left"===d.swatchPosition).toggleClass("minicolors-with-opacity",d.opacity),void 0!==d.position&&b.each(d.position.split(" "),function(){e.addClass("minicolors-position-"+this)}),c.addClass("minicolors-input").data("minicolors-initialized",
!0).data("minicolors-settings",d).prop("size",7).prop("maxlength",7).wrap(e).after('<span class="minicolors-panel minicolors-slider-'+d.control+'"><span class="minicolors-slider"><span class="minicolors-picker"></span></span><span class="minicolors-opacity-slider"><span class="minicolors-picker"></span></span><span class="minicolors-grid"><span class="minicolors-grid-inner"></span><span class="minicolors-picker"><span></span></span></span></span>'),c.parent().find(".minicolors-panel").on("selectstart",
function(){return!1}).end(),"left"===d.swatchPosition?c.before('<span class="minicolors-swatch"><span></span></span>'):c.after('<span class="minicolors-swatch"><span></span></span>'),d.textfield||c.addClass("minicolors-hidden"),d.inline&&c.parent().addClass("minicolors-inline"),j(c,!1,!0))}function d(b){var c=b.parent();b.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeProp("maxlength").removeClass("minicolors-input");c.before(b).remove()}function e(b){var c=
b.parent(),d=c.find(".minicolors-panel"),e=b.data("minicolors-settings");b.data("minicolors-initialized")&&(!b.prop("disabled")&&!c.hasClass("minicolors-inline")&&!c.hasClass("minicolors-focus"))&&(f(),c.addClass("minicolors-focus"),d.stop(!0,!0).fadeIn(e.showSpeed,function(){e.show&&e.show.call(b)}))}function f(){b(".minicolors-input").each(function(){var c=b(this),d=c.data("minicolors-settings"),e=c.parent();d.inline||e.find(".minicolors-panel").fadeOut(d.hideSpeed,function(){e.hasClass("minicolors-focus")&&
d.hide&&d.hide.call(c);e.removeClass("minicolors-focus")})})}function g(b,c,d){var e=b.parents(".minicolors").find(".minicolors-input"),f=e.data("minicolors-settings"),g=b.find("[class$=-picker]"),j=b.offset().left,k=b.offset().top,l=Math.round(c.pageX-j),o=Math.round(c.pageY-k),d=d?f.animationSpeed:0;c.originalEvent.changedTouches&&(l=c.originalEvent.changedTouches[0].pageX-j,o=c.originalEvent.changedTouches[0].pageY-k);0>l&&(l=0);0>o&&(o=0);l>b.width()&&(l=b.width());o>b.height()&&(o=b.height());
b.parent().is(".minicolors-slider-wheel")&&g.parent().is(".minicolors-grid")&&(j=75-l,k=75-o,c=Math.sqrt(j*j+k*k),j=Math.atan2(k,j),0>j&&(j+=2*Math.PI),75<c&&(c=75,l=75-75*Math.cos(j),o=75-75*Math.sin(j)),l=Math.round(l),o=Math.round(o));b.is(".minicolors-grid")?g.stop(!0).animate({top:o+"px",left:l+"px"},d,f.animationEasing,function(){h(e,b)}):g.stop(!0).animate({top:o+"px"},d,f.animationEasing,function(){h(e,b)})}function h(b,c){function d(b,c){var e,f;if(!b.length||!c)return null;e=b.offset().left;
f=b.offset().top;return{x:e-c.offset().left+b.outerWidth()/2,y:f-c.offset().top+b.outerHeight()/2}}var e,f,g,h,j,l;h=b.val();var o=b.attr("data-opacity");j=b.parent();var m=b.data("minicolors-settings");j.find(".minicolors-panel");var s=j.find(".minicolors-swatch");l=j.find(".minicolors-grid");var q=j.find(".minicolors-slider"),I=j.find(".minicolors-opacity-slider");g=l.find("[class$=-picker]");var J=q.find("[class$=-picker]"),N=I.find("[class$=-picker]");g=d(g,l);J=d(J,q);N=d(N,I);if(c.is(".minicolors-grid, .minicolors-slider")){switch(m.control){case "wheel":h=
l.width()/2-g.x;j=l.height()/2-g.y;l=Math.sqrt(h*h+j*j);h=Math.atan2(j,h);0>h&&(h+=2*Math.PI);75<l&&(l=75,g.x=69-75*Math.cos(h),g.y=69-75*Math.sin(h));f=p(l/0.75,0,100);e=p(180*h/Math.PI,0,360);g=p(100-Math.floor(J.y*(100/q.height())),0,100);h=r({h:e,s:f,b:g});q.css("backgroundColor",r({h:e,s:f,b:100}));break;case "saturation":e=p(parseInt(g.x*(360/l.width())),0,360);f=p(100-Math.floor(J.y*(100/q.height())),0,100);g=p(100-Math.floor(g.y*(100/l.height())),0,100);h=r({h:e,s:f,b:g});q.css("backgroundColor",
r({h:e,s:100,b:g}));j.find(".minicolors-grid-inner").css("opacity",f/100);break;case "brightness":e=p(parseInt(g.x*(360/l.width())),0,360);f=p(100-Math.floor(g.y*(100/l.height())),0,100);g=p(100-Math.floor(J.y*(100/q.height())),0,100);h=r({h:e,s:f,b:g});q.css("backgroundColor",r({h:e,s:f,b:100}));j.find(".minicolors-grid-inner").css("opacity",1-g/100);break;default:e=p(360-parseInt(J.y*(360/q.height())),0,360),f=p(Math.floor(g.x*(100/l.width())),0,100),g=p(100-Math.floor(g.y*(100/l.height())),0,100),
h=r({h:e,s:f,b:g}),l.css("backgroundColor",r({h:e,s:100,b:100}))}b.val(n(h,m.letterCase))}c.is(".minicolors-opacity-slider")&&(o=m.opacity?parseFloat(1-N.y/I.height()).toFixed(2):1,m.opacity&&b.attr("data-opacity",o));s.find("SPAN").css({backgroundColor:h,opacity:o});k(b,h,o)}function j(b,c,d){var e,f,g,h,j;h=b.parent();g=b.data("minicolors-settings");j=h.find(".minicolors-swatch");var l=h.find(".minicolors-grid"),m=h.find(".minicolors-slider"),s=h.find(".minicolors-opacity-slider"),D=l.find("[class$=-picker]"),
F=m.find("[class$=-picker]"),I=s.find("[class$=-picker]");(e=n(q(b.val(),!0),g.letterCase))||(e=n(q(g.defaultValue,!0)));var J=o(e),N=0,U=0,Q=0,U=Math.min(J.r,J.g,J.b),Q=Math.max(J.r,J.g,J.b),N=Q-U,U=0!==Q?255*N/Q:0,N=0!==U?J.r===Q?(J.g-J.b)/N:J.g===Q?2+(J.b-J.r)/N:4+(J.r-J.g)/N:-1,N=60*N;0>N&&(N+=360);U*=100/255;Q*=100/255;0===U&&(N=360);c||b.val(e);g.opacity&&(f=""===b.attr("data-opacity")?1:p(parseFloat(b.attr("data-opacity")).toFixed(2),0,1),isNaN(f)&&(f=1),b.attr("data-opacity",f),j.find("SPAN").css("opacity",
f),c=p(s.height()-s.height()*f,0,s.height()),I.css("top",c+"px"));j.find("SPAN").css("backgroundColor",e);switch(g.control){case "wheel":h=p(Math.ceil(0.75*U),0,l.height()/2);j=N*Math.PI/180;g=p(75-Math.cos(j)*h,0,l.width());c=p(75-Math.sin(j)*h,0,l.height());D.css({top:c+"px",left:g+"px"});c=150-Q/(100/l.height());""===e&&(c=0);F.css("top",c+"px");m.css("backgroundColor",r({h:N,s:U,b:100}));break;case "saturation":g=p(5*N/12,0,150);c=p(l.height()-Math.ceil(Q/(100/l.height())),0,l.height());D.css({top:c+
"px",left:g+"px"});c=p(m.height()-U*(m.height()/100),0,m.height());F.css("top",c+"px");m.css("backgroundColor",r({h:N,s:100,b:Q}));h.find(".minicolors-grid-inner").css("opacity",U/100);break;case "brightness":g=p(5*N/12,0,150);c=p(l.height()-Math.ceil(U/(100/l.height())),0,l.height());D.css({top:c+"px",left:g+"px"});c=p(m.height()-Q*(m.height()/100),0,m.height());F.css("top",c+"px");m.css("backgroundColor",r({h:N,s:U,b:100}));h.find(".minicolors-grid-inner").css("opacity",1-Q/100);break;default:g=
p(Math.ceil(U/(100/l.width())),0,l.width()),c=p(l.height()-Math.ceil(Q/(100/l.height())),0,l.height()),D.css({top:c+"px",left:g+"px"}),c=p(m.height()-N/(360/m.height()),0,m.height()),F.css("top",c+"px"),l.css("backgroundColor",r({h:N,s:100,b:100}))}d||k(b,e,f)}function k(b,c,d){var e=b.data("minicolors-settings");c+d!==b.data("minicolors-lastChange")&&(b.data("minicolors-lastChange",c+d),e.change&&(e.changeDelay?(clearTimeout(b.data("minicolors-changeTimeout")),b.data("minicolors-changeTimeout",setTimeout(function(){e.change.call(b,
c,d)},e.changeDelay))):e.change.call(b,c,d)))}function l(c){var d=q(b(c).val(),!0),d=o(d),c=b(c).attr("data-opacity");if(!d)return null;void 0!==c&&b.extend(d,{a:parseFloat(c)});return d}function m(c,d){var e=q(b(c).val(),!0),e=o(e),f=b(c).attr("data-opacity");if(!e)return null;void 0===f&&(f=1);return d?"rgba("+e.r+", "+e.g+", "+e.b+", "+parseFloat(f)+")":"rgb("+e.r+", "+e.g+", "+e.b+")"}function n(b,c){return"uppercase"===c?b.toUpperCase():b.toLowerCase()}function q(b,c){b=b.replace(/[^A-F0-9]/ig,
"");if(3!==b.length&&6!==b.length)return"";3===b.length&&c&&(b=b[0]+b[0]+b[1]+b[1]+b[2]+b[2]);return"#"+b}function p(b,c,d){b<c&&(b=c);b>d&&(b=d);return b}function s(c){var d=[c.r.toString(16),c.g.toString(16),c.b.toString(16)];b.each(d,function(b,c){1===c.length&&(d[b]="0"+c)});return"#"+d.join("")}function r(b){var c=s,d,e,f;d=Math.round(b.h);var g=Math.round(255*b.s/100),b=Math.round(255*b.b/100);if(0===g)d=e=f=b;else{var g=(255-g)*b/255,h=(b-g)*(d%60)/60;360===d&&(d=0);60>d?(d=b,f=g,e=g+h):120>
d?(e=b,f=g,d=b-h):180>d?(e=b,d=g,f=g+h):240>d?(f=b,d=g,e=b-h):300>d?(f=b,e=g,d=g+h):360>d?(d=b,e=g,f=b-h):f=e=d=0}b={r:Math.round(d),g:Math.round(e),b:Math.round(f)};return c(b)}function o(b){b=parseInt(-1<b.indexOf("#")?b.substring(1):b,16);return{r:b>>16,g:(b&65280)>>8,b:b&255}}b.minicolors={defaultSettings:{animationSpeed:100,animationEasing:"swing",change:null,changeDelay:0,control:"hue",defaultValue:"",hide:null,hideSpeed:100,inline:!1,letterCase:"lowercase",opacity:!1,position:"default",show:null,
showSpeed:100,swatchPosition:"left",textfield:!0,theme:"default"}};b.extend(b.fn,{minicolors:function(g,h){switch(g){case "destroy":return b(this).each(function(){d(b(this))}),b(this);case "hide":return f(),b(this);case "opacity":if(void 0===h)return b(this).attr("data-opacity");b(this).each(function(){var c=b(this).attr("data-opacity",h);j(c)});return b(this);case "rgbObject":return l(b(this),"rgbaObject"===g);case "rgbString":case "rgbaString":return m(b(this),"rgbaString"===g);case "settings":if(void 0===
h)return b(this).data("minicolors-settings");b(this).each(function(){var c=b(this).data("minicolors-settings")||{};d(b(this));b(this).minicolors(b.extend(!0,c,h))});return b(this);case "show":return e(b(this).eq(0)),b(this);case "value":if(void 0===h)return b(this).val();b(this).each(function(){var c=b(this).val(h);j(c)});return b(this);default:return"create"!==g&&(h=g),b(this).each(function(){c(b(this),h)}),b(this)}}});b(document).on("mousedown.minicolors touchstart.minicolors",function(c){b(c.target).parents().add(c.target).hasClass("minicolors")||
f()}).on("mousedown.minicolors touchstart.minicolors",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(c){var d=b(this);c.preventDefault();b(document).data("minicolors-target",d);g(d,c,!0)}).on("mousemove.minicolors touchmove.minicolors",function(c){var d=b(document).data("minicolors-target");d&&g(d,c)}).on("mouseup.minicolors touchend.minicolors",function(){b(this).removeData("minicolors-target")}).on("mousedown.minicolors touchstart.minicolors",".minicolors-swatch",function(){var c=
b(this).parent().find(".minicolors-input");c.parent().hasClass("minicolors-focus")?f(c):e(c)}).on("focus.minicolors",".minicolors-input",function(){var c=b(this);c.data("minicolors-initialized")&&e(c)}).on("blur.minicolors",".minicolors-input",function(){var c=b(this),d=c.data("minicolors-settings");c.data("minicolors-initialized")&&(c.val(q(c.val(),!0)),""===c.val()&&c.val(q(d.defaultValue,!0)),c.val(n(c.val(),d.letterCase)))}).on("keydown.minicolors",".minicolors-input",function(c){var d=b(this);
if(d.data("minicolors-initialized"))switch(c.keyCode){case 9:f();break;case 27:f(),d.blur()}}).on("keyup.minicolors",".minicolors-input",function(){var c=b(this);c.data("minicolors-initialized")&&j(c,!0)}).on("paste.minicolors",".minicolors-input",function(){var c=b(this);c.data("minicolors-initialized")&&setTimeout(function(){j(c,!0)},1)})}(jQuery);
(function(b){function c(b){return function(){var c=arguments[0],d;d="["+(b?b+":":"")+c+"] http://errors.angularjs.org/1.5.5/"+(b?b+"/":"")+c;for(c=1;c<arguments.length;c++){d=d+(1==c?"?":"&")+"p"+(c-1)+"=";var e=encodeURIComponent,f;f=arguments[c];f="function"==typeof f?f.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof f?"undefined":"string"!=typeof f?JSON.stringify(f):f;d+=e(f)}return Error(d)}}function d(b){if(null==b||G(b))return!1;if(ia(b)||u(b)||ca&&b instanceof ca)return!0;var c="length"in
Object(b)&&b.length;return w(c)&&(0<=c&&(c-1 in b||b instanceof Array)||"function"==typeof b.item)}function e(b,c,f){var g,h;if(b)if(A(b))for(g in b)"prototype"==g||"length"==g||"name"==g||b.hasOwnProperty&&!b.hasOwnProperty(g)||c.call(f,b[g],g,b);else if(ia(b)||d(b)){var j="object"!==typeof b;g=0;for(h=b.length;g<h;g++)(j||g in b)&&c.call(f,b[g],g,b)}else if(b.forEach&&b.forEach!==e)b.forEach(c,f,b);else if(t(b))for(g in b)c.call(f,b[g],g,b);else if("function"===typeof b.hasOwnProperty)for(g in b)b.hasOwnProperty(g)&&
c.call(f,b[g],g,b);else for(g in b)Gb.call(b,g)&&c.call(f,b[g],g,b);return b}function f(b,c,d){for(var e=Object.keys(b).sort(),f=0;f<e.length;f++)c.call(d,b[e[f]],e[f]);return e}function g(b){return function(c,d){b(d,c)}}function h(){return++Pc}function j(b,c,d){for(var e=b.$$hashKey,f=0,g=c.length;f<g;++f){var h=c[f];if(o(h)||A(h))for(var k=Object.keys(h),l=0,m=k.length;l<m;l++){var n=k[l],s=h[n];d&&o(s)?z(s)?b[n]=new Date(s.valueOf()):C(s)?b[n]=RegExp(s):s.nodeName?b[n]=s.cloneNode(!0):P(s)?b[n]=
s.clone():(o(b[n])||(b[n]=ia(s)?[]:{}),j(b[n],[s],!0)):b[n]=s}}e?b.$$hashKey=e:delete b.$$hashKey;return b}function k(b){return j(b,lb.call(arguments,1),!1)}function l(b){return j(b,lb.call(arguments,1),!0)}function m(b){return parseInt(b,10)}function n(){}function q(b){return b}function p(b){return function(){return b}}function s(b){return"undefined"===typeof b}function r(b){return"undefined"!==typeof b}function o(b){return null!==b&&"object"===typeof b}function t(b){return null!==b&&"object"===
typeof b&&!Td(b)}function u(b){return"string"===typeof b}function w(b){return"number"===typeof b}function z(b){return"[object Date]"===ab.call(b)}function A(b){return"function"===typeof b}function C(b){return"[object RegExp]"===ab.call(b)}function G(b){return b&&b.window===b}function H(b){return b&&b.$evalAsync&&b.$watch}function K(b){return"boolean"===typeof b}function P(b){return!(!b||!(b.nodeName||b.prop&&b.attr&&b.find))}function T(b){var c={},b=b.split(","),d;for(d=0;d<b.length;d++)c[b[d]]=!0;
return c}function D(b){return wa(b.nodeName||b[0]&&b[0].nodeName)}function F(b,c){var d=b.indexOf(c);0<=d&&b.splice(d,1);return d}function I(b,c){function d(b,c){var e=c.$$hashKey,g;if(ia(b)){g=0;for(var h=b.length;g<h;g++)c.push(f(b[g]))}else if(t(b))for(g in b)c[g]=f(b[g]);else if(b&&"function"===typeof b.hasOwnProperty)for(g in b)b.hasOwnProperty(g)&&(c[g]=f(b[g]));else for(g in b)Gb.call(b,g)&&(c[g]=f(b[g]));e?c.$$hashKey=e:delete c.$$hashKey;return c}function f(b){if(!o(b))return b;var c=h.indexOf(b);
if(-1!==c)return j[c];if(G(b)||H(b))throw dc("cpws");var c=!1,e=g(b);void 0===e&&(e=ia(b)?[]:Object.create(Td(b)),c=!0);h.push(b);j.push(e);return c?d(b,e):e}function g(b){switch(ab.call(b)){case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Float32Array]":case "[object Float64Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return new b.constructor(f(b.buffer));case "[object ArrayBuffer]":if(!b.slice){var c=
new ArrayBuffer(b.byteLength);(new Uint8Array(c)).set(new Uint8Array(b));return c}return b.slice(0);case "[object Boolean]":case "[object Number]":case "[object String]":case "[object Date]":return new b.constructor(b.valueOf());case "[object RegExp]":return c=RegExp(b.source,b.toString().match(/[^\/]*$/)[0]),c.lastIndex=b.lastIndex,c;case "[object Blob]":return new b.constructor([b],{type:b.type})}if(A(b.cloneNode))return b.cloneNode(!0)}var h=[],j=[];if(c){if(c&&w(c.length)&&Ke.test(ab.call(c))||
"[object ArrayBuffer]"===ab.call(c))throw dc("cpta");if(b===c)throw dc("cpi");ia(c)?c.length=0:e(c,function(b,d){"$$hashKey"!==d&&delete c[d]});h.push(b);j.push(c);return d(b,c)}return f(b)}function J(b,c){if(ia(b))for(var c=c||[],d=0,e=b.length;d<e;d++)c[d]=b[d];else if(o(b))for(d in c=c||{},b)if("$"!==d.charAt(0)||"$"!==d.charAt(1))c[d]=b[d];return c||b}function N(b,c){if(b===c)return!0;if(null===b||null===c)return!1;if(b!==b&&c!==c)return!0;var d=typeof b,e;if(d==typeof c&&"object"==d)if(ia(b)){if(!ia(c))return!1;
if((d=b.length)==c.length){for(e=0;e<d;e++)if(!N(b[e],c[e]))return!1;return!0}}else{if(z(b))return z(c)?N(b.getTime(),c.getTime()):!1;if(C(b))return C(c)?b.toString()==c.toString():!1;if(H(b)||H(c)||G(b)||G(c)||ia(c)||z(c)||C(c))return!1;d=W();for(e in b)if("$"!==e.charAt(0)&&!A(b[e])){if(!N(b[e],c[e]))return!1;d[e]=!0}for(e in c)if(!(e in d)&&"$"!==e.charAt(0)&&r(c[e])&&!A(c[e]))return!1;return!0}return!1}function U(b,c){var d=2<arguments.length?lb.call(arguments,2):[];return!A(c)||c instanceof RegExp?
c:d.length?function(){return arguments.length?c.apply(b,d.concat(lb.call(arguments,0))):c.apply(b,d)}:function(){return arguments.length?c.apply(b,arguments):c.call(b)}}function Q(c,d){var e=d;"string"===typeof c&&"$"===c.charAt(0)&&"$"===c.charAt(1)?e=void 0:G(d)?e="$WINDOW":d&&b.document===d?e="$DOCUMENT":H(d)&&(e="$SCOPE");return e}function B(b,c){if(!s(b))return w(c)||(c=c?2:null),JSON.stringify(b,Q,c)}function E(b){return u(b)?JSON.parse(b):b}function Z(b,c){var b=b.replace(Ne,""),d=Date.parse("Jan 01, 1970 00:00:00 "+
b)/6E4;return isNaN(d)?c:d}function O(b,c,d){var d=d?-1:1,e=b.getTimezoneOffset(),c=Z(c,e),d=d*(c-e),b=new Date(b.getTime());b.setMinutes(b.getMinutes()+d);return b}function M(b){b=ca(b).clone();try{b.empty()}catch(c){}var d=ca("<div>").append(b).html();try{return b[0].nodeType===mc?wa(d):d.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(b,c){return"<"+wa(c)})}catch(e){return wa(d)}}function X(b){try{return decodeURIComponent(b)}catch(c){}}function aa(b){var c={};e((b||"").split("&"),function(b){var d,
e,f;b&&(e=b=b.replace(/\+/g,"%20"),d=b.indexOf("="),-1!==d&&(e=b.substring(0,d),f=b.substring(d+1)),e=X(e),r(e)&&(f=r(f)?X(f):!0,Gb.call(c,e)?ia(c[e])?c[e].push(f):c[e]=[c[e],f]:c[e]=f))});return c}function Y(b){var c=[];e(b,function(b,d){ia(b)?e(b,function(b){c.push(da(d,!0)+(!0===b?"":"="+da(b,!0)))}):c.push(da(d,!0)+(!0===b?"":"="+da(b,!0)))});return c.length?c.join("&"):""}function ba(b){return da(b,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function da(b,c){return encodeURIComponent(b).replace(/%40/gi,
"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,c?"%20":"+")}function ra(b,c){var d,e,f=lc.length;for(e=0;e<f;++e)if(d=lc[e]+c,u(d=b.getAttribute(d)))return d;return null}function x(b,c){var d,f,g={};e(lc,function(c){c+="app";!d&&b.hasAttribute&&b.hasAttribute(c)&&(d=b,f=b.getAttribute(c))});e(lc,function(c){var c=c+"app",e;!d&&(e=b.querySelector("["+c.replace(":","\\:")+"]"))&&(d=e,f=e.getAttribute(c))});d&&(g.strictDi=null!==ra(d,"strict-di"),
c(d,f?[f]:[],g))}function ja(c,d,f){o(f)||(f={});var f=k({strictDi:!1},f),g=function(){c=ca(c);if(c.injector()){var e=c[0]===b.document?"document":M(c);throw dc("btstrpd",e.replace(/</,"&lt;").replace(/>/,"&gt;"));}d=d||[];d.unshift(["$provide",function(b){b.value("$rootElement",c)}]);f.debugInfoEnabled&&d.push(["$compileProvider",function(b){b.debugInfoEnabled(!0)}]);d.unshift("ng");e=Pa(d,f.strictDi);e.invoke(["$rootScope","$rootElement","$compile","$injector",function(b,c,d,e){b.$apply(function(){c.data("$injector",
e);d(c)(b)})}]);return e},h=/^NG_ENABLE_DEBUG_INFO!/,j=/^NG_DEFER_BOOTSTRAP!/;b&&h.test(b.name)&&(f.debugInfoEnabled=!0,b.name=b.name.replace(h,""));if(b&&!j.test(b.name))return g();b.name=b.name.replace(j,"");mb.resumeBootstrap=function(b){e(b,function(b){d.push(b)});return g()};A(mb.resumeDeferredBootstrap)&&mb.resumeDeferredBootstrap()}function ka(){b.name="NG_ENABLE_DEBUG_INFO!"+b.name;b.location.reload()}function oa(b){b=mb.element(b).injector();if(!b)throw dc("test");return b.get("$$testability")}
function pa(b,c){c=c||"_";return b.replace(Oe,function(b,d){return(d?c:"")+b.toLowerCase()})}function V(){var c;if(!Ud){var d=Mc();(Pb=s(d)?b.jQuery:d?b[d]:void 0)&&Pb.fn.on?(ca=Pb,k(Pb.fn,{scope:kc.scope,isolateScope:kc.isolateScope,controller:kc.controller,injector:kc.injector,inheritedData:kc.inheritedData}),c=Pb.cleanData,Pb.cleanData=function(b){for(var d,e=0,f;null!=(f=b[e]);e++)(d=Pb._data(f,"events"))&&d.$destroy&&Pb(f).triggerHandler("$destroy");c(b)}):ca=ea;mb.element=ca;Ud=!0}}function va(b,
c,d){if(!b)throw dc("areq",c||"?",d||"required");return b}function ta(b,c,d){d&&ia(b)&&(b=b[b.length-1]);va(A(b),c,"not a function, got "+(b&&"object"===typeof b?b.constructor.name||"Object":typeof b));return b}function sa(b,c){if("hasOwnProperty"===b)throw dc("badname",c);}function Da(b,c,d){if(!c)return b;for(var c=c.split("."),e,f=b,g=c.length,h=0;h<g;h++)e=c[h],b&&(b=(f=b)[e]);return!d&&A(b)?U(f,b):b}function L(b){for(var c=b[0],d=b[b.length-1],e,f=1;c!==d&&(c=c.nextSibling);f++)if(e||b[f]!==
c)e||(e=ca(lb.call(b,0,f))),e.push(c);return e||b}function W(){return Object.create(null)}function fa(b){var d=c("$injector"),e=c("ng"),b=b.angular||(b.angular={});b.$$minErr=b.$$minErr||c;return b.module||(b.module=function(){var b={};return function(c,f,g){if("hasOwnProperty"===c)throw e("badname","module");f&&b.hasOwnProperty(c)&&(b[c]=null);return b[c]||(b[c]=function(){function b(c,d,e,f){f||(f=h);return function(){f[e||"push"]([c,d,arguments]);return o}}function e(b,d){return function(e,f){f&&
A(f)&&(f.$$moduleName=c);h.push([b,d,arguments]);return o}}if(!f)throw d("nomod",c);var h=[],j=[],k=[],l=b("$injector","invoke","push",j),o={_invokeQueue:h,_configBlocks:j,_runBlocks:k,requires:f,name:c,provider:e("$provide","provider"),factory:e("$provide","factory"),service:e("$provide","service"),value:b("$provide","value"),constant:b("$provide","constant","unshift"),decorator:e("$provide","decorator"),animation:e("$animateProvider","register"),filter:e("$filterProvider","register"),controller:e("$controllerProvider",
"register"),directive:e("$compileProvider","directive"),component:e("$compileProvider","component"),config:l,run:function(b){k.push(b);return this}};g&&l(g);return o}())}}())}function R(d){k(d,{bootstrap:ja,copy:I,extend:k,merge:l,equals:N,element:ca,forEach:e,injector:Pa,noop:n,bind:U,toJson:B,fromJson:E,identity:q,isUndefined:s,isDefined:r,isString:u,isFunction:A,isObject:o,isNumber:w,isElement:P,isArray:ia,version:Pe,isDate:z,lowercase:wa,uppercase:Oc,callbacks:{counter:0},getTestability:oa,$$minErr:c,
$$csp:fc,reloadWithDebugInfo:ka});jd=fa(b);jd("ng",["ngLocale"],["$provide",function(b){b.provider({$$sanitizeUri:pd});b.provider("$compile",ob).directive({a:Ye,input:Vd,textarea:Vd,form:Ze,script:$e,select:af,style:bf,option:cf,ngBind:df,ngBindHtml:ef,ngBindTemplate:ff,ngClass:gf,ngClassEven:hf,ngClassOdd:jf,ngCloak:kf,ngController:lf,ngForm:mf,ngHide:nf,ngIf:of,ngInclude:pf,ngInit:qf,ngNonBindable:rf,ngPluralize:sf,ngRepeat:tf,ngShow:uf,ngStyle:vf,ngSwitch:wf,ngSwitchWhen:xf,ngSwitchDefault:yf,
ngOptions:zf,ngTransclude:Af,ngModel:Bf,ngList:Cf,ngChange:Df,pattern:Wd,ngPattern:Wd,required:Xd,ngRequired:Xd,minlength:Yd,ngMinlength:Yd,maxlength:Zd,ngMaxlength:Zd,ngValue:Ef,ngModelOptions:Ff}).directive({ngInclude:Gf}).directive(ad).directive($d);b.provider({$anchorScroll:yb,$animate:Fe,$animateCss:Ie,$$animateJs:De,$$animateQueue:Ee,$$AnimateRunner:He,$$animateAsyncRun:Ge,$browser:Ib,$cacheFactory:Ab,$controller:$b,$document:ac,$exceptionHandler:Nb,$filter:Bd,$$forceReflow:Hf,$interpolate:Vb,
$interval:rb,$http:sb,$httpParamSerializer:bc,$httpParamSerializerJQLike:gc,$httpBackend:nc,$xhrFactory:hc,$location:Cb,$log:Dc,$parse:Xc,$rootScope:Xb,$q:Yc,$$q:wc,$sce:rd,$sceDelegate:qd,$sniffer:sd,$templateCache:vb,$templateRequest:pc,$$testability:qc,$timeout:Zc,$window:td,$$rAF:Hc,$$jqLite:qa,$$HashMap:ue,$$cookieReader:pe})}])}function v(b){return b.replace(Re,function(b,c,d,e){return e?d.toUpperCase():d}).replace(Se,"Moz$1")}function Na(b){b=b.nodeType;return 1===b||!b||9===b}function tb(b,
c){var d,f,g=c.createDocumentFragment(),h=[];if(id.test(b)){d=d||g.appendChild(c.createElement("div"));f=(Te.exec(b)||["",""])[1].toLowerCase();f=zb[f]||zb._default;d.innerHTML=f[1]+b.replace(Ue,"<$1></$2>")+f[2];for(f=f[0];f--;)d=d.lastChild;h=h.concat(lb.call(d.childNodes,void 0));d=g.firstChild;d.textContent=""}else h.push(c.createTextNode(b));g.textContent="";g.innerHTML="";e(h,function(b){g.appendChild(b)});return g}function kb(b,c){var d=b.parentNode;d&&d.replaceChild(c,b);c.appendChild(b)}
function ea(c){if(c instanceof ea)return c;var d;u(c)&&(c=ya(c),d=!0);if(!(this instanceof ea)){if(d&&"<"!=c.charAt(0))throw hd("nosel");return new ea(c)}if(d){d=b.document;var e,c=(e=Ae.exec(c))?[d.createElement(e[1])]:(e=tb(c,d))?e.childNodes:[]}Ta(this,c)}function ma(b){return b.cloneNode(!0)}function Ca(b,c){c||Va(b);if(b.querySelectorAll)for(var d=b.querySelectorAll("*"),e=0,f=d.length;e<f;e++)Va(d[e])}function ub(b,c,d,f){if(r(f))throw hd("offargs");var g=(f=nb(b))&&f.events,h=f&&f.handle;if(h)if(c){var j=
function(c){var e=g[c];r(d)&&F(e||[],d);r(d)&&e&&0<e.length||(b.removeEventListener(c,h,!1),delete g[c])};e(c.split(" "),function(b){j(b);Qc[b]&&j(Qc[b])})}else for(c in g)"$destroy"!==c&&b.removeEventListener(c,h,!1),delete g[c]}function Va(b,c){var d=b.ng339,e=d&&yc[d];e&&(c?delete e.data[c]:(e.handle&&(e.events.$destroy&&e.handle({},"$destroy"),ub(b)),delete yc[d],b.ng339=void 0))}function nb(b,c){var d=b.ng339,d=d&&yc[d];c&&!d&&(b.ng339=d=++Qe,d=yc[d]={events:{},data:{},handle:void 0});return d}
function xb(b,c,d){if(Na(b)){var e=r(d),f=!e&&c&&!o(c),g=!c,b=(b=nb(b,!f))&&b.data;if(e)b[c]=d;else{if(g)return b;if(f)return b&&b[c];k(b,c)}}}function Fa(b,c){return b.getAttribute?-1<(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+c+" "):!1}function Sa(b,c){c&&b.setAttribute&&e(c.split(" "),function(c){b.setAttribute("class",ya((" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+ya(c)+" "," ")))})}function bb(b,c){if(c&&b.setAttribute){var d=(" "+
(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");e(c.split(" "),function(b){b=ya(b);-1===d.indexOf(" "+b+" ")&&(d+=b+" ")});b.setAttribute("class",ya(d))}}function Ta(b,c){if(c)if(c.nodeType)b[b.length++]=c;else{var d=c.length;if("number"===typeof d&&c.window!==c){if(d)for(var e=0;e<d;e++)b[b.length++]=c[e]}else b[b.length++]=c}}function Aa(b,c){return xa(b,"$"+(c||"ngController")+"Controller")}function xa(b,c,d){9==b.nodeType&&(b=b.documentElement);for(c=ia(c)?c:[c];b;){for(var e=0,f=c.length;e<
f;e++)if(r(d=ca.data(b,c[e])))return d;b=b.parentNode||11===b.nodeType&&b.host}}function Hb(b){for(Ca(b,!0);b.firstChild;)b.removeChild(b.firstChild)}function Ia(b,c){c||Ca(b);var d=b.parentNode;d&&d.removeChild(b)}function qb(c,d){d=d||b;if("complete"===d.document.readyState)d.setTimeout(c);else ca(d).on("load",c)}function Ma(b,c){var d=Lc[c.toLowerCase()];return d&&Hd[D(b)]&&d}function cb(b,c){var d=function(d,e){d.isDefaultPrevented=function(){return d.defaultPrevented};var f=c[e||d.type],g=f?
f.length:0;if(g){if(s(d.immediatePropagationStopped)){var h=d.stopImmediatePropagation;d.stopImmediatePropagation=function(){d.immediatePropagationStopped=!0;d.stopPropagation&&d.stopPropagation();h&&h.call(d)}}d.isImmediatePropagationStopped=function(){return!0===d.immediatePropagationStopped};var j=f.specialHandlerWrapper||gb;1<g&&(f=J(f));for(var k=0;k<g;k++)d.isImmediatePropagationStopped()||j(b,d,f[k])}};d.elem=b;return d}function gb(b,c,d){d.call(b,c)}function Qa(b,c,d){var e=c.relatedTarget;
e&&(e===b||Ve.call(b,e))||d.call(b,c)}function qa(){this.$get=function(){return k(ea,{hasClass:function(b,c){b.attr&&(b=b[0]);return Fa(b,c)},addClass:function(b,c){b.attr&&(b=b[0]);return bb(b,c)},removeClass:function(b,c){b.attr&&(b=b[0]);return Sa(b,c)}})}}function za(b,c){var d=b&&b.$$hashKey;if(d)return"function"===typeof d&&(d=b.$$hashKey()),d;d=typeof b;return"function"==d||"object"==d&&null!==b?b.$$hashKey=d+":"+(c||h)():d+":"+b}function ua(b,c){if(c){var d=0;this.nextUid=function(){return++d}}e(b,
this.put,this)}function hb(b){b=Function.prototype.toString.call(b).replace(ze,"");return b.match(ve)||b.match(we)}function Ka(b){return(b=hb(b))?"function("+(b[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function Pa(b,c){function d(b){return function(c,d){if(o(c))e(c,g(b));else return b(c,d)}}function f(b,c){sa(b,"service");if(A(c)||ia(c))c=r.instantiate(c);if(!c.$get)throw cc("pget",b);return q[b+"Provider"]=c}function h(b,c){return function(){var d=B.invoke(c,this);if(s(d))throw cc("undef",b);return d}}
function j(b,c,d){return f(b,{$get:!1!==d?h(b,c):c})}function k(b){va(s(b)||ia(b),"modulesToLoad","not an array");var c=[],d;e(b,function(b){function e(b){var c,d;c=0;for(d=b.length;c<d;c++){var f=b[c],g=r.get(f[0]);g[f[1]].apply(g,f[2])}}if(!t.get(b)){t.put(b,!0);try{u(b)?(d=jd(b),c=c.concat(k(d.requires)).concat(d._runBlocks),e(d._invokeQueue),e(d._configBlocks)):A(b)?c.push(r.invoke(b)):ia(b)?c.push(r.invoke(b)):ta(b,"module")}catch(f){throw ia(b)&&(b=b[b.length-1]),f.message&&f.stack&&-1==f.stack.indexOf(f.message)&&
(f=f.message+"\n"+f.stack),cc("modulerr",b,f.stack||f.message||f);}}});return c}function l(b,d){function e(c,f){if(b.hasOwnProperty(c)){if(b[c]===m)throw cc("cdep",c+" <- "+n.join(" <- "));return b[c]}try{return n.unshift(c),b[c]=m,b[c]=d(c,f)}catch(g){throw b[c]===m&&delete b[c],g;}finally{n.shift()}}function f(b,d,g){for(var h=[],b=Pa.$$annotate(b,c,g),j=0,k=b.length;j<k;j++){var l=b[j];if("string"!==typeof l)throw cc("itkn",l);h.push(d&&d.hasOwnProperty(l)?d[l]:e(l,g))}return h}return{invoke:function(b,
c,d,e){"string"===typeof d&&(e=d,d=null);d=f(b,d,e);ia(b)&&(b=b[b.length-1]);return(e=11>=Qb?!1:"function"===typeof b&&/^(?:class\s|constructor\()/.test(Function.prototype.toString.call(b)))?(d.unshift(null),new (Function.prototype.bind.apply(b,d))):b.apply(c,d)},instantiate:function(b,c,d){var e=ia(b)?b[b.length-1]:b,b=f(b,c,d);b.unshift(null);return new (Function.prototype.bind.apply(e,b))},get:e,annotate:Pa.$$annotate,has:function(c){return q.hasOwnProperty(c+"Provider")||b.hasOwnProperty(c)}}}
var c=!0===c,m={},n=[],t=new ua([],!0),q={$provide:{provider:d(f),factory:d(j),service:d(function(b,c){return j(b,["$injector",function(b){return b.instantiate(c)}])}),value:d(function(b,c){return j(b,p(c),!1)}),constant:d(function(b,c){sa(b,"constant");q[b]=c;L[b]=c}),decorator:function(b,c){var d=r.get(b+"Provider"),e=d.$get;d.$get=function(){var b=B.invoke(e,d);return B.invoke(c,null,{$delegate:b})}}}},r=q.$injector=l(q,function(b,c){mb.isString(c)&&n.push(c);throw cc("unpr",n.join(" <- "));}),
L={},w=l(L,function(b,c){var d=r.get(b+"Provider",c);return B.invoke(d.$get,d,void 0,b)}),B=w;q.$injectorProvider={$get:p(w)};var D=k(b),B=w.get("$injector");B.strictDi=c;e(D,function(b){b&&B.invoke(b)});return B}function yb(){var b=!0;this.disableAutoScrolling=function(){b=!1};this.$get=["$window","$location","$rootScope",function(c,d,e){function f(b){var c=null;Array.prototype.some.call(b,function(b){if("a"===D(b))return c=b,!0});return c}function g(b){if(b){b.scrollIntoView();var d;d=h.yOffset;
A(d)?d=d():P(d)?(d=d[0],d="fixed"!==c.getComputedStyle(d).position?0:d.getBoundingClientRect().bottom):w(d)||(d=0);d&&(b=b.getBoundingClientRect().top,c.scrollBy(0,b-d))}else c.scrollTo(0,0)}function h(b){var b=u(b)?b:d.hash(),c;b?(c=j.getElementById(b))?g(c):(c=f(j.getElementsByName(b)))?g(c):"top"===b&&g(null):g(null)}var j=c.document;b&&e.$watch(function(){return d.hash()},function(b,c){b===c&&""===b||qb(function(){e.$evalAsync(h)})});return h}]}function na(b,c){if(!b&&!c)return"";if(!b)return c;
if(!c)return b;ia(b)&&(b=b.join(" "));ia(c)&&(c=c.join(" "));return b+" "+c}function Fb(b){u(b)&&(b=b.split(" "));var c=W();e(b,function(b){b.length&&(c[b]=!0)});return c}function Ja(b){return o(b)?b:{}}function db(b,c,d,f){function g(b){try{b.apply(null,lb.call(arguments,1))}finally{if(q--,0===q)for(;r.length;)try{r.pop()()}catch(c){d.error(c)}}}function h(){D=null;j();k()}function j(){L=z();L=s(L)?null:L;N(L,E)&&(L=E);E=L}function k(){if(B!==l.url()||w!==L)B=l.url(),w=L,e(v,function(b){b(l.url(),
L)})}var l=this,o=b.location,m=b.history,u=b.setTimeout,p=b.clearTimeout,t={};l.isMock=!1;var q=0,r=[];l.$$completeOutstandingRequest=g;l.$$incOutstandingRequestCount=function(){q++};l.notifyWhenNoOutstandingRequests=function(b){0===q?b():r.push(b)};var L,w,B=o.href,A=c.find("base"),D=null,z=f.history?function(){try{return m.state}catch(b){}}:n;j();w=L;l.url=function(c,d,e){s(e)&&(e=null);o!==b.location&&(o=b.location);m!==b.history&&(m=b.history);if(c){var g=w===e;if(B===c&&(!f.history||g))return l;
var h=B&&$a(B)===$a(c);B=c;w=e;if(!f.history||h&&g){if(!h||D)D=c;d?o.replace(c):h?(d=o,e=c.indexOf("#"),e=-1===e?"":c.substr(e),d.hash=e):o.href=c;o.href!==c&&(D=c)}else m[d?"replaceState":"pushState"](e,"",c),j(),w=L;return l}return D||o.href.replace(/%27/g,"'")};l.state=function(){return L};var v=[],O=!1,E=null;l.onUrlChange=function(c){if(!O){if(f.history)ca(b).on("popstate",h);ca(b).on("hashchange",h);O=!0}v.push(c);return c};l.$$applicationDestroyed=function(){ca(b).off("hashchange popstate",
h)};l.$$checkUrlChange=k;l.baseHref=function(){var b=A.attr("href");return b?b.replace(/^(https?\:)?\/\/[^\/]*/,""):""};l.defer=function(b,c){var d;q++;d=u(function(){delete t[d];g(b)},c||0);t[d]=!0;return d};l.defer.cancel=function(b){return t[b]?(delete t[b],p(b),g(n),!0):!1}}function Ib(){this.$get=["$window","$log","$sniffer","$document",function(b,c,d,e){return new db(b,e,c,d)}]}function Ab(){this.$get=function(){function b(e,f){function g(b){b!=u&&(p?p==b&&(p=b.n):p=b,h(b.n,b.p),h(b,u),u=b,
u.n=null)}function h(b,c){b!=c&&(b&&(b.p=c),c&&(c.n=b))}if(e in d)throw c("$cacheFactory")("iid",e);var j=0,l=k({},f,{id:e}),o=W(),m=f&&f.capacity||Number.MAX_VALUE,n=W(),u=null,p=null;return d[e]={put:function(b,c){if(!s(c)){if(m<Number.MAX_VALUE){var d=n[b]||(n[b]={key:b});g(d)}b in o||j++;o[b]=c;j>m&&this.remove(p.key);return c}},get:function(b){if(m<Number.MAX_VALUE){var c=n[b];if(!c)return;g(c)}return o[b]},remove:function(b){if(m<Number.MAX_VALUE){var c=n[b];if(!c)return;c==u&&(u=c.p);c==p&&
(p=c.n);h(c.n,c.p);delete n[b]}b in o&&(delete o[b],j--)},removeAll:function(){o=W();j=0;n=W();u=p=null},destroy:function(){n=l=o=null;delete d[e]},info:function(){return k({},l,{size:j})}}}var d={};b.info=function(){var b={};e(d,function(c,d){b[d]=c.info()});return b};b.get=function(b){return d[b]};return b}}function vb(){this.$get=["$cacheFactory",function(b){return b("templates")}]}function ob(c,d){function f(b,c,d){var g=/^\s*([@&<]|=(\*?))(\??)\s*(\w*)\s*$/,h=W();e(b,function(b,e){if(b in B)h[e]=
B[b];else{var f=b.match(g);if(!f)throw Ra("iscp",c,e,b,d?"controller bindings definition":"isolate scope definition");h[e]={mode:f[1][0],collection:"*"===f[2],optional:"?"===f[3],attrName:f[4]||e};f[4]&&(B[b]=h[e])}});return h}function h(b){var c=b.charAt(0);if(!c||c!==wa(c))throw Ra("baddir",b);if(b!==b.trim())throw Ra("baddir",b);}var j={},l=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,m=/(([\w\-]+)(?:\:([^;]+))?;?)/,t=T("ngSrc,ngSrcset,src,srcset"),L=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,w=/^(on[a-z]+|formaction)$/,
B=W();this.directive=function Xe(b,d){sa(b,"directive");u(b)?(h(b),va(d,"directiveFactory"),j.hasOwnProperty(b)||(j[b]=[],c.factory(b+"Directive",["$injector","$exceptionHandler",function(c,d){var f=[];e(j[b],function(e,g){try{var h=c.invoke(e);A(h)?h={compile:p(h)}:!h.compile&&h.link&&(h.compile=p(h.link));h.priority=h.priority||0;h.index=g;h.name=h.name||b;h.require=h.require||h.controller&&h.name;h.restrict=h.restrict||"EA";h.$$moduleName=e.$$moduleName;f.push(h)}catch(j){d(j)}});return f}])),
j[b].push(d)):e(b,g(Xe));return this};this.component=function(b,c){function d(b){function g(c){return A(c)||ia(c)?function(d,e){return b.invoke(c,this,{$element:d,$attrs:e})}:c}var h=c.template||c.templateUrl?c.template:"",j={controller:f,controllerAs:Mb(c.controller)||c.controllerAs||"$ctrl",template:g(h),templateUrl:g(c.templateUrl),transclude:c.transclude,scope:{},bindToController:c.bindings||{},restrict:"E",require:c.require};e(c,function(b,c){"$"===c.charAt(0)&&(j[c]=b)});return j}var f=c.controller||
function(){};e(c,function(b,c){"$"===c.charAt(0)&&(d[c]=b,A(f)&&(f[c]=b))});d.$inject=["$injector"];return this.directive(b,d)};this.aHrefSanitizationWhitelist=function(b){return r(b)?(d.aHrefSanitizationWhitelist(b),this):d.aHrefSanitizationWhitelist()};this.imgSrcSanitizationWhitelist=function(b){return r(b)?(d.imgSrcSanitizationWhitelist(b),this):d.imgSrcSanitizationWhitelist()};var z=!0;this.debugInfoEnabled=function(b){return r(b)?(z=b,this):z};var v=10;this.onChangesTtl=function(b){return arguments.length?
(v=b,this):v};this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function(c,d,g,h,p,r,ha,B,O,E){function Xa(){try{if(!--Db)throw oa=void 0,Ra("infchng",v);ha.$apply(function(){for(var b=0,c=oa.length;b<c;++b)oa[b]();oa=void 0})}finally{Db++}}function x(b,c){if(c){var d=Object.keys(c),e,f,g;e=0;for(f=d.length;e<f;e++)g=d[e],this[g]=c[g]}else this.$attr={};this.$$element=b}function Ea(b,c,d){rb.innerHTML=
"<span "+c+">";var c=rb.firstChild.attributes,e=c[0];c.removeNamedItem(e.name);e.value=d;b.attributes.setNamedItem(e)}function J(b,c){try{b.addClass(c)}catch(d){}}function C(c,d,e,f,g){c instanceof ca||(c=ca(c));for(var h=/\S+/,j=0,k=c.length;j<k;j++){var l=c[j];l.nodeType===mc&&l.nodeValue.match(h)&&kb(l,c[j]=b.document.createElement("span"))}var o=I(c,d,c,e,f,g);C.$$addScopeClass(c);var m=null;return function(b,d,e){va(b,"scope");g&&g.needsNewScope&&(b=b.$parent.$new());var e=e||{},f=e.parentBoundTranscludeFn,
h=e.transcludeControllers,e=e.futureParentElement;f&&f.$$boundTransclude&&(f=f.$$boundTransclude);m||(m=(e=e&&e[0])?"foreignobject"!==D(e)&&ab.call(e).match(/SVG/)?"svg":"html":"html");e="html"!==m?ca(ta(m,ca("<div>").append(c).html())):d?kc.clone.call(c):c;if(h)for(var j in h)e.data("$"+j+"Controller",h[j].instance);C.$$addScopeInfo(e,b);d&&d(e,b);o&&o(b,e,e,f);return e}}function I(b,c,d,e,f,g){function h(b,d,e,f){var g,k,l,o,m,s,u;if(n){u=Array(d.length);for(o=0;o<j.length;o+=3)g=j[o],u[g]=d[g]}else u=
d;o=0;for(m=j.length;o<m;)k=u[j[o++]],d=j[o++],g=j[o++],d?(d.scope?(l=b.$new(),C.$$addScopeInfo(ca(k),l)):l=b,s=d.transcludeOnThisElement?la(b,d.transclude,f):!d.templateOnThisElement&&f?f:!f&&c?la(b,c):null,d(g,l,k,e,s)):g&&g(b,k.childNodes,void 0,f)}for(var j=[],k,l,o,m,n,s=0;s<b.length;s++){k=new x;l=X(b[s],[],k,0===s?e:void 0,f);(g=l.length?Q(l,b[s],k,c,d,null,[],[],g):null)&&g.scope&&C.$$addScopeClass(k.$$element);k=g&&g.terminal||!(o=b[s].childNodes)||!o.length?null:I(o,g?(g.transcludeOnThisElement||
!g.templateOnThisElement)&&g.transclude:c);if(g||k)j.push(s,g,k),m=!0,n=n||g;g=null}return m?h:null}function la(b,c,d){function e(f,g,h,j,k){f||(f=b.$new(!1,k),f.$$transcluded=!0);return c(f,g,{parentBoundTranscludeFn:d,transcludeControllers:h,futureParentElement:j})}var f=e.$$slots=W(),g;for(g in c.$$slots)f[g]=c.$$slots[g]?la(b,c.$$slots[g],d):null;return e}function X(b,c,d,e,f){var g=d.$attr,h;switch(b.nodeType){case 1:da(c,Ha(D(b)),"E",e,f);for(var j,k,n,s=b.attributes,p=0,t=s&&s.length;p<t;p++){var q=
!1,r=!1;j=s[p];h=j.name;k=ya(j.value);j=Ha(h);if(n=Wa.test(j))h=h.replace(Qd,"").substr(8).replace(/_(.)/g,function(b,c){return c.toUpperCase()});(j=j.match(Fa))&&Y(j[1])&&(q=h,r=h.substr(0,h.length-5)+"end",h=h.substr(0,h.length-6));j=Ha(h.toLowerCase());g[j]=h;if(n||!d.hasOwnProperty(j))d[j]=k,Ma(b,j)&&(d[j]=!0);We(b,c,k,j,n);da(c,j,"A",e,f,q,r)}b=b.className;o(b)&&(b=b.animVal);if(u(b)&&""!==b)for(;h=m.exec(b);)j=Ha(h[2]),da(c,j,"C",e,f)&&(d[j]=ya(h[3])),b=b.substr(h.index+h[0].length);break;case mc:if(11===
Qb)for(;b.parentNode&&b.nextSibling&&b.nextSibling.nodeType===mc;)b.nodeValue+=b.nextSibling.nodeValue,b.parentNode.removeChild(b.nextSibling);ba(c,b.nodeValue);break;case 8:try{if(h=l.exec(b.nodeValue))j=Ha(h[1]),da(c,j,"M",e,f)&&(d[j]=ya(h[2]))}catch(L){}}c.sort(R);return c}function Z(b,c,d){var e=[],f=0;if(c&&b.hasAttribute&&b.hasAttribute(c)){do{if(!b)throw Ra("uterdir",c,d);1==b.nodeType&&(b.hasAttribute(c)&&f++,b.hasAttribute(d)&&f--);e.push(b);b=b.nextSibling}while(0<f)}else e.push(b);return ca(e)}
function fa(b,c,d){return function(e,f,g,h,j){f=Z(f[0],c,d);return b(e,f,g,h,j)}}function G(b,c,d,e,f,g){var h;return b?C(c,d,e,f,g):function(){h||(h=C(c,d,e,f,g),c=d=g=null);return h.apply(this,arguments)}}function Q(b,c,d,f,h,j,l,m,n){function u(b,c,d,e){if(b){d&&(b=fa(b,d,e));b.require=E.require;b.directiveName=Xa;if(L===E||E.$$isolateScope)b=Da(b,{isolateScope:!0});l.push(b)}if(c){d&&(c=fa(c,d,e));c.require=E.require;c.directiveName=Xa;if(L===E||E.$$isolateScope)c=Da(c,{isolateScope:!0});m.push(c)}}
function p(b,f,g,h,j){function n(b,c,d,e){var f;H(b)||(e=d,d=c,c=b,b=void 0);v&&(f=z);d||(d=v?E.parent():E);if(e){var g=j.$$slots[e];if(g)return g(b,c,f,d,Ea);if(s(g))throw Ra("noslot",e,M(E));}else return j(b,c,f,d,Ea)}var u,t,ha,B,D,z,O,E;c===g?(h=d,E=d.$$element):(E=ca(g),h=new x(E,d));D=f;L?B=f.$new(!0):q&&(D=f.$parent);j&&(O=n,O.$$boundTransclude=j,O.isSlotFilled=function(b){return!!j.$$slots[b]});r&&(z=aa(E,h,O,r,B,f,L));L&&(C.$$addScopeInfo(E,B,!0,!(w&&(w===L||w===L.$$originalDirective))),
C.$$addScopeClass(E,!0),B.$$isolateBindings=L.$$isolateBindings,t=sa(f,h,B,B.$$isolateBindings,L),t.removeWatches&&B.$on("$destroy",t.removeWatches));for(u in z){t=r[u];ha=z[u];var Xa=t.$$bindings.bindToController;ha.bindingInfo=ha.identifier&&Xa?sa(D,h,ha.instance,Xa,t):{};var W=ha();W!==ha.instance&&(ha.instance=W,E.data("$"+t.name+"Controller",W),ha.bindingInfo.removeWatches&&ha.bindingInfo.removeWatches(),ha.bindingInfo=sa(D,h,ha.instance,Xa,t))}e(r,function(b,c){var d=b.require;b.bindToController&&
!ia(d)&&o(d)&&k(z[c].instance,U(c,d,E,z))});e(z,function(b){var c=b.instance;A(c.$onChanges)&&c.$onChanges(b.bindingInfo.initialChanges);A(c.$onInit)&&c.$onInit();A(c.$onDestroy)&&D.$on("$destroy",function(){c.$onDestroy()})});u=0;for(t=l.length;u<t;u++)ha=l[u],Vb(ha,ha.isolateScope?B:f,E,h,ha.require&&U(ha.directiveName,ha.require,E,z),O);var Ea=f;L&&(L.template||null===L.templateUrl)&&(Ea=B);b&&b(Ea,g.childNodes,void 0,j);for(u=m.length-1;0<=u;u--)ha=m[u],Vb(ha,ha.isolateScope?B:f,E,h,ha.require&&
U(ha.directiveName,ha.require,E,z),O);e(z,function(b){b=b.instance;A(b.$postLink)&&b.$postLink()})}for(var n=n||{},t=-Number.MAX_VALUE,q=n.newScopeDirective,r=n.controllerDirectives,L=n.newIsolateScopeDirective,w=n.templateDirective,ha=n.nonTlbTranscludeDirective,B=!1,z=!1,v=n.hasElementTranscludeDirective,O=d.$$element=ca(c),E,Xa,Ea,F=f,J,Yb=!1,I=!1,la,Kb=0,sc=b.length;Kb<sc;Kb++){E=b[Kb];var N=E.$$start,ud=E.$$end;N&&(O=Z(c,N,ud));Ea=void 0;if(t>E.priority)break;if(la=E.scope)E.templateUrl||(o(la)?
(ja("new/isolated scope",L||q,E,O),L=E):ja("new/isolated scope",L,E,O)),q=q||E;Xa=E.name;if(!Yb&&(E.replace&&(E.templateUrl||E.template)||E.transclude&&!E.$$tlb)){for(la=Kb+1;Yb=b[la++];)if(Yb.transclude&&!Yb.$$tlb||Yb.replace&&(Yb.templateUrl||Yb.template)){I=!0;break}Yb=!0}!E.templateUrl&&E.controller&&(la=E.controller,r=r||W(),ja("'"+Xa+"' controller",r[Xa],E,O),r[Xa]=E);if(la=E.transclude)if(B=!0,E.$$tlb||(ja("transclusion",ha,E,O),ha=E),"element"==la)v=!0,t=E.priority,Ea=O,O=d.$$element=ca(C.$$createComment(Xa,
d[Xa])),c=O[0],ka(h,lb.call(Ea,0),c),Ea[0].$$parentNode=Ea[0].parentNode,F=G(I,Ea,f,t,j&&j.name,{nonTlbTranscludeDirective:ha});else{var Ob=W();Ea=ca(ma(c)).contents();if(o(la)){Ea=[];var da=W(),vd=W();e(la,function(b,c){var d="?"===b.charAt(0),b=d?b.substring(1):b;da[b]=c;Ob[c]=null;vd[c]=d});e(O.contents(),function(b){var c=da[Ha(D(b))];c?(vd[c]=!0,Ob[c]=Ob[c]||[],Ob[c].push(b)):Ea.push(b)});e(vd,function(b,c){if(!b)throw Ra("reqslot",c);});for(var Y in Ob)Ob[Y]&&(Ob[Y]=G(I,Ob[Y],f))}O.empty();
F=G(I,Ea,f,void 0,void 0,{needsNewScope:E.$$isolateScope||E.$$newScope});F.$$slots=Ob}if(E.template)if(z=!0,ja("template",w,E,O),w=E,la=A(E.template)?E.template(O,d):E.template,la=Na(la),E.replace){j=E;Ea=id.test(la)?Rb(ta(E.templateNamespace,ya(la))):[];c=Ea[0];if(1!=Ea.length||1!==c.nodeType)throw Ra("tplrt",Xa,"");ka(h,O,c);sc={$attr:{}};la=X(c,[],sc);var R=b.splice(Kb+1,b.length-(Kb+1));(L||q)&&Ub(la,L,q);b=b.concat(la).concat(R);P(d,sc);sc=b.length}else O.html(la);if(E.templateUrl)z=!0,ja("template",
w,E,O),w=E,E.replace&&(j=E),p=ra(b.splice(Kb,b.length-Kb),O,d,h,B&&F,l,m,{controllerDirectives:r,newScopeDirective:q!==E&&q,newIsolateScopeDirective:L,templateDirective:w,nonTlbTranscludeDirective:ha}),sc=b.length;else if(E.compile)try{J=E.compile(O,d,F),A(J)?u(null,J,N,ud):J&&u(J.pre,J.post,N,ud)}catch(K){g(K,M(O))}E.terminal&&(p.terminal=!0,t=Math.max(t,E.priority))}p.scope=q&&!0===q.scope;p.transcludeOnThisElement=B;p.templateOnThisElement=z;p.transclude=F;n.hasElementTranscludeDirective=v;return p}
function U(b,c,d,f){var g;if(u(c)){var h=c.match(L),c=c.substring(h[0].length),j=h[1]||h[3],h="?"===h[2];"^^"===j?d=d.parent():g=(g=f&&f[c])&&g.instance;if(!g){var k="$"+c+"Controller";g=j?d.inheritedData(k):d.data(k)}if(!g&&!h)throw Ra("ctreq",c,b);}else if(ia(c)){g=[];j=0;for(h=c.length;j<h;j++)g[j]=U(b,c[j],d,f)}else o(c)&&(g={},e(c,function(c,e){g[e]=U(b,c,d,f)}));return g||null}function aa(b,c,d,e,f,g,h){var j=W(),k;for(k in e){var l=e[k],o={$scope:l===h||l.$$isolateScope?f:g,$element:b,$attrs:c,
$transclude:d},m=l.controller;"@"==m&&(m=c[l.name]);o=r(m,o,!0,l.controllerAs);j[l.name]=o;b.data("$"+l.name+"Controller",o.instance)}return j}function Ub(b,c,d){for(var e=0,f=b.length;e<f;e++)b[e]=k(Object.create(b[e]),{$$isolateScope:c,$$newScope:d})}function da(b,d,e,h,l,m,n){if(d===l)return null;l=null;if(j.hasOwnProperty(d))for(var u,d=c.get(d+"Directive"),p=0,t=d.length;p<t;p++)try{if(u=d[p],(s(h)||h>u.priority)&&-1!=u.restrict.indexOf(e)){m&&(u=k(Object.create(u),{$$start:m,$$end:n}));if(!u.$$bindings){var q=
u,r=u,L=u.name,w={isolateScope:null,bindToController:null};o(r.scope)&&(!0===r.bindToController?(w.bindToController=f(r.scope,L,!0),w.isolateScope={}):w.isolateScope=f(r.scope,L,!1));o(r.bindToController)&&(w.bindToController=f(r.bindToController,L,!0));if(o(w.bindToController)){var ha=r.controller,B=r.controllerAs;if(!ha)throw Ra("noctrl",L);if(!Mb(ha,B))throw Ra("noident",L);}var D=q.$$bindings=w;o(D.isolateScope)&&(u.$$isolateBindings=D.isolateScope)}b.push(u);l=u}}catch(A){g(A)}return l}function Y(b){if(j.hasOwnProperty(b))for(var d=
c.get(b+"Directive"),e=0,f=d.length;e<f;e++)if(b=d[e],b.multiElement)return!0;return!1}function P(b,c){var d=c.$attr,f=b.$attr,g=b.$$element;e(b,function(e,f){"$"!=f.charAt(0)&&(c[f]&&c[f]!==e&&(e+=("style"===f?";":" ")+c[f]),b.$set(f,e,!0,d[f]))});e(c,function(c,e){"class"==e?(J(g,c),b["class"]=(b["class"]?b["class"]+" ":"")+c):"style"==e?(g.attr("style",g.attr("style")+";"+c),b.style=(b.style?b.style+";":"")+c):"$"==e.charAt(0)||b.hasOwnProperty(e)||(b[e]=c,f[e]=d[e])})}function ra(b,c,d,f,g,j,
l,m){var n=[],s,u,p=c[0],t=b.shift(),q=k(Object.create(t),{templateUrl:null,transclude:null,replace:null,$$originalDirective:t}),r=A(t.templateUrl)?t.templateUrl(c,d):t.templateUrl,L=t.templateNamespace;c.empty();h(r).then(function(h){var k,w,h=Na(h);if(t.replace){h=id.test(h)?Rb(ta(L,ya(h))):[];k=h[0];if(1!=h.length||1!==k.nodeType)throw Ra("tplrt",t.name,r);h={$attr:{}};ka(f,c,k);var ha=X(k,[],h);o(t.scope)&&Ub(ha,!0);b=ha.concat(b);P(d,h)}else k=p,c.html(h);b.unshift(q);s=Q(b,k,d,g,c,t,j,l,m);
e(f,function(b,d){b==k&&(f[d]=c[0])});for(u=I(c[0].childNodes,g);n.length;){h=n.shift();w=n.shift();var B=n.shift(),D=n.shift(),ha=c[0];if(!h.$$destroyed){if(w!==p){var A=w.className;m.hasElementTranscludeDirective&&t.replace||(ha=ma(k));ka(B,ca(w),ha);J(ca(ha),A)}w=s.transcludeOnThisElement?la(h,s.transclude,D):D;s(u,h,ha,f,w)}}n=null});return function(b,c,d,e,f){b=f;c.$$destroyed||(n?n.push(c,d,e,b):(s.transcludeOnThisElement&&(b=la(c,s.transclude,f)),s(u,c,d,e,b)))}}function R(b,c){var d=c.priority-
b.priority;return 0!==d?d:b.name!==c.name?b.name<c.name?-1:1:b.index-c.index}function ja(b,c,d,e){if(c)throw Ra("multidir",c.name,c.$$moduleName?" (module: "+c.$$moduleName+")":"",d.name,d.$$moduleName?" (module: "+d.$$moduleName+")":"",b,M(e));}function ba(b,c){var e=d(c,!0);e&&b.push({priority:0,compile:function(b){var b=b.parent(),c=!!b.length;c&&C.$$addBindingClass(b);return function(b,d){var f=d.parent();c||C.$$addBindingClass(f);C.$$addBindingInfo(f,e.expressions);b.$watch(e,function(b){d[0].nodeValue=
b})}}})}function ta(c,d){c=wa(c||"html");switch(c){case "svg":case "math":var e=b.document.createElement("div");e.innerHTML="<"+c+">"+d+"</"+c+">";return e.childNodes[0].childNodes;default:return d}}function T(b,c){if("srcdoc"==c)return B.HTML;var d=D(b);if("xlinkHref"==c||"form"==d&&"action"==c||"img"!=d&&("src"==c||"ngSrc"==c))return B.RESOURCE_URL}function We(b,c,e,f,g){var h=T(b,f),g=t[f]||g,j=d(e,!0,h,g);if(j){if("multiple"===f&&"select"===D(b))throw Ra("selmulti",M(b));c.push({priority:100,
compile:function(){return{pre:function(b,c,k){c=k.$$observers||(k.$$observers=W());if(w.test(f))throw Ra("nodomevents");var l=k[f];l!==e&&(j=l&&d(l,!0,h,g),e=l);j&&(k[f]=j(b),(c[f]||(c[f]=[])).$$inter=!0,(k.$$observers&&k.$$observers[f].$$scope||b).$watch(j,function(b,c){"class"===f&&b!=c?k.$updateClass(b,c):k.$set(f,b)}))}}}})}}function ka(c,d,e){var f=d[0],g=d.length,h=f.parentNode,j,k;if(c){j=0;for(k=c.length;j<k;j++)if(c[j]==f){c[j++]=e;k=j+g-1;for(var l=c.length;j<l;j++,k++)k<l?c[j]=c[k]:delete c[j];
c.length-=g-1;c.context===f&&(c.context=e);break}}h&&h.replaceChild(e,f);c=b.document.createDocumentFragment();for(j=0;j<g;j++)c.appendChild(d[j]);ca.hasData(f)&&(ca.data(e,ca.data(f)),ca(f).off("$destroy"));ca.cleanData(c.querySelectorAll("*"));for(j=1;j<g;j++)delete d[j];d[0]=e;d.length=1}function Da(b,c){return k(function(){return b.apply(null,arguments)},b,c)}function Vb(b,c,d,e,f,h){try{b(c,d,e,f,h)}catch(j){g(j,M(d))}}function sa(b,c,f,g,h){function j(c,d,e){A(f.$onChanges)&&d!==e&&(oa||(b.$$postDigest(Xa),
oa=[]),m||(m={},oa.push(k)),m[c]&&(e=m[c].previousValue),m[c]=new Ga(e,d))}function k(){f.$onChanges(m);m=void 0}var l=[],o={},m;e(g,function(e,g){var k=e.attrName,m=e.optional,s,t,q,r;switch(e.mode){case "@":m||Gb.call(c,k)||(f[g]=c[k]=void 0);c.$observe(k,function(b){if(u(b)||K(b))j(g,b,f[g]),f[g]=b});c.$$observers[k].$$scope=b;s=c[k];u(s)?f[g]=d(s)(b):K(s)&&(f[g]=s);o[g]=new Ga(ld,f[g]);break;case "=":if(!Gb.call(c,k)){if(m)break;c[k]=void 0}if(m&&!c[k])break;t=p(c[k]);r=t.literal?N:function(b,
c){return b===c||b!==b&&c!==c};q=t.assign||function(){s=f[g]=t(b);throw Ra("nonassign",c[k],k,h.name);};s=f[g]=t(b);m=function(c){r(c,f[g])||(r(c,s)?q(b,c=f[g]):f[g]=c);return s=c};m.$stateful=!0;m=e.collection?b.$watchCollection(c[k],m):b.$watch(p(c[k],m),null,t.literal);l.push(m);break;case "<":if(!Gb.call(c,k)){if(m)break;c[k]=void 0}if(m&&!c[k])break;t=p(c[k]);f[g]=t(b);o[g]=new Ga(ld,f[g]);m=b.$watch(t,function(b,c){b===c&&(c=f[g]);j(g,b,c);f[g]=b},t.literal);l.push(m);break;case "&":t=c.hasOwnProperty(k)?
p(c[k]):n;if(t===n&&m)break;f[g]=function(c){return t(b,c)}}});return{initialChanges:o,removeWatches:l.length&&function(){for(var b=0,c=l.length;b<c;++b)l[b]()}}}var V=/^\w/,rb=b.document.createElement("div"),Db=v,oa;x.prototype={$normalize:Ha,$addClass:function(b){b&&0<b.length&&O.addClass(this.$$element,b)},$removeClass:function(b){b&&0<b.length&&O.removeClass(this.$$element,b)},$updateClass:function(b,c){var d=pb(b,c);d&&d.length&&O.addClass(this.$$element,d);(d=pb(c,b))&&d.length&&O.removeClass(this.$$element,
d)},$set:function(b,c,d,f){var h=Ma(this.$$element[0],b),j=Id[b],k=b;h?(this.$$element.prop(b,c),f=h):j&&(this[j]=c,k=j);this[b]=c;f?this.$attr[b]=f:(f=this.$attr[b])||(this.$attr[b]=f=pa(b,"-"));h=D(this.$$element);if("a"===h&&("href"===b||"xlinkHref"===b)||"img"===h&&"src"===b)this[b]=c=E(c,"src"===b);else if("img"===h&&"srcset"===b){for(var h="",j=ya(c),l=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,l=/\s/.test(j)?l:/(,)/,j=j.split(l),l=Math.floor(j.length/2),o=0;o<l;o++)var m=2*o,h=h+E(ya(j[m]),!0),
h=h+(" "+ya(j[m+1]));j=ya(j[2*o]).split(/\s/);h+=E(ya(j[0]),!0);2===j.length&&(h+=" "+ya(j[1]));this[b]=c=h}!1!==d&&(null===c||s(c)?this.$$element.removeAttr(f):V.test(f)?this.$$element.attr(f,c):Ea(this.$$element[0],f,c));(b=this.$$observers)&&e(b[k],function(b){try{b(c)}catch(d){g(d)}})},$observe:function(b,c){var d=this,e=d.$$observers||(d.$$observers=W()),f=e[b]||(e[b]=[]);f.push(c);ha.$evalAsync(function(){f.$$inter||!d.hasOwnProperty(b)||s(d[b])||c(d[b])});return function(){F(f,c)}}};var La=
d.startSymbol(),ea=d.endSymbol(),Na="{{"==La&&"}}"==ea?q:function(b){return b.replace(/\{\{/g,La).replace(/}}/g,ea)},Wa=/^ngAttr[A-Z]/,Fa=/^(.+)Start$/;C.$$addBindingInfo=z?function(b,c){var d=b.data("$binding")||[];ia(c)?d=d.concat(c):d.push(c);b.data("$binding",d)}:n;C.$$addBindingClass=z?function(b){J(b,"ng-binding")}:n;C.$$addScopeInfo=z?function(b,c,d,e){b.data(d?e?"$isolateScopeNoTemplate":"$isolateScope":"$scope",c)}:n;C.$$addScopeClass=z?function(b,c){J(b,c?"ng-isolate-scope":"ng-scope")}:
n;C.$$createComment=function(c,d){var e="";z&&(e=" "+(c||"")+": "+(d||"")+" ");return b.document.createComment(e)};return C}]}function Ga(b,c){this.previousValue=b;this.currentValue=c}function Ha(b){return v(b.replace(Qd,""))}function pb(b,c){var d="",e=b.split(/\s+/),f=c.split(/\s+/),g=0;a:for(;g<e.length;g++){for(var h=e[g],j=0;j<f.length;j++)if(h==f[j])continue a;d+=(0<d.length?" ":"")+h}return d}function Rb(b){var b=ca(b),c=b.length;if(1>=c)return b;for(;c--;)8===b[c].nodeType&&Ce.call(b,c,1);
return b}function Mb(b,c){if(c&&u(c))return c;if(u(b)){var d=ae.exec(b);if(d)return d[3]}}function $b(){var b={},d=!1;this.has=function(c){return b.hasOwnProperty(c)};this.register=function(c,d){sa(c,"controller");o(c)?k(b,c):b[c]=d};this.allowGlobals=function(){d=!0};this.$get=["$injector","$window",function(e,f){function g(b,d,e,f){if(!b||!o(b.$scope))throw c("$controller")("noscp",f,d);b.$scope[d]=e}return function(c,h,j,l){var m,n,s,j=!0===j;l&&u(l)&&(s=l);if(u(c)){l=c.match(ae);if(!l)throw If("ctrlfmt",
c);n=l[1];s=s||l[3];c=b.hasOwnProperty(n)?b[n]:Da(h.$scope,n,!0)||(d?Da(f,n,!0):void 0);ta(c,n,!0)}if(j)return j=(ia(c)?c[c.length-1]:c).prototype,m=Object.create(j||null),s&&g(h,s,m,n||c.name),k(function(){var b=e.invoke(c,m,h,n);b!==m&&(o(b)||A(b))&&(m=b,s&&g(h,s,m,n||c.name));return m},{instance:m,identifier:s});m=e.instantiate(c,h,n);s&&g(h,s,m,n||c.name);return m}}]}function ac(){this.$get=["$window",function(b){return ca(b.document)}]}function Nb(){this.$get=["$log",function(b){return function(c,
d){b.error.apply(b,arguments)}}]}function Ya(b){return o(b)?z(b)?b.toISOString():B(b):b}function bc(){this.$get=function(){return function(b){if(!b)return"";var c=[];f(b,function(b,d){null===b||s(b)||(ia(b)?e(b,function(b){c.push(da(d)+"="+da(Ya(b)))}):c.push(da(d)+"="+da(Ya(b))))});return c.join("&")}}}function gc(){this.$get=function(){return function(b){function c(b,g,h){null===b||s(b)||(ia(b)?e(b,function(b,d){c(b,g+"["+(o(b)?d:"")+"]")}):o(b)&&!z(b)?f(b,function(b,d){c(b,g+(h?"":"[")+d+(h?"":
"]"))}):d.push(da(g)+"="+da(Ya(b))))}if(!b)return"";var d=[];c(b,"",!0);return d.join("&")}}}function Za(b,c){if(u(b)){var d=b.replace(Jf,"").trim();if(d){var e=c("Content-Type");(e=e&&0===e.indexOf(be))||(e=(e=d.match(Kf))&&Lf[e[0]].test(d));e&&(b=E(d))}}return b}function Sb(b){var c=W(),d;u(b)?e(b.split("\n"),function(b){d=b.indexOf(":");var e=wa(ya(b.substr(0,d))),b=ya(b.substr(d+1));e&&(c[e]=c[e]?c[e]+", "+b:b)}):o(b)&&e(b,function(b,d){var e=wa(d),f=ya(b);e&&(c[e]=c[e]?c[e]+", "+f:f)});return c}
function Tb(b){var c;return function(d){c||(c=Sb(b));return d?(d=c[wa(d)],void 0===d&&(d=null),d):c}}function jb(b,c,d,f){if(A(f))return f(b,c,d);e(f,function(e){b=e(b,c,d)});return b}function sb(){var b=this.defaults={transformResponse:[Za],transformRequest:[function(b){return o(b)&&"[object File]"!==ab.call(b)&&"[object Blob]"!==ab.call(b)&&"[object FormData]"!==ab.call(b)?B(b):b}],headers:{common:{Accept:"application/json, text/plain, */*"},post:J(wd),put:J(wd),patch:J(wd)},xsrfCookieName:"XSRF-TOKEN",
xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},d=!1;this.useApplyAsync=function(b){return r(b)?(d=!!b,this):d};var f=!0;this.useLegacyPromiseExtensions=function(b){return r(b)?(f=!!b,this):f};var g=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function(h,j,l,m,n,p){function t(d){function g(b){var c=k({},b);c.data=jb(b.data,b.headers,b.status,j.transformResponse);b=b.status;return 200<=b&&300>b?c:n.reject(c)}function h(b,
c){var d,f={};e(b,function(b,e){A(b)?(d=b(c),null!=d&&(f[e]=d)):f[e]=b});return f}if(!o(d))throw c("$http")("badreq",d);if(!u(d.url))throw c("$http")("badreq",d.url);var j=k({method:"get",transformRequest:b.transformRequest,transformResponse:b.transformResponse,paramSerializer:b.paramSerializer},d);j.headers=function(c){var d=b.headers,e=k({},c.headers),f,g,j,d=k({},d.common,d[wa(c.method)]);a:for(f in d){g=wa(f);for(j in e)if(wa(j)===g)continue a;e[f]=d[f]}return h(e,J(c))}(d);j.method=Oc(j.method);
j.paramSerializer=u(j.paramSerializer)?p.get(j.paramSerializer):j.paramSerializer;var l=[function(c){var d=c.headers,f=jb(c.data,Tb(d),void 0,c.transformRequest);s(f)&&e(d,function(b,c){"content-type"===wa(c)&&delete d[c]});s(c.withCredentials)&&!s(b.withCredentials)&&(c.withCredentials=b.withCredentials);return q(c,f).then(g,g)},void 0],m=n.when(j);for(e(B,function(b){(b.request||b.requestError)&&l.unshift(b.request,b.requestError);(b.response||b.responseError)&&l.push(b.response,b.responseError)});l.length;)var d=
l.shift(),r=l.shift(),m=m.then(d,r);f?(m.success=function(b){ta(b,"fn");m.then(function(c){b(c.data,c.status,c.headers,j)});return m},m.error=function(b){ta(b,"fn");m.then(null,function(c){b(c.data,c.status,c.headers,j)});return m}):(m.success=ce("success"),m.error=ce("error"));return m}function q(c,f){function g(b){if(b){var c={};e(b,function(b,e){c[e]=function(c){function e(){b(c)}d?m.$applyAsync(e):m.$$phase?e():m.$apply(e)}});return c}}function k(b,c,e,f){function g(){l(c,b,e,f)}z&&(200<=b&&300>
b?z.put(E,[b,c,Sb(e),f]):z.remove(E));d?m.$applyAsync(g):(g(),m.$$phase||m.$apply())}function l(b,d,e,f){d=-1<=d?d:0;(200<=d&&300>d?B.resolve:B.reject)({data:b,status:d,headers:Tb(e),config:c,statusText:f})}function u(b){l(b.data,b.status,J(b.headers()),b.statusText)}function p(){var b=t.pendingRequests.indexOf(c);-1!==b&&t.pendingRequests.splice(b,1)}var B=n.defer(),D=B.promise,z,O,v=c.headers,E=L(c.url,c.paramSerializer(c.params));t.pendingRequests.push(c);D.then(p,p);!c.cache&&!b.cache||!1===c.cache||
"GET"!==c.method&&"JSONP"!==c.method||(z=o(c.cache)?c.cache:o(b.cache)?b.cache:w);z&&(O=z.get(E),r(O)?O&&A(O.then)?O.then(u,u):ia(O)?l(O[1],O[0],J(O[2]),O[3]):l(O,200,{},"OK"):z.put(E,D));s(O)&&((O=rc(c.url)?j()[c.xsrfCookieName||b.xsrfCookieName]:void 0)&&(v[c.xsrfHeaderName||b.xsrfHeaderName]=O),h(c.method,E,f,k,v,c.timeout,c.withCredentials,c.responseType,g(c.eventHandlers),g(c.uploadEventHandlers)));return D}function L(b,c){0<c.length&&(b+=(-1==b.indexOf("?")?"?":"&")+c);return b}var w=l("$http");
b.paramSerializer=u(b.paramSerializer)?p.get(b.paramSerializer):b.paramSerializer;var B=[];e(g,function(b){B.unshift(u(b)?p.get(b):p.invoke(b))});t.pendingRequests=[];(function(b){e(arguments,function(b){t[b]=function(c,d){return t(k({},d||{},{method:b,url:c}))}})})("get","delete","head","jsonp");(function(b){e(arguments,function(b){t[b]=function(c,d,e){return t(k({},e||{},{method:b,url:c,data:d}))}})})("post","put","patch");t.defaults=b;return t}]}function hc(){this.$get=function(){return function(){return new b.XMLHttpRequest}}}
function nc(){this.$get=["$browser","$window","$document","$xhrFactory",function(b,c,d,e){return Ub(b,e,b.defer,c.angular.callbacks,d[0])}]}function Ub(b,c,d,f,g){function h(b,c,d){var e=g.createElement("script"),j=null;e.type="text/javascript";e.src=b;e.async=!0;j=function(b){e.removeEventListener("load",j,!1);e.removeEventListener("error",j,!1);g.body.removeChild(e);e=null;var h=-1,k="unknown";b&&("load"!==b.type||f[c].called||(b={type:"error"}),k=b.type,h="error"===b.type?404:200);d&&d(h,k)};e.addEventListener("load",
j,!1);e.addEventListener("error",j,!1);g.body.appendChild(e);return j}return function(g,j,k,l,o,m,u,p,t,q){function L(){D&&D();z&&z.abort()}function w(c,e,f,g,h){r(v)&&d.cancel(v);D=z=null;c(e,f,g,h);b.$$completeOutstandingRequest(n)}b.$$incOutstandingRequestCount();j=j||b.url();if("jsonp"==wa(g)){var B="_"+(f.counter++).toString(36);f[B]=function(b){f[B].data=b;f[B].called=!0};var D=h(j.replace("JSON_CALLBACK","angular.callbacks."+B),B,function(b,c){w(l,b,f[B].data,"",c);f[B]=n})}else{var z=c(g,
j);z.open(g,j,!0);e(o,function(b,c){r(b)&&z.setRequestHeader(c,b)});z.onload=function(){var b=z.statusText||"",c="response"in z?z.response:z.responseText,d=1223===z.status?204:z.status;0===d&&(d=c?200:"file"==wb(j).protocol?404:0);w(l,d,c,z.getAllResponseHeaders(),b)};g=function(){w(l,-1,null,null,"")};z.onerror=g;z.onabort=g;e(t,function(b,c){z.addEventListener(c,b)});e(q,function(b,c){z.upload.addEventListener(c,b)});u&&(z.withCredentials=!0);if(p)try{z.responseType=p}catch(O){if("json"!==p)throw O;
}z.send(s(k)?null:k)}if(0<m)var v=d(L,m);else m&&A(m.then)&&m.then(L)}}function Vb(){var b="{{",c="}}";this.startSymbol=function(c){return c?(b=c,this):b};this.endSymbol=function(b){return b?(c=b,this):c};this.$get=["$parse","$exceptionHandler","$sce",function(d,e,f){function g(b){return"\\\\\\"+b}function h(d){return d.replace(n,b).replace(u,c)}function j(b,c,d,e){var f;return f=b.$watch(function(b){f();return e(b)},c,d)}function l(g,n,u,t){function q(b){try{var c=b,b=u?f.getTrusted(u,c):f.valueOf(c),
d;if(t&&!r(b))d=b;else if(null==b)d="";else{switch(typeof b){case "string":break;case "number":b=""+b;break;default:b=B(b)}d=b}return d}catch(h){e(ic.interr(g,h))}}if(!g.length||-1===g.indexOf(b)){var L;n||(n=h(g),L=p(n),L.exp=g,L.expressions=[],L.$$watchDelegate=j);return L}var t=!!t,w,D,z=0,O=[],v=[];L=g.length;for(var E=[],x=[];z<L;)if(-1!=(w=g.indexOf(b,z))&&-1!=(D=g.indexOf(c,w+o)))z!==w&&E.push(h(g.substring(z,w))),z=g.substring(w+o,D),O.push(z),v.push(d(z,q)),z=D+m,x.push(E.length),E.push("");
else{z!==L&&E.push(h(g.substring(z)));break}u&&1<E.length&&ic.throwNoconcat(g);if(!n||O.length){var W=function(b){for(var c=0,d=O.length;c<d;c++){if(t&&s(b[c]))return;E[x[c]]=b[c]}return E.join("")};return k(function(b){var c=0,d=O.length,f=Array(d);try{for(;c<d;c++)f[c]=v[c](b);return W(f)}catch(h){e(ic.interr(g,h))}},{exp:g,expressions:O,$$watchDelegate:function(b,c){var d;return b.$watchGroup(v,function(e,f){var g=W(e);A(c)&&c.call(this,g,e!==f?d:g,b);d=g})}})}}var o=b.length,m=c.length,n=RegExp(b.replace(/./g,
g),"g"),u=RegExp(c.replace(/./g,g),"g");l.startSymbol=function(){return b};l.endSymbol=function(){return c};return l}]}function rb(){this.$get=["$rootScope","$window","$q","$$q","$browser",function(b,c,d,e,f){function g(j,k,l,o){function m(){n?j.apply(null,s):j(t)}var n=4<arguments.length,s=n?lb.call(arguments,4):[],u=c.setInterval,p=c.clearInterval,t=0,q=r(o)&&!o,L=(q?e:d).defer(),w=L.promise,l=r(l)?l:0;w.$$intervalId=u(function(){q?f.defer(m):b.$evalAsync(m);L.notify(t++);0<l&&t>=l&&(L.resolve(t),
p(w.$$intervalId),delete h[w.$$intervalId]);q||b.$apply()},k);h[w.$$intervalId]=L;return w}var h={};g.cancel=function(b){return b&&b.$$intervalId in h?(h[b.$$intervalId].reject("canceled"),c.clearInterval(b.$$intervalId),delete h[b.$$intervalId],!0):!1};return g}]}function la(b){for(var b=b.split("/"),c=b.length;c--;)b[c]=ba(b[c]);return b.join("/")}function La(b,c){var d=wb(b);c.$$protocol=d.protocol;c.$$host=d.hostname;c.$$port=m(d.port)||Mf[d.protocol]||null}function vc(b,c){var d="/"!==b.charAt(0);
d&&(b="/"+b);var e=wb(b);c.$$path=decodeURIComponent(d&&"/"===e.pathname.charAt(0)?e.pathname.substring(1):e.pathname);c.$$search=aa(e.search);c.$$hash=decodeURIComponent(e.hash);c.$$path&&"/"!=c.$$path.charAt(0)&&(c.$$path="/"+c.$$path)}function ib(b,c){if(0===c.indexOf(b))return c.substr(b.length)}function $a(b){var c=b.indexOf("#");return-1==c?b:b.substr(0,c)}function Jb(b){return b.replace(/(#.+)|#$/,"$1")}function Ac(b,c,d){this.$$html5=!0;d=d||"";La(b,this);this.$$parse=function(b){var d=ib(c,
b);if(!u(d))throw bd("ipthprfx",b,c);vc(d,this);this.$$path||(this.$$path="/");this.$$compose()};this.$$compose=function(){var b=Y(this.$$search),d=this.$$hash?"#"+ba(this.$$hash):"";this.$$url=la(this.$$path)+(b?"?"+b:"")+d;this.$$absUrl=c+this.$$url.substr(1)};this.$$parseLinkUrl=function(e,f){if(f&&"#"===f[0])return this.hash(f.slice(1)),!0;var g,h;r(g=ib(b,e))?(h=g,h=r(g=ib(d,g))?c+(ib("/",g)||g):b+h):r(g=ib(c,e))?h=c+g:c==e+"/"&&(h=c);h&&this.$$parse(h);return!!h}}function Bc(b,c,d){La(b,this);
this.$$parse=function(e){var f=ib(b,e)||ib(c,e),g;s(f)||"#"!==f.charAt(0)?this.$$html5?g=f:(g="",s(f)&&(b=e,this.replace())):(g=ib(d,f),s(g)&&(g=f));vc(g,this);var e=this.$$path,f=b,h=/^\/[A-Z]:(\/.*)/;0===g.indexOf(f)&&(g=g.replace(f,""));h.exec(g)||(e=(g=h.exec(e))?g[1]:e);this.$$path=e;this.$$compose()};this.$$compose=function(){var c=Y(this.$$search),e=this.$$hash?"#"+ba(this.$$hash):"";this.$$url=la(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+(this.$$url?d+this.$$url:"")};this.$$parseLinkUrl=
function(c){return $a(b)==$a(c)?(this.$$parse(c),!0):!1}}function Rc(b,c,d){this.$$html5=!0;Bc.apply(this,arguments);this.$$parseLinkUrl=function(e,f){if(f&&"#"===f[0])return this.hash(f.slice(1)),!0;var g,h;b==$a(e)?g=e:(h=ib(c,e))?g=b+d+h:c===e+"/"&&(g=c);g&&this.$$parse(g);return!!g};this.$$compose=function(){var c=Y(this.$$search),e=this.$$hash?"#"+ba(this.$$hash):"";this.$$url=la(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+d+this.$$url}}function Bb(b){return function(){return this[b]}}function Cc(b,
c){return function(d){if(s(d))return this[b];this[b]=c(d);this.$$compose();return this}}function Cb(){var b="",c={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(c){return r(c)?(b=c,this):b};this.html5Mode=function(b){return K(b)?(c.enabled=b,this):o(b)?(K(b.enabled)&&(c.enabled=b.enabled),K(b.requireBase)&&(c.requireBase=b.requireBase),K(b.rewriteLinks)&&(c.rewriteLinks=b.rewriteLinks),this):c};this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(d,
e,f,g,h){function j(b,c,d){var f=l.url(),g=l.$$state;try{e.url(b,c,d),l.$$state=e.state()}catch(h){throw l.url(f),l.$$state=g,h;}}function k(b,c){d.$broadcast("$locationChangeSuccess",l.absUrl(),b,l.$$state,c)}var l,m;m=e.baseHref();var n=e.url(),u;if(c.enabled){if(!m&&c.requireBase)throw bd("nobase");u=n.substring(0,n.indexOf("/",n.indexOf("//")+2))+(m||"/");m=f.history?Ac:Rc}else u=$a(n),m=Bc;var p=u.substr(0,$a(u).lastIndexOf("/")+1);l=new m(u,p,"#"+b);l.$$parseLinkUrl(n,n);l.$$state=e.state();
var t=/^\s*(javascript|mailto):/i;g.on("click",function(b){if(c.rewriteLinks&&!b.ctrlKey&&!b.metaKey&&!b.shiftKey&&2!=b.which&&2!=b.button){for(var f=ca(b.target);"a"!==D(f[0]);)if(f[0]===g[0]||!(f=f.parent())[0])return;var j=f.prop("href"),k=f.attr("href")||f.attr("xlink:href");o(j)&&"[object SVGAnimatedString]"===j.toString()&&(j=wb(j.animVal).href);t.test(j)||!j||f.attr("target")||b.isDefaultPrevented()||!l.$$parseLinkUrl(j,k)||(b.preventDefault(),l.absUrl()!=e.url()&&(d.$apply(),h.angular["ff-684208-preventDefault"]=
!0))}});Jb(l.absUrl())!=Jb(n)&&e.url(l.absUrl(),!0);var q=!0;e.onUrlChange(function(b,c){s(ib(p,b))?h.location.href=b:(d.$evalAsync(function(){var e=l.absUrl(),f=l.$$state,g;b=Jb(b);l.$$parse(b);l.$$state=c;g=d.$broadcast("$locationChangeStart",b,e,c,f).defaultPrevented;l.absUrl()===b&&(g?(l.$$parse(e),l.$$state=f,j(e,!1,f)):(q=!1,k(e,f)))}),d.$$phase||d.$digest())});d.$watch(function(){var b=Jb(e.url()),c=Jb(l.absUrl()),g=e.state(),h=l.$$replace,o=b!==c||l.$$html5&&f.history&&g!==l.$$state;if(q||
o)q=!1,d.$evalAsync(function(){var c=l.absUrl(),e=d.$broadcast("$locationChangeStart",c,b,l.$$state,g).defaultPrevented;l.absUrl()===c&&(e?(l.$$parse(b),l.$$state=g):(o&&j(c,h,g===l.$$state?null:l.$$state),k(b,g)))});l.$$replace=!1});return l}]}function Dc(){var b=!0,c=this;this.debugEnabled=function(c){return r(c)?(b=c,this):b};this.$get=["$window",function(d){function f(b){b instanceof Error&&(b.stack?b=b.message&&-1===b.stack.indexOf(b.message)?"Error: "+b.message+"\n"+b.stack:b.stack:b.sourceURL&&
(b=b.message+"\n"+b.sourceURL+":"+b.line));return b}function g(b){var c=d.console||{},h=c[b]||c.log||n,b=!1;try{b=!!h.apply}catch(j){}return b?function(){var b=[];e(arguments,function(c){b.push(f(c))});return h.apply(c,b)}:function(b,c){h(b,null==c?"":c)}}return{log:g("log"),info:g("info"),warn:g("warn"),error:g("error"),debug:function(){var d=g("debug");return function(){b&&d.apply(c,arguments)}}()}}]}function eb(b,c){if("__defineGetter__"===b||"__defineSetter__"===b||"__lookupGetter__"===b||"__lookupSetter__"===
b||"__proto__"===b)throw fb("isecfld",c);return b}function Db(b){return b+""}function Wa(b,c){if(b){if(b.constructor===b)throw fb("isecfn",c);if(b.window===b)throw fb("isecwindow",c);if(b.children&&(b.nodeName||b.prop&&b.attr&&b.find))throw fb("isecdom",c);if(b===Object)throw fb("isecobj",c);}return b}function Sc(b,c){if(b){if(b.constructor===b)throw fb("isecfn",c);if(b===Nf||b===Of||b===Pf)throw fb("isecff",c);}}function Wb(b,c){if(b&&(b===(0).constructor||b===(!1).constructor||b==="".constructor||
b==={}.constructor||b===[].constructor||b===Function.constructor))throw fb("isecaf",c);}function od(b,c){return"undefined"!==typeof b?b:c}function oc(b,c){return"undefined"===typeof b?c:"undefined"===typeof c?b:b+c}function Ba(b,c){var d,f;switch(b.type){case S.Program:d=!0;e(b.body,function(b){Ba(b.expression,c);d=d&&b.expression.constant});b.constant=d;break;case S.Literal:b.constant=!0;b.toWatch=[];break;case S.UnaryExpression:Ba(b.argument,c);b.constant=b.argument.constant;b.toWatch=b.argument.toWatch;
break;case S.BinaryExpression:Ba(b.left,c);Ba(b.right,c);b.constant=b.left.constant&&b.right.constant;b.toWatch=b.left.toWatch.concat(b.right.toWatch);break;case S.LogicalExpression:Ba(b.left,c);Ba(b.right,c);b.constant=b.left.constant&&b.right.constant;b.toWatch=b.constant?[]:[b];break;case S.ConditionalExpression:Ba(b.test,c);Ba(b.alternate,c);Ba(b.consequent,c);b.constant=b.test.constant&&b.alternate.constant&&b.consequent.constant;b.toWatch=b.constant?[]:[b];break;case S.Identifier:b.constant=
!1;b.toWatch=[b];break;case S.MemberExpression:Ba(b.object,c);b.computed&&Ba(b.property,c);b.constant=b.object.constant&&(!b.computed||b.property.constant);b.toWatch=[b];break;case S.CallExpression:d=b.filter?!c(b.callee.name).$stateful:!1;f=[];e(b.arguments,function(b){Ba(b,c);d=d&&b.constant;b.constant||f.push.apply(f,b.toWatch)});b.constant=d;b.toWatch=b.filter&&!c(b.callee.name).$stateful?f:[b];break;case S.AssignmentExpression:Ba(b.left,c);Ba(b.right,c);b.constant=b.left.constant&&b.right.constant;
b.toWatch=[b];break;case S.ArrayExpression:d=!0;f=[];e(b.elements,function(b){Ba(b,c);d=d&&b.constant;b.constant||f.push.apply(f,b.toWatch)});b.constant=d;b.toWatch=f;break;case S.ObjectExpression:d=!0;f=[];e(b.properties,function(b){Ba(b.value,c);d=d&&b.value.constant;b.value.constant||f.push.apply(f,b.value.toWatch)});b.constant=d;b.toWatch=f;break;case S.ThisExpression:b.constant=!1;b.toWatch=[];break;case S.LocalsExpression:b.constant=!1,b.toWatch=[]}}function Tc(b){if(1==b.length){var b=b[0].expression,
c=b.toWatch;return 1!==c.length?c:c[0]!==b?c:void 0}}function Uc(b){if(1===b.body.length&&(b.body[0].expression.type===S.Identifier||b.body[0].expression.type===S.MemberExpression))return{type:S.AssignmentExpression,left:b.body[0].expression,right:{type:S.NGValueParameter},operator:"="}}function Ec(b){return 0===b.body.length||1===b.body.length&&(b.body[0].expression.type===S.Literal||b.body[0].expression.type===S.ArrayExpression||b.body[0].expression.type===S.ObjectExpression)}function Vc(b,c){this.astBuilder=
b;this.$filter=c}function Wc(b,c){this.astBuilder=b;this.$filter=c}function Fc(b){return A(b.valueOf)?b.valueOf():Qf.call(b)}function Xc(){var b=W(),c=W(),d={"true":!0,"false":!1,"null":null,undefined:void 0},f,g;this.addLiteral=function(b,c){d[b]=c};this.setIdentifierFns=function(b,c){f=b;g=c;return this};this.$get=["$filter",function(h){function j(d,e,f){var g,l,t,f=f||w;switch(typeof d){case "string":t=d=d.trim();var r=f?c:b;g=r[t];if(!g){":"===d.charAt(0)&&":"===d.charAt(1)&&(l=!0,d=d.substring(2));
g=f?L:q;var B=new xd(g);g=(new yd(B,h,g)).parse(d);g.constant?g.$$watchDelegate=u:l?g.$$watchDelegate=g.literal?s:m:g.inputs&&(g.$$watchDelegate=o);f&&(g=k(g));r[t]=g}return p(g,e);case "function":return p(d,e);default:return p(n,e)}}function k(b){function c(d,e,f,g){var h=w;w=!0;try{return b(d,e,f,g)}finally{w=h}}if(!b)return b;c.$$watchDelegate=b.$$watchDelegate;c.assign=k(b.assign);c.constant=b.constant;c.literal=b.literal;for(var d=0;b.inputs&&d<b.inputs.length;++d)b.inputs[d]=k(b.inputs[d]);
c.inputs=b.inputs;return c}function l(b,c){return null==b||null==c?b===c:"object"===typeof b&&(b=Fc(b),"object"===typeof b)?!1:b===c||b!==b&&c!==c}function o(b,c,d,e,f){var g=e.inputs,h;if(1===g.length){var j=l,g=g[0];return b.$watch(function(b){var c=g(b);l(c,j)||(h=e(b,void 0,void 0,[c]),j=c&&Fc(c));return h},c,d,f)}for(var k=[],m=[],n=0,s=g.length;n<s;n++)k[n]=l,m[n]=null;return b.$watch(function(b){for(var c=!1,d=0,f=g.length;d<f;d++){var j=g[d](b);if(c||(c=!l(j,k[d])))m[d]=j,k[d]=j&&Fc(j)}c&&
(h=e(b,void 0,void 0,m));return h},c,d,f)}function m(b,c,d,e){var f,g;return f=b.$watch(function(b){return e(b)},function(b,d,e){g=b;A(c)&&c.apply(this,arguments);r(b)&&e.$$postDigest(function(){r(g)&&f()})},d)}function s(b,c,d,f){function g(b){var c=!0;e(b,function(b){r(b)||(c=!1)});return c}var h,j;return h=b.$watch(function(b){return f(b)},function(b,d,e){j=b;A(c)&&c.call(this,b,d,e);g(b)&&e.$$postDigest(function(){g(j)&&h()})},d)}function u(b,c,d,e){var f;return f=b.$watch(function(b){f();return e(b)},
c,d)}function p(b,c){if(!c)return b;var d=b.$$watchDelegate,e=!1,d=d!==s&&d!==m?function(d,f,g,h){g=e&&h?h[0]:b(d,f,g,h);return c(g,d,f)}:function(d,e,f,g){f=b(d,e,f,g);d=c(f,d,e);return r(f)?d:f};b.$$watchDelegate&&b.$$watchDelegate!==o?d.$$watchDelegate=b.$$watchDelegate:c.$stateful||(d.$$watchDelegate=o,e=!b.inputs,d.inputs=b.inputs?b.inputs:[b]);return d}var t=fc().noUnsafeEval,q={csp:t,expensiveChecks:!1,literals:I(d),isIdentifierStart:A(f)&&f,isIdentifierContinue:A(g)&&g},L={csp:t,expensiveChecks:!0,
literals:I(d),isIdentifierStart:A(f)&&f,isIdentifierContinue:A(g)&&g},w=!1;j.$$runningExpensiveChecks=function(){return w};return j}]}function Yc(){this.$get=["$rootScope","$exceptionHandler",function(b,c){return Gc(function(c){b.$evalAsync(c)},c)}]}function wc(){this.$get=["$browser","$exceptionHandler",function(b,c){return Gc(function(c){b.defer(c)},c)}]}function Gc(b,d){function f(){this.$$state={status:0}}function g(b,c){return function(d){c.call(b,d)}}function h(c){!c.processScheduled&&c.pending&&
(c.processScheduled=!0,b(function(){var b,e,f;f=c.pending;c.processScheduled=!1;c.pending=void 0;for(var g=0,h=f.length;g<h;++g){e=f[g][0];b=f[g][c.status];try{A(b)?e.resolve(b(c.value)):1===c.status?e.resolve(c.value):e.reject(c.value)}catch(j){e.reject(j),d(j)}}}))}function j(){this.promise=new f}var l=c("$q",TypeError);k(f.prototype,{then:function(b,c,d){if(s(b)&&s(c)&&s(d))return this;var e=new j;this.$$state.pending=this.$$state.pending||[];this.$$state.pending.push([e,b,c,d]);0<this.$$state.status&&
h(this.$$state);return e.promise},"catch":function(b){return this.then(null,b)},"finally":function(b,c){return this.then(function(c){return n(c,!0,b)},function(c){return n(c,!1,b)},c)}});k(j.prototype,{resolve:function(b){this.promise.$$state.status||(b===this.promise?this.$$reject(l("qcycle",b)):this.$$resolve(b))},$$resolve:function(b){function c(b){k||(k=!0,j.$$resolve(b))}function e(b){k||(k=!0,j.$$reject(b))}var f,j=this,k=!1;try{if(o(b)||A(b))f=b&&b.then;A(f)?(this.promise.$$state.status=-1,
f.call(b,c,e,g(this,this.notify))):(this.promise.$$state.value=b,this.promise.$$state.status=1,h(this.promise.$$state))}catch(l){e(l),d(l)}},reject:function(b){this.promise.$$state.status||this.$$reject(b)},$$reject:function(b){this.promise.$$state.value=b;this.promise.$$state.status=2;h(this.promise.$$state)},notify:function(c){var e=this.promise.$$state.pending;0>=this.promise.$$state.status&&e&&e.length&&b(function(){for(var b,f,g=0,h=e.length;g<h;g++){f=e[g][0];b=e[g][3];try{f.notify(A(b)?b(c):
c)}catch(j){d(j)}}})}});var m=function(b,c){var d=new j;c?d.resolve(b):d.reject(b);return d.promise},n=function(b,c,d){var e=null;try{A(d)&&(e=d())}catch(f){return m(f,!1)}return e&&A(e.then)?e.then(function(){return m(b,c)},function(b){return m(b,!1)}):m(b,c)},u=function(b,c,d,e){var f=new j;f.resolve(b);return f.promise.then(c,d,e)},p=function(b){if(!A(b))throw l("norslvr",b);var c=new j;b(function(b){c.resolve(b)},function(b){c.reject(b)});return c.promise};p.prototype=f.prototype;p.defer=function(){var b=
new j;b.resolve=g(b,b.resolve);b.reject=g(b,b.reject);b.notify=g(b,b.notify);return b};p.reject=function(b){var c=new j;c.reject(b);return c.promise};p.when=u;p.resolve=u;p.all=function(b){var c=new j,d=0,f=ia(b)?[]:{};e(b,function(b,e){d++;u(b).then(function(b){f.hasOwnProperty(e)||(f[e]=b,--d||c.resolve(f))},function(b){f.hasOwnProperty(e)||c.reject(b)})});0===d&&c.resolve(f);return c.promise};return p}function Hc(){this.$get=["$window","$timeout",function(b,c){var d=b.requestAnimationFrame||b.webkitRequestAnimationFrame,
e=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.webkitCancelRequestAnimationFrame,f=!!d,g=f?function(b){var c=d(b);return function(){e(c)}}:function(b){var d=c(b,16.66,!1);return function(){c.cancel(d)}};g.supported=f;return g}]}function Xb(){function b(c){function d(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null;this.$$listeners={};this.$$listenerCount={};this.$$watchersCount=0;this.$id=++Pc;this.$$ChildScope=null}d.prototype=c;return d}var f=10,g=c("$rootScope"),
h=null,j=null;this.digestTtl=function(b){arguments.length&&(f=b);return f};this.$get=["$exceptionHandler","$parse","$browser",function(c,k,l){function m(b){b.currentScope.$$destroyed=!0}function u(b){9===Qb&&(b.$$childHead&&u(b.$$childHead),b.$$nextSibling&&u(b.$$nextSibling));b.$parent=b.$$nextSibling=b.$$prevSibling=b.$$childHead=b.$$childTail=b.$root=b.$$watchers=null}function p(){this.$id=++Pc;this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=
null;this.$root=this;this.$$destroyed=!1;this.$$listeners={};this.$$listenerCount={};this.$$watchersCount=0;this.$$isolateBindings=null}function t(b){if(D.$$phase)throw g("inprog",D.$$phase);D.$$phase=b}function q(b,c){do b.$$watchersCount+=c;while(b=b.$parent)}function r(b,c,d){do b.$$listenerCount[d]-=c,0===b.$$listenerCount[d]&&delete b.$$listenerCount[d];while(b=b.$parent)}function L(){}function w(){for(;v.length;)try{v.shift()()}catch(b){c(b)}j=null}function B(){null===j&&(j=l.defer(function(){D.$apply(w)}))}
p.prototype={constructor:p,$new:function(c,d){var e,d=d||this;c?(e=new p,e.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=b(this)),e=new this.$$ChildScope);e.$parent=d;e.$$prevSibling=d.$$childTail;d.$$childHead?(d.$$childTail.$$nextSibling=e,d.$$childTail=e):d.$$childHead=d.$$childTail=e;(c||d!=this)&&e.$on("$destroy",m);return e},$watch:function(b,c,d,e){var f=k(b);if(f.$$watchDelegate)return f.$$watchDelegate(this,c,d,f,b);var g=this,j=g.$$watchers,l={fn:c,last:L,get:f,exp:e||b,eq:!!d};
h=null;A(c)||(l.fn=n);j||(j=g.$$watchers=[]);j.unshift(l);q(this,1);return function(){0<=F(j,l)&&q(g,-1);h=null}},$watchGroup:function(b,c){function d(){k=!1;l?(l=!1,c(g,g,j)):c(g,f,j)}var f=Array(b.length),g=Array(b.length),h=[],j=this,k=!1,l=!0;if(!b.length){var o=!0;j.$evalAsync(function(){o&&c(g,g,j)});return function(){o=!1}}if(1===b.length)return this.$watch(b[0],function(b,d,e){g[0]=b;f[0]=d;c(g,b===d?g:f,e)});e(b,function(b,c){var e=j.$watch(b,function(b,e){g[c]=b;f[c]=e;k||(k=!0,j.$evalAsync(d))});
h.push(e)});return function(){for(;h.length;)h.shift()()}},$watchCollection:function(b,c){function e(b){g=b;var c,f,j,k;if(!s(g)){if(o(g))if(d(g)){h!==n&&(h=n,t=h.length=0,m++);b=g.length;t!==b&&(m++,h.length=t=b);for(c=0;c<b;c++)k=h[c],j=g[c],(f=k!==k&&j!==j)||k===j||(m++,h[c]=j)}else{h!==u&&(h=u={},t=0,m++);b=0;for(c in g)Gb.call(g,c)&&(b++,j=g[c],k=h[c],c in h?(f=k!==k&&j!==j,f||k===j||(m++,h[c]=j)):(t++,h[c]=j,m++));if(t>b)for(c in m++,h)Gb.call(g,c)||(t--,delete h[c])}else h!==g&&(h=g,m++);return m}}
e.$stateful=!0;var f=this,g,h,j,l=1<c.length,m=0,n=[],u={},p=!0,t=0;return this.$watch(k(b,e),function(){p?(p=!1,c(g,g,f)):c(g,j,f);if(l)if(o(g))if(d(g)){j=Array(g.length);for(var b=0;b<g.length;b++)j[b]=g[b]}else for(b in j={},g)Gb.call(g,b)&&(j[b]=g[b]);else j=g})},$digest:function(){var b,d,e,k,o,m,n,s,u=f,p,q=[],r,B;t("$digest");l.$$checkUrlChange();this===D&&null!==j&&(l.defer.cancel(j),w());h=null;do{s=!1;for(p=this;z.length;){try{B=z.shift(),B.scope.$eval(B.expression,B.locals)}catch(ha){c(ha)}h=
null}a:do{if(m=p.$$watchers)for(n=m.length;n--;)try{if(b=m[n])if(o=b.get,(d=o(p))!==(e=b.last)&&!(b.eq?N(d,e):"number"===typeof d&&"number"===typeof e&&isNaN(d)&&isNaN(e)))s=!0,h=b,b.last=b.eq?I(d,null):d,k=b.fn,k(d,e===L?d:e,p),5>u&&(r=4-u,q[r]||(q[r]=[]),q[r].push({msg:A(b.exp)?"fn: "+(b.exp.name||b.exp.toString()):b.exp,newVal:d,oldVal:e}));else if(b===h){s=!1;break a}}catch(v){c(v)}if(!(m=p.$$watchersCount&&p.$$childHead||p!==this&&p.$$nextSibling))for(;p!==this&&!(m=p.$$nextSibling);)p=p.$parent}while(p=
m);if((s||z.length)&&!u--)throw D.$$phase=null,g("infdig",f,q);}while(s||z.length);for(D.$$phase=null;O.length;)try{O.shift()()}catch(E){c(E)}},$destroy:function(){if(!this.$$destroyed){var b=this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;this===D&&l.$$applicationDestroyed();q(this,-this.$$watchersCount);for(var c in this.$$listenerCount)r(this,this.$$listenerCount[c],c);b&&b.$$childHead==this&&(b.$$childHead=this.$$nextSibling);b&&b.$$childTail==this&&(b.$$childTail=this.$$prevSibling);
this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling);this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling);this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=n;this.$on=this.$watch=this.$watchGroup=function(){return n};this.$$listeners={};this.$$nextSibling=null;u(this)}},$eval:function(b,c){return k(b)(this,c)},$evalAsync:function(b,c){D.$$phase||z.length||l.defer(function(){z.length&&D.$digest()});z.push({scope:this,expression:k(b),locals:c})},
$$postDigest:function(b){O.push(b)},$apply:function(b){try{t("$apply");try{return this.$eval(b)}finally{D.$$phase=null}}catch(d){c(d)}finally{try{D.$digest()}catch(e){throw c(e),e;}}},$applyAsync:function(b){function c(){d.$eval(b)}var d=this;b&&v.push(c);b=k(b);B()},$on:function(b,c){var d=this.$$listeners[b];d||(this.$$listeners[b]=d=[]);d.push(c);var e=this;do e.$$listenerCount[b]||(e.$$listenerCount[b]=0),e.$$listenerCount[b]++;while(e=e.$parent);var f=this;return function(){var e=d.indexOf(c);
-1!==e&&(d[e]=null,r(f,1,b))}},$emit:function(b,d){var e=[],f,g=this,h=!1,j={name:b,targetScope:g,stopPropagation:function(){h=!0},preventDefault:function(){j.defaultPrevented=!0},defaultPrevented:!1},k=[j].concat(lb.call(arguments,1)),l,o;do{f=g.$$listeners[b]||e;j.currentScope=g;l=0;for(o=f.length;l<o;l++)if(f[l])try{f[l].apply(null,k)}catch(m){c(m)}else f.splice(l,1),l--,o--;if(h)return j.currentScope=null,j;g=g.$parent}while(g);j.currentScope=null;return j},$broadcast:function(b,d){var e=this,
f=this,g={name:b,targetScope:this,preventDefault:function(){g.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[b])return g;for(var h=[g].concat(lb.call(arguments,1)),j,k;e=f;){g.currentScope=e;f=e.$$listeners[b]||[];j=0;for(k=f.length;j<k;j++)if(f[j])try{f[j].apply(null,h)}catch(l){c(l)}else f.splice(j,1),j--,k--;if(!(f=e.$$listenerCount[b]&&e.$$childHead||e!==this&&e.$$nextSibling))for(;e!==this&&!(f=e.$$nextSibling);)e=e.$parent}g.currentScope=null;return g}};var D=new p,z=D.$$asyncQueue=
[],O=D.$$postDigestQueue=[],v=D.$$applyAsyncQueue=[];return D}]}function pd(){var b=/^\s*(https?|ftp|mailto|tel|file):/,c=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(c){return r(c)?(b=c,this):b};this.imgSrcSanitizationWhitelist=function(b){return r(b)?(c=b,this):c};this.$get=function(){return function(d,e){var f=e?c:b,g;g=wb(d).href;return""===g||g.match(f)?d:"unsafe:"+g}}}function gd(b){if("self"===b)return b;if(u(b)){if(-1<b.indexOf("***"))throw Zb("iwcard",
b);b=Ld(b).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*");return RegExp("^"+b+"$")}if(C(b))return RegExp("^"+b.source+"$");throw Zb("imatcher");}function Ic(b){var c=[];r(b)&&e(b,function(b){c.push(gd(b))});return c}function qd(){this.SCE_CONTEXTS=Eb;var b=["self"],c=[];this.resourceUrlWhitelist=function(c){arguments.length&&(b=Ic(c));return b};this.resourceUrlBlacklist=function(b){arguments.length&&(c=Ic(b));return c};this.$get=["$injector",function(d){function e(b){var c=function(b){this.$$unwrapTrustedValue=
function(){return b}};b&&(c.prototype=new b);c.prototype.valueOf=function(){return this.$$unwrapTrustedValue()};c.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()};return c}var f=function(){throw Zb("unsafe");};d.has("$sanitize")&&(f=d.get("$sanitize"));var g=e(),h={};h[Eb.HTML]=e(g);h[Eb.CSS]=e(g);h[Eb.URL]=e(g);h[Eb.JS]=e(g);h[Eb.RESOURCE_URL]=e(h[Eb.URL]);return{trustAs:function(b,c){var d=h.hasOwnProperty(b)?h[b]:null;if(!d)throw Zb("icontext",b,c);if(null===c||s(c)||
""===c)return c;if("string"!==typeof c)throw Zb("itype",b);return new d(c)},getTrusted:function(d,e){if(null===e||s(e)||""===e)return e;var g=h.hasOwnProperty(d)?h[d]:null;if(g&&e instanceof g)return e.$$unwrapTrustedValue();if(d===Eb.RESOURCE_URL){var g=wb(e.toString()),j,k,l=!1;j=0;for(k=b.length;j<k;j++)if("self"===b[j]?rc(g):b[j].exec(g.href)){l=!0;break}if(l){j=0;for(k=c.length;j<k;j++)if("self"===c[j]?rc(g):c[j].exec(g.href)){l=!1;break}}if(l)return e;throw Zb("insecurl",e.toString());}if(d===
Eb.HTML)return f(e);throw Zb("unsafe");},valueOf:function(b){return b instanceof g?b.$$unwrapTrustedValue():b}}}]}function rd(){var b=!0;this.enabled=function(c){arguments.length&&(b=!!c);return b};this.$get=["$parse","$sceDelegate",function(c,d){if(b&&8>Qb)throw Zb("iequirks");var f=J(Eb);f.isEnabled=function(){return b};f.trustAs=d.trustAs;f.getTrusted=d.getTrusted;f.valueOf=d.valueOf;b||(f.trustAs=f.getTrusted=function(b,c){return c},f.valueOf=q);f.parseAs=function(b,d){var e=c(d);return e.literal&&
e.constant?e:c(d,function(c){return f.getTrusted(b,c)})};var g=f.parseAs,h=f.getTrusted,j=f.trustAs;e(Eb,function(b,c){var d=wa(c);f[v("parse_as_"+d)]=function(c){return g(b,c)};f[v("get_trusted_"+d)]=function(c){return h(b,c)};f[v("trust_as_"+d)]=function(c){return j(b,c)}});return f}]}function sd(){this.$get=["$window","$document",function(b,c){var d={},e=!(b.chrome&&b.chrome.app&&b.chrome.app.runtime)&&b.history&&b.history.pushState,f=m((/android (\d+)/.exec(wa((b.navigator||{}).userAgent))||[])[1]),
g=/Boxee/i.test((b.navigator||{}).userAgent),h=c[0]||{},j,k=/^(Moz|webkit|ms)(?=[A-Z])/,l=h.body&&h.body.style,o=!1,n=!1;if(l){for(var p in l)if(o=k.exec(p)){j=o[0];j=j.substr(0,1).toUpperCase()+j.substr(1);break}j||(j="WebkitOpacity"in l&&"webkit");o=!!("transition"in l||j+"Transition"in l);n=!!("animation"in l||j+"Animation"in l);!f||o&&n||(o=u(l.webkitTransition),n=u(l.webkitAnimation))}return{history:!(!e||4>f||g),hasEvent:function(b){if("input"===b&&11>=Qb)return!1;if(s(d[b])){var c=h.createElement("div");
d[b]="on"+b in c}return d[b]},csp:fc(),vendorPrefix:j,transitions:o,animations:n,android:f}}]}function pc(){var b;this.httpOptions=function(c){return c?(b=c,this):b};this.$get=["$templateCache","$http","$q","$sce",function(c,d,e,f){function g(h,j){g.totalPendingRequests++;u(h)&&c.get(h)||(h=f.getTrustedResourceUrl(h));var l=d.defaults&&d.defaults.transformResponse;ia(l)?l=l.filter(function(b){return b!==Za}):l===Za&&(l=null);return d.get(h,k({cache:c,transformResponse:l},b))["finally"](function(){g.totalPendingRequests--}).then(function(b){c.put(h,
b.data);return b.data},function(b){if(!j)throw Rf("tpload",h,b.status,b.statusText);return e.reject(b)})}g.totalPendingRequests=0;return g}]}function qc(){this.$get=["$rootScope","$browser","$location",function(b,c,d){return{findBindings:function(b,c,d){var b=b.getElementsByClassName("ng-binding"),f=[];e(b,function(b){var g=mb.element(b).data("$binding");g&&e(g,function(e){d?RegExp("(^|\\s)"+Ld(c)+"(\\s|\\||$)").test(e)&&f.push(b):-1!=e.indexOf(c)&&f.push(b)})});return f},findModels:function(b,c,
d){for(var e=["ng-","data-ng-","ng\\:"],f=0;f<e.length;++f){var g=b.querySelectorAll("["+e[f]+"model"+(d?"=":"*=")+'"'+c+'"]');if(g.length)return g}},getLocation:function(){return d.url()},setLocation:function(c){c!==d.url()&&(d.url(c),b.$digest())},whenStable:function(b){c.notifyWhenNoOutstandingRequests(b)}}}]}function Zc(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(b,c,d,e,f){function g(j,k,l){A(j)||(l=k,k=j,j=n);var o=lb.call(arguments,3),m=r(l)&&!l,s=(m?e:d).defer(),
u=s.promise,p;p=c.defer(function(){try{s.resolve(j.apply(null,o))}catch(c){s.reject(c),f(c)}finally{delete h[u.$$timeoutId]}m||b.$apply()},k);u.$$timeoutId=p;h[p]=s;return u}var h={};g.cancel=function(b){return b&&b.$$timeoutId in h?(h[b.$$timeoutId].reject("canceled"),delete h[b.$$timeoutId],c.defer.cancel(b.$$timeoutId)):!1};return g}]}function wb(b){Qb&&(Ua.setAttribute("href",b),b=Ua.href);Ua.setAttribute("href",b);return{href:Ua.href,protocol:Ua.protocol?Ua.protocol.replace(/:$/,""):"",host:Ua.host,
search:Ua.search?Ua.search.replace(/^\?/,""):"",hash:Ua.hash?Ua.hash.replace(/^#/,""):"",hostname:Ua.hostname,port:Ua.port,pathname:"/"===Ua.pathname.charAt(0)?Ua.pathname:"/"+Ua.pathname}}function rc(b){b=u(b)?wb(b):b;return b.protocol===de.protocol&&b.host===de.host}function td(){this.$get=p(b)}function $c(b){function c(b){try{return decodeURIComponent(b)}catch(d){return b}}var d=b[0]||{},e={},f="";return function(){var b,g,h,j,k;b=d.cookie||"";if(b!==f){f=b;b=f.split("; ");e={};for(h=0;h<b.length;h++)g=
b[h],j=g.indexOf("="),0<j&&(k=c(g.substring(0,j)),s(e[k])&&(e[k]=c(g.substring(j+1))))}return e}}function pe(){this.$get=$c}function Bd(b){function c(d,f){if(o(d)){var g={};e(d,function(b,d){g[d]=c(d,b)});return g}return b.factory(d+"Filter",f)}this.register=c;this.$get=["$injector",function(b){return function(c){return b.get(c+"Filter")}}];c("currency",Cd);c("date",Od);c("filter",qe);c("json",Je);c("limitTo",Le);c("lowercase",Sf);c("number",Dd);c("orderBy",Md);c("uppercase",Tf)}function qe(){return function(b,
e,f){if(!d(b)){if(null==b)return b;throw c("filter")("notarray",b);}var g;switch(fd(e)){case "function":break;case "boolean":case "null":case "number":case "string":g=!0;case "object":e=re(e,f,g);break;default:return b}return Array.prototype.filter.call(b,e)}}function re(b,c,d){var e=o(b)&&"$"in b;!0===c?c=N:A(c)||(c=function(b,c){if(s(b))return!1;if(null===b||null===c)return b===c;if(o(c)||o(b)&&!(A(b.toString)&&b.toString!==ab))return!1;b=wa(""+b);c=wa(""+c);return-1!==b.indexOf(c)});return function(f){return e&&
!o(f)?Lb(f,b.$,c,!1):Lb(f,b,c,d)}}function Lb(b,c,d,e,f){var g=fd(b),h=fd(c);if("string"===h&&"!"===c.charAt(0))return!Lb(b,c.substring(1),d,e);if(ia(b))return b.some(function(b){return Lb(b,c,d,e)});switch(g){case "object":var j;if(e){for(j in b)if("$"!==j.charAt(0)&&Lb(b[j],c,d,!0))return!0;return f?!1:Lb(b,c,d,!1)}if("object"===h){for(j in c)if(f=c[j],!A(f)&&!s(f)&&(g="$"===j,!Lb(g?b:b[j],f,d,g,g)))return!1;return!0}return d(b,c);case "function":return!1;default:return d(b,c)}}function fd(b){return null===
b?"null":typeof b}function Cd(b){var c=b.NUMBER_FORMATS;return function(b,d,e){s(d)&&(d=c.CURRENCY_SYM);s(e)&&(e=c.PATTERNS[1].maxFrac);return null==b?b:Ed(b,c.PATTERNS[1],c.GROUP_SEP,c.DECIMAL_SEP,e).replace(/\u00A4/g,d)}}function Dd(b){var c=b.NUMBER_FORMATS;return function(b,d){return null==b?b:Ed(b,c.PATTERNS[0],c.GROUP_SEP,c.DECIMAL_SEP,d)}}function se(b){var c=0,d,e,f,g,h;-1<(e=b.indexOf(ee))&&(b=b.replace(ee,""));0<(f=b.search(/e/i))?(0>e&&(e=f),e+=+b.slice(f+1),b=b.substring(0,f)):0>e&&(e=
b.length);for(f=0;b.charAt(f)==zd;f++);if(f==(h=b.length))d=[0],e=1;else{for(h--;b.charAt(h)==zd;)h--;e-=f;d=[];for(g=0;f<=h;f++,g++)d[g]=+b.charAt(f)}e>fe&&(d=d.splice(0,fe-1),c=e-1,e=1);return{d:d,e:c,i:e}}function te(b,c,d,e){var f=b.d,g=f.length-b.i,c=s(c)?Math.min(Math.max(d,g),e):+c,d=c+b.i,e=f[d];if(0<d){f.splice(Math.max(b.i,d));for(var h=d;h<f.length;h++)f[h]=0}else{g=Math.max(0,g);b.i=1;f.length=Math.max(1,d=c+1);f[0]=0;for(h=1;h<d;h++)f[h]=0}if(5<=e)if(0>d-1){for(e=0;e>d;e--)f.unshift(0),
b.i++;f.unshift(1);b.i++}else f[d-1]++;for(;g<Math.max(0,c);g++)f.push(0);if(c=f.reduceRight(function(b,c,d,e){c+=b;e[d]=c%10;return Math.floor(c/10)},0))f.unshift(c),b.i++}function Ed(b,c,d,e,f){if(!u(b)&&!w(b)||isNaN(b))return"";var g=!isFinite(b),h=!1,j=Math.abs(b)+"",k="";if(g)k="\u221e";else{h=se(j);te(h,f,c.minFrac,c.maxFrac);k=h.d;j=h.i;f=h.e;g=[];for(h=k.reduce(function(b,c){return b&&!c},!0);0>j;)k.unshift(0),j++;0<j?g=k.splice(j):(g=k,k=[0]);j=[];for(k.length>=c.lgSize&&j.unshift(k.splice(-c.lgSize).join(""));k.length>
c.gSize;)j.unshift(k.splice(-c.gSize).join(""));k.length&&j.unshift(k.join(""));k=j.join(d);g.length&&(k+=e+g.join(""));f&&(k+="e+"+f)}return 0>b&&!h?c.negPre+k+c.negSuf:c.posPre+k+c.posSuf}function jc(b,c,d,e){var f="";if(0>b||e&&0>=b)e?b=-b+1:(b=-b,f="-");for(b=""+b;b.length<c;)b=zd+b;d&&(b=b.substr(b.length-c));return f+b}function Oa(b,c,d,e,f){d=d||0;return function(g){g=g["get"+b]();if(0<d||g>-d)g+=d;0===g&&-12==d&&(g=12);return jc(g,c,e,f)}}function uc(b,c,d){return function(e,f){var g=e["get"+
b](),h=Oc((d?"STANDALONE":"")+(c?"SHORT":"")+b);return f[h][g]}}function Fd(b){var c=(new Date(b,0,1)).getDay();return new Date(b,0,(4>=c?5:12)-c)}function Gd(b){return function(c){var d=Fd(c.getFullYear()),c=+new Date(c.getFullYear(),c.getMonth(),c.getDate()+(4-c.getDay()))-+d,c=1+Math.round(c/6048E5);return jc(c,b)}}function kd(b,c){return 0>=b.getFullYear()?c.ERAS[0]:c.ERAS[1]}function Od(b){function c(b){var e;if(e=b.match(d)){var b=new Date(0),f=0,g=0,h=e[8]?b.setUTCFullYear:b.setFullYear,j=
e[8]?b.setUTCHours:b.setHours;e[9]&&(f=m(e[9]+e[10]),g=m(e[9]+e[11]));h.call(b,m(e[1]),m(e[2])-1,m(e[3]));f=m(e[4]||0)-f;g=m(e[5]||0)-g;h=m(e[6]||0);e=Math.round(1E3*parseFloat("0."+(e[7]||0)));j.call(b,f,g,h,e)}return b}var d=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(d,f,g){var h="",j=[],k,l,f=f||"mediumDate",f=b.DATETIME_FORMATS[f]||f;u(d)&&(d=Uf.test(d)?m(d):c(d));w(d)&&(d=new Date(d));if(!z(d)||!isFinite(d.getTime()))return d;
for(;f;)(l=Vf.exec(f))?(j=j.concat(lb.call(l,1)),f=j.pop()):(j.push(f),f=null);var o=d.getTimezoneOffset();g&&(o=Z(g,o),d=O(d,g,!0));e(j,function(c){k=Wf[c];h+=k?k(d,b.DATETIME_FORMATS,o):"''"===c?"'":c.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return h}}function Je(){return function(b,c){s(c)&&(c=2);return B(b,c)}}function Le(){return function(b,c,d){c=Infinity===Math.abs(Number(c))?Number(c):m(c);if(isNaN(c))return b;w(b)&&(b=b.toString());if(!ia(b)&&!u(b))return b;d=!d||isNaN(d)?0:m(d);d=0>d?
Math.max(0,b.length+d):d;return 0<=c?b.slice(d,d+c):0===d?b.slice(c,b.length):b.slice(Math.max(0,d+c),d)}}function Md(b){function e(c,d){d=d?-1:1;return c.map(function(c){var e=1,f=q;if(A(c))f=c;else if(u(c)){if("+"==c.charAt(0)||"-"==c.charAt(0))e="-"==c.charAt(0)?-1:1,c=c.substring(1);if(""!==c&&(f=b(c),f.constant))var g=f(),f=function(b){return b[g]}}return{get:f,descending:e*d}})}function f(b){switch(typeof b){case "number":case "boolean":case "string":return!0;default:return!1}}return function(b,
g,h){if(null==b)return b;if(!d(b))throw c("orderBy")("notarray",b);ia(g)||(g=[g]);0===g.length&&(g=["+"]);var j=e(g,h);j.push({get:function(){return{}},descending:h?-1:1});b=Array.prototype.map.call(b,function(b,c){return{value:b,predicateValues:j.map(function(d){var e=d.get(b),d=typeof e;if(null===e)d="string",e="null";else if("string"===d)e=e.toLowerCase();else if("object"===d&&!("function"===typeof e.valueOf&&(e=e.valueOf(),f(e))))if(!(A(e.toString)&&e.toString!==ab)||!(e=e.toString(),f(e)))e=
c;return{value:e,type:d}})}});b.sort(function(b,c){for(var d=0,e=0,f=j.length;e<f;++e){var d=b.predicateValues[e],g=c.predicateValues[e],h=0;d.type===g.type?d.value!==g.value&&(h=d.value<g.value?-1:1):h=d.type<g.type?-1:1;if(d=h*j[e].descending)break}return d});return b=b.map(function(b){return b.value})}}function ec(b){A(b)&&(b={link:b});b.restrict=b.restrict||"AC";return p(b)}function Rd(b,c,d,f,g){var h=this,j=[];h.$error={};h.$$success={};h.$pending=void 0;h.$name=g(c.name||c.ngForm||"")(d);h.$dirty=
!1;h.$pristine=!0;h.$valid=!0;h.$invalid=!1;h.$submitted=!1;h.$$parentForm=cd;h.$rollbackViewValue=function(){e(j,function(b){b.$rollbackViewValue()})};h.$commitViewValue=function(){e(j,function(b){b.$commitViewValue()})};h.$addControl=function(b){sa(b.$name,"input");j.push(b);b.$name&&(h[b.$name]=b);b.$$parentForm=h};h.$$renameControl=function(b,c){var d=b.$name;h[d]===b&&delete h[d];h[c]=b;b.$name=c};h.$removeControl=function(b){b.$name&&h[b.$name]===b&&delete h[b.$name];e(h.$pending,function(c,
d){h.$setValidity(d,null,b)});e(h.$error,function(c,d){h.$setValidity(d,null,b)});e(h.$$success,function(c,d){h.$setValidity(d,null,b)});F(j,b);b.$$parentForm=cd};Kd({ctrl:this,$element:b,set:function(b,c,d){var e=b[c];e?-1===e.indexOf(d)&&e.push(d):b[c]=[d]},unset:function(b,c,d){var e=b[c];e&&(F(e,d),0===e.length&&delete b[c])},$animate:f});h.$setDirty=function(){f.removeClass(b,tc);f.addClass(b,dd);h.$dirty=!0;h.$pristine=!1;h.$$parentForm.$setDirty()};h.$setPristine=function(){f.setClass(b,tc,
dd+" ng-submitted");h.$dirty=!1;h.$pristine=!0;h.$submitted=!1;e(j,function(b){b.$setPristine()})};h.$setUntouched=function(){e(j,function(b){b.$setUntouched()})};h.$setSubmitted=function(){f.addClass(b,"ng-submitted");h.$submitted=!0;h.$$parentForm.$setSubmitted()}}function md(b){b.$formatters.push(function(c){return b.$isEmpty(c)?c:c.toString()})}function xc(b,c,d,e,f,g){var h=wa(c[0].type);if(!f.android){var j=!1;c.on("compositionstart",function(){j=!0});c.on("compositionend",function(){j=!1;l()})}var k,
l=function(b){k&&(g.defer.cancel(k),k=null);if(!j){var f=c.val(),b=b&&b.type;"password"===h||d.ngTrim&&"false"===d.ngTrim||(f=ya(f));(e.$viewValue!==f||""===f&&e.$$hasNativeValidators)&&e.$setViewValue(f,b)}};if(f.hasEvent("input"))c.on("input",l);else{var o=function(b,c,d){k||(k=g.defer(function(){k=null;c&&c.value===d||l(b)}))};c.on("keydown",function(b){var c=b.keyCode;91===c||15<c&&19>c||37<=c&&40>=c||o(b,this,this.value)});if(f.hasEvent("paste"))c.on("paste cut",o)}c.on("change",l);if(ge[h]&&
e.$$hasNativeValidators&&h===d.type)c.on("keydown wheel mousedown",function(b){if(!k){var c=this.validity,d=c.badInput,e=c.typeMismatch;k=g.defer(function(){k=null;c.badInput===d&&c.typeMismatch===e||l(b)})}});e.$render=function(){var b=e.$isEmpty(e.$viewValue)?"":e.$viewValue;c.val()!==b&&c.val(b)}}function Nc(b,c){return function(d,f){var g,h;if(z(d))return d;if(u(d)){'"'==d.charAt(0)&&'"'==d.charAt(d.length-1)&&(d=d.substring(1,d.length-1));if(Xf.test(d))return new Date(d);b.lastIndex=0;if(g=b.exec(d))return g.shift(),
h=f?{yyyy:f.getFullYear(),MM:f.getMonth()+1,dd:f.getDate(),HH:f.getHours(),mm:f.getMinutes(),ss:f.getSeconds(),sss:f.getMilliseconds()/1E3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},e(g,function(b,d){d<c.length&&(h[c[d]]=+b)}),new Date(h.yyyy,h.MM-1,h.dd,h.HH,h.mm,h.ss||0,1E3*h.sss||0)}return NaN}}function zc(b,c,d,e){return function(f,g,h,j,k,l,o){function m(b){return b&&!(b.getTime&&b.getTime()!==b.getTime())}Pd(f,g,h,j);xc(f,g,h,j,k,l);var n=j&&j.$options&&j.$options.timezone,u;j.$$parserName=
b;j.$parsers.push(function(b){if(j.$isEmpty(b))return null;if(c.test(b))return b=d(b,u),n&&(b=O(b,n)),b});j.$formatters.push(function(b){if(b&&!z(b))throw Jc("datefmt",b);if(m(b))return(u=b)&&n&&(u=O(u,n,!0)),o("date")(b,e,n);u=null;return""});if(r(h.min)||h.ngMin){var p;j.$validators.min=function(b){return!m(b)||s(p)||d(b)>=p};h.$observe("min",function(b){p=r(b)&&!z(b)?d(b)||void 0:b;j.$validate()})}if(r(h.max)||h.ngMax){var t;j.$validators.max=function(b){return!m(b)||s(t)||d(b)<=t};h.$observe("max",
function(b){t=r(b)&&!z(b)?d(b)||void 0:b;j.$validate()})}}}function Pd(b,c,d,e){(e.$$hasNativeValidators=o(c[0].validity))&&e.$parsers.push(function(b){var d=c.prop("validity")||{};return d.badInput||d.typeMismatch?void 0:b})}function Sd(b,c,d,e,f){if(r(e)){b=b(e);if(!b.constant)throw Jc("constexpr",d,e);return b(c)}return f}function nd(b,c){b="ngClass"+b;return["$animate",function(d){function f(b,c){var d=[],e=0;a:for(;e<b.length;e++){for(var g=b[e],h=0;h<c.length;h++)if(g==c[h])continue a;d.push(g)}return d}
function g(b){var c=[];return ia(b)?(e(b,function(b){c=c.concat(g(b))}),c):u(b)?b.split(" "):o(b)?(e(b,function(b,d){b&&(c=c.concat(d.split(" ")))}),c):b}return{restrict:"AC",link:function(h,j,k){function l(b){b=o(b,1);k.$addClass(b)}function o(b,c){var d=j.data("$classCounts")||W(),f=[];e(b,function(b){if(0<c||d[b])d[b]=(d[b]||0)+c,d[b]===+(0<c)&&f.push(b)});j.data("$classCounts",d);return f.join(" ")}function m(b,c){var e=f(c,b),g=f(b,c),e=o(e,1),g=o(g,-1);e&&e.length&&d.addClass(j,e);g&&g.length&&
d.removeClass(j,g)}function n(b){if(!0===c||h.$index%2===c){var d=g(b||[]);if(s){if(!N(b,s)){var e=g(s);m(e,d)}}else l(d)}s=ia(b)?b.map(function(b){return J(b)}):J(b)}var s;h.$watch(k[b],n,!0);k.$observe("class",function(){n(h.$eval(k[b]))});"ngClass"!==b&&h.$watch("$index",function(d,e){var f=d&1;if(f!==(e&1)){var j=g(h.$eval(k[b]));f===c?l(j):(f=o(j,-1),k.$removeClass(f))}})}}}]}function Kd(b){function c(b,d){d&&!g[b]?(k.addClass(f,b),g[b]=!0):!d&&g[b]&&(k.removeClass(f,b),g[b]=!1)}function d(b,
e){b=b?"-"+pa(b,"-"):"";c(Kc+b,!0===e);c(he+b,!1===e)}var e=b.ctrl,f=b.$element,g={},h=b.set,j=b.unset,k=b.$animate;g[he]=!(g[Kc]=f.hasClass(Kc));e.$setValidity=function(b,f,g){s(f)?(e.$pending||(e.$pending={}),h(e.$pending,b,g)):(e.$pending&&j(e.$pending,b,g),Jd(e.$pending)&&(e.$pending=void 0));K(f)?f?(j(e.$error,b,g),h(e.$$success,b,g)):(h(e.$error,b,g),j(e.$$success,b,g)):(j(e.$error,b,g),j(e.$$success,b,g));e.$pending?(c(ie,!0),e.$valid=e.$invalid=void 0,d("",null)):(c(ie,!1),e.$valid=Jd(e.$error),
e.$invalid=!e.$valid,d("",e.$valid));f=e.$pending&&e.$pending[b]?void 0:e.$error[b]?!1:e.$$success[b]?!0:null;d(b,f);e.$$parentForm.$setValidity(b,f,e)}}function Jd(b){if(b)for(var c in b)if(b.hasOwnProperty(c))return!1;return!0}var Me=/^\/(.+)\/([a-z]*)$/,Gb=Object.prototype.hasOwnProperty,wa=function(b){return u(b)?b.toLowerCase():b},Oc=function(b){return u(b)?b.toUpperCase():b},Qb,ca,Pb,lb=[].slice,Ce=[].splice,Be=[].push,ab=Object.prototype.toString,Td=Object.getPrototypeOf,dc=c("ng"),mb=b.angular||
(b.angular={}),jd,Pc=0;Qb=b.document.documentMode;n.$inject=[];q.$inject=[];var ia=Array.isArray,Ke=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/,ya=function(b){return u(b)?b.trim():b},Ld=function(b){return b.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},fc=function(){if(!r(fc.rules)){var c=b.document.querySelector("[ng-csp]")||b.document.querySelector("[data-ng-csp]");if(c){var d=c.getAttribute("ng-csp")||c.getAttribute("data-ng-csp");
fc.rules={noUnsafeEval:!d||-1!==d.indexOf("no-unsafe-eval"),noInlineStyle:!d||-1!==d.indexOf("no-inline-style")}}else{c=fc;try{new Function(""),d=!1}catch(e){d=!0}c.rules={noUnsafeEval:d,noInlineStyle:!1}}}return fc.rules},Mc=function(){if(r(Mc.name_))return Mc.name_;var c,d,e=lc.length,f,g;for(d=0;d<e;++d)if(f=lc[d],c=b.document.querySelector("["+f.replace(":","\\:")+"jq]")){g=c.getAttribute(f+"jq");break}return Mc.name_=g},Ne=/:/g,lc=["ng-","data-ng-","ng:","x-ng-"],Oe=/[A-Z]/g,Ud=!1,mc=3,Pe={full:"1.5.5",
major:1,minor:5,dot:5,codeName:"material-conspiration"};ea.expando="ng339";var yc=ea.cache={},Qe=1;ea._data=function(b){return this.cache[b[this.expando]]||{}};var Re=/([\:\-\_]+(.))/g,Se=/^moz([A-Z])/,Qc={mouseleave:"mouseout",mouseenter:"mouseover"},hd=c("jqLite"),Ae=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,id=/<|&#?\w+;/,Te=/<([\w:-]+)/,Ue=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,zb={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,
"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};zb.optgroup=zb.option;zb.tbody=zb.tfoot=zb.colgroup=zb.caption=zb.thead;zb.th=zb.td;var Ve=b.Node.prototype.contains||function(b){return!!(this.compareDocumentPosition(b)&16)},kc=ea.prototype={ready:function(c){function d(){e||(e=!0,c())}var e=!1;"complete"===b.document.readyState?b.setTimeout(d):(this.on("DOMContentLoaded",d),ea(b).on("load",
d))},toString:function(){var b=[];e(this,function(c){b.push(""+c)});return"["+b.join(", ")+"]"},eq:function(b){return 0<=b?ca(this[b]):ca(this[this.length+b])},length:0,push:Be,sort:[].sort,splice:[].splice},Lc={};e("multiple selected checked disabled readOnly required open".split(" "),function(b){Lc[wa(b)]=b});var Hd={};e("input select option textarea button form details".split(" "),function(b){Hd[b]=true});var Id={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};
e({data:xb,removeData:Va,hasData:function(b){for(var c in yc[b.ng339])return!0;return!1},cleanData:function(b){for(var c=0,d=b.length;c<d;c++)Va(b[c])}},function(b,c){ea[c]=b});e({data:xb,inheritedData:xa,scope:function(b){return ca.data(b,"$scope")||xa(b.parentNode||b,["$isolateScope","$scope"])},isolateScope:function(b){return ca.data(b,"$isolateScope")||ca.data(b,"$isolateScopeNoTemplate")},controller:Aa,injector:function(b){return xa(b,"$injector")},removeAttr:function(b,c){b.removeAttribute(c)},
hasClass:Fa,css:function(b,c,d){c=v(c);if(r(d))b.style[c]=d;else return b.style[c]},attr:function(b,c,d){var e=b.nodeType;if(e!==mc&&2!==e&&8!==e)if(e=wa(c),Lc[e])if(r(d))d?(b[c]=!0,b.setAttribute(c,e)):(b[c]=!1,b.removeAttribute(e));else return b[c]||(b.attributes.getNamedItem(c)||n).specified?e:void 0;else if(r(d))b.setAttribute(c,d);else if(b.getAttribute)return b=b.getAttribute(c,2),null===b?void 0:b},prop:function(b,c,d){if(r(d))b[c]=d;else return b[c]},text:function(){function b(c,d){if(s(d)){var e=
c.nodeType;return 1===e||e===mc?c.textContent:""}c.textContent=d}b.$dv="";return b}(),val:function(b,c){if(s(c)){if(b.multiple&&"select"===D(b)){var d=[];e(b.options,function(b){b.selected&&d.push(b.value||b.text)});return 0===d.length?null:d}return b.value}b.value=c},html:function(b,c){if(s(c))return b.innerHTML;Ca(b,!0);b.innerHTML=c},empty:Hb},function(b,c){ea.prototype[c]=function(c,d){var e,f,g=this.length;if(b!==Hb&&s(2==b.length&&b!==Fa&&b!==Aa?c:d)){if(o(c)){for(e=0;e<g;e++)if(b===xb)b(this[e],
c);else for(f in c)b(this[e],f,c[f]);return this}e=b.$dv;g=s(e)?Math.min(g,1):g;for(f=0;f<g;f++){var h=b(this[f],c,d);e=e?e+h:h}return e}for(e=0;e<g;e++)b(this[e],c,d);return this}});e({removeData:Va,on:function(b,c,d,e){if(r(e))throw hd("onargs");if(Na(b)){var e=nb(b,!0),f=e.events,g=e.handle;g||(g=e.handle=cb(b,f));for(var e=0<=c.indexOf(" ")?c.split(" "):[c],h=e.length,j=function(c,e,h){var j=f[c];j||(j=f[c]=[],j.specialHandlerWrapper=e,"$destroy"===c||h||b.addEventListener(c,g,!1));j.push(d)};h--;)c=
e[h],Qc[c]?(j(Qc[c],Qa),j(c,void 0,!0)):j(c)}},off:ub,one:function(b,c,d){b=ca(b);b.on(c,function Kb(){b.off(c,d);b.off(c,Kb)});b.on(c,d)},replaceWith:function(b,c){var d,f=b.parentNode;Ca(b);e(new ea(c),function(c){d?f.insertBefore(c,d.nextSibling):f.replaceChild(c,b);d=c})},children:function(b){var c=[];e(b.childNodes,function(b){1===b.nodeType&&c.push(b)});return c},contents:function(b){return b.contentDocument||b.childNodes||[]},append:function(b,c){var d=b.nodeType;if(1===d||11===d)for(var c=
new ea(c),d=0,e=c.length;d<e;d++)b.appendChild(c[d])},prepend:function(b,c){if(1===b.nodeType){var d=b.firstChild;e(new ea(c),function(c){b.insertBefore(c,d)})}},wrap:function(b,c){kb(b,ca(c).eq(0).clone()[0])},remove:Ia,detach:function(b){Ia(b,!0)},after:function(b,c){for(var d=b,e=b.parentNode,c=new ea(c),f=0,g=c.length;f<g;f++){var h=c[f];e.insertBefore(h,d.nextSibling);d=h}},addClass:bb,removeClass:Sa,toggleClass:function(b,c,d){c&&e(c.split(" "),function(c){var e=d;s(e)&&(e=!Fa(b,c));(e?bb:Sa)(b,
c)})},parent:function(b){return(b=b.parentNode)&&11!==b.nodeType?b:null},next:function(b){return b.nextElementSibling},find:function(b,c){return b.getElementsByTagName?b.getElementsByTagName(c):[]},clone:ma,triggerHandler:function(b,c,d){var f,g,h=c.type||c,j=nb(b);if(j=(j=j&&j.events)&&j[h])f={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===
this.immediatePropagationStopped},stopPropagation:n,type:h,target:b},c.type&&(f=k(f,c)),c=J(j),g=d?[f].concat(d):[f],e(c,function(c){f.isImmediatePropagationStopped()||c.apply(b,g)})}},function(b,c){ea.prototype[c]=function(c,d,e){for(var f,g=0,h=this.length;g<h;g++)s(f)?(f=b(this[g],c,d,e),r(f)&&(f=ca(f))):Ta(f,b(this[g],c,d,e));return r(f)?f:this};ea.prototype.bind=ea.prototype.on;ea.prototype.unbind=ea.prototype.off});ua.prototype={put:function(b,c){this[za(b,this.nextUid)]=c},get:function(b){return this[za(b,
this.nextUid)]},remove:function(b){var c=this[b=za(b,this.nextUid)];delete this[b];return c}};var ue=[function(){this.$get=[function(){return ua}]}],ve=/^([^\(]+?)=>/,we=/^[^\(]*\(\s*([^\)]*)\)/m,xe=/,/,ye=/^\s*(_?)(\S+?)\1\s*$/,ze=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,cc=c("$injector");Pa.$$annotate=function(b,c,d){var f;if("function"===typeof b){if(!(f=b.$inject)){f=[];if(b.length){if(c)throw u(d)&&d||(d=b.name||Ka(b)),cc("strictdi",d);c=hb(b);e(c[1].split(xe),function(b){b.replace(ye,function(b,c,
d){f.push(d)})})}b.$inject=f}}else ia(b)?(c=b.length-1,ta(b[c],"fn"),f=b.slice(0,c)):ta(b,"fn",!0);return f};var Nd=c("$animate"),De=function(){this.$get=n},Ee=function(){var b=new ua,c=[];this.$get=["$$AnimateRunner","$rootScope",function(d,f){function g(b,c,d){var f=!1;c&&(c=u(c)?c.split(" "):ia(c)?c:[],e(c,function(c){c&&(f=!0,b[c]=d)}));return f}function h(){e(c,function(c){var d=b.get(c);if(d){var f=Fb(c.attr("class")),g="",h="";e(d,function(b,c){b!==!!f[c]&&(b?g+=(g.length?" ":"")+c:h+=(h.length?
" ":"")+c)});e(c,function(b){g&&bb(b,g);h&&Sa(b,h)});b.remove(c)}});c.length=0}return{enabled:n,on:n,off:n,pin:n,push:function(e,j,k,l){l&&l();k=k||{};k.from&&e.css(k.from);k.to&&e.css(k.to);if(k.addClass||k.removeClass)if(j=k.addClass,l=k.removeClass,k=b.get(e)||{},j=g(k,j,!0),l=g(k,l,!1),j||l)b.put(e,k),c.push(e),1===c.length&&f.$$postDigest(h);e=new d;e.complete();return e}}}]},Fe=["$provide",function(b){var c=this;this.$$registeredAnimations=Object.create(null);this.register=function(d,e){if(d&&
"."!==d.charAt(0))throw Nd("notcsel",d);var f=d+"-animation";c.$$registeredAnimations[d.substr(1)]=f;b.factory(f,e)};this.classNameFilter=function(b){if(1===arguments.length&&(this.$$classNameFilter=b instanceof RegExp?b:null)&&/(\s+|\/)ng-animate(\s+|\/)/.test(this.$$classNameFilter.toString()))throw Nd("nongcls","ng-animate");return this.$$classNameFilter};this.$get=["$$animateQueue",function(b){function c(b,d,e){if(e){var f;a:{for(f=0;f<e.length;f++){var g=e[f];if(1===g.nodeType){f=g;break a}}f=
void 0}!f||f.parentNode||f.previousElementSibling||(e=null)}e?e.after(b):d.prepend(b)}return{on:b.on,off:b.off,pin:b.pin,enabled:b.enabled,cancel:function(b){b.end&&b.end()},enter:function(d,e,f,g){e=e&&ca(e);f=f&&ca(f);e=e||f.parent();c(d,e,f);return b.push(d,"enter",Ja(g))},move:function(d,e,f,g){e=e&&ca(e);f=f&&ca(f);e=e||f.parent();c(d,e,f);return b.push(d,"move",Ja(g))},leave:function(c,d){return b.push(c,"leave",Ja(d),function(){c.remove()})},addClass:function(c,d,e){e=Ja(e);e.addClass=na(e.addclass,
d);return b.push(c,"addClass",e)},removeClass:function(c,d,e){e=Ja(e);e.removeClass=na(e.removeClass,d);return b.push(c,"removeClass",e)},setClass:function(c,d,e,f){f=Ja(f);f.addClass=na(f.addClass,d);f.removeClass=na(f.removeClass,e);return b.push(c,"setClass",f)},animate:function(c,d,e,f,g){g=Ja(g);g.from=g.from?k(g.from,d):d;g.to=g.to?k(g.to,e):e;g.tempClasses=na(g.tempClasses,f||"ng-inline-animate");return b.push(c,"animate",g)}}}]}],Ge=function(){this.$get=["$$rAF",function(b){function c(e){d.push(e);
1<d.length||b(function(){for(var b=0;b<d.length;b++)d[b]();d=[]})}var d=[];return function(){var b=!1;c(function(){b=!0});return function(d){b?d():c(d)}}}]},He=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$document","$timeout",function(b,c,d,f,g){function h(b){this.setHost(b);var c=d();this._doneCallbacks=[];this._tick=function(b){var d=f[0];d&&d.hidden?g(b,0,!1):c(b)};this._state=0}h.chain=function(b,c){function d(){if(e===b.length)c(!0);else b[e](function(b){!1===b?c(!1):(e++,d())})}
var e=0;d()};h.all=function(b,c){function d(e){g=g&&e;++f===b.length&&c(g)}var f=0,g=!0;e(b,function(b){b.done(d)})};h.prototype={setHost:function(b){this.host=b||{}},done:function(b){2===this._state?b():this._doneCallbacks.push(b)},progress:n,getPromise:function(){if(!this.promise){var c=this;this.promise=b(function(b,d){c.done(function(c){!1===c?d():b()})})}return this.promise},then:function(b,c){return this.getPromise().then(b,c)},"catch":function(b){return this.getPromise()["catch"](b)},"finally":function(b){return this.getPromise()["finally"](b)},
pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end();this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel();this._resolve(!1)},complete:function(b){var c=this;0===c._state&&(c._state=1,c._tick(function(){c._resolve(b)}))},_resolve:function(b){2!==this._state&&(e(this._doneCallbacks,function(c){c(b)}),this._doneCallbacks.length=0,this._state=2)}};return h}]},Ie=function(){this.$get=
["$$rAF","$q","$$AnimateRunner",function(b,c,d){return function(c,e){function f(){b(function(){g.addClass&&(c.addClass(g.addClass),g.addClass=null);g.removeClass&&(c.removeClass(g.removeClass),g.removeClass=null);g.to&&(c.css(g.to),g.to=null);h||j.complete();h=!0});return j}var g=e||{};g.$$prepared||(g=I(g));g.cleanupStyles&&(g.from=g.to=null);g.from&&(c.css(g.from),g.from=null);var h,j=new d;return{start:f,end:f}}}]},Ra=c("$compile"),ld=new function(){};ob.$inject=["$provide","$$sanitizeUriProvider"];
Ga.prototype.isFirstChange=function(){return this.previousValue===ld};var Qd=/^((?:x|data)[\:\-_])/i,If=c("$controller"),ae=/^(\S+)(\s+as\s+([\w$]+))?$/,Hf=function(){this.$get=["$document",function(b){return function(c){c?!c.nodeType&&c instanceof ca&&(c=c[0]):c=b[0].body;return c.offsetWidth+1}}]},be="application/json",wd={"Content-Type":be+";charset=utf-8"},Kf=/^\[|^\{(?!\{)/,Lf={"[":/]$/,"{":/}$/},Jf=/^\)\]\}',?\n/,Yf=c("$http"),ce=function(b){return function(){throw Yf("legacy",b);}},ic=mb.$interpolateMinErr=
c("$interpolate");ic.throwNoconcat=function(b){throw ic("noconcat",b);};ic.interr=function(b,c){return ic("interr",b,c.toString())};var Zf=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,Mf={http:80,https:443,ftp:21},bd=c("$location"),$f={$$html5:!1,$$replace:!1,absUrl:Bb("$$absUrl"),url:function(b){if(s(b))return this.$$url;var c=Zf.exec(b);(c[1]||""===b)&&this.path(decodeURIComponent(c[1]));(c[2]||c[1]||""===b)&&this.search(c[3]||"");this.hash(c[5]||"");return this},protocol:Bb("$$protocol"),host:Bb("$$host"),
port:Bb("$$port"),path:Cc("$$path",function(b){b=null!==b?b.toString():"";return"/"==b.charAt(0)?b:"/"+b}),search:function(b,c){switch(arguments.length){case 0:return this.$$search;case 1:if(u(b)||w(b))b=b.toString(),this.$$search=aa(b);else if(o(b))b=I(b,{}),e(b,function(c,d){null==c&&delete b[d]}),this.$$search=b;else throw bd("isrcharg");break;default:s(c)||null===c?delete this.$$search[b]:this.$$search[b]=c}this.$$compose();return this},hash:Cc("$$hash",function(b){return null!==b?b.toString():
""}),replace:function(){this.$$replace=!0;return this}};e([Rc,Bc,Ac],function(b){b.prototype=Object.create($f);b.prototype.state=function(c){if(!arguments.length)return this.$$state;if(b!==Ac||!this.$$html5)throw bd("nostate");this.$$state=s(c)?null:c;return this}});var fb=c("$parse"),Nf=Function.prototype.call,Of=Function.prototype.apply,Pf=Function.prototype.bind,ed=W();e("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(b){ed[b]=true});var ag={n:"\n",f:"\u000c",r:"\r",t:"\t",
v:"\v","'":"'",'"':'"'},xd=function(b){this.options=b};xd.prototype={constructor:xd,lex:function(b){this.text=b;this.index=0;for(this.tokens=[];this.index<this.text.length;)if(b=this.text.charAt(this.index),'"'===b||"'"===b)this.readString(b);else if(this.isNumber(b)||"."===b&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(b,"(){}[].,;:?"))this.tokens.push({index:this.index,text:b}),this.index++;else if(this.isWhitespace(b))this.index++;
else{var c=b+this.peek(),d=c+this.peek(2),e=ed[c],f=ed[d];ed[b]||e||f?(b=f?d:e?c:b,this.tokens.push({index:this.index,text:b,operator:!0}),this.index+=b.length):this.throwError("Unexpected next character ",this.index,this.index+1)}return this.tokens},is:function(b,c){return-1!==c.indexOf(b)},peek:function(b){b=b||1;return this.index+b<this.text.length?this.text.charAt(this.index+b):!1},isNumber:function(b){return"0"<=b&&"9">=b&&"string"===typeof b},isWhitespace:function(b){return" "===b||"\r"===b||
"\t"===b||"\n"===b||"\v"===b||"\u00a0"===b},isIdentifierStart:function(b){return this.options.isIdentifierStart?this.options.isIdentifierStart(b,this.codePointAt(b)):this.isValidIdentifierStart(b)},isValidIdentifierStart:function(b){return"a"<=b&&"z">=b||"A"<=b&&"Z">=b||"_"===b||"$"===b},isIdentifierContinue:function(b){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(b,this.codePointAt(b)):this.isValidIdentifierContinue(b)},isValidIdentifierContinue:function(b,c){return this.isValidIdentifierStart(b,
c)||this.isNumber(b)},codePointAt:function(b){return 1===b.length?b.charCodeAt(0):(b.charCodeAt(0)<<10)+b.charCodeAt(1)-56613888},peekMultichar:function(){var b=this.text.charAt(this.index),c=this.peek();if(!c)return b;var d=b.charCodeAt(0),e=c.charCodeAt(0);return 55296<=d&&56319>=d&&56320<=e&&57343>=e?b+c:b},isExpOperator:function(b){return"-"===b||"+"===b||this.isNumber(b)},throwError:function(b,c,d){d=d||this.index;c=r(c)?"s "+c+"-"+this.index+" ["+this.text.substring(c,d)+"]":" "+d;throw fb("lexerr",
b,c,this.text);},readNumber:function(){for(var b="",c=this.index;this.index<this.text.length;){var d=wa(this.text.charAt(this.index));if("."==d||this.isNumber(d))b+=d;else{var e=this.peek();if("e"==d&&this.isExpOperator(e))b+=d;else if(this.isExpOperator(d)&&e&&this.isNumber(e)&&"e"==b.charAt(b.length-1))b+=d;else if(!this.isExpOperator(d)||e&&this.isNumber(e)||"e"!=b.charAt(b.length-1))break;else this.throwError("Invalid exponent")}this.index++}this.tokens.push({index:c,text:b,constant:!0,value:Number(b)})},
readIdent:function(){var b=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var c=this.peekMultichar();if(!this.isIdentifierContinue(c))break;this.index+=c.length}this.tokens.push({index:b,text:this.text.slice(b,this.index),identifier:!0})},readString:function(b){var c=this.index;this.index++;for(var d="",e=b,f=!1;this.index<this.text.length;){var g=this.text.charAt(this.index),e=e+g;if(f)"u"===g?(f=this.text.substring(this.index+1,this.index+5),f.match(/[\da-f]{4}/i)||
this.throwError("Invalid unicode escape [\\u"+f+"]"),this.index+=4,d+=String.fromCharCode(parseInt(f,16))):d+=ag[g]||g,f=!1;else if("\\"===g)f=!0;else{if(g===b){this.index++;this.tokens.push({index:c,text:e,constant:!0,value:d});return}d+=g}this.index++}this.throwError("Unterminated quote",c)}};var S=function(b,c){this.lexer=b;this.options=c};S.Program="Program";S.ExpressionStatement="ExpressionStatement";S.AssignmentExpression="AssignmentExpression";S.ConditionalExpression="ConditionalExpression";
S.LogicalExpression="LogicalExpression";S.BinaryExpression="BinaryExpression";S.UnaryExpression="UnaryExpression";S.CallExpression="CallExpression";S.MemberExpression="MemberExpression";S.Identifier="Identifier";S.Literal="Literal";S.ArrayExpression="ArrayExpression";S.Property="Property";S.ObjectExpression="ObjectExpression";S.ThisExpression="ThisExpression";S.LocalsExpression="LocalsExpression";S.NGValueParameter="NGValueParameter";S.prototype={ast:function(b){this.text=b;this.tokens=this.lexer.lex(b);
b=this.program();0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]);return b},program:function(){for(var b=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&b.push(this.expressionStatement()),!this.expect(";"))return{type:S.Program,body:b}},expressionStatement:function(){return{type:S.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var b=this.expression();this.expect("|");)b=this.filter(b);return b},expression:function(){return this.assignment()},
assignment:function(){var b=this.ternary();this.expect("=")&&(b={type:S.AssignmentExpression,left:b,right:this.assignment(),operator:"="});return b},ternary:function(){var b=this.logicalOR(),c,d;return this.expect("?")&&(c=this.expression(),this.consume(":"))?(d=this.expression(),{type:S.ConditionalExpression,test:b,alternate:c,consequent:d}):b},logicalOR:function(){for(var b=this.logicalAND();this.expect("||");)b={type:S.LogicalExpression,operator:"||",left:b,right:this.logicalAND()};return b},logicalAND:function(){for(var b=
this.equality();this.expect("&&");)b={type:S.LogicalExpression,operator:"&&",left:b,right:this.equality()};return b},equality:function(){for(var b=this.relational(),c;c=this.expect("==","!=","===","!==");)b={type:S.BinaryExpression,operator:c.text,left:b,right:this.relational()};return b},relational:function(){for(var b=this.additive(),c;c=this.expect("<",">","<=",">=");)b={type:S.BinaryExpression,operator:c.text,left:b,right:this.additive()};return b},additive:function(){for(var b=this.multiplicative(),
c;c=this.expect("+","-");)b={type:S.BinaryExpression,operator:c.text,left:b,right:this.multiplicative()};return b},multiplicative:function(){for(var b=this.unary(),c;c=this.expect("*","/","%");)b={type:S.BinaryExpression,operator:c.text,left:b,right:this.unary()};return b},unary:function(){var b;return(b=this.expect("+","-","!"))?{type:S.UnaryExpression,operator:b.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var b;this.expect("(")?(b=this.filterChain(),this.consume(")")):
this.expect("[")?b=this.arrayDeclaration():this.expect("{")?b=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?b=I(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?b={type:S.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?b=this.identifier():this.peek().constant?b=this.constant():this.throwError("not a primary expression",this.peek());for(var c;c=this.expect("(","[",".");)"("===c.text?(b={type:S.CallExpression,
callee:b,arguments:this.parseArguments()},this.consume(")")):"["===c.text?(b={type:S.MemberExpression,object:b,property:this.expression(),computed:!0},this.consume("]")):"."===c.text?b={type:S.MemberExpression,object:b,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return b},filter:function(b){for(var b=[b],c={type:S.CallExpression,callee:this.identifier(),arguments:b,filter:!0};this.expect(":");)b.push(this.expression());return c},parseArguments:function(){var b=[];if(")"!==
this.peekToken().text){do b.push(this.expression());while(this.expect(","))}return b},identifier:function(){var b=this.consume();b.identifier||this.throwError("is not a valid identifier",b);return{type:S.Identifier,name:b.text}},constant:function(){return{type:S.Literal,value:this.consume().value}},arrayDeclaration:function(){var b=[];if("]"!==this.peekToken().text){do{if(this.peek("]"))break;b.push(this.expression())}while(this.expect(","))}this.consume("]");return{type:S.ArrayExpression,elements:b}},
object:function(){var b=[],c;if("}"!==this.peekToken().text){do{if(this.peek("}"))break;c={type:S.Property,kind:"init"};this.peek().constant?c.key=this.constant():this.peek().identifier?c.key=this.identifier():this.throwError("invalid key",this.peek());this.consume(":");c.value=this.expression();b.push(c)}while(this.expect(","))}this.consume("}");return{type:S.ObjectExpression,properties:b}},throwError:function(b,c){throw fb("syntax",c.text,b,c.index+1,this.text,this.text.substring(c.index));},consume:function(b){if(0===
this.tokens.length)throw fb("ueoe",this.text);var c=this.expect(b);c||this.throwError("is unexpected, expecting ["+b+"]",this.peek());return c},peekToken:function(){if(0===this.tokens.length)throw fb("ueoe",this.text);return this.tokens[0]},peek:function(b,c,d,e){return this.peekAhead(0,b,c,d,e)},peekAhead:function(b,c,d,e,f){if(this.tokens.length>b){var b=this.tokens[b],g=b.text;if(g===c||g===d||g===e||g===f||!c&&!d&&!e&&!f)return b}return!1},expect:function(b,c,d,e){return(b=this.peek(b,c,d,e))?
(this.tokens.shift(),b):!1},selfReferential:{"this":{type:S.ThisExpression},$locals:{type:S.LocalsExpression}}};Vc.prototype={compile:function(b,c){var d=this,f=this.astBuilder.ast(b);this.state={nextId:0,filters:{},expensiveChecks:c,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]};Ba(f,d.$filter);var g="",h;this.stage="assign";if(h=Uc(f))this.state.computing="assign",g=this.nextId(),this.recurse(h,g),this.return_(g),g="fn.assign="+this.generateFunction("assign","s,v,l");h=Tc(f.body);
d.stage="inputs";e(h,function(b,c){var e="fn"+c;d.state[e]={vars:[],body:[],own:{}};d.state.computing=e;var f=d.nextId();d.recurse(b,f);d.return_(f);d.state.inputs.push(e);b.watchId=c});this.state.computing="fn";this.stage="main";this.recurse(f);g='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+g+this.watchFns()+"return fn;";g=(new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext",
"ifDefined","plus","text",g))(this.$filter,eb,Wa,Sc,Db,Wb,od,oc,b);this.state=this.stage=void 0;g.literal=Ec(f);g.constant=f.constant;return g},USE:"use",STRICT:"strict",watchFns:function(){var b=[],c=this.state.inputs,d=this;e(c,function(c){b.push("var "+c+"="+d.generateFunction(c,"s"))});c.length&&b.push("fn.inputs=["+c.join(",")+"];");return b.join("")},generateFunction:function(b,c){return"function("+c+"){"+this.varsPrefix(b)+this.body(b)+"};"},filterPrefix:function(){var b=[],c=this;e(this.state.filters,
function(d,e){b.push(d+"=$filter("+c.escape(e)+")")});return b.length?"var "+b.join(",")+";":""},varsPrefix:function(b){return this.state[b].vars.length?"var "+this.state[b].vars.join(",")+";":""},body:function(b){return this.state[b].body.join("")},recurse:function(b,c,d,f,g,h){var j,k,l=this,o,m,f=f||n;if(!h&&r(b.watchId))c=c||this.nextId(),this.if_("i",this.lazyAssign(c,this.computedMember("i",b.watchId)),this.lazyRecurse(b,c,d,f,g,!0));else switch(b.type){case S.Program:e(b.body,function(c,d){l.recurse(c.expression,
void 0,void 0,function(b){k=b});d!==b.body.length-1?l.current().body.push(k,";"):l.return_(k)});break;case S.Literal:m=this.escape(b.value);this.assign(c,m);f(m);break;case S.UnaryExpression:this.recurse(b.argument,void 0,void 0,function(b){k=b});m=b.operator+"("+this.ifDefined(k,0)+")";this.assign(c,m);f(m);break;case S.BinaryExpression:this.recurse(b.left,void 0,void 0,function(b){j=b});this.recurse(b.right,void 0,void 0,function(b){k=b});m="+"===b.operator?this.plus(j,k):"-"===b.operator?this.ifDefined(j,
0)+b.operator+this.ifDefined(k,0):"("+j+")"+b.operator+"("+k+")";this.assign(c,m);f(m);break;case S.LogicalExpression:c=c||this.nextId();l.recurse(b.left,c);l.if_("&&"===b.operator?c:l.not(c),l.lazyRecurse(b.right,c));f(c);break;case S.ConditionalExpression:c=c||this.nextId();l.recurse(b.test,c);l.if_(c,l.lazyRecurse(b.alternate,c),l.lazyRecurse(b.consequent,c));f(c);break;case S.Identifier:c=c||this.nextId();d&&(d.context="inputs"===l.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",
b.name)+"?l:s"),d.computed=!1,d.name=b.name);eb(b.name);l.if_("inputs"===l.stage||l.not(l.getHasOwnProperty("l",b.name)),function(){l.if_("inputs"===l.stage||"s",function(){g&&1!==g&&l.if_(l.not(l.nonComputedMember("s",b.name)),l.lazyAssign(l.nonComputedMember("s",b.name),"{}"));l.assign(c,l.nonComputedMember("s",b.name))})},c&&l.lazyAssign(c,l.nonComputedMember("l",b.name)));(l.state.expensiveChecks||"constructor"==b.name)&&l.addEnsureSafeObject(c);f(c);break;case S.MemberExpression:j=d&&(d.context=
this.nextId())||this.nextId();c=c||this.nextId();l.recurse(b.object,j,void 0,function(){l.if_(l.notNull(j),function(){g&&1!==g&&l.addEnsureSafeAssignContext(j);if(b.computed)k=l.nextId(),l.recurse(b.property,k),l.getStringValue(k),l.addEnsureSafeMemberName(k),g&&1!==g&&l.if_(l.not(l.computedMember(j,k)),l.lazyAssign(l.computedMember(j,k),"{}")),m=l.ensureSafeObject(l.computedMember(j,k)),l.assign(c,m),d&&(d.computed=!0,d.name=k);else{eb(b.property.name);g&&1!==g&&l.if_(l.not(l.nonComputedMember(j,
b.property.name)),l.lazyAssign(l.nonComputedMember(j,b.property.name),"{}"));m=l.nonComputedMember(j,b.property.name);if(l.state.expensiveChecks||"constructor"==b.property.name)m=l.ensureSafeObject(m);l.assign(c,m);d&&(d.computed=!1,d.name=b.property.name)}},function(){l.assign(c,"undefined")});f(c)},!!g);break;case S.CallExpression:c=c||this.nextId();b.filter?(k=l.filter(b.callee.name),o=[],e(b.arguments,function(b){var c=l.nextId();l.recurse(b,c);o.push(c)}),m=k+"("+o.join(",")+")",l.assign(c,m),
f(c)):(k=l.nextId(),j={},o=[],l.recurse(b.callee,k,j,function(){l.if_(l.notNull(k),function(){l.addEnsureSafeFunction(k);e(b.arguments,function(b){l.recurse(b,l.nextId(),void 0,function(b){o.push(l.ensureSafeObject(b))})});j.name?(l.state.expensiveChecks||l.addEnsureSafeObject(j.context),m=l.member(j.context,j.name,j.computed)+"("+o.join(",")+")"):m=k+"("+o.join(",")+")";m=l.ensureSafeObject(m);l.assign(c,m)},function(){l.assign(c,"undefined")});f(c)}));break;case S.AssignmentExpression:k=this.nextId();
j={};if(!(b.left.type===S.Identifier||b.left.type===S.MemberExpression))throw fb("lval");this.recurse(b.left,void 0,j,function(){l.if_(l.notNull(j.context),function(){l.recurse(b.right,k);l.addEnsureSafeObject(l.member(j.context,j.name,j.computed));l.addEnsureSafeAssignContext(j.context);m=l.member(j.context,j.name,j.computed)+b.operator+k;l.assign(c,m);f(c||m)})},1);break;case S.ArrayExpression:o=[];e(b.elements,function(b){l.recurse(b,l.nextId(),void 0,function(b){o.push(b)})});m="["+o.join(",")+
"]";this.assign(c,m);f(m);break;case S.ObjectExpression:o=[];e(b.properties,function(b){l.recurse(b.value,l.nextId(),void 0,function(c){o.push(l.escape(b.key.type===S.Identifier?b.key.name:""+b.key.value)+":"+c)})});m="{"+o.join(",")+"}";this.assign(c,m);f(m);break;case S.ThisExpression:this.assign(c,"s");f("s");break;case S.LocalsExpression:this.assign(c,"l");f("l");break;case S.NGValueParameter:this.assign(c,"v"),f("v")}},getHasOwnProperty:function(b,c){var d=b+"."+c,e=this.current().own;e.hasOwnProperty(d)||
(e[d]=this.nextId(!1,b+"&&("+this.escape(c)+" in "+b+")"));return e[d]},assign:function(b,c){if(b)return this.current().body.push(b,"=",c,";"),b},filter:function(b){this.state.filters.hasOwnProperty(b)||(this.state.filters[b]=this.nextId(!0));return this.state.filters[b]},ifDefined:function(b,c){return"ifDefined("+b+","+this.escape(c)+")"},plus:function(b,c){return"plus("+b+","+c+")"},return_:function(b){this.current().body.push("return ",b,";")},if_:function(b,c,d){if(!0===b)c();else{var e=this.current().body;
e.push("if(",b,"){");c();e.push("}");d&&(e.push("else{"),d(),e.push("}"))}},not:function(b){return"!("+b+")"},notNull:function(b){return b+"!=null"},nonComputedMember:function(b,c){var d=/[^$_a-zA-Z0-9]/g;return/[$_a-zA-Z][$_a-zA-Z0-9]*/.test(c)?b+"."+c:b+'["'+c.replace(d,this.stringEscapeFn)+'"]'},computedMember:function(b,c){return b+"["+c+"]"},member:function(b,c,d){return d?this.computedMember(b,c):this.nonComputedMember(b,c)},addEnsureSafeObject:function(b){this.current().body.push(this.ensureSafeObject(b),
";")},addEnsureSafeMemberName:function(b){this.current().body.push(this.ensureSafeMemberName(b),";")},addEnsureSafeFunction:function(b){this.current().body.push(this.ensureSafeFunction(b),";")},addEnsureSafeAssignContext:function(b){this.current().body.push(this.ensureSafeAssignContext(b),";")},ensureSafeObject:function(b){return"ensureSafeObject("+b+",text)"},ensureSafeMemberName:function(b){return"ensureSafeMemberName("+b+",text)"},ensureSafeFunction:function(b){return"ensureSafeFunction("+b+",text)"},
getStringValue:function(b){this.assign(b,"getStringValue("+b+")")},ensureSafeAssignContext:function(b){return"ensureSafeAssignContext("+b+",text)"},lazyRecurse:function(b,c,d,e,f,g){var h=this;return function(){h.recurse(b,c,d,e,f,g)}},lazyAssign:function(b,c){var d=this;return function(){d.assign(b,c)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)},escape:function(b){if(u(b))return"'"+b.replace(this.stringEscapeRegex,this.stringEscapeFn)+
"'";if(w(b))return b.toString();if(!0===b)return"true";if(!1===b)return"false";if(null===b)return"null";if("undefined"===typeof b)return"undefined";throw fb("esc");},nextId:function(b,c){var d="v"+this.state.nextId++;b||this.current().vars.push(d+(c?"="+c:""));return d},current:function(){return this.state[this.state.computing]}};Wc.prototype={compile:function(b,c){var d=this,f=this.astBuilder.ast(b);this.expression=b;this.expensiveChecks=c;Ba(f,d.$filter);var g,h;if(g=Uc(f))h=this.recurse(g);g=Tc(f.body);
var j;g&&(j=[],e(g,function(b,c){var e=d.recurse(b);b.input=e;j.push(e);b.watchId=c}));var k=[];e(f.body,function(b){k.push(d.recurse(b.expression))});g=0===f.body.length?n:1===f.body.length?k[0]:function(b,c){var d;e(k,function(e){d=e(b,c)});return d};h&&(g.assign=function(b,c,d){return h(b,d,c)});j&&(g.inputs=j);g.literal=Ec(f);g.constant=f.constant;return g},recurse:function(b,c,d){var f,g,h=this,j;if(b.input)return this.inputs(b.input,b.watchId);switch(b.type){case S.Literal:return this.value(b.value,
c);case S.UnaryExpression:return g=this.recurse(b.argument),this["unary"+b.operator](g,c);case S.BinaryExpression:return f=this.recurse(b.left),g=this.recurse(b.right),this["binary"+b.operator](f,g,c);case S.LogicalExpression:return f=this.recurse(b.left),g=this.recurse(b.right),this["binary"+b.operator](f,g,c);case S.ConditionalExpression:return this["ternary?:"](this.recurse(b.test),this.recurse(b.alternate),this.recurse(b.consequent),c);case S.Identifier:return eb(b.name,h.expression),h.identifier(b.name,
h.expensiveChecks||"constructor"==b.name,c,d,h.expression);case S.MemberExpression:return f=this.recurse(b.object,!1,!!d),b.computed||(eb(b.property.name,h.expression),g=b.property.name),b.computed&&(g=this.recurse(b.property)),b.computed?this.computedMember(f,g,c,d,h.expression):this.nonComputedMember(f,g,h.expensiveChecks,c,d,h.expression);case S.CallExpression:return j=[],e(b.arguments,function(b){j.push(h.recurse(b))}),b.filter&&(g=this.$filter(b.callee.name)),b.filter||(g=this.recurse(b.callee,
!0)),b.filter?function(b,d,e,f){for(var h=[],k=0;k<j.length;++k)h.push(j[k](b,d,e,f));b=g.apply(void 0,h,f);return c?{context:void 0,name:void 0,value:b}:b}:function(b,d,e,f){var k=g(b,d,e,f),l;if(null!=k.value){Wa(k.context,h.expression);Sc(k.value,h.expression);l=[];for(var o=0;o<j.length;++o)l.push(Wa(j[o](b,d,e,f),h.expression));l=Wa(k.value.apply(k.context,l),h.expression)}return c?{value:l}:l};case S.AssignmentExpression:return f=this.recurse(b.left,!0,1),g=this.recurse(b.right),function(b,
d,e,j){var k=f(b,d,e,j),b=g(b,d,e,j);Wa(k.value,h.expression);Wb(k.context);k.context[k.name]=b;return c?{value:b}:b};case S.ArrayExpression:return j=[],e(b.elements,function(b){j.push(h.recurse(b))}),function(b,d,e,f){for(var g=[],h=0;h<j.length;++h)g.push(j[h](b,d,e,f));return c?{value:g}:g};case S.ObjectExpression:return j=[],e(b.properties,function(b){j.push({key:b.key.type===S.Identifier?b.key.name:""+b.key.value,value:h.recurse(b.value)})}),function(b,d,e,f){for(var g={},h=0;h<j.length;++h)g[j[h].key]=
j[h].value(b,d,e,f);return c?{value:g}:g};case S.ThisExpression:return function(b){return c?{value:b}:b};case S.LocalsExpression:return function(b,d){return c?{value:d}:d};case S.NGValueParameter:return function(b,d,e){return c?{value:e}:e}}},"unary+":function(b,c){return function(d,e,f,g){d=b(d,e,f,g);d=r(d)?+d:0;return c?{value:d}:d}},"unary-":function(b,c){return function(d,e,f,g){d=b(d,e,f,g);d=r(d)?-d:0;return c?{value:d}:d}},"unary!":function(b,c){return function(d,e,f,g){d=!b(d,e,f,g);return c?
{value:d}:d}},"binary+":function(b,c,d){return function(e,f,g,h){var j=b(e,f,g,h),e=c(e,f,g,h),j=oc(j,e);return d?{value:j}:j}},"binary-":function(b,c,d){return function(e,f,g,h){var j=b(e,f,g,h),e=c(e,f,g,h),j=(r(j)?j:0)-(r(e)?e:0);return d?{value:j}:j}},"binary*":function(b,c,d){return function(e,f,g,h){e=b(e,f,g,h)*c(e,f,g,h);return d?{value:e}:e}},"binary/":function(b,c,d){return function(e,f,g,h){e=b(e,f,g,h)/c(e,f,g,h);return d?{value:e}:e}},"binary%":function(b,c,d){return function(e,f,g,h){e=
b(e,f,g,h)%c(e,f,g,h);return d?{value:e}:e}},"binary===":function(b,c,d){return function(e,f,g,h){e=b(e,f,g,h)===c(e,f,g,h);return d?{value:e}:e}},"binary!==":function(b,c,d){return function(e,f,g,h){e=b(e,f,g,h)!==c(e,f,g,h);return d?{value:e}:e}},"binary==":function(b,c,d){return function(e,f,g,h){e=b(e,f,g,h)==c(e,f,g,h);return d?{value:e}:e}},"binary!=":function(b,c,d){return function(e,f,g,h){e=b(e,f,g,h)!=c(e,f,g,h);return d?{value:e}:e}},"binary<":function(b,c,d){return function(e,f,g,h){e=
b(e,f,g,h)<c(e,f,g,h);return d?{value:e}:e}},"binary>":function(b,c,d){return function(e,f,g,h){e=b(e,f,g,h)>c(e,f,g,h);return d?{value:e}:e}},"binary<=":function(b,c,d){return function(e,f,g,h){e=b(e,f,g,h)<=c(e,f,g,h);return d?{value:e}:e}},"binary>=":function(b,c,d){return function(e,f,g,h){e=b(e,f,g,h)>=c(e,f,g,h);return d?{value:e}:e}},"binary&&":function(b,c,d){return function(e,f,g,h){e=b(e,f,g,h)&&c(e,f,g,h);return d?{value:e}:e}},"binary||":function(b,c,d){return function(e,f,g,h){e=b(e,
f,g,h)||c(e,f,g,h);return d?{value:e}:e}},"ternary?:":function(b,c,d,e){return function(f,g,h,j){f=b(f,g,h,j)?c(f,g,h,j):d(f,g,h,j);return e?{value:f}:f}},value:function(b,c){return function(){return c?{context:void 0,name:void 0,value:b}:b}},identifier:function(b,c,d,e,f){return function(g,h){g=h&&b in h?h:g;e&&1!==e&&g&&!g[b]&&(g[b]={});h=g?g[b]:void 0;c&&Wa(h,f);return d?{context:g,name:b,value:h}:h}},computedMember:function(b,c,d,e,f){return function(g,h,j,k){var l=b(g,h,j,k),o,m;null!=l&&(o=
c(g,h,j,k),o+="",eb(o,f),e&&1!==e&&(Wb(l),l&&!l[o]&&(l[o]={})),m=l[o],Wa(m,f));return d?{context:l,name:o,value:m}:m}},nonComputedMember:function(b,c,d,e,f,g){return function(h,j,k,l){h=b(h,j,k,l);f&&1!==f&&(Wb(h),h&&!h[c]&&(h[c]={}));j=null!=h?h[c]:void 0;(d||"constructor"==c)&&Wa(j,g);return e?{context:h,name:c,value:j}:j}},inputs:function(b,c){return function(d,e,f,g){return g?g[c]:b(d,e,f)}}};var yd=function(b,c,d){this.lexer=b;this.$filter=c;this.options=d;this.ast=new S(b,d);this.astCompiler=
d.csp?new Wc(this.ast,c):new Vc(this.ast,c)};yd.prototype={constructor:yd,parse:function(b){return this.astCompiler.compile(b,this.options.expensiveChecks)}};var Qf=Object.prototype.valueOf,Zb=c("$sce"),Eb={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},Rf=c("$compile"),Ua=b.document.createElement("a"),de=wb(b.location.href);$c.$inject=["$document"];Bd.$inject=["$provide"];var fe=22,ee=".",zd="0";Cd.$inject=["$locale"];Dd.$inject=["$locale"];var Wf={yyyy:Oa("FullYear",4,0,!1,
!0),yy:Oa("FullYear",2,0,!0,!0),y:Oa("FullYear",1,0,!1,!0),MMMM:uc("Month"),MMM:uc("Month",!0),MM:Oa("Month",2,1),M:Oa("Month",1,1),LLLL:uc("Month",!1,!0),dd:Oa("Date",2),d:Oa("Date",1),HH:Oa("Hours",2),H:Oa("Hours",1),hh:Oa("Hours",2,-12),h:Oa("Hours",1,-12),mm:Oa("Minutes",2),m:Oa("Minutes",1),ss:Oa("Seconds",2),s:Oa("Seconds",1),sss:Oa("Milliseconds",3),EEEE:uc("Day"),EEE:uc("Day",!0),a:function(b,c){return 12>b.getHours()?c.AMPMS[0]:c.AMPMS[1]},Z:function(b,c,d){b=-1*d;return(0<=b?"+":"")+(jc(Math[0<
b?"floor":"ceil"](b/60),2)+jc(Math.abs(b%60),2))},ww:Gd(2),w:Gd(1),G:kd,GG:kd,GGG:kd,GGGG:function(b,c){return 0>=b.getFullYear()?c.ERANAMES[0]:c.ERANAMES[1]}},Vf=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,Uf=/^\-?\d+$/;Od.$inject=["$locale"];var Sf=p(wa),Tf=p(Oc);Md.$inject=["$parse"];var Ye=p({restrict:"E",compile:function(b,c){if(!c.href&&!c.xlinkHref)return function(b,c){if("a"===c[0].nodeName.toLowerCase()){var d="[object SVGAnimatedString]"===
ab.call(c.prop("href"))?"xlink:href":"href";c.on("click",function(b){c.attr(d)||b.preventDefault()})}}}}),ad={};e(Lc,function(b,c){function d(b,f,g){b.$watch(g[e],function(b){g.$set(c,!!b)})}if("multiple"!=b){var e=Ha("ng-"+c),f=d;"checked"===b&&(f=function(b,c,f){f.ngModel!==f[e]&&d(b,c,f)});ad[e]=function(){return{restrict:"A",priority:100,link:f}}}});e(Id,function(b,c){ad[c]=function(){return{priority:100,link:function(b,d,e){"ngPattern"===c&&"/"==e.ngPattern.charAt(0)&&(d=e.ngPattern.match(Me))?
e.$set("ngPattern",RegExp(d[1],d[2])):b.$watch(e[c],function(b){e.$set(c,b)})}}}});e(["src","srcset","href"],function(b){var c=Ha("ng-"+b);ad[c]=function(){return{priority:99,link:function(d,e,f){var g=b,h=b;"href"===b&&"[object SVGAnimatedString]"===ab.call(e.prop("href"))&&(h="xlinkHref",f.$attr[h]="xlink:href",g=null);f.$observe(c,function(c){c?(f.$set(h,c),Qb&&g&&e.prop(g,f[h])):"href"===b&&f.$set(h,null)})}}}});var cd={$addControl:n,$$renameControl:function(b,c){b.$name=c},$removeControl:n,$setValidity:n,
$setDirty:n,$setPristine:n,$setSubmitted:n};Rd.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var je=function(b){return["$timeout","$parse",function(c,d){function e(b){return""===b?d('this[""]').assign:d(b).assign||n}return{name:"form",restrict:b?"EAC":"E",require:["form","^^?form"],controller:Rd,compile:function(d,f){d.addClass(tc).addClass(Kc);var g=f.name?"name":b&&f.ngForm?"ngForm":!1;return{pre:function(b,d,f,h){var j=h[0];if(!("action"in f)){var l=function(c){b.$apply(function(){j.$commitViewValue();
j.$setSubmitted()});c.preventDefault()};d[0].addEventListener("submit",l,!1);d.on("$destroy",function(){c(function(){d[0].removeEventListener("submit",l,!1)},0,!1)})}(h[1]||j.$$parentForm).$addControl(j);var o=g?e(j.$name):n;g&&(o(b,j),f.$observe(g,function(c){j.$name!==c&&(o(b,void 0),j.$$parentForm.$$renameControl(j,c),o=e(j.$name),o(b,j))}));d.on("$destroy",function(){j.$$parentForm.$removeControl(j);o(b,void 0);k(j,cd)})}}}}}]},Ze=je(),mf=je(!0),Xf=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,
bg=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,cg=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,dg=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,ke=/^(\d{4,})-(\d{2})-(\d{2})$/,le=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Ad=/^(\d{4,})-W(\d\d)$/,me=/^(\d{4,})-(\d\d)$/,ne=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,ge=W();e(["date","datetime-local",
"month","time","week"],function(b){ge[b]=!0});var oe={text:function(b,c,d,e,f,g){xc(b,c,d,e,f,g);md(e)},date:zc("date",ke,Nc(ke,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":zc("datetimelocal",le,Nc(le,"yyyy MM dd HH mm ss sss".split(" ")),"yyyy-MM-ddTHH:mm:ss.sss"),time:zc("time",ne,Nc(ne,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:zc("week",Ad,function(b,c){if(z(b))return b;if(u(b)){Ad.lastIndex=0;var d=Ad.exec(b);if(d){var e=+d[1],f=+d[2],g=d=0,h=0,j=0,k=Fd(e),f=7*(f-1);c&&(d=c.getHours(),
g=c.getMinutes(),h=c.getSeconds(),j=c.getMilliseconds());return new Date(e,0,k.getDate()+f,d,g,h,j)}}return NaN},"yyyy-Www"),month:zc("month",me,Nc(me,["yyyy","MM"]),"yyyy-MM"),number:function(b,c,d,e,f,g){Pd(b,c,d,e);xc(b,c,d,e,f,g);e.$$parserName="number";e.$parsers.push(function(b){if(e.$isEmpty(b))return null;if(dg.test(b))return parseFloat(b)});e.$formatters.push(function(b){if(!e.$isEmpty(b)){if(!w(b))throw Jc("numfmt",b);b=b.toString()}return b});if(r(d.min)||d.ngMin){var h;e.$validators.min=
function(b){return e.$isEmpty(b)||s(h)||b>=h};d.$observe("min",function(b){r(b)&&!w(b)&&(b=parseFloat(b,10));h=w(b)&&!isNaN(b)?b:void 0;e.$validate()})}if(r(d.max)||d.ngMax){var j;e.$validators.max=function(b){return e.$isEmpty(b)||s(j)||b<=j};d.$observe("max",function(b){r(b)&&!w(b)&&(b=parseFloat(b,10));j=w(b)&&!isNaN(b)?b:void 0;e.$validate()})}},url:function(b,c,d,e,f,g){xc(b,c,d,e,f,g);md(e);e.$$parserName="url";e.$validators.url=function(b,c){var d=b||c;return e.$isEmpty(d)||bg.test(d)}},email:function(b,
c,d,e,f,g){xc(b,c,d,e,f,g);md(e);e.$$parserName="email";e.$validators.email=function(b,c){var d=b||c;return e.$isEmpty(d)||cg.test(d)}},radio:function(b,c,d,e){s(d.name)&&c.attr("name",++Pc);c.on("click",function(b){c[0].checked&&e.$setViewValue(d.value,b&&b.type)});e.$render=function(){c[0].checked=d.value==e.$viewValue};d.$observe("value",e.$render)},checkbox:function(b,c,d,e,f,g,h,j){var k=Sd(j,b,"ngTrueValue",d.ngTrueValue,!0),l=Sd(j,b,"ngFalseValue",d.ngFalseValue,!1);c.on("click",function(b){e.$setViewValue(c[0].checked,
b&&b.type)});e.$render=function(){c[0].checked=e.$viewValue};e.$isEmpty=function(b){return!1===b};e.$formatters.push(function(b){return N(b,k)});e.$parsers.push(function(b){return b?k:l})},hidden:n,button:n,submit:n,reset:n,file:n},Vd=["$browser","$sniffer","$filter","$parse",function(b,c,d,e){return{restrict:"E",require:["?ngModel"],link:{pre:function(f,g,h,j){j[0]&&(oe[wa(h.type)]||oe.text)(f,g,h,j[0],c,b,d,e)}}}}],eg=/^(true|false|\d+)$/,Ef=function(){return{restrict:"A",priority:100,compile:function(b,
c){return eg.test(c.ngValue)?function(b,c,d){d.$set("value",b.$eval(d.ngValue))}:function(b,c,d){b.$watch(d.ngValue,function(b){d.$set("value",b)})}}}},df=["$compile",function(b){return{restrict:"AC",compile:function(c){b.$$addBindingClass(c);return function(c,d,e){b.$$addBindingInfo(d,e.ngBind);d=d[0];c.$watch(e.ngBind,function(b){d.textContent=s(b)?"":b})}}}}],ff=["$interpolate","$compile",function(b,c){return{compile:function(d){c.$$addBindingClass(d);return function(d,e,f){d=b(e.attr(f.$attr.ngBindTemplate));
c.$$addBindingInfo(e,d.expressions);e=e[0];f.$observe("ngBindTemplate",function(b){e.textContent=s(b)?"":b})}}}}],ef=["$sce","$parse","$compile",function(b,c,d){return{restrict:"A",compile:function(e,f){var g=c(f.ngBindHtml),h=c(f.ngBindHtml,function(b){return(b||"").toString()});d.$$addBindingClass(e);return function(c,e,f){d.$$addBindingInfo(e,f.ngBindHtml);c.$watch(h,function(){e.html(b.getTrustedHtml(g(c))||"")})}}}}],Df=p({restrict:"A",require:"ngModel",link:function(b,c,d,e){e.$viewChangeListeners.push(function(){b.$eval(d.ngChange)})}}),
gf=nd("",!0),jf=nd("Odd",0),hf=nd("Even",1),kf=ec({compile:function(b,c){c.$set("ngCloak",void 0);b.removeClass("ng-cloak")}}),lf=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],$d={},fg={blur:!0,focus:!0};e("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(b){var c=Ha("ng-"+b);$d[c]=["$parse","$rootScope",function(d,e){return{restrict:"A",compile:function(f,g){var h=
d(g[c],null,true);return function(c,d){d.on(b,function(d){var f=function(){h(c,{$event:d})};fg[b]&&e.$$phase?c.$evalAsync(f):c.$apply(f)})}}}}]});var of=["$animate","$compile",function(b,c){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(d,e,f,g,h){var j,k,l;d.$watch(f.ngIf,function(d){d?k||h(function(d,g){k=g;d[d.length++]=c.$$createComment("end ngIf",f.ngIf);j={clone:d};b.enter(d,e.parent(),e)}):(l&&(l.remove(),l=null),k&&(k.$destroy(),k=
null),j&&(l=L(j.clone),b.leave(l).then(function(){l=null}),j=null))})}}}],pf=["$templateRequest","$anchorScroll","$animate",function(b,c,d){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:mb.noop,compile:function(e,f){var g=f.ngInclude||f.src,h=f.onload||"",j=f.autoscroll;return function(e,f,k,l,o){var m=0,n,s,u,p=function(){s&&(s.remove(),s=null);n&&(n.$destroy(),n=null);u&&(d.leave(u).then(function(){s=null}),s=u,u=null)};e.$watch(g,function(g){var k=function(){!r(j)||
j&&!e.$eval(j)||c()},s=++m;g?(b(g,!0).then(function(b){if(!e.$$destroyed&&s===m){var c=e.$new();l.template=b;b=o(c,function(b){p();d.enter(b,null,f).then(k)});n=c;u=b;n.$emit("$includeContentLoaded",g);e.$eval(h)}},function(){e.$$destroyed||s!==m||(p(),e.$emit("$includeContentError",g))}),e.$emit("$includeContentRequested",g)):(p(),l.template=null)})}}}}],Gf=["$compile",function(c){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(d,e,f,g){ab.call(e[0]).match(/SVG/)?(e.empty(),
c(tb(g.template,b.document).childNodes)(d,function(b){e.append(b)},{futureParentElement:e})):(e.html(g.template),c(e.contents())(d))}}}],qf=ec({priority:450,compile:function(){return{pre:function(b,c,d){b.$eval(d.ngInit)}}}}),Cf=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(b,c,d,f){var g=c.attr(d.$attr.ngList)||", ",h="false"!==d.ngTrim,j=h?ya(g):g;f.$parsers.push(function(b){if(!s(b)){var c=[];b&&e(b.split(j),function(b){b&&c.push(h?ya(b):b)});return c}});f.$formatters.push(function(b){if(ia(b))return b.join(g)});
f.$isEmpty=function(b){return!b||!b.length}}}},Kc="ng-valid",he="ng-invalid",tc="ng-pristine",dd="ng-dirty",ie="ng-pending",Jc=c("ngModel"),gg=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(b,c,d,f,g,h,j,k,l,o){this.$modelValue=this.$viewValue=Number.NaN;this.$$rawModelValue=void 0;this.$validators={};this.$asyncValidators={};this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$untouched=!0;this.$touched=
!1;this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$error={};this.$$success={};this.$pending=void 0;this.$name=o(d.name||"",!1)(b);this.$$parentForm=cd;var m=g(d.ngModel),u=m.assign,p=m,t=u,q=null,L,B=this;this.$$setOptions=function(b){if((B.$options=b)&&b.getterSetter){var c=g(d.ngModel+"()"),e=g(d.ngModel+"($$$p)");p=function(b){var d=m(b);A(d)&&(d=c(b));return d};t=function(b,c){A(m(b))?e(b,{$$$p:c}):u(b,c)}}else if(!m.assign)throw Jc("nonassign",d.ngModel,M(f));};this.$render=
n;this.$isEmpty=function(b){return s(b)||""===b||null===b||b!==b};this.$$updateEmptyClasses=function(b){B.$isEmpty(b)?(h.removeClass(f,"ng-not-empty"),h.addClass(f,"ng-empty")):(h.removeClass(f,"ng-empty"),h.addClass(f,"ng-not-empty"))};var D=0;Kd({ctrl:this,$element:f,set:function(b,c){b[c]=!0},unset:function(b,c){delete b[c]},$animate:h});this.$setPristine=function(){B.$dirty=!1;B.$pristine=!0;h.removeClass(f,dd);h.addClass(f,tc)};this.$setDirty=function(){B.$dirty=!0;B.$pristine=!1;h.removeClass(f,
tc);h.addClass(f,dd);B.$$parentForm.$setDirty()};this.$setUntouched=function(){B.$touched=!1;B.$untouched=!0;h.setClass(f,"ng-untouched","ng-touched")};this.$setTouched=function(){B.$touched=!0;B.$untouched=!1;h.setClass(f,"ng-touched","ng-untouched")};this.$rollbackViewValue=function(){j.cancel(q);B.$viewValue=B.$$lastCommittedViewValue;B.$render()};this.$validate=function(){if(!w(B.$modelValue)||!isNaN(B.$modelValue)){var b=B.$$rawModelValue,c=B.$valid,d=B.$modelValue,e=B.$options&&B.$options.allowInvalid;
B.$$runValidators(b,B.$$lastCommittedViewValue,function(f){e||c===f||(B.$modelValue=f?b:void 0,B.$modelValue!==d&&B.$$writeModelToScope())})}};this.$$runValidators=function(b,c,d){function f(){var d=!0;e(B.$validators,function(e,f){var g=e(b,c);d=d&&g;h(f,g)});return d?!0:(e(B.$asyncValidators,function(b,c){h(c,null)}),!1)}function g(){var d=[],f=!0;e(B.$asyncValidators,function(e,g){var j=e(b,c);if(!j||!A(j.then))throw Jc("nopromise",j);h(g,void 0);d.push(j.then(function(){h(g,!0)},function(){f=
!1;h(g,!1)}))});d.length?l.all(d).then(function(){j(f)},n):j(!0)}function h(b,c){k===D&&B.$setValidity(b,c)}function j(b){k===D&&d(b)}D++;var k=D;(function(){var b=B.$$parserName||"parse";if(s(L))h(b,null);else return L||(e(B.$validators,function(b,c){h(c,null)}),e(B.$asyncValidators,function(b,c){h(c,null)})),h(b,L),L;return!0})()?f()?g():j(!1):j(!1)};this.$commitViewValue=function(){var b=B.$viewValue;j.cancel(q);if(B.$$lastCommittedViewValue!==b||""===b&&B.$$hasNativeValidators)B.$$updateEmptyClasses(b),
B.$$lastCommittedViewValue=b,B.$pristine&&this.$setDirty(),this.$$parseAndValidate()};this.$$parseAndValidate=function(){var c=B.$$lastCommittedViewValue;if(L=s(c)?void 0:!0)for(var d=0;d<B.$parsers.length;d++)if(c=B.$parsers[d](c),s(c)){L=!1;break}w(B.$modelValue)&&isNaN(B.$modelValue)&&(B.$modelValue=p(b));var e=B.$modelValue,f=B.$options&&B.$options.allowInvalid;B.$$rawModelValue=c;f&&(B.$modelValue=c,B.$modelValue!==e&&B.$$writeModelToScope());B.$$runValidators(c,B.$$lastCommittedViewValue,function(b){f||
(B.$modelValue=b?c:void 0,B.$modelValue!==e&&B.$$writeModelToScope())})};this.$$writeModelToScope=function(){t(b,B.$modelValue);e(B.$viewChangeListeners,function(b){try{b()}catch(d){c(d)}})};this.$setViewValue=function(b,c){B.$viewValue=b;B.$options&&!B.$options.updateOnDefault||B.$$debounceViewValueCommit(c)};this.$$debounceViewValueCommit=function(c){var d=0,e=B.$options;e&&r(e.debounce)&&(e=e.debounce,w(e)?d=e:w(e[c])?d=e[c]:w(e["default"])&&(d=e["default"]));j.cancel(q);d?q=j(function(){B.$commitViewValue()},
d):k.$$phase?B.$commitViewValue():b.$apply(function(){B.$commitViewValue()})};b.$watch(function(){var c=p(b);if(c!==B.$modelValue&&(B.$modelValue===B.$modelValue||c===c)){B.$modelValue=B.$$rawModelValue=c;L=void 0;for(var d=B.$formatters,e=d.length,f=c;e--;)f=d[e](f);B.$viewValue!==f&&(B.$$updateEmptyClasses(f),B.$viewValue=B.$$lastCommittedViewValue=f,B.$render(),B.$$runValidators(c,f,n))}return c})}],Bf=["$rootScope",function(b){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],
controller:gg,priority:1,compile:function(c){c.addClass(tc).addClass("ng-untouched").addClass(Kc);return{pre:function(b,c,d,e){var f=e[0],c=e[1]||f.$$parentForm;f.$$setOptions(e[2]&&e[2].$options);c.$addControl(f);d.$observe("name",function(b){f.$name!==b&&f.$$parentForm.$$renameControl(f,b)});b.$on("$destroy",function(){f.$$parentForm.$removeControl(f)})},post:function(c,d,e,f){var g=f[0];if(g.$options&&g.$options.updateOn)d.on(g.$options.updateOn,function(b){g.$$debounceViewValueCommit(b&&b.type)});
d.on("blur",function(){g.$touched||(b.$$phase?c.$evalAsync(g.$setTouched):c.$apply(g.$setTouched))})}}}}}],hg=/(\s+|^)default(\s+|$)/,Ff=function(){return{restrict:"A",controller:["$scope","$attrs",function(b,c){var d=this;this.$options=I(b.$eval(c.ngModelOptions));r(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=ya(this.$options.updateOn.replace(hg,function(){d.$options.updateOnDefault=!0;return" "}))):this.$options.updateOnDefault=!0}]}},rf=ec({terminal:!0,priority:1E3}),
ig=c("ngOptions"),jg=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,zf=["$compile","$document","$parse",function(c,f,g){function h(b,c,e){function f(b,c,d,e,g){this.selectValue=b;this.viewValue=c;this.label=d;this.group=e;this.disabled=g}function j(b){var c;if(!o&&d(b))c=b;else{c=[];for(var e in b)b.hasOwnProperty(e)&&
"$"!==e.charAt(0)&&c.push(e)}return c}var k=b.match(jg);if(!k)throw ig("iexp",b,M(c));var l=k[5]||k[7],o=k[6],b=/ as /.test(k[0])&&k[1],m=k[9],c=g(k[2]?k[1]:l),n=b&&g(b)||c,s=m&&g(m),u=m?function(b,c){return s(e,c)}:function(b){return za(b)},p=function(b,c){return u(b,B(b,c))},t=g(k[2]||k[1]),q=g(k[3]||""),r=g(k[4]||""),L=g(k[8]),w={},B=o?function(b,c){w[o]=c;w[l]=b;return w}:function(b){w[l]=b;return w};return{trackBy:m,getTrackByValue:p,getWatchables:g(L,function(b){for(var c=[],b=b||[],d=j(b),
f=d.length,g=0;g<f;g++){var h=b===d?g:d[g],l=b[h],h=B(l,h),l=u(l,h);c.push(l);if(k[2]||k[1])l=t(e,h),c.push(l);k[4]&&(h=r(e,h),c.push(h))}return c}),getOptions:function(){for(var b=[],c={},d=L(e)||[],g=j(d),h=g.length,k=0;k<h;k++){var l=d===g?k:g[k],o=B(d[l],l),s=n(e,o),l=u(s,o),w=t(e,o),D=q(e,o),o=r(e,o),s=new f(l,s,w,D,o);b.push(s);c[l]=s}return{items:b,selectValueMap:c,getOptionFromViewValue:function(b){return c[p(b)]},getViewValueFromOption:function(b){return m?mb.copy(b.viewValue):b.viewValue}}}}}
var j=b.document.createElement("option"),k=b.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(b,c,d,e){e[0].registerOption=n},post:function(b,d,g,l){function o(){var b=w&&m.readValue();if(w)for(var c=w.items.length-1;0<=c;c--){var e=w.items[c];e.group?Ia(e.element.parentNode):Ia(e.element)}w=B.getOptions();var f={};q&&d.prepend(u);w.items.forEach(function(b){var c;if(r(b.group)){(c=f[b.group])||(c=k.cloneNode(!1),D.appendChild(c),c.label=
b.group,f[b.group]=c);var d=j.cloneNode(!1)}else c=D,d=j.cloneNode(!1);c.appendChild(d);c=d;b.element=c;c.disabled=b.disabled;b.label!==c.label&&(c.label=b.label,c.textContent=b.label);b.value!==c.value&&(c.value=b.selectValue)});d[0].appendChild(D);n.$render();n.$isEmpty(b)||(c=m.readValue(),(B.trackBy||s?N(b,c):b===c)||(n.$setViewValue(c),n.$render()))}for(var m=l[0],n=l[1],s=g.multiple,u,l=0,p=d.children(),t=p.length;l<t;l++)if(""===p[l].value){u=p.eq(l);break}var q=!!u,L=ca(j.cloneNode(!1));L.val("?");
var w,B=h(g.ngOptions,d,b),D=f[0].createDocumentFragment();s?(n.$isEmpty=function(b){return!b||0===b.length},m.writeValue=function(b){w.items.forEach(function(b){b.element.selected=!1});b&&b.forEach(function(b){if(b=w.getOptionFromViewValue(b))b.element.selected=!0})},m.readValue=function(){var b=d.val()||[],c=[];e(b,function(b){(b=w.selectValueMap[b])&&!b.disabled&&c.push(w.getViewValueFromOption(b))});return c},B.trackBy&&b.$watchCollection(function(){if(ia(n.$viewValue))return n.$viewValue.map(function(b){return B.getTrackByValue(b)})},
function(){n.$render()})):(m.writeValue=function(b){var c=w.getOptionFromViewValue(b);c?(d[0].value!==c.selectValue&&(L.remove(),q||u.remove(),d[0].value=c.selectValue,c.element.selected=!0),c.element.setAttribute("selected","selected")):null===b||q?(L.remove(),q||d.prepend(u),d.val(""),u.prop("selected",!0),u.attr("selected",!0)):(q||u.remove(),d.prepend(L),d.val("?"),L.prop("selected",!0),L.attr("selected",!0))},m.readValue=function(){var b=w.selectValueMap[d.val()];return b&&!b.disabled?(q||u.remove(),
L.remove(),w.getViewValueFromOption(b)):null},B.trackBy&&b.$watch(function(){return B.getTrackByValue(n.$viewValue)},function(){n.$render()}));q?(u.remove(),c(u)(b),u.removeClass("ng-scope")):u=ca(j.cloneNode(!1));d.empty();o();b.$watchCollection(B.getWatchables,o)}}}}],sf=["$locale","$interpolate","$log",function(b,c,d){var f=/{}/g,g=/^when(Minus)?(.+)$/;return{link:function(h,j,k){function l(b){j.text(b||"")}var o=k.count,m=k.$attr.when&&j.attr(k.$attr.when),u=k.offset||0,p=h.$eval(m)||{},t={},
q=c.startSymbol(),r=c.endSymbol(),L=q+o+"-"+u+r,B=mb.noop,D;e(k,function(b,c){var d=g.exec(c);d&&(d=(d[1]?"-":"")+wa(d[2]),p[d]=j.attr(k.$attr[c]))});e(p,function(b,d){t[d]=c(b.replace(f,L))});h.$watch(o,function(c){var e=parseFloat(c),f=isNaN(e);f||e in p||(e=b.pluralCat(e-u));e===D||f&&w(D)&&isNaN(D)||(B(),f=t[e],s(f)?(null!=c&&d.debug("ngPluralize: no rule defined for '"+e+"' in "+m),B=n,l()):B=h.$watch(f,l),D=e)})}}}],tf=["$parse","$animate","$compile",function(b,f,g){var h=c("ngRepeat"),j=function(b,
c,d,e,f,g,h){b[d]=e;f&&(b[f]=g);b.$index=c;b.$first=0===c;b.$last=c===h-1;b.$middle=!(b.$first||b.$last);b.$odd=!(b.$even=0===(c&1))};return{restrict:"A",multiElement:!0,transclude:"element",priority:1E3,terminal:!0,$$tlb:!0,compile:function(c,k){var l=k.ngRepeat,o=g.$$createComment("end ngRepeat",l),m=l.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!m)throw h("iexp",l);var n=m[1],s=m[2],u=m[3],p=m[4],m=n.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/);
if(!m)throw h("iidexp",n);var t=m[3]||m[1],q=m[2];if(u&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(u)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(u)))throw h("badident",u);var r,w,B,D,z={$id:za};p?r=b(p):(B=function(b,c){return za(c)},D=function(b){return b});return function(b,c,g,k,m){r&&(w=function(c,d,e){q&&(z[q]=c);z[t]=d;z.$index=e;return r(b,z)});var n=W();b.$watchCollection(s,function(g){var k,s,p=c[0],r,z=W(),A,O,v,E,x,M,F;u&&(b[u]=g);if(d(g))x=
g,s=w||B;else for(F in s=w||D,x=[],g)Gb.call(g,F)&&"$"!==F.charAt(0)&&x.push(F);A=x.length;F=Array(A);for(k=0;k<A;k++)if(O=g===x?k:x[k],v=g[O],E=s(O,v,k),n[E])M=n[E],delete n[E],z[E]=M,F[k]=M;else{if(z[E])throw e(F,function(b){b&&b.scope&&(n[b.id]=b)}),h("dupes",l,E,v);F[k]={id:E,scope:void 0,clone:void 0};z[E]=!0}for(r in n){M=n[r];E=L(M.clone);f.leave(E);if(E[0].parentNode){k=0;for(s=E.length;k<s;k++)E[k].$$NG_REMOVED=!0}M.scope.$destroy()}for(k=0;k<A;k++)if(O=g===x?k:x[k],v=g[O],M=F[k],M.scope){r=
p;do r=r.nextSibling;while(r&&r.$$NG_REMOVED);M.clone[0]!=r&&f.move(L(M.clone),null,p);p=M.clone[M.clone.length-1];j(M.scope,k,t,v,q,O,A)}else m(function(b,c){M.scope=c;var d=o.cloneNode(!1);b[b.length++]=d;f.enter(b,null,p);p=d;M.clone=b;z[M.id]=M;j(M.scope,k,t,v,q,O,A)});n=z})}}}}],uf=["$animate",function(b){return{restrict:"A",multiElement:!0,link:function(c,d,e){c.$watch(e.ngShow,function(c){b[c?"removeClass":"addClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],nf=["$animate",function(b){return{restrict:"A",
multiElement:!0,link:function(c,d,e){c.$watch(e.ngHide,function(c){b[c?"addClass":"removeClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],vf=ec(function(b,c,d){b.$watch(d.ngStyle,function(b,d){d&&b!==d&&e(d,function(b,d){c.css(d,"")});b&&c.css(b)},!0)}),wf=["$animate","$compile",function(b,c){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(d,f,g,h){var j=[],k=[],l=[],o=[],m=function(b,c){return function(){b.splice(c,1)}};d.$watch(g.ngSwitch||g.on,
function(d){var f,g;f=0;for(g=l.length;f<g;++f)b.cancel(l[f]);f=l.length=0;for(g=o.length;f<g;++f){var n=L(k[f].clone);o[f].$destroy();(l[f]=b.leave(n)).then(m(l,f))}k.length=0;o.length=0;(j=h.cases["!"+d]||h.cases["?"])&&e(j,function(d){d.transclude(function(e,f){o.push(f);var g=d.element;e[e.length++]=c.$$createComment("end ngSwitchWhen");k.push({clone:e});b.enter(e,g.parent(),g)})})})}}}],xf=ec({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(b,c,d,e,f){e.cases["!"+
d.ngSwitchWhen]=e.cases["!"+d.ngSwitchWhen]||[];e.cases["!"+d.ngSwitchWhen].push({transclude:f,element:c})}}),yf=ec({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(b,c,d,e,f){e.cases["?"]=e.cases["?"]||[];e.cases["?"].push({transclude:f,element:c})}}),kg=c("ngTransclude"),Af=ec({restrict:"EAC",link:function(b,c,d,e,f){d.ngTransclude===d.$attr.ngTransclude&&(d.ngTransclude="");if(!f)throw kg("orphan",M(c));f(function(b){b.length&&(c.empty(),c.append(b))},null,
d.ngTransclude||d.ngTranscludeSlot)}}),$e=["$templateCache",function(b){return{restrict:"E",terminal:!0,compile:function(c,d){"text/ng-template"==d.type&&b.put(d.id,c[0].text)}}}],lg={$setViewValue:n,$render:n},mg=["$element","$scope",function(c,d){var e=this,f=new ua;e.ngModelCtrl=lg;e.unknownOption=ca(b.document.createElement("option"));e.renderUnknownOption=function(b){b="? "+za(b)+" ?";e.unknownOption.val(b);c.prepend(e.unknownOption);c.val(b)};d.$on("$destroy",function(){e.renderUnknownOption=
n});e.removeUnknownOption=function(){e.unknownOption.parent()&&e.unknownOption.remove()};e.readValue=function(){e.removeUnknownOption();return c.val()};e.writeValue=function(b){e.hasOption(b)?(e.removeUnknownOption(),c.val(b),""===b&&e.emptyOption.prop("selected",!0)):null==b&&e.emptyOption?(e.removeUnknownOption(),c.val("")):e.renderUnknownOption(b)};e.addOption=function(b,c){if(8!==c[0].nodeType){sa(b,'"option value"');""===b&&(e.emptyOption=c);var d=f.get(b)||0;f.put(b,d+1);e.ngModelCtrl.$render();
c[0].hasAttribute("selected")&&(c[0].selected=!0)}};e.removeOption=function(b){var c=f.get(b);c&&(1===c?(f.remove(b),""===b&&(e.emptyOption=void 0)):f.put(b,c-1))};e.hasOption=function(b){return!!f.get(b)};e.registerOption=function(b,c,d,f,g){if(f){var h;d.$observe("value",function(b){r(h)&&e.removeOption(h);h=b;e.addOption(b,c)})}else g?b.$watch(g,function(b,f){d.$set("value",b);f!==b&&e.removeOption(f);e.addOption(b,c)}):e.addOption(d.value,c);c.on("$destroy",function(){e.removeOption(d.value);
e.ngModelCtrl.$render()})}}],af=function(){return{restrict:"E",require:["select","?ngModel"],controller:mg,priority:1,link:{pre:function(b,c,d,f){var g=f[1];if(g){var h=f[0];h.ngModelCtrl=g;c.on("change",function(){b.$apply(function(){g.$setViewValue(h.readValue())})});if(d.multiple){h.readValue=function(){var b=[];e(c.find("option"),function(c){c.selected&&b.push(c.value)});return b};h.writeValue=function(b){var d=new ua(b);e(c.find("option"),function(b){b.selected=r(d.get(b.value))})};var j,k=NaN;
b.$watch(function(){k!==g.$viewValue||N(j,g.$viewValue)||(j=J(g.$viewValue),g.$render());k=g.$viewValue});g.$isEmpty=function(b){return!b||0===b.length}}}},post:function(b,c,d,e){var f=e[1];if(f){var g=e[0];f.$render=function(){g.writeValue(f.$viewValue)}}}}}},cf=["$interpolate",function(b){return{restrict:"E",priority:100,compile:function(c,d){if(r(d.value))var e=b(d.value,!0);else{var f=b(c.text(),!0);f||d.$set("value",c.text())}return function(b,c,d){var g=c.parent();(g=g.data("$selectController")||
g.parent().data("$selectController"))&&g.registerOption(b,c,d,e,f)}}}}],bf=p({restrict:"E",terminal:!1}),Xd=function(){return{restrict:"A",require:"?ngModel",link:function(b,c,d,e){e&&(d.required=!0,e.$validators.required=function(b,c){return!d.required||!e.$isEmpty(c)},d.$observe("required",function(){e.$validate()}))}}},Wd=function(){return{restrict:"A",require:"?ngModel",link:function(b,d,e,f){if(f){var g,h=e.ngPattern||e.pattern;e.$observe("pattern",function(b){u(b)&&0<b.length&&(b=RegExp("^"+
b+"$"));if(b&&!b.test)throw c("ngPattern")("noregexp",h,b,M(d));g=b||void 0;f.$validate()});f.$validators.pattern=function(b,c){return f.$isEmpty(c)||s(g)||g.test(c)}}}}},Zd=function(){return{restrict:"A",require:"?ngModel",link:function(b,c,d,e){if(e){var f=-1;d.$observe("maxlength",function(b){b=m(b);f=isNaN(b)?-1:b;e.$validate()});e.$validators.maxlength=function(b,c){return 0>f||e.$isEmpty(c)||c.length<=f}}}}},Yd=function(){return{restrict:"A",require:"?ngModel",link:function(b,c,d,e){if(e){var f=
0;d.$observe("minlength",function(b){f=m(b)||0;e.$validate()});e.$validators.minlength=function(b,c){return e.$isEmpty(c)||c.length>=f}}}}};b.angular.bootstrap?b.console&&console.log("WARNING: Tried to load angular more than once."):(V(),R(mb),mb.module("ngLocale",[],["$provide",function(b){function c(b){var b=b+"",d=b.indexOf(".");return-1==d?0:b.length-d-1}b.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ERANAMES:["Before Christ",
"Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:"January February March April May June July August September October November December".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),STANDALONEMONTH:"January February March April May June July August September October November December".split(" "),WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",
mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-\u00a4",negSuf:"",posPre:"\u00a4",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(b,d){var e=b|0,f=d;void 0===f&&(f=Math.min(c(b),3));Math.pow(10,f);return 1==e&&0==f?"one":"other"}})}]),
ca(b.document).ready(function(){x(b.document,ja)}))})(window);!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>');
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router");
(function(b,c,d){function e(b,c){return X(new (X(function(){},{prototype:b})),c)}function f(b){return M(arguments,function(c){c!==b&&M(c,function(c,d){b.hasOwnProperty(d)||(b[d]=c)})}),b}function g(b){if(Object.keys)return Object.keys(b);var c=[];return M(b,function(b,d){c.push(d)}),c}function h(b,c,d){if(Array.prototype.indexOf)return b.indexOf(c,Number(d)||0);var e=b.length>>>0,d=Number(d)||0,d=0>d?Math.ceil(d):Math.floor(d);for(0>d&&(d+=e);e>d;d++)if(d in b&&b[d]===c)return d;return-1}function j(b,
c,d,e){var f,j=[],k;for(k in d.path){if(d.path[k]!==e.path[k])break;j.push(d.path[k])}var d={},e=[],l;for(l in j)if(j[l]&&j[l].params&&(f=g(j[l].params),f.length))for(var o in f)0<=h(e,f[o])||(e.push(f[o]),d[f[o]]=b[f[o]]);return X({},d,c)}function k(b,c,d){if(!d){var d=[],e;for(e in b)d.push(e)}for(e=0;e<d.length;e++){var f=d[e];if(b[f]!=c[f])return!1}return!0}function l(b,c){var d={};return M(b,function(b){d[b]=c[b]}),d}function m(b){var c={},d=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,
1));return M(d,function(d){d in b&&(c[d]=b[d])}),c}function n(b){var c={},d=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1)),e;for(e in b)-1==h(d,e)&&(c[e]=b[e]);return c}function q(b,c){var d=O(b),e=d?[]:{};return M(b,function(b,f){c(b,f)&&(e[d?e.length:f]=b)}),e}function p(b,c){var d=O(b)?[]:{};return M(b,function(b,e){d[e]=c(b,e)}),d}function s(b,c){var e=1,j=2,k={},l=[],o=X(b.when(k),{$$promises:k,$$values:k});this.study=function(m){function s(b,d){if(q[d]!==
j){if(t.push(d),q[d]===e)throw t.splice(0,h(t,d)),Error("Cyclic dependency: "+t.join(" -> "));if(q[d]=e,E(b))p.push(d,[function(){return c.get(b)}],l);else{var f=c.annotate(b);M(f,function(b){b!==d&&m.hasOwnProperty(b)&&s(m[b],b)});p.push(d,b,f)}t.pop();q[d]=j}}if(!Z(m))throw Error("'invocables' must be an object");var u=g(m||{}),p=[],t=[],q={};return M(m,s),m=t=q=null,function(e,g,h){function j(){--L||(w||f(r,g.$$values),t.$$values=r,t.$$promises=t.$$promises||!0,delete t.$$inheritedValues,s.resolve(r))}
function l(b){t.$$failure=b;s.reject(b)}function m(d,f,g){function k(b){n.reject(b);l(b)}function o(){if(!Q(t.$$failure))try{n.resolve(c.invoke(f,h,r)),n.promise.then(function(b){r[d]=b;j()},k)}catch(b){k(b)}}var n=b.defer(),s=0;M(g,function(b){q.hasOwnProperty(b)&&!e.hasOwnProperty(b)&&(s++,q[b].then(function(c){r[b]=c;--s||o()},k))});s||o();q[d]=n.promise}if(Z(e)&&e.then&&e.$$promises&&h===d&&(h=g,g=e,e=null),e){if(!Z(e))throw Error("'locals' must be an object");}else e=k;if(g){if(!Z(g)||!g.then||
!g.$$promises)throw Error("'parent' must be a promise returned by $resolve.resolve()");}else g=o;var s=b.defer(),t=s.promise,q=t.$$promises={},r=X({},e),L=1+p.length/3,w=!1;if(Q(g.$$failure))return l(g.$$failure),t;g.$$inheritedValues&&f(r,n(g.$$inheritedValues,u));X(q,g.$$promises);g.$$values?(w=f(r,n(g.$$values,u)),t.$$inheritedValues=n(g.$$values,u),j()):(g.$$inheritedValues&&(t.$$inheritedValues=n(g.$$inheritedValues,u)),g.then(j,l));for(var B=0,D=p.length;D>B;B+=3)e.hasOwnProperty(p[B])?j():
m(p[B],p[B+1],p[B+2]);return t}};this.resolve=function(b,c,d,e){return this.study(b)(c,d,e)}}function r(b,c,d){this.fromConfig=function(b,c,d){return Q(b.template)?this.fromString(b.template,c):Q(b.templateUrl)?this.fromUrl(b.templateUrl,c):Q(b.templateProvider)?this.fromProvider(b.templateProvider,c,d):null};this.fromString=function(b,c){return B(b)?b(c):b};this.fromUrl=function(d,e){return B(d)&&(d=d(e)),null==d?null:b.get(d,{cache:c,headers:{Accept:"text/html"}}).then(function(b){return b.data})};
this.fromProvider=function(b,c,e){return d.invoke(b,null,e||{params:c})}}function o(b,c,f){function g(c,d,e,f){if(t.push(c),u[c])return u[c];if(!/^\w+([-.]+\w+)*(?:\[\])?$/.test(c))throw Error("Invalid parameter name '"+c+"' in pattern '"+b+"'");if(p[c])throw Error("Duplicate parameter name '"+c+"' in pattern '"+b+"'");return p[c]=new ba.Param(c,d,e,f),p[c]}function h(b,c,d,e){var f=["",""],b=b.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!c)return b;switch(d){case !1:f=["(",")"+(e?"?":"")];break;case !0:b=
b.replace(/\/$/,"");f=["(?:/(",")|/)?"];break;default:f=["("+d+"|",")?"]}return b+f[0]+c+f[1]}function j(f,g){var h,k,l,o,m;return h=f[2]||f[3],m=c.params[h],l=b.substring(n,f.index),k=g?f[4]:f[4]||("*"==f[1]?".*":null),k&&(o=ba.type(k)||e(ba.type("string"),{pattern:RegExp(k,c.caseInsensitive?"i":d)})),{id:h,regexp:k,segment:l,type:o,cfg:m}}var c=X({params:{}},Z(c)?c:{}),k,l=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,o=/([:]?)([\w\[\].-]+)|\{([\w\[\].-]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,
m="^",n=0,s=this.segments=[],u=f?f.params:{},p=this.params=f?f.params.$$new():new ba.ParamSet,t=[];this.source=b;for(var q,r;(k=l.exec(b))&&(q=j(k,!1),!(0<=q.segment.indexOf("?")));)r=g(q.id,q.type,q.cfg,"path"),m+=h(q.segment,r.type.pattern.source,r.squash,r.isOptional),s.push(q.segment),n=l.lastIndex;f=b.substring(n);k=f.indexOf("?");if(0<=k){var w=this.sourceSearch=f.substring(k);if(f=f.substring(0,k),this.sourcePath=b.substring(0,n+k),0<w.length)for(n=0;k=o.exec(w);)q=j(k,!0),r=g(q.id,q.type,
q.cfg,"search"),n=l.lastIndex}else this.sourcePath=b,this.sourceSearch="";m+=h(f)+(!1===c.strict?"/?":"")+"$";s.push(f);this.regexp=RegExp(m,c.caseInsensitive?"i":d);this.prefix=s[0];this.$$paramNames=t}function t(b){X(this,b)}function u(){function b(c){return null!=c?c.toString().replace(/~/g,"~~").replace(/\//g,"~2F"):c}function f(){for(;w.length;){var b=w.shift();if(b.pattern)throw Error("You cannot override a type's .pattern at runtime.");c.extend(s[b.name],k.invoke(b.def))}}function j(b){X(this,
b||{})}ba=this;var k,l=!1,m=!0,n=!1,s={},r=!0,w=[],D={string:{encode:b,decode:function(b){return null!=b?b.toString().replace(/~2F/g,"/").replace(/~~/g,"~"):b},is:function(b){return null==b||!Q(b)||"string"==typeof b},pattern:/[^\/]*/},"int":{encode:b,decode:function(b){return parseInt(b,10)},is:function(b){return Q(b)&&this.decode(b.toString())===b},pattern:/\d+/},bool:{encode:function(b){return b?1:0},decode:function(b){return 0!==parseInt(b,10)},is:function(b){return!0===b||!1===b},pattern:/0|1/},
date:{encode:function(b){return this.is(b)?[b.getFullYear(),("0"+(b.getMonth()+1)).slice(-2),("0"+b.getDate()).slice(-2)].join("-"):d},decode:function(b){return this.is(b)?b:(b=this.capture.exec(b))?new Date(b[1],b[2]-1,b[3]):d},is:function(b){return b instanceof Date&&!isNaN(b.valueOf())},equals:function(b,c){return this.is(b)&&this.is(c)&&b.toISOString()===c.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},
json:{encode:c.toJson,decode:c.fromJson,is:c.isObject,equals:c.equals,pattern:/[^\/]*/},any:{encode:c.identity,decode:c.identity,equals:c.equals,pattern:/.*/}};u.$$getDefaultValue=function(b){if(!(B(b.value)||O(b.value)&&B(b.value[b.value.length-1])))return b.value;if(!k)throw Error("Injectable functions cannot be called at configuration time");return k.invoke(b.value)};this.caseInsensitive=function(b){return Q(b)&&(l=b),l};this.strictMode=function(b){return Q(b)&&(m=b),m};this.defaultSquashPolicy=
function(b){if(!Q(b))return n;if(!0!==b&&!1!==b&&!E(b))throw Error("Invalid squash policy: "+b+". Valid policies: false, true, arbitrary-string");return n=b,b};this.compile=function(b,c){return new o(b,X({strict:m,caseInsensitive:l},c))};this.isMatcher=function(b){if(!Z(b))return!1;var c=!0;return M(o.prototype,function(d,e){B(d)&&(c=c&&Q(b[e])&&B(b[e]))}),c};this.type=function(b,c,d){if(!Q(c))return s[b];if(s.hasOwnProperty(b))throw Error("A type named '"+b+"' has already been defined.");return s[b]=
new t(X({name:b},c)),d&&(w.push({name:b,def:d}),r||f()),this};M(D,function(b,c){s[c]=new t(X({name:c},b))});s=e(s,{});this.$get=["$injector",function(b){return k=b,r=!1,f(),M(D,function(b,c){s[c]||(s[c]=new t(b))}),this}];this.Param=function(b,e,f,j){function l(){if(!k)throw Error("Injectable functions cannot be called at configuration time");var b=k.invoke(f.$$fn);if(null!==b&&b!==d&&!o.type.is(b))throw Error("Default value ("+b+") for parameter '"+o.id+"' is not an instance of Type ("+o.type.name+
")");return b}var o=this,f=function(b){var c=Z(b)?g(b):[];return-1===h(c,"value")&&(-1===h(c,"type")&&-1===h(c,"squash")&&-1===h(c,"array"))&&(b={value:b}),b.$$fn=B(b.value)||O(b.value)&&B(b.value[b.value.length-1])?b.value:function(){return b.value},b}(f),e=function(d,e,f){if(d.type&&e)throw Error("Param '"+b+"' has two type configurations.");return e?e:d.type?c.isString(d.type)?s[d.type]:d.type instanceof t?d.type:new t(d.type):"config"===f?s.any:s.string}(f,e,j),m=function(){var c={array:"search"===
j?"auto":!1},d=b.match(/\[\]$/)?{array:!0}:{};return X(c,d,f).array}(),e=m?e.$asArray(m,"search"===j):e;"string"!==e.name||m||"path"!==j||f.value!==d||(f.value="");var u=f.value!==d,r=function(b,c){var d=b.squash;if(!c||!1===d)return!1;if(!Q(d)||null==d)return n;if(!0===d||E(d))return d;throw Error("Invalid squash policy: '"+d+"'. Valid policies: false, true, or arbitrary string");}(f,u),w=function(b,c,e,f){var g,j,c=[{from:"",to:e||c?d:""},{from:null,to:e||c?d:""}];return g=O(b.replace)?b.replace:
[],E(f)&&g.push({from:f,to:d}),j=p(g,function(b){return b.from}),q(c,function(b){return-1===h(j,b.from)}).concat(g)}(f,m,u,r);X(this,{id:b,type:e,location:j,array:m,squash:r,replace:w,isOptional:u,value:function(b){function c(b){return function(c){return c.from===b}}return b=function(b){var d=p(q(o.replace,c(b)),function(b){return b.to});return d.length?d[0]:b}(b),Q(b)?o.type.$normalize(b):l()},dynamic:d,config:f,toString:function(){return"{Param:"+b+" "+e+" squash: '"+r+"' optional: "+u+"}"}})};
j.prototype={$$new:function(){return e(this,X(new j,{$$parent:this}))},$$keys:function(){for(var b=[],c=[],d=this,e=g(j.prototype);d;)c.push(d),d=d.$$parent;return c.reverse(),M(c,function(c){M(g(c),function(c){-1===h(b,c)&&-1===h(e,c)&&b.push(c)})}),b},$$values:function(b){var c={},d=this;return M(d.$$keys(),function(e){c[e]=d[e].value(b&&b[e])}),c},$$equals:function(b,c){var d=!0,e=this;return M(e.$$keys(),function(f){e[f].type.equals(b&&b[f],c&&c[f])||(d=!1)}),d},$$validates:function(b){var e,
f,g,h,j,k=this.$$keys();for(e=0;e<k.length&&(f=this[k[e]],g=b[k[e]],g!==d&&null!==g||!f.isOptional);e++)if((h=f.type.$normalize(g),!f.type.is(h))||(j=f.type.encode(h),c.isString(j)&&!f.type.pattern.exec(j)))return!1;return!0},$$parent:d};this.ParamSet=j}function w(b,e){function f(b){b=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(b.source);return null!=b?b[1].replace(/\\(.)/g,"$1"):""}function g(b,c){return b.replace(/\$(\$|\d{1,2})/,function(b,d){return c["$"===d?0:Number(d)]})}function h(b,
c,d){if(!d)return!1;b=b.invoke(c,c,{$match:d});return Q(b)?b:!0}function j(e,f,g,h,n){function s(b){function c(b){return(b=b(g,e))?(E(b)&&e.replace().url(b),!0):!1}if(!b||!b.defaultPrevented){p&&e.url();p=d;for(var f=l.length,b=0;f>b;b++)if(c(l[b]))return;o&&c(o)}}function u(){return k=k||f.$on("$locationChangeSuccess",s)}var p,t=h.baseHref(),q=e.url();return m||u(),{sync:function(){s()},listen:function(){return u()},update:function(b){return b?void(q=e.url()):void(e.url()!==q&&(e.url(q),e.replace()))},
push:function(b,c,f){b=b.format(c||{});null!==b&&c&&c["#"]&&(b+="#"+c["#"]);e.url(b);p=f&&f.$$avoidResync?e.url():d;f&&f.replace&&e.replace()},href:function(d,f,g){if(!d.validates(f))return null;var h=b.html5Mode();c.isObject(h)&&(h=h.enabled);h=h&&n.history;d=d.format(f);if(g=g||{},h||null===d||(d="#"+b.hashPrefix()+d),null!==d&&f&&f["#"]&&(d+="#"+f["#"]),d="/"===t?d:h?t.slice(0,-1)+d:g.absolute?t.slice(1)+d:d,!g.absolute||!d)return d;f=!h&&d?"/":"";g=e.port();return g=80===g||443===g?"":":"+g,[e.protocol(),
"://",e.host(),g,f,d].join("")}}}var k,l=[],o=null,m=!1;this.rule=function(b){if(!B(b))throw Error("'rule' must be a function");return l.push(b),this};this.otherwise=function(b){if(E(b))var c=b,b=function(){return c};else if(!B(b))throw Error("'rule' must be a function");return o=b,this};this.when=function(b,c){var d,j=E(c);if(E(b)&&(b=e.compile(b)),!j&&!B(c)&&!O(c))throw Error("invalid 'handler' in when()");var k={matcher:function(b,c){return j&&(d=e.compile(c),c=["$match",function(b){return d.format(b)}]),
X(function(d,e){return h(d,c,b.exec(e.path(),e.search()))},{prefix:E(b.prefix)?b.prefix:""})},regex:function(b,c){if(b.global||b.sticky)throw Error("when() RegExp must not be global or sticky");return j&&(d=c,c=["$match",function(b){return g(d,b)}]),X(function(d,e){return h(d,c,b.exec(e.path()))},{prefix:f(b)})}},l={matcher:e.isMatcher(b),regex:b instanceof RegExp},o;for(o in l)if(l[o])return this.rule(k[o](b,c));throw Error("invalid 'what' in when()");};this.deferIntercept=function(b){b===d&&(b=
!0);m=b};this.$get=j;j.$inject=["$location","$rootScope","$injector","$browser","$sniffer"]}function z(b,f){function o(b,c){if(!b)return d;var e=E(b),f=e?b:b.name;if(0===f.indexOf(".")||0===f.indexOf("^")){if(!c)throw Error("No reference point given for path '"+f+"'");for(var c=o(c),g=f.split("."),h=0,j=g.length,k=c;j>h;h++)if(""!==g[h]||0!==h){if("^"!==g[h])break;if(!k.parent)throw Error("Path '"+f+"' not valid for state '"+c.name+"'");k=k.parent}else k=c;g=g.slice(h).join(".");f=k.name+(k.name&&
g?".":"")+g}f=D[f];return!f||!e&&(e||f!==b&&f.self!==b)?d:f}function n(b,c){z[b]||(z[b]=[]);z[b].push(c)}function s(b){for(b=z[b]||[];b.length;)u(b.shift())}function u(c){var c=e(c,{self:c,resolve:c.resolve||{},toString:function(){return this.name}}),d=c.name;if(!E(d)||0<=d.indexOf("@"))throw Error("State must have a valid name");if(D.hasOwnProperty(d))throw Error("State '"+d+"' is already defined");var f=-1!==d.indexOf(".")?d.substring(0,d.lastIndexOf(".")):E(c.parent)?c.parent:Z(c.parent)&&E(c.parent.name)?
c.parent.name:"";if(f&&!D[f])return n(f,c.self);for(var g in A)B(A[g])&&(c[g]=A[g](c,A.$delegates[g]));return D[d]=c,!c[L]&&c.url&&b.when(c.url,["$match","$stateParams",function(b,d){w.$current.navigable==c&&k(b,d)||w.transitionTo(c,b,{inherit:!0,location:!1})}]),s(d),c}function t(b,f,m,n,s,u,z){function A(c,d,e,g){d=b.$broadcast("$stateNotFound",c,d,e);if(d.defaultPrevented)return z.update(),J;if(!d.retry)return null;if(g.$retry)return z.update(),I;var h=w.transition=f.when(d.retry);return h.then(function(){return h!==
w.transition?W:(c.options.$retry=!0,w.transitionTo(c.to,c.toParams,c.options))},function(){return J}),z.update(),h}function F(b,d,e,g,h,j){var k=e?d:l(b.params.$$keys(),d);h.resolve=s.resolve(b.resolve,{$stateParams:k},h.resolve,b);d=[h.resolve.then(function(b){h.globals=b})];return g&&d.push(g),f.all(d).then(function(){var d=[];return M(b.views,function(e,f){var g=e.resolve&&e.resolve!==b.resolve?e.resolve:{};g.$template=[function(){return m.load(f,{view:e,locals:h.globals,params:k,notify:j.notify})||
""}];d.push(s.resolve(g,h.globals,h.resolve,b).then(function(d){if(B(e.controllerProvider)||O(e.controllerProvider)){var j=c.extend({},g,h.globals);d.$$controller=n.invoke(e.controllerProvider,null,j)}else d.$$controller=e.controller;d.$$state=b;d.$$controllerAs=e.controllerAs;d.$$resolveAs=e.resolveAs;h[f]=d}))}),f.all(d).then(function(){return h.globals})}).then(function(){return h})}var W=f.reject(Error("transition superseded")),C=f.reject(Error("transition prevented")),J=f.reject(Error("transition aborted")),
I=f.reject(Error("transition failed"));return r.locals={resolve:null,globals:{$stateParams:{}}},w={params:{},current:r.self,$current:r,transition:null},w.reload=function(b){return w.transitionTo(w.current,u,{reload:b||!0,inherit:!1,notify:!0})},w.go=function(b,c,d){return w.transitionTo(b,c,X({inherit:!0,relative:w.$current},d))},w.transitionTo=function(c,d,g){var d=d||{},g=X({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},g||{}),h,k=w.$current,m=w.params,s=k.path,p=o(c,g.relative),
t=d["#"];if(!Q(p)){var B={to:c,toParams:d,options:g},D=A(B,k.self,m,g);if(D)return D;if(c=B.to,d=B.toParams,g=B.options,p=o(c,g.relative),!Q(p)){if(!g.relative)throw Error("No such state '"+c+"'");throw Error("Could not resolve '"+c+"' from state '"+g.relative+"'");}}if(p[L])throw Error("Cannot transition to abstract state '"+c+"'");if(g.inherit&&(d=j(u,d||{},w.$current,p)),!p.params.$$validates(d))return I;var d=p.params.$$values(d),c=p,O=c.path,v=0,p=O[v],B=r.locals,M=[];if(g.reload){if(E(g.reload)||
Z(g.reload)){if(Z(g.reload)&&!g.reload.name)throw Error("Invalid reload state object");D=!0===g.reload?s[0]:o(g.reload);if(g.reload&&!D)throw Error("No such reload state '"+(E(g.reload)?g.reload:g.reload.name)+"'");for(;p&&p===s[v]&&p!==D;)B=M[v]=p.locals,v++,p=O[v]}}else for(;p&&p===s[v]&&p.ownParams.$$equals(d,m);)B=M[v]=p.locals,v++,p=O[v];if(q(c,d,k,m,B,g))return t&&(d["#"]=t),w.params=d,aa(w.params,u),aa(l(c.params.$$keys(),u),c.locals.globals.$stateParams),g.location&&c.navigable&&c.navigable.url&&
(z.push(c.navigable.url,d,{$$avoidResync:!0,replace:"replace"===g.location}),z.update(!0)),w.transition=null,f.when(w.current);if(d=l(c.params.$$keys(),d||{}),t&&(d["#"]=t),g.notify&&b.$broadcast("$stateChangeStart",c.self,d,k.self,m,g).defaultPrevented)return b.$broadcast("$stateChangeCancel",c.self,d,k.self,m),null==w.transition&&z.update(),C;t=f.when(B);for(D=v;D<O.length;D++,p=O[D])B=M[D]=e(B),t=F(p,d,p===c,t,B,g);var J=w.transition=t.then(function(){var e,f;if(w.transition!==J)return W;for(e=
s.length-1;e>=v;e--)f=s[e],f.self.onExit&&n.invoke(f.self.onExit,f.self,f.locals.globals),f.locals=null;for(e=v;e<O.length;e++)f=O[e],f.locals=M[e],f.self.onEnter&&n.invoke(f.self.onEnter,f.self,f.locals.globals);return w.transition!==J?W:(w.$current=c,w.current=c.self,w.params=d,aa(w.params,u),w.transition=null,g.location&&c.navigable&&z.push(c.navigable.url,c.navigable.locals.globals.$stateParams,{$$avoidResync:!0,replace:"replace"===g.location}),g.notify&&b.$broadcast("$stateChangeSuccess",c.self,
d,k.self,m),z.update(!0),w.current)}).then(null,function(e){return w.transition!==J?W:(w.transition=null,h=b.$broadcast("$stateChangeError",c.self,d,k.self,m,e),h.defaultPrevented||z.update(),f.reject(e))});return J},w.is=function(b,c,e){e=X({relative:w.$current},e||{});b=o(b,e.relative);return Q(b)?w.$current!==b?!1:c?k(b.params.$$values(c),u):!0:d},w.includes=function(b,c,e){if(e=X({relative:w.$current},e||{}),E(b)&&-1<b.indexOf("*")){for(var b=b.split("."),f=w.$current.name.split("."),j=0,l=b.length;l>
j;j++)"*"===b[j]&&(f[j]="*");if(!("**"===b[0]&&(f=f.slice(h(f,b[1])),f.unshift("**")),"**"===b[b.length-1]&&(f.splice(h(f,b[b.length-2])+1,Number.MAX_VALUE),f.push("**")),b.length!=f.length?!1:f.join("")===b.join("")))return!1;b=w.$current.name}e=o(b,e.relative);return Q(e)?Q(w.$current.includes[e.name])?c?k(e.params.$$values(c),u,g(c)):!0:!1:d},w.href=function(b,c,e){e=X({lossy:!0,inherit:!0,absolute:!1,relative:w.$current},e||{});b=o(b,e.relative);if(!Q(b))return null;e.inherit&&(c=j(u,c||{},w.$current,
b));var f=b&&e.lossy?b.navigable:b;return f&&f.url!==d&&null!==f.url?z.href(f.url,l(b.params.$$keys().concat("#"),c||{}),{absolute:e.absolute}):null},w.get=function(b,c){if(0===arguments.length)return p(g(D),function(b){return D[b].self});var d=o(b,c||w.$current);return d&&d.self?d.self:null},w}function q(b,c,d,e,f,g){function h(b,c,d){var e=b.params.$$keys().filter(function(c){return"search"!=b.params[c].location}),e=m.apply({},[b.params].concat(e));return(new ba.ParamSet(e)).$$equals(c,d)}return!g.reload&&
b===d&&(f===d.locals||!1===b.self.reloadOnSearch&&h(d,e,c))?!0:void 0}var r,w,D={},z={},L="abstract",A={parent:function(b){return Q(b.parent)&&b.parent?o(b.parent):(b=/^(.+)\.[^.]+$/.exec(b.name))?o(b[1]):r},data:function(b){return b.parent&&b.parent.data&&(b.data=b.self.data=e(b.parent.data,b.data)),b.data},url:function(b){var c=b.url,d={params:b.params||{}};if(E(c))return"^"==c.charAt(0)?f.compile(c.substring(1),d):(b.parent.navigable||r).url.concat(c,d);if(!c||f.isMatcher(c))return c;throw Error("Invalid url '"+
c+"' in state '"+b+"'");},navigable:function(b){return b.url?b:b.parent?b.parent.navigable:null},ownParams:function(b){var c=b.url&&b.url.params||new ba.ParamSet;return M(b.params||{},function(b,d){c[d]||(c[d]=new ba.Param(d,null,b,"config"))}),c},params:function(b){var c=m(b.ownParams,b.ownParams.$$keys());return b.parent&&b.parent.params?X(b.parent.params.$$new(),c):new ba.ParamSet},views:function(b){var c={};return M(Q(b.views)?b.views:{"":b},function(d,e){0>e.indexOf("@")&&(e+="@"+b.parent.name);
d.resolveAs=d.resolveAs||b.resolveAs||"$resolve";c[e]=d}),c},path:function(b){return b.parent?b.parent.path.concat(b):[]},includes:function(b){var c=b.parent?X({},b.parent.includes):{};return c[b.name]=!0,c},$delegates:{}};r=u({name:"",url:"^",views:null,"abstract":!0});r.navigable=null;this.decorator=function(b,c){return E(b)&&!Q(c)?A[b]:B(c)&&E(b)?(A[b]&&!A.$delegates[b]&&(A.$delegates[b]=A[b]),A[b]=c,this):this};this.state=function(b,c){return Z(b)?c=b:c.name=b,u(c),this};this.$get=t;t.$inject=
"$rootScope $q $view $injector $resolve $stateParams $urlRouter $location $urlMatcherFactory".split(" ")}function A(){function b(c,d){return{load:function(b,c){var e;return c=X({template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}},c),c.view&&(e=d.fromConfig(c.view,c.params,c.locals)),e}}}this.$get=b;b.$inject=["$rootScope","$templateFactory"]}function C(b,d,e,f,g){function h(b,d){if(l)return{enter:function(b,d,e){2<c.version.minor?l.enter(b,null,d).then(e):l.enter(b,null,
d,e)},leave:function(b,d){2<c.version.minor?l.leave(b).then(d):l.leave(b,d)}};if(k){var e=k&&k(d,b);return{enter:function(b,c,d){e.enter(b,null,c);d()},leave:function(b,c){e.leave(b);c()}}}return function(){return{enter:function(b,c,d){c.after(b);d()},leave:function(b,c){b.remove();c()}}}()}var j=function(){return d.has?function(b){return d.has(b)?d.get(b):null}:function(b){try{return d.get(b)}catch(c){return null}}}(),k=j("$animator"),l=j("$animate");return{restrict:"ECA",terminal:!0,priority:400,
transclude:"element",compile:function(d,j,k){return function(d,j,l){function o(){if(n&&(n.remove(),n=null),u&&(u.$destroy(),u=null),s){var b=s.data("$uiViewAnim");r.leave(s,function(){b.$$animLeave.resolve();n=null});n=s;s=null}}function m(h){var n=H(d,l,j,f),w=n&&b.$current&&b.$current.locals[n];if(h||w!==p)h=d.$new(),p=b.$current.locals[n],h.$emit("$viewContentLoading",n),s=k(h,function(b){var f=g.defer(),h=g.defer();b.data("$uiViewAnim",{$animEnter:f.promise,$animLeave:h.promise,$$animLeave:h});
r.enter(b,j,function(){f.resolve();u&&u.$emit("$viewContentAnimationEnded");(c.isDefined(q)&&!q||d.$eval(q))&&e(b)});o()}),u=h,u.$emit("$viewContentLoaded",n),u.$eval(t)}var n,s,u,p,t=l.onload||"",q=l.autoscroll,r=h(l,d);j.inheritedData("$uiView");d.$on("$stateChangeSuccess",function(){m(!1)});m(!0)}}}}function G(b,d,e,f){return{restrict:"ECA",priority:-400,compile:function(g){var h=g.html();return function(g,j,k){var l=e.$current,k=H(g,k,j,f);if(l=l&&l.locals[k]){j.data("$uiView",{name:k,state:l.$$state});
j.html(l.$template?l.$template:h);k=c.extend({},l);g[l.$$resolveAs]=k;var o=b(j.contents());if(l.$$controller){l.$scope=g;l.$element=j;var m=d(l.$$controller,l);l.$$controllerAs&&(g[l.$$controllerAs]=m,g[l.$$controllerAs][l.$$resolveAs]=k);B(m.$onInit)&&m.$onInit();j.data("$ngControllerController",m);j.children().data("$ngControllerController",m)}o(g)}}}}}function H(b,c,d,e){b=e(c.uiView||c.name||"")(b);d=d.inheritedData("$uiView");return 0<=b.indexOf("@")?b:b+"@"+(d?d.state.name:"")}function K(b,
c){var d,e=b.match(/^\s*({[^}]*})\s*$/);if(e&&(b=c+"("+e[1]+")"),d=b.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/),!d||4!==d.length)throw Error("Invalid state ref '"+b+"'");return{state:d[1],paramExpr:d[3]||null}}function P(b){return(b=b.parent().inheritedData("$uiView"))&&b.state&&b.state.name?b.state:void 0}function T(b){var c="[object SVGAnimatedString]"===Object.prototype.toString.call(b.prop("href")),d="FORM"===b[0].nodeName;return{attr:d?"action":c?"xlink:href":"href",isAnchor:"A"===
b.prop("tagName").toUpperCase(),clickable:!d}}function D(b,c,d,e,f){return function(g){var h=g.which||g.button,j=f();if(!(1<h||g.ctrlKey||g.metaKey||g.shiftKey||b.attr("target"))){var k=d(function(){c.go(j.state,j.params,j.options)});g.preventDefault();var l=e.isAnchor&&!j.href?1:0;g.preventDefault=function(){0>=l--&&d.cancel(k)}}}}function F(b,d){return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(e,f,g,h){var j,k=K(g.uiSref,b.current.name),l={state:k.state,href:null,
params:null},o=T(f),m=h[1]||h[0],n=null;l.options=X({relative:P(f)||b.$current,inherit:!0},g.uiSrefOpts?e.$eval(g.uiSrefOpts):{});var s=function(d){d&&(l.params=c.copy(d));l.href=b.href(k.state,l.params,l.options);n&&n();m&&(n=m.$$addStateInfo(k.state,l.params));null!==l.href&&g.$set(o.attr,l.href)};k.paramExpr&&(e.$watch(k.paramExpr,function(b){b!==l.params&&s(b)},!0),l.params=c.copy(e.$eval(k.paramExpr)));s();o.clickable&&(j=D(f,b,d,o,function(){return l}),f.bind("click",j),e.$on("$destroy",function(){f.unbind("click",
j)}))}}}function I(b,c){return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(d,e,f,g){function h(c){o.state=c[0];o.params=c[1];o.options=c[2];o.href=b.href(o.state,o.params,o.options);m&&m();l&&(m=l.$$addStateInfo(o.state,o.params));o.href&&f.$set(k.attr,o.href)}var j,k=T(e),l=g[1]||g[0],g="["+[f.uiState,f.uiStateParams||null,f.uiStateOpts||null].map(function(b){return b||"null"}).join(", ")+"]",o={state:null,params:null,options:null,href:null},m=null;d.$watch(g,h,!0);h(d.$eval(g));
k.clickable&&(j=D(e,b,c,k,function(){return o}),e.bind("click",j),d.$on("$destroy",function(){e.unbind("click",j)}))}}}function J(b,c,d){return{restrict:"A",controller:["$scope","$element","$attrs","$timeout",function(c,e,f,g){function h(c,d,f){var g=b.get(c,P(e)),k=j(c,d),l={state:g||{name:c},params:d,hash:k};return n.push(l),s[k]=f,function(){var b=n.indexOf(l);-1!==b&&n.splice(b,1)}}function j(b,d){if(!E(b))throw Error("state should be a string");return Z(d)?b+Y(d):(d=c.$eval(d),Z(d)?b+Y(d):b)}
function k(){for(var c=0;c<n.length;c++)b.includes(n[c].state.name,n[c].params)?l(e,s[n[c].hash]):e.removeClass(s[n[c].hash]),b.is(n[c].state.name,n[c].params)?l(e,o):e.removeClass(o)}function l(b,c){g(function(){b.addClass(c)})}var o,m,n=[],s={};o=d(f.uiSrefActiveEq||"",!1)(c);try{m=c.$eval(f.uiSrefActive)}catch(u){}m=m||d(f.uiSrefActive||"",!1)(c);Z(m)&&M(m,function(d,e){if(E(d)){var f=K(d,b.current.name);h(f.state,c.$eval(f.paramExpr),e)}});this.$$addStateInfo=function(b,c){if(!(Z(m)&&0<n.length)){var d=
h(b,c,m);return k(),d}};c.$on("$stateChangeSuccess",k);k()}]}}function N(b){var c=function(c,d){return b.is(c,d)};return c.$stateful=!0,c}function U(b){var c=function(c,d,e){return b.includes(c,d,e)};return c.$stateful=!0,c}var Q=c.isDefined,B=c.isFunction,E=c.isString,Z=c.isObject,O=c.isArray,M=c.forEach,X=c.extend,aa=c.copy,Y=c.toJson;c.module("ui.router.util",["ng"]);c.module("ui.router.router",["ui.router.util"]);c.module("ui.router.state",["ui.router.router","ui.router.util"]);c.module("ui.router",
["ui.router.state"]);c.module("ui.router.compat",["ui.router"]);s.$inject=["$q","$injector"];c.module("ui.router.util").service("$resolve",s);r.$inject=["$http","$templateCache","$injector"];c.module("ui.router.util").service("$templateFactory",r);var ba;o.prototype.concat=function(b,c){var d={caseInsensitive:ba.caseInsensitive(),strict:ba.strictMode(),squash:ba.defaultSquashPolicy()};return new o(this.sourcePath+b+this.sourceSearch,X(d,c),this)};o.prototype.toString=function(){return this.source};
o.prototype.exec=function(b,c){function d(b){function c(b){return b.split("").reverse().join("")}b=c(b).split(/-(?!\\)/);b=p(b,c);return p(b,function(b){return b.replace(/\\-/g,"-")}).reverse()}var e=this.regexp.exec(b);if(!e)return null;var c=c||{},f,g,h,j=this.parameters(),k=j.length,l=this.segments.length-1,o={};if(l!==e.length-1)throw Error("Unbalanced capture group in route '"+this.source+"'");var m,n;for(f=0;l>f;f++){h=j[f];m=this.params[h];n=e[f+1];for(g=0;g<m.replace.length;g++)m.replace[g].from===
n&&(n=m.replace[g].to);n&&!0===m.array&&(n=d(n));Q(n)&&(n=m.type.decode(n));o[h]=m.value(n)}for(;k>f;f++){h=j[f];o[h]=this.params[h].value(c[h]);m=this.params[h];n=c[h];for(g=0;g<m.replace.length;g++)m.replace[g].from===n&&(n=m.replace[g].to);Q(n)&&(n=m.type.decode(n));o[h]=m.value(n)}return o};o.prototype.parameters=function(b){return Q(b)?this.params[b]||null:this.$$paramNames};o.prototype.validates=function(b){return this.params.$$validates(b)};o.prototype.format=function(b){function c(b){return encodeURIComponent(b).replace(/-/g,
function(b){return"%5C%"+b.charCodeAt(0).toString(16).toUpperCase()})}var b=b||{},d=this.segments,e=this.parameters(),f=this.params;if(!this.validates(b))return null;var g,h=!1,j=d.length-1,k=e.length,l=d[0];for(g=0;k>g;g++){var o=j>g,m=e[g],n=f[m],s=n.value(b[m]),u=n.isOptional&&n.type.equals(n.value(),s),t=u?n.squash:!1,s=n.type.encode(s);if(o)o=d[g+1],m=g+1===j,!1===t?(null!=s&&(l+=O(s)?p(s,c).join("-"):encodeURIComponent(s)),l+=o):!0===t?(t=l.match(/\/$/)?/\/?(.*)/:/(.*)/,l+=o.match(t)[1]):E(t)&&
(l+=t+o),m&&!0===n.squash&&"/"===l.slice(-1)&&(l=l.slice(0,-1));else if(!(null==s||u&&!1!==t))if(!(O(s)||(s=[s]),0===s.length))s=p(s,encodeURIComponent).join("&"+m+"="),l+=(h?"&":"?")+(m+"="+s),h=!0}return l};t.prototype.is=function(){return!0};t.prototype.encode=function(b){return b};t.prototype.decode=function(b){return b};t.prototype.equals=function(b,c){return b==c};t.prototype.$subPattern=function(){var b=this.pattern.toString();return b.substr(1,b.length-2)};t.prototype.pattern=/.*/;t.prototype.toString=
function(){return"{Type:"+this.name+"}"};t.prototype.$normalize=function(b){return this.is(b)?b:this.decode(b)};t.prototype.$asArray=function(b,c){if(!b)return this;if("auto"===b&&!c)throw Error("'auto' array mode is for query parameters only");return new function(b,c){function e(b,c){return function(){return b[c].apply(b,arguments)}}function f(b){return O(b)?b:Q(b)?[b]:[]}function g(b){return!b}function h(b,e){return function(h){if(O(h)&&0===h.length)return h;h=f(h);h=p(h,b);if(!0===e)h=0===q(h,
g).length;else a:switch(h.length){case 0:h=d;break a;case 1:h="auto"===c?h[0]:h;break a}return h}}this.encode=h(e(b,"encode"));this.decode=h(e(b,"decode"));this.is=h(e(b,"is"),!0);this.equals=function(b){return function(c,d){var e=f(c),g=f(d);if(e.length!==g.length)return!1;for(var h=0;h<e.length;h++)if(!b(e[h],g[h]))return!1;return!0}}(e(b,"equals"));this.pattern=b.pattern;this.$normalize=h(e(b,"$normalize"));this.name=b.name;this.$arrayMode=c}(this,b)};c.module("ui.router.util").provider("$urlMatcherFactory",
u);c.module("ui.router.util").run(["$urlMatcherFactory",function(){}]);w.$inject=["$locationProvider","$urlMatcherFactoryProvider"];c.module("ui.router.router").provider("$urlRouter",w);z.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"];c.module("ui.router.state").factory("$stateParams",function(){return{}}).constant("$state.runtime",{autoinject:!0}).provider("$state",z).run(["$injector",function(b){b.get("$state.runtime").autoinject&&b.get("$state")}]);A.$inject=[];c.module("ui.router.state").provider("$view",
A);c.module("ui.router.state").provider("$uiViewScroll",function(){var b=!1;this.useAnchorScroll=function(){b=!0};this.$get=["$anchorScroll","$timeout",function(c,d){return b?c:function(b){return d(function(){b[0].scrollIntoView()},0,!1)}}]});C.$inject=["$state","$injector","$uiViewScroll","$interpolate","$q"];G.$inject=["$compile","$controller","$state","$interpolate"];c.module("ui.router.state").directive("uiView",C);c.module("ui.router.state").directive("uiView",G);F.$inject=["$state","$timeout"];
I.$inject=["$state","$timeout"];J.$inject=["$state","$stateParams","$interpolate"];c.module("ui.router.state").directive("uiSref",F).directive("uiSrefActive",J).directive("uiSrefActiveEq",J).directive("uiState",I);N.$inject=["$state"];U.$inject=["$state"];c.module("ui.router.state").filter("isState",N).filter("includedByState",U)})(window,window.angular);
function shareFacebook(b,c){var c=c?c:{},d="https://www.facebook.com/dialog/share?"+$.param({app_id:c.appId,display:"popup",href:b,redirect_uri:"http://"+(c.serverName?c.serverName:"www.tynker.com")+"/api/closewindow"});window.open(d,"Share","toolbar=0,status=0,width=626,height=436")}
function shareTwitter(b,c,d){d=d?d:{};d=void 0!==d.hashTags?d.hashTags:"stem,hourofcode";b={url:b,text:c};d&&(b.hashtags=d);b="https://twitter.com/intent/tweet?"+$.param(b);window.open(b,"Tweet","toolbar=0,status=0,width=626,height=436")}function shareGooglePlus(b){b="https://plus.google.com/share?"+$.param({url:b});window.open(b,"Share on Google+","toolbar=0,status=0,width=626,height=436")}
function shareEmail(b,c){window.open("mailto:?subject="+encodeURIComponent(b)+"&body="+encodeURIComponent(c),"Share using e-mail","toolbar=0,status=0,width=626,height=436")}function shareProjectFacebook(b,c){var d=c.serverName?c.serverName:"www.tynker.com";shareFacebook(c.shareUrl?c.shareUrl:"http://"+d+"/play?p="+b,c)}
function shareProjectTwitter(b,c,d,e){e=e?e:{};d=e.serverName?e.serverName:"www.tynker.com";e.hashTags=e.hashTags?e.hashTags:"tynker";shareTwitter(e.shareUrl?e.shareUrl:"http://"+d+"/play?p="+b,"Check out "+c+" a coding project created with Tynker",e)}function shareProjectGooglePlus(b,c){var c=c?c:{},d=c.serverName?c.serverName:"www.tynker.com";shareGooglePlus(c.shareUrl?c.shareUrl:"http://"+d+"/play?p="+b)}
function shareProjectEmail(b,c,d,e){var e=e?e:{},f=e.serverName?e.serverName:"www.tynker.com";shareEmail(c,"\n\nTynker project made by "+d+"\n"+(e.shareUrl?e.shareUrl:"http://"+f+"/play?p="+b)+"\n")}function shareMyHocProjectTwitter(b,c,d,e){e=e?e:{};e.hashTags=e.hashTags?e.hashTags:"hourofcode,tynker";e.serverName?e.serverName:"www.tynker.com";d=e.serverName;shareTwitter(e.shareUrl?e.shareUrl:"http://"+d+"/play?p="+b,"I made "+c+" using code. Try it at",e)}
function shareMyHocProjectEmail(b,c,d,e){e=e?e:{};e.serverName=e.serverName?e.serverName:"www.tynker.com";d=e.serverName;shareEmail(c,"\n\nI made "+c+" using code. Try it at "+(e.shareUrl?e.shareUrl:"http://"+d+"/play?p="+b))}
$(document).ready(function(){$(".js-share-facebook").click(function(){var b=$(this),c=b.attr("data-url"),b=b.attr("data-options"),b=$.parseJSON(b);shareFacebook(c,b)});$(".js-share-twitter").click(function(){var b=$(this),c=b.attr("data-url"),d=b.attr("data-text"),b=b.attr("data-options"),b=$.parseJSON(b);shareTwitter(c,d,b)});$(".js-share-google-plus").click(function(){var b=$(this),c=b.attr("data-url"),b=b.attr("data-options"),b=$.parseJSON(b);shareGooglePlus(c,b)});$(".js-share-email").click(function(){var b=
$(this),c=b.attr("data-subject"),d=b.attr("data-body"),b=b.attr("data-options");$.parseJSON(b);shareEmail(c,d)})});
(function(){var b=function(){return this}(),c=function(b,d,e){"string"!=typeof b?c.original?c.original.apply(window,arguments):(console.error("dropping module because define wasn't a string."),console.trace()):(2==arguments.length&&(e=d),c.modules||(c.modules={},c.payloads={}),c.payloads[b]=e,c.modules[b]=null)},d=function(b,c,e){if("[object Array]"===Object.prototype.toString.call(c)){for(var k=[],l=0,m=c.length;l<m;++l){var n=f(b,c[l]);if(!n&&d.original)return d.original.apply(window,arguments);
k.push(n)}e&&e.apply(null,k)}else{if("string"==typeof c)return k=f(b,c),!k&&d.original?d.original.apply(window,arguments):(e&&e(),k);if(d.original)return d.original.apply(window,arguments)}},e=function(b,c){if(-1!==c.indexOf("!")){var d=c.split("!");return e(b,d[0])+"!"+e(b,d[1])}if("."==c.charAt(0))for(c=b.split("/").slice(0,-1).join("/")+"/"+c;-1!==c.indexOf(".")&&d!=c;)d=c,c=c.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"");return c},f=function(b,f){var f=e(b,f),j=c.modules[f];if(!j){j=c.payloads[f];
if("function"==typeof j){var k={},l={id:f,uri:"",exports:k,packaged:!0},k=j(function(b,c){return d(f,b,c)},k,l)||l.exports;c.modules[f]=k;delete c.payloads[f]}j=c.modules[f]=k||j}return j};(function(e){var f=function(b,c){return d("",b,c)},j=b;e&&(b[e]||(b[e]={}),j=b[e]);if(!j.define||!j.define.packaged)c.original=j.define,j.define=c,j.define.packaged=!0;if(!j.require||!j.require.packaged)d.original=j.require,j.require=f,j.require.packaged=!0})("ace")})();
ace.define("ace/ace","require exports module ace/lib/fixoldbrowsers ace/lib/dom ace/lib/event ace/editor ace/edit_session ace/undomanager ace/virtual_renderer ace/multi_select ace/worker/worker_client ace/keyboard/hash_handler ace/placeholder ace/mode/folding/fold_mode ace/theme/textmate ace/ext/error_marker ace/config".split(" "),function(b,c){b("./lib/fixoldbrowsers");var d=b("./lib/dom"),e=b("./lib/event"),f=b("./editor").Editor,g=b("./edit_session").EditSession,h=b("./undomanager").UndoManager,
j=b("./virtual_renderer").VirtualRenderer,k=b("./multi_select").MultiSelect;b("./worker/worker_client");b("./keyboard/hash_handler");b("./placeholder");b("./mode/folding/fold_mode");b("./theme/textmate");b("./ext/error_marker");c.config=b("./config");c.require=b;c.edit=function(b){if(typeof b=="string"){var g=b,b=document.getElementById(g);if(!b)throw Error("ace.edit can't find div #"+g);}if(b.env&&b.env.editor instanceof f)return b.env.editor;g=c.createEditSession(d.getInnerText(b));b.innerHTML=
"";var h=new f(new j(b));new k(h);h.setSession(g);var q={document:g,editor:h,onResize:h.resize.bind(h,null)};return e.addListener(window,"resize",q.onResize),h.on("destroy",function(){e.removeListener(window,"resize",q.onResize)}),b.env=h.env=q,h};c.createEditSession=function(b,c){var d=new g(b,c);return d.setUndoManager(new h),d};c.EditSession=g;c.UndoManager=h});ace.define("ace/lib/fixoldbrowsers",["require","exports","module","ace/lib/regexp","ace/lib/es5-shim"],function(b){b("./regexp");b("./es5-shim")});
ace.define("ace/lib/regexp",["require","exports","module"],function(){function b(b,c,d){if(Array.prototype.indexOf)return b.indexOf(c,d);for(d=d||0;d<b.length;d++)if(b[d]===c)return d;return-1}var c=RegExp.prototype.exec,d=RegExp.prototype.test,e=String.prototype.replace,f=void 0===c.call(/()??/,"")[1],g=function(){var b=/^/g;return d.call(b,""),!b.lastIndex}();if(!g||!f)RegExp.prototype.exec=function(d){var j=c.apply(this,arguments),k;if("string"==typeof d&&j){!f&&1<j.length&&-1<b(j,"")&&(k=RegExp(this.source,
e.call((this.global?"g":"")+(this.ignoreCase?"i":"")+(this.multiline?"m":"")+(this.extended?"x":"")+(this.sticky?"y":""),"g","")),e.call(d.slice(j.index),k,function(){for(var b=1;b<arguments.length-2;b++)void 0===arguments[b]&&(j[b]=void 0)}));if(this._xregexp&&this._xregexp.captureNames)for(var l=1;l<j.length;l++)(k=this._xregexp.captureNames[l-1])&&(j[k]=j[l]);!g&&this.global&&!j[0].length&&this.lastIndex>j.index&&this.lastIndex--}return j},g||(RegExp.prototype.test=function(b){b=c.call(this,b);
return b&&this.global&&!b[0].length&&this.lastIndex>b.index&&this.lastIndex--,!!b})});
ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function b(){}function c(b){try{return Object.defineProperty(b,"sentinel",{}),"sentinel"in b}catch(c){}}function d(b){return b=+b,b!==b?b=0:0!==b&&b!==1/0&&b!==-1/0&&(b=(0<b||-1)*Math.floor(Math.abs(b))),b}Function.prototype.bind||(Function.prototype.bind=function(c){var d=this;if("function"!=typeof d)throw new TypeError("Function.prototype.bind called on incompatible "+d);var e=g.call(arguments,1),f=function(){if(this instanceof
f){var b=d.apply(this,e.concat(g.call(arguments)));return Object(b)===b?b:this}return d.apply(c,e.concat(g.call(arguments)))};return d.prototype&&(b.prototype=d.prototype,f.prototype=new b,b.prototype=null),f});var e=Function.prototype.call,f=Object.prototype,g=Array.prototype.slice,h=e.bind(f.toString),j=e.bind(f.hasOwnProperty),k,l,m,n,q;if(q=j(f,"__defineGetter__"))k=e.bind(f.__defineGetter__),l=e.bind(f.__defineSetter__),m=e.bind(f.__lookupGetter__),n=e.bind(f.__lookupSetter__);if(2!=[1,2].splice(0).length)if(function(){function b(c){c=
Array(c+2);return c[0]=c[1]=0,c}var c=[],d;c.splice.apply(c,b(20));c.splice.apply(c,b(26));d=c.length;c.splice(5,0,"XXX");d+1==c.length;if(d+1==c.length)return!0}()){var p=Array.prototype.splice;Array.prototype.splice=function(b,c){return arguments.length?p.apply(this,[void 0===b?0:b,void 0===c?this.length-b:c].concat(g.call(arguments,2))):[]}}else Array.prototype.splice=function(b,c){var d=this.length;0<b?b>d&&(b=d):void 0==b?b=0:0>b&&(b=Math.max(d+b,0));b+c<d||(c=d-b);var e=this.slice(b,b+c),f=
g.call(arguments,2),h=f.length;if(b===d)h&&this.push.apply(this,f);else{var j=Math.min(c,d-b),k=b+j,l=k+h-j,o=d-k,d=d-j;if(l<k)for(j=0;j<o;++j)this[l+j]=this[k+j];else if(l>k)for(j=o;j--;)this[l+j]=this[k+j];if(h&&b===d)this.length=d,this.push.apply(this,f);else{this.length=d+h;for(j=0;j<h;++j)this[b+j]=f[j]}}return e};Array.isArray||(Array.isArray=function(b){return"[object Array]"==h(b)});var e=Object("a"),s="a"!=e[0]||!(0 in e);Array.prototype.forEach||(Array.prototype.forEach=function(b,c){var d=
K(this),e=s&&"[object String]"==h(this)?this.split(""):d,f=-1,g=e.length>>>0;if("[object Function]"!=h(b))throw new TypeError;for(;++f<g;)f in e&&b.call(c,e[f],f,d)});Array.prototype.map||(Array.prototype.map=function(b,c){var d=K(this),e=s&&"[object String]"==h(this)?this.split(""):d,f=e.length>>>0,g=Array(f);if("[object Function]"!=h(b))throw new TypeError(b+" is not a function");for(var j=0;j<f;j++)j in e&&(g[j]=b.call(c,e[j],j,d));return g});Array.prototype.filter||(Array.prototype.filter=function(b,
c){var d=K(this),e=s&&"[object String]"==h(this)?this.split(""):d,f=e.length>>>0,g=[],j;if("[object Function]"!=h(b))throw new TypeError(b+" is not a function");for(var k=0;k<f;k++)k in e&&(j=e[k],b.call(c,j,k,d)&&g.push(j));return g});Array.prototype.every||(Array.prototype.every=function(b,c){var d=K(this),e=s&&"[object String]"==h(this)?this.split(""):d,f=e.length>>>0;if("[object Function]"!=h(b))throw new TypeError(b+" is not a function");for(var g=0;g<f;g++)if(g in e&&!b.call(c,e[g],g,d))return!1;
return!0});Array.prototype.some||(Array.prototype.some=function(b,c){var d=K(this),e=s&&"[object String]"==h(this)?this.split(""):d,f=e.length>>>0;if("[object Function]"!=h(b))throw new TypeError(b+" is not a function");for(var g=0;g<f;g++)if(g in e&&b.call(c,e[g],g,d))return!0;return!1});Array.prototype.reduce||(Array.prototype.reduce=function(b){var c=K(this),d=s&&"[object String]"==h(this)?this.split(""):c,e=d.length>>>0;if("[object Function]"!=h(b))throw new TypeError(b+" is not a function");
if(!e&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var f=0,g;if(2<=arguments.length)g=arguments[1];else{do{if(f in d){g=d[f++];break}if(++f>=e)throw new TypeError("reduce of empty array with no initial value");}while(1)}for(;f<e;f++)f in d&&(g=b.call(void 0,g,d[f],f,c));return g});Array.prototype.reduceRight||(Array.prototype.reduceRight=function(b){var c=K(this),d=s&&"[object String]"==h(this)?this.split(""):c,e=d.length>>>0;if("[object Function]"!=h(b))throw new TypeError(b+
" is not a function");if(!e&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var f,e=e-1;if(2<=arguments.length)f=arguments[1];else{do{if(e in d){f=d[e--];break}if(0>--e)throw new TypeError("reduceRight of empty array with no initial value");}while(1)}do e in this&&(f=b.call(void 0,f,d[e],e,c));while(e--);return f});if(!Array.prototype.indexOf||-1!=[0,1].indexOf(1,2))Array.prototype.indexOf=function(b){var c=s&&"[object String]"==h(this)?this.split(""):
K(this),e=c.length>>>0;if(!e)return-1;var f=0;1<arguments.length&&(f=d(arguments[1]));for(f=0<=f?f:Math.max(0,e+f);f<e;f++)if(f in c&&c[f]===b)return f;return-1};if(!Array.prototype.lastIndexOf||-1!=[0,1].lastIndexOf(0,-3))Array.prototype.lastIndexOf=function(b){var c=s&&"[object String]"==h(this)?this.split(""):K(this),e=c.length>>>0;if(!e)return-1;var f=e-1;1<arguments.length&&(f=Math.min(f,d(arguments[1])));for(f=0<=f?f:e-Math.abs(f);0<=f;f--)if(f in c&&b===c[f])return f;return-1};Object.getPrototypeOf||
(Object.getPrototypeOf=function(b){return b.__proto__||(b.constructor?b.constructor.prototype:f)});Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(b,c){if("object"!=typeof b&&"function"!=typeof b||null===b)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+b);if(j(b,c)){var d,e,g;d={enumerable:!0,configurable:!0};if(q){var h=b.__proto__;b.__proto__=f;e=m(b,c);g=n(b,c);b.__proto__=h;if(e||g)return e&&(d.get=e),g&&(d.set=g),d}return d.value=b[c],
d}});Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(b){return Object.keys(b)});if(!Object.create){var r;null===Object.prototype.__proto__?r=function(){return{__proto__:null}}:r=function(){var b={},c;for(c in b)b[c]=null;return b.constructor=b.hasOwnProperty=b.propertyIsEnumerable=b.isPrototypeOf=b.toLocaleString=b.toString=b.valueOf=b.__proto__=null,b};Object.create=function(b,c){var d;if(b===null)d=r();else{if(typeof b!="object")throw new TypeError("typeof prototype["+typeof b+
"] != 'object'");d=function(){};d.prototype=b;d=new d;d.__proto__=b}return c!==void 0&&Object.defineProperties(d,c),d}}if(Object.defineProperty){var e=c({}),o="undefined"==typeof document||c(document.createElement("div"));if(!e||!o)var t=Object.defineProperty}if(!Object.defineProperty||t)Object.defineProperty=function(b,c,d){if(typeof b!="object"&&typeof b!="function"||b===null)throw new TypeError("Object.defineProperty called on non-object: "+b);if(typeof d!="object"&&typeof d!="function"||d===null)throw new TypeError("Property description must be an object: "+
d);if(t)try{return t.call(Object,b,c,d)}catch(e){}if(j(d,"value"))if(q&&(m(b,c)||n(b,c))){var g=b.__proto__;b.__proto__=f;delete b[c];b[c]=d.value;b.__proto__=g}else b[c]=d.value;else{if(!q)throw new TypeError("getters & setters can not be defined on this javascript engine");j(d,"get")&&k(b,c,d.get);j(d,"set")&&l(b,c,d.set)}return b};Object.defineProperties||(Object.defineProperties=function(b,c){for(var d in c)j(c,d)&&Object.defineProperty(b,d,c[d]);return b});Object.seal||(Object.seal=function(b){return b});
Object.freeze||(Object.freeze=function(b){return b});try{Object.freeze(function(){})}catch(u){Object.freeze=function(b){return function(c){return typeof c=="function"?c:b(c)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(b){return b});Object.isSealed||(Object.isSealed=function(){return false});Object.isFrozen||(Object.isFrozen=function(){return false});Object.isExtensible||(Object.isExtensible=function(b){if(Object(b)===b)throw new TypeError;for(var c="";j(b,c);)c=c+
"?";b[c]=true;var d=j(b,c);return delete b[c],d});if(!Object.keys){var w=!0,z="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),A=z.length,C;for(C in{toString:null})w=!1;Object.keys=function(b){if(typeof b!="object"&&typeof b!="function"||b===null)throw new TypeError("Object.keys called on a non-object");var c=[],d;for(d in b)j(b,d)&&c.push(d);if(w)for(d=0;d<A;d++){var e=z[d];j(b,e)&&c.push(e)}return c}}Date.now||(Date.now=function(){return(new Date).getTime()});
C="\t\n\x0B\u000c\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff";if(!String.prototype.trim||C.trim()){C="["+C+"]";var G=RegExp("^"+C+C+"*"),H=RegExp(C+C+"*$");String.prototype.trim=function(){return(""+this).replace(G,"").replace(H,"")}}var K=function(b){if(b==null)throw new TypeError("can't convert "+b+" to object");return Object(b)}});
ace.define("ace/lib/dom",["require","exports","module"],function(b,c){"undefined"!=typeof document&&(c.getDocumentHead=function(b){return b||(b=document),b.head||b.getElementsByTagName("head")[0]||b.documentElement},c.createElement=function(b,c){return document.createElementNS?document.createElementNS(c||"http://www.w3.org/1999/xhtml",b):document.createElement(b)},c.hasCssClass=function(b,c){return-1!==b.className.split(/\s+/g).indexOf(c)},c.addCssClass=function(b,e){c.hasCssClass(b,e)||(b.className+=
" "+e)},c.removeCssClass=function(b,c){for(var f=b.className.split(/\s+/g);;){var g=f.indexOf(c);if(-1==g)break;f.splice(g,1)}b.className=f.join(" ")},c.toggleCssClass=function(b,c){for(var f=b.className.split(/\s+/g),g=!0;;){var h=f.indexOf(c);if(-1==h)break;g=!1;f.splice(h,1)}return g&&f.push(c),b.className=f.join(" "),g},c.setCssClass=function(b,e,f){f?c.addCssClass(b,e):c.removeCssClass(b,e)},c.hasCssString=function(b,c){var f=0,g,c=c||document;if(c.createStyleSheet&&(g=c.styleSheets))for(;f<
g.length;){if(g[f++].owningElement.id===b)return!0}else if(g=c.getElementsByTagName("style"))for(;f<g.length;)if(g[f++].id===b)return!0;return!1},c.importCssString=function(b,e,f){f=f||document;if(e&&c.hasCssString(e,f))return null;var g;f.createStyleSheet?(g=f.createStyleSheet(),g.cssText=b,e&&(g.owningElement.id=e)):(g=f.createElementNS?f.createElementNS("http://www.w3.org/1999/xhtml","style"):f.createElement("style"),g.appendChild(f.createTextNode(b)),e&&(g.id=e),c.getDocumentHead(f).appendChild(g))},
c.importCssStylsheet=function(b,e){if(e.createStyleSheet)e.createStyleSheet(b);else{var f=c.createElement("link");f.rel="stylesheet";f.href=b;c.getDocumentHead(e).appendChild(f)}},c.getInnerWidth=function(b){return parseInt(c.computedStyle(b,"paddingLeft"),10)+parseInt(c.computedStyle(b,"paddingRight"),10)+b.clientWidth},c.getInnerHeight=function(b){return parseInt(c.computedStyle(b,"paddingTop"),10)+parseInt(c.computedStyle(b,"paddingBottom"),10)+b.clientHeight},void 0!==window.pageYOffset?(c.getPageScrollTop=
function(){return window.pageYOffset},c.getPageScrollLeft=function(){return window.pageXOffset}):(c.getPageScrollTop=function(){return document.body.scrollTop},c.getPageScrollLeft=function(){return document.body.scrollLeft}),window.getComputedStyle?c.computedStyle=function(b,c){return c?(window.getComputedStyle(b,"")||{})[c]||"":window.getComputedStyle(b,"")||{}}:c.computedStyle=function(b,c){return c?b.currentStyle[c]:b.currentStyle},c.scrollbarWidth=function(b){var e=c.createElement("ace_inner");
e.style.width="100%";e.style.minWidth="0px";e.style.height="200px";e.style.display="block";var f=c.createElement("ace_outer"),g=f.style;g.position="absolute";g.left="-10000px";g.overflow="hidden";g.width="200px";g.minWidth="0px";g.height="150px";g.display="block";f.appendChild(e);b=b.documentElement;b.appendChild(f);var h=e.offsetWidth;g.overflow="scroll";e=e.offsetWidth;return h==e&&(e=f.clientWidth),b.removeChild(f),h-e},c.setInnerHtml=function(b,c){var f=b.cloneNode(!1);return f.innerHTML=c,b.parentNode.replaceChild(f,
b),f},"textContent"in document.documentElement?(c.setInnerText=function(b,c){b.textContent=c},c.getInnerText=function(b){return b.textContent}):(c.setInnerText=function(b,c){b.innerText=c},c.getInnerText=function(b){return b.innerText}),c.getParentWindow=function(b){return b.defaultView||b.parentWindow})});
ace.define("ace/lib/event","require exports module ace/lib/keys ace/lib/useragent ace/lib/dom".split(" "),function(b,c){function d(b,c,d){var m=0;!f.isOpera||"KeyboardEvent"in window||!f.isMac?m=0|(c.ctrlKey?1:0)|(c.altKey?2:0)|(c.shiftKey?4:0)|(c.metaKey?8:0):m=0|(c.metaKey?1:0)|(c.altKey?2:0)|(c.shiftKey?4:0)|(c.ctrlKey?8:0);if(!f.isMac&&g){if(g[91]||g[92])m=m|8;if(g.altGr){if((3&m)==3)return;g.altGr=0}if(d===18||d===17){var n=c.location||c.keyLocation;if(d===17&&n===1)h=c.timeStamp;else if(d===
18&&m===3&&n===2){n=-h;h=c.timeStamp;n=n+h;n<3&&(g.altGr=true)}}}if(d in e.MODIFIER_KEYS){switch(e.MODIFIER_KEYS[d]){case "Alt":m=2;break;case "Shift":m=4;break;case "Ctrl":m=1;break;default:m=8}d=0}m&8&&(d===91||d===93)&&(d=0);if(!m&&d===13&&(c.location||c.keyLocation===3)){b(c,m,-d);if(c.defaultPrevented)return}return m||d in e.FUNCTION_KEYS||d in e.PRINTABLE_KEYS?b(c,m,d):false}var e=b("./keys"),f=b("./useragent");b("./dom");c.addListener=function(b,c,d){if(b.addEventListener)return b.addEventListener(c,
d,false);if(b.attachEvent){var e=function(){d.call(b,window.event)};d._wrapper=e;b.attachEvent("on"+c,e)}};c.removeListener=function(b,c,d){if(b.removeEventListener)return b.removeEventListener(c,d,false);b.detachEvent&&b.detachEvent("on"+c,d._wrapper||d)};c.stopEvent=function(b){return c.stopPropagation(b),c.preventDefault(b),false};c.stopPropagation=function(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=true};c.preventDefault=function(b){b.preventDefault?b.preventDefault():b.returnValue=
false};c.getButton=function(b){return b.type=="dblclick"?0:b.type=="contextmenu"||b.ctrlKey&&f.isMac?2:b.preventDefault?b.button:{1:0,2:2,4:1}[b.button]};c.capture=function(b,d,e){function f(b){d&&d(b);e&&e(b);c.removeListener(document,"mousemove",d,true);c.removeListener(document,"mouseup",f,true);c.removeListener(document,"dragstart",f,true)}return c.addListener(document,"mousemove",d,true),c.addListener(document,"mouseup",f,true),c.addListener(document,"dragstart",f,true),f};c.addMouseWheelListener=
function(b,d){"onmousewheel"in b?c.addListener(b,"mousewheel",function(b){b.wheelDeltaX!==void 0?(b.wheelX=-b.wheelDeltaX/8,b.wheelY=-b.wheelDeltaY/8):(b.wheelX=0,b.wheelY=-b.wheelDelta/8);d(b)}):"onwheel"in b?c.addListener(b,"wheel",function(b){switch(b.deltaMode){case b.DOM_DELTA_PIXEL:b.wheelX=b.deltaX*0.35||0;b.wheelY=b.deltaY*0.35||0;break;case b.DOM_DELTA_LINE:case b.DOM_DELTA_PAGE:b.wheelX=(b.deltaX||0)*5;b.wheelY=(b.deltaY||0)*5}d(b)}):c.addListener(b,"DOMMouseScroll",function(b){b.axis&&
b.axis==b.HORIZONTAL_AXIS?(b.wheelX=(b.detail||0)*5,b.wheelY=0):(b.wheelX=0,b.wheelY=(b.detail||0)*5);d(b)})};c.addMultiMouseDownListener=function(b,d,e,g){var h=0,q,p,s,r={2:"dblclick",3:"tripleclick",4:"quadclick"};c.addListener(b,"mousedown",function(b){c.getButton(b)!=0?h=0:b.detail>1?(h++,h>4&&(h=1)):h=1;if(f.isIE){(Math.abs(b.clientX-q)>5||Math.abs(b.clientY-p)>5)&&(h=1);h==1&&(q=b.clientX,p=b.clientY)}e[g]("mousedown",b);if(h>4)h=0;else if(h>1)return e[g](r[h],b)});f.isOldIE&&c.addListener(b,
"dblclick",function(b){h=2;s&&clearTimeout(s);s=setTimeout(function(){s=null},d[h-1]||600);e[g]("mousedown",b);e[g](r[h],b)})};var g=null,h=0;c.addCommandKeyListener=function(b,e){var h=c.addListener;if(f.isOldGecko||f.isOpera&&!("KeyboardEvent"in window)){var m=null;h(b,"keydown",function(b){m=b.keyCode});h(b,"keypress",function(b){return d(e,b,m)})}else{var n=null;h(b,"keydown",function(b){g[b.keyCode]=true;var c=d(e,b,b.keyCode);return n=b.defaultPrevented,c});h(b,"keypress",function(b){n&&(b.ctrlKey||
b.altKey||b.shiftKey||b.metaKey)&&(c.stopEvent(b),n=null)});h(b,"keyup",function(b){g[b.keyCode]=null});g||(g=Object.create(null),h(window,"focus",function(){g=Object.create(null)}))}};if(window.postMessage&&!f.isOldIE)c.nextTick=function(b,d){d=d||window;c.addListener(d,"message",function m(e){e.data=="zero-timeout-message-1"&&(c.stopPropagation(e),c.removeListener(d,"message",m),b())});d.postMessage("zero-timeout-message-1","*")};c.nextFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||
window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;c.nextFrame?c.nextFrame=c.nextFrame.bind(window):c.nextFrame=function(b){setTimeout(b,17)}});
ace.define("ace/lib/keys",["require","exports","module","ace/lib/oop"],function(b,c){var d=b("./oop"),e=function(){var b={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,meta:8,command:8,cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",
101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",
88:"x",89:"y",90:"z",107:"+",109:"-",110:".",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}},c;for(c in b.FUNCTION_KEYS){var e=b.FUNCTION_KEYS[c].toLowerCase();b[e]=parseInt(c,10)}return d.mixin(b,b.MODIFIER_KEYS),d.mixin(b,b.PRINTABLE_KEYS),d.mixin(b,b.FUNCTION_KEYS),b.enter=b["return"],b.escape=b.esc,b.del=b["delete"],b[173]="-",b}();d.mixin(c,e);c.keyCodeToString=function(b){return(e[b]||String.fromCharCode(b)).toLowerCase()}});
ace.define("ace/lib/oop",["require","exports","module"],function(b,c){c.inherits=function(b,c){b.super_=c;b.prototype=Object.create(c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})};c.mixin=function(b,c){for(var f in c)b[f]=c[f];return b};c.implement=function(b,e){c.mixin(b,e)}});
ace.define("ace/lib/useragent",["require","exports","module"],function(b,c){c.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"};c.getOS=function(){return c.isMac?c.OS.MAC:c.isLinux?c.OS.LINUX:c.OS.WINDOWS};if("object"==typeof navigator){var d=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),e=navigator.userAgent;c.isWin="win"==d;c.isMac="mac"==d;c.isLinux="linux"==d;c.isIE=("Microsoft Internet Explorer"==navigator.appName||0<=navigator.appName.indexOf("MSAppHost"))&&parseFloat(navigator.userAgent.match(/MSIE ([0-9]+[\.0-9]+)/)[1]);
c.isOldIE=c.isIE&&9>c.isIE;c.isGecko=c.isMozilla=window.controllers&&"Gecko"===window.navigator.product;c.isOldGecko=c.isGecko&&4>parseInt((navigator.userAgent.match(/rv\:(\d+)/)||[])[1],10);c.isOpera=window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera);c.isWebKit=parseFloat(e.split("WebKit/")[1])||void 0;c.isChrome=parseFloat(e.split(" Chrome/")[1])||void 0;c.isAIR=0<=e.indexOf("AdobeAIR");c.isIPad=0<=e.indexOf("iPad");c.isTouchPad=0<=e.indexOf("TouchPad")}});
ace.define("ace/editor","require exports module ace/lib/fixoldbrowsers ace/lib/oop ace/lib/dom ace/lib/lang ace/lib/useragent ace/keyboard/textinput ace/mouse/mouse_handler ace/mouse/fold_handler ace/keyboard/keybinding ace/edit_session ace/search ace/range ace/lib/event_emitter ace/commands/command_manager ace/commands/default_commands ace/config".split(" "),function(b,c){b("./lib/fixoldbrowsers");var d=b("./lib/oop"),e=b("./lib/dom"),f=b("./lib/lang"),g=b("./lib/useragent"),h=b("./keyboard/textinput").TextInput,
j=b("./mouse/mouse_handler").MouseHandler,k=b("./mouse/fold_handler").FoldHandler,l=b("./keyboard/keybinding").KeyBinding,m=b("./edit_session").EditSession,n=b("./search").Search,q=b("./range").Range,p=b("./lib/event_emitter").EventEmitter,s=b("./commands/command_manager").CommandManager,r=b("./commands/default_commands").commands,o=b("./config"),t=function(b,c){this.container=b.getContainerElement();this.renderer=b;this.commands=new s(g.isMac?"mac":"win",r);this.textInput=new h(b.getTextAreaContainer(),
this);this.renderer.textarea=this.textInput.getElement();this.keyBinding=new l(this);this.$mouseHandler=new j(this);new k(this);this.$blockScrolling=0;this.$search=(new n).set({wrap:true});this.$historyTracker=this.$historyTracker.bind(this);this.commands.on("exec",this.$historyTracker);this.$initOperationListeners();this._$emitInputEvent=f.delayedCall(function(){this._signal("input",{});this.session.bgTokenizer&&this.session.bgTokenizer.scheduleStart()}.bind(this));this.on("change",function(b,c){c._$emitInputEvent.schedule(31)});
this.setSession(c||new m(""));o.resetOptions(this);o._emit("editor",this)};(function(){d.implement(this,p);this.$initOperationListeners=function(){this.selections=[];this.commands.on("exec",function(b){this.startOperation(b);if(b.command.aceCommandGroup=="fileJump"){b=this.prevOp;if(!b||b.command.aceCommandGroup!="fileJump")this.lastFileJumpPos=this.selections[this.selections.length-1]}else this.lastFileJumpPos=null}.bind(this),true);this.commands.on("afterExec",function(b){b.command.aceCommandGroup==
"fileJump"&&this.lastFileJumpPos&&!this.curOp.selectionChanged&&this.selection.fromJSON(this.lastFileJumpPos);this.endOperation(b)}.bind(this),true);this.$opResetTimer=f.delayedCall(this.endOperation.bind(this));this.on("change",function(){this.curOp||this.startOperation();this.curOp.docChanged=true}.bind(this),true);this.on("changeSelection",function(){this.curOp||this.startOperation();this.curOp.selectionChanged=true}.bind(this),true)};this.curOp=null;this.prevOp={};this.startOperation=function(b){if(this.curOp){if(!b||
this.curOp.command)return;this.prevOp=this.curOp}b||(this.previousCommand=null,b={});this.$opResetTimer.schedule();this.curOp={command:b.command||{},args:b.args,scrollTop:this.renderer.scrollTop};(b=this.curOp.command)&&b.scrollIntoView&&this.$blockScrolling++;this.selections.push(this.selection.toJSON())};this.endOperation=function(){if(this.curOp){var b=this.curOp.command;if(b&&b.scrollIntoView){this.$blockScrolling--;switch(b.scrollIntoView){case "center":this.renderer.scrollCursorIntoView(null,
0.5);break;case "animate":case "cursor":this.renderer.scrollCursorIntoView();break;case "selectionPart":var c=this.selection.getRange(),d=this.renderer.layerConfig;(c.start.row>=d.lastRow||c.end.row<=d.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}b.scrollIntoView=="animate"&&this.renderer.animateScrolling(this.curOp.scrollTop)}this.prevOp=this.curOp;this.curOp=null}};this.$historyTracker=function(b){if(this.$mergeUndoDeltas){var c=this.prevOp,d=["backspace",
"del","insertstring"],e=c.command&&b.command.name==c.command.name;if(b.command.name=="insertstring"){var f=b.args;this.mergeNextCommand===void 0&&(this.mergeNextCommand=true);e=e&&this.mergeNextCommand&&(!/\s/.test(f)||/\s/.test(c.args));this.mergeNextCommand=true}else e=e&&d.indexOf(b.command.name)!==-1;this.$mergeUndoDeltas!="always"&&Date.now()-this.sequenceStartTime>2E3&&(e=false);e?this.session.mergeUndoDeltas=true:d.indexOf(b.command.name)!==-1&&(this.sequenceStartTime=Date.now())}};this.setKeyboardHandler=
function(b){if(b)if(typeof b=="string"){this.$keybindingId=b;var c=this;o.loadModule(["keybinding",b],function(d){c.$keybindingId==b&&c.keyBinding.setKeyboardHandler(d&&d.handler)})}else{this.$keybindingId=null;this.keyBinding.setKeyboardHandler(b)}else this.keyBinding.setKeyboardHandler(null)};this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()};this.setSession=function(b){if(this.session!=b){if(this.session){var c=this.session;this.session.removeEventListener("change",
this.$onDocumentChange);this.session.removeEventListener("changeMode",this.$onChangeMode);this.session.removeEventListener("tokenizerUpdate",this.$onTokenizerUpdate);this.session.removeEventListener("changeTabSize",this.$onChangeTabSize);this.session.removeEventListener("changeWrapLimit",this.$onChangeWrapLimit);this.session.removeEventListener("changeWrapMode",this.$onChangeWrapMode);this.session.removeEventListener("onChangeFold",this.$onChangeFold);this.session.removeEventListener("changeFrontMarker",
this.$onChangeFrontMarker);this.session.removeEventListener("changeBackMarker",this.$onChangeBackMarker);this.session.removeEventListener("changeBreakpoint",this.$onChangeBreakpoint);this.session.removeEventListener("changeAnnotation",this.$onChangeAnnotation);this.session.removeEventListener("changeOverwrite",this.$onCursorChange);this.session.removeEventListener("changeScrollTop",this.$onScrollTopChange);this.session.removeEventListener("changeScrollLeft",this.$onScrollLeftChange);var d=this.session.getSelection();
d.removeEventListener("changeCursor",this.$onCursorChange);d.removeEventListener("changeSelection",this.$onSelectionChange)}this.session=b;this.$onDocumentChange=this.onDocumentChange.bind(this);b.addEventListener("change",this.$onDocumentChange);this.renderer.setSession(b);this.$onChangeMode=this.onChangeMode.bind(this);b.addEventListener("changeMode",this.$onChangeMode);this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this);b.addEventListener("tokenizerUpdate",this.$onTokenizerUpdate);this.$onChangeTabSize=
this.renderer.onChangeTabSize.bind(this.renderer);b.addEventListener("changeTabSize",this.$onChangeTabSize);this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this);b.addEventListener("changeWrapLimit",this.$onChangeWrapLimit);this.$onChangeWrapMode=this.onChangeWrapMode.bind(this);b.addEventListener("changeWrapMode",this.$onChangeWrapMode);this.$onChangeFold=this.onChangeFold.bind(this);b.addEventListener("changeFold",this.$onChangeFold);this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this);
this.session.addEventListener("changeFrontMarker",this.$onChangeFrontMarker);this.$onChangeBackMarker=this.onChangeBackMarker.bind(this);this.session.addEventListener("changeBackMarker",this.$onChangeBackMarker);this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this);this.session.addEventListener("changeBreakpoint",this.$onChangeBreakpoint);this.$onChangeAnnotation=this.onChangeAnnotation.bind(this);this.session.addEventListener("changeAnnotation",this.$onChangeAnnotation);this.$onCursorChange=
this.onCursorChange.bind(this);this.session.addEventListener("changeOverwrite",this.$onCursorChange);this.$onScrollTopChange=this.onScrollTopChange.bind(this);this.session.addEventListener("changeScrollTop",this.$onScrollTopChange);this.$onScrollLeftChange=this.onScrollLeftChange.bind(this);this.session.addEventListener("changeScrollLeft",this.$onScrollLeftChange);this.selection=b.getSelection();this.selection.addEventListener("changeCursor",this.$onCursorChange);this.$onSelectionChange=this.onSelectionChange.bind(this);
this.selection.addEventListener("changeSelection",this.$onSelectionChange);this.onChangeMode();this.$blockScrolling=this.$blockScrolling+1;this.onCursorChange();this.$blockScrolling=this.$blockScrolling-1;this.onScrollTopChange();this.onScrollLeftChange();this.onSelectionChange();this.onChangeFrontMarker();this.onChangeBackMarker();this.onChangeBreakpoint();this.onChangeAnnotation();this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit();this.renderer.updateFull();this._emit("changeSession",
{session:b,oldSession:c})}};this.getSession=function(){return this.session};this.setValue=function(b,c){return this.session.doc.setValue(b),c?c==1?this.navigateFileEnd():c==-1&&this.navigateFileStart():this.selectAll(),b};this.getValue=function(){return this.session.getValue()};this.getSelection=function(){return this.selection};this.resize=function(b){this.renderer.onResize(b)};this.setTheme=function(b){this.renderer.setTheme(b)};this.getTheme=function(){return this.renderer.getTheme()};this.setStyle=
function(b){this.renderer.setStyle(b)};this.unsetStyle=function(b){this.renderer.unsetStyle(b)};this.getFontSize=function(){return this.getOption("fontSize")||e.computedStyle(this.container,"fontSize")};this.setFontSize=function(b){this.setOption("fontSize",b)};this.$highlightBrackets=function(){this.session.$bracketHighlight&&(this.session.removeMarker(this.session.$bracketHighlight),this.session.$bracketHighlight=null);if(!this.$highlightPending){var b=this;this.$highlightPending=true;setTimeout(function(){b.$highlightPending=
false;var c=b.session.findMatchingBracket(b.getCursorPosition());if(c)var d=new q(c.row,c.column,c.row,c.column+1);else b.session.$mode.getMatching&&(d=b.session.$mode.getMatching(b.session));d&&(b.session.$bracketHighlight=b.session.addMarker(d,"ace_bracket","text"))},50)}};this.focus=function(){var b=this;setTimeout(function(){b.textInput.focus()});this.textInput.focus()};this.isFocused=function(){return this.textInput.isFocused()};this.blur=function(){this.textInput.blur()};this.onFocus=function(){if(!this.$isFocused){this.$isFocused=
true;this.renderer.showCursor();this.renderer.visualizeFocus();this._emit("focus")}};this.onBlur=function(){if(this.$isFocused){this.$isFocused=false;this.renderer.hideCursor();this.renderer.visualizeBlur();this._emit("blur")}};this.$cursorChange=function(){this.renderer.updateCursor()};this.onDocumentChange=function(b){var c=b.data,d=c.range,e;d.start.row==d.end.row&&c.action!="insertLines"&&c.action!="removeLines"?e=d.end.row:e=Infinity;this.renderer.updateLines(d.start.row,e);this._emit("change",
b);this.$cursorChange()};this.onTokenizerUpdate=function(b){b=b.data;this.renderer.updateLines(b.first,b.last)};this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())};this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())};this.onCursorChange=function(){this.$cursorChange();this.$blockScrolling||this.renderer.scrollCursorIntoView();this.$highlightBrackets();this.$updateHighlightActiveLine();this._emit("changeSelection")};this.$updateHighlightActiveLine=
function(){var b=this.getSession(),c;if(this.$highlightActiveLine){if(this.$selectionStyle!="line"||!this.selection.isMultiLine())c=this.getCursorPosition();this.renderer.$maxLines&&this.session.getLength()===1&&(c=false)}if(b.$highlightLineMarker&&!c){b.removeMarker(b.$highlightLineMarker.id);b.$highlightLineMarker=null}else if(!b.$highlightLineMarker&&c){c=new q(c.row,c.column,c.row,Infinity);c.id=b.addMarker(c,"ace_active-line","screenLine");b.$highlightLineMarker=c}else c&&(b.$highlightLineMarker.start.row=
c.row,b.$highlightLineMarker.end.row=c.row,b.$highlightLineMarker.start.column=c.column,b._emit("changeBackMarker"))};this.onSelectionChange=function(){var b=this.session;b.$selectionMarker&&b.removeMarker(b.$selectionMarker);b.$selectionMarker=null;if(this.selection.isEmpty())this.$updateHighlightActiveLine();else{var c=this.selection.getRange(),d=this.getSelectionStyle();b.$selectionMarker=b.addMarker(c,"ace_selection",d)}this.session.highlight(this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp());
this._emit("changeSelection")};this.$getSelectionHighLightRegexp=function(){var b=this.session,c=this.getSelectionRange();if(!c.isEmpty()&&!c.isMultiLine()){var d=c.start.column-1,e=c.end.column+1,b=b.getLine(c.start.row),f=b.length,g=b.substring(Math.max(d,0),Math.min(e,f));if(!(d>=0&&/^[\w\d]/.test(g)||e<=f&&/[\w\d]$/.test(g))){g=b.substring(c.start.column,c.end.column);if(/^[\w\d]+$/.test(g))return this.$search.$assembleRegExp({wholeWord:true,caseSensitive:true,needle:g})}}};this.onChangeFrontMarker=
function(){this.renderer.updateFrontMarkers()};this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()};this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()};this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())};this.onChangeMode=function(b){this.renderer.updateText();this._emit("changeMode",b)};this.onChangeWrapLimit=function(){this.renderer.updateFull()};this.onChangeWrapMode=function(){this.renderer.onResize(true)};this.onChangeFold=
function(){this.$updateHighlightActiveLine();this.renderer.updateFull()};this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())};this.getCopyText=function(){var b=this.getSelectedText();return this._signal("copy",b),b};this.onCopy=function(){this.commands.exec("copy",this)};this.onCut=function(){this.commands.exec("cut",this)};this.onPaste=function(b){if(!this.$readOnly){this._emit("paste",b);this.insert(b)}};this.execCommand=function(b,c){this.commands.exec(b,
this,c)};this.insert=function(b){var c=this.session,d=c.getMode(),e=this.getCursorPosition();if(this.getBehavioursEnabled()){var f=d.transformAction(c.getState(e.row),"insertion",this,c,b);f&&(b!==f.text&&(this.session.mergeUndoDeltas=false,this.$mergeNextCommand=false),b=f.text)}b=="\t"&&(b=this.session.getTabString());if(this.selection.isEmpty()){if(this.session.getOverwrite()){g=new q.fromPoints(e,e);g.end.column=g.end.column+b.length;this.session.remove(g)}}else{var g=this.getSelectionRange(),
e=this.session.remove(g);this.clearSelection()}if(b=="\n"||b=="\r\n"){var h=c.getLine(e.row);if(e.column>h.search(/\S|$/)){g=h.substr(e.column).search(/\S|$/);c.doc.removeInLine(e.row,e.column,e.column+g)}}this.clearSelection();var j=e.column,g=c.getState(e.row),h=c.getLine(e.row),k=d.checkOutdent(g,h,b);c.insert(e,b);f&&f.selection&&(f.selection.length==2?this.selection.setSelectionRange(new q(e.row,j+f.selection[0],e.row,j+f.selection[1])):this.selection.setSelectionRange(new q(e.row+f.selection[0],
f.selection[1],e.row+f.selection[2],f.selection[3])));if(c.getDocument().isNewLine(b)){b=d.getNextLineIndent(g,h.slice(0,e.column),c.getTabString());c.insert({row:e.row+1,column:0},b)}k&&d.autoOutdent(g,c,e.row)};this.onTextInput=function(b){this.keyBinding.onTextInput(b)};this.onCommandKey=function(b,c,d){this.keyBinding.onCommandKey(b,c,d)};this.setOverwrite=function(b){this.session.setOverwrite(b)};this.getOverwrite=function(){return this.session.getOverwrite()};this.toggleOverwrite=function(){this.session.toggleOverwrite()};
this.setScrollSpeed=function(b){this.setOption("scrollSpeed",b)};this.getScrollSpeed=function(){return this.getOption("scrollSpeed")};this.setDragDelay=function(b){this.setOption("dragDelay",b)};this.getDragDelay=function(){return this.getOption("dragDelay")};this.setSelectionStyle=function(b){this.setOption("selectionStyle",b)};this.getSelectionStyle=function(){return this.getOption("selectionStyle")};this.setHighlightActiveLine=function(b){this.setOption("highlightActiveLine",b)};this.getHighlightActiveLine=
function(){return this.getOption("highlightActiveLine")};this.setHighlightGutterLine=function(b){this.setOption("highlightGutterLine",b)};this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")};this.setHighlightSelectedWord=function(b){this.setOption("highlightSelectedWord",b)};this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord};this.setAnimatedScroll=function(b){this.renderer.setAnimatedScroll(b)};this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()};
this.setShowInvisibles=function(b){this.renderer.setShowInvisibles(b)};this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()};this.setDisplayIndentGuides=function(b){this.renderer.setDisplayIndentGuides(b)};this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()};this.setShowPrintMargin=function(b){this.renderer.setShowPrintMargin(b)};this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()};this.setPrintMarginColumn=function(b){this.renderer.setPrintMarginColumn(b)};
this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()};this.setReadOnly=function(b){this.setOption("readOnly",b)};this.getReadOnly=function(){return this.getOption("readOnly")};this.setBehavioursEnabled=function(b){this.setOption("behavioursEnabled",b)};this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")};this.setWrapBehavioursEnabled=function(b){this.setOption("wrapBehavioursEnabled",b)};this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")};
this.setShowFoldWidgets=function(b){this.setOption("showFoldWidgets",b)};this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")};this.setFadeFoldWidgets=function(b){this.setOption("fadeFoldWidgets",b)};this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")};this.remove=function(b){this.selection.isEmpty()&&(b=="left"?this.selection.selectLeft():this.selection.selectRight());b=this.getSelectionRange();if(this.getBehavioursEnabled()){var c=this.session,d=c.getState(b.start.row),
d=c.getMode().transformAction(d,"deletion",this,c,b);if(b.end.column===0){var e=c.getTextRange(b);if(e[e.length-1]=="\n"){c=c.getLine(b.end.row);/^\s+$/.test(c)&&(b.end.column=c.length)}}d&&(b=d)}this.session.remove(b);this.clearSelection()};this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight();this.session.remove(this.getSelectionRange());this.clearSelection()};this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft();this.session.remove(this.getSelectionRange());
this.clearSelection()};this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart();this.session.remove(this.getSelectionRange());this.clearSelection()};this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var b=this.getSelectionRange();b.start.column==b.end.column&&b.start.row==b.end.row&&(b.end.column=0,b.end.row++);this.session.remove(b);this.clearSelection()};this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),
this.clearSelection());var b=this.getCursorPosition();this.insert("\n");this.moveCursorToPosition(b)};this.transposeLetters=function(){if(this.selection.isEmpty()){var b=this.getCursorPosition(),c=b.column;if(c!==0){var d=this.session.getLine(b.row),e,f;c<d.length?(e=d.charAt(c)+d.charAt(c-1),f=new q(b.row,c-1,b.row,c+1)):(e=d.charAt(c-1)+d.charAt(c-2),f=new q(b.row,c-2,b.row,c));this.session.replace(f,e)}}};this.toLowerCase=function(){var b=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();
var c=this.getSelectionRange(),d=this.session.getTextRange(c);this.session.replace(c,d.toLowerCase());this.selection.setSelectionRange(b)};this.toUpperCase=function(){var b=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var c=this.getSelectionRange(),d=this.session.getTextRange(c);this.session.replace(c,d.toUpperCase());this.selection.setSelectionRange(b)};this.indent=function(){var b=this.session,c=this.getSelectionRange();if(c.start.row<c.end.row){c=this.$getSelectedRows();
b.indentRows(c.first,c.last,"\t")}else if(c.start.column<c.end.column&&!/^\s+$/.test(b.getTextRange(c))){c=this.$getSelectedRows();b.indentRows(c.first,c.last,"\t")}else{var d=b.getLine(c.start.row),e=c.start,g=b.getTabSize(),b=b.documentToScreenColumn(e.row,e.column);if(this.session.getUseSoftTabs())c=f.stringRepeat(" ",g-b%g);else{for(b=b%g;d[c.start.column]==" "&&b;){c.start.column--;b--}this.selection.setSelectionRange(c);c="\t"}return this.insert(c)}};this.blockIndent=function(){var b=this.$getSelectedRows();
this.session.indentRows(b.first,b.last,"\t")};this.blockOutdent=function(){this.session.outdentRows(this.session.getSelection().getRange())};this.sortLines=function(){for(var b=this.$getSelectedRows(),c=this.session,d=[],e=b.first;e<=b.last;e++)d.push(c.getLine(e));d.sort(function(b,c){return b.toLowerCase()<c.toLowerCase()?-1:b.toLowerCase()>c.toLowerCase()?1:0});for(var f=new q(0,0,0,0),e=b.first;e<=b.last;e++){var g=c.getLine(e);f.start.row=e;f.end.row=e;f.end.column=g.length;c.replace(f,d[e-b.first])}};
this.toggleCommentLines=function(){var b=this.session.getState(this.getCursorPosition().row),c=this.$getSelectedRows();this.session.getMode().toggleCommentLines(b,this.session,c.first,c.last)};this.toggleBlockComment=function(){var b=this.getCursorPosition(),c=this.session.getState(b.row),d=this.getSelectionRange();this.session.getMode().toggleBlockComment(c,this.session,d,b)};this.getNumberAt=function(b,c){var d=/[\-]?[0-9]+(?:\.[0-9]+)?/g;d.lastIndex=0;for(var e=this.session.getLine(b);d.lastIndex<
c;){var f=d.exec(e);if(f.index<=c&&f.index+f[0].length>=c)return{value:f[0],start:f.index,end:f.index+f[0].length}}return null};this.modifyNumber=function(b){var c=this.selection.getCursor().row,d=this.selection.getCursor().column,e=this.session.getTextRange(new q(c,d-1,c,d));if(!isNaN(parseFloat(e))&&isFinite(e))if(e=this.getNumberAt(c,d)){var f=e.value.indexOf(".")>=0?e.start+e.value.indexOf(".")+1:e.end,g=e.start+e.value.length-f,h=parseFloat(e.value),h=h*Math.pow(10,g);f!==e.end&&d<f?b=b*Math.pow(10,
e.end-d-1):b=b*Math.pow(10,e.end-d);h=(h+b)/Math.pow(10,g);b=h.toFixed(g);this.session.replace(new q(c,e.start,c,e.end),b);this.moveCursorTo(c,Math.max(e.start+1,d+b.length-e.value.length))}};this.removeLines=function(){var b=this.$getSelectedRows(),c;b.first===0||b.last+1<this.session.getLength()?c=new q(b.first,0,b.last+1,0):c=new q(b.first-1,this.session.getLine(b.first-1).length,b.last,this.session.getLine(b.last).length);this.session.remove(c);this.clearSelection()};this.duplicateSelection=function(){var b=
this.selection,c=this.session,d=b.getRange(),e=b.isBackwards();if(d.isEmpty()){b=d.start.row;c.duplicateLines(b,b)}else{var f=e?d.start:d.end,c=c.insert(f,c.getTextRange(d),false);d.start=f;d.end=c;b.setSelectionRange(d,e)}};this.moveLinesDown=function(){this.$moveLines(function(b,c){return this.session.moveLinesDown(b,c)})};this.moveLinesUp=function(){this.$moveLines(function(b,c){return this.session.moveLinesUp(b,c)})};this.moveText=function(b,c,d){return this.session.moveText(b,c,d)};this.copyLinesUp=
function(){this.$moveLines(function(b,c){return this.session.duplicateLines(b,c),0})};this.copyLinesDown=function(){this.$moveLines(function(b,c){return this.session.duplicateLines(b,c)})};this.$moveLines=function(b){var c=this.selection;if(!c.inMultiSelectMode||this.inVirtualSelectionMode){var d=c.toOrientedRange(),e=this.$getSelectedRows(d),e=b.call(this,e.first,e.last);d.moveBy(e,0);c.fromOrientedRange(d)}else{d=c.rangeList.ranges;c.rangeList.detach(this.session);for(var f=d.length;f--;){for(var g=
f,e=d[f].collapseRows(),h=e.end.row,j=e.start.row;f--;){e=d[f].collapseRows();if(!(j-e.end.row<=1))break;j=e.end.row}f++;for(e=b.call(this,j,h);g>=f;){d[g].moveBy(e,0);g--}}c.fromOrientedRange(c.ranges[0]);c.rangeList.attach(this.session)}};this.$getSelectedRows=function(){var b=this.getSelectionRange().collapseRows();return{first:this.session.getRowFoldStart(b.start.row),last:this.session.getRowFoldEnd(b.end.row)}};this.onCompositionStart=function(){this.renderer.showComposition(this.getCursorPosition())};
this.onCompositionUpdate=function(b){this.renderer.setCompositionText(b)};this.onCompositionEnd=function(){this.renderer.hideComposition()};this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()};this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()};this.isRowVisible=function(b){return b>=this.getFirstVisibleRow()&&b<=this.getLastVisibleRow()};this.isRowFullyVisible=function(b){return b>=this.renderer.getFirstFullyVisibleRow()&&b<=this.renderer.getLastFullyVisibleRow()};
this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1};this.$moveByPage=function(b,c){var d=this.renderer,e=this.renderer.layerConfig,f=b*Math.floor(e.height/e.lineHeight);this.$blockScrolling++;c===true?this.selection.$moveSelection(function(){this.moveCursorBy(f,0)}):c===false&&(this.selection.moveCursorBy(f,0),this.selection.clearSelection());this.$blockScrolling--;var g=d.scrollTop;d.scrollBy(0,f*e.lineHeight);c!=null&&d.scrollCursorIntoView(null,
0.5);d.animateScrolling(g)};this.selectPageDown=function(){this.$moveByPage(1,true)};this.selectPageUp=function(){this.$moveByPage(-1,true)};this.gotoPageDown=function(){this.$moveByPage(1,false)};this.gotoPageUp=function(){this.$moveByPage(-1,false)};this.scrollPageDown=function(){this.$moveByPage(1)};this.scrollPageUp=function(){this.$moveByPage(-1)};this.scrollToRow=function(b){this.renderer.scrollToRow(b)};this.scrollToLine=function(b,c,d,e){this.renderer.scrollToLine(b,c,d,e)};this.centerSelection=
function(){var b=this.getSelectionRange();this.renderer.alignCursor({row:Math.floor(b.start.row+(b.end.row-b.start.row)/2),column:Math.floor(b.start.column+(b.end.column-b.start.column)/2)},0.5)};this.getCursorPosition=function(){return this.selection.getCursor()};this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())};this.getSelectionRange=function(){return this.selection.getRange()};this.selectAll=function(){this.$blockScrolling=this.$blockScrolling+
1;this.selection.selectAll();this.$blockScrolling=this.$blockScrolling-1};this.clearSelection=function(){this.selection.clearSelection()};this.moveCursorTo=function(b,c){this.selection.moveCursorTo(b,c)};this.moveCursorToPosition=function(b){this.selection.moveCursorToPosition(b)};this.jumpToMatching=function(b){var c=this.getCursorPosition(),d=this.session.getBracketRange(c);if(!d){d=this.find({needle:/[{}()\[\]]/g,preventScroll:true,start:{row:c.row,column:c.column-1}});if(!d)return;var e=d.start;
e.row==c.row&&Math.abs(e.column-c.column)<2&&(d=this.session.getBracketRange(e))}(e=d&&d.cursor||e)&&(b?d&&d.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(e.row,e.column):(this.clearSelection(),this.moveCursorTo(e.row,e.column)))};this.gotoLine=function(b,c,d){this.selection.clearSelection();this.session.unfold({row:b-1,column:c||0});this.$blockScrolling=this.$blockScrolling+1;this.exitMultiSelectMode&&this.exitMultiSelectMode();this.moveCursorTo(b-1,c||0);this.$blockScrolling=
this.$blockScrolling-1;this.isRowFullyVisible(b-1)||this.scrollToLine(b-1,true,d)};this.navigateTo=function(b,c){this.clearSelection();this.moveCursorTo(b,c)};this.navigateUp=function(b){if(this.selection.isMultiLine()&&!this.selection.isBackwards())return this.moveCursorToPosition(this.selection.anchor.getPosition());this.selection.clearSelection();this.selection.moveCursorBy(-(b||1),0)};this.navigateDown=function(b){if(this.selection.isMultiLine()&&this.selection.isBackwards())return this.moveCursorToPosition(this.selection.anchor.getPosition());
this.selection.clearSelection();this.selection.moveCursorBy(b||1,0)};this.navigateLeft=function(b){if(this.selection.isEmpty())for(b=b||1;b--;)this.selection.moveCursorLeft();else this.moveCursorToPosition(this.getSelectionRange().start);this.clearSelection()};this.navigateRight=function(b){if(this.selection.isEmpty())for(b=b||1;b--;)this.selection.moveCursorRight();else this.moveCursorToPosition(this.getSelectionRange().end);this.clearSelection()};this.navigateLineStart=function(){this.selection.moveCursorLineStart();
this.clearSelection()};this.navigateLineEnd=function(){this.selection.moveCursorLineEnd();this.clearSelection()};this.navigateFileEnd=function(){this.selection.moveCursorFileEnd();this.clearSelection()};this.navigateFileStart=function(){this.selection.moveCursorFileStart();this.clearSelection()};this.navigateWordRight=function(){this.selection.moveCursorWordRight();this.clearSelection()};this.navigateWordLeft=function(){this.selection.moveCursorWordLeft();this.clearSelection()};this.replace=function(b,
c){c&&this.$search.set(c);var d=this.$search.find(this.session),e=0;return d?(this.$tryReplace(d,b)&&(e=1),d!==null&&(this.selection.setSelectionRange(d),this.renderer.scrollSelectionIntoView(d.start,d.end)),e):e};this.replaceAll=function(b,c){c&&this.$search.set(c);var d=this.$search.findAll(this.session),e=0;if(!d.length)return e;this.$blockScrolling=this.$blockScrolling+1;var f=this.getSelectionRange();this.clearSelection();this.selection.moveCursorTo(0,0);for(var g=d.length-1;g>=0;--g)this.$tryReplace(d[g],
b)&&e++;return this.selection.setSelectionRange(f),this.$blockScrolling=this.$blockScrolling-1,e};this.$tryReplace=function(b,c){return c=this.$search.replace(this.session.getTextRange(b),c),c!==null?(b.end=this.session.replace(b,c),b):null};this.getLastSearchOptions=function(){return this.$search.getOptions()};this.find=function(b,c,e){c||(c={});typeof b=="string"||b instanceof RegExp?c.needle=b:typeof b=="object"&&d.mixin(c,b);var f=this.selection.getRange();c.needle==null&&(b=this.session.getTextRange(f)||
this.$search.$options.needle,b||(f=this.session.getWordRange(f.start.row,f.start.column),b=this.session.getTextRange(f)),this.$search.set({needle:b}));this.$search.set(c);c.start||this.$search.set({start:f});b=this.$search.find(this.session);if(c.preventScroll)return b;if(b)return this.revealRange(b,e),b;c.backwards?f.start=f.end:f.end=f.start;this.selection.setRange(f)};this.findNext=function(b,c){this.find({skipCurrent:true,backwards:false},b,c)};this.findPrevious=function(b,c){this.find(b,{skipCurrent:true,
backwards:true},c)};this.revealRange=function(b,c){this.$blockScrolling=this.$blockScrolling+1;this.session.unfold(b);this.selection.setSelectionRange(b);this.$blockScrolling=this.$blockScrolling-1;var d=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(b.start,b.end,0.5);c!==false&&this.renderer.animateScrolling(d)};this.undo=function(){this.$blockScrolling++;this.session.getUndoManager().undo();this.$blockScrolling--;this.renderer.scrollCursorIntoView(null,0.5)};this.redo=function(){this.$blockScrolling++;
this.session.getUndoManager().redo();this.$blockScrolling--;this.renderer.scrollCursorIntoView(null,0.5)};this.destroy=function(){this.renderer.destroy();this._emit("destroy",this)};this.setAutoScrollEditorIntoView=function(b){if(b!==false){var c,d=this,e=false;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var f=this.$scrollAnchor;f.style.cssText="position:absolute";this.container.insertBefore(f,this.container.firstChild);var g=this.on("changeSelection",function(){e=true}),
h=this.renderer.on("beforeRender",function(){e&&(c=d.renderer.container.getBoundingClientRect())}),j=this.renderer.on("afterRender",function(){if(e&&c&&d.isFocused()){var b=d.renderer,g=b.$cursorLayer.$pixelPos,b=b.layerConfig,h=g.top-b.offset;g.top>=0&&h+c.top<0?e=true:g.top<b.height&&g.top+c.top+b.lineHeight>window.innerHeight?e=false:e=null;e!=null&&(f.style.top=h+"px",f.style.left=g.left+"px",f.style.height=b.lineHeight+"px",f.scrollIntoView(e));e=c=null}});this.setAutoScrollEditorIntoView=function(b){if(b!==
true){delete this.setAutoScrollEditorIntoView;this.removeEventListener("changeSelection",g);this.renderer.removeEventListener("afterRender",j);this.renderer.removeEventListener("beforeRender",h)}}}};this.$resetCursorStyle=function(){var b=this.$cursorStyle||"ace",c=this.renderer.$cursorLayer;if(c){c.setSmoothBlinking(b=="smooth");c.isBlinking=!this.$readOnly&&b!="wide"}}}).call(t.prototype);o.defineOptions(t.prototype,"editor",{selectionStyle:{set:function(b){this.onSelectionChange();this._emit("changeSelectionStyle",
{data:b})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:true},highlightSelectedWord:{set:function(){this.$onSelectionChange()},initialValue:true},readOnly:{set:function(b){this.textInput.setReadOnly(b);this.$resetCursorStyle()},initialValue:false},cursorStyle:{set:function(){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[false,true,"always"],initialValue:true},behavioursEnabled:{initialValue:true},
wrapBehavioursEnabled:{initialValue:true},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",showGutter:"renderer",displayIndentGuides:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",
theme:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimout:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",tabSize:"session",wrap:"session",foldStyle:"session",mode:"session"});c.Editor=t});
ace.define("ace/lib/lang",["require","exports","module"],function(b,c){c.stringReverse=function(b){return b.split("").reverse().join("")};c.stringRepeat=function(b,c){for(var d="";0<c;)if(c&1&&(d+=b),c>>=1)b+=b;return d};var d=/^\s\s*/,e=/\s\s*$/;c.stringTrimLeft=function(b){return b.replace(d,"")};c.stringTrimRight=function(b){return b.replace(e,"")};c.copyObject=function(b){var c={},d;for(d in b)c[d]=b[d];return c};c.copyArray=function(b){for(var c=[],d=0,e=b.length;d<e;d++)b[d]&&"object"==typeof b[d]?
c[d]=this.copyObject(b[d]):c[d]=b[d];return c};c.deepCopy=function(b){if("object"!=typeof b||!b)return b;var d=b.constructor;if(d===RegExp)return b;var d=d(),e;for(e in b)"object"==typeof b[e]?d[e]=c.deepCopy(b[e]):d[e]=b[e];return d};c.arrayToMap=function(b){for(var c={},d=0;d<b.length;d++)c[b[d]]=1;return c};c.createMap=function(b){var c=Object.create(null),d;for(d in b)c[d]=b[d];return c};c.arrayRemove=function(b,c){for(var d=0;d<=b.length;d++)c===b[d]&&b.splice(d,1)};c.escapeRegExp=function(b){return b.replace(/([.*+?^${}()|[\]\/\\])/g,
"\\$1")};c.escapeHTML=function(b){return b.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")};c.getMatchOffsets=function(b,c){var d=[];return b.replace(c,function(b){d.push({offset:arguments[arguments.length-2],length:b.length})}),d};c.deferredCall=function(b){var c=null,d=function(){c=null;b()},e=function(b){return e.cancel(),c=setTimeout(d,b||0),e};return e.schedule=e,e.call=function(){return this.cancel(),b(),e},e.cancel=function(){return clearTimeout(c),c=
null,e},e.isPending=function(){return c},e};c.delayedCall=function(b,c){var d=null,e=function(){d=null;b()},k=function(b){null==d&&(d=setTimeout(e,b||c))};return k.delay=function(b){d&&clearTimeout(d);d=setTimeout(e,b||c)},k.schedule=k,k.call=function(){this.cancel();b()},k.cancel=function(){d&&clearTimeout(d);d=null},k.isPending=function(){return d},k}});
ace.define("ace/keyboard/textinput","require exports module ace/lib/event ace/lib/useragent ace/lib/dom ace/lib/lang".split(" "),function(b,c){var d=b("../lib/event"),e=b("../lib/useragent"),f=b("../lib/dom"),g=b("../lib/lang"),h=e.isChrome<18;c.TextInput=function(b,c){function l(b){if(!t){if(F){c=0;b=b?0:q.value.length-1}else var c=b?2:1,b=2;try{q.setSelectionRange(c,b)}catch(d){}}}function m(){if(!t){q.value=p;e.isWebKit&&G.schedule()}}function n(){setTimeout(function(){u&&(q.style.cssText=u,u=
"");c.renderer.$keepTextAreaAtCursor==null&&(c.renderer.$keepTextAreaAtCursor=true,c.renderer.$moveTextAreaToCursor())},0)}var q=f.createElement("textarea");q.className="ace_text-input";e.isTouchPad&&q.setAttribute("x-palm-disable-auto-cap",true);q.wrap="off";q.autocorrect="off";q.autocapitalize="off";q.spellcheck=false;q.style.opacity="0";b.insertBefore(q,b.firstChild);var p="\u0001\u0001",s=false,r=false,o=false,t=false,u="",w=true;try{var z=document.activeElement===q}catch(A){}d.addListener(q,
"blur",function(){c.onBlur();z=false});d.addListener(q,"focus",function(){z=true;c.onFocus();l()});this.focus=function(){q.focus()};this.blur=function(){q.blur()};this.isFocused=function(){return z};var C=g.delayedCall(function(){z&&l(w)}),G=g.delayedCall(function(){t||(q.value=p,z&&l())});e.isWebKit||c.addEventListener("changeSelection",function(){c.selection.isEmpty()!=w&&(w=!w,C.schedule())});m();z&&c.onFocus();var H=function(b){return b.selectionStart===0&&b.selectionEnd===b.value.length};!q.setSelectionRange&&
q.createTextRange&&(q.setSelectionRange=function(b,c){var d=this.createTextRange();d.collapse(true);d.moveStart("character",b);d.moveEnd("character",c);d.select()},H=function(b){try{var c=b.ownerDocument.selection.createRange()}catch(d){}return!c||c.parentElement()!=b?false:c.text==b.value});if(e.isOldIE){var K=false,P=function(b){if(!K){var c=q.value;if(!t&&c&&c!=p){if(b&&c==p[0])return T.schedule();J(c);K=true;m();K=false}}},T=g.delayedCall(P);d.addListener(q,"propertychange",P);var D={13:1,27:1};
d.addListener(q,"keyup",function(b){t&&(!q.value||D[b.keyCode])&&setTimeout(Z,0);if((q.value.charCodeAt(0)||0)<129)return T.call();t?E():B()});d.addListener(q,"keydown",function(){T.schedule(50)})}var F=null;this.setInputHandler=function(b){F=b};this.getInputHandler=function(){return F};var I=false,J=function(b){F&&(b=F(b),F=null);o?(l(),b&&c.onPaste(b),o=false):b==p.charAt(0)?I?c.execCommand("del",{source:"ace"}):c.execCommand("backspace",{source:"ace"}):(b.substring(0,2)==p?b=b.substr(2):b.charAt(0)==
p.charAt(0)?b=b.substr(1):b.charAt(b.length-1)==p.charAt(0)&&(b=b.slice(0,-1)),b.charAt(b.length-1)==p.charAt(0)&&(b=b.slice(0,-1)),b&&c.onTextInput(b));I&&(I=false)},N=function(b){var e=c.getCopyText();if(e){var f=b.clipboardData||window.clipboardData;if(f&&!h){var g=f.setData("Text",e);g&&(c.onCut(),d.preventDefault(b))}g||(s=true,q.value=e,q.select(),setTimeout(function(){s=false;m();l();c.onCut()}))}else d.preventDefault(b)},U=function(b){var e=c.getCopyText();if(e){var f=b.clipboardData||window.clipboardData;
if(f&&!h){var g=f.setData("Text",e);g&&(c.onCopy(),d.preventDefault(b))}g||(r=true,q.value=e,q.select(),setTimeout(function(){r=false;m();l();c.onCopy()}))}else d.preventDefault(b)},Q=function(b){var f=b.clipboardData||window.clipboardData;if(f){(f=f.getData("Text"))&&c.onPaste(f);e.isIE&&setTimeout(l);d.preventDefault(b)}else{q.value="";o=true}};d.addCommandKeyListener(q,c.onCommandKey.bind(c));d.addListener(q,"select",function(){s?s=false:r?r=false:H(q)?(c.selectAll(),l()):F&&l(c.selection.isEmpty())});
d.addListener(q,"input",function(){if(!t){J(q.value);m()}});d.addListener(q,"cut",N);d.addListener(q,"copy",U);d.addListener(q,"paste",Q);(!("oncut"in q)||!("oncopy"in q)||!("onpaste"in q))&&d.addListener(b,"keydown",function(b){if((!e.isMac||b.metaKey)&&b.ctrlKey)switch(b.keyCode){case 67:U(b);break;case 86:Q(b);break;case 88:N(b)}});var B=function(){if(!t){t={};c.onCompositionStart();setTimeout(E,0);c.on("mousedown",Z);c.selection.isEmpty()||(c.insert(""),c.session.markUndoGroup(),c.selection.clearSelection());
c.session.markUndoGroup()}},E=function(){if(t){var b=q.value.replace(/\x01/g,"");if(t.lastValue!==b){c.onCompositionUpdate(b);t.lastValue&&c.undo();t.lastValue=b;if(t.lastValue){b=c.selection.getRange();c.insert(t.lastValue);c.session.markUndoGroup();t.range=c.selection.getRange();c.selection.setRange(b);c.selection.clearSelection()}}}},Z=function(b){var d=t;t=false;var e=setTimeout(function(){e=null;var b=q.value.replace(/\x01/g,"");t||(b==d.lastValue?m():!d.lastValue&&b&&(m(),J(b)))});F=function(b){return e&&
clearTimeout(e),b=b.replace(/\x01/g,""),b==d.lastValue?"":(d.lastValue&&e&&c.undo(),b)};c.onCompositionEnd();c.removeListener("mousedown",Z);b.type=="compositionend"&&d.range&&c.selection.setRange(d.range)},O=g.delayedCall(E,50);d.addListener(q,"compositionstart",B);e.isGecko?d.addListener(q,"text",function(){O.schedule()}):(d.addListener(q,"keyup",function(){O.schedule()}),d.addListener(q,"keydown",function(){O.schedule()}));d.addListener(q,"compositionend",Z);this.getElement=function(){return q};
this.setReadOnly=function(b){q.readOnly=b};this.onContextMenu=function(b){I=true;u||(u=q.style.cssText);q.style.cssText="z-index:100000;"+(e.isIE?"opacity:0.1;":"");l(c.selection.isEmpty());c._emit("nativecontextmenu",{target:c,domEvent:b});var g=c.container.getBoundingClientRect(),h=f.computedStyle(c.container),j=g.top+(parseInt(h.borderTopWidth)||0),o=g.left+(parseInt(g.borderLeftWidth)||0),m=g.bottom-j-q.clientHeight,g=function(b){q.style.left=b.clientX-o-2+"px";q.style.top=Math.min(b.clientY-
j-2,m)+"px"};g(b);if(b.type=="mousedown"){c.renderer.$keepTextAreaAtCursor&&(c.renderer.$keepTextAreaAtCursor=null);e.isWin&&d.capture(c.container,g,n)}};this.onContextMenuClose=n;if(!e.isGecko||e.isMac){P=function(b){c.textInput.onContextMenu(b);n()};d.addListener(c.renderer.scroller,"contextmenu",P);d.addListener(q,"contextmenu",P)}}});
ace.define("ace/mouse/mouse_handler","require exports module ace/lib/event ace/lib/useragent ace/mouse/default_handlers ace/mouse/default_gutter_handler ace/mouse/mouse_event ace/mouse/dragdrop_handler ace/config".split(" "),function(b,c){var d=b("../lib/event"),e=b("../lib/useragent"),f=b("./default_handlers").DefaultHandlers,g=b("./default_gutter_handler").GutterHandler,h=b("./mouse_event").MouseEvent,j=b("./dragdrop_handler").DragdropHandler,k=b("../config"),l=function(b){this.editor=b;new f(this);
new g(this);new j(this);var c=b.renderer.getMouseEventTarget();d.addListener(c,"click",this.onMouseEvent.bind(this,"click"));d.addListener(c,"mousemove",this.onMouseMove.bind(this,"mousemove"));d.addMultiMouseDownListener(c,[300,300,250],this,"onMouseEvent");b.renderer.scrollBarV&&(d.addMultiMouseDownListener(b.renderer.scrollBarV.inner,[300,300,250],this,"onMouseEvent"),d.addMultiMouseDownListener(b.renderer.scrollBarH.inner,[300,300,250],this,"onMouseEvent"));d.addMouseWheelListener(b.container,
this.onMouseWheel.bind(this,"mousewheel"));var e=b.renderer.$gutter;d.addListener(e,"mousedown",this.onMouseEvent.bind(this,"guttermousedown"));d.addListener(e,"click",this.onMouseEvent.bind(this,"gutterclick"));d.addListener(e,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick"));d.addListener(e,"mousemove",this.onMouseEvent.bind(this,"guttermousemove"));d.addListener(c,"mousedown",function(){b.focus()});d.addListener(e,"mousedown",function(c){return b.focus(),d.preventDefault(c)})};(function(){this.onMouseEvent=
function(b,c){this.editor._emit(b,new h(c,this.editor))};this.onMouseMove=function(b,c){var d=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;d&&d.length&&this.editor._emit(b,new h(c,this.editor))};this.onMouseWheel=function(b,c){var d=new h(c,this.editor);d.speed=this.$scrollSpeed*2;d.wheelX=c.wheelX;d.wheelY=c.wheelY;this.editor._emit(b,d)};this.setState=function(b){this.state=b};this.captureMouse=function(b,c){this.x=b.x;this.y=b.y;this.isMousePressed=true;var f=this.editor.renderer;
f.$keepTextAreaAtCursor&&(f.$keepTextAreaAtCursor=null);var g=this,j=function(b){g.x=b.clientX;g.y=b.clientY;c&&c(b);g.mouseEvent=new h(b,g.editor);g.$mouseMoved=true},k=function(b){clearInterval(t);l();g[g.state+"End"]&&g[g.state+"End"](b);g.$clickSelection=null;f.$keepTextAreaAtCursor==null&&(f.$keepTextAreaAtCursor=true,f.$moveTextAreaToCursor());g.isMousePressed=false;g.$onCaptureMouseMove=g.releaseMouse=null;g.onMouseEvent("mouseup",b)},l=function(){g[g.state]&&g[g.state]();g.$mouseMoved=false};
if(e.isOldIE&&b.domEvent.type=="dblclick")return setTimeout(function(){k(b)});g.$onCaptureMouseMove=j;g.releaseMouse=d.capture(this.editor.container,j,k);var t=setInterval(l,20)};this.releaseMouse=null}).call(l.prototype);k.defineOptions(l.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:150},dragEnabled:{initialValue:true},focusTimout:{initialValue:0}});c.MouseHandler=l});
ace.define("ace/mouse/default_handlers","require exports module ace/lib/dom ace/lib/event ace/lib/useragent".split(" "),function(b,c){function d(b){b.$clickSelection=null;var c=b.editor;c.setDefaultHandler("mousedown",this.onMouseDown.bind(b));c.setDefaultHandler("dblclick",this.onDoubleClick.bind(b));c.setDefaultHandler("tripleclick",this.onTripleClick.bind(b));c.setDefaultHandler("quadclick",this.onQuadClick.bind(b));c.setDefaultHandler("mousewheel",this.onMouseWheel.bind(b));["select","startSelect",
"selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"].forEach(function(c){b[c]=this[c]},this);b.selectByLines=this.extendSelectionBy.bind(b,"getLineRange");b.selectByWords=this.extendSelectionBy.bind(b,"getWordRange")}function e(b,c){return(b.start.row==b.end.row?2*c.column-b.start.column-b.end.column:b.start.row==b.end.row-1&&!b.start.column&&!b.end.column?c.column-4:2*c.row-b.start.row-b.end.row)<0?{cursor:b.start,anchor:b.end}:{cursor:b.end,anchor:b.start}}
b("../lib/dom");b("../lib/event");b("../lib/useragent");(function(){this.onMouseDown=function(b){var c=b.inSelection(),d=b.getDocumentPosition();this.mousedownEvent=b;var e=this.editor;if(b.getButton()!==0){e.getSelectionRange().isEmpty()&&(e.moveCursorToPosition(d),e.selection.clearSelection());e.textInput.onContextMenu(b.domEvent)}else{if(c&&!e.isFocused()){e.focus();if(this.$focusTimout&&!this.$clickSelection&&!e.inMultiSelectMode){this.mousedownEvent.time=Date.now();this.setState("focusWait");
this.captureMouse(b);return}}return!c||this.$clickSelection||b.getShiftKey()||e.inMultiSelectMode?this.startSelect(d):c&&(this.mousedownEvent.time=Date.now(),this.startSelect(d)),this.captureMouse(b),b.preventDefault()}};this.startSelect=function(b){var b=b||this.editor.renderer.screenToTextCoordinates(this.x,this.y),c=this.editor;this.mousedownEvent.getShiftKey()?c.selection.selectToPosition(b):this.$clickSelection||(c.moveCursorToPosition(b),c.selection.clearSelection());c.renderer.scroller.setCapture&&
c.renderer.scroller.setCapture();c.setStyle("ace_selecting");this.setState("select")};this.select=function(){var b,c=this.editor,d=c.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){b=this.$clickSelection.comparePoint(d);if(b==-1)b=this.$clickSelection.end;else if(b==1)b=this.$clickSelection.start;else{b=e(this.$clickSelection,d);d=b.cursor;b=b.anchor}c.selection.setSelectionAnchor(b.row,b.column)}c.selection.selectToPosition(d);c.renderer.scrollCursorIntoView()};this.extendSelectionBy=
function(b){var c,d=this.editor,j=d.renderer.screenToTextCoordinates(this.x,this.y),b=d.selection[b](j.row,j.column);if(this.$clickSelection){c=this.$clickSelection.comparePoint(b.start);var k=this.$clickSelection.comparePoint(b.end);if(c==-1&&k<=0){c=this.$clickSelection.end;if(b.end.row!=j.row||b.end.column!=j.column)j=b.start}else if(k==1&&c>=0){c=this.$clickSelection.start;if(b.start.row!=j.row||b.start.column!=j.column)j=b.end}else if(c==-1&&k==1){j=b.end;c=b.start}else{b=e(this.$clickSelection,
j);j=b.cursor;c=b.anchor}d.selection.setSelectionAnchor(c.row,c.column)}d.selection.selectToPosition(j);d.renderer.scrollCursorIntoView()};this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.editor.unsetStyle("ace_selecting");this.editor.renderer.scroller.releaseCapture&&this.editor.renderer.scroller.releaseCapture()};this.focusWait=function(){var b=Math.sqrt(Math.pow(this.x-this.mousedownEvent.x,2)+Math.pow(this.y-this.mousedownEvent.y,2)),c=Date.now();(b>
0||c-this.mousedownEvent.time>this.$focusTimout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())};this.onDoubleClick=function(b){var c=b.getDocumentPosition(),d=this.editor,e=d.session.getBracketRange(c);e?(e.isEmpty()&&(e.start.column--,e.end.column++),this.setState("select")):(e=d.selection.getWordRange(c.row,c.column),this.setState("selectByWords"));this.$clickSelection=e;this[this.state]&&this[this.state](b)};this.onTripleClick=function(b){var c=b.getDocumentPosition(),d=this.editor;
this.setState("selectByLines");this.$clickSelection=d.selection.getLineRange(c.row);this[this.state]&&this[this.state](b)};this.onQuadClick=function(){var b=this.editor;b.selectAll();this.$clickSelection=b.getSelectionRange();this.setState("selectAll")};this.onMouseWheel=function(b){if(!b.getShiftKey()&&!b.getAccelKey()){var c=b.domEvent.timeStamp,d=c-(this.$lastScrollTime||0),e=this.editor;if(e.renderer.isScrollableBy(b.wheelX*b.speed,b.wheelY*b.speed)||d<200)return this.$lastScrollTime=c,e.renderer.scrollBy(b.wheelX*
b.speed,b.wheelY*b.speed),b.stop()}}}).call(d.prototype);c.DefaultHandlers=d});
ace.define("ace/mouse/default_gutter_handler",["require","exports","module","ace/lib/dom","ace/lib/event"],function(b,c){var d=b("../lib/dom"),e=b("../lib/event");c.GutterHandler=function(b){function c(){l&&(l=clearTimeout(l));q&&(n.style.display="none",q=null,j.removeEventListener("mousewheel",c))}function h(b){var c=j.renderer.$gutter.getBoundingClientRect();n.style.left=b.x+15+"px";b.y+3*j.renderer.lineHeight+15<c.bottom?(n.style.bottom="",n.style.top=b.y+15+"px"):(n.style.top="",n.style.bottom=
(window.innerHeight||document.documentElement.clientHeight)-b.y+5+"px")}var j=b.editor,k=j.renderer.$gutterLayer;b.editor.setDefaultHandler("guttermousedown",function(c){if(j.isFocused()&&0==c.getButton()&&"foldWidgets"!=k.getRegion(c)){var d=c.getDocumentPosition().row,e=j.session.selection;if(c.getShiftKey())e.selectTo(d,0);else{if(2==c.domEvent.detail)return j.selectAll(),c.preventDefault();b.$clickSelection=j.selection.getLineRange(d)}return b.setState("selectByLines"),b.captureMouse(c),c.preventDefault()}});
var l,m,n,q;b.editor.setDefaultHandler("guttermousemove",function(e){if(d.hasCssClass(e.domEvent.target||e.domEvent.srcElement,"ace_fold-widget"))return c();q&&h(e);m=e;l||(l=setTimeout(function(){l=null;if(m&&!b.isMousePressed)a:{n||(n=d.createElement("div"),n.className="ace_gutter-tooltip",n.style.display="none",j.container.appendChild(n));var e=m.getDocumentPosition().row,p=k.$annotations[e];if(p){var o=j.session.getLength();if(e==o&&(e=j.renderer.pixelToScreenCoordinates(0,m.y).row,o=m.$pos,e>
j.session.documentToScreenRow(o.row,o.column))){c();break a}q!=p&&(q=p.text.join("<br/>"),n.style.display="block",n.innerHTML=q,j.on("mousewheel",c),h(m))}else c()}else c()},50))});e.addListener(j.renderer.$gutter,"mouseout",function(){m=null;q&&!l&&(l=setTimeout(function(){l=null;c()},50))});j.on("changeSession",c)}});
ace.define("ace/mouse/mouse_event",["require","exports","module","ace/lib/event","ace/lib/useragent"],function(b,c){var d=b("../lib/event"),e=b("../lib/useragent");(function(){this.stopPropagation=function(){d.stopPropagation(this.domEvent);this.propagationStopped=!0};this.preventDefault=function(){d.preventDefault(this.domEvent);this.defaultPrevented=!0};this.stop=function(){this.stopPropagation();this.preventDefault()};this.getDocumentPosition=function(){return this.$pos?this.$pos:(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,
this.clientY),this.$pos)};this.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var b=this.editor.getSelectionRange();if(b.isEmpty())this.$inSelection=!1;else{var c=this.getDocumentPosition();this.$inSelection=b.contains(c.row,c.column)}return this.$inSelection};this.getButton=function(){return d.getButton(this.domEvent)};this.getShiftKey=function(){return this.domEvent.shiftKey};this.getAccelKey=e.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call((c.MouseEvent=
function(b,c){this.domEvent=b;this.editor=c;this.x=this.clientX=b.clientX;this.y=this.clientY=b.clientY;this.$inSelection=this.$pos=null;this.defaultPrevented=this.propagationStopped=!1}).prototype)});
ace.define("ace/mouse/dragdrop_handler","require exports module ace/lib/dom ace/lib/event ace/lib/useragent".split(" "),function(b,c){function d(b){var c,d;function q(){var b=P,e=P=u.renderer.screenToTextCoordinates(C,G),f=Date.now(),g=!b||e.row!=b.row,l=!b||e.column!=b.column;if(!J||g||l){u.$blockScrolling=u.$blockScrolling+1;u.moveCursorToPosition(e);u.$blockScrolling=u.$blockScrolling-1;J=f;c=C;d=G}else Math.sqrt(Math.pow(C-c,2)+Math.pow(G-d,2))>k?J=null:f-J>=j&&(u.renderer.scrollCursorIntoView(),
J=null);var e=P,f=Date.now(),l=u.renderer.layerConfig.lineHeight,o=u.renderer.layerConfig.characterWidth,g=u.renderer.scroller.getBoundingClientRect(),s=C-g.left,p=g.right-C,t=G-g.top,q=g.bottom-G,r=Math.min(s,p),w=Math.min(t,q),g={row:e.row,column:e.column};r/o<=2&&(g.column=g.column+(s<p?-3:2));w/l<=1&&(g.row=g.row+(t<q?-1:1));l=e.column!=g.column;b=!b||e.row!=b.row;e.row!=g.row||l&&!b?I?f-I>=h&&u.renderer.scrollCursorIntoView(g):I=f:I=null}function p(){K=u.selection.toOrientedRange();A=u.session.addMarker(K,
"ace_selection",u.getSelectionStyle());u.clearSelection();u.isFocused()&&u.renderer.$cursorLayer.setBlinking(false);clearInterval(H);H=setInterval(q,20);T=0;f.addListener(document,"mousemove",r)}function s(){clearInterval(H);u.session.removeMarker(A);A=null;u.$blockScrolling=u.$blockScrolling+1;u.selection.fromOrientedRange(K);u.$blockScrolling=u.$blockScrolling-1;u.isFocused()&&!F&&u.renderer.$cursorLayer.setBlinking(!u.getReadOnly());K=null;T=0;J=I=null;f.removeListener(document,"mousemove",r)}
function r(){N==null&&(N=setTimeout(function(){N!=null&&A&&s()},20))}function o(b){b=b.types;return!b||Array.prototype.some.call(b,function(b){return b=="text/plain"||b=="Text"})}function t(b){var c=["copy","copymove","all","uninitialized"],d=["move","copymove","linkmove","all","uninitialized"],e=g.isMac?b.altKey:b.ctrlKey,f="uninitialized";try{f=b.dataTransfer.effectAllowed.toLowerCase()}catch(h){}return e&&c.indexOf(f)>=0||d.indexOf(f)>=0||c.indexOf(f),"none"}var u=b.editor,w=e.createElement("img");
w.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";g.isOpera&&(w.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;");["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"].forEach(function(c){b[c]=this[c]},this);u.addEventListener("mousedown",this.onMouseDown.bind(b));var z=u.container,A,C,G,H,K,P,T=0,D,F,I,J;this.onDragStart=function(b){if(this.cancelDrag||!z.draggable){var c=this;return setTimeout(function(){c.startSelect();
c.captureMouse(b)},0),b.preventDefault()}K=u.getSelectionRange();var d=b.dataTransfer;d.effectAllowed=u.getReadOnly()?"copy":"copyMove";g.isOpera&&(u.container.appendChild(w),w._top=w.offsetTop);d.setDragImage&&d.setDragImage(w,0,0);g.isOpera&&u.container.removeChild(w);d.clearData();d.setData("Text",u.session.getTextRange());F=true;this.setState("drag")};this.onDragEnd=function(b){F=z.draggable=false;this.setState(null);if(!u.getReadOnly()){b=b.dataTransfer.dropEffect;!D&&b=="move"&&u.session.remove(u.getSelectionRange());
u.renderer.$cursorLayer.setBlinking(true)}this.editor.unsetStyle("ace_dragging")};this.onDragEnter=function(b){if(!u.getReadOnly()&&o(b.dataTransfer))return A||p(),T++,b.dataTransfer.dropEffect=D=t(b),f.preventDefault(b)};this.onDragOver=function(b){if(!u.getReadOnly()&&o(b.dataTransfer))return A||(p(),T++),N!==null&&(N=null),C=b.clientX,G=b.clientY,b.dataTransfer.dropEffect=D=t(b),f.preventDefault(b)};this.onDragLeave=function(b){T--;if(T<=0&&A)return s(),D=null,f.preventDefault(b)};this.onDrop=
function(b){if(A){var c=b.dataTransfer;if(F)switch(D){case "move":K.contains(P.row,P.column)?K={start:P,end:P}:K=u.moveText(K,P);break;case "copy":K=u.moveText(K,P,true)}else{c=c.getData("Text");K={start:P,end:u.session.insert(P,c)};u.focus();D=null}return s(),f.preventDefault(b)}};f.addListener(z,"dragstart",this.onDragStart.bind(b));f.addListener(z,"dragend",this.onDragEnd.bind(b));f.addListener(z,"dragenter",this.onDragEnter.bind(b));f.addListener(z,"dragover",this.onDragOver.bind(b));f.addListener(z,
"dragleave",this.onDragLeave.bind(b));f.addListener(z,"drop",this.onDrop.bind(b));var N=null}var e=b("../lib/dom"),f=b("../lib/event"),g=b("../lib/useragent"),h=200,j=200,k=5;(function(){this.dragWait=function(){Date.now()-this.mousedownEvent.time>this.editor.getDragDelay()&&this.startDrag()};this.dragWaitEnd=function(){this.editor.container.draggable=false;this.startSelect(this.mousedownEvent.getDocumentPosition());this.selectEnd()};this.dragReadyEnd=function(){this.editor.renderer.$cursorLayer.setBlinking(!this.editor.getReadOnly());
this.editor.unsetStyle("ace_dragging");this.dragWaitEnd()};this.startDrag=function(){this.cancelDrag=false;this.editor.container.draggable=true;this.editor.renderer.$cursorLayer.setBlinking(false);this.editor.setStyle("ace_dragging");this.setState("dragReady")};this.onMouseDrag=function(){var b=this.editor.container;if(g.isIE&&this.state=="dragReady"){var c=Math.sqrt(Math.pow(this.x-this.mousedownEvent.x,2)+Math.pow(this.y-this.mousedownEvent.y,2));c>3&&b.dragDrop()}if(this.state==="dragWait"){c=
Math.sqrt(Math.pow(this.x-this.mousedownEvent.x,2)+Math.pow(this.y-this.mousedownEvent.y,2));c>0&&(b.draggable=false,this.startSelect(this.mousedownEvent.getDocumentPosition()))}};this.onMouseDown=function(b){if(this.$dragEnabled){this.mousedownEvent=b;var c=this.editor,d=b.inSelection(),e=b.getButton();if((b.domEvent.detail||1)===1&&e===0&&d)if(!b.editor.inMultiSelectMode||!b.getAccelKey()&&!b.getShiftKey()){this.mousedownEvent.time=Date.now();d=b.domEvent.target||b.domEvent.srcElement;"unselectable"in
d&&(d.unselectable="on");if(c.getDragDelay()){if(g.isWebKit){this.cancelDrag=true;c.container.draggable=true}this.setState("dragWait")}else this.startDrag();this.captureMouse(b,this.onMouseDrag.bind(this));b.defaultPrevented=true}}}}).call(d.prototype);c.DragdropHandler=d});
ace.define("ace/config","require exports module ace/lib/lang ace/lib/oop ace/lib/net ace/lib/event_emitter".split(" "),function(b,c,d){function e(b){return b.replace(/-(.)/g,function(b,c){return c.toUpperCase()})}"no use strict";var f=b("./lib/lang"),g=b("./lib/oop"),h=b("./lib/net"),j=b("./lib/event_emitter").EventEmitter,k=function(){return this}(),l={packaged:false,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{}};c.get=function(b){if(!l.hasOwnProperty(b))throw Error("Unknown config key: "+
b);return l[b]};c.set=function(b,c){if(!l.hasOwnProperty(b))throw Error("Unknown config key: "+b);l[b]=c};c.all=function(){return f.copyObject(l)};g.implement(c,j);c.moduleUrl=function(b,c){if(l.$moduleUrls[b])return l.$moduleUrls[b];var d=b.split("/"),c=c||d[d.length-2]||"",e=c=="snippets"?"/":"-",f=d[d.length-1];e=="-"&&(f=f.replace(RegExp("^"+c+"[\\-_]|[\\-_]"+c+"$","g"),""));(!f||f==c)&&d.length>1&&(f=d[d.length-2]);d=l[c+"Path"];return d==null?d=l.basePath:e=="/"&&(c=e=""),d&&d.slice(-1)!="/"&&
(d=d+"/"),d+c+e+f+this.get("suffix")};c.setModuleUrl=function(b,c){return l.$moduleUrls[b]=c};c.$loading={};c.loadModule=function(d,e){var f,g;Array.isArray(d)&&(g=d[0],d=d[1]);try{f=b(d)}catch(j){}if(f&&!c.$loading[d])return e&&e(f);c.$loading[d]||(c.$loading[d]=[]);c.$loading[d].push(e);if(!(c.$loading[d].length>1)){f=function(){b([d],function(b){c._emit("load.module",{name:d,module:b});var e=c.$loading[d];c.$loading[d]=null;e.forEach(function(c){c&&c(b)})})};if(!c.get("packaged"))return f();h.loadScript(c.moduleUrl(d,
g),f)}};c.init=function(){l.packaged=b.packaged||d.packaged||k.define&&define.packaged;if(!k.document)return"";for(var f={},g="",h=document.getElementsByTagName("script"),j=0;j<h.length;j++){var o=h[j],m=o.src||o.getAttribute("src");if(m){for(var o=o.attributes,n=0,w=o.length;n<w;n++){var z=o[n];z.name.indexOf("data-ace-")===0&&(f[e(z.name.replace(/^data-ace-/,""))]=z.value)}(m=m.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/))&&(g=m[1])}}g&&(f.base=f.base||g,f.packaged=true);f.basePath=f.base;f.workerPath=
f.workerPath||f.base;f.modePath=f.modePath||f.base;f.themePath=f.themePath||f.base;delete f.base;for(var A in f)typeof f[A]!="undefined"&&c.set(A,f[A])};var m={setOptions:function(b){Object.keys(b).forEach(function(c){this.setOption(c,b[c])},this)},getOptions:function(b){var c={};return b?Array.isArray(b)||(c=b,b=Object.keys(c)):b=Object.keys(this.$options),b.forEach(function(b){c[b]=this.getOption(b)},this),c},setOption:function(b,c){if(this["$"+b]!==c){var d=this.$options[b];if(!d)return typeof console!=
"undefined"&&console.warn&&console.warn('misspelled option "'+b+'"'),void 0;if(d.forwardTo)return this[d.forwardTo]&&this[d.forwardTo].setOption(b,c);d.handlesSet||(this["$"+b]=c);d&&d.set&&d.set.call(this,c)}},getOption:function(b){var c=this.$options[b];return c?c.forwardTo?this[c.forwardTo]&&this[c.forwardTo].getOption(b):c&&c.get?c.get.call(this):this["$"+b]:(typeof console!="undefined"&&console.warn&&console.warn('misspelled option "'+b+'"'),void 0)}},n={};c.defineOptions=function(b,c,d){return b.$options||
(n[c]=b.$options={}),Object.keys(d).forEach(function(c){var e=d[c];typeof e=="string"&&(e={forwardTo:e});e.name||(e.name=c);b.$options[e.name]=e;"initialValue"in e&&(b["$"+e.name]=e.initialValue)}),g.implement(b,m),this};c.resetOptions=function(b){Object.keys(b.$options).forEach(function(c){var d=b.$options[c];"value"in d&&b.setOption(c,d.value)})};c.setDefaultValue=function(b,d,e){b=n[b]||(n[b]={});b[d]&&(b.forwardTo?c.setDefaultValue(b.forwardTo,d,e):b[d].value=e)};c.setDefaultValues=function(b,
d){Object.keys(d).forEach(function(e){c.setDefaultValue(b,e,d[e])})}});
ace.define("ace/lib/net",["require","exports","module","ace/lib/dom"],function(b,c){var d=b("./dom");c.get=function(b,c){var d=new XMLHttpRequest;d.open("GET",b,!0);d.onreadystatechange=function(){4===d.readyState&&c(d.responseText)};d.send(null)};c.loadScript=function(b,c){var g=d.getDocumentHead(),h=document.createElement("script");h.src=b;g.appendChild(h);h.onload=h.onreadystatechange=function(b,d){if(d||!h.readyState||"loaded"==h.readyState||"complete"==h.readyState)h=h.onload=h.onreadystatechange=
null,d||c()}}});
ace.define("ace/lib/event_emitter",["require","exports","module"],function(b,c){var d={},e=function(){this.propagationStopped=!0},f=function(){this.defaultPrevented=!0};d._emit=d._dispatchEvent=function(b,c){this._eventRegistry||(this._eventRegistry={});this._defaultHandlers||(this._defaultHandlers={});var d=this._eventRegistry[b]||[],k=this._defaultHandlers[b];if(d.length||k){if("object"!=typeof c||!c)c={};c.type||(c.type=b);c.stopPropagation||(c.stopPropagation=e);c.preventDefault||(c.preventDefault=
f);for(var d=d.slice(),l=0;l<d.length&&!(d[l](c,this),c.propagationStopped);l++);if(k&&!c.defaultPrevented)return k(c,this)}};d._signal=function(b,c){var d=(this._eventRegistry||{})[b];if(d)for(var d=d.slice(),e=0;e<d.length;e++)d[e](c,this)};d.once=function(b,c){var d=this;c&&this.addEventListener(b,function l(){d.removeEventListener(b,l);c.apply(null,arguments)})};d.setDefaultHandler=function(b,c){var d=this._defaultHandlers;d||(d=this._defaultHandlers={_disabled_:{}});if(d[b]){var e=d[b],f=d._disabled_[b];
f||(d._disabled_[b]=f=[]);f.push(e);e=f.indexOf(c);-1!=e&&f.splice(e,1)}d[b]=c};d.removeDefaultHandler=function(b,c){var d=this._defaultHandlers;if(d){var e=d._disabled_[b];d[b]==c?e&&this.setDefaultHandler(b,e.pop()):e&&(d=e.indexOf(c),-1!=d&&e.splice(d,1))}};d.on=d.addEventListener=function(b,c,d){this._eventRegistry=this._eventRegistry||{};var e=this._eventRegistry[b];return e||(e=this._eventRegistry[b]=[]),-1==e.indexOf(c)&&e[d?"unshift":"push"](c),c};d.off=d.removeListener=d.removeEventListener=
function(b,c){this._eventRegistry=this._eventRegistry||{};var d=this._eventRegistry[b];if(d){var e=d.indexOf(c);-1!==e&&d.splice(e,1)}};d.removeAllListeners=function(b){this._eventRegistry&&(this._eventRegistry[b]=[])};c.EventEmitter=d});
ace.define("ace/mouse/fold_handler",["require","exports","module"],function(b,c){c.FoldHandler=function(b){b.on("click",function(c){var f=c.getDocumentPosition(),g=b.session;(f=g.getFoldAt(f.row,f.column,1))&&(c.getAccelKey()?g.removeFold(f):g.expandFold(f),c.stop())});b.on("gutterclick",function(c){if("foldWidgets"==b.renderer.$gutterLayer.getRegion(c)){var f=c.getDocumentPosition().row,g=b.session;g.foldWidgets&&g.foldWidgets[f]&&b.session.onFoldWidgetClick(f,c);b.isFocused()||b.focus();c.stop()}});
b.on("gutterdblclick",function(c){if("foldWidgets"==b.renderer.$gutterLayer.getRegion(c)){var f=c.getDocumentPosition().row,g=b.session,h=g.getParentFoldRangeData(f,!0);if(h=h.range||h.firstRange)f=h.start.row,(f=g.getFoldAt(f,g.getLine(f).length,1))?g.removeFold(f):(g.addFold("...",h),b.renderer.scrollCursorIntoView({row:h.start.row,column:0}));c.stop()}})}});
ace.define("ace/keyboard/keybinding",["require","exports","module","ace/lib/keys","ace/lib/event"],function(b,c){var d=b("../lib/keys"),e=b("../lib/event"),f=function(b){this.$editor=b;this.$data={};this.$handlers=[];this.setDefaultHandler(b.commands)};(function(){this.setDefaultHandler=function(b){this.removeKeyboardHandler(this.$defaultHandler);this.$defaultHandler=b;this.addKeyboardHandler(b,0);this.$data={editor:this.$editor}};this.setKeyboardHandler=function(b){var c=this.$handlers;if(c[c.length-
1]!=b){for(;c[c.length-1]&&c[c.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(c[c.length-1]);this.addKeyboardHandler(b,1)}};this.addKeyboardHandler=function(b,c){if(b){var d=this.$handlers.indexOf(b);-1!=d&&this.$handlers.splice(d,1);void 0==c?this.$handlers.push(b):this.$handlers.splice(c,0,b);-1==d&&b.attach&&b.attach(this.$editor)}};this.removeKeyboardHandler=function(b){var c=this.$handlers.indexOf(b);return-1==c?!1:(this.$handlers.splice(c,1),b.detach&&b.detach(this.$editor),!0)};
this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]};this.$callKeyboardHandlers=function(b,c,d,f){for(var l,m=!1,n=this.$editor.commands,q=this.$handlers.length;q--;)if((l=this.$handlers[q].handleKeyboard(this.$data,b,c,d,f))&&l.command)if("null"==l.command?m=!0:m=n.exec(l.command,this.$editor,l.args,f),m&&f&&-1!=b&&1!=l.passEvent&&1!=l.command.passEvent&&e.stopEvent(f),m)break;return m};this.onCommandKey=function(b,c,e){var f=d.keyCodeToString(e);this.$callKeyboardHandlers(c,
f,e,b)};this.onTextInput=function(b){this.$callKeyboardHandlers(-1,b)||this.$editor.commands.exec("insertstring",this.$editor,b)}}).call(f.prototype);c.KeyBinding=f});
ace.define("ace/edit_session","require exports module ace/lib/oop ace/lib/lang ace/config ace/lib/event_emitter ace/selection ace/mode/text ace/range ace/document ace/background_tokenizer ace/search_highlight ace/edit_session/folding ace/edit_session/bracket_match".split(" "),function(b,c){var d=b("./lib/oop"),e=b("./lib/lang"),f=b("./config"),g=b("./lib/event_emitter").EventEmitter,h=b("./selection").Selection,j=b("./mode/text").Mode,k=b("./range").Range,l=b("./document").Document,m=b("./background_tokenizer").BackgroundTokenizer,
n=b("./search_highlight").SearchHighlight,q=function(b,c){this.$breakpoints=[];this.$decorations=[];this.$frontMarkers={};this.$backMarkers={};this.$markerId=1;this.$undoSelect=true;this.$foldData=[];this.$foldData.toString=function(){return this.join("\n")};this.on("changeFold",this.onChangeFold.bind(this));this.$onChange=this.onChange.bind(this);if(typeof b!="object"||!b.getLine)b=new l(b);this.setDocument(b);this.selection=new h(this);f.resetOptions(this);this.setMode(c);f._emit("session",this)};
(function(){function c(b){return b<4352?false:b>=4352&&b<=4447||b>=4515&&b<=4519||b>=4602&&b<=4607||b>=9001&&b<=9002||b>=11904&&b<=11929||b>=11931&&b<=12019||b>=12032&&b<=12245||b>=12272&&b<=12283||b>=12288&&b<=12350||b>=12353&&b<=12438||b>=12441&&b<=12543||b>=12549&&b<=12589||b>=12593&&b<=12686||b>=12688&&b<=12730||b>=12736&&b<=12771||b>=12784&&b<=12830||b>=12832&&b<=12871||b>=12880&&b<=13054||b>=13056&&b<=19903||b>=19968&&b<=42124||b>=42128&&b<=42182||b>=43360&&b<=43388||b>=44032&&b<=55203||b>=
55216&&b<=55238||b>=55243&&b<=55291||b>=63744&&b<=64255||b>=65040&&b<=65049||b>=65072&&b<=65106||b>=65108&&b<=65126||b>=65128&&b<=65131||b>=65281&&b<=65376||b>=65504&&b<=65510}d.implement(this,g);this.setDocument=function(b){this.doc&&this.doc.removeListener("change",this.$onChange);this.doc=b;b.on("change",this.$onChange);this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument());this.resetCaches()};this.getDocument=function(){return this.doc};this.$resetRowCache=function(b){if(b){var c=
this.$docRowCache.length,b=this.$getRowCacheIndex(this.$docRowCache,b)+1;c>b&&(this.$docRowCache.splice(b,c),this.$screenRowCache.splice(b,c))}else{this.$docRowCache=[];this.$screenRowCache=[]}};this.$getRowCacheIndex=function(b,c){for(var d=0,e=b.length-1;d<=e;){var f=d+e>>1,g=b[f];if(c>g)d=f+1;else{if(!(c<g))return f;e=f-1}}return d-1};this.resetCaches=function(){this.$modified=true;this.$wrapData=[];this.$rowLengthCache=[];this.$resetRowCache(0);this.bgTokenizer&&this.bgTokenizer.start(0)};this.onChangeFold=
function(b){this.$resetRowCache(b.data.start.row)};this.onChange=function(b){var c=b.data;this.$modified=true;this.$resetRowCache(c.range.start.row);var d=this.$updateInternalDataOnChange(b);!this.$fromUndo&&this.$undoManager&&!c.ignore&&(this.$deltasDoc.push(c),d&&d.length!=0&&this.$deltasFold.push({action:"removeFolds",folds:d}),this.$informUndoManager.schedule());this.bgTokenizer.$updateOnChange(c);this._emit("change",b)};this.setValue=function(b){this.doc.setValue(b);this.selection.moveCursorTo(0,
0);this.selection.clearSelection();this.$resetRowCache(0);this.$deltas=[];this.$deltasDoc=[];this.$deltasFold=[];this.getUndoManager().reset()};this.getValue=this.toString=function(){return this.doc.getValue()};this.getSelection=function(){return this.selection};this.getState=function(b){return this.bgTokenizer.getState(b)};this.getTokens=function(b){return this.bgTokenizer.getTokens(b)};this.getTokenAt=function(b,c){var d=this.bgTokenizer.getTokens(b),e,f=0;if(c==null){g=d.length-1;f=this.getLine(b).length}else for(var g=
0;g<d.length;g++){f=f+d[g].value.length;if(f>=c)break}return e=d[g],e?(e.index=g,e.start=f-e.value.length,e):null};this.setUndoManager=function(b){this.$undoManager=b;this.$deltas=[];this.$deltasDoc=[];this.$deltasFold=[];this.$informUndoManager&&this.$informUndoManager.cancel();if(b){var c=this;this.$syncInformUndoManager=function(){c.$informUndoManager.cancel();c.$deltasFold.length&&(c.$deltas.push({group:"fold",deltas:c.$deltasFold}),c.$deltasFold=[]);c.$deltasDoc.length&&(c.$deltas.push({group:"doc",
deltas:c.$deltasDoc}),c.$deltasDoc=[]);c.$deltas.length>0&&b.execute({action:"aceupdate",args:[c.$deltas,c],merge:c.mergeUndoDeltas});c.mergeUndoDeltas=false;c.$deltas=[]};this.$informUndoManager=e.delayedCall(this.$syncInformUndoManager)}};this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()};this.$defaultUndoManager={undo:function(){},redo:function(){},reset:function(){}};this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager};this.getTabString=
function(){return this.getUseSoftTabs()?e.stringRepeat(" ",this.getTabSize()):"\t"};this.setUseSoftTabs=function(b){this.setOption("useSoftTabs",b)};this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs};this.setTabSize=function(b){this.setOption("tabSize",b)};this.getTabSize=function(){return this.$tabSize};this.isTabStop=function(b){return this.$useSoftTabs&&b.column%this.$tabSize==0};this.$overwrite=false;this.setOverwrite=function(b){this.setOption("overwrite",b)};
this.getOverwrite=function(){return this.$overwrite};this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)};this.addGutterDecoration=function(b,c){this.$decorations[b]||(this.$decorations[b]="");this.$decorations[b]=this.$decorations[b]+(" "+c);this._emit("changeBreakpoint",{})};this.removeGutterDecoration=function(b,c){this.$decorations[b]=(this.$decorations[b]||"").replace(" "+c,"");this._emit("changeBreakpoint",{})};this.getBreakpoints=function(){return this.$breakpoints};this.setBreakpoints=
function(b){this.$breakpoints=[];for(var c=0;c<b.length;c++)this.$breakpoints[b[c]]="ace_breakpoint";this._emit("changeBreakpoint",{})};this.clearBreakpoints=function(){this.$breakpoints=[];this._emit("changeBreakpoint",{})};this.setBreakpoint=function(b,c){c===void 0&&(c="ace_breakpoint");c?this.$breakpoints[b]=c:delete this.$breakpoints[b];this._emit("changeBreakpoint",{})};this.clearBreakpoint=function(b){delete this.$breakpoints[b];this._emit("changeBreakpoint",{})};this.addMarker=function(b,
c,d,e){var f=this.$markerId++,b={range:b,type:d||"line",renderer:typeof d=="function"?d:null,clazz:c,inFront:!!e,id:f};return e?(this.$frontMarkers[f]=b,this._emit("changeFrontMarker")):(this.$backMarkers[f]=b,this._emit("changeBackMarker")),f};this.addDynamicMarker=function(b,c){if(b.update){var d=this.$markerId++;return b.id=d,b.inFront=!!c,c?(this.$frontMarkers[d]=b,this._emit("changeFrontMarker")):(this.$backMarkers[d]=b,this._emit("changeBackMarker")),b}};this.removeMarker=function(b){var c=
this.$frontMarkers[b]||this.$backMarkers[b];if(c){var d=c.inFront?this.$frontMarkers:this.$backMarkers;c&&(delete d[b],this._emit(c.inFront?"changeFrontMarker":"changeBackMarker"))}};this.getMarkers=function(b){return b?this.$frontMarkers:this.$backMarkers};this.highlight=function(b){if(!this.$searchHighlight)this.$searchHighlight=this.addDynamicMarker(new n(null,"ace_selected-word","text"));this.$searchHighlight.setRegexp(b)};this.highlightLines=function(b,c,d,e){typeof c!="number"&&(d=c,c=b);d||
(d="ace_step");b=new k(b,0,c,Infinity);return b.id=this.addMarker(b,d,"fullLine",e),b};this.setAnnotations=function(b){this.$annotations=b;this._emit("changeAnnotation",{})};this.getAnnotations=function(){return this.$annotations||[]};this.clearAnnotations=function(){this.setAnnotations([])};this.$detectNewLine=function(b){(b=b.match(/^.*?(\r?\n)/m))?this.$autoNewLine=b[1]:this.$autoNewLine="\n"};this.getWordRange=function(b,c){var d=this.getLine(b),e=false;c>0&&(e=!!d.charAt(c-1).match(this.tokenRe));
e||(e=!!d.charAt(c).match(this.tokenRe));var e=e?this.tokenRe:/^\s+$/.test(d.slice(c-1,c+1))?/\s/:this.nonTokenRe,f=c;if(f>0){do f--;while(f>=0&&d.charAt(f).match(e));f++}for(var g=c;g<d.length&&d.charAt(g).match(e);)g++;return new k(b,f,b,g)};this.getAWordRange=function(b,c){for(var d=this.getWordRange(b,c),e=this.getLine(d.end.row);e.charAt(d.end.column).match(/[ \t]/);)d.end.column=d.end.column+1;return d};this.setNewLineMode=function(b){this.doc.setNewLineMode(b)};this.getNewLineMode=function(){return this.doc.getNewLineMode()};
this.setUseWorker=function(b){this.setOption("useWorker",b)};this.getUseWorker=function(){return this.$useWorker};this.onReloadTokenizer=function(b){this.bgTokenizer.start(b.data.first);this._emit("tokenizerUpdate",b)};this.$modes={};this.$modeId=this.$mode=null;this.setMode=function(b,c){if(b&&typeof b=="object"){if(b.getTokenizer)return this.$onChangeMode(b);var d=b,e=d.path}else e=b||"ace/mode/text";this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new j);if(this.$modes[e]&&!d){this.$onChangeMode(this.$modes[e]);
c&&c()}else{this.$modeId=e;f.loadModule(["mode",e],function(b){if(this.$modeId!==e)return c&&c();if(this.$modes[e]&&!d)return this.$onChangeMode(this.$modes[e]);b&&b.Mode&&(b=new b.Mode(d),d||(this.$modes[e]=b,b.$id=e),this.$onChangeMode(b),c&&c())}.bind(this));this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],true)}};this.$onChangeMode=function(b,c){c||(this.$modeId=b.$id);if(this.$mode!==b){this.$mode=b;this.$stopWorker();this.$useWorker&&this.$startWorker();var d=b.getTokenizer();if(d.addEventListener!==
void 0){var e=this.onReloadTokenizer.bind(this);d.addEventListener("update",e)}if(this.bgTokenizer)this.bgTokenizer.setTokenizer(d);else{this.bgTokenizer=new m(d);var f=this;this.bgTokenizer.addEventListener("update",function(b){f._emit("tokenizerUpdate",b)})}this.bgTokenizer.setDocument(this.getDocument());this.tokenRe=b.tokenRe;this.nonTokenRe=b.nonTokenRe;c||(this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(b.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode"))}};
this.$stopWorker=function(){this.$worker&&this.$worker.terminate();this.$worker=null};this.$startWorker=function(){if(typeof Worker!="undefined"&&!b.noWorker)try{this.$worker=this.$mode.createWorker(this)}catch(c){console.log("Could not load worker");console.log(c);this.$worker=null}else this.$worker=null};this.getMode=function(){return this.$mode};this.$scrollTop=0;this.setScrollTop=function(b){if(!(this.$scrollTop===b||isNaN(b))){this.$scrollTop=b;this._signal("changeScrollTop",b)}};this.getScrollTop=
function(){return this.$scrollTop};this.$scrollLeft=0;this.setScrollLeft=function(b){if(!(this.$scrollLeft===b||isNaN(b))){this.$scrollLeft=b;this._signal("changeScrollLeft",b)}};this.getScrollLeft=function(){return this.$scrollLeft};this.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth};this.getLineWidgetMaxWidth=function(){if(this.lineWidgetsWidth!=null)return this.lineWidgetsWidth;var b=0;return this.lineWidgets.forEach(function(c){c&&
c.screenWidth>b&&(b=c.screenWidth)}),this.lineWidgetWidth=b};this.$computeWidth=function(b){if(this.$modified||b){this.$modified=false;if(this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var b=this.doc.getAllLines(),c=this.$rowLengthCache,d=0,e=0,f=this.$foldData[e],g=f?f.start.row:Infinity,h=b.length,j=0;j<h;j++){if(j>g){j=f.end.row+1;if(j>=h)break;g=(f=this.$foldData[e++])?f.start.row:Infinity}c[j]==null&&(c[j]=this.$getStringScreenWidth(b[j])[0]);c[j]>d&&(d=c[j])}this.screenWidth=
d}};this.getLine=function(b){return this.doc.getLine(b)};this.getLines=function(b,c){return this.doc.getLines(b,c)};this.getLength=function(){return this.doc.getLength()};this.getTextRange=function(b){return this.doc.getTextRange(b||this.selection.getRange())};this.insert=function(b,c){return this.doc.insert(b,c)};this.remove=function(b){return this.doc.remove(b)};this.undoChanges=function(b,c){if(b.length){this.$fromUndo=true;for(var d=null,e=b.length-1;e!=-1;e--){var f=b[e];f.group=="doc"?(this.doc.revertDeltas(f.deltas),
d=this.$getUndoSelection(f.deltas,true,d)):f.deltas.forEach(function(b){this.addFolds(b.folds)},this)}return this.$fromUndo=false,d&&this.$undoSelect&&!c&&this.selection.setSelectionRange(d),d}};this.redoChanges=function(b,c){if(b.length){this.$fromUndo=true;for(var d=null,e=0;e<b.length;e++){var f=b[e];f.group=="doc"&&(this.doc.applyDeltas(f.deltas),d=this.$getUndoSelection(f.deltas,false,d))}return this.$fromUndo=false,d&&this.$undoSelect&&!c&&this.selection.setSelectionRange(d),d}};this.setUndoSelect=
function(b){this.$undoSelect=b};this.$getUndoSelection=function(b,c,d){function e(b){b=b.action==="insertText"||b.action==="insertLines";return c?!b:b}var f=b[0],g,h;e(f)?g=k.fromPoints(f.range.start,f.range.end):g=k.fromPoints(f.range.start,f.range.start);for(var j=1;j<b.length;j++){f=b[j];e(f)?(h=f.range.start,g.compare(h.row,h.column)==-1&&g.setStart(f.range.start),h=f.range.end,g.compare(h.row,h.column)==1&&g.setEnd(f.range.end)):(h=f.range.start,g.compare(h.row,h.column)==-1&&(g=k.fromPoints(f.range.start,
f.range.start)))}if(d!=null){k.comparePoints(d.start,g.start)==0&&(d.start.column=d.start.column+(g.end.column-g.start.column),d.end.column=d.end.column+(g.end.column-g.start.column));b=d.compareRange(g);b==1?g.setStart(d.start):b==-1&&g.setEnd(d.end)}return g};this.replace=function(b,c){return this.doc.replace(b,c)};this.moveText=function(b,c,d){var e=this.getTextRange(b),f=this.getFoldsInRange(b),c=k.fromPoints(c,c);if(!d){this.remove(b);var g=b.start.row-b.end.row,h=g?-b.end.column:b.start.column-
b.end.column;h&&(c.start.row==b.end.row&&c.start.column>b.end.column&&(c.start.column=c.start.column+h),c.end.row==b.end.row&&c.end.column>b.end.column&&(c.end.column=c.end.column+h));g&&c.start.row>=b.end.row&&(c.start.row=c.start.row+g,c.end.row=c.end.row+g)}c.end=this.insert(c.start,e);if(f.length){var j=b.start,b=c.start,g=b.row-j.row,h=b.column-j.column;this.addFolds(f.map(function(b){return b=b.clone(),b.start.row==j.row&&(b.start.column=b.start.column+h),b.end.row==j.row&&(b.end.column=b.end.column+
h),b.start.row=b.start.row+g,b.end.row=b.end.row+g,b}))}return c};this.indentRows=function(b,c,d){for(d=d.replace(/\t/g,this.getTabString());b<=c;b++)this.insert({row:b,column:0},d)};this.outdentRows=function(b){for(var b=b.collapseRows(),c=new k(0,0,0,0),d=this.getTabSize(),e=b.start.row;e<=b.end.row;++e){var f=this.getLine(e);c.start.row=e;c.end.row=e;for(var g=0;g<d;++g)if(f.charAt(g)!=" ")break;g<d&&f.charAt(g)=="\t"?(c.start.column=g,c.end.column=g+1):(c.start.column=0,c.end.column=g);this.remove(c)}};
this.$moveLines=function(b,c,d){b=this.getRowFoldStart(b);c=this.getRowFoldEnd(c);if(d<0){var e=this.getRowFoldStart(b+d);if(e<0)return 0;var f=e-b}else if(d>0){e=this.getRowFoldEnd(c+d);if(e>this.doc.getLength()-1)return 0;f=e-c}else{b=this.$clipRowToDocument(b);c=this.$clipRowToDocument(c);f=c-b+1}e=this.getFoldsInRange(new k(b,0,c,Number.MAX_VALUE)).map(function(b){return b=b.clone(),b.start.row=b.start.row+f,b.end.row=b.end.row+f,b});c=d==0?this.doc.getLines(b,c):this.doc.removeLines(b,c);return this.doc.insertLines(b+
f,c),e.length&&this.addFolds(e),f};this.moveLinesUp=function(b,c){return this.$moveLines(b,c,-1)};this.moveLinesDown=function(b,c){return this.$moveLines(b,c,1)};this.duplicateLines=function(b,c){return this.$moveLines(b,c,0)};this.$clipRowToDocument=function(b){return Math.max(0,Math.min(b,this.doc.getLength()-1))};this.$clipColumnToRow=function(b,c){return c<0?0:Math.min(this.doc.getLine(b).length,c)};this.$clipPositionToDocument=function(b,c){c=Math.max(0,c);if(b<0)c=b=0;else{var d=this.doc.getLength();
b>=d?(b=d-1,c=this.doc.getLine(d-1).length):c=Math.min(this.doc.getLine(b).length,c)}return{row:b,column:c}};this.$clipRangeToDocument=function(b){b.start.row<0?(b.start.row=0,b.start.column=0):b.start.column=this.$clipColumnToRow(b.start.row,b.start.column);var c=this.doc.getLength()-1;return b.end.row>c?(b.end.row=c,b.end.column=this.doc.getLine(c).length):b.end.column=this.$clipColumnToRow(b.end.row,b.end.column),b};this.$wrapLimit=80;this.$useWrapMode=false;this.$wrapLimitRange={min:null,max:null};
this.setUseWrapMode=function(b){if(b!=this.$useWrapMode){this.$useWrapMode=b;this.$modified=true;this.$resetRowCache(0);if(b){b=this.getLength();this.$wrapData=[];for(var c=0;c<b;c++)this.$wrapData.push([]);this.$updateWrapData(0,b-1)}this._emit("changeWrapMode")}};this.getUseWrapMode=function(){return this.$useWrapMode};this.setWrapLimitRange=function(b,c){if(this.$wrapLimitRange.min!==b||this.$wrapLimitRange.max!==c){this.$wrapLimitRange={min:b,max:c};this.$modified=true;this._emit("changeWrapMode")}};
this.adjustWrapLimit=function(b,c){var d=this.$wrapLimitRange;d.max<0&&(d={min:c,max:c});d=this.$constrainWrapLimit(b,d.min,d.max);return d!=this.$wrapLimit&&d>1?(this.$wrapLimit=d,this.$modified=true,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._emit("changeWrapLimit")),true):false};this.$constrainWrapLimit=function(b,c,d){return c&&(b=Math.max(c,b)),d&&(b=Math.min(d,b)),b};this.getWrapLimit=function(){return this.$wrapLimit};this.setWrapLimit=function(b){this.setWrapLimitRange(b,
b)};this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}};this.$updateInternalDataOnChange=function(b){var c=this.$useWrapMode,d,e=b.data.action,f=b.data.range.start.row,g=b.data.range.end.row,h=b.data.range.start,j=b.data.range.end,k=null;e.indexOf("Lines")!=-1?(e=="insertLines"?g=f+b.data.lines.length:g=f,d=b.data.lines?b.data.lines.length:g-f):d=g-f;this.$updating=true;if(d!=0)if(e.indexOf("remove")!=-1){this[c?"$wrapData":"$rowLengthCache"].splice(f,
d);e=this.$foldData;k=this.getFoldsInRange(b.data.range);this.removeFolds(k);var b=this.getFoldLine(j.row),l=0;if(b){b.addRemoveChars(j.row,j.column,h.column-j.column);b.shiftRow(-d);(g=this.getFoldLine(f))&&g!==b&&(g.merge(b),b=g);l=e.indexOf(b)+1}for(l;l<e.length;l++){b=e[l];b.start.row>=j.row&&b.shiftRow(-d)}g=f}else{if(c){e=[f,0];for(b=0;b<d;b++)e.push([]);this.$wrapData.splice.apply(this.$wrapData,e)}else{e=Array(d);e.unshift(f,0);this.$rowLengthCache.splice.apply(this.$rowLengthCache,e)}e=this.$foldData;
b=this.getFoldLine(f);l=0;if(b){l=b.range.compareInside(h.row,h.column);l==0?(b=b.split(h.row,h.column),b.shiftRow(d),b.addRemoveChars(g,0,j.column-h.column)):l==-1&&(b.addRemoveChars(f,0,j.column-h.column),b.shiftRow(d));l=e.indexOf(b)+1}for(l;l<e.length;l++){b=e[l];b.start.row>=f&&b.shiftRow(d)}}else{d=Math.abs(b.data.range.start.column-b.data.range.end.column);e.indexOf("remove")!=-1&&(k=this.getFoldsInRange(b.data.range),this.removeFolds(k),d=-d);(b=this.getFoldLine(f))&&b.addRemoveChars(f,h.column,
d)}return c&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=false,c?this.$updateWrapData(f,g):this.$updateRowLengthCache(f,g),k};this.$updateRowLengthCache=function(b,c){this.$rowLengthCache[b]=null;this.$rowLengthCache[c]=null};this.$updateWrapData=function(b,c){for(var d=this.doc.getAllLines(),e=this.getTabSize(),f=this.$wrapData,g=this.$wrapLimit,j,k,m=b,c=Math.min(c,d.length-1);m<=c;)(k=this.getFoldLine(m,
k))?(j=[],k.walk(function(b,c,e,f){if(b!=null){b=this.$getDisplayTokens(b,j.length);b[0]=h;for(c=1;c<b.length;c++)b[c]=l}else b=this.$getDisplayTokens(d[c].substring(f,e),j.length);j=j.concat(b)}.bind(this),k.end.row,d[k.end.row].length+1),f[k.start.row]=this.$computeWrapSplits(j,g,e),m=k.end.row+1):(j=this.$getDisplayTokens(d[m]),f[m]=this.$computeWrapSplits(j,g,e),m++)};var h=3,l=4;this.$computeWrapSplits=function(b,c){function d(c){var f=b.slice(g,c),h=f.length;f.join("").replace(/12/g,function(){h=
h-1}).replace(/2/g,function(){h=h-1});j=j+h;e.push(j);g=c}if(b.length==0)return[];for(var e=[],f=b.length,g=0,j=0,k=this.$wrapAsCode;f-g>c;){var m=g+c;if(b[m-1]>=10&&b[m]>=10)d(m);else if(b[m]==h||b[m]==l){for(m;m!=g-1;m--)if(b[m]==h)break;if(!(m>g)){m=g+c;for(m;m<b.length;m++)if(b[m]!=l)break;if(m==b.length)break}d(m)}else{for(var n=Math.max(m-(k?10:c-(c>>2)),g-1);m>n&&b[m]<h;)m--;if(k){for(;m>n&&b[m]<h;)m--;for(;m>n&&b[m]==9;)m--}else for(;m>n&&b[m]<10;)m--;if(m>n)d(++m);else{m=g+c;d(m)}}}return e};
this.$getDisplayTokens=function(b,d){for(var e=[],f,d=d||0,g=0;g<b.length;g++){f=b.charCodeAt(g);if(f==9){f=this.getScreenTabSize(e.length+d);e.push(11);for(var h=1;h<f;h++)e.push(12)}else f==32?e.push(10):f>39&&f<48||f>57&&f<64?e.push(9):f>=4352&&c(f)?e.push(1,2):e.push(1)}return e};this.$getStringScreenWidth=function(b,d,e){if(d==0)return[0,0];d==null&&(d=Infinity);var e=e||0,f,g;for(g=0;g<b.length;g++){f=b.charCodeAt(g);f==9?e=e+this.getScreenTabSize(e):f>=4352&&c(f)?e=e+2:e=e+1;if(e>d)break}return[e,
g]};this.lineWidgets=null;this.getRowLength=function(b){var c=this.lineWidgets?this.lineWidgets[b]&&this.lineWidgets[b].rowCount||0:0;return!this.$useWrapMode||!this.$wrapData[b]?1+c:this.$wrapData[b].length+1+c};this.getRowLineCount=function(b){return!this.$useWrapMode||!this.$wrapData[b]?1:this.$wrapData[b].length+1};this.getScreenLastRowColumn=function(b){b=this.screenToDocumentPosition(b,Number.MAX_VALUE);return this.documentToScreenColumn(b.row,b.column)};this.getDocumentLastRowColumn=function(b,
c){return this.getScreenLastRowColumn(this.documentToScreenRow(b,c))};this.getDocumentLastRowColumnPosition=function(b,c){return this.screenToDocumentPosition(this.documentToScreenRow(b,c),Number.MAX_VALUE/10)};this.getRowSplitData=function(b){return this.$useWrapMode?this.$wrapData[b]:void 0};this.getScreenTabSize=function(b){return this.$tabSize-b%this.$tabSize};this.screenToDocumentRow=function(b,c){return this.screenToDocumentPosition(b,c).row};this.screenToDocumentColumn=function(b,c){return this.screenToDocumentPosition(b,
c).column};this.screenToDocumentPosition=function(b,c){if(b<0)return{row:0,column:0};var d,e=0,f=0,g,h=0;d=0;var j=this.$screenRowCache,k=this.$getRowCacheIndex(j,b),l=j.length;if(l&&k>=0){h=j[k];e=this.$docRowCache[k];k=b>j[l-1]}else k=!l;for(var l=this.getLength()-1,m=(j=this.getNextFoldLine(e))?j.start.row:Infinity;h<=b;){d=this.getRowLength(e);if(h+d>b||e>=l)break;h=h+d;e++;e>m&&(e=j.end.row+1,j=this.getNextFoldLine(e,j),m=j?j.start.row:Infinity);k&&(this.$docRowCache.push(e),this.$screenRowCache.push(h))}if(j&&
j.start.row<=e){d=this.getFoldDisplayLine(j);e=j.start.row}else{if(h+d<=b||e>l)return{row:l,column:this.getLine(l).length};d=this.getLine(e);j=null}if(this.$useWrapMode)if(k=this.$wrapData[e]){h=Math.floor(b-h);g=k[h];h>0&&k.length&&(f=k[h-1]||k[k.length-1],d=d.substring(f))}return f=f+this.$getStringScreenWidth(d,c)[1],this.$useWrapMode&&f>=g&&(f=g-1),j?j.idxToPosition(f):{row:e,column:f}};this.documentToScreenPosition=function(b,c){var d=typeof c=="undefined"?this.$clipPositionToDocument(b.row,
b.column):this.$clipPositionToDocument(b,c),b=d.row,c=d.column,d=0,e=null,f=null;(f=this.getFoldAt(b,c,1))&&(b=f.start.row,c=f.start.column);var g,f=0,h=this.$docRowCache,j=this.$getRowCacheIndex(h,b);if((g=h.length)&&j>=0)var f=h[j],d=this.$screenRowCache[j],k=b>h[g-1];else k=!g;for(j=(h=this.getNextFoldLine(f))?h.start.row:Infinity;f<b;){if(f>=j){g=h.end.row+1;if(g>b)break;j=(h=this.getNextFoldLine(g,h))?h.start.row:Infinity}else g=f+1;d=d+this.getRowLength(f);f=g;k&&(this.$docRowCache.push(f),
this.$screenRowCache.push(d))}g="";h&&f>=j?(g=this.getFoldDisplayLine(h,b,c),e=h.start.row):(g=this.getLine(b).substring(0,c),e=b);if(this.$useWrapMode){e=this.$wrapData[e];for(f=0;g.length>=e[f];){d++;f++}g=g.substring(e[f-1]||0,g.length)}return{row:d,column:this.$getStringScreenWidth(g)[0]}};this.documentToScreenColumn=function(b,c){return this.documentToScreenPosition(b,c).column};this.documentToScreenRow=function(b,c){return this.documentToScreenPosition(b,c).row};this.getScreenLength=function(){var b=
0,c=null;if(this.$useWrapMode)for(var d=this.$wrapData.length,e=0,f=0,g=(c=this.$foldData[f++])?c.start.row:Infinity;e<d;){b=b+(this.$wrapData[e].length+1);e++;e>g&&(e=c.end.row+1,c=this.$foldData[f++],g=c?c.start.row:Infinity)}else for(var b=this.getLength(),d=this.$foldData,f=0;f<d.length;f++){c=d[f];b=b-(c.end.row-c.start.row)}return this.lineWidgets&&(b=b+this.$getWidgetScreenLength()),b}}).call(q.prototype);b("./edit_session/folding").Folding.call(q.prototype);b("./edit_session/bracket_match").BracketMatch.call(q.prototype);
f.defineOptions(q.prototype,"session",{wrap:{set:function(b){!b||b=="off"?b=false:b=="free"?b=true:b=="printMargin"?b=-1:typeof b=="string"&&(b=parseInt(b,10)||false);if(this.$wrap!=b){if(b){var c=typeof b=="number"?b:null;this.setWrapLimitRange(c,c);this.setUseWrapMode(true)}else this.setUseWrapMode(false);this.$wrap=b}},get:function(){return this.getUseWrapMode()?this.$wrap==-1?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:true},wrapMethod:{set:function(b){b=b==
"auto"?this.$mode.type!="text":b!="text";b!=this.$wrapAsCode&&(this.$wrapAsCode=b,this.$useWrapMode&&(this.$modified=true,this.$resetRowCache(0),this.$updateWrapData(0,this.getLength()-1)))},initialValue:"auto"},firstLineNumber:{set:function(){this._emit("changeBreakpoint")},initialValue:1},useWorker:{set:function(b){this.$useWorker=b;this.$stopWorker();b&&this.$startWorker()},initialValue:true},useSoftTabs:{initialValue:true},tabSize:{set:function(b){if(!(isNaN(b)||this.$tabSize===b)){this.$modified=
true;this.$rowLengthCache=[];this.$tabSize=b;this._emit("changeTabSize")}},initialValue:4,handlesSet:true},overwrite:{set:function(){this._emit("changeOverwrite")},initialValue:false},newLineMode:{set:function(b){this.doc.setNewLineMode(b)},get:function(){return this.doc.getNewLineMode()},handlesSet:true},mode:{set:function(b){this.setMode(b)},get:function(){return this.$modeId}}});c.EditSession=q});
ace.define("ace/selection","require exports module ace/lib/oop ace/lib/lang ace/lib/event_emitter ace/range".split(" "),function(b,c){var d=b("./lib/oop"),e=b("./lib/lang"),f=b("./lib/event_emitter").EventEmitter,g=b("./range").Range,h=function(b){this.session=b;this.doc=b.getDocument();this.clearSelection();this.lead=this.selectionLead=this.doc.createAnchor(0,0);this.anchor=this.selectionAnchor=this.doc.createAnchor(0,0);var c=this;this.lead.on("change",function(b){c._emit("changeCursor");c.$isEmpty||
c._emit("changeSelection");!c.$keepDesiredColumnOnChange&&b.old.column!=b.value.column&&(c.$desiredColumn=null)});this.selectionAnchor.on("change",function(){c.$isEmpty||c._emit("changeSelection")})};(function(){d.implement(this,f);this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column};this.isMultiLine=function(){return this.isEmpty()?false:this.getRange().isMultiLine()};this.getCursor=function(){return this.lead.getPosition()};this.setSelectionAnchor=
function(b,c){this.anchor.setPosition(b,c);this.$isEmpty&&(this.$isEmpty=false,this._emit("changeSelection"))};this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()};this.getSelectionLead=function(){return this.lead.getPosition()};this.shiftSelection=function(b){if(this.$isEmpty)this.moveCursorTo(this.lead.row,this.lead.column+b);else{var c=this.getSelectionAnchor(),d=this.getSelectionLead(),e=this.isBackwards();(!e||c.column!==0)&&this.setSelectionAnchor(c.row,
c.column+b);(e||d.column!==0)&&this.$moveSelection(function(){this.moveCursorTo(d.row,d.column+b)})}};this.isBackwards=function(){var b=this.anchor,c=this.lead;return b.row>c.row||b.row==c.row&&b.column>c.column};this.getRange=function(){var b=this.anchor,c=this.lead;return this.isEmpty()?g.fromPoints(c,c):this.isBackwards()?g.fromPoints(c,b):g.fromPoints(b,c)};this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=true,this._emit("changeSelection"))};this.selectAll=function(){var b=this.doc.getLength()-
1;this.setSelectionAnchor(0,0);this.moveCursorTo(b,this.doc.getLine(b).length)};this.setRange=this.setSelectionRange=function(b,c){c?(this.setSelectionAnchor(b.end.row,b.end.column),this.selectTo(b.start.row,b.start.column)):(this.setSelectionAnchor(b.start.row,b.start.column),this.selectTo(b.end.row,b.end.column));this.getRange().isEmpty()&&(this.$isEmpty=true);this.$desiredColumn=null};this.$moveSelection=function(b){var c=this.lead;this.$isEmpty&&this.setSelectionAnchor(c.row,c.column);b.call(this)};
this.selectTo=function(b,c){this.$moveSelection(function(){this.moveCursorTo(b,c)})};this.selectToPosition=function(b){this.$moveSelection(function(){this.moveCursorToPosition(b)})};this.selectUp=function(){this.$moveSelection(this.moveCursorUp)};this.selectDown=function(){this.$moveSelection(this.moveCursorDown)};this.selectRight=function(){this.$moveSelection(this.moveCursorRight)};this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)};this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)};
this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)};this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)};this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)};this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)};this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)};this.getWordRange=function(b,c){if(typeof c=="undefined")var d=b||this.lead,b=d.row,c=d.column;return this.session.getWordRange(b,
c)};this.selectWord=function(){this.setSelectionRange(this.getWordRange())};this.selectAWord=function(){var b=this.getCursor();this.setSelectionRange(this.session.getAWordRange(b.row,b.column))};this.getLineRange=function(b,c){var d=typeof b=="number"?b:this.lead.row,e,f=this.session.getFoldLine(d);return f?(d=f.start.row,e=f.end.row):e=d,c===true?new g(d,0,e,this.session.getLine(e).length):new g(d,0,e+1,0)};this.selectLine=function(){this.setSelectionRange(this.getLineRange())};this.moveCursorUp=
function(){this.moveCursorBy(-1,0)};this.moveCursorDown=function(){this.moveCursorBy(1,0)};this.moveCursorLeft=function(){var b=this.lead.getPosition(),c;if(c=this.session.getFoldAt(b.row,b.column,-1))this.moveCursorTo(c.start.row,c.start.column);else if(b.column==0)b.row>0&&this.moveCursorTo(b.row-1,this.doc.getLine(b.row-1).length);else{c=this.session.getTabSize();this.session.isTabStop(b)&&this.doc.getLine(b.row).slice(b.column-c,b.column).split(" ").length-1==c?this.moveCursorBy(0,-c):this.moveCursorBy(0,
-1)}};this.moveCursorRight=function(){var b=this.lead.getPosition();if(b=this.session.getFoldAt(b.row,b.column,1))this.moveCursorTo(b.end.row,b.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var c=this.session.getTabSize(),b=this.lead;this.session.isTabStop(b)&&this.doc.getLine(b.row).slice(b.column,b.column+c).split(" ").length-1==c?this.moveCursorBy(0,c):this.moveCursorBy(0,1)}};this.moveCursorLineStart=
function(){var b=this.lead.row,c=this.lead.column,d=this.session.screenToDocumentPosition(this.session.documentToScreenRow(b,c),0),b=this.session.getDisplayLine(b,null,d.row,d.column).match(/^\s*/);b[0].length!=c&&!this.session.$useEmacsStyleLineStart&&(d.column=d.column+b[0].length);this.moveCursorToPosition(d)};this.moveCursorLineEnd=function(){var b=this.lead,b=this.session.getDocumentLastRowColumnPosition(b.row,b.column);if(this.lead.column==b.column){var c=this.session.getLine(b.row);if(b.column==
c.length){c=c.search(/\s+$/);c>0&&(b.column=c)}}this.moveCursorTo(b.row,b.column)};this.moveCursorFileEnd=function(){var b=this.doc.getLength()-1,c=this.doc.getLine(b).length;this.moveCursorTo(b,c)};this.moveCursorFileStart=function(){this.moveCursorTo(0,0)};this.moveCursorLongWordRight=function(){var b=this.lead.row,c=this.lead.column,d=this.doc.getLine(b),e=d.substring(c);this.session.nonTokenRe.lastIndex=0;this.session.tokenRe.lastIndex=0;var f=this.session.getFoldAt(b,c,1);if(f)this.moveCursorTo(f.end.row,
f.end.column);else{if(this.session.nonTokenRe.exec(e)){c=c+this.session.nonTokenRe.lastIndex;this.session.nonTokenRe.lastIndex=0;e=d.substring(c)}if(c>=d.length){this.moveCursorTo(b,d.length);this.moveCursorRight();b<this.doc.getLength()-1&&this.moveCursorWordRight()}else{if(this.session.tokenRe.exec(e)){c=c+this.session.tokenRe.lastIndex;this.session.tokenRe.lastIndex=0}this.moveCursorTo(b,c)}}};this.moveCursorLongWordLeft=function(){var b=this.lead.row,c=this.lead.column,d;if(d=this.session.getFoldAt(b,
c,-1))this.moveCursorTo(d.start.row,d.start.column);else{d=this.session.getFoldStringAt(b,c,-1);d==null&&(d=this.doc.getLine(b).substring(0,c));d=e.stringReverse(d);this.session.nonTokenRe.lastIndex=0;this.session.tokenRe.lastIndex=0;if(this.session.nonTokenRe.exec(d)){c=c-this.session.nonTokenRe.lastIndex;d=d.slice(this.session.nonTokenRe.lastIndex);this.session.nonTokenRe.lastIndex=0}if(c<=0){this.moveCursorTo(b,0);this.moveCursorLeft();b>0&&this.moveCursorWordLeft()}else{if(this.session.tokenRe.exec(d)){c=
c-this.session.tokenRe.lastIndex;this.session.tokenRe.lastIndex=0}this.moveCursorTo(b,c)}}};this.$shortWordEndIndex=function(b){var c=0,d,e=/\s/,f=this.session.tokenRe;f.lastIndex=0;if(this.session.tokenRe.exec(b))c=this.session.tokenRe.lastIndex;else{for(;(d=b[c])&&e.test(d);)c++;if(c<1)for(f.lastIndex=0;(d=b[c])&&!f.test(d);){f.lastIndex=0;c++;if(e.test(d)){if(c>2){c--;break}for(;(d=b[c])&&e.test(d);)c++;if(c>2)break}}}return f.lastIndex=0,c};this.moveCursorShortWordRight=function(){var b=this.lead.row,
c=this.lead.column,d=this.doc.getLine(b),e=d.substring(c),f=this.session.getFoldAt(b,c,1);if(f)return this.moveCursorTo(f.end.row,f.end.column);if(c==d.length){c=this.doc.getLength();do{b++;e=this.doc.getLine(b)}while(b<c&&/^\s*$/.test(e));/^\s+/.test(e)||(e="");c=0}e=this.$shortWordEndIndex(e);this.moveCursorTo(b,c+e)};this.moveCursorShortWordLeft=function(){var b=this.lead.row,c=this.lead.column,d;if(d=this.session.getFoldAt(b,c,-1))return this.moveCursorTo(d.start.row,d.start.column);d=this.session.getLine(b).substring(0,
c);if(c==0){do{b--;d=this.doc.getLine(b)}while(b>0&&/^\s*$/.test(d));c=d.length;/\s+$/.test(d)||(d="")}d=this.$shortWordEndIndex(e.stringReverse(d));return this.moveCursorTo(b,c-d)};this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()};this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()};this.moveCursorBy=function(b,c){var d=this.session.documentToScreenPosition(this.lead.row,
this.lead.column);c===0&&(this.$desiredColumn?d.column=this.$desiredColumn:this.$desiredColumn=d.column);d=this.session.screenToDocumentPosition(d.row+b,d.column);b!==0&&c===0&&d.row===this.lead.row&&d.column===this.lead.column&&this.session.lineWidgets&&this.session.lineWidgets[d.row]&&d.row++;this.moveCursorTo(d.row,d.column+c,c===0)};this.moveCursorToPosition=function(b){this.moveCursorTo(b.row,b.column)};this.moveCursorTo=function(b,c,d){var e=this.session.getFoldAt(b,c,1);e&&(b=e.start.row,c=
e.start.column);this.$keepDesiredColumnOnChange=true;this.lead.setPosition(b,c);this.$keepDesiredColumnOnChange=false;d||(this.$desiredColumn=null)};this.moveCursorToScreen=function(b,c,d){b=this.session.screenToDocumentPosition(b,c);this.moveCursorTo(b.row,b.column,d)};this.detach=function(){this.lead.detach();this.anchor.detach();this.session=this.doc=null};this.fromOrientedRange=function(b){this.setSelectionRange(b,b.cursor==b.start);this.$desiredColumn=b.desiredColumn||this.$desiredColumn};this.toOrientedRange=
function(b){var c=this.getRange();return b?(b.start.column=c.start.column,b.start.row=c.start.row,b.end.column=c.end.column,b.end.row=c.end.row):b=c,b.cursor=this.isBackwards()?b.start:b.end,b.desiredColumn=this.$desiredColumn,b};this.toJSON=function(){if(this.rangeCount)var b=this.ranges.map(function(b){var c=b.clone();return c.isBackwards=b.cursor==b.start,c});else{b=this.getRange();b.isBackwards=this.isBackwards()}return b};this.fromJSON=function(b){if(b.start==void 0){if(this.rangeList){this.toSingleRange(b[0]);
for(var c=b.length;c--;){var d=g.fromPoints(b[c].start,b[c].end);b.isBackwards&&(d.cursor=d.start);this.addRange(d,true)}return}b=b[0]}this.rangeList&&this.toSingleRange(b);this.setSelectionRange(b,b.isBackwards)};this.isEqual=function(b){if((b.length||this.rangeCount)&&b.length!=this.rangeCount)return false;if(!b.length||!this.ranges)return this.getRange().isEqual(b);for(var c=this.ranges.length;c--;)if(!this.ranges[c].isEqual(b[c]))return false;return true}}).call(h.prototype);c.Selection=h});
ace.define("ace/range",["require","exports","module"],function(b,c){var d=function(b,c,d,h){this.start={row:b,column:c};this.end={row:d,column:h}};(function(){this.isEqual=function(b){return this.start.row===b.start.row&&this.end.row===b.end.row&&this.start.column===b.start.column&&this.end.column===b.end.column};this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"};this.contains=function(b,c){return 0==this.compare(b,c)};this.compareRange=
function(b){var c,d=b.end,b=b.start;return c=this.compare(d.row,d.column),1==c?(c=this.compare(b.row,b.column),1==c?2:0==c?1:0):-1==c?-2:(c=this.compare(b.row,b.column),-1==c?-1:1==c?42:0)};this.comparePoint=function(b){return this.compare(b.row,b.column)};this.containsRange=function(b){return 0==this.comparePoint(b.start)&&0==this.comparePoint(b.end)};this.intersects=function(b){b=this.compareRange(b);return-1==b||0==b||1==b};this.isEnd=function(b,c){return this.end.row==b&&this.end.column==c};this.isStart=
function(b,c){return this.start.row==b&&this.start.column==c};this.setStart=function(b,c){"object"==typeof b?(this.start.column=b.column,this.start.row=b.row):(this.start.row=b,this.start.column=c)};this.setEnd=function(b,c){"object"==typeof b?(this.end.column=b.column,this.end.row=b.row):(this.end.row=b,this.end.column=c)};this.inside=function(b,c){return 0==this.compare(b,c)?this.isEnd(b,c)||this.isStart(b,c)?!1:!0:!1};this.insideStart=function(b,c){return 0==this.compare(b,c)?this.isEnd(b,c)?!1:
!0:!1};this.insideEnd=function(b,c){return 0==this.compare(b,c)?this.isStart(b,c)?!1:!0:!1};this.compare=function(b,c){return!this.isMultiLine()&&b===this.start.row?c<this.start.column?-1:c>this.end.column?1:0:b<this.start.row?-1:b>this.end.row?1:this.start.row===b?c>=this.start.column?0:-1:this.end.row===b?c<=this.end.column?0:1:0};this.compareStart=function(b,c){return this.start.row==b&&this.start.column==c?-1:this.compare(b,c)};this.compareEnd=function(b,c){return this.end.row==b&&this.end.column==
c?1:this.compare(b,c)};this.compareInside=function(b,c){return this.end.row==b&&this.end.column==c?1:this.start.row==b&&this.start.column==c?-1:this.compare(b,c)};this.clipRows=function(b,c){if(this.end.row>c)var g={row:c+1,column:0};else this.end.row<b&&(g={row:b,column:0});if(this.start.row>c)var h={row:c+1,column:0};else this.start.row<b&&(h={row:b,column:0});return d.fromPoints(h||this.start,g||this.end)};this.extend=function(b,c){var g=this.compare(b,c);if(0==g)return this;if(-1==g)var h={row:b,
column:c};else var j={row:b,column:c};return d.fromPoints(h||this.start,j||this.end)};this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column};this.isMultiLine=function(){return this.start.row!==this.end.row};this.clone=function(){return d.fromPoints(this.start,this.end)};this.collapseRows=function(){return 0==this.end.column?new d(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new d(this.start.row,0,this.end.row,0)};this.toScreenRange=function(b){var c=
b.documentToScreenPosition(this.start),b=b.documentToScreenPosition(this.end);return new d(c.row,c.column,b.row,b.column)};this.moveBy=function(b,c){this.start.row+=b;this.start.column+=c;this.end.row+=b;this.end.column+=c}}).call(d.prototype);d.fromPoints=function(b,c){return new d(b.row,b.column,c.row,c.column)};d.comparePoints=function(b,c){return b.row-c.row||b.column-c.column};d.comparePoints=function(b,c){return b.row-c.row||b.column-c.column};c.Range=d});
ace.define("ace/mode/text","require exports module ace/tokenizer ace/mode/text_highlight_rules ace/mode/behaviour ace/unicode ace/lib/lang ace/token_iterator ace/range".split(" "),function(b,c){var d=b("../tokenizer").Tokenizer,e=b("./text_highlight_rules").TextHighlightRules,f=b("./behaviour").Behaviour,g=b("../unicode"),h=b("../lib/lang"),j=b("../token_iterator").TokenIterator,k=b("../range").Range,l=function(){this.HighlightRules=e;this.$behaviour=new f};(function(){this.tokenRe=RegExp("^["+g.packages.L+
g.packages.Mn+g.packages.Mc+g.packages.Nd+g.packages.Pc+"\\$_]+","g");this.nonTokenRe=RegExp("^(?:[^"+g.packages.L+g.packages.Mn+g.packages.Mc+g.packages.Nd+g.packages.Pc+"\\$_]|s])+","g");this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=new this.HighlightRules,this.$tokenizer=new d(this.$highlightRules.getRules())),this.$tokenizer};this.blockComment=this.lineCommentStart="";this.toggleCommentLines=function(b,c,d,e){function f(b){for(var c=d;c<=e;c++)b(g.getLine(c),c)}var g=
c.doc,j=true,k=true,l=Infinity,w=c.getTabSize(),b=false;if(this.lineCommentStart){if(Array.isArray(this.lineCommentStart)){z=this.lineCommentStart.map(h.escapeRegExp).join("|");P=this.lineCommentStart[0]}else{z=h.escapeRegExp(this.lineCommentStart);P=this.lineCommentStart}var z=RegExp("^(\\s*)(?:"+z+") ?"),b=c.getUseSoftTabs(),A=function(b,c){var d=b.match(z);if(d){var e=d[1].length,f=d[0].length;!K(b,e,f)&&d[0][f-1]==" "&&f--;g.removeInLine(c,e,f)}},C=P+" ",G=function(b,c){if(!j||/\S/.test(b))K(b,
l,l)?g.insertInLine({row:c,column:l},C):g.insertInLine({row:c,column:l},P)},H=function(b){return z.test(b)},K=function(b,c,d){for(var e=0;c--&&b.charAt(c)==" ";)e++;if(e%w!=0)return false;for(e=0;b.charAt(d++)==" ";)e++;return w>2?e%w!=w-1:e%w==0}}else{if(!this.blockComment)return false;var P=this.blockComment.start,T=this.blockComment.end,z=RegExp("^(\\s*)(?:"+h.escapeRegExp(P)+")"),D=RegExp("(?:"+h.escapeRegExp(T)+")\\s*$"),G=function(b,c){if(!H(b,c)&&(!j||/\S/.test(b))){g.insertInLine({row:c,column:b.length},
T);g.insertInLine({row:c,column:l},P)}},A=function(b,c){var d;(d=b.match(D))&&g.removeInLine(c,b.length-d[0].length,b.length);(d=b.match(z))&&g.removeInLine(c,d[1].length,d[0].length)},H=function(b,d){if(z.test(b))return true;for(var e=c.getTokens(d),f=0;f<e.length;f++)if(e[f].type==="comment")return true}}var F=Infinity;f(function(b,c){var d=b.search(/\S/);d!==-1?(d<l&&(l=d),k&&!H(b,c)&&(k=false)):F>b.length&&(F=b.length)});l==Infinity&&(l=F,j=false,k=false);b&&l%w!=0&&(l=Math.floor(l/w)*w);f(k?
A:G)};this.toggleBlockComment=function(b,c,d,e){if(b=this.blockComment){!b.start&&b[0]&&(b=b[0]);var f=new j(c,e.row,e.column),g=f.getCurrentToken(),h=c.selection.toOrientedRange(),l,u;if(g&&/comment/.test(g.type)){for(var w,z;g&&/comment/.test(g.type);){g=g.value.indexOf(b.start);if(g!=-1){d=f.getCurrentTokenRow();f=f.getCurrentTokenColumn()+g;w=new k(d,f,d,f+b.start.length);break}g=f.stepBackward()}f=new j(c,e.row,e.column);for(g=f.getCurrentToken();g&&/comment/.test(g.type);){g=g.value.indexOf(b.end);
if(g!=-1){d=f.getCurrentTokenRow();f=f.getCurrentTokenColumn()+g;z=new k(d,f,d,f+b.end.length);break}g=f.stepForward()}z&&c.remove(z);w&&(c.remove(w),l=w.start.row,u=-b.start.length)}else{u=b.start.length;l=d.start.row;c.insert(d.end,b.end);c.insert(d.start,b.start)}h.start.row==l&&(h.start.column=h.start.column+u);h.end.row==l&&(h.end.column=h.end.column+u);c.selection.fromOrientedRange(h)}};this.getNextLineIndent=function(b,c){return this.$getIndent(c)};this.checkOutdent=function(){return false};
this.autoOutdent=function(){};this.$getIndent=function(b){return b.match(/^\s*/)[0]};this.createWorker=function(){return null};this.createModeDelegates=function(b){this.$embeds=[];this.$modes={};for(var c in b)b[c]&&(this.$embeds.push(c),this.$modes[c]=new b[c]);var d=["toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"];for(c=0;c<d.length;c++)(function(b){var e=d[c],f=b[e];b[d[c]]=function(){return this.$delegator(e,arguments,f)}})(this)};this.$delegator=
function(b,c,d){var e=c[0];typeof e!="string"&&(e=e[0]);for(var f=0;f<this.$embeds.length;f++)if(this.$modes[this.$embeds[f]]){var g=e.split(this.$embeds[f]);if(!g[0]&&g[1]){c[0]=g[1];d=this.$modes[this.$embeds[f]];return d[b].apply(d,c)}}b=d.apply(this,c);return d?b:void 0};this.transformAction=function(b,c,d,e,f){if(this.$behaviour){var g=this.$behaviour.getBehaviours(),h;for(h in g)if(g[h][c]){var j=g[h][c].apply(this,arguments);if(j)return j}}};this.getKeywords=function(b){if(!this.completionKeywords){var c=
this.$tokenizer.rules,d=[],e;for(e in c)for(var f=c[e],g=0,h=f.length;g<h;g++)if(typeof f[g].token=="string")/keyword|support|storage/.test(f[g].token)&&d.push(f[g].regex);else if(typeof f[g].token=="object")for(var j=0,k=f[g].token.length;j<k;j++)if(/keyword|support|storage/.test(f[g].token[j])){e=f[g].regex.match(/\(.+?\)/g)[j];d.push(e.substr(1,e.length-2))}this.completionKeywords=d}return b?d.concat(this.$keywordList||[]):this.$keywordList};this.$createKeywordList=function(){return this.$highlightRules||
this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]};this.getCompletions=function(){return(this.$keywordList||this.$createKeywordList()).map(function(b){return{name:b,value:b,score:0,meta:"keyword"}})};this.$id="ace/mode/text"}).call(l.prototype);c.Mode=l});
ace.define("ace/tokenizer",["require","exports","module"],function(b,c){var d=1E3,e=function(b){this.states=b;this.regExps={};this.matchMappings={};for(var c in this.states){for(var b=this.states[c],d=[],e=0,k=this.matchMappings[c]={defaultToken:"text"},l="g",m=[],n=0;n<b.length;n++){var q=b[n];q.defaultToken&&(k.defaultToken=q.defaultToken);q.caseInsensitive&&(l="gi");if(null!=q.regex){q.regex instanceof RegExp&&(q.regex=q.regex.toString().slice(1,-1));var p=q.regex,s=RegExp("(?:("+p+")|(.))").exec("a").length-
2;if(Array.isArray(q.token))if(1==q.token.length||1==s)q.token=q.token[0];else{if(s-1!=q.token.length)throw Error("number of classes and regexp groups in '"+q.token+"'\n'"+q.regex+"' doesn't match\n"+(s-1)+"!="+q.token.length);q.tokenArray=q.token;q.token=null;q.onMatch=this.$arrayTokens}else"function"==typeof q.token&&!q.onMatch&&(1<s?q.onMatch=this.$applyToken:q.onMatch=q.token);1<s&&(/\\\d/.test(q.regex)?p=q.regex.replace(/\\([0-9]+)/g,function(b,c){return"\\"+(parseInt(c,10)+e+1)}):(s=1,p=this.removeCapturingGroups(q.regex)),
!q.splitRegex&&"string"!=typeof q.token&&m.push(q));k[e]=n;e+=s;d.push(p);q.onMatch||(q.onMatch=null);q.__proto__=null}}m.forEach(function(b){b.splitRegex=this.createSplitterRegexp(b.regex,l)},this);this.regExps[c]=RegExp("("+d.join(")|(")+")|($)",l)}};(function(){this.$setMaxTokenCount=function(b){d=b|0};this.$applyToken=function(b){var c=this.splitRegex.exec(b).slice(1),d=this.token.apply(this,c);if("string"==typeof d)return[{type:d,value:b}];for(var b=[],e=0,k=d.length;e<k;e++)c[e]&&(b[b.length]=
{type:d[e],value:c[e]});return b};this.$arrayTokens=function(b){if(!b)return[];b=this.splitRegex.exec(b);if(!b)return"text";for(var c=[],d=this.tokenArray,e=0,k=d.length;e<k;e++)b[e+1]&&(c[c.length]={type:d[e],value:b[e+1]});return c};this.removeCapturingGroups=function(b){return b.replace(/\[(?:\\.|[^\]])*?\]|\\.|\(\?[:=!]|(\()/g,function(b,c){return c?"(?:":b})};this.createSplitterRegexp=function(b,c){if(-1!=b.indexOf("(?=")){var d=0,e=!1,k,l,m;b.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,function(b,
c,f,g,r,o){return e?e="]"!=r:r?e=!0:g?(d==k&&(l=o+1,k=-1),d--):f&&(d++,1!=f.length&&(k=d,m=o)),b});null!=l&&/^\)*$/.test(b.substr(l))&&(b=b.substring(0,m)+b.substr(l))}return RegExp(b,(c||"").replace("g",""))};this.getLineTokens=function(b,c){if(c&&"string"!=typeof c)var e=c.slice(0),c=e[0];else e=[];var j=c||"start",k=this.states[j];k||(j="start",k=this.states[j]);var l=this.matchMappings[j],m=this.regExps[j];m.lastIndex=0;for(var n,q=[],p=0,s={type:null,value:""};n=m.exec(b);){var r=l.defaultToken,
o=null,t=n[0],u=m.lastIndex;if(u-t.length>p){var w=b.substring(p,u-t.length);s.type==r?s.value+=w:(s.type&&q.push(s),s={type:r,value:w})}for(w=0;w<n.length-2;w++)if(void 0!==n[w+1]){o=k[l[w]];o.onMatch?r=o.onMatch(t,j,e):r=o.token;o.next&&("string"==typeof o.next?j=o.next:j=o.next(j,e),k=this.states[j],k||(window.console&&console.error&&console.error(j,"doesn't exist"),j="start",k=this.states[j]),l=this.matchMappings[j],p=u,m=this.regExps[j],m.lastIndex=u);break}if(t)if("string"==typeof r)o&&!1===
o.merge||s.type!==r?(s.type&&q.push(s),s={type:r,value:t}):s.value+=t;else if(r){s.type&&q.push(s);s={type:null,value:""};for(w=0;w<r.length;w++)q.push(r[w])}if(p==b.length)break;p=u;if(q.length>d){for(;p<b.length;)s.type&&q.push(s),s={value:b.substring(p,p+=2E3),type:"overflow"};j="start";e=[];break}}return s.type&&q.push(s),1<e.length&&e[0]!==j&&e.unshift(j),{tokens:q,state:e.length?e:j}}}).call(e.prototype);c.Tokenizer=e});
ace.define("ace/mode/text_highlight_rules",["require","exports","module","ace/lib/lang"],function(b,c){var d=b("../lib/lang"),e=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(b,c){if(c)for(g in b){for(var d=b[g],e=0;e<d.length;e++){var f=d[e];f.next&&("string"!=typeof f.next?f.nextState&&0!==f.nextState.indexOf(c)&&(f.nextState=c+f.nextState):0!==f.next.indexOf(c)&&(f.next=c+f.next))}this.$rules[c+g]=d}else for(var g in b)this.$rules[g]=
b[g]};this.getRules=function(){return this.$rules};this.embedRules=function(b,c,e,f,g){b=(new b).getRules();if(f)for(var n=0;n<f.length;n++)f[n]=c+f[n];else for(n in f=[],b)f.push(c+n);this.addRules(b,c);if(e){g=Array.prototype[g?"push":"unshift"];for(n=0;n<f.length;n++)g.apply(this.$rules[f[n]],d.deepCopy(e))}this.$embeds||(this.$embeds=[]);this.$embeds.push(c)};this.getEmbeds=function(){return this.$embeds};var b=function(b,c){return"start"!=b&&c.unshift(this.nextState,b),this.nextState},c=function(b,
c){return c[0]!==b?"start":(c.shift(),c.shift())};this.normalizeRules=function(){function d(l){l=k[l];l.processed=!0;for(var m=0;m<l.length;m++){var n=l[m];!n.regex&&n.start&&(n.regex=n.start,n.next||(n.next=[]),n.next.push({defaultToken:n.token},{token:n.token+".end",regex:n.end||n.start,next:"pop"}),n.token+=".start",n.push=!0);var q=n.next||n.push;if(q&&Array.isArray(q)){var p=n.stateName;p||(p=n.token,"string"!=typeof p&&(p=p[0]||""),k[p]&&(p+=e++));k[p]=q;n.next=p;d(p)}else"pop"==q&&(n.next=
c);n.push&&(n.nextState=n.next||n.push,n.next=b,delete n.push);if(n.rules)for(var s in n.rules)k[s]?k[s].push&&k[s].push.apply(k[s],n.rules[s]):k[s]=n.rules[s];if(n.include||"string"==typeof n)var r=k[n.include||n];else Array.isArray(n)&&(r=n);r&&(r=[m,1].concat(r),n.noEscape&&(r=r.filter(function(b){return!b.next})),l.splice.apply(l,r),m--,r=null);n.keywordMap&&(n.token=this.createKeywordMapper(n.keywordMap,n.defaultToken||"text",n.caseInsensitive),delete n.defaultToken)}}var e=0,k=this.$rules;Object.keys(k).forEach(d,
this)};this.createKeywordMapper=function(b,c,d,e){var f=Object.create(null);return Object.keys(b).forEach(function(c){var g=b[c];d&&(g=g.toLowerCase());for(var g=g.split(e||"|"),j=g.length;j--;)f[g[j]]=c}),Object.getPrototypeOf(f)&&(f.__proto__=null),this.$keywordList=Object.keys(f),b=null,d?function(b){return f[b.toLowerCase()]||c}:function(b){return f[b]||c}};this.getKeywords=function(){return this.$keywords}}).call(e.prototype);c.TextHighlightRules=e});
ace.define("ace/mode/behaviour",["require","exports","module"],function(b,c){var d=function(){this.$behaviours={}};(function(){this.add=function(b,c,d){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[b]:this.$behaviours[b]={}}this.$behaviours[b][c]=d};this.addBehaviours=function(b){for(var c in b)for(var d in b[c])this.add(c,d,b[c][d])};this.remove=function(b){this.$behaviours&&this.$behaviours[b]&&delete this.$behaviours[b]};this.inherit=function(b,c){this.addBehaviours("function"==
typeof b?(new b).getBehaviours(c):b.getBehaviours(c))};this.getBehaviours=function(b){if(!b)return this.$behaviours;for(var c={},d=0;d<b.length;d++)this.$behaviours[b[d]]&&(c[b[d]]=this.$behaviours[b[d]]);return c}}).call(d.prototype);c.Behaviour=d});
ace.define("ace/unicode",["require","exports","module"],function(b,c){c.packages={};var d={L:"0041-005A0061-007A00AA00B500BA00C0-00D600D8-00F600F8-02C102C6-02D102E0-02E402EC02EE0370-037403760377037A-037D03860388-038A038C038E-03A103A3-03F503F7-0481048A-05250531-055605590561-058705D0-05EA05F0-05F20621-064A066E066F0671-06D306D506E506E606EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA07F407F507FA0800-0815081A082408280904-0939093D09500958-0961097109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E460E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EC60EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10A0-10C510D0-10FA10FC1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317D717DC1820-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541AA71B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C7D1CE9-1CEC1CEE-1CF11D00-1DBF1E00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FBC1FBE1FC2-1FC41FC6-1FCC1FD0-1FD31FD6-1FDB1FE0-1FEC1FF2-1FF41FF6-1FFC2071207F2090-209421022107210A-211321152119-211D212421262128212A-212D212F-2139213C-213F2145-2149214E218321842C00-2C2E2C30-2C5E2C60-2CE42CEB-2CEE2D00-2D252D30-2D652D6F2D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2E2F300530063031-3035303B303C3041-3096309D-309F30A1-30FA30FC-30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A48CA4D0-A4FDA500-A60CA610-A61FA62AA62BA640-A65FA662-A66EA67F-A697A6A0-A6E5A717-A71FA722-A788A78BA78CA7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2A9CFAA00-AA28AA40-AA42AA44-AA4BAA60-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADB-AADDABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF21-FF3AFF41-FF5AFF66-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",Ll:"0061-007A00AA00B500BA00DF-00F600F8-00FF01010103010501070109010B010D010F01110113011501170119011B011D011F01210123012501270129012B012D012F01310133013501370138013A013C013E014001420144014601480149014B014D014F01510153015501570159015B015D015F01610163016501670169016B016D016F0171017301750177017A017C017E-0180018301850188018C018D019201950199-019B019E01A101A301A501A801AA01AB01AD01B001B401B601B901BA01BD-01BF01C601C901CC01CE01D001D201D401D601D801DA01DC01DD01DF01E101E301E501E701E901EB01ED01EF01F001F301F501F901FB01FD01FF02010203020502070209020B020D020F02110213021502170219021B021D021F02210223022502270229022B022D022F02310233-0239023C023F0240024202470249024B024D024F-02930295-02AF037103730377037B-037D039003AC-03CE03D003D103D5-03D703D903DB03DD03DF03E103E303E503E703E903EB03ED03EF-03F303F503F803FB03FC0430-045F04610463046504670469046B046D046F04710473047504770479047B047D047F0481048B048D048F04910493049504970499049B049D049F04A104A304A504A704A904AB04AD04AF04B104B304B504B704B904BB04BD04BF04C204C404C604C804CA04CC04CE04CF04D104D304D504D704D904DB04DD04DF04E104E304E504E704E904EB04ED04EF04F104F304F504F704F904FB04FD04FF05010503050505070509050B050D050F05110513051505170519051B051D051F0521052305250561-05871D00-1D2B1D62-1D771D79-1D9A1E011E031E051E071E091E0B1E0D1E0F1E111E131E151E171E191E1B1E1D1E1F1E211E231E251E271E291E2B1E2D1E2F1E311E331E351E371E391E3B1E3D1E3F1E411E431E451E471E491E4B1E4D1E4F1E511E531E551E571E591E5B1E5D1E5F1E611E631E651E671E691E6B1E6D1E6F1E711E731E751E771E791E7B1E7D1E7F1E811E831E851E871E891E8B1E8D1E8F1E911E931E95-1E9D1E9F1EA11EA31EA51EA71EA91EAB1EAD1EAF1EB11EB31EB51EB71EB91EBB1EBD1EBF1EC11EC31EC51EC71EC91ECB1ECD1ECF1ED11ED31ED51ED71ED91EDB1EDD1EDF1EE11EE31EE51EE71EE91EEB1EED1EEF1EF11EF31EF51EF71EF91EFB1EFD1EFF-1F071F10-1F151F20-1F271F30-1F371F40-1F451F50-1F571F60-1F671F70-1F7D1F80-1F871F90-1F971FA0-1FA71FB0-1FB41FB61FB71FBE1FC2-1FC41FC61FC71FD0-1FD31FD61FD71FE0-1FE71FF2-1FF41FF61FF7210A210E210F2113212F21342139213C213D2146-2149214E21842C30-2C5E2C612C652C662C682C6A2C6C2C712C732C742C76-2C7C2C812C832C852C872C892C8B2C8D2C8F2C912C932C952C972C992C9B2C9D2C9F2CA12CA32CA52CA72CA92CAB2CAD2CAF2CB12CB32CB52CB72CB92CBB2CBD2CBF2CC12CC32CC52CC72CC92CCB2CCD2CCF2CD12CD32CD52CD72CD92CDB2CDD2CDF2CE12CE32CE42CEC2CEE2D00-2D25A641A643A645A647A649A64BA64DA64FA651A653A655A657A659A65BA65DA65FA663A665A667A669A66BA66DA681A683A685A687A689A68BA68DA68FA691A693A695A697A723A725A727A729A72BA72DA72F-A731A733A735A737A739A73BA73DA73FA741A743A745A747A749A74BA74DA74FA751A753A755A757A759A75BA75DA75FA761A763A765A767A769A76BA76DA76FA771-A778A77AA77CA77FA781A783A785A787A78CFB00-FB06FB13-FB17FF41-FF5A",
Lu:"0041-005A00C0-00D600D8-00DE01000102010401060108010A010C010E01100112011401160118011A011C011E01200122012401260128012A012C012E01300132013401360139013B013D013F0141014301450147014A014C014E01500152015401560158015A015C015E01600162016401660168016A016C016E017001720174017601780179017B017D018101820184018601870189-018B018E-0191019301940196-0198019C019D019F01A001A201A401A601A701A901AC01AE01AF01B1-01B301B501B701B801BC01C401C701CA01CD01CF01D101D301D501D701D901DB01DE01E001E201E401E601E801EA01EC01EE01F101F401F6-01F801FA01FC01FE02000202020402060208020A020C020E02100212021402160218021A021C021E02200222022402260228022A022C022E02300232023A023B023D023E02410243-02460248024A024C024E03700372037603860388-038A038C038E038F0391-03A103A3-03AB03CF03D2-03D403D803DA03DC03DE03E003E203E403E603E803EA03EC03EE03F403F703F903FA03FD-042F04600462046404660468046A046C046E04700472047404760478047A047C047E0480048A048C048E04900492049404960498049A049C049E04A004A204A404A604A804AA04AC04AE04B004B204B404B604B804BA04BC04BE04C004C104C304C504C704C904CB04CD04D004D204D404D604D804DA04DC04DE04E004E204E404E604E804EA04EC04EE04F004F204F404F604F804FA04FC04FE05000502050405060508050A050C050E05100512051405160518051A051C051E0520052205240531-055610A0-10C51E001E021E041E061E081E0A1E0C1E0E1E101E121E141E161E181E1A1E1C1E1E1E201E221E241E261E281E2A1E2C1E2E1E301E321E341E361E381E3A1E3C1E3E1E401E421E441E461E481E4A1E4C1E4E1E501E521E541E561E581E5A1E5C1E5E1E601E621E641E661E681E6A1E6C1E6E1E701E721E741E761E781E7A1E7C1E7E1E801E821E841E861E881E8A1E8C1E8E1E901E921E941E9E1EA01EA21EA41EA61EA81EAA1EAC1EAE1EB01EB21EB41EB61EB81EBA1EBC1EBE1EC01EC21EC41EC61EC81ECA1ECC1ECE1ED01ED21ED41ED61ED81EDA1EDC1EDE1EE01EE21EE41EE61EE81EEA1EEC1EEE1EF01EF21EF41EF61EF81EFA1EFC1EFE1F08-1F0F1F18-1F1D1F28-1F2F1F38-1F3F1F48-1F4D1F591F5B1F5D1F5F1F68-1F6F1FB8-1FBB1FC8-1FCB1FD8-1FDB1FE8-1FEC1FF8-1FFB21022107210B-210D2110-211221152119-211D212421262128212A-212D2130-2133213E213F214521832C00-2C2E2C602C62-2C642C672C692C6B2C6D-2C702C722C752C7E-2C802C822C842C862C882C8A2C8C2C8E2C902C922C942C962C982C9A2C9C2C9E2CA02CA22CA42CA62CA82CAA2CAC2CAE2CB02CB22CB42CB62CB82CBA2CBC2CBE2CC02CC22CC42CC62CC82CCA2CCC2CCE2CD02CD22CD42CD62CD82CDA2CDC2CDE2CE02CE22CEB2CEDA640A642A644A646A648A64AA64CA64EA650A652A654A656A658A65AA65CA65EA662A664A666A668A66AA66CA680A682A684A686A688A68AA68CA68EA690A692A694A696A722A724A726A728A72AA72CA72EA732A734A736A738A73AA73CA73EA740A742A744A746A748A74AA74CA74EA750A752A754A756A758A75AA75CA75EA760A762A764A766A768A76AA76CA76EA779A77BA77DA77EA780A782A784A786A78BFF21-FF3A",
Lt:"01C501C801CB01F21F88-1F8F1F98-1F9F1FA8-1FAF1FBC1FCC1FFC",Lm:"02B0-02C102C6-02D102E0-02E402EC02EE0374037A0559064006E506E607F407F507FA081A0824082809710E460EC610FC17D718431AA71C78-1C7D1D2C-1D611D781D9B-1DBF2071207F2090-20942C7D2D6F2E2F30053031-3035303B309D309E30FC-30FEA015A4F8-A4FDA60CA67FA717-A71FA770A788A9CFAA70AADDFF70FF9EFF9F",Lo:"01BB01C0-01C3029405D0-05EA05F0-05F20621-063F0641-064A066E066F0671-06D306D506EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA0800-08150904-0939093D09500958-096109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E450E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10D0-10FA1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317DC1820-18421844-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C771CE9-1CEC1CEE-1CF12135-21382D30-2D652D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE3006303C3041-3096309F30A1-30FA30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A014A016-A48CA4D0-A4F7A500-A60BA610-A61FA62AA62BA66EA6A0-A6E5A7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2AA00-AA28AA40-AA42AA44-AA4BAA60-AA6FAA71-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADBAADCABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF66-FF6FFF71-FF9DFFA0-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",
M:"0300-036F0483-04890591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DE-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0903093C093E-094E0951-0955096209630981-098309BC09BE-09C409C709C809CB-09CD09D709E209E30A01-0A030A3C0A3E-0A420A470A480A4B-0A4D0A510A700A710A750A81-0A830ABC0ABE-0AC50AC7-0AC90ACB-0ACD0AE20AE30B01-0B030B3C0B3E-0B440B470B480B4B-0B4D0B560B570B620B630B820BBE-0BC20BC6-0BC80BCA-0BCD0BD70C01-0C030C3E-0C440C46-0C480C4A-0C4D0C550C560C620C630C820C830CBC0CBE-0CC40CC6-0CC80CCA-0CCD0CD50CD60CE20CE30D020D030D3E-0D440D46-0D480D4A-0D4D0D570D620D630D820D830DCA0DCF-0DD40DD60DD8-0DDF0DF20DF30E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F3E0F3F0F71-0F840F860F870F90-0F970F99-0FBC0FC6102B-103E1056-1059105E-10601062-10641067-106D1071-10741082-108D108F109A-109D135F1712-17141732-1734175217531772177317B6-17D317DD180B-180D18A91920-192B1930-193B19B0-19C019C819C91A17-1A1B1A55-1A5E1A60-1A7C1A7F1B00-1B041B34-1B441B6B-1B731B80-1B821BA1-1BAA1C24-1C371CD0-1CD21CD4-1CE81CED1CF21DC0-1DE61DFD-1DFF20D0-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66F-A672A67CA67DA6F0A6F1A802A806A80BA823-A827A880A881A8B4-A8C4A8E0-A8F1A926-A92DA947-A953A980-A983A9B3-A9C0AA29-AA36AA43AA4CAA4DAA7BAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE3-ABEAABECABEDFB1EFE00-FE0FFE20-FE26",
Mn:"0300-036F0483-04870591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0902093C0941-0948094D0951-095509620963098109BC09C1-09C409CD09E209E30A010A020A3C0A410A420A470A480A4B-0A4D0A510A700A710A750A810A820ABC0AC1-0AC50AC70AC80ACD0AE20AE30B010B3C0B3F0B41-0B440B4D0B560B620B630B820BC00BCD0C3E-0C400C46-0C480C4A-0C4D0C550C560C620C630CBC0CBF0CC60CCC0CCD0CE20CE30D41-0D440D4D0D620D630DCA0DD2-0DD40DD60E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F71-0F7E0F80-0F840F860F870F90-0F970F99-0FBC0FC6102D-10301032-10371039103A103D103E10581059105E-10601071-1074108210851086108D109D135F1712-17141732-1734175217531772177317B7-17BD17C617C9-17D317DD180B-180D18A91920-19221927192819321939-193B1A171A181A561A58-1A5E1A601A621A65-1A6C1A73-1A7C1A7F1B00-1B031B341B36-1B3A1B3C1B421B6B-1B731B801B811BA2-1BA51BA81BA91C2C-1C331C361C371CD0-1CD21CD4-1CE01CE2-1CE81CED1DC0-1DE61DFD-1DFF20D0-20DC20E120E5-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66FA67CA67DA6F0A6F1A802A806A80BA825A826A8C4A8E0-A8F1A926-A92DA947-A951A980-A982A9B3A9B6-A9B9A9BCAA29-AA2EAA31AA32AA35AA36AA43AA4CAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE5ABE8ABEDFB1EFE00-FE0FFE20-FE26",
Mc:"0903093E-09400949-094C094E0982098309BE-09C009C709C809CB09CC09D70A030A3E-0A400A830ABE-0AC00AC90ACB0ACC0B020B030B3E0B400B470B480B4B0B4C0B570BBE0BBF0BC10BC20BC6-0BC80BCA-0BCC0BD70C01-0C030C41-0C440C820C830CBE0CC0-0CC40CC70CC80CCA0CCB0CD50CD60D020D030D3E-0D400D46-0D480D4A-0D4C0D570D820D830DCF-0DD10DD8-0DDF0DF20DF30F3E0F3F0F7F102B102C10311038103B103C105610571062-10641067-106D108310841087-108C108F109A-109C17B617BE-17C517C717C81923-19261929-192B193019311933-193819B0-19C019C819C91A19-1A1B1A551A571A611A631A641A6D-1A721B041B351B3B1B3D-1B411B431B441B821BA11BA61BA71BAA1C24-1C2B1C341C351CE11CF2A823A824A827A880A881A8B4-A8C3A952A953A983A9B4A9B5A9BAA9BBA9BD-A9C0AA2FAA30AA33AA34AA4DAA7BABE3ABE4ABE6ABE7ABE9ABEAABEC",
Me:"0488048906DE20DD-20E020E2-20E4A670-A672",N:"0030-003900B200B300B900BC-00BE0660-066906F0-06F907C0-07C90966-096F09E6-09EF09F4-09F90A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BF20C66-0C6F0C78-0C7E0CE6-0CEF0D66-0D750E50-0E590ED0-0ED90F20-0F331040-10491090-10991369-137C16EE-16F017E0-17E917F0-17F91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C5920702074-20792080-20892150-21822185-21892460-249B24EA-24FF2776-27932CFD30073021-30293038-303A3192-31953220-32293251-325F3280-328932B1-32BFA620-A629A6E6-A6EFA830-A835A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",
Nd:"0030-00390660-066906F0-06F907C0-07C90966-096F09E6-09EF0A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BEF0C66-0C6F0CE6-0CEF0D66-0D6F0E50-0E590ED0-0ED90F20-0F291040-10491090-109917E0-17E91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C59A620-A629A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nl:"16EE-16F02160-21822185-218830073021-30293038-303AA6E6-A6EF",No:"00B200B300B900BC-00BE09F4-09F90BF0-0BF20C78-0C7E0D70-0D750F2A-0F331369-137C17F0-17F920702074-20792080-20892150-215F21892460-249B24EA-24FF2776-27932CFD3192-31953220-32293251-325F3280-328932B1-32BFA830-A835",
P:"0021-00230025-002A002C-002F003A003B003F0040005B-005D005F007B007D00A100AB00B700BB00BF037E0387055A-055F0589058A05BE05C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F3A-0F3D0F850FD0-0FD4104A-104F10FB1361-13681400166D166E169B169C16EB-16ED1735173617D4-17D617D8-17DA1800-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD32010-20272030-20432045-20512053-205E207D207E208D208E2329232A2768-277527C527C627E6-27EF2983-299829D8-29DB29FC29FD2CF9-2CFC2CFE2CFF2E00-2E2E2E302E313001-30033008-30113014-301F3030303D30A030FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFD3EFD3FFE10-FE19FE30-FE52FE54-FE61FE63FE68FE6AFE6BFF01-FF03FF05-FF0AFF0C-FF0FFF1AFF1BFF1FFF20FF3B-FF3DFF3FFF5BFF5DFF5F-FF65",
Pd:"002D058A05BE140018062010-20152E172E1A301C303030A0FE31FE32FE58FE63FF0D",Ps:"0028005B007B0F3A0F3C169B201A201E2045207D208D23292768276A276C276E27702772277427C527E627E827EA27EC27EE2983298529872989298B298D298F299129932995299729D829DA29FC2E222E242E262E283008300A300C300E3010301430163018301A301DFD3EFE17FE35FE37FE39FE3BFE3DFE3FFE41FE43FE47FE59FE5BFE5DFF08FF3BFF5BFF5FFF62",Pe:"0029005D007D0F3B0F3D169C2046207E208E232A2769276B276D276F27712773277527C627E727E927EB27ED27EF298429862988298A298C298E2990299229942996299829D929DB29FD2E232E252E272E293009300B300D300F3011301530173019301B301E301FFD3FFE18FE36FE38FE3AFE3CFE3EFE40FE42FE44FE48FE5AFE5CFE5EFF09FF3DFF5DFF60FF63",
Pi:"00AB2018201B201C201F20392E022E042E092E0C2E1C2E20",Pf:"00BB2019201D203A2E032E052E0A2E0D2E1D2E21",Pc:"005F203F20402054FE33FE34FE4D-FE4FFF3F",Po:"0021-00230025-0027002A002C002E002F003A003B003F0040005C00A100B700BF037E0387055A-055F058905C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F850FD0-0FD4104A-104F10FB1361-1368166D166E16EB-16ED1735173617D4-17D617D8-17DA1800-18051807-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD3201620172020-20272030-2038203B-203E2041-20432047-205120532055-205E2CF9-2CFC2CFE2CFF2E002E012E06-2E082E0B2E0E-2E162E182E192E1B2E1E2E1F2E2A-2E2E2E302E313001-3003303D30FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFE10-FE16FE19FE30FE45FE46FE49-FE4CFE50-FE52FE54-FE57FE5F-FE61FE68FE6AFE6BFF01-FF03FF05-FF07FF0AFF0CFF0EFF0FFF1AFF1BFF1FFF20FF3CFF61FF64FF65",
S:"0024002B003C-003E005E0060007C007E00A2-00A900AC00AE-00B100B400B600B800D700F702C2-02C502D2-02DF02E5-02EB02ED02EF-02FF03750384038503F604820606-0608060B060E060F06E906FD06FE07F609F209F309FA09FB0AF10B700BF3-0BFA0C7F0CF10CF20D790E3F0F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-139917DB194019E0-19FF1B61-1B6A1B74-1B7C1FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE20442052207A-207C208A-208C20A0-20B8210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B2140-2144214A-214D214F2190-2328232B-23E82400-24262440-244A249C-24E92500-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE27C0-27C427C7-27CA27CC27D0-27E527F0-29822999-29D729DC-29FB29FE-2B4C2B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F309B309C319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A700-A716A720A721A789A78AA828-A82BA836-A839AA77-AA79FB29FDFCFDFDFE62FE64-FE66FE69FF04FF0BFF1C-FF1EFF3EFF40FF5CFF5EFFE0-FFE6FFE8-FFEEFFFCFFFD",
Sm:"002B003C-003E007C007E00AC00B100D700F703F60606-060820442052207A-207C208A-208C2140-2144214B2190-2194219A219B21A021A321A621AE21CE21CF21D221D421F4-22FF2308-230B23202321237C239B-23B323DC-23E125B725C125F8-25FF266F27C0-27C427C7-27CA27CC27D0-27E527F0-27FF2900-29822999-29D729DC-29FB29FE-2AFF2B30-2B442B47-2B4CFB29FE62FE64-FE66FF0BFF1C-FF1EFF5CFF5EFFE2FFE9-FFEC",Sc:"002400A2-00A5060B09F209F309FB0AF10BF90E3F17DB20A0-20B8A838FDFCFE69FF04FFE0FFE1FFE5FFE6",Sk:"005E006000A800AF00B400B802C2-02C502D2-02DF02E5-02EB02ED02EF-02FF0375038403851FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE309B309CA700-A716A720A721A789A78AFF3EFF40FFE3",
So:"00A600A700A900AE00B000B60482060E060F06E906FD06FE07F609FA0B700BF3-0BF80BFA0C7F0CF10CF20D790F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-1399194019E0-19FF1B61-1B6A1B74-1B7C210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B214A214C214D214F2195-2199219C-219F21A121A221A421A521A7-21AD21AF-21CD21D021D121D321D5-21F32300-2307230C-231F2322-2328232B-237B237D-239A23B4-23DB23E2-23E82400-24262440-244A249C-24E92500-25B625B8-25C025C2-25F72600-266E2670-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE2800-28FF2B00-2B2F2B452B462B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A828-A82BA836A837A839AA77-AA79FDFDFFE4FFE8FFEDFFEEFFFCFFFD",
Z:"002000A01680180E2000-200A20282029202F205F3000",Zs:"002000A01680180E2000-200A202F205F3000",Zl:"2028",Zp:"2029",C:"0000-001F007F-009F00AD03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-0605061C061D0620065F06DD070E070F074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17B417B517DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF200B-200F202A-202E2060-206F20722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-F8FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFD-FF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFFBFFFEFFFF",
Cc:"0000-001F007F-009F",Cf:"00AD0600-060306DD070F17B417B5200B-200F202A-202E2060-2064206A-206FFEFFFFF9-FFFB",Co:"E000-F8FF",Cs:"D800-DFFF",Cn:"03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-05FF06040605061C061D0620065F070E074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF2065-206920722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-D7FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFDFEFEFF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFF8FFFEFFFF"},
e=/\w{4}/g,f;for(f in d)c.packages[f]=d[f].replace(e,"\\u$&")});
ace.define("ace/token_iterator",["require","exports","module"],function(b,c){var d=function(b,c,d){this.$session=b;this.$row=c;this.$rowTokens=b.getTokens(c);this.$tokenIndex=(b=b.getTokenAt(c,d))?b.index:-1};(function(){this.stepBackward=function(){for(this.$tokenIndex-=1;0>this.$tokenIndex;){this.$row-=1;if(0>this.$row)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row);this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]};this.stepForward=function(){this.$tokenIndex+=
1;for(var b;this.$tokenIndex>=this.$rowTokens.length;){this.$row+=1;b||(b=this.$session.getLength());if(this.$row>=b)return this.$row=b-1,null;this.$rowTokens=this.$session.getTokens(this.$row);this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]};this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]};this.getCurrentTokenRow=function(){return this.$row};this.getCurrentTokenColumn=function(){var b=this.$rowTokens,c=this.$tokenIndex,d=b[c].start;if(void 0!==d)return d;for(d=
0;0<c;)c-=1,d+=b[c].value.length;return d}}).call(d.prototype);c.TokenIterator=d});
ace.define("ace/document","require exports module ace/lib/oop ace/lib/event_emitter ace/range ace/anchor".split(" "),function(b,c){var d=b("./lib/oop"),e=b("./lib/event_emitter").EventEmitter,f=b("./range").Range,g=b("./anchor").Anchor,h=function(b){this.$lines=[];b.length==0?this.$lines=[""]:Array.isArray(b)?this._insertLines(0,b):this.insert({row:0,column:0},b)};(function(){d.implement(this,e);this.setValue=function(b){var c=this.getLength();this.remove(new f(0,0,c,this.getLine(c-1).length));this.insert({row:0,
column:0},b)};this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())};this.createAnchor=function(b,c){return new g(this,b,c)};"aaa".split(/a/).length==0?this.$split=function(b){return b.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(b){return b.split(/\r\n|\r|\n/)};this.$detectNewLine=function(b){this.$autoNewLine=(b=b.match(/^.*?(\r\n|\r|\n)/m))?b[1]:"\n"};this.getNewLineCharacter=function(){switch(this.$newLineMode){case "windows":return"\r\n";case "unix":return"\n";
default:return this.$autoNewLine}};this.$autoNewLine="\n";this.$newLineMode="auto";this.setNewLineMode=function(b){if(this.$newLineMode!==b)this.$newLineMode=b};this.getNewLineMode=function(){return this.$newLineMode};this.isNewLine=function(b){return b=="\r\n"||b=="\r"||b=="\n"};this.getLine=function(b){return this.$lines[b]||""};this.getLines=function(b,c){return this.$lines.slice(b,c+1)};this.getAllLines=function(){return this.getLines(0,this.getLength())};this.getLength=function(){return this.$lines.length};
this.getTextRange=function(b){if(b.start.row==b.end.row)return this.getLine(b.start.row).substring(b.start.column,b.end.column);var c=this.getLines(b.start.row,b.end.row);c[0]=(c[0]||"").substring(b.start.column);var d=c.length-1;return b.end.row-b.start.row==d&&(c[d]=c[d].substring(0,b.end.column)),c.join(this.getNewLineCharacter())};this.$clipPosition=function(b){var c=this.getLength();return b.row>=c?(b.row=Math.max(0,c-1),b.column=this.getLine(c-1).length):b.row<0&&(b.row=0),b};this.insert=function(b,
c){if(!c||c.length===0)return b;b=this.$clipPosition(b);this.getLength()<=1&&this.$detectNewLine(c);var d=this.$split(c),e=d.splice(0,1)[0],f=d.length==0?null:d.splice(d.length-1,1)[0];return b=this.insertInLine(b,e),f!==null&&(b=this.insertNewLine(b),b=this._insertLines(b.row,d),b=this.insertInLine(b,f||"")),b};this.insertLines=function(b,c){return b>=this.getLength()?this.insert({row:b,column:0},"\n"+c.join("\n")):this._insertLines(Math.max(b,0),c)};this._insertLines=function(b,c){if(c.length==
0)return{row:b,column:0};if(c.length>65535)var d=this._insertLines(b,c.slice(65535)),c=c.slice(0,65535);var e=[b,0];e.push.apply(e,c);this.$lines.splice.apply(this.$lines,e);e=new f(b,0,b+c.length,0);return this._emit("change",{data:{action:"insertLines",range:e,lines:c}}),d||e.end};this.insertNewLine=function(b){var b=this.$clipPosition(b),c=this.$lines[b.row]||"";this.$lines[b.row]=c.substring(0,b.column);this.$lines.splice(b.row+1,0,c.substring(b.column,c.length));c={row:b.row+1,column:0};return this._emit("change",
{data:{action:"insertText",range:f.fromPoints(b,c),text:this.getNewLineCharacter()}}),c};this.insertInLine=function(b,c){if(c.length==0)return b;var d=this.$lines[b.row]||"";this.$lines[b.row]=d.substring(0,b.column)+c+d.substring(b.column);d={row:b.row,column:b.column+c.length};return this._emit("change",{data:{action:"insertText",range:f.fromPoints(b,d),text:c}}),d};this.remove=function(b){!b instanceof f&&(b=f.fromPoints(b.start,b.end));b.start=this.$clipPosition(b.start);b.end=this.$clipPosition(b.end);
if(b.isEmpty())return b.start;var c=b.start.row,d=b.end.row;if(b.isMultiLine()){var e=b.start.column==0?c:c+1,g=d-1;b.end.column>0&&this.removeInLine(d,0,b.end.column);g>=e&&this._removeLines(e,g);e!=c&&(this.removeInLine(c,b.start.column,this.getLine(c).length),this.removeNewLine(b.start.row))}else this.removeInLine(c,b.start.column,b.end.column);return b.start};this.removeInLine=function(b,c,d){if(c!=d){var e=new f(b,c,b,d),g=this.getLine(b),h=g.substring(c,d),c=g.substring(0,c)+g.substring(d,g.length);
this.$lines.splice(b,1,c);return this._emit("change",{data:{action:"removeText",range:e,text:h}}),e.start}};this.removeLines=function(b,c){return b<0||c>=this.getLength()?this.remove(new f(b,0,c+1,0)):this._removeLines(b,c)};this._removeLines=function(b,c){var d=new f(b,0,c+1,0),e=this.$lines.splice(b,c-b+1);return this._emit("change",{data:{action:"removeLines",range:d,nl:this.getNewLineCharacter(),lines:e}}),e};this.removeNewLine=function(b){var c=this.getLine(b),d=this.getLine(b+1),e=new f(b,c.length,
b+1,0);this.$lines.splice(b,2,c+d);this._emit("change",{data:{action:"removeText",range:e,text:this.getNewLineCharacter()}})};this.replace=function(b,c){!b instanceof f&&(b=f.fromPoints(b.start,b.end));if(c.length==0&&b.isEmpty())return b.start;if(c==this.getTextRange(b))return b.end;this.remove(b);return c?this.insert(b.start,c):b.start};this.applyDeltas=function(b){for(var c=0;c<b.length;c++){var d=b[c],e=f.fromPoints(d.range.start,d.range.end);d.action=="insertLines"?this.insertLines(e.start.row,
d.lines):d.action=="insertText"?this.insert(e.start,d.text):d.action=="removeLines"?this._removeLines(e.start.row,e.end.row-1):d.action=="removeText"&&this.remove(e)}};this.revertDeltas=function(b){for(var c=b.length-1;c>=0;c--){var d=b[c],e=f.fromPoints(d.range.start,d.range.end);d.action=="insertLines"?this._removeLines(e.start.row,e.end.row-1):d.action=="insertText"?this.remove(e):d.action=="removeLines"?this._insertLines(e.start.row,d.lines):d.action=="removeText"&&this.insert(e.start,d.text)}};
this.indexToPosition=function(b,c){for(var d=this.$lines||this.getAllLines(),e=this.getNewLineCharacter().length,f=c||0,g=d.length;f<g;f++){b=b-(d[f].length+e);if(b<0)return{row:f,column:b+d[f].length+e}}return{row:g-1,column:d[g-1].length}};this.positionToIndex=function(b,c){for(var d=this.$lines||this.getAllLines(),e=this.getNewLineCharacter().length,f=0,g=Math.min(b.row,d.length),h=c||0;h<g;++h)f=f+(d[h].length+e);return f+b.column}}).call(h.prototype);c.Document=h});
ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(b,c){var d=b("./lib/oop"),e=b("./lib/event_emitter").EventEmitter;(function(){d.implement(this,e);this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)};this.getDocument=function(){return this.document};this.$insertRight=!1;this.onChange=function(b){var b=b.data,c=b.range;if(!(c.start.row==c.end.row&&c.start.row!=this.row)&&!(c.start.row>this.row)&&!(c.start.row==this.row&&
c.start.column>this.column)){var d=this.row,e=this.column,k=c.start,c=c.end;if("insertText"===b.action)if(k.row===d&&k.column<=e){if(k.column!==e||!this.$insertRight)k.row===c.row?e+=c.column-k.column:(e-=k.column,d+=c.row-k.row)}else k.row!==c.row&&k.row<d&&(d+=c.row-k.row);else"insertLines"===b.action?k.row<=d&&(d+=c.row-k.row):"removeText"===b.action?k.row===d&&k.column<e?c.column>=e?e=k.column:e=Math.max(0,e-(c.column-k.column)):k.row!==c.row&&k.row<d?(c.row===d&&(e=Math.max(0,e-c.column)+k.column),
d-=c.row-k.row):c.row===d&&(d-=c.row-k.row,e=Math.max(0,e-c.column)+k.column):"removeLines"==b.action&&k.row<=d&&(c.row<=d?d-=c.row-k.row:(d=k.row,e=0));this.setPosition(d,e,!0)}};this.setPosition=function(b,c,d){var e;d?e={row:b,column:c}:e=this.$clipPositionToDocument(b,c);this.row==e.row&&this.column==e.column||(b={row:this.row,column:this.column},this.row=e.row,this.column=e.column,this._emit("change",{old:b,value:e}))};this.detach=function(){this.document.removeEventListener("change",this.$onChange)};
this.attach=function(b){this.document=b||this.document;this.document.on("change",this.$onChange)};this.$clipPositionToDocument=function(b,c){var d={};return b>=this.document.getLength()?(d.row=Math.max(0,this.document.getLength()-1),d.column=this.document.getLine(d.row).length):0>b?(d.row=0,d.column=0):(d.row=b,d.column=Math.min(this.document.getLine(d.row).length,Math.max(0,c))),0>c&&(d.column=0),d}}).call((c.Anchor=function(b,c,d){this.$onChange=this.onChange.bind(this);this.attach(b);"undefined"==
typeof d?this.setPosition(c.row,c.column):this.setPosition(c,d)}).prototype)});
ace.define("ace/background_tokenizer",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(b,c){var d=b("./lib/oop"),e=b("./lib/event_emitter").EventEmitter,f=function(b){this.running=!1;this.lines=[];this.states=[];this.currentLine=0;this.tokenizer=b;var c=this;this.$worker=function(){if(c.running){for(var b=new Date,d=c.currentLine,e=-1,f=c.doc;c.lines[d];)d++;var g=d,f=f.getLength(),q=0;for(c.running=!1;d<f;){c.$tokenizeRow(d);e=d;do d++;while(c.lines[d]);q++;if(0==q%5&&
20<new Date-b){c.running=setTimeout(c.$worker,20);c.currentLine=d;return}}c.currentLine=d;g<=e&&c.fireUpdateEvent(g,e)}}};(function(){d.implement(this,e);this.setTokenizer=function(b){this.tokenizer=b;this.lines=[];this.states=[];this.start(0)};this.setDocument=function(b){this.doc=b;this.lines=[];this.states=[];this.stop()};this.fireUpdateEvent=function(b,c){this._emit("update",{data:{first:b,last:c}})};this.start=function(b){this.currentLine=Math.min(b||0,this.currentLine,this.doc.getLength());
this.lines.splice(this.currentLine,this.lines.length);this.states.splice(this.currentLine,this.states.length);this.stop();this.running=setTimeout(this.$worker,700)};this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))};this.$updateOnChange=function(b){var c=b.range,d=c.start.row,c=c.end.row-d;0===c?this.lines[d]=null:"removeText"==b.action||"removeLines"==b.action?(this.lines.splice(d,c+1,null),this.states.splice(d,c+1,null)):(b=Array(c+1),b.unshift(d,1),this.lines.splice.apply(this.lines,
b),this.states.splice.apply(this.states,b));this.currentLine=Math.min(d,this.currentLine,this.doc.getLength());this.stop()};this.stop=function(){this.running&&clearTimeout(this.running);this.running=!1};this.getTokens=function(b){return this.lines[b]||this.$tokenizeRow(b)};this.getState=function(b){return this.currentLine==b&&this.$tokenizeRow(b),this.states[b]||"start"};this.$tokenizeRow=function(b){var c=this.tokenizer.getLineTokens(this.doc.getLine(b),this.states[b-1],b);return this.states[b]+
""!=c.state+""?(this.states[b]=c.state,this.lines[b+1]=null,this.currentLine>b+1&&(this.currentLine=b+1)):this.currentLine==b&&(this.currentLine=b+1),this.lines[b]=c.tokens}}).call(f.prototype);c.BackgroundTokenizer=f});
ace.define("ace/search_highlight","require exports module ace/lib/lang ace/lib/oop ace/range".split(" "),function(b,c){var d=b("./lib/lang");b("./lib/oop");var e=b("./range").Range,f=function(b,c,d){this.setRegexp(b);this.clazz=c;this.type=d||"text"};(function(){this.MAX_RANGES=500;this.setRegexp=function(b){if(this.regExp+""!=b+""){this.regExp=b;this.cache=[]}};this.update=function(b,c,f,k){if(this.regExp)for(var l=k.lastRow,m=k.firstRow;m<=l;m++){var n=this.cache[m];n==null&&(n=d.getMatchOffsets(f.getLine(m),
this.regExp),n.length>this.MAX_RANGES&&(n=n.slice(0,this.MAX_RANGES)),n=n.map(function(b){return new e(m,b.offset,m,b.offset+b.length)}),this.cache[m]=n.length?n:"");for(var q=n.length;q--;)c.drawSingleLineMarker(b,n[q].toScreenRange(f),this.clazz,k)}}}).call(f.prototype);c.SearchHighlight=f});
ace.define("ace/edit_session/folding","require exports module ace/range ace/edit_session/fold_line ace/edit_session/fold ace/token_iterator".split(" "),function(b,c){var d=b("../range").Range,e=b("./fold_line").FoldLine,f=b("./fold").Fold,g=b("../token_iterator").TokenIterator;c.Folding=function(){this.getFoldAt=function(b,c,d){var e=this.getFoldLine(b);if(!e)return null;for(var e=e.folds,f=0;f<e.length;f++){var g=e[f];if(g.range.contains(b,c)&&!(d==1&&g.range.isEnd(b,c))&&!(d==-1&&g.range.isStart(b,
c)))return g}};this.getFoldsInRange=function(b){var c=b.start,d=b.end,e=this.$foldData,f=[];c.column=c.column+1;d.column=d.column-1;for(var g=0;g<e.length;g++){var q=e[g].range.compareRange(b);if(q!=2){if(q==-2)break;for(var p=e[g].folds,s=0;s<p.length;s++){var r=p[s],q=r.range.compareRange(b);if(q==-2)break;if(q!=2){if(q==42)break;f.push(r)}}}}return c.column=c.column-1,d.column=d.column+1,f};this.getFoldsInRangeList=function(b){if(Array.isArray(b)){var c=[];b.forEach(function(b){c=c.concat(this.getFoldsInRange(b))},
this)}else c=this.getFoldsInRange(b);return c};this.getAllFolds=function(){for(var b=[],c=this.$foldData,d=0;d<c.length;d++)for(var e=0;e<c[d].folds.length;e++)b.push(c[d].folds[e]);return b};this.getFoldStringAt=function(b,c,d,e){e=e||this.getFoldLine(b);if(!e)return null;for(var f={end:{column:0}},g,q,p=0;p<e.folds.length;p++){q=e.folds[p];var s=q.range.compareEnd(b,c);if(s==-1){g=this.getLine(q.start.row).substring(f.end.column,q.start.column);break}if(s===0)return null;f=q}return g||(g=this.getLine(q.start.row).substring(f.end.column)),
d==-1?g.substring(0,c-f.end.column):d==1?g.substring(c-f.end.column):g};this.getFoldLine=function(b,c){var d=this.$foldData,e=0;c&&(e=d.indexOf(c));e==-1&&(e=0);for(e;e<d.length;e++){var f=d[e];if(f.start.row<=b&&f.end.row>=b)return f;if(f.end.row>b)break}return null};this.getNextFoldLine=function(b,c){var d=this.$foldData,e=0;c&&(e=d.indexOf(c));e==-1&&(e=0);for(e;e<d.length;e++){var f=d[e];if(f.end.row>=b)return f}return null};this.getFoldedRowCount=function(b,c){for(var d=this.$foldData,e=c-b+
1,f=0;f<d.length;f++){var g=d[f],q=g.end.row,g=g.start.row;if(q>=c){g<c&&(g>=b?e=e-(c-g):e=0);break}q>=b&&(g>=b?e=e-(q-g):e=e-(q-b+1))}return e};this.$addFoldLine=function(b){return this.$foldData.push(b),this.$foldData.sort(function(b,c){return b.start.row-c.start.row}),b};this.addFold=function(b,c){var d=this.$foldData,g=false,m;b instanceof f?m=b:(m=new f(c,b),m.collapseChildren=c.collapseChildren);this.$clipRangeToDocument(m.range);var n=m.start.row,q=m.start.column,p=m.end.row,s=m.end.column;
if(n<p||n==p&&q<=s-2){var r=this.getFoldAt(n,q,1),o=this.getFoldAt(p,s,-1);if(r&&o==r)return r.addSubFold(m);if(r&&!r.range.isStart(n,q)||o&&!o.range.isEnd(p,s))throw Error("A fold can't intersect already existing fold"+m.range+r.range);q=this.getFoldsInRange(m.range);q.length>0&&(this.removeFolds(q),q.forEach(function(b){m.addSubFold(b)}));for(q=0;q<d.length;q++){var t=d[q];if(p==t.start.row){t.addFold(m);g=true;break}if(n==t.end.row){t.addFold(m);g=true;if(!m.sameRow)if((d=d[q+1])&&d.start.row==
p){t.merge(d);break}break}if(p<=t.start.row)break}return g||(t=this.$addFoldLine(new e(this.$foldData,m))),this.$useWrapMode?this.$updateWrapData(t.start.row,t.start.row):this.$updateRowLengthCache(t.start.row,t.start.row),this.$modified=true,this._emit("changeFold",{data:m,action:"add"}),m}throw Error("The range has to be at least 2 characters width");};this.addFolds=function(b){b.forEach(function(b){this.addFold(b)},this)};this.removeFold=function(b){var c=b.foldLine,d=c.start.row,e=c.end.row,f=
this.$foldData,g=c.folds;if(g.length==1)f.splice(f.indexOf(c),1);else if(c.range.isEnd(b.end.row,b.end.column)){g.pop();c.end.row=g[g.length-1].end.row;c.end.column=g[g.length-1].end.column}else if(c.range.isStart(b.start.row,b.start.column)){g.shift();c.start.row=g[0].start.row;c.start.column=g[0].start.column}else if(b.sameRow)g.splice(g.indexOf(b),1);else{c=c.split(b.start.row,b.start.column);g=c.folds;g.shift();c.start.row=g[0].start.row;c.start.column=g[0].start.column}this.$updating||(this.$useWrapMode?
this.$updateWrapData(d,e):this.$updateRowLengthCache(d,e));this.$modified=true;this._emit("changeFold",{data:b,action:"remove"})};this.removeFolds=function(b){for(var c=[],d=0;d<b.length;d++)c.push(b[d]);c.forEach(function(b){this.removeFold(b)},this);this.$modified=true};this.expandFold=function(b){this.removeFold(b);b.subFolds.forEach(function(c){b.restoreRange(c);this.addFold(c)},this);b.collapseChildren>0&&this.foldAll(b.start.row+1,b.end.row,b.collapseChildren-1);b.subFolds=[]};this.expandFolds=
function(b){b.forEach(function(b){this.expandFold(b)},this)};this.unfold=function(b,c){var e,f;b==null?(e=new d(0,0,this.getLength(),0),c=true):typeof b=="number"?e=new d(b,0,b,this.getLine(b).length):"row"in b?e=d.fromPoints(b,b):e=b;f=this.getFoldsInRangeList(e);if(c)this.removeFolds(f);else for(var g=f;g.length;){this.expandFolds(g);g=this.getFoldsInRangeList(e)}if(f.length)return f};this.isRowFolded=function(b,c){return!!this.getFoldLine(b,c)};this.getRowFoldEnd=function(b,c){var d=this.getFoldLine(b,
c);return d?d.end.row:b};this.getRowFoldStart=function(b,c){var d=this.getFoldLine(b,c);return d?d.start.row:b};this.getFoldDisplayLine=function(b,c,d,e,f){e==null&&(e=b.start.row,f=0);c==null&&(c=b.end.row,d=this.getLine(c).length);var g=this.doc,q="";return b.walk(function(b,c,d,h){if(!(c<e)){if(c==e){if(d<f)return;h=Math.max(f,h)}b!=null?q=q+b:q=q+g.getLine(c).substring(h,d)}},c,d),q};this.getDisplayLine=function(b,c,d,e){var f=this.getFoldLine(b);if(!f){var g;return g=this.doc.getLine(b),g.substring(e||
0,c||g.length)}return this.getFoldDisplayLine(f,b,c,d,e)};this.$cloneFoldData=function(){var b=[];return b=this.$foldData.map(function(c){c=c.folds.map(function(b){return b.clone()});return new e(b,c)}),b};this.toggleFold=function(b){var c=this.selection.getRange(),d,e;if(c.isEmpty()){b=c.start;if(d=this.getFoldAt(b.row,b.column)){this.expandFold(d);return}(e=this.findMatchingBracket(b))?c.comparePoint(e)==1?c.end=e:(c.start=e,c.start.column++,c.end.column--):(e=this.findMatchingBracket({row:b.row,
column:b.column+1}))?(c.comparePoint(e)==1?c.end=e:c.start=e,c.start.column++):c=this.getCommentFoldRange(b.row,b.column)||c}else{e=this.getFoldsInRange(c);if(b&&e.length){this.expandFolds(e);return}e.length==1&&(d=e[0])}d||(d=this.getFoldAt(c.start.row,c.start.column));if(d&&d.range.toString()==c.toString())this.expandFold(d);else{d="...";if(!c.isMultiLine()){d=this.getTextRange(c);if(d.length<4)return;d=d.trim().substring(0,2)+".."}this.addFold(d,c)}};this.getCommentFoldRange=function(b,c,e){var f=
new g(this,b,c),m=f.getCurrentToken();if(m&&/^comment|string/.test(m.type)){var n=new d,q=RegExp(m.type.replace(/\..*/,"\\."));if(e!=1){do m=f.stepBackward();while(m&&q.test(m.type));f.stepForward()}n.start.row=f.getCurrentTokenRow();n.start.column=f.getCurrentTokenColumn()+2;f=new g(this,b,c);if(e!=-1){do m=f.stepForward();while(m&&q.test(m.type));m=f.stepBackward()}else m=f.getCurrentToken();return n.end.row=f.getCurrentTokenRow(),n.end.column=f.getCurrentTokenColumn()+m.value.length-2,n}};this.foldAll=
function(b,c,d){d==void 0&&(d=1E5);var e=this.foldWidgets;if(e)for(var c=c||this.getLength(),f=b=b||0;f<c;f++){e[f]==null&&(e[f]=this.getFoldWidget(f));if(e[f]=="start"){var g=this.getFoldWidgetRange(f);if(g&&g.isMultiLine()&&g.end.row<=c&&g.start.row>=b){f=g.end.row;try{var q=this.addFold("...",g);q&&(q.collapseChildren=d)}catch(p){}}}}};this.$foldStyles={manual:1,markbegin:1,markbeginend:1};this.$foldStyle="markbegin";this.setFoldStyle=function(b){if(!this.$foldStyles[b])throw Error("invalid fold style: "+
b+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=b){this.$foldStyle=b;b=="manual"&&this.unfold();b=this.$foldMode;this.$setFolding(null);this.$setFolding(b)}};this.$setFolding=function(b){if(this.$foldMode!=b){this.$foldMode=b;this.removeListener("change",this.$updateFoldWidgets);this._emit("changeAnnotation");if(!b||this.$foldStyle=="manual")this.foldWidgets=null;else{this.foldWidgets=[];this.getFoldWidget=b.getFoldWidget.bind(b,this,this.$foldStyle);this.getFoldWidgetRange=
b.getFoldWidgetRange.bind(b,this,this.$foldStyle);this.$updateFoldWidgets=this.updateFoldWidgets.bind(this);this.on("change",this.$updateFoldWidgets)}}};this.getParentFoldRangeData=function(b,c){var d=this.foldWidgets;if(!d||c&&d[b])return{};for(var e=b-1,f;e>=0;){var g=d[e];g==null&&(g=d[e]=this.getFoldWidget(e));if(g=="start"){var q=this.getFoldWidgetRange(e);f||(f=q);if(q&&q.end.row>=b)break}e--}return{range:e!==-1&&q,firstRange:f}};this.onFoldWidgetClick=function(b,c){c=c.domEvent;if(!this.$toggleFoldWidget(b,
{children:c.shiftKey,all:c.ctrlKey||c.metaKey,siblings:c.altKey})){var d=c.target||c.srcElement;d&&/ace_fold-widget/.test(d.className)&&(d.className=d.className+" ace_invalid")}};this.$toggleFoldWidget=function(b,c){if(this.getFoldWidget){var d=this.getFoldWidget(b),e=this.getLine(b),d=d==="end"?-1:1;if(d=this.getFoldAt(b,d===-1?0:e.length,d))c.children||c.all?this.removeFold(d):this.expandFold(d);else{if((e=this.getFoldWidgetRange(b,true))&&!e.isMultiLine())if((d=this.getFoldAt(e.start.row,e.start.column,
1))&&e.isEqual(d.range)){this.removeFold(d);return}if(c.siblings){d=this.getParentFoldRangeData(b);if(d.range)var f=d.range.start.row+1,g=d.range.end.row;this.foldAll(f,g,c.all?1E4:0)}else c.children?(e||this.getLength(),this.foldAll(b+1,e.end.row,c.all?1E4:0)):e&&(c.all&&(e.collapseChildren=1E4),this.addFold("...",e));return e}}};this.toggleFoldWidget=function(){var b=this.selection.getCursor().row,b=this.getRowFoldStart(b),c=this.$toggleFoldWidget(b,{});if(!c){c=this.getParentFoldRangeData(b,true);
if(c=c.range||c.firstRange){b=c.start.row;(b=this.getFoldAt(b,this.getLine(b).length,1))?this.removeFold(b):this.addFold("...",c)}}};this.updateFoldWidgets=function(b){var c=b.data,d=c.range,b=d.start.row,d=d.end.row-b;if(d===0)this.foldWidgets[b]=null;else if(c.action=="removeText"||c.action=="removeLines")this.foldWidgets.splice(b,d+1,null);else{c=Array(d+1);c.unshift(b,1);this.foldWidgets.splice.apply(this.foldWidgets,c)}}}});
ace.define("ace/edit_session/fold_line",["require","exports","module","ace/range"],function(b,c){function d(b,c){this.foldData=b;Array.isArray(c)?this.folds=c:c=this.folds=[c];var d=c[c.length-1];this.range=new e(c[0].start.row,c[0].start.column,d.end.row,d.end.column);this.start=this.range.start;this.end=this.range.end;this.folds.forEach(function(b){b.setFoldLine(this)},this)}var e=b("../range").Range;(function(){this.shiftRow=function(b){this.start.row+=b;this.end.row+=b;this.folds.forEach(function(c){c.start.row+=
b;c.end.row+=b})};this.addFold=function(b){if(b.sameRow){if(b.start.row<this.startRow||b.endRow>this.endRow)throw Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(b);this.folds.sort(function(b,c){return-b.range.compareEnd(c.start.row,c.start.column)});0<this.range.compareEnd(b.start.row,b.start.column)?(this.end.row=b.end.row,this.end.column=b.end.column):0>this.range.compareStart(b.end.row,b.end.column)&&(this.start.row=b.start.row,this.start.column=b.start.column)}else if(b.start.row==
this.end.row)this.folds.push(b),this.end.row=b.end.row,this.end.column=b.end.column;else{if(b.end.row!=this.start.row)throw Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(b);this.start.row=b.start.row;this.start.column=b.start.column}b.foldLine=this};this.containsRow=function(b){return b>=this.start.row&&b<=this.end.row};this.walk=function(b,c,d){var e=0,k=this.folds,l,m,n;n=!0;null==c&&(c=this.end.row,d=this.end.column);for(var q=0;q<k.length;q++){l=k[q];
m=l.range.compareStart(c,d);if(-1==m){b(null,c,d,e,n);return}n=b(null,l.start.row,l.start.column,e,n);if((n=!n&&b(l.placeholder,l.start.row,l.start.column,e))||0==m)return;n=!l.sameRow;e=l.end.column}b(null,c,d,e,n)};this.getNextFoldTo=function(b,c){for(var d,e,k=0;k<this.folds.length;k++){d=this.folds[k];e=d.range.compareEnd(b,c);if(-1==e)return{fold:d,kind:"after"};if(0==e)return{fold:d,kind:"inside"}}return null};this.addRemoveChars=function(b,c,d){var e=this.getNextFoldTo(b,c),k;if(e)if(k=e.fold,
"inside"==e.kind&&k.start.column!=c&&k.start.row!=b)window.console&&window.console.log(b,c,k);else if(k.start.row==b){b=this.folds;c=b.indexOf(k);0==c&&(this.start.column+=d);for(c;c<b.length;c++){k=b[c];k.start.column+=d;if(!k.sameRow)return;k.end.column+=d}this.end.column+=d}};this.split=function(b,c){var e=this.getNextFoldTo(b,c).fold,j=this.folds,k=this.foldData;if(!e)return null;var e=j.indexOf(e),l=j[e-1];this.end.row=l.end.row;this.end.column=l.end.column;j=j.splice(e,j.length-e);j=new d(k,
j);return k.splice(k.indexOf(this)+1,0,j),j};this.merge=function(b){for(var c=b.folds,d=0;d<c.length;d++)this.addFold(c[d]);c=this.foldData;c.splice(c.indexOf(b),1)};this.toString=function(){var b=[this.range.toString()+": ["];return this.folds.forEach(function(c){b.push("  "+c.toString())}),b.push("]"),b.join("\n")};this.idxToPosition=function(b){for(var c=0,d,e=0;e<this.folds.length;e++){d=this.folds[e];b-=d.start.column-c;if(0>b)return{row:d.start.row,column:d.start.column+b};b-=d.placeholder.length;
if(0>b)return d.start;c=d.end.column}return{row:this.end.row,column:this.end.column+b}}}).call(d.prototype);c.FoldLine=d});
ace.define("ace/edit_session/fold","require exports module ace/range ace/range_list ace/lib/oop".split(" "),function(b,c){b("../range");var d=b("../range_list").RangeList,e=b("../lib/oop"),f=c.Fold=function(b,c){this.foldLine=null;this.placeholder=c;this.range=b;this.start=b.start;this.end=b.end;this.sameRow=b.start.row==b.end.row;this.subFolds=this.ranges=[]};e.inherits(f,d);(function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()};this.setFoldLine=function(b){this.foldLine=
b;this.subFolds.forEach(function(c){c.setFoldLine(b)})};this.clone=function(){var b=this.range.clone(),c=new f(b,this.placeholder);return this.subFolds.forEach(function(b){c.subFolds.push(b.clone())}),c.collapseChildren=this.collapseChildren,c};this.addSubFold=function(b){if(!this.range.isEqual(b)){if(!this.range.containsRange(b))throw Error("A fold can't intersect already existing fold"+b.range+this.range);var c=this.start,d=b.start;d.row=d.row-c.row;d.row==0&&(d.column=d.column-c.column);d=b.end;
d.row=d.row-c.row;d.row==0&&(d.column=d.column-c.column);for(var e=b.start.row,f=b.start.column,c=0,d=-1;c<this.subFolds.length;c++){d=this.subFolds[c].range.compare(e,f);if(d!=1)break}e=this.subFolds[c];if(d==0)return e.addSubFold(b);for(var e=b.range.end.row,f=b.range.end.column,m=c,d=-1;m<this.subFolds.length;m++){d=this.subFolds[m].range.compare(e,f);if(d!=1)break}if(d==0)throw Error("A fold can't intersect already existing fold"+b.range+this.range);this.subFolds.splice(c,m-c,b);return b.setFoldLine(this.foldLine),
b}};this.restoreRange=function(b){var c=this.start,d=b.start;d.row==0&&(d.column=d.column+c.column);d.row=d.row+c.row;b=b.end;b.row==0&&(b.column=b.column+c.column);b.row=b.row+c.row}}).call(f.prototype)});
ace.define("ace/range_list",["require","exports","module","ace/range"],function(b,c){var d=b("./range").Range.comparePoints,e=function(){this.ranges=[]};(function(){this.comparePoints=d;this.pointIndex=function(b,c,e){for(var j=this.ranges,e=e||0;e<j.length;e++){var k=j[e],l=d(b,k.end);if(!(0<l))return b=d(b,k.start),0===l?c&&0!==b?-e-2:e:0<b||0===b&&!c?e:-e-1}return-e-1};this.add=function(b){var c=!b.isEmpty(),d=this.pointIndex(b.start,c);0>d&&(d=-d-1);c=this.pointIndex(b.end,c,d);return 0>c?c=-c-
1:c++,this.ranges.splice(d,c-d,b)};this.addList=function(b){for(var c=[],d=b.length;d--;)c.push.call(c,this.add(b[d]));return c};this.substractPoint=function(b){b=this.pointIndex(b);if(0<=b)return this.ranges.splice(b,1)};this.merge=function(){for(var b=[],c=this.ranges,c=c.sort(function(b,c){return d(b.start,c.start)}),e=c[0],j,k=1;k<c.length;k++){j=e;var e=c[k],l=d(j.end,e.start);!(0>l)&&!(0==l&&!j.isEmpty()&&!e.isEmpty())&&(0>d(j.end,e.end)&&(j.end.row=e.end.row,j.end.column=e.end.column),c.splice(k,
1),b.push(e),e=j,k--)}return this.ranges=c,b};this.contains=function(b,c){return 0<=this.pointIndex({row:b,column:c})};this.containsPoint=function(b){return 0<=this.pointIndex(b)};this.rangeAtPoint=function(b){b=this.pointIndex(b);if(0<=b)return this.ranges[b]};this.clipRows=function(b,c){var d=this.ranges;if(d[0].start.row>c||d[d.length-1].start.row<b)return[];var e=this.pointIndex({row:b,column:0});0>e&&(e=-e-1);var k=this.pointIndex({row:c,column:0},e);0>k&&(k=-k-1);for(var l=[];e<k;e++)l.push(d[e]);
return l};this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)};this.attach=function(b){this.session&&this.detach();this.session=b;this.onChange=this.$onChange.bind(this);this.session.on("change",this.onChange)};this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)};this.$onChange=function(b){var c=b.data.range;if("i"==b.data.action[0])var b=c.start,d=c.end;else d=c.start,b=c.end;for(var c=b.row,e=d.row-c,d=-b.column+d.column,
k=this.ranges,l=0,m=k.length;l<m;l++){var n=k[l];if(!(n.end.row<c)){if(n.start.row>c)break;n.start.row==c&&n.start.column>=b.column&&(n.start.column!=b.column||!this.$insertRight)&&(n.start.column+=d,n.start.row+=e);n.end.row==c&&n.end.column>=b.column&&!(n.end.column==b.column&&this.$insertRight)&&(n.end.column==b.column&&0<d&&l<m-1&&n.end.column>n.start.column&&n.end.column==k[l+1].start.column&&(n.end.column-=d),n.end.column+=d,n.end.row+=e)}}if(0!=e&&l<m)for(;l<m;l++)n=k[l],n.start.row+=e,n.end.row+=
e}}).call(e.prototype);c.RangeList=e});
ace.define("ace/edit_session/bracket_match",["require","exports","module","ace/token_iterator","ace/range"],function(b,c){var d=b("../token_iterator").TokenIterator,e=b("../range").Range;c.BracketMatch=function(){this.findMatchingBracket=function(b,c){if(0==b.column)return null;var d=c||this.getLine(b.row).charAt(b.column-1);return""==d?null:(d=d.match(/([\(\[\{])|([\)\]\}])/))?d[1]?this.$findClosingBracket(d[1],b):this.$findOpeningBracket(d[2],b):null};this.getBracketRange=function(b){var c=this.getLine(b.row),
d=!0,j=c.charAt(b.column-1),k=j&&j.match(/([\(\[\{])|([\)\]\}])/);k||(j=c.charAt(b.column),b={row:b.row,column:b.column+1},k=j&&j.match(/([\(\[\{])|([\)\]\}])/),d=!1);if(!k)return null;if(k[1]){c=this.$findClosingBracket(k[1],b);if(!c)return null;b=e.fromPoints(b,c);d||(b.end.column++,b.start.column--);b.cursor=b.end}else{c=this.$findOpeningBracket(k[2],b);if(!c)return null;b=e.fromPoints(c,b);d||(b.start.column++,b.end.column--);b.cursor=b.start}return b};this.$brackets={")":"(","(":")","]":"[",
"[":"]","{":"}","}":"{"};this.$findOpeningBracket=function(b,c,e){var j=this.$brackets[b],k=1,l=new d(this,c.row,c.column),m=l.getCurrentToken();m||(m=l.stepForward());if(m){e||(e=RegExp("(\\.?"+m.type.replace(".","\\.").replace("rparen",".paren")+")+"));c=c.column-l.getCurrentTokenColumn()-2;for(m=m.value;;){for(;0<=c;){var n=m.charAt(c);if(n==j){if(k-=1,0==k)return{row:l.getCurrentTokenRow(),column:c+l.getCurrentTokenColumn()}}else n==b&&(k+=1);c-=1}do m=l.stepBackward();while(m&&!e.test(m.type));
if(null==m)break;m=m.value;c=m.length-1}return null}};this.$findClosingBracket=function(b,c,e){var j=this.$brackets[b],k=1,l=new d(this,c.row,c.column),m=l.getCurrentToken();m||(m=l.stepForward());if(m){e||(e=RegExp("(\\.?"+m.type.replace(".","\\.").replace("lparen",".paren")+")+"));for(c=c.column-l.getCurrentTokenColumn();;){for(var m=m.value,n=m.length;c<n;){var q=m.charAt(c);if(q==j){if(k-=1,0==k)return{row:l.getCurrentTokenRow(),column:c+l.getCurrentTokenColumn()}}else q==b&&(k+=1);c+=1}do m=
l.stepForward();while(m&&!e.test(m.type));if(null==m)break;c=0}return null}}}});
ace.define("ace/search","require exports module ace/lib/lang ace/lib/oop ace/range".split(" "),function(b,c){var d=b("./lib/lang"),e=b("./lib/oop"),f=b("./range").Range,g=function(){this.$options={}};(function(){this.set=function(b){return e.mixin(this.$options,b),this};this.getOptions=function(){return d.copyObject(this.$options)};this.setOptions=function(b){this.$options=b};this.find=function(b){b=this.$matchIterator(b,this.$options);if(!b)return false;var c=null;return b.forEach(function(b,d,e){if(b.start)c=
b;else{e=b.offset+(e||0);c=new f(d,e,d,e+b.length)}return true}),c};this.findAll=function(b){var c=this.$options;if(!c.needle)return[];this.$assembleRegExp(c);var e=c.range,g=e?b.getLines(e.start.row,e.end.row):b.doc.getAllLines(),b=[],m=c.re;if(c.$isMultiLine)for(var n=m.length,q=g.length-n,p=m.offset||0;p<=q;p++){for(c=0;c<n;c++)if(g[p+c].search(m[c])==-1)break;var c=g[p],s=g[p+n-1],r=c.match(m[0])[0].length,s=s.match(m[n-1])[0].length;b.push(new f(p,c.length-r,p+n-1,s))}else for(n=0;n<g.length;n++){q=
d.getMatchOffsets(g[n],m);for(c=0;c<q.length;c++){p=q[c];b.push(new f(n,p.offset,n,p.offset+p.length))}}if(e){m=g=e.start.column;n=0;for(c=b.length-1;n<c&&b[n].start.column<g&&b[n].start.row==e.start.row;)n++;for(;n<c&&b[c].end.column>m&&b[c].end.row==e.end.row;)c--;b=b.slice(n,c+1);n=0;for(c=b.length;n<c;n++){b[n].start.row=b[n].start.row+e.start.row;b[n].end.row=b[n].end.row+e.start.row}}return b};this.replace=function(b,c){var d=this.$options,e=this.$assembleRegExp(d);if(d.$isMultiLine)return c;
if(e){var f=e.exec(b);if(!f||f[0].length!=b.length)return null;c=b.replace(e,c);if(d.preserveCase){c=c.split("");for(d=Math.min(b.length,b.length);d--;)(e=b[d])&&e.toLowerCase()!=e?c[d]=c[d].toUpperCase():c[d]=c[d].toLowerCase();c=c.join("")}return c}};this.$matchIterator=function(b,c){var e=this.$assembleRegExp(c);if(!e)return false;var g=this,m,n=c.backwards;if(c.$isMultiLine)var q=e.length,p=function(c,d,g){var j=c.search(e[0]);if(j!=-1){for(var l=1;l<q;l++){c=b.getLine(d+l);if(c.search(e[l])==
-1)return}c=c.match(e[q-1])[0].length;d=new f(d,j,d+q-1,c);e.offset==1?(d.start.row--,d.start.column=Number.MAX_VALUE):g&&(d.start.column=d.start.column+g);if(m(d))return true}};else p=n?function(b,c,f){for(var b=d.getMatchOffsets(b,e),g=b.length-1;g>=0;g--)if(m(b[g],c,f))return true}:function(b,c,f){for(var b=d.getMatchOffsets(b,e),g=0;g<b.length;g++)if(m(b[g],c,f))return true};return{forEach:function(d){m=d;g.$lineIterator(b,c).forEach(p)}}};this.$assembleRegExp=function(b,c){if(b.needle instanceof
RegExp)return b.re=b.needle;var e=b.needle;if(!b.needle)return b.re=false;b.regExp||(e=d.escapeRegExp(e));b.wholeWord&&(e="\\b"+e+"\\b");var f=b.caseSensitive?"g":"gi";b.$isMultiLine=!c&&/[\n\r]/.test(e);if(b.$isMultiLine)return b.re=this.$assembleMultilineRegExp(e,f);try{var g=RegExp(e,f)}catch(n){g=false}return b.re=g};this.$assembleMultilineRegExp=function(b,c){for(var d=b.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),e=[],f=0;f<d.length;f++)try{e.push(RegExp(d[f],c))}catch(g){return false}return d[0]==
""?(e.shift(),e.offset=1):e.offset=0,e};this.$lineIterator=function(b,c){var d=c.backwards==1,e=c.skipCurrent!=0,f=c.range,g=c.start;g||(g=f?f[d?"end":"start"]:b.selection.getRange());g.start&&(g=g[e!=d?"end":"start"]);var q=f?f.start.row:0,p=f?f.end.row:b.getLength()-1;return{forEach:d?function(d){var e=g.row,f=b.getLine(e).substring(0,g.column);if(!d(f,e)){for(e--;e>=q;e--)if(d(b.getLine(e),e))return;if(c.wrap!=0){e=p;for(q=g.row;e>=q;e--)if(d(b.getLine(e),e))break}}}:function(d){var e=g.row,f=
b.getLine(e).substr(g.column);if(!d(f,e,g.column)){for(e=e+1;e<=p;e++)if(d(b.getLine(e),e))return;if(c.wrap!=0){e=q;for(p=g.row;e<=p;e++)if(d(b.getLine(e),e))break}}}}}}).call(g.prototype);c.Search=g});
ace.define("ace/commands/command_manager","require exports module ace/lib/oop ace/keyboard/hash_handler ace/lib/event_emitter".split(" "),function(b,c){var d=b("../lib/oop"),e=b("../keyboard/hash_handler").HashHandler,f=b("../lib/event_emitter").EventEmitter,g=function(b,c){e.call(this,c,b);this.byName=this.commands;this.setDefaultHandler("exec",function(b){return b.command.exec(b.editor,b.args||{})})};d.inherits(g,e);(function(){d.implement(this,f);this.exec=function(b,c,d){typeof b=="string"&&(b=
this.commands[b]);if(!b||c&&c.$readOnly&&!b.readOnly)return false;b={editor:c,command:b,args:d};c=this._emit("exec",b);return this._signal("afterExec",b),c===false?false:true};this.toggleRecording=function(b){if(!this.$inReplay)return b&&b._emit("changeStatus"),this.recording?(this.macro.pop(),this.removeEventListener("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=false):(this.$addCommandToMacro||(this.$addCommandToMacro=function(b){this.macro.push([b.command,
b.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=true)};this.replay=function(b){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(b);try{this.$inReplay=true;this.macro.forEach(function(c){typeof c=="string"?this.exec(c,b):this.exec(c[0],b,c[1])},this)}finally{this.$inReplay=false}}};this.trimMacro=function(b){return b.map(function(b){return typeof b[0]!="string"&&(b[0]=b[0].name),b[1]||(b=b[0]),b})}}).call(g.prototype);
c.CommandManager=g});
ace.define("ace/keyboard/hash_handler",["require","exports","module","ace/lib/keys","ace/lib/useragent"],function(b,c){function d(b,c){this.platform=c||(f.isMac?"mac":"win");this.commands={};this.commandKeyBinding={};if(this.__defineGetter__&&this.__defineSetter__&&"undefined"!=typeof console&&console.error){var d=!1,e=function(){d||(d=!0,console.error("commmandKeyBinding has too many m's. use commandKeyBinding"))};this.__defineGetter__("commmandKeyBinding",function(){return e(),this.commandKeyBinding});
this.__defineSetter__("commmandKeyBinding",function(b){return e(),this.commandKeyBinding=b})}else this.commmandKeyBinding=this.commandKeyBinding;this.addCommands(b)}var e=b("../lib/keys"),f=b("../lib/useragent");(function(){this.addCommand=function(b){this.commands[b.name]&&this.removeCommand(b);this.commands[b.name]=b;b.bindKey&&this._buildKeyHash(b)};this.removeCommand=function(b){var c="string"==typeof b?b:b.name,b=this.commands[c];delete this.commands[c];var c=this.commandKeyBinding,d;for(d in c)for(var e in c[d])c[d][e]==
b&&delete c[d][e]};this.bindKey=function(b,c){if(b)if("function"==typeof c)this.addCommand({exec:c,bindKey:b,name:c.name||b});else{var d=this.commandKeyBinding;b.split("|").forEach(function(b){var b=this.parseKeys(b,c),e=b.hashId;(d[e]||(d[e]={}))[b.key]=c},this)}};this.addCommands=function(b){b&&Object.keys(b).forEach(function(c){var d=b[c];if(d){if("string"==typeof d)return this.bindKey(d,c);"function"==typeof d&&(d={exec:d});"object"==typeof d&&(d.name||(d.name=c),this.addCommand(d))}},this)};
this.removeCommands=function(b){Object.keys(b).forEach(function(c){this.removeCommand(b[c])},this)};this.bindKeys=function(b){Object.keys(b).forEach(function(c){this.bindKey(c,b[c])},this)};this._buildKeyHash=function(b){var c=b.bindKey;c&&this.bindKey("string"==typeof c?c:c[this.platform],b)};this.parseKeys=function(b){-1!=b.indexOf(" ")&&(b=b.split(/\s+/).pop());var c=b.toLowerCase().split(/[\-\+]([\-\+])?/).filter(function(b){return b}),d=c.pop(),f=e[d];if(e.FUNCTION_KEYS[f])d=e.FUNCTION_KEYS[f].toLowerCase();
else{if(!c.length)return{key:d,hashId:-1};if(1==c.length&&"shift"==c[0])return{key:d.toUpperCase(),hashId:-1}}for(var f=0,l=c.length;l--;){var m=e.KEY_MODS[c[l]];if(null==m)return"undefined"!=typeof console&&console.error("invalid modifier "+c[l]+" in "+b),!1;f|=m}return{key:d,hashId:f}};this.findKeyCommand=function(b,c){var d=this.commandKeyBinding;return d[b]&&d[b][c]};this.handleKeyboard=function(b,c,d){return{command:this.findKeyCommand(c,d)}}}).call(d.prototype);c.HashHandler=d});
ace.define("ace/commands/default_commands",["require","exports","module","ace/lib/lang","ace/config"],function(b,c){function d(b,c){return{win:b,mac:c}}var e=b("../lib/lang"),f=b("../config");c.commands=[{name:"showSettingsMenu",bindKey:d("Ctrl-,","Command-,"),exec:function(b){f.loadModule("ace/ext/settings_menu",function(c){c.init(b);b.showSettingsMenu()})},readOnly:!0},{name:"goToNextError",bindKey:d("Alt-E","Ctrl-E"),exec:function(b){f.loadModule("ace/ext/error_marker",function(c){c.showErrorMarker(b,
1)})},scrollIntoView:"center",readOnly:!0},{name:"goToPreviousError",bindKey:d("Alt-Shift-E","Ctrl-Shift-E"),exec:function(b){f.loadModule("ace/ext/error_marker",function(c){c.showErrorMarker(b,-1)})},scrollIntoView:"center",readOnly:!0},{name:"selectall",bindKey:d("Ctrl-A","Command-A"),exec:function(b){b.selectAll()},readOnly:!0},{name:"centerselection",bindKey:d(null,"Ctrl-L"),exec:function(b){b.centerSelection()},readOnly:!0},{name:"gotoline",bindKey:d("Ctrl-L","Command-L"),exec:function(b){var c=
parseInt(prompt("Enter line number:"),10);isNaN(c)||b.gotoLine(c)},readOnly:!0},{name:"fold",bindKey:d("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(b){b.session.toggleFold(!1)},scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:d("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(b){b.session.toggleFold(!0)},scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",bindKey:d("F2","F2"),exec:function(b){b.session.toggleFoldWidget()},scrollIntoView:"center",
readOnly:!0},{name:"toggleParentFoldWidget",bindKey:d("Alt-F2","Alt-F2"),exec:function(b){b.session.toggleFoldWidget(!0)},scrollIntoView:"center",readOnly:!0},{name:"foldall",bindKey:d("Ctrl-Alt-0","Ctrl-Command-Option-0"),exec:function(b){b.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",bindKey:d("Alt-0","Command-Option-0"),exec:function(b){b.session.foldAll();b.session.unfold(b.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",bindKey:d("Alt-Shift-0",
"Command-Option-Shift-0"),exec:function(b){b.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",bindKey:d("Ctrl-K","Command-G"),exec:function(b){b.findNext()},readOnly:!0},{name:"findprevious",bindKey:d("Ctrl-Shift-K","Command-Shift-G"),exec:function(b){b.findPrevious()},readOnly:!0},{name:"selectOrFindNext",bindKey:d("ALt-K","Ctrl-G"),exec:function(b){b.selection.isEmpty()?b.selection.selectWord():b.findNext()},readOnly:!0},{name:"selectOrFindPrevious",bindKey:d("Alt-Shift-K",
"Ctrl-Shift-G"),exec:function(b){b.selection.isEmpty()?b.selection.selectWord():b.findPrevious()},readOnly:!0},{name:"find",bindKey:d("Ctrl-F","Command-F"),exec:function(b){f.loadModule("ace/ext/searchbox",function(c){c.Search(b)})},readOnly:!0},{name:"overwrite",bindKey:"Insert",exec:function(b){b.toggleOverwrite()},readOnly:!0},{name:"selecttostart",bindKey:d("Ctrl-Shift-Home","Command-Shift-Up"),exec:function(b){b.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",
aceCommandGroup:"fileJump"},{name:"gotostart",bindKey:d("Ctrl-Home","Command-Home|Command-Up"),exec:function(b){b.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",bindKey:d("Shift-Up","Shift-Up"),exec:function(b){b.getSelection().selectUp()},multiSelectAction:"forEach",readOnly:!0},{name:"golineup",bindKey:d("Up","Up|Ctrl-P"),exec:function(b,c){b.navigateUp(c.times)},multiSelectAction:"forEach",readOnly:!0},{name:"selecttoend",
bindKey:d("Ctrl-Shift-End","Command-Shift-Down"),exec:function(b){b.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",bindKey:d("Ctrl-End","Command-End|Command-Down"),exec:function(b){b.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",bindKey:d("Shift-Down","Shift-Down"),exec:function(b){b.getSelection().selectDown()},multiSelectAction:"forEach",
scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",bindKey:d("Down","Down|Ctrl-N"),exec:function(b,c){b.navigateDown(c.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",bindKey:d("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(b){b.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",bindKey:d("Ctrl-Left","Option-Left"),exec:function(b){b.navigateWordLeft()},multiSelectAction:"forEach",
scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",bindKey:d("Alt-Shift-Left","Command-Shift-Left"),exec:function(b){b.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",bindKey:d("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(b){b.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",bindKey:d("Shift-Left","Shift-Left"),exec:function(b){b.getSelection().selectLeft()},
multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",bindKey:d("Left","Left|Ctrl-B"),exec:function(b,c){b.navigateLeft(c.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",bindKey:d("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(b){b.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",bindKey:d("Ctrl-Right","Option-Right"),exec:function(b){b.navigateWordRight()},
multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",bindKey:d("Alt-Shift-Right","Command-Shift-Right"),exec:function(b){b.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",bindKey:d("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(b){b.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",bindKey:d("Shift-Right","Shift-Right"),exec:function(b){b.getSelection().selectRight()},
multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",bindKey:d("Right","Right|Ctrl-F"),exec:function(b,c){b.navigateRight(c.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",bindKey:"Shift-PageDown",exec:function(b){b.selectPageDown()},readOnly:!0},{name:"pagedown",bindKey:d(null,"Option-PageDown"),exec:function(b){b.scrollPageDown()},readOnly:!0},{name:"gotopagedown",bindKey:d("PageDown","PageDown|Ctrl-V"),exec:function(b){b.gotoPageDown()},
readOnly:!0},{name:"selectpageup",bindKey:"Shift-PageUp",exec:function(b){b.selectPageUp()},readOnly:!0},{name:"pageup",bindKey:d(null,"Option-PageUp"),exec:function(b){b.scrollPageUp()},readOnly:!0},{name:"gotopageup",bindKey:"PageUp",exec:function(b){b.gotoPageUp()},readOnly:!0},{name:"scrollup",bindKey:d("Ctrl-Up",null),exec:function(b){b.renderer.scrollBy(0,-2*b.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",bindKey:d("Ctrl-Down",null),exec:function(b){b.renderer.scrollBy(0,
2*b.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",bindKey:"Shift-Home",exec:function(b){b.getSelection().selectLineStart()},multiSelectAction:"forEach",readOnly:!0},{name:"selectlineend",bindKey:"Shift-End",exec:function(b){b.getSelection().selectLineEnd()},multiSelectAction:"forEach",readOnly:!0},{name:"togglerecording",bindKey:d("Ctrl-Alt-E","Command-Option-E"),exec:function(b){b.commands.toggleRecording(b)},readOnly:!0},{name:"replaymacro",bindKey:d("Ctrl-Shift-E","Command-Shift-E"),
exec:function(b){b.commands.replay(b)},readOnly:!0},{name:"jumptomatching",bindKey:d("Ctrl-P","Ctrl-Shift-P"),exec:function(b){b.jumpToMatching()},multiSelectAction:"forEach",readOnly:!0},{name:"selecttomatching",bindKey:d("Ctrl-Shift-P",null),exec:function(b){b.jumpToMatching(!0)},multiSelectAction:"forEach",readOnly:!0},{name:"cut",exec:function(b){var c=b.getSelectionRange();b._emit("cut",c);b.selection.isEmpty()||(b.session.remove(c),b.clearSelection())},multiSelectAction:"forEach"},{name:"removeline",
bindKey:d("Ctrl-D","Command-D"),exec:function(b){b.removeLines()},multiSelectAction:"forEachLine"},{name:"duplicateSelection",bindKey:d("Ctrl-Shift-D","Command-Shift-D"),exec:function(b){b.duplicateSelection()},multiSelectAction:"forEach"},{name:"sortlines",bindKey:d("Ctrl-Alt-S","Command-Alt-S"),exec:function(b){b.sortLines()},multiSelectAction:"forEachLine"},{name:"togglecomment",bindKey:d("Ctrl-/","Command-/"),exec:function(b){b.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},
{name:"toggleBlockComment",bindKey:d("Ctrl-Shift-/","Command-Shift-/"),exec:function(b){b.toggleBlockComment()},multiSelectAction:"forEach"},{name:"modifyNumberUp",bindKey:d("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(b){b.modifyNumber(1)},multiSelectAction:"forEach"},{name:"modifyNumberDown",bindKey:d("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(b){b.modifyNumber(-1)},multiSelectAction:"forEach"},{name:"replace",bindKey:d("Ctrl-H","Command-Option-F"),exec:function(b){f.loadModule("ace/ext/searchbox",
function(c){c.Search(b,!0)})}},{name:"undo",bindKey:d("Ctrl-Z","Command-Z"),exec:function(b){b.undo()}},{name:"redo",bindKey:d("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(b){b.redo()}},{name:"copylinesup",bindKey:d("Alt-Shift-Up","Command-Option-Up"),exec:function(b){b.copyLinesUp()}},{name:"movelinesup",bindKey:d("Alt-Up","Option-Up"),exec:function(b){b.moveLinesUp()}},{name:"copylinesdown",bindKey:d("Alt-Shift-Down","Command-Option-Down"),exec:function(b){b.copyLinesDown()}},
{name:"movelinesdown",bindKey:d("Alt-Down","Option-Down"),exec:function(b){b.moveLinesDown()}},{name:"del",bindKey:d("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(b){b.remove("right")},multiSelectAction:"forEach"},{name:"backspace",bindKey:d("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(b){b.remove("left")},multiSelectAction:"forEach"},{name:"cut_or_delete",bindKey:d("Shift-Delete",null),exec:function(b){if(!b.selection.isEmpty())return!1;b.remove("left")},
multiSelectAction:"forEach"},{name:"removetolinestart",bindKey:d("Alt-Backspace","Command-Backspace"),exec:function(b){b.removeToLineStart()},multiSelectAction:"forEach"},{name:"removetolineend",bindKey:d("Alt-Delete","Ctrl-K"),exec:function(b){b.removeToLineEnd()},multiSelectAction:"forEach"},{name:"removewordleft",bindKey:d("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(b){b.removeWordLeft()},multiSelectAction:"forEach"},{name:"removewordright",bindKey:d("Ctrl-Delete","Alt-Delete"),
exec:function(b){b.removeWordRight()},multiSelectAction:"forEach"},{name:"outdent",bindKey:d("Shift-Tab","Shift-Tab"),exec:function(b){b.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",bindKey:d("Tab","Tab"),exec:function(b){b.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",bindKey:d("Ctrl-[","Ctrl-["),exec:function(b){b.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",
bindKey:d("Ctrl-]","Ctrl-]"),exec:function(b){b.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",exec:function(b,c){b.insert(c)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",exec:function(b,c){b.insert(e.stringRepeat(c.text||"",c.times||1))},multiSelectAction:"forEach"},{name:"splitline",bindKey:d(null,"Ctrl-O"),exec:function(b){b.splitLine()},multiSelectAction:"forEach"},{name:"transposeletters",bindKey:d("Ctrl-T","Ctrl-T"),
exec:function(b){b.transposeLetters()},multiSelectAction:function(b){b.transposeSelections(1)}},{name:"touppercase",bindKey:d("Ctrl-U","Ctrl-U"),exec:function(b){b.toUpperCase()},multiSelectAction:"forEach"},{name:"tolowercase",bindKey:d("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(b){b.toLowerCase()},multiSelectAction:"forEach"}]});
ace.define("ace/undomanager",["require","exports","module"],function(b,c){var d=function(){this.reset()};(function(){this.execute=function(b){var c=b.args[0];this.$doc=b.args[1];b.merge&&this.hasUndo()&&(c=this.$undoStack.pop().concat(c));this.$undoStack.push(c);this.$redoStack=[];0>this.dirtyCounter&&(this.dirtyCounter=NaN);this.dirtyCounter++};this.undo=function(b){var c=this.$undoStack.pop();return c&&(this.$doc.undoChanges(c,b),this.$redoStack.push(c),this.dirtyCounter--),null};this.redo=function(b){var c=
this.$redoStack.pop();return c&&(this.$doc.redoChanges(c,b),this.$undoStack.push(c),this.dirtyCounter++),null};this.reset=function(){this.$undoStack=[];this.$redoStack=[];this.dirtyCounter=0};this.hasUndo=function(){return 0<this.$undoStack.length};this.hasRedo=function(){return 0<this.$redoStack.length};this.markClean=function(){this.dirtyCounter=0};this.isClean=function(){return 0===this.dirtyCounter}}).call(d.prototype);c.UndoManager=d});
ace.define("ace/virtual_renderer","require exports module ace/lib/oop ace/lib/dom ace/lib/useragent ace/config ace/layer/gutter ace/layer/marker ace/layer/text ace/layer/cursor ace/scrollbar ace/renderloop ace/lib/event_emitter".split(" "),function(b,c){var d=b("./lib/oop"),e=b("./lib/dom");b("./lib/useragent");var f=b("./config"),g=b("./layer/gutter").Gutter,h=b("./layer/marker").Marker,j=b("./layer/text").Text,k=b("./layer/cursor").Cursor,l=b("./scrollbar").HScrollBar,m=b("./scrollbar").VScrollBar,
n=b("./renderloop").RenderLoop,q=b("./lib/event_emitter").EventEmitter;e.importCssString(".ace_editor {position: relative;overflow: hidden;font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;font-size: 12px;line-height: normal;color: black;}.ace_editor .ace_line {direction: ltr;unicode-bidi: bidi-override;}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: text;min-width: 100%;}.ace_dragging, .ace_dragging * {cursor: move !important;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QUM2OEZDQTQ4RTU0MTFFMUEzM0VFRTM2RUY1M0RBMjYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QUM2OEZDQTU4RTU0MTFFMUEzM0VFRTM2RUY1M0RBMjYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBQzY4RkNBMjhFNTQxMUUxQTMzRUVFMzZFRjUzREEyNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBQzY4RkNBMzhFNTQxMUUxQTMzRUVFMzZFRjUzREEyNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkgXxbAAAAJbSURBVHjapFNNaBNBFH4zs5vdZLP5sQmNpT82QY209heh1ioWisaDRcSKF0WKJ0GQnrzrxasHsR6EnlrwD0TagxJabaVEpFYxLWlLSS822tr87m66ccfd2GKyVhA6MMybgfe97/vmPUQphd0sZjto9XIn9OOsvlu2nkqRzVU+6vvlzPf8W6bk8dxQ0NPbxAALgCgg2JkaQuhzQau/El0zbmUA7U0Es8v2CiYmKQJHGO1QICCLoqilMhkmurDAyapKgqItezi/USRdJqEYY4D5jCy03ht2yMkkvL91jTTX10qzyyu2hruPRN7jgbH+EOsXcMLgYiThEgAMhABW85oqy1DXdRIdvP1AHJ2acQXvDIrVHcdQNrEKNYSVMSZGMjEzIIAwDXIo+6G/FxcGnzkC3T2oMhLjre49sBB+RRcHLqdafK6sYdE/GGBwU1VpFNj0aN8pJbe+BkZyevUrvLl6Xmm0W9IuTc0DxrDNAJd5oEvI/KRsNC3bQyNjPO9yQ1YHcfj2QvfQc/5TUhJTBc2iM0U7AWDQtc1nJHvD/cfO2s7jaGkiTEfa/Ep8coLu7zmNmh8+dc5lZDuUeFAGUNA/OY6JVaypQ0vjr7XYjUvJM37vt+j1vuTK5DgVfVUoTjVe+y3/LxMxY2GgU+CSLy4cpfsYorRXuXIOi0Vt40h67uZFTdIo6nLaZcwUJWAzwNS0tBnqqKzQDnjdG/iPyZxo46HaKUpbvYkj8qYRTZsBhge+JHhZyh0x9b95JqjVJkT084kZIPwu/mPWqPgfQ5jXh2+92Ay7HedfAgwA6KDWafb4w3cAAAAASUVORK5CYII=\");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QUM2OEZDQTg4RTU0MTFFMUEzM0VFRTM2RUY1M0RBMjYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QUM2OEZDQTk4RTU0MTFFMUEzM0VFRTM2RUY1M0RBMjYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBQzY4RkNBNjhFNTQxMUUxQTMzRUVFMzZFRjUzREEyNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBQzY4RkNBNzhFNTQxMUUxQTMzRUVFMzZFRjUzREEyNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pgd7PfIAAAGmSURBVHjaYvr//z8DJZiJgUIANoCRkREb9gLiSVAaQx4OQM7AAkwd7XU2/v++/rOttdYGEB9dASEvOMydGKfH8Gv/p4XTkvRBfLxeQAP+1cUhXopyvzhP7P/IoSj7g7Mw09cNKO6J1QQ0L4gICPIv/veg/8W+JdFvQNLHVsW9/nmn9zk7B+cCkDwhL7gt6knSZnx9/LuCEOcvkIAMP+cvto9nfqyZmmUAksfnBUtbM60gX/3/kgyv3/xSFOL5DZT+L8vP+Yfh5cvfPvp/xUHyQHXGyAYwgpwBjZYFT3Y1OEl/OfCH4ffv3wzc4iwMvNIsDJ+f/mH4+vIPAxsb631WW0Yln6ZpQLXdMK/DXGDflh+sIv37EivD5x//Gb7+YWT4y86sl7BCCkSD+Z++/1dkvsFRl+HnD1Rvje4F8whjMXmGj58YGf5zsDMwcnAwfPvKcml62DsQDeaDxN+/Y0qwlpEHqrdB94IRNIDUgfgfKJChGK4OikEW3gTiXUB950ASLFAF54AC94A0G9QAfOnmF9DCDzABFqS08IHYDIScdijOjQABBgC+/9awBH96jwAAAABJRU5ErkJggg==\");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url(\"data:image/gif;base64,R0lGODlhEAAQAMQAAAAAAEFBQVJSUl5eXmRkZGtra39/f4WFhYmJiZGRkaampry8vMPDw8zMzNXV1dzc3OTk5Orq6vDw8P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAkAABQALAAAAAAQABAAAAUuICWOZGmeaBml5XGwFCQSBGyXRSAwtqQIiRuiwIM5BoYVbEFIyGCQoeJGrVptIQA7\");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGRTk5MTVGREIxNDkxMUUxOTc5Q0FFREQyMTNGMjBFQyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGRTk5MTVGRUIxNDkxMUUxOTc5Q0FFREQyMTNGMjBFQyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZFOTkxNUZCQjE0OTExRTE5NzlDQUVERDIxM0YyMEVDIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkZFOTkxNUZDQjE0OTExRTE5NzlDQUVERDIxM0YyMEVDIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+SIDkjAAAAJ1JREFUeNpi/P//PwMlgImBQkB7A6qrq/+DMC55FkIGKCoq4pVnpFkgTp069f/+/fv/r1u37r+tre1/kg0A+ptn9uzZYLaRkRHpLvjw4cNXWVlZhufPnzOcO3eOdAO0tbVPAjHDmzdvGA4fPsxIsgGSkpJmv379Ynj37h2DjIyMCMkG3LhxQ/T27dsMampqDHZ2dq/pH41DxwCAAAMAFdc68dUsFZgAAAAASUVORK5CYII=\");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;}.ace_text-input.ace_composition {background: #f8f8f8;color: #111;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;/* setting pointer-events: auto; on node under the mouse, which changesduring scroll, will break mouse wheel scrolling in Safari */pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0px;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-moz-transition: opacity 0.18s;-webkit-transition: opacity 0.18s;-o-transition: opacity 0.18s;-ms-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_cursor[style*=\"opacity: 0\"]{-ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)\";}.ace_editor.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url(\"data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%11%00%00%00%09%08%06%00%00%00%D4%E8%C7%0C%00%00%03%1EiCCPICC%20Profile%00%00x%01%85T%DFk%D3P%14%FE%DAe%9D%B0%E1%8B%3Ag%11%09%3Eh%91ndStC%9C%B6kW%BA%CDZ%EA6%B7!H%9B%A6m%5C%9A%C6%24%ED~%B0%07%D9%8Bo%3A%C5w%F1%07%3E%F9%07%0C%D9%83o%7B%92%0D%C6%14a%F8%AC%88%22L%F6%22%B3%9E%9B4M'S%03%B9%F7%BB%DF%F9%EE9'%E7%E4%5E%A0%F9qZ%D3%14%2F%0F%14USO%C5%C2%FC%C4%E4%14%DF%F2%01%5E%1CC%2B%FChM%8B%86%16J%26G%40%0F%D3%B2y%EF%B3%F3%0E%1E%C6lt%EEo%DF%AB%FEc%D5%9A%95%0C%11%F0%1C%20%BE%945%C4%22%E1Y%A0i%5C%D4t%13%E0%D6%89%EF%9D15%C2%CDLsX%A7%04%09%1Fg8oc%81%E1%8C%8D%23%96f45%40%9A%09%C2%07%C5B%3AK%B8%408%98i%E0%F3%0D%D8%CE%81%14%E4'%26%A9%92.%8B%3C%ABER%2F%E5dE%B2%0C%F6%F0%1Fs%83%F2_%B0%A8%94%E9%9B%AD%E7%10%8Dm%9A%19N%D1%7C%8A%DE%1F9%7Dp%8C%E6%00%D5%C1%3F_%18%BDA%B8%9DpX6%E3%A35~B%CD%24%AE%11%26%BD%E7%EEti%98%EDe%9A%97Y)%12%25%1C%24%BCbT%AE3li%E6%0B%03%89%9A%E6%D3%ED%F4P%92%B0%9F4%BF43Y%F3%E3%EDP%95%04%EB1%C5%F5%F6KF%F4%BA%BD%D7%DB%91%93%07%E35%3E%A7)%D6%7F%40%FE%BD%F7%F5r%8A%E5y%92%F0%EB%B4%1E%8D%D5%F4%5B%92%3AV%DB%DB%E4%CD%A6%23%C3%C4wQ%3F%03HB%82%8E%1Cd(%E0%91B%0Ca%9Ac%C4%AA%F8L%16%19%22J%A4%D2itTy%B28%D6%3B(%93%96%ED%1CGx%C9_%0E%B8%5E%16%F5%5B%B2%B8%F6%E0%FB%9E%DD%25%D7%8E%BC%15%85%C5%B7%A3%D8Q%ED%B5%81%E9%BA%B2%13%9A%1B%7Fua%A5%A3n%E17%B9%E5%9B%1Bm%AB%0B%08Q%FE%8A%E5%B1H%5Ee%CAO%82Q%D7u6%E6%90S%97%FCu%0B%CF2%94%EE%25v%12X%0C%BA%AC%F0%5E%F8*l%0AO%85%17%C2%97%BF%D4%C8%CE%DE%AD%11%CB%80q%2C%3E%AB%9ES%CD%C6%EC%25%D2L%D2%EBd%B8%BF%8A%F5B%C6%18%F9%901CZ%9D%BE%24M%9C%8A9%F2%DAP%0B'%06w%82%EB%E6%E2%5C%2F%D7%07%9E%BB%CC%5D%E1%FA%B9%08%AD.r%23%8E%C2%17%F5E%7C!%F0%BE3%BE%3E_%B7o%88a%A7%DB%BE%D3d%EB%A31Z%EB%BB%D3%91%BA%A2%B1z%94%8F%DB'%F6%3D%8E%AA%13%19%B2%B1%BE%B1~V%08%2B%B4%A2cjJ%B3tO%00%03%25mN%97%F3%05%93%EF%11%84%0B%7C%88%AE-%89%8F%ABbW%90O%2B%0Ao%99%0C%5E%97%0CI%AFH%D9.%B0%3B%8F%ED%03%B6S%D6%5D%E6i_s9%F3*p%E9%1B%FD%C3%EB.7U%06%5E%19%C0%D1s.%17%A03u%E4%09%B0%7C%5E%2C%EB%15%DB%1F%3C%9E%B7%80%91%3B%DBc%AD%3Dma%BA%8B%3EV%AB%DBt.%5B%1E%01%BB%0F%AB%D5%9F%CF%AA%D5%DD%E7%E4%7F%0Bx%A3%FC%06%A9%23%0A%D6%C2%A1_2%00%00%00%09pHYs%00%00%0B%13%00%00%0B%13%01%00%9A%9C%18%00%00%00%B5IDAT(%15%A5%91%3D%0E%02!%10%85ac%E1%05%D6%CE%D6%C6%CE%D2%E8%ED%CD%DE%C0%C6%D6N.%E0V%F8%3D%9Ca%891XH%C2%BE%D9y%3F%90!%E6%9C%C3%BFk%E5%011%C6-%F5%C8N%04%DF%BD%FF%89%DFt%83DN%60%3E%F3%AB%A0%DE%1A%5Dg%BE%10Q%97%1B%40%9C%A8o%10%8F%5E%828%B4%1B%60%87%F6%02%26%85%1Ch%1E%C1%2B%5Bk%FF%86%EE%B7j%09%9A%DA%9B%ACe%A3%F9%EC%DA!9%B4%D5%A6%81%86%86%98%CC%3C%5B%40%FA%81%B3%E9%CB%23%94%C16Azo%05%D4%E1%C1%95a%3B%8A'%A0%E8%CC%17%22%85%1D%BA%00%A2%FA%DC%0A%94%D1%D1%8D%8B%3A%84%17B%C7%60%1A%25Z%FC%8D%00%00%00%00IEND%AEB%60%82\"),url(\"data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%05%00%00%007%08%06%00%00%00%C4%DD%80C%00%00%03%1EiCCPICC%20Profile%00%00x%01%85T%DFk%D3P%14%FE%DAe%9D%B0%E1%8B%3Ag%11%09%3Eh%91ndStC%9C%B6kW%BA%CDZ%EA6%B7!H%9B%A6m%5C%9A%C6%24%ED~%B0%07%D9%8Bo%3A%C5w%F1%07%3E%F9%07%0C%D9%83o%7B%92%0D%C6%14a%F8%AC%88%22L%F6%22%B3%9E%9B4M'S%03%B9%F7%BB%DF%F9%EE9'%E7%E4%5E%A0%F9qZ%D3%14%2F%0F%14USO%C5%C2%FC%C4%E4%14%DF%F2%01%5E%1CC%2B%FChM%8B%86%16J%26G%40%0F%D3%B2y%EF%B3%F3%0E%1E%C6lt%EEo%DF%AB%FEc%D5%9A%95%0C%11%F0%1C%20%BE%945%C4%22%E1Y%A0i%5C%D4t%13%E0%D6%89%EF%9D15%C2%CDLsX%A7%04%09%1Fg8oc%81%E1%8C%8D%23%96f45%40%9A%09%C2%07%C5B%3AK%B8%408%98i%E0%F3%0D%D8%CE%81%14%E4'%26%A9%92.%8B%3C%ABER%2F%E5dE%B2%0C%F6%F0%1Fs%83%F2_%B0%A8%94%E9%9B%AD%E7%10%8Dm%9A%19N%D1%7C%8A%DE%1F9%7Dp%8C%E6%00%D5%C1%3F_%18%BDA%B8%9DpX6%E3%A35~B%CD%24%AE%11%26%BD%E7%EEti%98%EDe%9A%97Y)%12%25%1C%24%BCbT%AE3li%E6%0B%03%89%9A%E6%D3%ED%F4P%92%B0%9F4%BF43Y%F3%E3%EDP%95%04%EB1%C5%F5%F6KF%F4%BA%BD%D7%DB%91%93%07%E35%3E%A7)%D6%7F%40%FE%BD%F7%F5r%8A%E5y%92%F0%EB%B4%1E%8D%D5%F4%5B%92%3AV%DB%DB%E4%CD%A6%23%C3%C4wQ%3F%03HB%82%8E%1Cd(%E0%91B%0Ca%9Ac%C4%AA%F8L%16%19%22J%A4%D2itTy%B28%D6%3B(%93%96%ED%1CGx%C9_%0E%B8%5E%16%F5%5B%B2%B8%F6%E0%FB%9E%DD%25%D7%8E%BC%15%85%C5%B7%A3%D8Q%ED%B5%81%E9%BA%B2%13%9A%1B%7Fua%A5%A3n%E17%B9%E5%9B%1Bm%AB%0B%08Q%FE%8A%E5%B1H%5Ee%CAO%82Q%D7u6%E6%90S%97%FCu%0B%CF2%94%EE%25v%12X%0C%BA%AC%F0%5E%F8*l%0AO%85%17%C2%97%BF%D4%C8%CE%DE%AD%11%CB%80q%2C%3E%AB%9ES%CD%C6%EC%25%D2L%D2%EBd%B8%BF%8A%F5B%C6%18%F9%901CZ%9D%BE%24M%9C%8A9%F2%DAP%0B'%06w%82%EB%E6%E2%5C%2F%D7%07%9E%BB%CC%5D%E1%FA%B9%08%AD.r%23%8E%C2%17%F5E%7C!%F0%BE3%BE%3E_%B7o%88a%A7%DB%BE%D3d%EB%A31Z%EB%BB%D3%91%BA%A2%B1z%94%8F%DB'%F6%3D%8E%AA%13%19%B2%B1%BE%B1~V%08%2B%B4%A2cjJ%B3tO%00%03%25mN%97%F3%05%93%EF%11%84%0B%7C%88%AE-%89%8F%ABbW%90O%2B%0Ao%99%0C%5E%97%0CI%AFH%D9.%B0%3B%8F%ED%03%B6S%D6%5D%E6i_s9%F3*p%E9%1B%FD%C3%EB.7U%06%5E%19%C0%D1s.%17%A03u%E4%09%B0%7C%5E%2C%EB%15%DB%1F%3C%9E%B7%80%91%3B%DBc%AD%3Dma%BA%8B%3EV%AB%DBt.%5B%1E%01%BB%0F%AB%D5%9F%CF%AA%D5%DD%E7%E4%7F%0Bx%A3%FC%06%A9%23%0A%D6%C2%A1_2%00%00%00%09pHYs%00%00%0B%13%00%00%0B%13%01%00%9A%9C%18%00%00%00%3AIDAT8%11c%FC%FF%FF%7F%18%03%1A%60%01%F2%3F%A0%891%80%04%FF%11-%F8%17%9BJ%E2%05%B1ZD%81v%26t%E7%80%F8%A3%82h%A12%1A%20%A3%01%02%0F%01%BA%25%06%00%19%C0%0D%AEF%D5%3ES%00%00%00%00IEND%AEB%60%82\");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;-moz-border-radius: 2px;-webkit-border-radius: 2px;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url(\"data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%11%00%00%00%09%08%06%00%00%00%D4%E8%C7%0C%00%00%03%1EiCCPICC%20Profile%00%00x%01%85T%DFk%D3P%14%FE%DAe%9D%B0%E1%8B%3Ag%11%09%3Eh%91ndStC%9C%B6kW%BA%CDZ%EA6%B7!H%9B%A6m%5C%9A%C6%24%ED~%B0%07%D9%8Bo%3A%C5w%F1%07%3E%F9%07%0C%D9%83o%7B%92%0D%C6%14a%F8%AC%88%22L%F6%22%B3%9E%9B4M'S%03%B9%F7%BB%DF%F9%EE9'%E7%E4%5E%A0%F9qZ%D3%14%2F%0F%14USO%C5%C2%FC%C4%E4%14%DF%F2%01%5E%1CC%2B%FChM%8B%86%16J%26G%40%0F%D3%B2y%EF%B3%F3%0E%1E%C6lt%EEo%DF%AB%FEc%D5%9A%95%0C%11%F0%1C%20%BE%945%C4%22%E1Y%A0i%5C%D4t%13%E0%D6%89%EF%9D15%C2%CDLsX%A7%04%09%1Fg8oc%81%E1%8C%8D%23%96f45%40%9A%09%C2%07%C5B%3AK%B8%408%98i%E0%F3%0D%D8%CE%81%14%E4'%26%A9%92.%8B%3C%ABER%2F%E5dE%B2%0C%F6%F0%1Fs%83%F2_%B0%A8%94%E9%9B%AD%E7%10%8Dm%9A%19N%D1%7C%8A%DE%1F9%7Dp%8C%E6%00%D5%C1%3F_%18%BDA%B8%9DpX6%E3%A35~B%CD%24%AE%11%26%BD%E7%EEti%98%EDe%9A%97Y)%12%25%1C%24%BCbT%AE3li%E6%0B%03%89%9A%E6%D3%ED%F4P%92%B0%9F4%BF43Y%F3%E3%EDP%95%04%EB1%C5%F5%F6KF%F4%BA%BD%D7%DB%91%93%07%E35%3E%A7)%D6%7F%40%FE%BD%F7%F5r%8A%E5y%92%F0%EB%B4%1E%8D%D5%F4%5B%92%3AV%DB%DB%E4%CD%A6%23%C3%C4wQ%3F%03HB%82%8E%1Cd(%E0%91B%0Ca%9Ac%C4%AA%F8L%16%19%22J%A4%D2itTy%B28%D6%3B(%93%96%ED%1CGx%C9_%0E%B8%5E%16%F5%5B%B2%B8%F6%E0%FB%9E%DD%25%D7%8E%BC%15%85%C5%B7%A3%D8Q%ED%B5%81%E9%BA%B2%13%9A%1B%7Fua%A5%A3n%E17%B9%E5%9B%1Bm%AB%0B%08Q%FE%8A%E5%B1H%5Ee%CAO%82Q%D7u6%E6%90S%97%FCu%0B%CF2%94%EE%25v%12X%0C%BA%AC%F0%5E%F8*l%0AO%85%17%C2%97%BF%D4%C8%CE%DE%AD%11%CB%80q%2C%3E%AB%9ES%CD%C6%EC%25%D2L%D2%EBd%B8%BF%8A%F5B%C6%18%F9%901CZ%9D%BE%24M%9C%8A9%F2%DAP%0B'%06w%82%EB%E6%E2%5C%2F%D7%07%9E%BB%CC%5D%E1%FA%B9%08%AD.r%23%8E%C2%17%F5E%7C!%F0%BE3%BE%3E_%B7o%88a%A7%DB%BE%D3d%EB%A31Z%EB%BB%D3%91%BA%A2%B1z%94%8F%DB'%F6%3D%8E%AA%13%19%B2%B1%BE%B1~V%08%2B%B4%A2cjJ%B3tO%00%03%25mN%97%F3%05%93%EF%11%84%0B%7C%88%AE-%89%8F%ABbW%90O%2B%0Ao%99%0C%5E%97%0CI%AFH%D9.%B0%3B%8F%ED%03%B6S%D6%5D%E6i_s9%F3*p%E9%1B%FD%C3%EB.7U%06%5E%19%C0%D1s.%17%A03u%E4%09%B0%7C%5E%2C%EB%15%DB%1F%3C%9E%B7%80%91%3B%DBc%AD%3Dma%BA%8B%3EV%AB%DBt.%5B%1E%01%BB%0F%AB%D5%9F%CF%AA%D5%DD%E7%E4%7F%0Bx%A3%FC%06%A9%23%0A%D6%C2%A1_2%00%00%00%09pHYs%00%00%0B%13%00%00%0B%13%01%00%9A%9C%18%00%00%00%B5IDAT(%15%A5%91%3D%0E%02!%10%85ac%E1%05%D6%CE%D6%C6%CE%D2%E8%ED%CD%DE%C0%C6%D6N.%E0V%F8%3D%9Ca%891XH%C2%BE%D9y%3F%90!%E6%9C%C3%BFk%E5%011%C6-%F5%C8N%04%DF%BD%FF%89%DFt%83DN%60%3E%F3%AB%A0%DE%1A%5Dg%BE%10Q%97%1B%40%9C%A8o%10%8F%5E%828%B4%1B%60%87%F6%02%26%85%1Ch%1E%C1%2B%5Bk%FF%86%EE%B7j%09%9A%DA%9B%ACe%A3%F9%EC%DA!9%B4%D5%A6%81%86%86%98%CC%3C%5B%40%FA%81%B3%E9%CB%23%94%C16Azo%05%D4%E1%C1%95a%3B%8A'%A0%E8%CC%17%22%85%1D%BA%00%A2%FA%DC%0A%94%D1%D1%8D%8B%3A%84%17B%C7%60%1A%25Z%FC%8D%00%00%00%00IEND%AEB%60%82\"),url(\"data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%05%00%00%007%08%06%00%00%00%C4%DD%80C%00%00%03%1EiCCPICC%20Profile%00%00x%01%85T%DFk%D3P%14%FE%DAe%9D%B0%E1%8B%3Ag%11%09%3Eh%91ndStC%9C%B6kW%BA%CDZ%EA6%B7!H%9B%A6m%5C%9A%C6%24%ED~%B0%07%D9%8Bo%3A%C5w%F1%07%3E%F9%07%0C%D9%83o%7B%92%0D%C6%14a%F8%AC%88%22L%F6%22%B3%9E%9B4M'S%03%B9%F7%BB%DF%F9%EE9'%E7%E4%5E%A0%F9qZ%D3%14%2F%0F%14USO%C5%C2%FC%C4%E4%14%DF%F2%01%5E%1CC%2B%FChM%8B%86%16J%26G%40%0F%D3%B2y%EF%B3%F3%0E%1E%C6lt%EEo%DF%AB%FEc%D5%9A%95%0C%11%F0%1C%20%BE%945%C4%22%E1Y%A0i%5C%D4t%13%E0%D6%89%EF%9D15%C2%CDLsX%A7%04%09%1Fg8oc%81%E1%8C%8D%23%96f45%40%9A%09%C2%07%C5B%3AK%B8%408%98i%E0%F3%0D%D8%CE%81%14%E4'%26%A9%92.%8B%3C%ABER%2F%E5dE%B2%0C%F6%F0%1Fs%83%F2_%B0%A8%94%E9%9B%AD%E7%10%8Dm%9A%19N%D1%7C%8A%DE%1F9%7Dp%8C%E6%00%D5%C1%3F_%18%BDA%B8%9DpX6%E3%A35~B%CD%24%AE%11%26%BD%E7%EEti%98%EDe%9A%97Y)%12%25%1C%24%BCbT%AE3li%E6%0B%03%89%9A%E6%D3%ED%F4P%92%B0%9F4%BF43Y%F3%E3%EDP%95%04%EB1%C5%F5%F6KF%F4%BA%BD%D7%DB%91%93%07%E35%3E%A7)%D6%7F%40%FE%BD%F7%F5r%8A%E5y%92%F0%EB%B4%1E%8D%D5%F4%5B%92%3AV%DB%DB%E4%CD%A6%23%C3%C4wQ%3F%03HB%82%8E%1Cd(%E0%91B%0Ca%9Ac%C4%AA%F8L%16%19%22J%A4%D2itTy%B28%D6%3B(%93%96%ED%1CGx%C9_%0E%B8%5E%16%F5%5B%B2%B8%F6%E0%FB%9E%DD%25%D7%8E%BC%15%85%C5%B7%A3%D8Q%ED%B5%81%E9%BA%B2%13%9A%1B%7Fua%A5%A3n%E17%B9%E5%9B%1Bm%AB%0B%08Q%FE%8A%E5%B1H%5Ee%CAO%82Q%D7u6%E6%90S%97%FCu%0B%CF2%94%EE%25v%12X%0C%BA%AC%F0%5E%F8*l%0AO%85%17%C2%97%BF%D4%C8%CE%DE%AD%11%CB%80q%2C%3E%AB%9ES%CD%C6%EC%25%D2L%D2%EBd%B8%BF%8A%F5B%C6%18%F9%901CZ%9D%BE%24M%9C%8A9%F2%DAP%0B'%06w%82%EB%E6%E2%5C%2F%D7%07%9E%BB%CC%5D%E1%FA%B9%08%AD.r%23%8E%C2%17%F5E%7C!%F0%BE3%BE%3E_%B7o%88a%A7%DB%BE%D3d%EB%A31Z%EB%BB%D3%91%BA%A2%B1z%94%8F%DB'%F6%3D%8E%AA%13%19%B2%B1%BE%B1~V%08%2B%B4%A2cjJ%B3tO%00%03%25mN%97%F3%05%93%EF%11%84%0B%7C%88%AE-%89%8F%ABbW%90O%2B%0Ao%99%0C%5E%97%0CI%AFH%D9.%B0%3B%8F%ED%03%B6S%D6%5D%E6i_s9%F3*p%E9%1B%FD%C3%EB.7U%06%5E%19%C0%D1s.%17%A03u%E4%09%B0%7C%5E%2C%EB%15%DB%1F%3C%9E%B7%80%91%3B%DBc%AD%3Dma%BA%8B%3EV%AB%DBt.%5B%1E%01%BB%0F%AB%D5%9F%CF%AA%D5%DD%E7%E4%7F%0Bx%A3%FC%06%A9%23%0A%D6%C2%A1_2%00%00%00%09pHYs%00%00%0B%13%00%00%0B%13%01%00%9A%9C%18%00%00%003IDAT8%11c%FC%FF%FF%7F%3E%03%1A%60%01%F2%3F%A3%891%80%04%FFQ%26%F8w%C0%B43%A1%DB%0C%E2%8F%0A%A2%85%CAh%80%8C%06%08%3C%04%E8%96%18%00%A3S%0D%CD%CF%D8%C1%9D%00%00%00%00IEND%AEB%60%82\");background-repeat: no-repeat, repeat-x;background-position: center center, top left;}.ace_gutter-tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;display: inline-block;max-width: 500px;padding: 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre-line;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url(\"data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%05%00%00%00%05%08%06%00%00%00%8Do%26%E5%00%00%004IDATx%DAe%8A%B1%0D%000%0C%C2%F2%2CK%96%BC%D0%8F9%81%88H%E9%D0%0E%96%C0%10%92%3E%02%80%5E%82%E4%A9*-%EEsw%C8%CC%11%EE%96w%D8%DC%E9*Eh%0C%151(%00%00%00%00IEND%AEB%60%82\");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url(\"data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%05%00%00%00%05%08%06%00%00%00%8Do%26%E5%00%00%004IDATx%DAm%C7%C1%09%000%08C%D1%8C%ECE%C8E(%8E%EC%02)%1EZJ%F1%C1'%04%07I%E1%E5%EE%CAL%F5%A2%99%99%22%E2%D6%1FU%B5%FE0%D9x%A7%26Wz5%0E%D5%00%00%00%00IEND%AEB%60%82\");}.ace_fold-widget.ace_closed {background-image: url(\"data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%03%00%00%00%06%08%06%00%00%00%06%E5%24%0C%00%00%009IDATx%DA5%CA%C1%09%000%08%03%C0%AC*(%3E%04%C1%0D%BA%B1%23%A4Uh%E0%20%81%C0%CC%F8%82%81%AA%A2%AArGfr%88%08%11%11%1C%DD%7D%E0%EE%5B%F6%F6%CB%B8%05Q%2F%E9tai%D9%00%00%00%00IEND%AEB%60%82\");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);-moz-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);-webkit-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);-moz-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);-webkit-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}/*** Dark version for fold widgets*/.ace_dark .ace_fold-widget {background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC\");}.ace_dark .ace_fold-widget.ace_end {background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==\");}.ace_dark .ace_fold-widget.ace_closed {background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==\");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {-moz-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);-webkit-box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-moz-transition: opacity 0.4s ease 0.05s;-webkit-transition: opacity 0.4s ease 0.05s;-o-transition: opacity 0.4s ease 0.05s;-ms-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-moz-transition: opacity 0.05s ease 0.05s;-webkit-transition: opacity 0.05s ease 0.05s;-o-transition: opacity 0.05s ease 0.05s;-ms-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}",
"ace_editor");var p=function(b,c){var d=this;this.container=b||e.createElement("div");this.$keepTextAreaAtCursor=true;e.addCssClass(this.container,"ace_editor");this.setTheme(c);this.$gutter=e.createElement("div");this.$gutter.className="ace_gutter";this.container.appendChild(this.$gutter);this.scroller=e.createElement("div");this.scroller.className="ace_scroller";this.container.appendChild(this.scroller);this.content=e.createElement("div");this.content.className="ace_content";this.scroller.appendChild(this.content);
this.$gutterLayer=new g(this.$gutter);this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this));this.$markerBack=new h(this.content);this.canvas=(this.$textLayer=new j(this.content)).element;this.$markerFront=new h(this.content);this.$cursorLayer=new k(this.content);this.$vScroll=this.$horizScroll=false;this.scrollBar=this.scrollBarV=new m(this.container,this);this.scrollBarH=new l(this.container,this);this.scrollBarV.addEventListener("scroll",function(b){d.$scrollAnimation||d.session.setScrollTop(b.data-
d.scrollMargin.top)});this.scrollBarH.addEventListener("scroll",function(b){d.$scrollAnimation||d.session.setScrollLeft(b.data-d.scrollMargin.left)});this.scrollLeft=this.scrollTop=0;this.cursorPos={row:0,column:0};this.$textLayer.addEventListener("changeCharacterSize",function(){d.updateCharacterSize();d.onResize(true,d.gutterWidth,d.$size.width,d.$size.height);d._signal("changeCharacterSize")});this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:true};this.layerConfig={width:1,
padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1};this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0};this.$loop=new n(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView);this.$loop.schedule(this.CHANGE_FULL);this.updateCharacterSize();this.setPadding(4);f.resetOptions(this);f._emit("renderer",this)};(function(){this.CHANGE_CURSOR=1;this.CHANGE_MARKER=2;this.CHANGE_GUTTER=4;this.CHANGE_SCROLL=8;this.CHANGE_LINES=
16;this.CHANGE_TEXT=32;this.CHANGE_SIZE=64;this.CHANGE_MARKER_BACK=128;this.CHANGE_MARKER_FRONT=256;this.CHANGE_FULL=512;this.CHANGE_H_SCROLL=1024;d.implement(this,q);this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts));this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth();this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight();
this.$updatePrintMargin()};this.setSession=function(b){this.session=b;this.scrollMargin.top&&b.getScrollTop()<=0&&b.setScrollTop(-this.scrollMargin.top);this.$cursorLayer.setSession(b);this.$markerBack.setSession(b);this.$markerFront.setSession(b);this.$gutterLayer.setSession(b);this.$textLayer.setSession(b);this.$loop.schedule(this.CHANGE_FULL)};this.updateLines=function(b,c){c===void 0&&(c=Infinity);this.$changedLines?(this.$changedLines.firstRow>b&&(this.$changedLines.firstRow=b),this.$changedLines.lastRow<
c&&(this.$changedLines.lastRow=c)):this.$changedLines={firstRow:b,lastRow:c};this.$changedLines.firstRow>this.layerConfig.lastRow||this.$changedLines.lastRow<this.layerConfig.firstRow||this.$loop.schedule(this.CHANGE_LINES)};this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER);this.$textLayer.onChangeTabSize()};this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)};this.updateFull=function(b){b?this.$renderChanges(this.CHANGE_FULL,true):this.$loop.schedule(this.CHANGE_FULL)};
this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()};this.$changes=0;this.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=true:this.onResize()};this.onResize=function(b,c,d,e){if(!(this.resizing>2)){this.resizing>0?this.resizing++:this.resizing=b?1:0;var f=this.container;e||(e=f.clientHeight||f.scrollHeight);d||(d=f.clientWidth||f.scrollWidth);c=this.$updateCachedSize(b,c,d,e);if(!this.$size.scrollerHeight||!d&&!e)return this.resizing=0;b&&(this.$gutterLayer.$padding=
null);b?this.$renderChanges(c|this.$changes,true):this.$loop.schedule(c|this.$changes);this.resizing&&(this.resizing=0)}};this.$updateCachedSize=function(b,c,d,e){var e=e-(this.$extraHeight||0),f=0,g=this.$size,h={width:g.width,height:g.height,scrollerHeight:g.scrollerHeight,scrollerWidth:g.scrollerWidth};e&&(b||g.height!=e)&&(g.height=e,f=this.CHANGE_SIZE,g.scrollerHeight=g.height,this.$horizScroll&&(g.scrollerHeight=g.scrollerHeight-this.scrollBarH.getHeight()),this.scrollBarV.element.style.bottom=
this.scrollBarH.getHeight()+"px",this.session&&(f=f|this.CHANGE_SCROLL));if(d&&(b||g.width!=d)){f=this.CHANGE_SIZE;g.width=d;c==null&&(c=this.$showGutter?this.$gutter.offsetWidth:0);this.gutterWidth=c;this.scrollBarH.element.style.left=this.scroller.style.left=c+"px";g.scrollerWidth=Math.max(0,d-c-this.scrollBarV.getWidth());this.scrollBarH.element.style.right=this.scroller.style.right=this.scrollBarV.getWidth()+"px";this.scroller.style.bottom=this.scrollBarH.getHeight()+"px";if(this.session&&this.session.getUseWrapMode()&&
this.adjustWrapLimit()||b)f=f|this.CHANGE_FULL}return g.$dirty=!d||!e,f&&this._signal("resize",h),f};this.onGutterResize=function(){var b=this.$showGutter?this.$gutter.offsetWidth:0;b!=this.gutterWidth&&(this.$changes=this.$changes|this.$updateCachedSize(true,b,this.$size.width,this.$size.height));this.session.getUseWrapMode()&&this.adjustWrapLimit()?this.$loop.schedule(this.CHANGE_FULL):this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):(this.$computeLayerConfig(),this.$loop.schedule(this.CHANGE_MARKER))};
this.adjustWrapLimit=function(){return this.session.adjustWrapLimit(Math.floor((this.$size.scrollerWidth-this.$padding*2)/this.characterWidth),this.$showPrintMargin&&this.$printMarginColumn)};this.setAnimatedScroll=function(b){this.setOption("animatedScroll",b)};this.getAnimatedScroll=function(){return this.$animatedScroll};this.setShowInvisibles=function(b){this.setOption("showInvisibles",b)};this.getShowInvisibles=function(){return this.getOption("showInvisibles")};this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")};
this.setDisplayIndentGuides=function(b){this.setOption("displayIndentGuides",b)};this.setShowPrintMargin=function(b){this.setOption("showPrintMargin",b)};this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")};this.setPrintMarginColumn=function(b){this.setOption("printMarginColumn",b)};this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")};this.getShowGutter=function(){return this.getOption("showGutter")};this.setShowGutter=function(b){return this.setOption("showGutter",
b)};this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")};this.setFadeFoldWidgets=function(b){this.setOption("fadeFoldWidgets",b)};this.setHighlightGutterLine=function(b){this.setOption("highlightGutterLine",b)};this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")};this.$updateGutterLineHighlight=function(){var b=this.$cursorLayer.$pixelPos,c=this.layerConfig.lineHeight;if(this.session.getUseWrapMode()){var d=this.session.selection.getCursor();
d.column=0;b=this.$cursorLayer.getPixelPosition(d,true);c=c*this.session.getRowLength(d.row)}this.$gutterLineHighlight.style.top=b.top-this.layerConfig.offset+"px";this.$gutterLineHighlight.style.height=c+"px"};this.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var b=e.createElement("div");b.className="ace_layer ace_print-margin-layer";this.$printMarginEl=e.createElement("div");this.$printMarginEl.className="ace_print-margin";b.appendChild(this.$printMarginEl);
this.content.insertBefore(b,this.content.firstChild)}b=this.$printMarginEl.style;b.left=this.characterWidth*this.$printMarginColumn+this.$padding+"px";b.visibility=this.$showPrintMargin?"visible":"hidden";this.session&&this.session.$wrap==-1&&this.adjustWrapLimit()}};this.getContainerElement=function(){return this.container};this.getMouseEventTarget=function(){return this.content};this.getTextAreaContainer=function(){return this.container};this.$moveTextAreaToCursor=function(){if(this.$keepTextAreaAtCursor){var b=
this.layerConfig,c=this.$cursorLayer.$pixelPos.top,d=this.$cursorLayer.$pixelPos.left,c=c-b.offset,e=this.lineHeight;if(!(c<0||c>b.height-e)){b=this.characterWidth;if(this.$composition)var f=this.textarea.value.replace(/^\x01+/,""),b=b*(this.session.$getStringScreenWidth(f)[0]+2),e=e+2,c=c-1;d=d-this.scrollLeft;d>this.$size.scrollerWidth-b&&(d=this.$size.scrollerWidth-b);d=d-this.scrollBar.width;this.textarea.style.height=e+"px";this.textarea.style.width=b+"px";this.textarea.style.right=Math.max(0,
this.$size.scrollerWidth-d-b)+"px";this.textarea.style.bottom=Math.max(0,this.$size.height-c-e)+"px"}}};this.getFirstVisibleRow=function(){return this.layerConfig.firstRow};this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(this.layerConfig.offset===0?0:1)};this.getLastFullyVisibleRow=function(){return this.layerConfig.firstRow-1+Math.floor((this.layerConfig.height+this.layerConfig.offset)/this.layerConfig.lineHeight)};this.getLastVisibleRow=function(){return this.layerConfig.lastRow};
this.$padding=null;this.setPadding=function(b){this.$padding=b;this.$textLayer.setPadding(b);this.$cursorLayer.setPadding(b);this.$markerFront.setPadding(b);this.$markerBack.setPadding(b);this.$loop.schedule(this.CHANGE_FULL);this.$updatePrintMargin()};this.setScrollMargin=function(b,c,d,e){var f=this.scrollMargin;f.top=b|0;f.bottom=c|0;f.right=e|0;f.left=d|0;f.v=f.top+f.bottom;f.h=f.left+f.right;f.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(f.top);this.updateFull()};this.getHScrollBarAlwaysVisible=
function(){return this.$hScrollBarAlwaysVisible};this.setHScrollBarAlwaysVisible=function(b){this.setOption("hScrollBarAlwaysVisible",b)};this.getVScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible};this.setVScrollBarAlwaysVisible=function(b){this.setOption("vScrollBarAlwaysVisible",b)};this.$updateScrollBarV=function(){this.scrollBarV.setScrollHeight(this.layerConfig.maxHeight+this.scrollMargin.v);this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)};this.$updateScrollBarH=
function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h);this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)};this.$frozen=false;this.freeze=function(){this.$frozen=true};this.unfreeze=function(){this.$frozen=false};this.$renderChanges=function(b,c){this.$changes&&(b=b|this.$changes,this.$changes=0);if(!this.session||!this.container.offsetWidth||this.$frozen||!b&&!c)this.$changes=this.$changes|b;else{if(this.$size.$dirty)return this.$changes=
this.$changes|b,this.onResize(true);this.lineHeight||this.$textLayer.checkForSizeChanges();this._signal("beforeRender");var d=this.layerConfig;if(b&this.CHANGE_FULL||b&this.CHANGE_SIZE||b&this.CHANGE_TEXT||b&this.CHANGE_LINES||b&this.CHANGE_SCROLL||b&this.CHANGE_H_SCROLL){b=b|this.$computeLayerConfig();d=this.layerConfig;this.$updateScrollBarV();b&this.CHANGE_H_SCROLL&&this.$updateScrollBarH();this.$gutterLayer.element.style.marginTop=-d.offset+"px";this.content.style.marginTop=-d.offset+"px";this.content.style.width=
d.width+2*this.$padding+"px";this.content.style.height=d.minHeight+"px"}b&this.CHANGE_H_SCROLL&&(this.content.style.marginLeft=-this.scrollLeft+"px",this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left");if(b&this.CHANGE_FULL){this.$textLayer.update(d);this.$showGutter&&this.$gutterLayer.update(d);this.$markerBack.update(d);this.$markerFront.update(d);this.$cursorLayer.update(d);this.$moveTextAreaToCursor();this.$highlightGutterLine&&this.$updateGutterLineHighlight()}else if(b&
this.CHANGE_SCROLL){b&this.CHANGE_TEXT||b&this.CHANGE_LINES?this.$textLayer.update(d):this.$textLayer.scrollLines(d);this.$showGutter&&this.$gutterLayer.update(d);this.$markerBack.update(d);this.$markerFront.update(d);this.$cursorLayer.update(d);this.$highlightGutterLine&&this.$updateGutterLineHighlight();this.$moveTextAreaToCursor()}else{b&this.CHANGE_TEXT?(this.$textLayer.update(d),this.$showGutter&&this.$gutterLayer.update(d)):b&this.CHANGE_LINES?(this.$updateLines()||b&this.CHANGE_GUTTER&&this.$showGutter)&&
this.$gutterLayer.update(d):(b&this.CHANGE_TEXT||b&this.CHANGE_GUTTER)&&this.$showGutter&&this.$gutterLayer.update(d);b&this.CHANGE_CURSOR&&(this.$cursorLayer.update(d),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight());b&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(d);b&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(d)}this._signal("afterRender")}};this.$autosize=function(){var b=this.session.getScreenLength()*
this.lineHeight,c=this.$maxLines*this.lineHeight,d=Math.max((this.$minLines||1)*this.lineHeight,Math.min(c,b))+this.scrollMargin.v+(this.$extraHeight||0),b=b>c;if(d!=this.desiredHeight||this.$size.height!=this.desiredHeight||b!=this.$vScroll){b!=this.$vScroll&&(this.$vScroll=b,this.scrollBarV.setVisible(b));b=this.container.clientWidth;this.container.style.height=d+"px";this.$updateCachedSize(true,this.$gutterWidth,b,d);this.desiredHeight=d}};this.$computeLayerConfig=function(){this.$maxLines&&this.lineHeight>
1&&this.$autosize();var b=this.session,c=this.$size.height<=2*this.lineHeight,d=this.session.getScreenLength()*this.lineHeight,e=this.scrollTop%this.lineHeight,f=this.$size.scrollerHeight+this.lineHeight,g=this.$getLongestLine(),h=!c&&(this.$hScrollBarAlwaysVisible||this.$size.scrollerWidth-g-2*this.$padding<0),j=this.$horizScroll!==h;j&&(this.$horizScroll=h,this.scrollBarH.setVisible(h));!this.$maxLines&&this.$scrollPastEnd&&this.scrollTop>d-this.$size.scrollerHeight&&(d=d+Math.min((this.$size.scrollerHeight-
this.lineHeight)*this.$scrollPastEnd,this.scrollTop-d+this.$size.scrollerHeight));h=!c&&(this.$vScrollBarAlwaysVisible||this.$size.scrollerHeight-d<0);(c=this.$vScroll!==h)&&(this.$vScroll=h,this.scrollBarV.setVisible(h));this.session.setScrollTop(Math.max(-this.scrollMargin.top,Math.min(this.scrollTop,d-this.$size.scrollerHeight+this.scrollMargin.v)));this.session.setScrollLeft(Math.max(-this.scrollMargin.left,Math.min(this.scrollLeft,g+2*this.$padding-this.$size.scrollerWidth+this.scrollMargin.h)));
var f=Math.ceil(f/this.lineHeight)-1,h=Math.max(0,Math.round((this.scrollTop-e)/this.lineHeight)),k=h+f,l,m=this.lineHeight,h=b.screenToDocumentRow(h,0);(e=b.getFoldLine(h))&&(h=e.start.row);l=b.documentToScreenRow(h,0);e=b.getRowLength(h)*m;k=Math.min(b.screenToDocumentRow(k,0),b.getLength()-1);f=this.$size.scrollerHeight+b.getRowLength(k)*m+e;e=this.scrollTop-l*m;b=0;if(j||c){b=this.$updateCachedSize(true,this.gutterWidth,this.$size.width,this.$size.height);this._signal("scrollbarVisibilityChanged");
c&&(g=this.$getLongestLine())}return this.layerConfig={width:g,padding:this.$padding,firstRow:h,firstRowScreen:l,lastRow:k,lineHeight:m,characterWidth:this.characterWidth,minHeight:f,maxHeight:d,offset:e,height:this.$size.scrollerHeight},b};this.$updateLines=function(){var b=this.$changedLines.firstRow,c=this.$changedLines.lastRow;this.$changedLines=null;var d=this.layerConfig;if(!(b>d.lastRow+1)&&!(c<d.firstRow))if(c===Infinity){this.$showGutter&&this.$gutterLayer.update(d);this.$textLayer.update(d)}else return this.$textLayer.updateLines(d,
b,c),true};this.$getLongestLine=function(){var b=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(b=b+1),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(b*this.characterWidth))};this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(true));this.$loop.schedule(this.CHANGE_MARKER_FRONT)};this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers());this.$loop.schedule(this.CHANGE_MARKER_BACK)};
this.addGutterDecoration=function(b,c){this.$gutterLayer.addGutterDecoration(b,c)};this.removeGutterDecoration=function(b,c){this.$gutterLayer.removeGutterDecoration(b,c)};this.updateBreakpoints=function(){this.$loop.schedule(this.CHANGE_GUTTER)};this.setAnnotations=function(b){this.$gutterLayer.setAnnotations(b);this.$loop.schedule(this.CHANGE_GUTTER)};this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)};this.hideCursor=function(){this.$cursorLayer.hideCursor()};this.showCursor=
function(){this.$cursorLayer.showCursor()};this.scrollSelectionIntoView=function(b,c,d){this.scrollCursorIntoView(b,d);this.scrollCursorIntoView(c,d)};this.scrollCursorIntoView=function(b,c){if(this.$size.scrollerHeight!==0){var d=this.$cursorLayer.getPixelPosition(b),e=d.left,d=d.top,f=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;f>d?(c&&(d=d-c*this.$size.scrollerHeight),d==0?d=-this.scrollMargin.top:d==0&&(d=+this.scrollMargin.bottom),this.session.setScrollTop(d)):f+this.$size.scrollerHeight<
d+this.lineHeight&&(c&&(d=d+c*this.$size.scrollerHeight),this.session.setScrollTop(d+this.lineHeight-this.$size.scrollerHeight));d=this.scrollLeft;d>e?(e<this.$padding+2*this.layerConfig.characterWidth&&(e=-this.scrollMargin.left),this.session.setScrollLeft(e)):d+this.$size.scrollerWidth<e+this.characterWidth?this.session.setScrollLeft(Math.round(e+this.characterWidth-this.$size.scrollerWidth)):d<=this.$padding&&e-d<this.characterWidth&&this.session.setScrollLeft(0)}};this.getScrollTop=function(){return this.session.getScrollTop()};
this.getScrollLeft=function(){return this.session.getScrollLeft()};this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight};this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)};this.scrollToRow=function(b){this.session.setScrollTop(b*this.lineHeight)};this.alignCursor=function(b,c){typeof b=="number"&&(b={row:b,column:0});var d=this.$size.scrollerHeight-this.lineHeight,d=this.$cursorLayer.getPixelPosition(b).top-
d*(c||0);return this.session.setScrollTop(d),d};this.STEPS=8;this.$calcSteps=function(b,c){for(var d=0,e=this.STEPS,f=[],d=0;d<e;++d)f.push((c-b)*(Math.pow(d/this.STEPS-1,3)+1)+b);return f};this.scrollToLine=function(b,c,d,e){b=this.$cursorLayer.getPixelPosition({row:b,column:0}).top;c&&(b=b-this.$size.scrollerHeight/2);c=this.scrollTop;this.session.setScrollTop(b);d!==false&&this.animateScrolling(c,e)};this.animateScrolling=function(b,c){var d=this.scrollTop;if(this.$animatedScroll){var e=this;if(b!=
d){if(this.$scrollAnimation){var f=this.$scrollAnimation.steps;if(f.length){b=f[0];if(b==d)return}}var g=e.$calcSteps(b,d);this.$scrollAnimation={from:b,to:d,steps:g};clearInterval(this.$timer);e.session.setScrollTop(g.shift());e.session.$scrollTop=d;this.$timer=setInterval(function(){g.length?(e.session.setScrollTop(g.shift()),e.session.$scrollTop=d):d!=null?(e.session.$scrollTop=-1,e.session.setScrollTop(d),d=null):(e.$timer=clearInterval(e.$timer),e.$scrollAnimation=null,c&&c())},10)}}};this.scrollToY=
function(b){this.scrollTop!==b&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=b)};this.scrollToX=function(b){this.scrollLeft!==b&&(this.scrollLeft=b);this.$loop.schedule(this.CHANGE_H_SCROLL)};this.scrollTo=function(b,c){this.session.setScrollTop(c);this.session.setScrollLeft(c)};this.scrollBy=function(b,c){c&&this.session.setScrollTop(this.session.getScrollTop()+c);b&&this.session.setScrollLeft(this.session.getScrollLeft()+b)};this.isScrollableBy=function(b,c){if(c<0&&this.session.getScrollTop()>=
1-this.scrollMargin.top||c>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight-(this.$size.scrollerHeight-this.lineHeight)*this.$scrollPastEnd<-1+this.scrollMargin.bottom||b<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left||b>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right)return true};this.pixelToScreenCoordinates=function(b,c){var d=this.scroller.getBoundingClientRect(),e=(b+this.scrollLeft-d.left-
this.$padding)/this.characterWidth,d=Math.floor((c+this.scrollTop-d.top)/this.lineHeight),f=Math.round(e);return{row:d,column:f,side:e-f>0?1:-1}};this.screenToTextCoordinates=function(b,c){var d=this.scroller.getBoundingClientRect(),e=Math.round((b+this.scrollLeft-d.left-this.$padding)/this.characterWidth);return this.session.screenToDocumentPosition((c+this.scrollTop-d.top)/this.lineHeight,Math.max(e,0))};this.textToScreenCoordinates=function(b,c){var d=this.scroller.getBoundingClientRect(),e=this.session.documentToScreenPosition(b,
c),f=this.$padding+Math.round(e.column*this.characterWidth);return{pageX:d.left+f-this.scrollLeft,pageY:d.top+e.row*this.lineHeight-this.scrollTop}};this.visualizeFocus=function(){e.addCssClass(this.container,"ace_focus")};this.visualizeBlur=function(){e.removeCssClass(this.container,"ace_focus")};this.showComposition=function(){this.$composition||(this.$composition={keepTextAreaAtCursor:this.$keepTextAreaAtCursor,cssText:this.textarea.style.cssText});this.$keepTextAreaAtCursor=true;e.addCssClass(this.textarea,
"ace_composition");this.textarea.style.cssText="";this.$moveTextAreaToCursor()};this.setCompositionText=function(){this.$moveTextAreaToCursor()};this.hideComposition=function(){if(this.$composition){e.removeCssClass(this.textarea,"ace_composition");this.$keepTextAreaAtCursor=this.$composition.keepTextAreaAtCursor;this.textarea.style.cssText=this.$composition.cssText;this.$composition=null}};this.setTheme=function(b,c){function d(f){if(g.$themeId!=b)return c&&c();if(f.cssClass){e.importCssString(f.cssText,
f.cssClass,g.container.ownerDocument);g.theme&&e.removeCssClass(g.container,g.theme.cssClass);var h="padding"in f?f.padding:"padding"in(g.theme||{})?4:g.$padding;g.$padding&&h!=g.$padding&&g.setPadding(h);g.$theme=f.cssClass;g.theme=f;e.addCssClass(g.container,f.cssClass);e.setCssClass(g.container,"ace_dark",f.isDark);g.$size&&(g.$size.width=0,g.$updateSizeAsync());g._dispatchEvent("themeLoaded",{theme:f});c&&c()}}var g=this;this.$themeId=b;g._dispatchEvent("themeChange",{theme:b});!b||typeof b==
"string"?f.loadModule(["theme",b||this.$options.theme.initialValue],d):d(b)};this.getTheme=function(){return this.$themeId};this.setStyle=function(b,c){e.setCssClass(this.container,b,c!==false)};this.unsetStyle=function(b){e.removeCssClass(this.container,b)};this.setCursorStyle=function(b){this.content.style.cursor!=b&&(this.content.style.cursor=b)};this.setMouseCursor=function(b){this.content.style.cursor=b};this.destroy=function(){this.$textLayer.destroy();this.$cursorLayer.destroy()}}).call(p.prototype);
f.defineOptions(p.prototype,"renderer",{animatedScroll:{initialValue:false},showInvisibles:{set:function(b){this.$textLayer.setShowInvisibles(b)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:false},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:true},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(b){typeof b=="number"&&(this.$printMarginColumn=b);this.$showPrintMargin=!!b;this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&
this.$printMarginColumn}},showGutter:{set:function(b){this.$gutter.style.display=b?"block":"none";this.onGutterResize()},initialValue:true},fadeFoldWidgets:{set:function(b){e.setCssClass(this.$gutter,"ace_fade-fold-widgets",b)},initialValue:false},showFoldWidgets:{set:function(b){this.$gutterLayer.setShowFoldWidgets(b)},initialValue:true},displayIndentGuides:{set:function(b){this.$textLayer.setDisplayIndentGuides(b)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:true},highlightGutterLine:{set:function(b){if(this.$gutterLineHighlight){this.$gutterLineHighlight.style.display=
b?"":"none";this.$cursorLayer.$pixelPos&&this.$updateGutterLineHighlight()}else{this.$gutterLineHighlight=e.createElement("div");this.$gutterLineHighlight.className="ace_gutter-active-line";this.$gutter.appendChild(this.$gutterLineHighlight)}},initialValue:false,value:true},hScrollBarAlwaysVisible:{set:function(){(!this.$hScrollBarAlwaysVisible||!this.$horizScroll)&&this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:false},vScrollBarAlwaysVisible:{set:function(){(!this.$vScrollBarAlwaysVisible||
!this.$vScroll)&&this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:false},fontSize:{set:function(b){typeof b=="number"&&(b=b+"px");this.container.style.fontSize=b;this.updateFontSize()},initialValue:12},fontFamily:{set:function(b){this.container.style.fontFamily=b;this.updateFontSize()}},maxLines:{set:function(){this.updateFull()}},minLines:{set:function(){this.updateFull()}},scrollPastEnd:{set:function(b){b=+b||0;if(this.$scrollPastEnd!=b){this.$scrollPastEnd=b;this.$loop.schedule(this.CHANGE_SCROLL)}},
initialValue:0,handlesSet:true},fixedWidthGutter:{set:function(b){this.$gutterLayer.$fixedWidth=!!b;this.$loop.schedule(this.CHANGE_GUTTER)}},theme:{set:function(b){this.setTheme(b)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:true}});c.VirtualRenderer=p});
ace.define("ace/layer/gutter","require exports module ace/lib/dom ace/lib/oop ace/lib/lang ace/lib/event_emitter".split(" "),function(b,c){var d=b("../lib/dom"),e=b("../lib/oop"),f=b("../lib/lang"),g=b("../lib/event_emitter").EventEmitter,h=function(b){this.element=d.createElement("div");this.element.className="ace_layer ace_gutter-layer";b.appendChild(this.element);this.setShowFoldWidgets(this.$showFoldWidgets);this.gutterWidth=0;this.$annotations=[];this.$updateAnnotations=this.$updateAnnotations.bind(this);
this.$cells=[]};(function(){e.implement(this,g);this.setSession=function(b){this.session&&this.session.removeEventListener("change",this.$updateAnnotations);this.session=b;b.on("change",this.$updateAnnotations)};this.addGutterDecoration=function(b,c){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration");this.session.addGutterDecoration(b,c)};this.removeGutterDecoration=function(b,c){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration");
this.session.removeGutterDecoration(b,c)};this.setAnnotations=function(b){this.$annotations=[];for(var c=0;c<b.length;c++){var d=b[c],e=d.row,g=this.$annotations[e];g||(g=this.$annotations[e]={text:[]});e=(e=d.text)?f.escapeHTML(e):d.html||"";g.text.indexOf(e)===-1&&g.text.push(e);d=d.type;d=="error"?g.className=" ace_error":d=="warning"&&g.className!=" ace_error"?g.className=" ace_warning":d=="info"&&!g.className&&(g.className=" ace_info")}};this.$updateAnnotations=function(b){if(this.$annotations.length){var c=
b.data,d=c.range,b=d.start.row,d=d.end.row-b;if(d!==0)if(c.action=="removeText"||c.action=="removeLines")this.$annotations.splice(b,d+1,null);else{c=Array(d+1);c.unshift(b,1);this.$annotations.splice.apply(this.$annotations,c)}}};this.update=function(b){for(var c=b.firstRow,e=b.lastRow,f=this.session,g=f.getNextFoldLine(c),h=g?g.start.row:Infinity,p=this.$showFoldWidgets&&f.foldWidgets,s=f.$breakpoints,r=f.$decorations,o=f.$firstLineNumber,t=0,u=f.gutterRenderer,w=null,z=-1;;){c>h&&(c=g.end.row+1,
g=f.getNextFoldLine(c,g),h=g?g.start.row:Infinity);if(c>e){for(;this.$cells.length>z+1;){w=this.$cells.pop();this.element.removeChild(w.element)}break}(w=this.$cells[++z])||(w={element:null,textNode:null,foldWidget:null},w.element=d.createElement("div"),w.textNode=document.createTextNode(""),w.element.appendChild(w.textNode),this.element.appendChild(w.element),this.$cells[z]=w);t="ace_gutter-cell ";s[c]&&(t=t+s[c]);r[c]&&(t=t+r[c]);this.$annotations[c]&&(t=t+this.$annotations[c].className);w.element.className!=
t&&(w.element.className=t);t=f.getRowLength(c)*b.lineHeight+"px";t!=w.element.style.height&&(w.element.style.height=t);if(p){var A=p[c];A==null&&(A=p[c]=f.getFoldWidget(c))}if(A){w.foldWidget||(w.foldWidget=d.createElement("span"),w.element.appendChild(w.foldWidget));t="ace_fold-widget ace_"+A;A=="start"&&c==h&&c<g.end.row?t=t+" ace_closed":t=t+" ace_open";w.foldWidget.className!=t&&(w.foldWidget.className=t);t=b.lineHeight+"px";w.foldWidget.style.height!=t&&(w.foldWidget.style.height=t)}else w.foldWidget&&
(w.element.removeChild(w.foldWidget),w.foldWidget=null);var C=t=u?u.getText(f,c):c+o;C!=w.textNode.data&&(w.textNode.data=C);c++}this.element.style.height=b.minHeight+"px";if(this.$fixedWidth||f.$useWrapMode)t=f.getLength()+o;b=u?u.getWidth(f,t,b):t.toString().length*b.characterWidth;e=this.$padding||this.$computePadding();b=b+(e.left+e.right);b!==this.gutterWidth&&!isNaN(b)&&(this.gutterWidth=b,this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._emit("changeGutterWidth",b))};this.$fixedWidth=
false;this.$showFoldWidgets=true;this.setShowFoldWidgets=function(b){b?d.addCssClass(this.element,"ace_folding-enabled"):d.removeCssClass(this.element,"ace_folding-enabled");this.$showFoldWidgets=b;this.$padding=null};this.getShowFoldWidgets=function(){return this.$showFoldWidgets};this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var b=d.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=parseInt(b.paddingLeft)+1||0,this.$padding.right=
parseInt(b.paddingRight)||0,this.$padding};this.getRegion=function(b){var c=this.$padding||this.$computePadding(),d=this.element.getBoundingClientRect();if(b.x<c.left+d.left)return"markers";if(this.$showFoldWidgets&&b.x>d.right-c.right)return"foldWidgets"}}).call(h.prototype);c.Gutter=h});
ace.define("ace/layer/marker",["require","exports","module","ace/range","ace/lib/dom"],function(b,c){var d=b("../range").Range,e=b("../lib/dom"),f=function(b){this.element=e.createElement("div");this.element.className="ace_layer ace_marker-layer";b.appendChild(this.element)};(function(){this.$padding=0;this.setPadding=function(b){this.$padding=b};this.setSession=function(b){this.session=b};this.setMarkers=function(b){this.markers=b};this.update=function(b){if(b=b||this.config){this.config=b;var c=
[],d;for(d in this.markers){var f=this.markers[d];if(f.range){var l=f.range.clipRows(b.firstRow,b.lastRow);if(!l.isEmpty())if(l=l.toScreenRange(this.session),f.renderer){var m=this.$getTop(l.start.row,b);f.renderer(c,l,this.$padding+l.start.column*b.characterWidth,m,b)}else"fullLine"==f.type?this.drawFullLineMarker(c,l,f.clazz,b):"screenLine"==f.type?this.drawScreenLineMarker(c,l,f.clazz,b):l.isMultiLine()?"text"==f.type?this.drawTextMarker(c,l,f.clazz,b):this.drawMultiLineMarker(c,l,f.clazz,b):this.drawSingleLineMarker(c,
l,f.clazz+" ace_start",b)}else f.update(c,this,this.session,b)}this.element=e.setInnerHtml(this.element,c.join(""))}};this.$getTop=function(b,c){return(b-c.firstRowScreen)*c.lineHeight};this.drawTextMarker=function(b,c,e,f,l){var m=c.start.row,n=new d(m,c.start.column,m,this.session.getScreenLastRowColumn(m));this.drawSingleLineMarker(b,n,e+" ace_start",f,1,l);m=c.end.row;n=new d(m,0,m,c.end.column);this.drawSingleLineMarker(b,n,e,f,0,l);for(m=c.start.row+1;m<c.end.row;m++)n.start.row=m,n.end.row=
m,n.end.column=this.session.getScreenLastRowColumn(m),this.drawSingleLineMarker(b,n,e,f,1,l)};this.drawMultiLineMarker=function(b,c,d,e,f){var m=this.$padding,n=e.lineHeight,q=this.$getTop(c.start.row,e),p=m+c.start.column*e.characterWidth,f=f||"";b.push("<div class='",d," ace_start' style='","height:",n,"px;","right:0;","top:",q,"px;","left:",p,"px;",f,"'></div>");q=this.$getTop(c.end.row,e);b.push("<div class='",d,"' style='","height:",n,"px;","width:",c.end.column*e.characterWidth,"px;","top:",
q,"px;","left:",m,"px;",f,"'></div>");n=(c.end.row-c.start.row-1)*e.lineHeight;0>n||(q=this.$getTop(c.start.row+1,e),b.push("<div class='",d,"' style='","height:",n,"px;","right:0;","top:",q,"px;","left:",m,"px;",f,"'></div>"))};this.drawSingleLineMarker=function(b,c,d,e,f,m){var n=e.lineHeight,f=(c.end.column+(f||0)-c.start.column)*e.characterWidth,q=this.$getTop(c.start.row,e);b.push("<div class='",d,"' style='","height:",n,"px;","width:",f,"px;","top:",q,"px;","left:",this.$padding+c.start.column*
e.characterWidth,"px;",m||"","'></div>")};this.drawFullLineMarker=function(b,c,d,e,f){var m=this.$getTop(c.start.row,e),n=e.lineHeight;c.start.row!=c.end.row&&(n+=this.$getTop(c.end.row,e)-m);b.push("<div class='",d,"' style='","height:",n,"px;","top:",m,"px;","left:0;right:0;",f||"","'></div>")};this.drawScreenLineMarker=function(b,c,d,e,f){c=this.$getTop(c.start.row,e);b.push("<div class='",d,"' style='","height:",e.lineHeight,"px;","top:",c,"px;","left:0;right:0;",f||"","'></div>")}}).call(f.prototype);
c.Marker=f});
ace.define("ace/layer/text","require exports module ace/lib/oop ace/lib/dom ace/lib/lang ace/lib/useragent ace/lib/event_emitter".split(" "),function(b,c){var d=b("../lib/oop"),e=b("../lib/dom"),f=b("../lib/lang"),g=b("../lib/useragent"),h=b("../lib/event_emitter").EventEmitter,j=function(b){this.element=e.createElement("div");this.element.className="ace_layer ace_text-layer";b.appendChild(this.element);this.$characterSize={width:0,height:0};this.checkForSizeChanges();this.$pollSizeChanges()};(function(){d.implement(this,
h);this.EOF_CHAR="\u00b6";this.EOL_CHAR="\u00ac";this.TAB_CHAR="\u2192";this.SPACE_CHAR="\u00b7";this.$padding=0;this.setPadding=function(b){this.$padding=b;this.element.style.padding="0 "+b+"px"};this.getLineHeight=function(){return this.$characterSize.height||0};this.getCharacterWidth=function(){return this.$characterSize.width||0};this.checkForSizeChanges=function(){var b=this.$measureSizes();if(b&&(this.$characterSize.width!==b.width||this.$characterSize.height!==b.height)){this.$measureNode.style.fontWeight=
"bold";var c=this.$measureSizes();this.$measureNode.style.fontWeight="";this.$characterSize=b;this.allowBoldFonts=c&&c.width===b.width&&c.height===b.height;this._emit("changeCharacterSize",{data:b})}};this.$pollSizeChanges=function(){var b=this;this.$pollSizeChangesTimer=setInterval(function(){b.checkForSizeChanges()},500)};this.$fontStyles={fontFamily:1,fontSize:1,fontWeight:1,fontStyle:1,lineHeight:1};this.$measureSizes=g.isIE||g.isOldGecko?function(){if(!this.$measureNode){var b=this.$measureNode=
e.createElement("div"),c=b.style;c.width=c.height="auto";c.left=c.top="-40000px";c.visibility="hidden";c.position="fixed";c.overflow="visible";c.whiteSpace="nowrap";b.innerHTML=f.stringRepeat("Xy",1E3);if(this.element.ownerDocument.body)this.element.ownerDocument.body.appendChild(b);else{for(c=this.element.parentNode;!e.hasCssClass(c,"ace_editor");)c=c.parentNode;c.appendChild(b)}}if(!this.element.offsetWidth)return null;var c=this.$measureNode.style,b=e.computedStyle(this.element),d;for(d in this.$fontStyles)c[d]=
b[d];d={height:this.$measureNode.offsetHeight,width:this.$measureNode.offsetWidth/2E3};return d.width==0||d.height==0?null:d}:function(){if(!this.$measureNode){var b=this.$measureNode=e.createElement("div"),c=b.style;c.width=c.height="auto";c.left=c.top="-100px";c.visibility="hidden";c.position="fixed";c.overflow="visible";c.whiteSpace="nowrap";b.innerHTML=f.stringRepeat("X",100);for(c=this.element.parentNode;c&&!e.hasCssClass(c,"ace_editor");)c=c.parentNode;if(!c)return this.$measureNode=null;c.appendChild(b)}b=
this.$measureNode.getBoundingClientRect();b={height:b.height,width:b.width/100};return b.width==0||b.height==0?null:b};this.setSession=function(b){this.session=b;this.$computeTabString()};this.showInvisibles=false;this.setShowInvisibles=function(b){return this.showInvisibles==b?false:(this.showInvisibles=b,this.$computeTabString(),true)};this.displayIndentGuides=true;this.setDisplayIndentGuides=function(b){return this.displayIndentGuides==b?false:(this.displayIndentGuides=b,this.$computeTabString(),
true)};this.$tabStrings=[];this.onChangeTabSize=this.$computeTabString=function(){var b=this.session.getTabSize();this.tabSize=b;for(var c=this.$tabStrings=[0],d=1;d<b+1;d++)this.showInvisibles?c.push("<span class='ace_invisible'>"+this.TAB_CHAR+f.stringRepeat("\u00a0",d-1)+"</span>"):c.push(f.stringRepeat("\u00a0",d));if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;b="ace_indent-guide";if(this.showInvisibles){b=b+" ace_invisible";c=f.stringRepeat(this.SPACE_CHAR,this.tabSize);
d=this.TAB_CHAR+f.stringRepeat("\u00a0",this.tabSize-1)}else d=c=f.stringRepeat("\u00a0",this.tabSize);this.$tabStrings[" "]="<span class='"+b+"'>"+c+"</span>";this.$tabStrings["\t"]="<span class='"+b+"'>"+d+"</span>"}};this.updateLines=function(b,c,d){(this.config.lastRow!=b.lastRow||this.config.firstRow!=b.firstRow)&&this.scrollLines(b);this.config=b;for(var f=Math.max(c,b.firstRow),d=Math.min(d,b.lastRow),c=this.element.childNodes,g=0,h=b.firstRow;h<f;h++){var j=this.session.getFoldLine(h);if(j){if(j.containsRow(f)){f=
j.start.row;break}h=j.end.row}g++}h=f;for(f=(j=this.session.getNextFoldLine(h))?j.start.row:Infinity;;){h>f&&(h=j.end.row+1,j=this.session.getNextFoldLine(h,j),f=j?j.start.row:Infinity);if(h>d)break;var r=c[g++];if(r){var o=[];this.$renderLine(o,h,!this.$useLineGroups(),h==f?j:false);r.style.height=b.lineHeight*this.session.getRowLength(h)+"px";e.setInnerHtml(r,o.join(""))}h++}};this.scrollLines=function(b){var c=this.config;this.config=b;if(!c||c.lastRow<b.firstRow||b.lastRow<c.firstRow)return this.update(b);
var d=this.element;if(c.firstRow<b.firstRow)for(var e=this.session.getFoldedRowCount(c.firstRow,b.firstRow-1);e>0;e--)d.removeChild(d.firstChild);if(c.lastRow>b.lastRow)for(e=this.session.getFoldedRowCount(b.lastRow+1,c.lastRow);e>0;e--)d.removeChild(d.lastChild);if(b.firstRow<c.firstRow){e=this.$renderLinesFragment(b,b.firstRow,c.firstRow-1);d.firstChild?d.insertBefore(e,d.firstChild):d.appendChild(e)}if(b.lastRow>c.lastRow){e=this.$renderLinesFragment(b,c.lastRow+1,b.lastRow);d.appendChild(e)}};
this.$renderLinesFragment=function(b,c,d){for(var f=this.element.ownerDocument.createDocumentFragment(),g=this.session.getNextFoldLine(c),h=g?g.start.row:Infinity;;){c>h&&(c=g.end.row+1,g=this.session.getNextFoldLine(c,g),h=g?g.start.row:Infinity);if(c>d)break;var j=e.createElement("div"),r=[];this.$renderLine(r,c,false,c==h?g:false);j.innerHTML=r.join("");if(this.$useLineGroups()){j.className="ace_line_group";f.appendChild(j);j.style.height=b.lineHeight*this.session.getRowLength(c)+"px"}else for(j=
j.childNodes;j.length;)f.appendChild(j[0]);c++}return f};this.update=function(b){this.config=b;for(var c=[],d=b.lastRow,f=b.firstRow,g=this.session.getNextFoldLine(f),h=g?g.start.row:Infinity;;){f>h&&(f=g.end.row+1,g=this.session.getNextFoldLine(f,g),h=g?g.start.row:Infinity);if(f>d)break;this.$useLineGroups()&&c.push("<div class='ace_line_group' style='height:",b.lineHeight*this.session.getRowLength(f),"px'>");this.$renderLine(c,f,false,f==h?g:false);this.$useLineGroups()&&c.push("</div>");f++}this.element=
e.setInnerHtml(this.element,c.join(""))};this.$textToken={text:true,rparen:true,lparen:true};this.$renderToken=function(b,c,d,e){var g=this,h=e.replace(/\t|&|<|( +)|([\x00-\x1f\x80-\xa0\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\u3000\uFEFF])|[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]/g,
function(b,d,e,h){if(d)return g.showInvisibles?"<span class='ace_invisible'>"+f.stringRepeat(g.SPACE_CHAR,b.length)+"</span>":f.stringRepeat("\u00a0",b.length);if(b=="&")return"&#38;";if(b=="<")return"&#60;";if(b=="\t"){b=g.session.getScreenTabSize(c+h);return c=c+(b-1),g.$tabStrings[b]}if(b=="\u3000"){b=g.showInvisibles?"ace_cjk ace_invisible":"ace_cjk";d=g.showInvisibles?g.SPACE_CHAR:"";return c=c+1,"<span class='"+b+"' style='width:"+g.config.characterWidth*2+"px'>"+d+"</span>"}return e?"<span class='ace_invisible ace_invalid'>"+
g.SPACE_CHAR+"</span>":(c=c+1,"<span class='ace_cjk' style='width:"+g.config.characterWidth*2+"px'>"+b+"</span>")});if(this.$textToken[d.type])b.push(h);else{var j="ace_"+d.type.replace(/\./g," ace_"),r="";d.type=="fold"&&(r=" style='width:"+d.value.length*this.config.characterWidth+"px;' ");b.push("<span class='",j,"'",r,">",h,"</span>")}return c+e.length};this.renderIndentGuide=function(b,c,d){var e=c.search(this.$indentGuideRe);return e<=0||e>=d?c:c[0]==" "?(e=e-e%this.tabSize,b.push(f.stringRepeat(this.$tabStrings[" "],
e/this.tabSize)),c.substr(e)):c[0]=="\t"?(b.push(f.stringRepeat(this.$tabStrings["\t"],e)),c.substr(e)):c};this.$renderWrappedLine=function(b,c,d,e){for(var f=0,g=0,h=d[0],j=0,o=0;o<c.length;o++){var t=c[o],u=t.value;if(o==0&&this.displayIndentGuides){f=u.length;u=this.renderIndentGuide(b,u,h);if(!u)continue;f=f-u.length}if(f+u.length<h){j=this.$renderToken(b,j,t,u);f=f+u.length}else{for(;f+u.length>=h;){this.$renderToken(b,j,t,u.substring(0,h-f));u=u.substring(h-f);f=h;e||b.push("</div>","<div class='ace_line' style='height:",
this.config.lineHeight,"px'>");g++;j=0;h=d[g]||Number.MAX_VALUE}u.length!=0&&(f=f+u.length,j=this.$renderToken(b,j,t,u))}}};this.$renderSimpleLine=function(b,c){var d=0,e=c[0],f=e.value;this.displayIndentGuides&&(f=this.renderIndentGuide(b,f));f&&(d=this.$renderToken(b,d,e,f));for(var g=1;g<c.length;g++){e=c[g];f=e.value;d=this.$renderToken(b,d,e,f)}};this.$renderLine=function(b,c,d,e){!e&&e!=0&&(e=this.session.getFoldLine(c));var f=e?this.$getFoldLineTokens(c,e):this.session.getTokens(c);d||b.push("<div class='ace_line' style='height:",
this.config.lineHeight*(this.$useLineGroups()?1:this.session.getRowLength(c)),"px'>");if(f.length){var g=this.session.getRowSplitData(c);g&&g.length?this.$renderWrappedLine(b,f,g,d):this.$renderSimpleLine(b,f)}this.showInvisibles&&(e&&(c=e.end.row),b.push("<span class='ace_invisible'>",c==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,"</span>"));d||b.push("</div>")};this.$getFoldLineTokens=function(b,c){var d=this.session,e=[],f=d.getTokens(b);return c.walk(function(b,c,g,h,j){if(b!=null)e.push({type:"fold",
value:b});else{j&&(f=d.getTokens(c));if(f.length)a:{b=f;for(j=c=0;j+b[c].value.length<h;){j=j+b[c].value.length;c++;if(c==b.length)break a}if(j!=h){var k=b[c].value.substring(h-j);k.length>g-h&&(k=k.substring(0,g-h));e.push({type:b[c].type,value:k});j=h+k.length;c=c+1}for(;j<g&&c<b.length;){k=b[c].value;k.length+j>g?e.push({type:b[c].type,value:k.substring(0,g-j)}):e.push(b[c]);j=j+k.length;c=c+1}}}},c.end.row,this.session.getLine(c.end.row).length),e};this.$useLineGroups=function(){return this.session.getUseWrapMode()};
this.destroy=function(){clearInterval(this.$pollSizeChangesTimer);this.$measureNode&&this.$measureNode.parentNode.removeChild(this.$measureNode);delete this.$measureNode}}).call(j.prototype);c.Text=j});
ace.define("ace/layer/cursor",["require","exports","module","ace/lib/dom"],function(b,c){var d=b("../lib/dom"),e=function(b){this.element=d.createElement("div");this.element.className="ace_layer ace_cursor-layer";b.appendChild(this.element);this.isVisible=!1;this.isBlinking=!0;this.blinkInterval=1E3;this.smoothBlinking=!1;this.cursors=[];this.cursor=this.addCursor();d.addCssClass(this.element,"ace_hidden-cursors")};(function(){this.$padding=0;this.setPadding=function(b){this.$padding=b};this.setSession=
function(b){this.session=b};this.setBlinking=function(b){b!=this.isBlinking&&(this.isBlinking=b,this.restartTimer())};this.setBlinkInterval=function(b){b!=this.blinkInterval&&(this.blinkInterval=b,this.restartTimer())};this.setSmoothBlinking=function(b){b!=this.smoothBlinking&&(this.smoothBlinking=b,b?d.addCssClass(this.element,"ace_smooth-blinking"):d.removeCssClass(this.element,"ace_smooth-blinking"),this.restartTimer())};this.addCursor=function(){var b=d.createElement("div");return b.className=
"ace_cursor",this.element.appendChild(b),this.cursors.push(b),b};this.removeCursor=function(){if(1<this.cursors.length){var b=this.cursors.pop();return b.parentNode.removeChild(b),b}};this.hideCursor=function(){this.isVisible=!1;d.addCssClass(this.element,"ace_hidden-cursors");this.restartTimer()};this.showCursor=function(){this.isVisible=!0;d.removeCssClass(this.element,"ace_hidden-cursors");this.restartTimer()};this.restartTimer=function(){clearInterval(this.intervalId);clearTimeout(this.timeoutId);
this.smoothBlinking&&d.removeCssClass(this.element,"ace_smooth-blinking");for(var b=this.cursors.length;b--;)this.cursors[b].style.opacity="";if(this.isBlinking&&this.blinkInterval&&this.isVisible){this.smoothBlinking&&setTimeout(function(){d.addCssClass(this.element,"ace_smooth-blinking")}.bind(this));var c=function(){this.timeoutId=setTimeout(function(){for(var b=this.cursors.length;b--;)this.cursors[b].style.opacity=0}.bind(this),0.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval(function(){for(var b=
this.cursors.length;b--;)this.cursors[b].style.opacity="";c()}.bind(this),this.blinkInterval);c()}};this.getPixelPosition=function(b,c){if(!this.config||!this.session)return{left:0,top:0};b||(b=this.session.selection.getCursor());var d=this.session.documentToScreenPosition(b);return{left:this.$padding+d.column*this.config.characterWidth,top:(d.row-(c?this.config.firstRowScreen:0))*this.config.lineHeight}};this.update=function(b){this.config=b;var c=this.session.$selectionMarkers,d=0,e=0;if(void 0===
c||0===c.length)c=[{cursor:null}];for(var d=0,k=c.length;d<k;d++){var l=this.getPixelPosition(c[d].cursor,!0);if(!((l.top>b.height+b.offset||l.top<-b.offset)&&1<d)){var m=(this.cursors[e++]||this.addCursor()).style;m.left=l.left+"px";m.top=l.top+"px";m.width=b.characterWidth+"px";m.height=b.lineHeight+"px"}}for(;this.cursors.length>e;)this.removeCursor();this.$setOverwrite(this.session.getOverwrite());this.$pixelPos=l;this.restartTimer()};this.$setOverwrite=function(b){b!=this.overwrite&&(this.overwrite=
b,b?d.addCssClass(this.element,"ace_overwrite-cursors"):d.removeCssClass(this.element,"ace_overwrite-cursors"))};this.destroy=function(){clearInterval(this.intervalId);clearTimeout(this.timeoutId)}}).call(e.prototype);c.Cursor=e});
ace.define("ace/scrollbar","require exports module ace/lib/oop ace/lib/dom ace/lib/event ace/lib/event_emitter".split(" "),function(b,c){var d=b("./lib/oop"),e=b("./lib/dom"),f=b("./lib/event"),g=b("./lib/event_emitter").EventEmitter,h=function(b){this.element=e.createElement("div");this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix;this.inner=e.createElement("div");this.inner.className="ace_scrollbar-inner";this.element.appendChild(this.inner);b.appendChild(this.element);this.setVisible(false);
this.skipEvent=false;f.addListener(this.element,"scroll",this.onScroll.bind(this));f.addListener(this.element,"mousedown",f.preventDefault)};(function(){d.implement(this,g);this.setVisible=function(b){this.element.style.display=b?"":"none";this.isVisible=b}}).call(h.prototype);var j=function(b,c){h.call(this,b);this.scrollTop=0;c.$scrollbarWidth=this.width=e.scrollbarWidth(b.ownerDocument);this.inner.style.width=this.element.style.width=(this.width||15)+5+"px"};d.inherits(j,h);(function(){this.classSuffix=
"-v";this.onScroll=function(){this.skipEvent||(this.scrollTop=this.element.scrollTop,this._emit("scroll",{data:this.scrollTop}));this.skipEvent=false};this.getWidth=function(){return this.isVisible?this.width:0};this.setHeight=function(b){this.element.style.height=b+"px"};this.setInnerHeight=function(b){this.inner.style.height=b+"px"};this.setScrollHeight=function(b){this.inner.style.height=b+"px"};this.setScrollTop=function(b){this.scrollTop!=b&&(this.skipEvent=true,this.scrollTop=this.element.scrollTop=
b)}}).call(j.prototype);var k=function(b,c){h.call(this,b);this.scrollLeft=0;this.height=c.$scrollbarWidth;this.inner.style.height=this.element.style.height=(this.height||15)+5+"px"};d.inherits(k,h);(function(){this.classSuffix="-h";this.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft}));this.skipEvent=false};this.getHeight=function(){return this.isVisible?this.height:0};this.setWidth=function(b){this.element.style.width=b+"px"};
this.setInnerWidth=function(b){this.inner.style.width=b+"px"};this.setScrollWidth=function(b){this.inner.style.width=b+"px"};this.setScrollLeft=function(b){this.scrollLeft!=b&&(this.skipEvent=true,this.scrollLeft=this.element.scrollLeft=b)}}).call(k.prototype);c.ScrollBar=j;c.ScrollBarV=j;c.ScrollBarH=k;c.VScrollBar=j;c.HScrollBar=k});
ace.define("ace/renderloop",["require","exports","module","ace/lib/event"],function(b,c){var d=b("./lib/event"),e=function(b,c){this.onRender=b;this.pending=!1;this.changes=0;this.window=c||window};(function(){this.schedule=function(b){this.changes|=b;if(!this.pending&&this.changes){this.pending=!0;var c=this;d.nextFrame(function(){c.pending=!1;for(var b;b=c.changes;)c.changes=0,c.onRender(b)},this.window)}}}).call(e.prototype);c.RenderLoop=e});
ace.define("ace/multi_select","require exports module ace/range_list ace/range ace/selection ace/mouse/multi_select_handler ace/lib/event ace/lib/lang ace/commands/multi_select_commands ace/search ace/edit_session ace/editor ace/config".split(" "),function(b,c){function d(b){if(!b.$multiselectOnSessionChange){b.$onAddRange=b.$onAddRange.bind(b);b.$onRemoveRange=b.$onRemoveRange.bind(b);b.$onMultiSelect=b.$onMultiSelect.bind(b);b.$onSingleSelect=b.$onSingleSelect.bind(b);b.$multiselectOnSessionChange=
c.onSessionChange.bind(b);b.$multiselectOnSessionChange(b);b.on("changeSession",b.$multiselectOnSessionChange);b.on("mousedown",j);b.commands.addCommands(m.defaultCommands);e(b)}}function e(b){function c(){e&&(b.renderer.setMouseCursor(""),e=false)}var d=b.textInput.getElement(),e=false;k.addListener(d,"keydown",function(d){d.keyCode==18&&!d.ctrlKey&&!d.shiftKey&&!d.metaKey?e||(b.renderer.setMouseCursor("crosshair"),e=true):e&&c()});k.addListener(d,"keyup",c);k.addListener(d,"blur",c)}var f=b("./range_list").RangeList,
g=b("./range").Range,h=b("./selection").Selection,j=b("./mouse/multi_select_handler").onMouseDown,k=b("./lib/event"),l=b("./lib/lang"),m=b("./commands/multi_select_commands");c.commands=m.defaultCommands.concat(m.multiSelectCommands);var n=new (b("./search").Search);(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(b("./edit_session").EditSession.prototype);(function(){this.rangeList=this.ranges=null;this.addRange=function(b,c){if(b){if(!this.inMultiSelectMode&&
this.rangeCount==0){var d=this.toOrientedRange();this.rangeList.add(d);this.rangeList.add(b);if(this.rangeList.ranges.length!=2)return this.rangeList.removeAll(),c||this.fromOrientedRange(b);this.rangeList.removeAll();this.rangeList.add(d);this.$onAddRange(d)}b.cursor||(b.cursor=b.end);d=this.rangeList.add(b);return this.$onAddRange(b),d.length&&this.$onRemoveRange(d),this.rangeCount>1&&!this.inMultiSelectMode&&(this._emit("multiSelect"),this.inMultiSelectMode=true,this.session.$undoSelect=false,
this.rangeList.attach(this.session)),c||this.fromOrientedRange(b)}};this.toSingleRange=function(b){var b=b||this.ranges[0],c=this.rangeList.removeAll();c.length&&this.$onRemoveRange(c);b&&this.fromOrientedRange(b)};this.substractPoint=function(b){if(b=this.rangeList.substractPoint(b))return this.$onRemoveRange(b),b[0]};this.mergeOverlappingRanges=function(){var b=this.rangeList.merge();b.length?this.$onRemoveRange(b):this.ranges[0]&&this.fromOrientedRange(this.ranges[0])};this.$onAddRange=function(b){this.rangeCount=
this.rangeList.ranges.length;this.ranges.unshift(b);this._emit("addRange",{range:b})};this.$onRemoveRange=function(b){this.rangeCount=this.rangeList.ranges.length;if(this.rangeCount==1&&this.inMultiSelectMode){var c=this.rangeList.ranges.pop();b.push(c);this.rangeCount=0}for(var d=b.length;d--;)this.ranges.splice(this.ranges.indexOf(b[d]),1);this._emit("removeRange",{ranges:b});this.rangeCount==0&&this.inMultiSelectMode&&(this.inMultiSelectMode=false,this._emit("singleSelect"),this.session.$undoSelect=
true,this.rangeList.detach(this.session));(c=c||this.ranges[0])&&!c.isEqual(this.getRange())&&this.fromOrientedRange(c)};this.$initRangeList=function(){if(!this.rangeList){this.rangeList=new f;this.ranges=[];this.rangeCount=0}};this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]};this.splitIntoLines=function(){if(this.rangeCount>1){var b=this.rangeList.ranges,c=b[b.length-1],b=g.fromPoints(b[0].start,c.end);this.toSingleRange();this.setSelectionRange(b,
c.cursor==c.start)}else{var b=this.getRange(),d=this.isBackwards(),e=b.start.row,c=b.end.row;if(e==c){if(d){c=b.end;b=b.start}else{c=b.start;b=b.end}this.addRange(g.fromPoints(b,b));this.addRange(g.fromPoints(c,c))}else{var d=[],f=this.getLineRange(e,true);f.start.column=b.start.column;d.push(f);for(e=e+1;e<c;e++)d.push(this.getLineRange(e,true));f=this.getLineRange(c,true);f.end.column=b.end.column;d.push(f);d.forEach(this.addRange,this)}}};this.toggleBlockSelection=function(){if(this.rangeCount>
1){var b=this.rangeList.ranges,c=b[b.length-1],b=g.fromPoints(b[0].start,c.end);this.toSingleRange();this.setSelectionRange(b,c.cursor==c.start)}else{c=this.session.documentToScreenPosition(this.selectionLead);b=this.session.documentToScreenPosition(this.selectionAnchor);this.rectangularRangeBlock(c,b).forEach(this.addRange,this)}};this.rectangularRangeBlock=function(b,c,d){var e=[],f=b.column<c.column;if(f)var h=b.column,j=c.column;else{h=c.column;j=b.column}var k=b.row<c.row;if(k)var l=b.row,b=
c.row;else{l=c.row;b=b.row}h<0&&(h=0);l<0&&(l=0);for(l==b&&(d=true);l<=b;l++){c=g.fromPoints(this.session.screenToDocumentPosition(l,h),this.session.screenToDocumentPosition(l,j));if(c.isEmpty()){if(m&&c.end.row==m.row&&c.end.column==m.column)break;var m=c.end}c.cursor=f?c.start:c.end;e.push(c)}k&&e.reverse();if(!d){for(d=e.length-1;e[d].isEmpty()&&d>0;)d--;if(d>0)for(var n=0;e[n].isEmpty();)n++;for(;d>=n;d--)e[d].isEmpty()&&e.splice(d,1)}return e}}).call(h.prototype);var q=b("./editor").Editor;(function(){this.updateSelectionMarkers=
function(){this.renderer.updateCursor();this.renderer.updateBackMarkers()};this.addSelectionMarker=function(b){b.cursor||(b.cursor=b.end);var c=this.getSelectionStyle();return b.marker=this.session.addMarker(b,"ace_selection",c),this.session.$selectionMarkers.push(b),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,b};this.removeSelectionMarker=function(b){if(b.marker){this.session.removeMarker(b.marker);b=this.session.$selectionMarkers.indexOf(b);b!=-1&&this.session.$selectionMarkers.splice(b,
1);this.session.selectionMarkerCount=this.session.$selectionMarkers.length}};this.removeSelectionMarkers=function(b){for(var c=this.session.$selectionMarkers,d=b.length;d--;){var e=b[d];if(e.marker){this.session.removeMarker(e.marker);e=c.indexOf(e);e!=-1&&c.splice(e,1)}}this.session.selectionMarkerCount=c.length};this.$onAddRange=function(b){this.addSelectionMarker(b.range);this.renderer.updateCursor();this.renderer.updateBackMarkers()};this.$onRemoveRange=function(b){this.removeSelectionMarkers(b.ranges);
this.renderer.updateCursor();this.renderer.updateBackMarkers()};this.$onMultiSelect=function(){if(!this.inMultiSelectMode){this.inMultiSelectMode=true;this.setStyle("ace_multiselect");this.keyBinding.addKeyboardHandler(m.keyboardHandler);this.commands.setDefaultHandler("exec",this.$onMultiSelectExec);this.renderer.updateCursor();this.renderer.updateBackMarkers()}};this.$onSingleSelect=function(){if(!this.session.multiSelect.inVirtualMode){this.inMultiSelectMode=false;this.unsetStyle("ace_multiselect");
this.keyBinding.removeKeyboardHandler(m.keyboardHandler);this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec);this.renderer.updateCursor();this.renderer.updateBackMarkers()}};this.$onMultiSelectExec=function(b){var c=b.command,d=b.editor;if(d.multiSelect){if(c.multiSelectAction)c.multiSelectAction=="forEach"?e=d.forEachSelection(c,b.args):c.multiSelectAction=="forEachLine"?e=d.forEachSelection(c,b.args,true):c.multiSelectAction=="single"?(d.exitMultiSelectMode(),e=c.exec(d,b.args||{})):
e=c.multiSelectAction(d,b.args||{});else{var e=c.exec(d,b.args||{});d.multiSelect.addRange(d.multiSelect.toOrientedRange());d.multiSelect.mergeOverlappingRanges()}return e}};this.forEachSelection=function(b,c,d){if(!this.inVirtualSelectionMode){var e=this.session,f=this.selection,g=f.rangeList,j,k=f._eventRegistry;f._eventRegistry={};var l=new h(e);this.inVirtualSelectionMode=true;for(var m=g.ranges.length;m--;){if(d)for(;m>0&&g.ranges[m].start.row==g.ranges[m-1].end.row;)m--;l.fromOrientedRange(g.ranges[m]);
this.selection=e.selection=l;var n=b.exec(this,c||{});!j==void 0&&(j=n);l.toOrientedRange(g.ranges[m])}l.detach();this.selection=e.selection=f;this.inVirtualSelectionMode=false;f._eventRegistry=k;f.mergeOverlappingRanges();b=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),b&&b.from==b.to&&this.renderer.animateScrolling(b.from),j}};this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()};this.getSelectedText=
function(){var b="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var b=this.multiSelect.rangeList.ranges,c=[],d=0;d<b.length;d++)c.push(this.session.getTextRange(b[d]));d=this.session.getDocument().getNewLineCharacter();b=c.join(d);b.length==(c.length-1)*d.length&&(b="")}else this.selection.isEmpty()||(b=this.session.getTextRange(this.getSelectionRange()));return b};this.onPaste=function(b){if(!this.$readOnly){this._signal("paste",b);if(!this.inMultiSelectMode||this.inVirtualSelectionMode)return this.insert(b);
var c=b.split(/\r\n|\r|\n/),d=this.selection.rangeList.ranges;if(c.length>d.length||c.length<2||!c[1])return this.commands.exec("insertstring",this,b);for(b=d.length;b--;){var e=d[b];e.isEmpty()||this.session.remove(e);this.session.insert(e.start,c[b])}}};this.findAll=function(b,c,d){c=c||{};c.needle=b||c.needle;this.$search.set(c);b=this.$search.findAll(this.session);if(!b.length)return 0;this.$blockScrolling=this.$blockScrolling+1;c=this.multiSelect;d||c.toSingleRange(b[0]);for(d=b.length;d--;)c.addRange(b[d],
true);return this.$blockScrolling=this.$blockScrolling-1,b.length};this.selectMoreLines=function(b,c){var d=this.selection.toOrientedRange(),e=d.cursor==d.end,f=this.session.documentToScreenPosition(d.cursor);this.selection.$desiredColumn&&(f.column=this.selection.$desiredColumn);var h=this.session.screenToDocumentPosition(f.row+b,f.column);if(d.isEmpty())j=h;else var j=this.session.documentToScreenPosition(e?d.end:d.start),j=this.session.screenToDocumentPosition(j.row+b,j.column);if(e){e=g.fromPoints(h,
j);e.cursor=e.start}else{e=g.fromPoints(j,h);e.cursor=e.end}e.desiredColumn=f.column;if(this.selection.inMultiSelectMode){if(c)var k=d.cursor}else this.selection.addRange(d);this.selection.addRange(e);k&&this.selection.substractPoint(k)};this.transposeSelections=function(b){for(var c=this.session,d=c.multiSelect,e=d.ranges,f=e.length;f--;){var g=e[f];if(g.isEmpty()){var h=c.getWordRange(g.start.row,g.start.column);g.start.row=h.start.row;g.start.column=h.start.column;g.end.row=h.end.row;g.end.column=
h.end.column}}d.mergeOverlappingRanges();d=[];for(f=e.length;f--;){g=e[f];d.unshift(c.getTextRange(g))}b<0?d.unshift(d.pop()):d.push(d.shift());for(f=e.length;f--;){g=e[f];h=g.clone();c.replace(g,d[f]);g.start.row=h.start.row;g.start.column=h.start.column}};this.selectMore=function(b,c){var d=this.session,e=d.multiSelect.toOrientedRange();e.isEmpty()&&(e=d.getWordRange(e.start.row,e.start.column),e.cursor=b==-1?e.start:e.end,this.multiSelect.addRange(e));var f=d.getTextRange(e);(d=(n.$options.wrap=
true,n.$options.needle=f,n.$options.backwards=b==-1,n.find(d)))&&(d.cursor=b==-1?d.start:d.end,this.$blockScrolling=this.$blockScrolling+1,this.session.unfold(d),this.multiSelect.addRange(d),this.$blockScrolling=this.$blockScrolling-1,this.renderer.scrollCursorIntoView(null,0.5));c&&this.multiSelect.substractPoint(e.cursor)};this.alignCursors=function(){var b=this.session,c=b.multiSelect,d=c.ranges;if(d.length){var e=-1,f=d.filter(function(b){if(b.cursor.row==e)return true;e=b.cursor.row});c.$onRemoveRange(f);
var h=0,j=Infinity,k=d.map(function(c){var c=c.cursor,d=b.getLine(c.row).substr(c.column).search(/\S/g);return d==-1&&(d=0),c.column>h&&(h=c.column),d<j&&(j=d),d});d.forEach(function(c,d){var e=c.cursor,f=h-e.column,m=k[d]-j;f>m?b.insert(e,l.stringRepeat(" ",f-m)):b.remove(new g(e.row,e.column,e.row,e.column-f+m));c.start.column=c.end.column=h;c.start.row=c.end.row=e.row;c.cursor=c.end});c.fromOrientedRange(d[0]);this.renderer.updateCursor();this.renderer.updateBackMarkers()}else{var c=this.selection.getRange(),
d=c.start.row,m=c.end.row;if(f=d==m){var n=this.session.getLength(),q;do q=this.session.getLine(m);while(/[=:]/.test(q)&&++m<n);do q=this.session.getLine(d);while(/[=:]/.test(q)&&--d>0);d<0&&(d=0);m>=n&&(m=n-1)}m=this.session.doc.removeLines(d,m);m=this.$reAlignText(m,f);this.session.doc.insert({row:d,column:0},m.join("\n")+"\n");f||(c.start.column=0,c.end.column=m[m.length-1].length);this.selection.setRange(c)}};this.$reAlignText=function(b,c){function d(b){return l.stringRepeat(" ",b)}function e(b){return b[2]?
d(k)+b[2]+d(m-b[2].length+n)+b[4].replace(/^([=:])\s+/,"$1 "):b[0]}function f(b){return b[2]?d(k+m-b[2].length)+b[2]+d(n," ")+b[4].replace(/^([=:])\s+/,"$1 "):b[0]}function g(b){return b[2]?d(k)+b[2]+d(n)+b[4].replace(/^([=:])\s+/,"$1 "):b[0]}var h=true,j=true,k,m,n;return b.map(function(b){var c=b.match(/(\s*)(.*?)(\s*)([=:].*)/);return c?k==null?(k=c[1].length,m=c[2].length,n=c[3].length,c):(k+m+n!=c[1].length+c[2].length+c[3].length&&(j=false),k!=c[1].length&&(h=false),k>c[1].length&&(k=c[1].length),
m<c[2].length&&(m=c[2].length),n>c[3].length&&(n=c[3].length),c):[b]}).map(c?e:h?j?f:e:g)}}).call(q.prototype);c.onSessionChange=function(b){var c=b.session;c.multiSelect||(c.$selectionMarkers=[],c.selection.$initRangeList(),c.multiSelect=c.selection);this.multiSelect=c.multiSelect;(b=b.oldSession)&&(b.multiSelect.removeEventListener("addRange",this.$onAddRange),b.multiSelect.removeEventListener("removeRange",this.$onRemoveRange),b.multiSelect.removeEventListener("multiSelect",this.$onMultiSelect),
b.multiSelect.removeEventListener("singleSelect",this.$onSingleSelect));c.multiSelect.on("addRange",this.$onAddRange);c.multiSelect.on("removeRange",this.$onRemoveRange);c.multiSelect.on("multiSelect",this.$onMultiSelect);c.multiSelect.on("singleSelect",this.$onSingleSelect);this.inMultiSelectMode!=c.selection.inMultiSelectMode&&(c.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())};c.MultiSelect=d;b("./config").defineOptions(q.prototype,"editor",{enableMultiselect:{set:function(b){d(this);
b?(this.on("changeSession",this.$multiselectOnSessionChange),this.on("mousedown",j)):(this.off("changeSession",this.$multiselectOnSessionChange),this.off("mousedown",j))},value:true}})});
ace.define("ace/mouse/multi_select_handler",["require","exports","module","ace/lib/event"],function(b,c){function d(b,c){return b.row==c.row&&b.column==c.column}var e=b("../lib/event");c.onMouseDown=function(b){var c=b.domEvent,h=c.altKey,c=c.shiftKey,j=b.getAccelKey(),k=b.getButton();if(b.editor.inMultiSelectMode&&2==k)b.editor.textInput.onContextMenu(b.domEvent);else if(!j&&!h)0==k&&b.editor.inMultiSelectMode&&b.editor.exitMultiSelectMode();else{var l=b.editor,m=l.selection,n=l.inMultiSelectMode,
q=b.getDocumentPosition(),p=m.getCursor(),p=b.inSelection()||m.isEmpty()&&d(q,p),s=b.x,r=b.y,o=function(b){s=b.clientX;r=b.clientY},t=function(){var b=l.renderer.pixelToScreenCoordinates(s,r),c=u.screenToDocumentPosition(b.row,b.column);if(!d(z,b)||!d(c,m.selectionLead))z=b,l.selection.moveCursorToPosition(c),l.selection.clearSelection(),l.renderer.scrollCursorIntoView(),l.removeSelectionMarkers(G),G=m.rectangularRangeBlock(z,w),G.forEach(l.addSelectionMarker,l),l.updateSelectionMarkers()},u=l.session,
w=l.renderer.pixelToScreenCoordinates(s,r),z=w;if(j&&!c&&!h&&0==k){if(n||!p){if(!n){var A=m.toOrientedRange();l.addSelectionMarker(A)}var C=m.rangeList.rangeAtPoint(q);l.$blockScrolling++;l.once("mouseup",function(){var b=m.toOrientedRange();C&&b.isEmpty()&&d(C.cursor,b.cursor)?m.substractPoint(b.cursor):(A&&(l.removeSelectionMarker(A),m.addRange(A)),m.addRange(b));l.$blockScrolling--})}}else if(h&&0==k){b.stop();n&&!j?m.toSingleRange():!n&&j&&m.addRange();var G=[];c?(w=u.documentToScreenPosition(m.lead),
t()):(m.moveCursorToPosition(q),m.clearSelection());e.capture(l.container,o,function(){clearInterval(H);l.removeSelectionMarkers(G);for(var b=0;b<G.length;b++)m.addRange(G[b])});var H=setInterval(function(){t()},20);return b.preventDefault()}}}});
ace.define("ace/commands/multi_select_commands",["require","exports","module","ace/keyboard/hash_handler"],function(b,c){c.defaultCommands=[{name:"addCursorAbove",exec:function(b){b.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},readonly:!0},{name:"addCursorBelow",exec:function(b){b.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},readonly:!0},{name:"addCursorAboveSkipCurrent",exec:function(b){b.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},
readonly:!0},{name:"addCursorBelowSkipCurrent",exec:function(b){b.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},readonly:!0},{name:"selectMoreBefore",exec:function(b){b.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},readonly:!0},{name:"selectMoreAfter",exec:function(b){b.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},readonly:!0},{name:"selectNextBefore",exec:function(b){b.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",
mac:"Ctrl-Alt-Shift-Left"},readonly:!0},{name:"selectNextAfter",exec:function(b){b.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},readonly:!0},{name:"splitIntoLines",exec:function(b){b.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readonly:!0},{name:"alignCursors",exec:function(b){b.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"}}];c.multiSelectCommands=[{name:"singleSelection",bindKey:"esc",exec:function(b){b.exitMultiSelectMode()},
readonly:!0,isAvailable:function(b){return b&&b.inMultiSelectMode}}];var d=b("../keyboard/hash_handler").HashHandler;c.keyboardHandler=new d(c.multiSelectCommands)});
ace.define("ace/worker/worker_client","require exports module ace/lib/oop ace/lib/event_emitter ace/config".split(" "),function(b,c){var d=b("../lib/oop"),e=b("../lib/event_emitter").EventEmitter,f=b("../config"),g=function(c,d,e){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this);this.changeListener=this.changeListener.bind(this);this.onMessage=this.onMessage.bind(this);b.nameToUrl&&!b.toUrl&&(b.toUrl=b.nameToUrl);var g;if(f.get("packaged")||!b.toUrl)g=f.moduleUrl(d,"worker");else{var h=this.$normalizePath;
g=h(b.toUrl("ace/worker/worker.js",null,"_"));var q={};c.forEach(function(c){q[c]=h(b.toUrl(c,null,"_").replace(/(\.js)?(\?.*)?$/,""))})}this.$worker=new Worker(g);this.$worker.postMessage({init:true,tlns:q,module:d,classname:e});this.callbackId=1;this.callbacks={};this.$worker.onmessage=this.onMessage};(function(){d.implement(this,e);this.onMessage=function(b){b=b.data;switch(b.type){case "log":window.console&&console.log&&console.log.apply(console,b.data);break;case "event":this._emit(b.name,{data:b.data});
break;case "call":var c=this.callbacks[b.id];c&&(c(b.data),delete this.callbacks[b.id])}};this.$normalizePath=function(b){return location.host?(b=b.replace(/^[a-z]+:\/\/[^\/]+/,""),b=location.protocol+"//"+location.host+(b.charAt(0)=="/"?"":location.pathname.replace(/\/[^\/]*$/,""))+"/"+b.replace(/^[\/]+/,""),b):b};this.terminate=function(){this._emit("terminate",{});this.deltaQueue=null;this.$worker.terminate();this.$worker=null;this.$doc.removeEventListener("change",this.changeListener);this.$doc=
null};this.send=function(b,c){this.$worker.postMessage({command:b,args:c})};this.call=function(b,c,d){if(d){var e=this.callbackId++;this.callbacks[e]=d;c.push(e)}this.send(b,c)};this.emit=function(b,c){try{this.$worker.postMessage({event:b,data:{data:c.data}})}catch(d){}};this.attachToDocument=function(b){this.$doc&&this.terminate();this.$doc=b;this.call("setValue",[b.getValue()]);b.on("change",this.changeListener)};this.changeListener=function(b){this.deltaQueue?this.deltaQueue.push(b.data):(this.deltaQueue=
[b.data],setTimeout(this.$sendDeltaQueue,0))};this.$sendDeltaQueue=function(){var b=this.deltaQueue;if(b){this.deltaQueue=null;b.length>20&&b.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:b})}}}).call(g.prototype);var h=function(b,c,d){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this);this.changeListener=this.changeListener.bind(this);this.callbackId=1;this.callbacks={};this.messageBuffer=[];var g=null,h=Object.create(e),q=this;this.$worker=
{};this.$worker.terminate=function(){};this.$worker.postMessage=function(b){q.messageBuffer.push(b);g&&setTimeout(p)};var p=function(){var b=q.messageBuffer.shift();b.command?g[b.command].apply(g,b.args):b.event&&h._emit(b.event,b.data)};h.postMessage=function(b){q.onMessage({data:b})};h.callback=function(b,c){this.postMessage({type:"call",id:c,data:b})};h.emit=function(b,c){this.postMessage({type:"event",name:b,data:c})};f.loadModule(["worker",c],function(b){for(g=new b[d](h);q.messageBuffer.length;)p()})};
h.prototype=g.prototype;c.UIWorkerClient=h;c.WorkerClient=g});
ace.define("ace/placeholder","require exports module ace/range ace/lib/event_emitter ace/lib/oop".split(" "),function(b,c){var d=b("./range").Range,e=b("./lib/event_emitter").EventEmitter,f=b("./lib/oop"),g=function(b,c,d,e,f,g){var q=this;this.length=c;this.session=b;this.doc=b.getDocument();this.mainClass=f;this.othersClass=g;this.$onUpdate=this.onUpdate.bind(this);this.doc.on("change",this.$onUpdate);this.$others=e;this.$onCursorChange=function(){setTimeout(function(){q.onCursorChange()})};this.$pos=
d;this.$undoStackDepth=(b.getUndoManager().$undoStack||b.getUndoManager().$undostack||{length:-1}).length;this.setup();b.selection.on("changeCursor",this.$onCursorChange)};(function(){f.implement(this,e);this.setup=function(){var b=this,c=this.doc,e=this.session,f=this.$pos;this.pos=c.createAnchor(f.row,f.column);this.markerId=e.addMarker(new d(f.row,f.column,f.row,f.column+this.length),this.mainClass,null,false);this.pos.on("change",function(c){e.removeMarker(b.markerId);b.markerId=e.addMarker(new d(c.value.row,
c.value.column,c.value.row,c.value.column+b.length),b.mainClass,null,false)});this.others=[];this.$others.forEach(function(d){d=c.createAnchor(d.row,d.column);b.others.push(d)});e.setUndoSelect(false)};this.showOtherMarkers=function(){if(!this.othersActive){var b=this.session,c=this;this.othersActive=true;this.others.forEach(function(e){e.markerId=b.addMarker(new d(e.row,e.column,e.row,e.column+c.length),c.othersClass,null,false);e.on("change",function(f){b.removeMarker(e.markerId);e.markerId=b.addMarker(new d(f.value.row,
f.value.column,f.value.row,f.value.column+c.length),c.othersClass,null,false)})})}};this.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=false;for(var b=0;b<this.others.length;b++)this.session.removeMarker(this.others[b].markerId)}};this.onUpdate=function(b){var b=b.data,c=b.range;if(c.start.row===c.end.row&&c.start.row===this.pos.row&&!this.$updating){this.$updating=true;var e=b.action==="insertText"?c.end.column-c.start.column:c.start.column-c.end.column;if(c.start.column>=this.pos.column&&
c.start.column<=this.pos.column+this.length+1){var f=c.start.column-this.pos.column;this.length=this.length+e;if(!this.session.$fromUndo){if(b.action==="insertText")for(var g=this.others.length-1;g>=0;g--){var n=this.others[g],q={row:n.row,column:n.column+f};n.row===c.start.row&&c.start.column<n.column&&(q.column=q.column+e);this.doc.insert(q,b.text)}else if(b.action==="removeText")for(g=this.others.length-1;g>=0;g--){n=this.others[g];q={row:n.row,column:n.column+f};n.row===c.start.row&&c.start.column<
n.column&&(q.column=q.column+e);this.doc.remove(new d(q.row,q.column,q.row,q.column-e))}c.start.column===this.pos.column&&b.action==="insertText"?setTimeout(function(){this.pos.setPosition(this.pos.row,this.pos.column-e);for(var b=0;b<this.others.length;b++){var d=this.others[b],f=d.row,g=d.column-e;d.row===c.start.row&&c.start.column<d.column&&(g=g+e);d.setPosition(f,g)}}.bind(this),0):c.start.column===this.pos.column&&b.action==="removeText"&&setTimeout(function(){for(var b=0;b<this.others.length;b++){var d=
this.others[b];d.row===c.start.row&&c.start.column<d.column&&d.setPosition(d.row,d.column-e)}}.bind(this),0)}this.pos._emit("change",{value:this.pos});for(g=0;g<this.others.length;g++)this.others[g]._emit("change",{value:this.others[g]})}this.$updating=false}};this.onCursorChange=function(b){if(!this.$updating){var c=this.session.selection.getCursor();c.row===this.pos.row&&c.column>=this.pos.column&&c.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",b)):(this.hideOtherMarkers(),
this._emit("cursorLeave",b))}};this.detach=function(){this.session.removeMarker(this.markerId);this.hideOtherMarkers();this.doc.removeEventListener("change",this.$onUpdate);this.session.selection.removeEventListener("changeCursor",this.$onCursorChange);this.pos.detach();for(var b=0;b<this.others.length;b++)this.others[b].detach();this.session.setUndoSelect(true)};this.cancel=function(){if(this.$undoStackDepth===-1)throw Error("Canceling placeholders only supported with undo manager attached to session.");
for(var b=this.session.getUndoManager(),c=(b.$undoStack||b.$undostack).length-this.$undoStackDepth,d=0;d<c;d++)b.undo(true)}}).call(g.prototype);c.PlaceHolder=g});
ace.define("ace/mode/folding/fold_mode",["require","exports","module","ace/range"],function(b,c){var d=b("../../range").Range;(function(){this.foldingStopMarker=this.foldingStartMarker=null;this.getFoldWidget=function(b,c,d){b=b.getLine(d);return this.foldingStartMarker.test(b)?"start":"markbeginend"==c&&this.foldingStopMarker&&this.foldingStopMarker.test(b)?"end":""};this.getFoldWidgetRange=function(){return null};this.indentationBlock=function(b,c,g){var h=/\S/,j=b.getLine(c),k=j.search(h);if(-1!=
k){for(var g=g||j.length,l=b.getLength(),m=j=c;++c<l;){var n=b.getLine(c).search(h);if(-1!=n){if(n<=k)break;m=c}}if(m>j)return b=b.getLine(m).length,new d(j,g,m,b)}};this.openingBracketBlock=function(b,c,g,h,j){g={row:g,column:h+1};if(c=b.$findClosingBracket(c,g,j))return j=b.foldWidgets[c.row],null==j&&(j=b.getFoldWidget(c.row)),"start"==j&&c.row>g.row&&(c.row--,c.column=b.getLine(c.row).length),d.fromPoints(g,c)};this.closingBracketBlock=function(b,c,g,h){g={row:g,column:h};if(b=b.$findOpeningBracket(c,
g))return b.column++,g.column--,d.fromPoints(b,g)}}).call((c.FoldMode=function(){}).prototype)});
ace.define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],function(b,c){c.isDark=!1;c.cssClass="ace-tm";c.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;border-radius: 2px;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}';b("../lib/dom").importCssString(c.cssText,
c.cssClass)});
ace.define("ace/ext/error_marker","require exports module ace/line_widgets ace/lib/dom ace/range".split(" "),function(b,c){function d(b,c,d){b=b.getAnnotations().sort(g.comparePoints);if(b.length){var e;a:{e={row:c,column:-1};for(var f=g.comparePoints,n=0,q=b.length-1;n<=q;){var p=n+q>>1,s=f(e,b[p]);if(s>0)n=p+1;else{if(!(s<0)){e=p;break a}q=p-1}}e=-(n+1)}e<0&&(e=-e-1);e>=b.length-1?e=d>0?0:b.length-1:e===0&&d<0&&(e=b.length-1);if((f=b[e])&&d){if(f.row===c){do f=b[e=e+d];while(f&&f.row===c);if(!f)return b.slice()}n=
[];c=f.row;do{n[d<0?"unshift":"push"](f);f=b[e=e+d]}while(f&&f.row==c);return n.length&&n}}}var e=b("ace/line_widgets").LineWidgets,f=b("ace/lib/dom"),g=b("ace/range").Range;c.showErrorMarker=function(b,c){var g=b.session;g.widgetManager||(g.widgetManager=new e(g),g.widgetManager.attach(b));var l=b.getCursorPosition(),m=l.row,n=g.lineWidgets&&g.lineWidgets[m];n?n.destroy():m=m-c;if(m=d(g,m,c)){n=m[0];n.pos&&n.column==null&&(l.column=n.pos.sc);l.row=n.row;n=b.renderer.$gutterLayer.$annotations[l.row]}else{if(n)return;
n={text:["Looks good!"],className:"ace_ok"}}b.session.unfold(l.row);b.selection.moveCursorToPosition(l);b.selection.clearSelection();var q={row:l.row,fixedWidth:true,coverGutter:true,el:f.createElement("div")},m=q.el.appendChild(f.createElement("div")),p=q.el.appendChild(f.createElement("div"));p.className="error_widget_arrow "+n.className;l=b.renderer.$cursorLayer.getPixelPosition(l).left;p.style.left=l+b.renderer.gutterWidth-5+"px";q.el.className="error_widget_wrapper";m.className="error_widget "+
n.className;m.innerHTML=n.text.join("<br>");var s={handleKeyboard:function(b,c,d){if(c===0&&d==="esc")return q.destroy(),true}};q.destroy=function(){if(!b.$mouseHandler.isMousePressed){b.keyBinding.removeKeyboardHandler(s);g.widgetManager.removeLineWidget(q);b.off("changeSelection",q.destroy);b.off("changeSession",q.destroy);b.off("mouseup",q.destroy);b.off("change",q.destroy)}};b.keyBinding.addKeyboardHandler(s);b.on("changeSelection",q.destroy);b.on("changeSession",q.destroy);b.on("mouseup",q.destroy);
b.on("change",q.destroy);b.session.widgetManager.addLineWidget(q);q.el.onmousedown=b.focus.bind(b)};f.importCssString("    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }",
"")});
ace.define("ace/line_widgets","require exports module ace/lib/oop ace/lib/dom ace/range".split(" "),function(b,c){function d(b){this.session=b;this.session.widgetManager=this;this.session.getRowLength=this.getRowLength;this.session.$getWidgetScreenLength=this.$getWidgetScreenLength;this.updateOnChange=this.updateOnChange.bind(this);this.renderWidgets=this.renderWidgets.bind(this);this.measureWidgets=this.measureWidgets.bind(this);this.session._changedWidgets=[];this.detach=this.detach.bind(this);this.session.on("change",
this.updateOnChange)}b("./lib/oop");var e=b("./lib/dom");b("./range");(function(){this.getRowLength=function(b){var c;return this.lineWidgets?c=this.lineWidgets[b]&&this.lineWidgets[b].rowCount||0:c=0,!this.$useWrapMode||!this.$wrapData[b]?1+c:this.$wrapData[b].length+1+c};this.$getWidgetScreenLength=function(){var b=0;return this.lineWidgets.forEach(function(c){c&&c.rowCount&&(b=b+c.rowCount)}),b};this.attach=function(b){b.widgetManager&&b.widgetManager!=this&&b.widgetManager.detach();if(this.editor!=
b){this.detach();this.editor=b;this.editor.on("changeSession",this.detach);b.widgetManager=this;b.setOption("enableLineWidgets",true);b.renderer.on("beforeRender",this.measureWidgets);b.renderer.on("afterRender",this.renderWidgets)}};this.detach=function(b){if(!(b&&b.session==this.session))if(b=this.editor){b.off("changeSession",this.detach);this.editor=null;b.widgetManager=null;b.renderer.off("beforeRender",this.measureWidgets);b.renderer.off("afterRender",this.renderWidgets);(b=this.session.lineWidgets)&&
b.forEach(function(b){b&&b.el&&b.el.parentNode&&(b._inDocument=false,b.el.parentNode.removeChild(b.el))})}};this.updateOnChange=function(b){var c=this.session.lineWidgets;if(c){var d=b.data,e=d.range,b=e.start.row,e=e.end.row-b;if(e!==0){if(d.action=="removeText"||d.action=="removeLines")c.splice(b+1,e).forEach(function(b){b&&this.removeLineWidget(b)},this);else{d=Array(e);d.unshift(b,0);c.splice.apply(c,d)}this.$updateRows()}}};this.$updateRows=function(){var b=this.session.lineWidgets;if(b){var c=
true;b.forEach(function(b,d){b&&(c=false,b.row=d)});c&&(this.session.lineWidgets=null)}};this.addLineWidget=function(b){this.session.lineWidgets||(this.session.lineWidgets=Array(this.session.getLength()));this.session.lineWidgets[b.row]=b;var c=this.editor.renderer;return b.html&&!b.el&&(b.el=e.createElement("div"),b.el.innerHTML=b.html),b.el&&(e.addCssClass(b.el,"ace_lineWidgetContainer"),b.el.style.position="absolute",b.el.style.zIndex=5,c.container.appendChild(b.el),b._inDocument=true),b.coverGutter||
(b.el.style.zIndex=3),b.pixelHeight||(b.pixelHeight=b.el.offsetHeight),b.rowCount==null&&(b.rowCount=b.pixelHeight/c.layerConfig.lineHeight),this.session._emit("changeFold",{data:{start:{row:b.row}}}),this.$updateRows(),this.renderWidgets(null,c),b};this.removeLineWidget=function(b){b._inDocument=false;b.el&&b.el.parentNode&&b.el.parentNode.removeChild(b.el);if(b.editor&&b.editor.destroy)try{b.editor.destroy()}catch(c){}this.session.lineWidgets&&(this.session.lineWidgets[b.row]=void 0);this.session._emit("changeFold",
{data:{start:{row:b.row}}});this.$updateRows()};this.onWidgetChanged=function(b){this.session._changedWidgets.push(b);this.editor&&this.editor.renderer.updateFull()};this.measureWidgets=function(b,c){var d=this.session._changedWidgets,e=c.layerConfig;if(d&&d.length){for(var k=Infinity,l=0;l<d.length;l++){var m=d[l];m._inDocument||(m._inDocument=true,c.container.appendChild(m.el));m.h=m.el.offsetHeight;m.fixedWidth||(m.w=m.el.offsetWidth,m.screenWidth=Math.ceil(m.w/e.characterWidth));var n=m.h/e.lineHeight;
m.coverLine&&(n=n-this.session.getRowLineCount(m.row),n<0&&(n=0));m.rowCount!=n&&(m.rowCount=n,m.row<k&&(k=m.row))}k!=Infinity&&(this.session._emit("changeFold",{data:{start:{row:k}}}),this.session.lineWidgetWidth=null);this.session._changedWidgets=[]}};this.renderWidgets=function(b,c){var d=c.layerConfig,e=this.session.lineWidgets;if(e){for(var k=Math.min(this.firstRow,d.firstRow),l=Math.max(this.lastRow,d.lastRow,e.length);k>0&&!e[k];)k--;this.firstRow=d.firstRow;this.lastRow=d.lastRow;for(c.$cursorLayer.config=
d;k<=l;k++){var m=e[k];if(m&&m.el){m._inDocument||(m._inDocument=true,c.container.appendChild(m.el));var n=c.$cursorLayer.getPixelPosition({row:k,column:0},true).top;m.coverLine||(n=n+d.lineHeight*this.session.getRowLineCount(m.row));m.el.style.top=n-d.offset+"px";n=m.coverGutter?0:c.gutterWidth;m.fixedWidth||(n=n-c.scrollLeft);m.el.style.left=n+"px";m.fixedWidth?m.el.style.right=c.scrollBar.getWidth()+"px":m.el.style.right=""}}}}}).call(d.prototype);c.LineWidgets=d});
(function(){ace.require(["ace/ace"],function(b){b&&b.config.init();window.ace||(window.ace={});for(var c in b)b.hasOwnProperty(c)&&(ace[c]=b[c])})})();
ace.define("ace/ext/language_tools","require exports module ace/snippets ace/autocomplete ace/config ace/autocomplete/text_completer ace/editor".split(" "),function(b,c){var d=b("../snippets").snippetManager,e=b("../autocomplete").Autocomplete,f=b("../config"),g=[{getCompletions:function(b,c,e,f,g){var h=d.snippetMap,j=[];d.getActiveScopes(b).forEach(function(b){for(var b=h[b]||[],c=b.length;c--;){var d=b[c],e=d.name||d.tabTrigger;e&&j.push({caption:e,snippet:d.content,meta:d.tabTrigger&&!d.name?
d.tabTrigger+"\u21e5 ":"snippet"})}},this);g(null,j)}},b("../autocomplete/text_completer"),{getCompletions:function(b,c,d,e,f){b=b.session.getState(d.row);c=c.$mode.getCompletions(b,c,d,e);f(null,c)}}];c.addCompleter=function(b){g.push(b)};var h={name:"expandSnippet",exec:function(b){d.expandWithTab(b)||b.execCommand("indent")},bindKey:"tab"},j=function(b,c){k(c.session.$mode)},k=function(b){var c=b.$id;d.files||(d.files={});l(c);b.modes&&b.modes.forEach(k)},l=function(b){if(b&&!d.files[b]){var c=
b.replace("mode","snippets");d.files[b]={};f.loadModule(c,function(c){c&&(d.files[b]=c,c.snippets=d.parseSnippetFile(c.snippetText),d.register(c.snippets,c.scope),c.includeScopes&&(d.snippetMap[c.scope].includeScopes=c.includeScopes,c.includeScopes.forEach(function(b){l("ace/mode/"+b)})))})}},m=b("../editor").Editor;b("../config").defineOptions(m.prototype,"editor",{enableBasicAutocompletion:{set:function(b){b?(this.completers=g,this.commands.addCommand(e.startCommand)):this.commands.removeCommand(e.startCommand)},
value:false},enableSnippets:{set:function(b){b?(this.commands.addCommand(h),this.on("changeMode",j),j(null,this)):(this.commands.removeCommand(h),this.off("changeMode",j))},value:false}})});
ace.define("ace/snippets","require exports module ace/lib/lang ace/range ace/keyboard/hash_handler ace/tokenizer ace/lib/dom".split(" "),function(b,c){var d=b("./lib/lang"),e=b("./range").Range,f=b("./keyboard/hash_handler").HashHandler,g=b("./tokenizer").Tokenizer,h=e.comparePoints,j=function(){this.snippetMap={};this.snippetNameMap={}};(function(){this.getTokenizer=function(){function b(c,d,e){return c=c.substr(1),/^\d+$/.test(c)&&!e.inFormatString?[{tabstopId:parseInt(c,10)}]:[{text:c}]}function c(b){return"(?:[^\\\\"+
b+"]|\\\\.)"}return j.$tokenizer=new g({start:[{regex:/:/,onMatch:function(b,c,d){return d.length&&d[0].expectIf?(d[0].expectIf=false,d[0].elseBranch=d[0],[d[0]]):":"}},{regex:/\\./,onMatch:function(b,c,d){c=b[1];return c=="}"&&d.length?b=c:"`$\\".indexOf(c)!=-1?b=c:d.inFormatString&&(c=="n"?b="\n":c=="t"?b="\n":"ulULE".indexOf(c)!=-1&&(b={changeCase:c,local:c>"a"})),[b]}},{regex:/}/,onMatch:function(b,c,d){return[d.length?d.shift():b]}},{regex:/\$(?:\d+|\w+)/,onMatch:b},{regex:/\$\{[\dA-Z_a-z]+/,
onMatch:function(c,d,e){c=b(c.substr(1),d,e);return e.unshift(c[0]),c},next:"snippetVar"},{regex:/\n/,token:"newline",merge:false}],snippetVar:[{regex:"\\|"+c("\\|")+"*\\|",onMatch:function(b,c,d){d[0].choices=b.slice(1,-1).split(",")},next:"start"},{regex:"/("+c("/")+"+)/(?:("+c("/")+"*)/)(\\w*):?",onMatch:function(b,c,d){c=d[0];return c.fmtString=b,b=this.splitRegex.exec(b),c.guard=b[1],c.fmt=b[2],c.flag=b[3],""},next:"start"},{regex:"`"+c("`")+"*`",onMatch:function(b,c,d){return d[0].code=b.splice(1,
-1),""},next:"start"},{regex:"\\?",onMatch:function(b,c,d){d[0]&&(d[0].expectIf=true)},next:"start"},{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"start"}],formatString:[{regex:"/("+c("/")+"+)/",token:"regex"},{regex:"",onMatch:function(b,c,d){d.inFormatString=true},next:"start"}]}),j.prototype.getTokenizer=function(){return j.$tokenizer},j.$tokenizer};this.tokenizeTmSnippet=function(b,c){return this.getTokenizer().getLineTokens(b,c).tokens.map(function(b){return b.value||b})};this.$getDefaultValue=
function(b,c){if(/^[A-Z]\d+$/.test(c)){var d=c.substr(1);return(this.variables[c[0]+"__"]||{})[d]}if(/^\d+$/.test(c))return(this.variables.__||{})[c];c=c.replace(/^TM_/,"");if(b){d=b.session;switch(c){case "CURRENT_WORD":var e=d.getWordRange();case "SELECTION":case "SELECTED_TEXT":return d.getTextRange(e);case "CURRENT_LINE":return d.getLine(b.getCursorPosition().row);case "PREV_LINE":return d.getLine(b.getCursorPosition().row-1);case "LINE_INDEX":return b.getCursorPosition().column;case "LINE_NUMBER":return b.getCursorPosition().row+
1;case "SOFT_TABS":return d.getUseSoftTabs()?"YES":"NO";case "TAB_SIZE":return d.getTabSize();case "FILENAME":case "FILEPATH":return"ace.ajax.org";case "FULLNAME":return"Ace"}}};this.variables={};this.getVariableValue=function(b,c){return this.variables.hasOwnProperty(c)?this.variables[c](b,c)||"":this.$getDefaultValue(b,c)||""};this.tmStrFormat=function(b,c,d){var e=c.guard,e=RegExp(e,(c.flag||"").replace(/[^gi]/,"")),f=this.tokenizeTmSnippet(c.fmt,"formatString"),g=this,b=b.replace(e,function(){g.variables.__=
arguments;for(var b=g.resolveVariables(f,d),c="E",e=0;e<b.length;e++){var h=b[e];if(typeof h=="object"){b[e]="";if(h.changeCase&&h.local){var j=b[e+1];j&&typeof j=="string"&&(h.changeCase=="u"?b[e]=j[0].toUpperCase():b[e]=j[0].toLowerCase(),b[e+1]=j.substr(1))}else h.changeCase&&(c=h.changeCase)}else c=="U"?b[e]=h.toUpperCase():c=="L"&&(b[e]=h.toLowerCase())}return b.join("")});return this.variables.__=null,b};this.resolveVariables=function(b,c){function d(c){c=b.indexOf(c,f+1);c!=-1&&(f=c)}for(var e=
[],f=0;f<b.length;f++){var g=b[f];if(typeof g=="string")e.push(g);else if(typeof g=="object")if(g.skip)d(g);else if(!(g.processed<f))if(g.text){var h=this.getVariableValue(c,g.text);h&&g.fmtString&&(h=this.tmStrFormat(h,g));g.processed=f;g.expectIf==null?h&&(e.push(h),d(g)):h?g.skip=g.elseBranch:d(g)}else g.tabstopId!=null?e.push(g):g.changeCase!=null&&e.push(g)}return e};this.insertSnippet=function(b,c){function d(b){for(var c=[],e=0;e<b.length;e++){var f=b[e];if(typeof f=="object"){if(l[f.tabstopId])continue;
var g=b.lastIndexOf(f,e-1),f=c[g]||{tabstopId:f.tabstopId}}c[e]=f}return c}var e=b.getCursorPosition(),f=b.session.getLine(e.row).match(/^\s*/)[0],g=b.session.getTabString(),h=this.tokenizeTmSnippet(c),h=this.resolveVariables(h,b),h=h.map(function(b){return b=="\n"?b+f:typeof b=="string"?b.replace(/\t/g,g):b}),j=[];h.forEach(function(b,c){if(typeof b=="object"){var d=b.tabstopId,e=j[d];e||(e=j[d]=[],e.index=d,e.value="");if(e.indexOf(b)===-1){e.push(b);d=h.indexOf(b,c+1);if(d!==-1){d=h.slice(c+1,
d);d.some(function(b){return typeof b=="object"})&&!e.value?e.value=d:d.length&&(!e.value||typeof e.value!="string")&&(e.value=d.join(""))}}}});j.forEach(function(b){b.length=0});for(var l={},e=0;e<h.length;e++){var w=h[e];if(typeof w=="object"){var z=w.tabstopId,A=h.indexOf(w,e+1);if(l[z]==w)l[z]=null;else{var C=j[z],G=typeof C.value=="string"?[C.value]:d(C.value);G.unshift(e+1,Math.max(0,A-e));G.push(w);l[z]=w;h.splice.apply(h,G);C.indexOf(w)===-1&&C.push(w)}}}var H=0,K=0,P="";h.forEach(function(b){typeof b==
"string"?(b[0]==="\n"?(K=b.length-1,H++):K=K+b.length,P=P+b):b.start?b.end={row:H,column:K}:b.start={row:H,column:K}});e=b.getSelectionRange();w=b.session.replace(e,P);z=new k(b);z.addTabstops(j,e.start,w);z.tabNext()};this.$getScope=function(b){var c=b.session.$mode.$id||"",c=c.split("/").pop();if(c==="html"||c==="php"){c==="php"&&(c="html");var d=b.getCursorPosition(),b=b.session.getState(d.row);typeof b=="object"&&(b=b[0]);b.substring&&(b.substring(0,3)=="js-"?c="javascript":b.substring(0,4)==
"css-"?c="css":b.substring(0,4)=="php-"&&(c="php"))}return c};this.getActiveScopes=function(b){var b=this.$getScope(b),c=[b],d=this.snippetMap;return d[b]&&d[b].includeScopes&&c.push.apply(c,d[b].includeScopes),c.push("_"),c};this.expandWithTab=function(b){var c=b.getCursorPosition(),d=b.session.getLine(c.row),e=d.substring(0,c.column),f=d.substr(c.column),g=this.snippetMap,h;return this.getActiveScopes(b).some(function(b){b=g[b];return b&&(h=this.findMatchingSnippet(b,e,f)),!!h},this),h?(b.session.doc.removeInLine(c.row,
c.column-h.replaceBefore.length,c.column+h.replaceAfter.length),this.variables.M__=h.matchBefore,this.variables.T__=h.matchAfter,this.insertSnippet(b,h.content),this.variables.M__=this.variables.T__=null,true):false};this.findMatchingSnippet=function(b,c,d){for(var e=b.length;e--;){var f=b[e];if(!f.startRe||f.startRe.test(c))if(!f.endRe||f.endRe.test(d))if(f.startRe||f.endRe)return f.matchBefore=f.startRe?f.startRe.exec(c):[""],f.matchAfter=f.endRe?f.endRe.exec(d):[""],f.replaceBefore=f.triggerRe?
f.triggerRe.exec(c)[0]:"",f.replaceAfter=f.endTriggerRe?f.endTriggerRe.exec(d)[0]:"",f}};this.snippetMap={};this.snippetNameMap={};this.register=function(b,c){function e(b){return b&&!/^\^?\(.*\)\$?$|^\\b$/.test(b)&&(b="(?:"+b+")"),b||""}function f(b,c,d){return b=e(b),c=e(c),d?(b=c+b,b&&b[b.length-1]!="$"&&(b=b+"$")):(b=b+c,b&&b[0]!="^"&&(b="^"+b)),RegExp(b)}function g(b){b.scope||(b.scope=c||"_");c=b.scope;h[c]||(h[c]=[],j[c]={});var e=j[c];if(b.name){var l=e[b.name];l&&k.unregister(l);e[b.name]=
b}h[c].push(b);b.tabTrigger&&!b.trigger&&(!b.guard&&/^\w/.test(b.tabTrigger)&&(b.guard="\\b"),b.trigger=d.escapeRegExp(b.tabTrigger));b.startRe=f(b.trigger,b.guard,true);b.triggerRe=RegExp(b.trigger,"",true);b.endRe=f(b.endTrigger,b.endGuard,true);b.endTriggerRe=RegExp(b.endTrigger,"",true)}var h=this.snippetMap,j=this.snippetNameMap,k=this;b.content?g(b):Array.isArray(b)&&b.forEach(g)};this.unregister=function(b,c){function d(b){var g=f[b.scope||c];if(g&&g[b.name]){delete g[b.name];b=(g=e[b.scope||
c])&&g.indexOf(b);b>=0&&g.splice(b,1)}}var e=this.snippetMap,f=this.snippetNameMap;b.content?d(b):Array.isArray(b)&&b.forEach(d)};this.parseSnippetFile=function(b){for(var b=b.replace(/\r/g,""),c=[],d={},e=/^#.*|^({[\s\S]*})\s*$|^(\S+) (.*)$|^((?:\n*\t.*)+)/gm,f;f=e.exec(b);){if(f[1])try{d=JSON.parse(f[1]);c.push(d)}catch(g){}if(f[4]){d.content=f[4].replace(/^\t/gm,"");c.push(d);d={}}else{var h=f[2];f=f[3];if(h=="regex"){h=/\/((?:[^\/\\]|\\.)*)|$/g;d.guard=h.exec(f)[1];d.trigger=h.exec(f)[1];d.endTrigger=
h.exec(f)[1];d.endGuard=h.exec(f)[1]}else h=="snippet"?(d.tabTrigger=f.match(/^\S*/)[0],d.name||(d.name=f)):d[h]=f}}return c};this.getSnippetByName=function(b,c){var d=this.snippetNameMap,e;return this.getActiveScopes(c).some(function(c){c=d[c];return c&&(e=c[b]),!!e},this),e}}).call(j.prototype);var k=function(b){if(b.tabstopManager)return b.tabstopManager;b.tabstopManager=this;this.$onChange=this.onChange.bind(this);this.$onChangeSelection=d.delayedCall(this.onChangeSelection.bind(this)).schedule;
this.$onChangeSession=this.onChangeSession.bind(this);this.$onAfterExec=this.onAfterExec.bind(this);this.attach(b)};(function(){this.attach=function(b){this.index=-1;this.ranges=[];this.tabstops=[];this.selectedTabstop=null;this.editor=b;this.editor.on("change",this.$onChange);this.editor.on("changeSelection",this.$onChangeSelection);this.editor.on("changeSession",this.$onChangeSession);this.editor.commands.on("afterExec",this.$onAfterExec);this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)};
this.detach=function(){this.tabstops.forEach(this.removeTabstopMarkers,this);this.selectedTabstop=this.tabstops=this.ranges=null;this.editor.removeListener("change",this.$onChange);this.editor.removeListener("changeSelection",this.$onChangeSelection);this.editor.removeListener("changeSession",this.$onChangeSession);this.editor.commands.removeListener("afterExec",this.$onAfterExec);this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);this.editor=this.editor.tabstopManager=null};this.onChange=
function(b){var c=b.data.range,d=b.data.action[0]=="r",e=c.start,f=c.end,c=e.row,b=f.row-c,g=f.column-e.column;d&&(b=-b,g=-g);if(!this.$inChange&&d&&!this.selectedTabstop.some(function(b){return h(b.start,e)<=0&&h(b.end,f)>=0}))return this.detach();for(var d=this.ranges,j=0;j<d.length;j++){var k=d[j];if(!(k.end.row<e.row))if(h(e,k.start)<0&&h(f,k.end)>0){this.removeRange(k);j--}else{k.start.row==c&&k.start.column>e.column&&(k.start.column=k.start.column+g);k.end.row==c&&k.end.column>=e.column&&(k.end.column=
k.end.column+g);k.start.row>=c&&(k.start.row=k.start.row+b);k.end.row>=c&&(k.end.row=k.end.row+b);h(k.start,k.end)>0&&this.removeRange(k)}}d.length||this.detach()};this.updateLinkedFields=function(){var b=this.selectedTabstop;if(b.hasLinkedRanges){this.$inChange=true;for(var d=this.editor.session,e=d.getTextRange(b.firstNonLinked),f=b.length;f--;){var g=b[f];if(g.linked){var h=c.snippetManager.tmStrFormat(e,g.original);d.replace(g,h)}}this.$inChange=false}};this.onAfterExec=function(b){b.command&&
!b.command.readOnly&&this.updateLinkedFields()};this.onChangeSelection=function(){if(this.editor){for(var b=this.editor.selection.lead,c=this.editor.selection.anchor,d=this.editor.selection.isEmpty(),e=this.ranges.length;e--;)if(!this.ranges[e].linked){var f=this.ranges[e].contains(b.row,b.column),g=d||this.ranges[e].contains(c.row,c.column);if(f&&g)return}this.detach()}};this.onChangeSession=function(){this.detach()};this.tabNext=function(b){var c=this.tabstops.length-1,b=this.index+(b||1),b=Math.min(Math.max(b,
0),c);this.selectTabstop(b);b==c&&this.detach()};this.selectTabstop=function(b){var c=this.tabstops[this.index];c&&this.addTabstopMarkers(c);this.index=b;if((c=this.tabstops[this.index])&&c.length){this.selectedTabstop=c;if(this.editor.inVirtualSelectionMode)this.editor.selection.setRange(c.firstNonLinked);else{b=this.editor.multiSelect;b.toSingleRange(c.firstNonLinked.clone());for(var d=c.length;d--;)(!c.hasLinkedRanges||!c[d].linked)&&b.addRange(c[d].clone(),true)}this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)}};
this.addTabstops=function(b,c,d){if(!b[0]){d=e.fromPoints(d,d);l(d.start,c);l(d.end,c);b[0]=[d];b[0].index=0}var f=[this.index,0],g=this.ranges;b.forEach(function(b){for(var d=b.length;d--;){var h=b[d],j=e.fromPoints(h.start,h.end||h.start),k=j.start,l=c;k.row==0&&(k.column=k.column+l.column);k.row=k.row+l.row;k=j.end;l=c;k.row==0&&(k.column=k.column+l.column);k.row=k.row+l.row;j.original=h;j.tabstop=b;g.push(j);b[d]=j;h.fmtString?(j.linked=true,b.hasLinkedRanges=true):b.firstNonLinked||(b.firstNonLinked=
j)}b.firstNonLinked||(b.hasLinkedRanges=false);f.push(b);this.addTabstopMarkers(b)},this);f.push(f.splice(2,1)[0]);this.tabstops.splice.apply(this.tabstops,f)};this.addTabstopMarkers=function(b){var c=this.editor.session;b.forEach(function(b){b.markerId||(b.markerId=c.addMarker(b,"ace_snippet-marker","text"))})};this.removeTabstopMarkers=function(b){var c=this.editor.session;b.forEach(function(b){c.removeMarker(b.markerId);b.markerId=null})};this.removeRange=function(b){var c=b.tabstop.indexOf(b);
b.tabstop.splice(c,1);c=this.ranges.indexOf(b);this.ranges.splice(c,1);this.editor.session.removeMarker(b.markerId)};this.keyboardHandler=new f;this.keyboardHandler.bindKeys({Tab:function(b){(!c.snippetManager||!c.snippetManager.expandWithTab(b))&&b.tabstopManager.tabNext(1)},"Shift-Tab":function(b){b.tabstopManager.tabNext(-1)},Esc:function(b){b.tabstopManager.detach()},Return:function(){return false}})}).call(k.prototype);var l=function(b,c){b.row==c.row&&(b.column=b.column-c.column);b.row=b.row-
c.row};b("./lib/dom").importCssString(".ace_snippet-marker {    -moz-box-sizing: border-box;    box-sizing: border-box;    background: rgba(194, 193, 208, 0.09);    border: 1px dotted rgba(211, 208, 235, 0.62);    position: absolute;}");c.snippetManager=new j});
ace.define("ace/autocomplete","require exports module ace/keyboard/hash_handler ace/autocomplete/popup ace/autocomplete/util ace/lib/event ace/lib/lang ace/snippets".split(" "),function(b,c){var d=b("./keyboard/hash_handler").HashHandler,e=b("./autocomplete/popup").AcePopup,f=b("./autocomplete/util"),g=b("./lib/event"),h=b("./lib/lang"),j=b("./snippets").snippetManager,k=function(){this.autoInsert=true;this.keyboardHandler=new d;this.keyboardHandler.bindKeys(this.commands);this.blurListener=this.blurListener.bind(this);
this.changeListener=this.changeListener.bind(this);this.mousedownListener=this.mousedownListener.bind(this);this.mousewheelListener=this.mousewheelListener.bind(this);this.changeTimer=h.delayedCall(function(){this.updateCompletions(true)}.bind(this))};(function(){this.$init=function(){this.popup=new e(document.body||document.documentElement);this.popup.on("click",function(b){this.insertMatch();b.stop()}.bind(this))};this.openPopup=function(b,c,d){this.popup||this.$init();this.popup.setData(this.completions.filtered);
c=b.renderer;if(!d){this.popup.setRow(0);this.popup.setFontSize(b.getFontSize());var d=c.layerConfig.lineHeight,e=c.$cursorLayer.getPixelPosition(this.base,true);e.left=e.left-this.popup.getTextLeftOffset();var f=b.container.getBoundingClientRect();e.top=e.top+(f.top-c.layerConfig.offset);e.left=e.left+(f.left-b.renderer.scrollLeft);e.left=e.left+c.$gutterLayer.gutterWidth;this.popup.show(e,d)}};this.detach=function(){this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);this.editor.off("changeSelection",
this.changeListener);this.editor.off("blur",this.changeListener);this.editor.off("mousedown",this.mousedownListener);this.editor.off("mousewheel",this.mousewheelListener);this.changeTimer.cancel();this.popup&&this.popup.hide();this.activated=false;this.completions=this.base=null};this.changeListener=function(){var b=this.editor.selection.lead;(b.row!=this.base.row||b.column<this.base.column)&&this.detach();this.activated?this.changeTimer.schedule():this.detach()};this.blurListener=function(){document.activeElement!=
this.editor.textInput.getElement()&&this.detach()};this.mousedownListener=function(){this.detach()};this.mousewheelListener=function(){this.detach()};this.goTo=function(b){var c=this.popup.getRow(),d=this.popup.session.getLength()-1;switch(b){case "up":c=c<0?d:c-1;break;case "down":c=c>=d?-1:c+1;break;case "start":c=0;break;case "end":c=d}this.popup.setRow(c)};this.insertMatch=function(b){b||(b=this.popup.getData(this.popup.getRow()));if(!b)return false;if(b.completer&&b.completer.insertMatch)b.completer.insertMatch(this.editor);
else{if(this.completions.filterText)for(var c=this.editor.selection.getAllRanges(),d=0,e;e=c[d];d++){e.start.column=e.start.column-this.completions.filterText.length;this.editor.session.remove(e)}b.snippet?j.insertSnippet(this.editor,b.snippet):this.editor.execCommand("insertstring",b.value||b)}this.detach()};this.commands={Up:function(b){b.completer.goTo("up")},Down:function(b){b.completer.goTo("down")},"Ctrl-Up|Ctrl-Home":function(b){b.completer.goTo("start")},"Ctrl-Down|Ctrl-End":function(b){b.completer.goTo("end")},
Esc:function(b){b.completer.detach()},Space:function(b){b.completer.detach();b.insert(" ")},Return:function(b){b.completer.insertMatch()},"Shift-Return":function(b){b.completer.insertMatch(true)},Tab:function(b){b.completer.insertMatch()},PageUp:function(b){b.completer.popup.gotoPageUp()},PageDown:function(b){b.completer.popup.gotoPageDown()}};this.gatherCompletions=function(b,c){var d=b.getSession(),e=b.getCursorPosition(),g=d.getLine(e.row),h=f.retrievePrecedingIdentifier(g,e.column);this.base=
b.getCursorPosition();this.base.column=this.base.column-h.length;var j=[];return f.parForEach(b.completers,function(c,f){c.getCompletions(b,d,e,h,function(b,c){b||(j=j.concat(c));f()})},function(){c(null,{prefix:h,matches:j})}),true};this.showPopup=function(b){this.editor&&this.detach();this.activated=true;this.editor=b;b.completer!=this&&(b.completer&&b.completer.detach(),b.completer=this);b.keyBinding.addKeyboardHandler(this.keyboardHandler);b.on("changeSelection",this.changeListener);b.on("blur",
this.blurListener);b.on("mousedown",this.mousedownListener);b.on("mousewheel",this.mousewheelListener);this.updateCompletions()};this.updateCompletions=function(b){if(b&&this.base&&this.completions){var c=this.editor.session.getTextRange({start:this.base,end:this.editor.getCursorPosition()});if(c!=this.completions.filterText){this.completions.setFilter(c);if(!this.completions.filtered.length)return this.detach();this.openPopup(this.editor,c,b)}}else this.gatherCompletions(this.editor,function(c,d){var e=
d&&d.matches;if(!e||!e.length)return this.detach();this.completions=new l(e);this.completions.setFilter(d.prefix);e=this.completions.filtered;if(!e.length)return this.detach();if(this.autoInsert&&e.length==1)return this.insertMatch(e[0]);this.openPopup(this.editor,d.prefix,b)}.bind(this))};this.cancelContextMenu=function(){var b=function(c){this.editor.off("nativecontextmenu",b);c&&c.domEvent&&g.stopEvent(c.domEvent)}.bind(this);setTimeout(b,10);this.editor.on("nativecontextmenu",b)}}).call(k.prototype);
k.startCommand={name:"startAutocomplete",exec:function(b){b.completer||(b.completer=new k);b.completer.showPopup(b);b.completer.cancelContextMenu()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"};var l=function(b,c){this.filtered=this.all=b;this.filterText=c||""};(function(){this.setFilter=function(b){var c=b.length>this.filterText&&b.lastIndexOf(this.filterText,0)===0?this.filtered:this.all;this.filterText=b;var c=this.filterCompletions(c,this.filterText),c=c.sort(function(b,c){return c.exactMatch-
b.exactMatch||c.score-b.score}),d=null;this.filtered=c=c.filter(function(b){b=b.value||b.caption||b.snippet;return b===d?false:(d=b,true)})};this.filterCompletions=function(b,c){var d=[],e=c.toUpperCase(),f=c.toLowerCase(),g=0,h;a:for(;h=b[g];g++){var j=h.value||h.caption||h.snippet;if(j){for(var k=-1,l=0,z=0,A,C,G=0;G<c.length;G++){A=j.indexOf(f[G],k+1);C=j.indexOf(e[G],k+1);A=A>=0?C<0||A<C?A:C:C;if(A<0)continue a;C=A-k-1;C>0&&(k===-1&&(z=z+10),z=z+C);l=l|1<<A;k=A}h.matchMask=l;h.exactMatch=z?0:
1;h.score=(h.score||0)-z;d.push(h)}}return d}}).call(l.prototype);c.Autocomplete=k;c.FilteredList=l});
ace.define("ace/autocomplete/popup","require exports module ace/edit_session ace/virtual_renderer ace/editor ace/range ace/lib/event ace/lib/lang ace/lib/dom".split(" "),function(b,c){b("../edit_session");var d=b("../virtual_renderer").VirtualRenderer,e=b("../editor").Editor,f=b("../range").Range,g=b("../lib/event"),h=b("../lib/lang"),j=b("../lib/dom"),k=function(b){b=new d(b);b.$maxLines=4;b=new e(b);return b.setHighlightActiveLine(false),b.setShowPrintMargin(false),b.renderer.setShowGutter(false),
b.renderer.setHighlightGutterLine(false),b.$mouseHandler.$focusWaitTimout=0,b};j.importCssString(".ace_autocomplete.ace-tm .ace_marker-layer .ace_active-line {    background-color: #CAD6FA;    z-index: 1;}.ace_autocomplete.ace-tm .ace_line-hover {    border: 1px solid #abbffe;    margin-top: -1px;    background: rgba(233,233,253,0.4);}.ace_autocomplete .ace_line-hover {    position: absolute;    z-index: 2;}.ace_rightAlignedText {    color: gray;    display: inline-block;    position: absolute;    right: 4px;    text-align: right;    z-index: -1;}.ace_autocomplete .ace_completion-highlight{    color: #000;    text-shadow: 0 0 0.01em;}.ace_autocomplete {    width: 280px;    z-index: 200000;    background: #fbfbfb;    color: #444;    border: 1px lightgray solid;    position: fixed;    box-shadow: 2px 3px 5px rgba(0,0,0,.2);    line-height: 1.4;}");
c.AcePopup=function(b){var c=j.createElement("div"),d=new k(c);b&&b.appendChild(c);c.style.display="none";d.renderer.content.style.cursor="default";d.renderer.setStyle("ace_autocomplete");d.setOption("displayIndentGuides",false);b=function(){};d.focus=b;d.$isFocused=true;d.renderer.$cursorLayer.restartTimer=b;d.renderer.$cursorLayer.element.style.opacity=0;d.renderer.$maxLines=8;d.renderer.$keepTextAreaAtCursor=false;d.setHighlightActiveLine(false);d.session.highlight("");d.session.$searchHighlight.clazz=
"ace_highlight-marker";d.on("mousedown",function(b){var c=b.getDocumentPosition();d.moveCursorToPosition(c);d.selection.clearSelection();s.start.row=s.end.row=c.row;b.stop()});var e,p=new f(-1,0,-1,Infinity),s=new f(-1,0,-1,Infinity);s.id=d.session.addMarker(s,"ace_active-line","fullLine");d.setSelectOnHover=function(b){b?p.id&&(d.session.removeMarker(p.id),p.id=null):p.id=d.session.addMarker(p,"ace_line-hover","fullLine")};d.setSelectOnHover(false);d.on("mousemove",function(b){if(e){if(!(e.x==b.x&&
e.y==b.y)){e=b;e.scrollTop=d.renderer.scrollTop;b=e.getDocumentPosition().row;p.start.row!=b&&(p.id||d.setRow(b),r(b))}}else e=b});d.renderer.on("beforeRender",function(){if(e&&p.start.row!=-1){e.$pos=null;var b=e.getDocumentPosition().row;p.id||d.setRow(b);r(b,true)}});d.renderer.on("afterRender",function(){var b=d.getRow(),c=d.renderer.$textLayer,b=c.element.childNodes[b-c.config.firstRow];if(b!=c.selectedNode){c.selectedNode&&j.removeCssClass(c.selectedNode,"ace_selected");(c.selectedNode=b)&&
j.addCssClass(b,"ace_selected")}});var c=function(){r(-1)},r=function(b,c){b!==p.start.row&&(p.start.row=p.end.row=b,c||d.session._emit("changeBackMarker"),d._emit("changeHoverMarker"))};d.getHoveredRow=function(){return p.start.row};g.addListener(d.container,"mouseout",c);d.on("hide",c);d.on("changeSelection",c);d.session.doc.getLength=function(){return d.data.length};d.session.doc.getLine=function(b){b=d.data[b];return typeof b=="string"?b:b&&b.value||""};c=d.session.bgTokenizer;return c.$tokenizeRow=
function(b){var c=d.data[b],e=[];if(!c)return e;typeof c=="string"&&(c={value:c});c.caption||(c.caption=c.value);for(var f=-1,g,h,b=0;b<c.caption.length;b++){h=c.caption[b];g=c.matchMask&1<<b?1:0;f!==g?(e.push({type:c.className||""+(g?"completion-highlight":""),value:h}),f=g):e[e.length-1].value=e[e.length-1].value+h}c.meta&&c.meta.length+c.caption.length<d.renderer.$size.scrollerWidth/d.renderer.layerConfig.characterWidth-2&&e.push({type:"rightAlignedText",value:c.meta});return e},c.$updateOnChange=
b,c.start=b,d.session.$computeWidth=function(){return this.screenWidth=0},d.isOpen=false,d.isTopdown=false,d.data=[],d.setData=function(b){d.data=b||[];d.setValue(h.stringRepeat("\n",b.length),-1);d.setRow(0)},d.getData=function(b){return d.data[b]},d.getRow=function(){return s.start.row},d.setRow=function(b){b=Math.max(-1,Math.min(this.data.length,b));s.start.row!=b&&(d.selection.clearSelection(),s.start.row=s.end.row=b||0,d.session._emit("changeBackMarker"),d.moveCursorTo(b||0,0),d.isOpen&&d._signal("select"))},
d.on("changeSelection",function(){d.isOpen&&d.setRow(d.selection.lead.row)}),d.hide=function(){this.container.style.display="none";this._signal("hide");d.isOpen=false},d.show=function(b,c,f){var g=this.container,h=window.innerHeight,j=window.innerWidth,k=b.top+this.$borderSize;k+this.renderer.$maxLines*c*1.4>h-c&&!f?(g.style.top="",g.style.bottom=h-k+"px",d.isTopdown=false):(k=k+c,g.style.top=k+"px",g.style.bottom="",d.isTopdown=true);g.style.display="";this.renderer.$textLayer.checkForSizeChanges();
b=b.left;b+g.offsetWidth>j&&(b=j-g.offsetWidth);g.style.left=b+"px";this._signal("show");e=null;d.isOpen=true},d.getTextLeftOffset=function(){return this.$borderSize+this.renderer.$padding+this.$imageSize},d.$imageSize=0,d.$borderSize=1,d}});
ace.define("ace/autocomplete/util",["require","exports","module"],function(b,c){c.parForEach=function(b,c,d){var h=0,j=b.length;0===j&&d();for(var k=0;k<j;k++)c(b[k],function(b,c){h++;h===j&&d(b,c)})};var d=/[a-zA-Z_0-9\$-]/;c.retrievePrecedingIdentifier=function(b,c,g){for(var g=g||d,h=[],c=c-1;0<=c&&g.test(b[c]);c--)h.push(b[c]);return h.reverse().join("")};c.retrieveFollowingIdentifier=function(b,c,g){for(var g=g||d,h=[];c<b.length&&g.test(b[c]);c++)h.push(b[c]);return h}});
ace.define("ace/autocomplete/text_completer",["require","exports","module","ace/range"],function(b,c){function d(b,c){var d=b.getTextRange(e.fromPoints({row:0,column:0},c)).split(f).length-1,k=b.getValue().split(f),l=Object.create(null),m=k[d];return k.forEach(function(b,c){if(b&&b!==m){var e=Math.abs(d-c),e=k.length-e;l[b]?l[b]=Math.max(e,l[b]):l[b]=e}}),l}var e=b("ace/range").Range,f=/[^a-zA-Z_0-9\$\-]+/;c.getCompletions=function(b,c,e,f,l){var m=d(c,e,f),b=Object.keys(m);l(null,b.map(function(b){return{name:b,
value:b,score:m[b],meta:"local"}}))}});
(function(b){b.fn.jqte=function(c){function d(b,c,d,e,f){return h.push({name:b,cls:h.length+1,command:c,key:d,tag:e,emphasis:f})}var e=["0,0,0","68,68,68","102,102,102","153,153,153","204,204,204","238,238,238","243,243,243","255,255,255",null,"255,0,0","255,153,0","255,255,0","0,255,0","0,255,255","0,0,255","153,0,255","255,0,255",null,"244,204,204","252,229,205","255,242,204","217,234,211","208,224,227","207,226,243","217,210,233","234,209,220","234,153,153","249,203,156","255,229,153","182,215,168",
"162,196,201","159,197,232","180,167,214","213,166,189","224,102,102","246,178,107","255,217,102","147,196,125","118,165,175","111,168,220","142,124,195","194,123,160","204,0,0","230,145,56","241,194,50","106,168,79","69,129,142","61,133,198","103,78,167","166,77,121","153,0,0","180,95,6","191,144,0","56,118,29","19,79,92","11,83,148","53,28,117","116,27,71","102,0,0","120,63,4","127,96,0","39,78,19","12,52,61","7,55,99","32,18,77","76,17,48"],f=b.extend({status:!0,css:"jqte",title:!0,titletext:[{title:"Text Format"},
{title:"Font Size"},{title:"Color"},{title:"Bold",hotkey:"B"},{title:"Italic",hotkey:"I"},{title:"Underline",hotkey:"U"},{title:"Ordered List",hotkey:"."},{title:"Unordered List",hotkey:","},{title:"Subscript",hotkey:"down arrow"},{title:"Superscript",hotkey:"up arrow"},{title:"Outdent",hotkey:"left arrow"},{title:"Indent",hotkey:"right arrow"},{title:"Justify Left"},{title:"Justify Center"},{title:"Justify Right"},{title:"Strike Through",hotkey:"K"},{title:"Add Link",hotkey:"L"},{title:"Remove Link"},
{title:"Cleaner Style",hotkey:"Delete"},{title:"Horizontal Rule",hotkey:"H"},{title:"Source"}],button:"OK",format:!0,formats:[["p","Normal"],["h1","Header 1"],["h2","Header 2"],["h3","Header 3"],["h4","Header 4"],["h5","Header 5"],["h6","Header 6"],["pre","Preformatted"]],fsize:!0,fsizes:"10 12 16 18 20 24 28".split(" "),funit:"px",color:!0,linktypes:["Web Address","E-mail Address","Picture URL"],b:!0,i:!0,u:!0,ol:!0,ul:!0,sub:!0,sup:!0,outdent:!0,indent:!0,left:!0,center:!0,right:!0,strike:!0,link:!0,
unlink:!0,remove:!0,rule:!0,source:!0,placeholder:!1,br:!0,p:!0,change:"",focus:"",blur:""},c);b.fn.jqteVal=function(c){b(this).closest("."+f.css).find("."+f.css+"_editor").html(c)};var g=navigator.userAgent.toLowerCase();/msie [1-7]./.test(g)&&(f.title=!1);var h=[];d("format","formats","","",!1);d("fsize","fSize","","",!1);d("color","colors","","",!1);d("b","Bold","B",["b","strong"],!0);d("i","Italic","I",["i","em"],!0);d("u","Underline","U",["u"],!0);d("ol","insertorderedlist","\u00be",["ol"],!0);
d("ul","insertunorderedlist","\u00bc",["ul"],!0);d("sub","subscript","(",["sub"],!0);d("sup","superscript","&",["sup"],!0);d("outdent","outdent","%",["blockquote"],!1);d("indent","indent","'",["blockquote"],!0);d("left","justifyLeft","","",!1);d("center","justifyCenter","","",!1);d("right","justifyRight","","",!1);d("strike","strikeThrough","K",["strike"],!0);d("link","linkcreator","L",["a"],!0);d("unlink","unlink","",["a"],!1);d("remove","removeformat",".","",!1);d("rule","inserthorizontalrule",
"H",["hr"],!1);d("source","displaysource","","",!1);return this.each(function(){function c(){if(window.getSelection)return window.getSelection();if(document.selection&&document.selection.createRange&&document.selection.type!="None")return document.selection.createRange()}function d(b,e){var f,h=c();if(window.getSelection){h.anchorNode&&h.getRangeAt&&(f=h.getRangeAt(0));if(f){h.removeAllRanges();h.addRange(f)}g.match(/msie/)||document.execCommand("StyleWithCSS",false,false);document.execCommand(b,
false,e)}else if(document.selection&&document.selection.createRange&&document.selection.type!="None"){f=document.selection.createRange();f.execCommand(b,false,e)}m(false,false)}function l(d,e,f){E.not(":focus")&&E.focus();if(window.getSelection){var g=c(),h,k;if(g.anchorNode&&g.getRangeAt){h=g.getRangeAt(0);d=document.createElement(d);b(d).attr(e,f);k=h.extractContents();d.appendChild(k);h.insertNode(d);g.removeAllRanges();e=="style"?m(b(d),f):m(b(d),false)}}else if(document.selection&&document.selection.createRange&&
document.selection.type!="None"){g=document.selection.createRange().htmlText;document.selection.createRange().pasteHTML("<"+d+" "+e+'="'+f+'">'+g+"</"+d+">")}}function m(b,c){var d=V();if((d=d?d:b)&&c==false){d.parent().is("[style]")&&d.attr("style",d.parent().attr("style"));d.is("[style]")&&d.find("*").attr("style",d.attr("style"))}else if(b&&c&&b.is("[style]")){d=c.split(";");d=d[0].split(":");b.is("[style*="+d[0]+"]")&&b.find("*").css(d[0],d[1]);n(b)}}function n(c){if(c){c=c[0];if(document.body.createTextRange){var d=
document.body.createTextRange();d.moveToElementText(c);d.select()}else if(window.getSelection){var e=window.getSelection(),d=document.createRange();if(c!="undefined"&&c!=null){d.selectNodeContents(c);e.removeAllRanges();e.addRange(d);if(b(c).is(":empty")){b(c).append("&nbsp;");n(b(c))}}}}}function q(){if(Q.data("sourceOpened"))s(false);else{var c=V(),d="http://";s(true);if(c)if(c.prop("tagName").toLowerCase()=="a"&&c.is("[href]")){d=c.attr("href");c.attr(ba,"")}else l("a",ba,"");else M.val(d).focus();
O.click(function(c){(b(c.target).hasClass(f.css+"_linktypetext")||b(c.target).hasClass(f.css+"_linktypearrow"))&&r(true)});aa.find("a").click(function(){var c=b(this).attr(f.css+"-linktype");aa.data("linktype",c);Y.find("."+f.css+"_linktypetext").html(aa.find("a:eq("+aa.data("linktype")+")").text());o(d);r()});o(d);M.focus().val(d).bind("keypress keyup",function(b){if(b.keyCode==13){p(U.find("["+ba+"]"));return false}});X.click(function(){p(U.find("["+ba+"]"))})}}function p(c){M.focus();n(c);c.removeAttr(ba);
if(aa.data("linktype")!="2")d("createlink",M.val());else{d("insertImage",M.val());E.find("img").each(function(){var c=b(this).prev("a"),d=b(this).next("a");c.length>0&&c.html()==""?c.remove():d.length>0&&d.html()==""&&d.remove()})}s();E.trigger("change")}function s(b){w("["+ba+"]:not([href])");U.find("["+ba+"][href]").removeAttr(ba);if(b){Q.data("linkOpened",true);B.show()}else{Q.data("linkOpened",false);B.hide()}r()}function r(b){b?aa.show():aa.hide()}function o(b){var c=aa.data("linktype");c=="1"&&
(M.val()=="http://"||M.is("[value^=http://]")||!M.is("[value^=mailto]"))?M.val("mailto:"):c!="1"&&!M.is("[value^=http://]")?M.val("http://"):M.val(b)}function t(c){if(Q.data("sourceOpened"))u(styleField,false);else{c=="fSize"?styleField=oa:c=="colors"&&(styleField=pa);u(styleField,true);styleField.find("a").unbind("click").click(function(){var d=b(this).attr(f.css+"-styleval");if(c=="fSize"){styleType="font-size";d=d+f.funit}else if(c=="colors"){styleType="color";d="rgb("+d+")"}var e;e=styleType;
var g=V();if(g&&g.is("[style]")&&g.css(e)!=""){var h=g.css(e);g.css(e,"");var j=g.attr("style");g.css(e,h);e=j}else e="";l("span","style",styleType+":"+d+";"+e);u("",false);b("."+f.css+"_title").remove();E.trigger("change")})}s(false)}function u(b,c){var d="",e=[{d:"fsizeOpened",f:oa},{d:"cpallOpened",f:pa}];if(b!="")for(var f=0;f<e.length;f++)b==e[f].f&&(d=e[f]);if(c){Q.data(d.d,true);d.f.slideDown(100);for(f=0;f<e.length;f++)if(d.d!=e[f].d){Q.data(e[f].d,false);e[f].f.slideUp(100)}}else for(f=0;f<
e.length;f++){Q.data(e[f].d,false);e[f].f.slideUp(100)}}function w(c){U.find(c).each(function(){b(this).before(b(this).html()).remove()})}function z(){A(true);ka.find("a").click(function(){b("*",this).click(function(b){b.preventDefault();return false});C(b(this).text());var c=b(this).attr(f.css+"-formatval");d("formatBlock","<"+c+">");A(false)})}function A(b){var c=b?true:false;(c=b&&ka.data("status")?true:false)||!b?ka.data("status",false).slideUp(200):ka.data("status",true).slideDown(200)}function C(b){var c=
ka.closest("."+f.css+"_tool").find("."+f.css+"_tool_label").find("."+f.css+"_tool_text");b.length>10&&(b=b.substr(0,7)+"...");c.html(b)}function G(b){var c,d,b=b.replace(/\n/gim,"").replace(/\r/gim,"").replace(/\t/gim,"").replace(/&nbsp;/gim," ");c=[/\<span(|\s+.*?)><span(|\s+.*?)>(.*?)<\/span><\/span>/gim,/\<pre(|\s+.*?)><pre(|\s+.*?)>(.*?)<\/pre><\/pre>/gim,/<(\w*[^p])\s*[^\/>]*>\s*<\/\1>/gim,/\<div(|\s+.*?)>(.*?)\<\/div>/gim,/\<strong(|\s+.*?)>(.*?)\<\/strong>/gim,/\<em(|\s+.*?)>(.*?)\<\/em>/gim];
d=["<span$2>$3</span>","<pre$2>$3</pre>","","<p$1>$2</p>","<b$1>$2</b>","<i$1>$2</i>"];for(ra=0;ra<5;ra++)for(var e=0;e<c.length;e++)b=b.replace(c[e],d[e]);f.p||(b=b.replace(/\<p(|\s+.*?)>(.*?)\<\/p>/ig,"<br/>$2"));if(!f.br){c=[/\<br>(.*?)/ig,/\<br\/>(.*?)/ig];d=["<p>$1</p>","<p>$1</p>"];for(e=0;e<c.length;e++)b=b.replace(c[e],d[e])}!f.p&&!f.br&&(b=b.replace(/\<p>(.*?)\<\/p>/ig,"<div>$1</div>"));return b}function H(){var b=E.text()==""&&E.html().length<12?"":E.html();N.val(G(b))}function K(){E.html(G(N.val()))}
function P(c){var d=false,e=V(),f;if(e){b.each(c,function(c,g){f=e.prop("tagName").toLowerCase();f==g?d=true:e.parents().each(function(){f=b(this).prop("tagName").toLowerCase();f==g&&(d=true)})});return d}return false}function T(){for(var c=0;c<h.length;c++)f[h[c].name]&&(h[c].emphasis&&h[c].tag!="")&&(P(h[c].tag)?Q.find("."+f.css+"_tool_"+h[c].cls).addClass(Z):b("."+f.css+"_tool_"+h[c].cls).removeClass(Z));if(f.format&&b.isArray(f.formats)){for(var c=false,d=0;d<f.formats.length;d++){var e=[];e[0]=
f.formats[d][0];if(f.formats[d][0].length>0&&P(e)){C(f.formats[d][1]);c=true;break}}c||C(f.formats[0][1])}u("",false);A(false)}!b(this).data("jqte")||b(this).data("jqte")==null||b(this).data("jqte")=="undefined"?b(this).data("jqte",true):b(this).data("jqte",false);if(!f.status||!b(this).data("jqte")){if(b(this).closest("."+f.css).length>0){var D=b(this).closest("."+f.css).find("."+f.css+"_editor").html(),F="";b(b(this)[0].attributes).each(function(){this.nodeName!="style"&&(F=F+" "+this.nodeName+
'="'+this.nodeValue+'"')});var I=b(this).is("[data-origin]")&&b(this).attr("data-origin")!=""?b(this).attr("data-origin"):"textarea",J=">"+D;if(I=="input"||I=="option"){D=D.replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;");J='value="'+D+'">'}D=b(this).clone();b(this).data("jqte",false).closest("."+f.css).before(D).remove();D.replaceWith("<"+I+F+J+"</"+I+">")}}else{var N=b(this),I=b(this).prop("tagName").toLowerCase();b(this).attr("data-origin",I);J=b(this).is("[value]")||
I=="textarea"?b(this).val():b(this).html();J=J.replace(/&#34;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");b(this).after('<div class="'+f.css+'"></div>');var U=b(this).next("."+f.css);U.html('<div class="'+f.css+'_toolbar" role="toolbar" unselectable></div><div class="'+f.css+'_linkform" style="display:none" role="dialog"></div><div class="'+f.css+'_editor"></div>');var Q=U.find("."+f.css+"_toolbar"),B=U.find("."+f.css+"_linkform"),E=U.find("."+f.css+
"_editor"),Z=f.css+"_tool_depressed";B.append('<div class="'+f.css+'_linktypeselect" unselectable></div><input class="'+f.css+'_linkinput" type="text/css" value=""><div class="'+f.css+'_linkbutton" unselectable>'+f.button+'</div> <div style="height:1px;float:none;clear:both"></div>');var O=B.find("."+f.css+"_linktypeselect"),M=B.find("."+f.css+"_linkinput"),X=B.find("."+f.css+"_linkbutton");O.append('<div class="'+f.css+'_linktypeview" unselectable></div><div class="'+f.css+'_linktypes" role="menu" unselectable></div>');
var aa=O.find("."+f.css+"_linktypes"),Y=O.find("."+f.css+"_linktypeview"),ba=f.css+"-setlink";E.after('<div class="'+f.css+"_source "+f.css+'_hiddenField"></div>');var da=U.find("."+f.css+"_source");N.appendTo(da);if(I!="textarea"){F="";b(N[0].attributes).each(function(){this.nodeName!="type"&&this.nodeName!="value"&&(F=F+" "+this.nodeName+'="'+this.nodeValue+'"')});I=b("<textarea "+F+"></textarea>");I.val(J);N.replaceWith(I);N=da.find("textarea")}E.attr("contenteditable","true").html(J);for(I=0;I<
h.length;I++)if(f[h[I].name]){J=h[I].key.length>0?f.titletext[I].hotkey!=null&&f.titletext[I].hotkey!="undefined"&&f.titletext[I].hotkey!=""?" (Ctrl+"+f.titletext[I].hotkey+")":"":"";J=f.titletext[I].title!=null&&f.titletext[I].title!="undefined"&&f.titletext[I].title!=""?f.titletext[I].title+J:"";Q.append('<div class="'+f.css+"_tool "+f.css+"_tool_"+h[I].cls+'" role="button" data-tool="'+I+'" unselectable><a class="'+f.css+'_tool_icon" unselectable></a></div>');Q.find("."+f.css+"_tool[data-tool="+
I+"]").data({tag:h[I].tag,command:h[I].command,emphasis:h[I].emphasis,title:J});if(h[I].name=="format"&&b.isArray(f.formats)){J=f.formats[0][1].length>0&&f.formats[0][1]!="undefined"?f.formats[0][1]:"";Q.find("."+f.css+"_tool_"+h[I].cls).find("."+f.css+"_tool_icon").replaceWith('<a class="'+f.css+'_tool_label" unselectable><span class="'+f.css+'_tool_text" unselectable>'+J+'</span><span class="'+f.css+'_tool_icon" unselectable></span></a>');Q.find("."+f.css+"_tool_"+h[I].cls).append('<div class="'+
f.css+'_formats" unselectable></div>');for(J=0;J<f.formats.length;J++)Q.find("."+f.css+"_formats").append("<a "+f.css+'-formatval="'+f.formats[J][0]+'" class="'+f.css+"_format "+f.css+"_format_"+J+'" role="menuitem" unselectable>'+f.formats[J][1]+"</a>");Q.find("."+f.css+"_formats").data("status",false)}else if(h[I].name=="fsize"&&b.isArray(f.fsizes)){Q.find("."+f.css+"_tool_"+h[I].cls).append('<div class="'+f.css+'_fontsizes" unselectable></div>');for(J=0;J<f.fsizes.length;J++)Q.find("."+f.css+"_fontsizes").append("<a "+
f.css+'-styleval="'+f.fsizes[J]+'" class="'+f.css+'_fontsize" style="font-size:'+f.fsizes[J]+f.funit+'" role="menuitem" unselectable>Abcdefgh...</a>')}else if(h[I].name=="color"&&b.isArray(e)){Q.find("."+f.css+"_tool_"+h[I].cls).append('<div class="'+f.css+'_cpalette" unselectable></div>');for(var ra=0;ra<e.length;ra++)e[ra]!=null?Q.find("."+f.css+"_cpalette").append("<a "+f.css+'-styleval="'+e[ra]+'" class="'+f.css+'_color" style="background-color: rgb('+e[ra]+')" role="gridcell" unselectable></a>'):
Q.find("."+f.css+"_cpalette").append('<div class="'+f.css+'_colorSeperator"></div>')}}aa.data("linktype","0");for(I=0;I<3;I++){aa.append("<a "+f.css+'-linktype="'+I+'" unselectable>'+f.linktypes[I]+"</a>");Y.html('<div class="'+f.css+'_linktypearrow" unselectable></div><div class="'+f.css+'_linktypetext">'+aa.find("a:eq("+aa.data("linktype")+")").text()+"</div>")}I="";I=/msie/.test(g)?"-ms-":/chrome/.test(g)||/safari/.test(g)||/yandex/.test(g)?"-webkit-":/mozilla/.test(g)?"-moz-":/opera/.test(g)?
"-o-":/konqueror/.test(g)?"-khtml-":"";if(f.placeholder&&f.placeholder!=""){U.prepend('<div class="'+f.css+'_placeholder" unselectable><div class="'+f.css+'_placeholder_text">'+f.placeholder+"</div></div>");var x=U.find("."+f.css+"_placeholder");x.click(function(){E.focus()})}U.find("[unselectable]").css(I+"user-select","none").addClass("unselectable").attr("unselectable","on").on("selectstart mousedown",false);var ja=Q.find("."+f.css+"_tool"),ka=Q.find("."+f.css+"_formats"),oa=Q.find("."+f.css+"_fontsizes"),
pa=Q.find("."+f.css+"_cpalette"),V=function(){var c;if(window.getSelection){c=getSelection();c=c.anchorNode}if(!c&&document.selection&&document.selection.createRange&&document.selection.type!="None"){c=document.selection;c=c.getRangeAt?c.getRangeAt(0):c.createRange();c=c.commonAncestorContainer?c.commonAncestorContainer:c.parentElement?c.parentElement():c.item(0)}return c?c.nodeName=="#text"?b(c.parentNode):b(c):false};ja.unbind("click").click(function(c){if(b(this).data("command")=="displaysource"&&
!Q.data("sourceOpened")){Q.find("."+f.css+"_tool").addClass(f.css+"_hiddenField");b(this).removeClass(f.css+"_hiddenField");Q.data("sourceOpened",true);N.css("height",E.outerHeight());da.removeClass(f.css+"_hiddenField");E.addClass(f.css+"_hiddenField");N.focus();s(false);u("",false);A();f.placeholder&&f.placeholder!=""&&x.hide()}else{if(Q.data("sourceOpened")){Q.data("sourceOpened",false);Q.find("."+f.css+"_tool").removeClass(f.css+"_hiddenField");da.addClass(f.css+"_hiddenField");E.removeClass(f.css+
"_hiddenField")}else if(b(this).data("command")=="linkcreator")if(Q.data("linkOpened")){s(false);A(false)}else q();else if(b(this).data("command")=="formats"){b(this).data("command")=="formats"&&!b(c.target).hasClass(f.css+"_format")&&z();u("",false);E.not(":focus")&&E.focus()}else if(b(this).data("command")=="fSize"||b(this).data("command")=="colors"){(b(this).data("command")=="fSize"&&!b(c.target).hasClass(f.css+"_fontsize")||b(this).data("command")=="colors"&&!b(c.target).hasClass(f.css+"_color"))&&
t(b(this).data("command"));A(false);E.not(":focus")&&E.focus()}else{E.not(":focus")&&E.focus();d(b(this).data("command"),null);u("",false);A(false);r();b(this).data("emphasis")==true&&!b(this).hasClass(Z)?b(this).addClass(Z):b(this).removeClass(Z);da.addClass(f.css+"_hiddenField");E.removeClass(f.css+"_hiddenField")}f.placeholder&&f.placeholder!=""&&(E.html()!=""?x.hide():x.show())}E.trigger("change")}).hover(function(c){if(f.title&&b(this).data("title")!=""&&(b(c.target).hasClass(f.css+"_tool")||
b(c.target).hasClass(f.css+"_tool_icon"))){b("."+f.css+"_title").remove();U.append('<div class="'+f.css+'_title"><div class="'+f.css+'_titleArrow"><div class="'+f.css+'_titleArrowIcon"></div></div><div class="'+f.css+'_titleText">'+b(this).data("title")+"</div></div>");c=b("."+f.css+"_title:first");c.find("."+f.css+"_titleArrowIcon");var d=b(this).position(),e=d.left+b(this).outerWidth()-c.outerWidth()/2-b(this).outerWidth()/2,d=d.top+b(this).outerHeight()+5;c.delay(400).css({top:d,left:e}).fadeIn(200)}},
function(){b("."+f.css+"_title").remove()});var va=null;E.bind("keypress keyup keydown drop cut copy paste DOMCharacterDataModified DOMSubtreeModified",function(){Q.data("sourceOpened")||b(this).trigger("change");r();b.isFunction(f.change)&&f.change();f.placeholder&&f.placeholder!=""&&(b(this).text()!=""?x.hide():x.show())}).bind("change",function(){if(!Q.data("sourceOpened")){clearTimeout(va);va=setTimeout(H,10)}}).keydown(function(b){if(b.ctrlKey)for(var c=0;c<h.length;c++)if(f[h[c].name]&&b.keyCode==
h[c].key.charCodeAt(0)){h[c].command!=""&&h[c].command!="linkcreator"?d(h[c].command,null):h[c].command=="linkcreator"&&q();return false}}).bind("mouseup keyup",T).focus(function(){b.isFunction(f.focus)&&f.focus();U.addClass(f.css+"_focused");if(/opera/.test(g)){var c=document.createRange();c.selectNodeContents(E[0]);c.collapse(false);var d=window.getSelection();d.removeAllRanges();d.addRange(c)}}).focusout(function(){ja.removeClass(Z);u("",false);A(false);r();b.isFunction(f.blur)&&f.blur();U.removeClass(f.css+
"_focused");b.isArray(f.formats)&&C(f.formats[0][1])});N.bind("keydown keyup",function(){setTimeout(K,0);b(this).height(b(this)[0].scrollHeight);b(this).val()==""&&b(this).height(0)}).focus(function(){U.addClass(f.css+"_focused")}).focusout(function(){U.removeClass(f.css+"_focused")})}})}})(jQuery);
!function(b){function c(b){return void 0===Function.prototype.name?(b=/function\s([^(]{1,})\(/.exec(b.toString()))&&1<b.length?b[1].trim():"":void 0===b.prototype?b.constructor.name:b.prototype.constructor.name}function d(b){return b.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}var e={version:"6.2.3",_plugins:{},_uuids:[],rtl:function(){return"rtl"===b("html").attr("dir")},plugin:function(b,e){var h=e||c(b);this._plugins[d(h)]=this[h]=b},registerPlugin:function(b,e){var h=e?d(e):c(b.constructor).toLowerCase();
b.uuid=this.GetYoDigits(6,h);b.$element.attr("data-"+h)||b.$element.attr("data-"+h,b.uuid);b.$element.data("zfPlugin")||b.$element.data("zfPlugin",b);b.$element.trigger("init.zf."+h);this._uuids.push(b.uuid)},unregisterPlugin:function(b){var e=d(c(b.$element.data("zfPlugin").constructor));this._uuids.splice(this._uuids.indexOf(b.uuid),1);b.$element.removeAttr("data-"+e).removeData("zfPlugin").trigger("destroyed.zf."+e);for(var h in b)b[h]=null},reInit:function(c){var e=c instanceof b;try{if(e)c.each(function(){b(this).data("zfPlugin")._init()});
else{var h=this;({object:function(c){c.forEach(function(c){c=d(c);b("[data-"+c+"]").foundation("_init")})},string:function(){c=d(c);b("[data-"+c+"]").foundation("_init")},undefined:function(){this.object(Object.keys(h._plugins))}})[typeof c](c)}}catch(j){console.error(j)}finally{return c}},GetYoDigits:function(b,c){b=b||6;return Math.round(Math.pow(36,b+1)-Math.random()*Math.pow(36,b)).toString(36).slice(1)+(c?"-"+c:"")},reflow:function(c,d){"undefined"===typeof d?d=Object.keys(this._plugins):"string"===
typeof d&&(d=[d]);var e=this;b.each(d,function(d,g){var l=e._plugins[g];b(c).find("[data-"+g+"]").addBack("[data-"+g+"]").each(function(){var c=b(this),d={};if(c.data("zfPlugin"))console.warn("Tried to initialize "+g+" on an element that already has a Foundation plugin.");else{c.attr("data-options")&&c.attr("data-options").split(";").forEach(function(b){b=b.split(":").map(function(b){return b.trim()});b[0]&&(d[b[0]]=/true/.test(b[1])?!0:/false/.test(b[1])?!1:!isNaN(1*b[1])?parseFloat(b[1]):b[1])});
try{c.data("zfPlugin",new l(b(this),d))}catch(e){console.error(e)}finally{}}})})},getFnName:c,transitionend:function(b){var c={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend"},d=document.createElement("div"),e,k;for(k in c)"undefined"!==typeof d.style[k]&&(e=c[k]);if(e)return e;e=setTimeout(function(){b.triggerHandler("transitionend",[b])},1);return"transitionend"},util:{throttle:function(b,c){var d=null;return function(){var e=
this,k=arguments;null===d&&(d=setTimeout(function(){b.apply(e,k);d=null},c))}}}};window.Foundation=e;b.fn.foundation=function(d){var g=typeof d,h=b("meta.foundation-mq"),j=b(".no-js");h.length||b('<meta class="foundation-mq">').appendTo(document.head);j.length&&j.removeClass("no-js");if("undefined"===g)e.MediaQuery._init(),e.reflow(this);else if("string"===g){var k=Array.prototype.slice.call(arguments,1),l=this.data("zfPlugin");if(void 0!==l&&void 0!==l[d])1===this.length?l[d].apply(l,k):this.each(function(c,
e){l[d].apply(b(e).data("zfPlugin"),k)});else throw new ReferenceError("We're sorry, '"+d+"' is not an available method for "+(l?c(l):"this element")+".");}else throw new TypeError("We're sorry, "+g+" is not a valid parameter. You must use a string representing the method you wish to invoke.");return this};(function(){if(!Date.now||!window.Date.now)window.Date.now=Date.now=function(){return(new Date).getTime()};for(var b=["webkit","moz"],c=0;c<b.length&&!window.requestAnimationFrame;++c){var d=b[c];
window.requestAnimationFrame=window[d+"RequestAnimationFrame"];window.cancelAnimationFrame=window[d+"CancelAnimationFrame"]||window[d+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var e=0;window.requestAnimationFrame=function(b){var c=Date.now(),d=Math.max(e+16,c);return setTimeout(function(){b(e=d)},d-c)};window.cancelAnimationFrame=clearTimeout}if(!window.performance||!window.performance.now)window.performance=
{start:Date.now(),now:function(){return Date.now()-this.start}}})();Function.prototype.bind||(Function.prototype.bind=function(b){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),d=this,e=function(){},k=function(){return d.apply(this instanceof e?this:b,c.concat(Array.prototype.slice.call(arguments)))};this.prototype&&(e.prototype=this.prototype);k.prototype=new e;return k})}(jQuery);
"use strict";
!function(){function b(b){b=b.length?b[0]:b;if(b===window||b===document)throw Error("I'm sorry, Dave. I'm afraid I can't do that.");var d=b.getBoundingClientRect(),b=b.parentNode.getBoundingClientRect(),e=document.body.getBoundingClientRect(),f=window.pageYOffset,g=window.pageXOffset;return{width:d.width,height:d.height,offset:{top:d.top+f,left:d.left+g},parentDims:{width:b.width,height:b.height,offset:{top:b.top+f,left:b.left+g}},windowDims:{width:e.width,height:e.height,offset:{top:f,left:g}}}}
Foundation.Box={ImNotTouchingYou:function(c,d,e,f){var c=b(c),g,h;if(d){var j=b(d);g=c.offset.top+c.height<=j.height+j.offset.top;d=c.offset.top>=j.offset.top;h=c.offset.left>=j.offset.left;c=c.offset.left+c.width<=j.width+j.offset.left}else g=c.offset.top+c.height<=c.windowDims.height+c.windowDims.offset.top,d=c.offset.top>=c.windowDims.offset.top,h=c.offset.left>=c.windowDims.offset.left,c=c.offset.left+c.width<=c.windowDims.width;return e?!0===(h===c):f?!0===(d===g):-1===[g,d,h,c].indexOf(!1)},
GetDimensions:b,GetOffsets:function(c,d,e,f,g,h){c=b(c);d=d?b(d):null;switch(e){case "top":return{left:Foundation.rtl()?d.offset.left-c.width+d.width:d.offset.left,top:d.offset.top-(c.height+f)};case "left":return{left:d.offset.left-(c.width+g),top:d.offset.top};case "right":return{left:d.offset.left+d.width+g,top:d.offset.top};case "center top":return{left:d.offset.left+d.width/2-c.width/2,top:d.offset.top-(c.height+f)};case "center bottom":return{left:h?g:d.offset.left+d.width/2-c.width/2,top:d.offset.top+
d.height+f};case "center left":return{left:d.offset.left-(c.width+g),top:d.offset.top+d.height/2-c.height/2};case "center right":return{left:d.offset.left+d.width+g+1,top:d.offset.top+d.height/2-c.height/2};case "center":return{left:c.windowDims.offset.left+c.windowDims.width/2-c.width/2,top:c.windowDims.offset.top+c.windowDims.height/2-c.height/2};case "reveal":return{left:(c.windowDims.width-c.width)/2,top:c.windowDims.offset.top+f};case "reveal full":return{left:c.windowDims.offset.left,top:c.windowDims.offset.top};
case "left bottom":return{left:d.offset.left-(c.width+g),top:d.offset.top+d.height};case "right bottom":return{left:d.offset.left+d.width+g-c.width,top:d.offset.top+d.height};default:return{left:Foundation.rtl()?d.offset.left-c.width+d.width:d.offset.left,top:d.offset.top+d.height+f}}}}}(jQuery);"use strict";
!function(b){var c={9:"TAB",13:"ENTER",27:"ESCAPE",32:"SPACE",37:"ARROW_LEFT",38:"ARROW_UP",39:"ARROW_RIGHT",40:"ARROW_DOWN"},d={},e={keys:function(b){var c={},d;for(d in b)c[b[d]]=b[d];return c}(c),parseKey:function(b){var d=c[b.which||b.keyCode]||String.fromCharCode(b.which).toUpperCase();b.shiftKey&&(d="SHIFT_"+d);b.ctrlKey&&(d="CTRL_"+d);b.altKey&&(d="ALT_"+d);return d},handleKey:function(c,e,h){e=d[e];c=this.parseKey(c);if(!e)return console.warn("Component not defined!");e="undefined"===typeof e.ltr?
e:Foundation.rtl()?b.extend({},e.ltr,e.rtl):b.extend({},e.rtl,e.ltr);(c=h[e[c]])&&"function"===typeof c?(c=c.apply(),(h.handled||"function"===typeof h.handled)&&h.handled(c)):(h.unhandled||"function"===typeof h.unhandled)&&h.unhandled()},findFocusable:function(c){return c.find("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]").filter(function(){return!b(this).is(":visible")||
0>b(this).attr("tabindex")?!1:!0})},register:function(b,c){d[b]=c}};Foundation.Keyboard=e}(jQuery);"use strict";
!function(b){function c(b){var c={};if("string"!==typeof b)return c;b=b.trim().slice(1,-1);return!b?c:c=b.split("&").reduce(function(b,c){var d=c.replace(/\+/g," ").split("="),e=d[0],d=d[1],e=decodeURIComponent(e),d=void 0===d?null:decodeURIComponent(d);b.hasOwnProperty(e)?Array.isArray(b[e])?b[e].push(d):b[e]=[b[e],d]:b[e]=d;return b},{})}var d={queries:[],current:"",_init:function(){var d=b(".foundation-mq").css("font-family"),d=c(d),f;for(f in d)d.hasOwnProperty(f)&&this.queries.push({name:f,value:"only screen and (min-width: "+
d[f]+")"});this.current=this._getCurrentSize();this._watcher()},atLeast:function(b){return(b=this.get(b))?window.matchMedia(b).matches:!1},get:function(b){for(var c in this.queries)if(this.queries.hasOwnProperty(c)){var d=this.queries[c];if(b===d.name)return d.value}return null},_getCurrentSize:function(){for(var b,c=0;c<this.queries.length;c++){var d=this.queries[c];window.matchMedia(d.value).matches&&(b=d)}return"object"===typeof b?b.name:b},_watcher:function(){var c=this;b(window).on("resize.zf.mediaquery",
function(){var d=c._getCurrentSize(),g=c.current;d!==g&&(c.current=d,b(window).trigger("changed.zf.mediaquery",[d,g]))})}};Foundation.MediaQuery=d;window.matchMedia||(window.matchMedia=function(){var b=window.styleMedia||window.media;if(!b){var c=document.createElement("style"),d=document.getElementsByTagName("script")[0],h=null;c.type="text/css";c.id="matchmediajs-test";d.parentNode.insertBefore(c,d);h="getComputedStyle"in window&&window.getComputedStyle(c,null)||c.currentStyle;b={matchMedium:function(b){b=
"@media "+b+"{ #matchmediajs-test { width: 1px; } }";c.styleSheet?c.styleSheet.cssText=b:c.textContent=b;return"1px"===h.width}}}return function(c){return{matches:b.matchMedium(c||"all"),media:c||"all"}}}());Foundation.MediaQuery=d}(jQuery);"use strict";
!function(b){function c(c,g,h,j){function k(){c||g.hide();l();j&&j.apply(g)}function l(){g[0].style.transitionDuration=0;g.removeClass(m+" "+n+" "+h)}g=b(g).eq(0);if(g.length){var m=c?d[0]:d[1],n=c?e[0]:e[1];l();g.addClass(h).css("transition","none");requestAnimationFrame(function(){g.addClass(m);c&&g.show()});requestAnimationFrame(function(){g[0].offsetWidth;g.css("transition","").addClass(n)});g.one(Foundation.transitionend(g),k)}}var d=["mui-enter","mui-leave"],e=["mui-enter-active","mui-leave-active"];
Foundation.Move=function(b,c,d){function e(n){m||(m=window.performance.now());l=n-m;d.apply(c);l<b?k=window.requestAnimationFrame(e,c):(window.cancelAnimationFrame(k),c.trigger("finished.zf.animate",[c]).triggerHandler("finished.zf.animate",[c]))}var k,l,m=null;k=window.requestAnimationFrame(e)};Foundation.Motion={animateIn:function(b,d,e){c(!0,b,d,e)},animateOut:function(b,d,e){c(!1,b,d,e)}}}(jQuery);"use strict";
!function(b){Foundation.Nest={Feather:function(c){var d=1>=arguments.length||void 0===arguments[1]?"zf":arguments[1];c.attr("role","menubar");var e=c.find("li").attr({role:"menuitem"}),f="is-"+d+"-submenu",g=f+"-item",h="is-"+d+"-submenu-parent";c.find("a:first").attr("tabindex",0);e.each(function(){var c=b(this),d=c.children("ul");d.length&&(c.addClass(h).attr({"aria-haspopup":!0,"aria-expanded":!1,"aria-label":c.children("a:first").text()}),d.addClass("submenu "+f).attr({"data-submenu":"","aria-hidden":!0,
role:"menu"}));c.parent("[data-submenu]").length&&c.addClass("is-submenu-item "+g)})},Burn:function(b,d){b.find("li").removeAttr("tabindex");var e="is-"+d+"-submenu",f=e+"-item",g="is-"+d+"-submenu-parent";b.find("*").removeClass(e+" "+f+" "+g+" is-submenu-item submenu is-active").removeAttr("data-submenu").css("display","")}}}(jQuery);"use strict";
!function(b){Foundation.Timer=function(b,d,e){var f=this,g=d.duration,h=Object.keys(b.data())[0]||"timer",j=-1,k,l;this.isPaused=!1;this.restart=function(){j=-1;clearTimeout(l);this.start()};this.start=function(){this.isPaused=!1;clearTimeout(l);j=0>=j?g:j;b.data("paused",!1);k=Date.now();l=setTimeout(function(){d.infinite&&f.restart();e()},j);b.trigger("timerstart.zf."+h)};this.pause=function(){this.isPaused=!0;clearTimeout(l);b.data("paused",!0);var d=Date.now();j-=d-k;b.trigger("timerpaused.zf."+
h)}};Foundation.onImagesLoaded=function(c,d){function e(){f--;0===f&&d()}var f=c.length;0===f&&d();c.each(function(){if(this.complete)e();else if("undefined"!==typeof this.naturalWidth&&0<this.naturalWidth)e();else b(this).one("load",function(){e()})})}}(jQuery);
(function(b){function c(){this.removeEventListener("touchmove",d);this.removeEventListener("touchend",c);j=!1}function d(d){b.spotSwipe.preventDefault&&d.preventDefault();if(j){var e=f-d.touches[0].pageX,m;h=(new Date).getTime()-g;Math.abs(e)>=b.spotSwipe.moveThreshold&&h<=b.spotSwipe.timeThreshold&&(m=0<e?"left":"right");m&&(d.preventDefault(),c.call(this),b(this).trigger("swipe",m).trigger("swipe"+m))}}function e(b){1==b.touches.length&&(f=b.touches[0].pageX,j=!0,g=(new Date).getTime(),this.addEventListener("touchmove",
d,!1),this.addEventListener("touchend",c,!1))}b.spotSwipe={version:"1.0.0",enabled:"ontouchstart"in document.documentElement,preventDefault:!1,moveThreshold:75,timeThreshold:200};var f,g,h,j=!1;b.event.special.swipe={setup:function(){this.addEventListener&&this.addEventListener("touchstart",e,!1)}};b.each(["left","up","down","right"],function(){b.event.special["swipe"+this]={setup:function(){b(this).on("swipe",b.noop)}}})})(jQuery);
!function(b){b.fn.addTouch=function(){this.each(function(c,d){b(d).bind("touchstart touchmove touchend touchcancel",function(){var b=event.changedTouches[0],c={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"}[event.type],d;"MouseEvent"in window&&"function"===typeof window.MouseEvent?d=new window.MouseEvent(c,{bubbles:!0,cancelable:!0,screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY}):(d=document.createEvent("MouseEvent"),d.initMouseEvent(c,!0,!0,window,1,b.screenX,
b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null));b.target.dispatchEvent(d)})})}}(jQuery);"use strict";
!function(b){function c(){g();e();f();d()}function d(c){var d=b("[data-yeti-box]"),e=["dropdown","tooltip","reveal"];c&&("string"===typeof c?e.push(c):"object"===typeof c&&"string"===typeof c[0]?e.concat(c):console.error("Plugin names must be strings"));d.length&&(c=e.map(function(b){return"closeme.zf."+b}).join(" "),b(window).off(c).on(c,function(c,d){var e=c.namespace.split(".")[0];b("[data-"+e+"]").not('[data-yeti-box="'+d+'"]').each(function(){var c=b(this);c.triggerHandler("close.zf.trigger",
[c])})}))}function e(c){var d=void 0,e=b("[data-resize]");if(e.length)b(window).off("resize.zf.trigger").on("resize.zf.trigger",function(){d&&clearTimeout(d);d=setTimeout(function(){h||e.each(function(){b(this).triggerHandler("resizeme.zf.trigger")});e.attr("data-events","resize")},c||10)})}function f(c){var d=void 0,e=b("[data-scroll]");if(e.length)b(window).off("scroll.zf.trigger").on("scroll.zf.trigger",function(){d&&clearTimeout(d);d=setTimeout(function(){h||e.each(function(){b(this).triggerHandler("scrollme.zf.trigger")});
e.attr("data-events","scroll")},c||10)})}function g(){if(!h)return!1;var c=document.querySelectorAll("[data-resize], [data-scroll], [data-mutate]"),d=function(c){c=b(c[0].target);switch(c.attr("data-events")){case "resize":c.triggerHandler("resizeme.zf.trigger",[c]);break;case "scroll":c.triggerHandler("scrollme.zf.trigger",[c,window.pageYOffset]);break;default:return!1}};if(c.length)for(var e=0;e<=c.length-1;e++)(new h(d)).observe(c[e],{attributes:!0,childList:!1,characterData:!1,subtree:!1,attributeFilter:["data-events"]})}
var h=function(){for(var b=["WebKit","Moz","O","Ms",""],c=0;c<b.length;c++)if(b[c]+"MutationObserver"in window)return window[b[c]+"MutationObserver"];return!1}(),j=function(c,d){c.data(d).split(" ").forEach(function(e){b("#"+e)["close"===d?"trigger":"triggerHandler"](d+".zf.trigger",[c])})};b(document).on("click.zf.trigger","[data-open]",function(){j(b(this),"open")});b(document).on("click.zf.trigger","[data-close]",function(){b(this).data("close")?j(b(this),"close"):b(this).trigger("close.zf.trigger")});
b(document).on("click.zf.trigger","[data-toggle]",function(){j(b(this),"toggle")});b(document).on("close.zf.trigger","[data-closable]",function(c){c.stopPropagation();c=b(this).data("closable");""!==c?Foundation.Motion.animateOut(b(this),c,function(){b(this).trigger("closed.zf")}):b(this).fadeOut().trigger("closed.zf")});b(document).on("focus.zf.trigger blur.zf.trigger","[data-toggle-focus]",function(){var c=b(this).data("toggle-focus");b("#"+c).triggerHandler("toggle.zf.trigger",[b(this)])});b(window).load(function(){c()});
Foundation.IHearYou=c}(jQuery);"use strict";var _createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e){var f=1>=arguments.length||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this._init();Foundation.registerPlugin(this,"Abide")}_createClass(c,[{key:"_init",value:function(){this.$inputs=this.$element.find("input, textarea, select");this._events()}},{key:"_events",value:function(){var c=this;this.$element.off(".abide").on("reset.zf.abide",function(){c.resetForm()}).on("submit.zf.abide",
function(){return c.validateForm()});if("fieldChange"===this.options.validateOn)this.$inputs.off("change.zf.abide").on("change.zf.abide",function(d){c.validateInput(b(d.target))});if(this.options.liveValidate)this.$inputs.off("input.zf.abide").on("input.zf.abide",function(d){c.validateInput(b(d.target))})}},{key:"_reflow",value:function(){this._init()}},{key:"requiredCheck",value:function(b){if(!b.attr("required"))return!0;var c=!0;switch(b[0].type){case "checkbox":c=b[0].checked;break;case "select":case "select-one":case "select-multiple":b=
b.find("option:selected");if(!b.length||!b.val())c=!1;break;default:if(!b.val()||!b.val().length)c=!1}return c}},{key:"findFormError",value:function(b){var c=b.siblings(this.options.formErrorSelector);c.length||(c=b.parent().find(this.options.formErrorSelector));return c}},{key:"findLabel",value:function(b){var c=this.$element.find('label[for="'+b[0].id+'"]');return!c.length?b.closest("label"):c}},{key:"findRadioLabels",value:function(c){var d=this,c=c.map(function(c,e){var j=d.$element.find('label[for="'+
e.id+'"]');j.length||(j=b(e).closest("label"));return j[0]});return b(c)}},{key:"addErrorClasses",value:function(b){var c=this.findLabel(b),d=this.findFormError(b);c.length&&c.addClass(this.options.labelErrorClass);d.length&&d.addClass(this.options.formErrorClass);b.addClass(this.options.inputErrorClass).attr("data-invalid","")}},{key:"removeRadioErrorClasses",value:function(b){var b=this.$element.find(':radio[name="'+b+'"]'),c=this.findRadioLabels(b),d=this.findFormError(b);c.length&&c.removeClass(this.options.labelErrorClass);
d.length&&d.removeClass(this.options.formErrorClass);b.removeClass(this.options.inputErrorClass).removeAttr("data-invalid")}},{key:"removeErrorClasses",value:function(b){if("radio"==b[0].type)return this.removeRadioErrorClasses(b.attr("name"));var c=this.findLabel(b),d=this.findFormError(b);c.length&&c.removeClass(this.options.labelErrorClass);d.length&&d.removeClass(this.options.formErrorClass);b.removeClass(this.options.inputErrorClass).removeAttr("data-invalid")}},{key:"validateInput",value:function(b){var c=
this.requiredCheck(b),d=!1,h=!0,j=b.attr("data-validator"),k=!0;if(b.is("[data-abide-ignore]")||b.is('[type="hidden"]'))return!0;switch(b[0].type){case "radio":d=this.validateRadio(b.attr("name"));break;case "checkbox":d=c;break;case "select":case "select-one":case "select-multiple":d=c;break;default:d=this.validateText(b)}j&&(h=this.matchValidation(b,j,b.attr("required")));b.attr("data-equalto")&&(k=this.options.validators.equalTo(b));c=-1===[c,d,h,k].indexOf(!1);d=(c?"valid":"invalid")+".zf.abide";
this[c?"removeErrorClasses":"addErrorClasses"](b);b.trigger(d,[b]);return c}},{key:"validateForm",value:function(){var c=[],d=this;this.$inputs.each(function(){c.push(d.validateInput(b(this)))});var g=-1===c.indexOf(!1);this.$element.find("[data-abide-error]").css("display",g?"none":"block");this.$element.trigger((g?"formvalid":"forminvalid")+".zf.abide",[this.$element]);return g}},{key:"validateText",value:function(b,c){var c=c||b.attr("pattern")||b.attr("type"),d=b.val(),h=!1;d.length?h=this.options.patterns.hasOwnProperty(c)?
this.options.patterns[c].test(d):c!==b.attr("type")?RegExp(c).test(d):!0:b.prop("required")||(h=!0);return h}},{key:"validateRadio",value:function(c){var c=this.$element.find(':radio[name="'+c+'"]'),d=!1,g=!1;c.each(function(c,d){b(d).attr("required")&&(g=!0)});g||(d=!0);d||c.each(function(c,e){b(e).prop("checked")&&(d=!0)});return d}},{key:"matchValidation",value:function(b,c,d){var h=this,d=d?!0:!1;return-1===c.split(" ").map(function(c){return h.options.validators[c](b,d,b.parent())}).indexOf(!1)}},
{key:"resetForm",value:function(){var c=this.$element,d=this.options;b("."+d.labelErrorClass,c).not("small").removeClass(d.labelErrorClass);b("."+d.inputErrorClass,c).not("small").removeClass(d.inputErrorClass);b(d.formErrorSelector+"."+d.formErrorClass).removeClass(d.formErrorClass);c.find("[data-abide-error]").css("display","none");b(":input",c).not(":button, :submit, :reset, :hidden, :radio, :checkbox, [data-abide-ignore]").val("").removeAttr("data-invalid");b(":input:radio",c).not("[data-abide-ignore]").prop("checked",
!1).removeAttr("data-invalid");b(":input:checkbox",c).not("[data-abide-ignore]").prop("checked",!1).removeAttr("data-invalid");c.trigger("formreset.zf.abide",[c])}},{key:"destroy",value:function(){var c=this;this.$element.off(".abide").find("[data-abide-error]").css("display","none");this.$inputs.off(".abide").each(function(){c.removeErrorClasses(b(this))});Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={validateOn:"fieldChange",labelErrorClass:"is-invalid-label",inputErrorClass:"is-invalid-input",
formErrorSelector:".form-error",formErrorClass:"is-visible",liveValidate:!1,patterns:{alpha:/^[a-zA-Z]+$/,alpha_numeric:/^[a-zA-Z0-9]+$/,integer:/^[-+]?\d+$/,number:/^[-+]?\d*(?:[\.\,]\d+)?$/,card:/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,cvv:/^([0-9]){3,4}$/,email:/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$/,
url:/^(https?|ftp|file|ssh):\/\/(((([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/,
domain:/^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,8}$/,datetime:/^([0-2][0-9]{3})\-([0-1][0-9])\-([0-3][0-9])T([0-5][0-9])\:([0-5][0-9])\:([0-5][0-9])(Z|([\-\+]([0-1][0-9])\:00))$/,date:/(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))$/,time:/^(0[0-9]|1[0-9]|2[0-3])(:[0-5][0-9]){2}$/,dateISO:/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/,month_day_year:/^(0[1-9]|1[012])[- \/.](0[1-9]|[12][0-9]|3[01])[- \/.]\d{4}$/,
day_month_year:/^(0[1-9]|[12][0-9]|3[01])[- \/.](0[1-9]|1[012])[- \/.]\d{4}$/,color:/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/},validators:{equalTo:function(c){return b("#"+c.attr("data-equalto")).val()===c.val()}}};Foundation.plugin(c,"Abide")}(jQuery);"use strict";
_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this._init();Foundation.registerPlugin(this,"Accordion");Foundation.Keyboard.register("Accordion",{ENTER:"toggle",SPACE:"toggle",ARROW_DOWN:"next",ARROW_UP:"previous"})}_createClass(c,[{key:"_init",value:function(){this.$element.attr("role","tablist");this.$tabs=this.$element.children("li, [data-accordion-item]");this.$tabs.each(function(c,d){var e=b(d),
j=e.children("[data-tab-content]"),k=j[0].id||Foundation.GetYoDigits(6,"accordion"),l=d.id||k+"-label";e.find("a:first").attr({"aria-controls":k,role:"tab",id:l,"aria-expanded":!1,"aria-selected":!1});j.attr({role:"tabpanel","aria-labelledby":l,"aria-hidden":!0,id:k})});var c=this.$element.find(".is-active").children("[data-tab-content]");c.length&&this.down(c,!0);this._events()}},{key:"_events",value:function(){var c=this;this.$tabs.each(function(){var d=b(this),g=d.children("[data-tab-content]");
if(g.length)d.children("a").off("click.zf.accordion keydown.zf.accordion").on("click.zf.accordion",function(b){b.preventDefault();d.hasClass("is-active")?(c.options.allowAllClosed||d.siblings().hasClass("is-active"))&&c.up(g):c.down(g)}).on("keydown.zf.accordion",function(b){Foundation.Keyboard.handleKey(b,"Accordion",{toggle:function(){c.toggle(g)},next:function(){var b=d.next().find("a").focus();c.options.multiExpand||b.trigger("click.zf.accordion")},previous:function(){var b=d.prev().find("a").focus();
c.options.multiExpand||b.trigger("click.zf.accordion")},handled:function(){b.preventDefault();b.stopPropagation()}})})})}},{key:"toggle",value:function(b){b.parent().hasClass("is-active")?(this.options.allowAllClosed||b.parent().siblings().hasClass("is-active"))&&this.up(b):this.down(b)}},{key:"down",value:function(c,d){var g=this;if(!this.options.multiExpand&&!d){var h=this.$element.children(".is-active").children("[data-tab-content]");h.length&&this.up(h)}c.attr("aria-hidden",!1).parent("[data-tab-content]").addBack().parent().addClass("is-active");
c.slideDown(this.options.slideSpeed,function(){g.$element.trigger("down.zf.accordion",[c])});b("#"+c.attr("aria-labelledby")).attr({"aria-expanded":!0,"aria-selected":!0})}},{key:"up",value:function(c){var d=c.parent().siblings(),g=this,d=this.options.multiExpand?d.hasClass("is-active"):c.parent().hasClass("is-active");if(this.options.allowAllClosed||d)c.slideUp(g.options.slideSpeed,function(){g.$element.trigger("up.zf.accordion",[c])}),c.attr("aria-hidden",!0).parent().removeClass("is-active"),b("#"+
c.attr("aria-labelledby")).attr({"aria-expanded":!1,"aria-selected":!1})}},{key:"destroy",value:function(){this.$element.find("[data-tab-content]").stop(!0).slideUp(0).css("display","");this.$element.find("a").off(".zf.accordion");Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={slideSpeed:250,multiExpand:!1,allowAllClosed:!1};Foundation.plugin(c,"Accordion")}(jQuery);"use strict";
_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);Foundation.Nest.Feather(this.$element,"accordion");this._init();Foundation.registerPlugin(this,"AccordionMenu");Foundation.Keyboard.register("AccordionMenu",{ENTER:"toggle",SPACE:"toggle",ARROW_RIGHT:"open",ARROW_UP:"up",ARROW_DOWN:"down",ARROW_LEFT:"close",ESCAPE:"closeAll",TAB:"down",SHIFT_TAB:"up"})}_createClass(c,[{key:"_init",value:function(){this.$element.find("[data-submenu]").not(".is-active").slideUp(0);
this.$element.attr({role:"tablist","aria-multiselectable":this.options.multiOpen});this.$menuLinks=this.$element.find(".is-accordion-submenu-parent");this.$menuLinks.each(function(){var c=this.id||Foundation.GetYoDigits(6,"acc-menu-link"),d=b(this),e=d.children("[data-submenu]"),f=e[0].id||Foundation.GetYoDigits(6,"acc-menu"),l=e.hasClass("is-active");d.attr({"aria-controls":f,"aria-expanded":l,role:"tab",id:c});e.attr({"aria-labelledby":c,"aria-hidden":!l,role:"tabpanel",id:f})});var c=this.$element.find(".is-active");
if(c.length){var d=this;c.each(function(){d.down(b(this))})}this._events()}},{key:"_events",value:function(){var c=this;this.$element.find("li").each(function(){var d=b(this).children("[data-submenu]");if(d.length)b(this).children("a").off("click.zf.accordionMenu").on("click.zf.accordionMenu",function(b){b.preventDefault();c.toggle(d)})}).on("keydown.zf.accordionmenu",function(d){var g=b(this),h=g.parent("ul").children("li"),j,k,l=g.children("[data-submenu]");h.each(function(c){b(this).is(g)&&(j=
h.eq(Math.max(0,c-1)).find("a").first(),k=h.eq(Math.min(c+1,h.length-1)).find("a").first(),b(this).children("[data-submenu]:visible").length&&(k=g.find("li:first-child").find("a").first()),b(this).is(":first-child")?j=g.parents("li").first().find("a").first():j.children("[data-submenu]:visible").length&&(j=j.find("li:last-child").find("a").first()),b(this).is(":last-child")&&(k=g.parents("li").first().next("li").find("a").first()))});Foundation.Keyboard.handleKey(d,"AccordionMenu",{open:function(){l.is(":hidden")&&
(c.down(l),l.find("li").first().find("a").first().focus())},close:function(){l.length&&!l.is(":hidden")?c.up(l):g.parent("[data-submenu]").length&&(c.up(g.parent("[data-submenu]")),g.parents("li").first().find("a").first().focus())},up:function(){j.attr("tabindex",-1).focus();return!0},down:function(){k.attr("tabindex",-1).focus();return!0},toggle:function(){g.children("[data-submenu]").length&&c.toggle(g.children("[data-submenu]"))},closeAll:function(){c.hideAll()},handled:function(b){b&&d.preventDefault();
d.stopImmediatePropagation()}})})}},{key:"hideAll",value:function(){this.$element.find("[data-submenu]").slideUp(this.options.slideSpeed)}},{key:"toggle",value:function(b){b.is(":animated")||(b.is(":hidden")?this.down(b):this.up(b))}},{key:"down",value:function(b){var c=this;this.options.multiOpen||this.up(this.$element.find(".is-active").not(b.parentsUntil(this.$element).add(b)));b.addClass("is-active").attr({"aria-hidden":!1}).parent(".is-accordion-submenu-parent").attr({"aria-expanded":!0});b.slideDown(c.options.slideSpeed,
function(){c.$element.trigger("down.zf.accordionMenu",[b])})}},{key:"up",value:function(b){var c=this;b.slideUp(c.options.slideSpeed,function(){c.$element.trigger("up.zf.accordionMenu",[b])});b.find("[data-submenu]").slideUp(0).addBack().attr("aria-hidden",!0).parent(".is-accordion-submenu-parent").attr("aria-expanded",!1)}},{key:"destroy",value:function(){this.$element.find("[data-submenu]").slideDown(0).css("display","");this.$element.find("a").off("click.zf.accordionMenu");Foundation.Nest.Burn(this.$element,
"accordion");Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={slideSpeed:250,multiOpen:!0};Foundation.plugin(c,"AccordionMenu")}(jQuery);"use strict";_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();
function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);Foundation.Nest.Feather(this.$element,"drilldown");this._init();Foundation.registerPlugin(this,"Drilldown");Foundation.Keyboard.register("Drilldown",{ENTER:"open",SPACE:"open",ARROW_RIGHT:"next",ARROW_UP:"up",ARROW_DOWN:"down",ARROW_LEFT:"previous",ESCAPE:"close",TAB:"down",SHIFT_TAB:"up"})}_createClass(c,[{key:"_init",value:function(){this.$submenuAnchors=
this.$element.find("li.is-drilldown-submenu-parent").children("a");this.$submenus=this.$submenuAnchors.parent("li").children("[data-submenu]");this.$menuItems=this.$element.find("li").not(".js-drilldown-back").attr("role","menuitem").find("a");this._prepareMenu();this._keyboardEvents()}},{key:"_prepareMenu",value:function(){var c=this;this.$submenuAnchors.each(function(){var d=b(this),g=d.parent();c.options.parentLink&&d.clone().prependTo(g.children("[data-submenu]")).wrap('<li class="is-submenu-parent-item is-submenu-item is-drilldown-submenu-item" role="menu-item"></li>');
d.data("savedHref",d.attr("href")).removeAttr("href");d.children("[data-submenu]").attr({"aria-hidden":!0,tabindex:0,role:"menu"});c._events(d)});this.$submenus.each(function(){var d=b(this);d.find(".js-drilldown-back").length||d.prepend(c.options.backButton);c._back(d)});this.$element.parent().hasClass("is-drilldown")||(this.$wrapper=b(this.options.wrapper).addClass("is-drilldown"),this.$wrapper=this.$element.wrap(this.$wrapper).parent().css(this._getMaxDims()))}},{key:"_events",value:function(c){var d=
this;c.off("click.zf.drilldown").on("click.zf.drilldown",function(g){b(g.target).parentsUntil("ul","li").hasClass("is-drilldown-submenu-parent")&&(g.stopImmediatePropagation(),g.preventDefault());d._show(c.parent("li"));if(d.options.closeOnClick){var h=b("body");h.off(".zf.drilldown").on("click.zf.drilldown",function(c){if(!(c.target===d.$element[0]||b.contains(d.$element[0],c.target))){c.preventDefault();d._hideAll();h.off(".zf.drilldown")}})}})}},{key:"_keyboardEvents",value:function(){var c=this;
this.$menuItems.add(this.$element.find(".js-drilldown-back > a")).on("keydown.zf.drilldown",function(d){var g=b(this),h=g.parent("li").parent("ul").children("li").children("a"),j,k;h.each(function(c){b(this).is(g)&&(j=h.eq(Math.max(0,c-1)),k=h.eq(Math.min(c+1,h.length-1)))});Foundation.Keyboard.handleKey(d,"Drilldown",{next:function(){if(g.is(c.$submenuAnchors))return c._show(g.parent("li")),g.parent("li").one(Foundation.transitionend(g),function(){g.parent("li").find("ul li a").filter(c.$menuItems).first().focus()}),
!0},previous:function(){c._hide(g.parent("li").parent("ul"));g.parent("li").parent("ul").one(Foundation.transitionend(g),function(){setTimeout(function(){g.parent("li").parent("ul").parent("li").children("a").first().focus()},1)});return!0},up:function(){j.focus();return!0},down:function(){k.focus();return!0},close:function(){c._back()},open:function(){g.is(c.$menuItems)?g.is(c.$submenuAnchors)&&(c._show(g.parent("li")),g.parent("li").one(Foundation.transitionend(g),function(){g.parent("li").find("ul li a").filter(c.$menuItems).first().focus()})):
(c._hide(g.parent("li").parent("ul")),g.parent("li").parent("ul").one(Foundation.transitionend(g),function(){setTimeout(function(){g.parent("li").parent("ul").parent("li").children("a").first().focus()},1)}));return!0},handled:function(b){b&&d.preventDefault();d.stopImmediatePropagation()}})})}},{key:"_hideAll",value:function(){var b=this.$element.find(".is-drilldown-submenu.is-active").addClass("is-closing");b.one(Foundation.transitionend(b),function(){b.removeClass("is-active is-closing")});this.$element.trigger("closed.zf.drilldown")}},
{key:"_back",value:function(b){var c=this;b.off("click.zf.drilldown");b.children(".js-drilldown-back").on("click.zf.drilldown",function(d){d.stopImmediatePropagation();c._hide(b)})}},{key:"_menuLinkEvents",value:function(){var b=this;this.$menuItems.not(".is-drilldown-submenu-parent").off("click.zf.drilldown").on("click.zf.drilldown",function(){setTimeout(function(){b._hideAll()},0)})}},{key:"_show",value:function(b){b.children("[data-submenu]").addClass("is-active");this.$element.trigger("open.zf.drilldown",
[b])}},{key:"_hide",value:function(b){b.addClass("is-closing").one(Foundation.transitionend(b),function(){b.removeClass("is-active is-closing");b.blur()});b.trigger("hide.zf.drilldown",[b])}},{key:"_getMaxDims",value:function(){var c=0,d={};this.$submenus.add(this.$element).each(function(){var d=b(this).children("li").length;c=d>c?d:c});d["min-height"]=c*this.$menuItems[0].getBoundingClientRect().height+"px";d["max-width"]=this.$element[0].getBoundingClientRect().width+"px";return d}},{key:"destroy",
value:function(){this._hideAll();Foundation.Nest.Burn(this.$element,"drilldown");this.$element.unwrap().find(".js-drilldown-back, .is-submenu-parent-item").remove().end().find(".is-active, .is-closing, .is-drilldown-submenu").removeClass("is-active is-closing is-drilldown-submenu").end().find("[data-submenu]").removeAttr("aria-hidden tabindex role");this.$submenuAnchors.each(function(){b(this).off(".zf.drilldown")});this.$element.find("a").each(function(){var c=b(this);c.data("savedHref")&&c.attr("href",
c.data("savedHref")).removeData("savedHref")});Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={backButton:'<li class="js-drilldown-back"><a tabindex="0">Back</a></li>',wrapper:"<div></div>",parentLink:!1,closeOnClick:!1};Foundation.plugin(c,"Drilldown")}(jQuery);"use strict";
_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this._init();Foundation.registerPlugin(this,"Dropdown");Foundation.Keyboard.register("Dropdown",{ENTER:"open",SPACE:"open",ESCAPE:"close",TAB:"tab_forward",SHIFT_TAB:"tab_backward"})}_createClass(c,[{key:"_init",value:function(){var c=this.$element.attr("id");this.$anchor=b('[data-toggle="'+c+'"]')||b('[data-open="'+c+'"]');this.$anchor.attr({"aria-controls":c,
"data-is-focus":!1,"data-yeti-box":c,"aria-haspopup":!0,"aria-expanded":!1});this.options.positionClass=this.getPositionClass();this.counter=4;this.usedPositions=[];this.$element.attr({"aria-hidden":"true","data-yeti-box":c,"data-resize":c,"aria-labelledby":this.$anchor[0].id||Foundation.GetYoDigits(6,"dd-anchor")});this._events()}},{key:"getPositionClass",value:function(){var b=this.$element[0].className.match(/(top|left|right|bottom)/g),b=b?b[0]:"",c=/float-(\S+)\s/.exec(this.$anchor[0].className);
return(c=c?c[1]:"")?c+" "+b:b}},{key:"_reposition",value:function(b){this.usedPositions.push(b?b:"bottom");!b&&0>this.usedPositions.indexOf("top")?this.$element.addClass("top"):"top"===b&&0>this.usedPositions.indexOf("bottom")?this.$element.removeClass(b):"left"===b&&0>this.usedPositions.indexOf("right")?this.$element.removeClass(b).addClass("right"):"right"===b&&0>this.usedPositions.indexOf("left")?this.$element.removeClass(b).addClass("left"):!b&&-1<this.usedPositions.indexOf("top")&&0>this.usedPositions.indexOf("left")?
this.$element.addClass("left"):"top"===b&&-1<this.usedPositions.indexOf("bottom")&&0>this.usedPositions.indexOf("left")?this.$element.removeClass(b).addClass("left"):("left"===b&&-1<this.usedPositions.indexOf("right")&&0>this.usedPositions.indexOf("bottom")||"right"===b&&-1<this.usedPositions.indexOf("left")&&this.usedPositions.indexOf("bottom"),this.$element.removeClass(b));this.classChanged=!0;this.counter--}},{key:"_setPosition",value:function(){if("false"===this.$anchor.attr("aria-expanded"))return!1;
var b=this.getPositionClass(),c=Foundation.Box.GetDimensions(this.$element);Foundation.Box.GetDimensions(this.$anchor);if(c.width>=c.windowDims.width||!this.counter&&!Foundation.Box.ImNotTouchingYou(this.$element))return this.$element.offset(Foundation.Box.GetOffsets(this.$element,this.$anchor,"center bottom",this.options.vOffset,this.options.hOffset,!0)).css({width:c.windowDims.width-2*this.options.hOffset,height:"auto"}),this.classChanged=!0,!1;for(this.$element.offset(Foundation.Box.GetOffsets(this.$element,
this.$anchor,b,this.options.vOffset,this.options.hOffset));!Foundation.Box.ImNotTouchingYou(this.$element,!1,!0)&&this.counter;)this._reposition(b),this._setPosition()}},{key:"_events",value:function(){var c=this;this.$element.on({"open.zf.trigger":this.open.bind(this),"close.zf.trigger":this.close.bind(this),"toggle.zf.trigger":this.toggle.bind(this),"resizeme.zf.trigger":this._setPosition.bind(this)});if(this.options.hover&&(this.$anchor.off("mouseenter.zf.dropdown mouseleave.zf.dropdown").on("mouseenter.zf.dropdown",
function(){clearTimeout(c.timeout);c.timeout=setTimeout(function(){c.open();c.$anchor.data("hover",!0)},c.options.hoverDelay)}).on("mouseleave.zf.dropdown",function(){clearTimeout(c.timeout);c.timeout=setTimeout(function(){c.close();c.$anchor.data("hover",!1)},c.options.hoverDelay)}),this.options.hoverPane))this.$element.off("mouseenter.zf.dropdown mouseleave.zf.dropdown").on("mouseenter.zf.dropdown",function(){clearTimeout(c.timeout)}).on("mouseleave.zf.dropdown",function(){clearTimeout(c.timeout);
c.timeout=setTimeout(function(){c.close();c.$anchor.data("hover",!1)},c.options.hoverDelay)});this.$anchor.add(this.$element).on("keydown.zf.dropdown",function(d){var g=b(this),h=Foundation.Keyboard.findFocusable(c.$element);Foundation.Keyboard.handleKey(d,"Dropdown",{tab_forward:function(){c.$element.find(":focus").is(h.eq(-1))&&(c.options.trapFocus?(h.eq(0).focus(),d.preventDefault()):c.close())},tab_backward:function(){if(c.$element.find(":focus").is(h.eq(0))||c.$element.is(":focus"))c.options.trapFocus?
(h.eq(-1).focus(),d.preventDefault()):c.close()},open:function(){g.is(c.$anchor)&&(c.open(),c.$element.attr("tabindex",-1).focus(),d.preventDefault())},close:function(){c.close();c.$anchor.focus()}})})}},{key:"_addBodyHandler",value:function(){var c=b(document.body).not(this.$element),d=this;c.off("click.zf.dropdown").on("click.zf.dropdown",function(b){!d.$anchor.is(b.target)&&!d.$anchor.find(b.target).length&&!d.$element.find(b.target).length&&(d.close(),c.off("click.zf.dropdown"))})}},{key:"open",
value:function(){this.$element.trigger("closeme.zf.dropdown",this.$element.attr("id"));this.$anchor.addClass("hover").attr({"aria-expanded":!0});this._setPosition();this.$element.addClass("is-open").attr({"aria-hidden":!1});if(this.options.autoFocus){var b=Foundation.Keyboard.findFocusable(this.$element);b.length&&b.eq(0).focus()}this.options.closeOnClick&&this._addBodyHandler();this.$element.trigger("show.zf.dropdown",[this.$element])}},{key:"close",value:function(){if(!this.$element.hasClass("is-open"))return!1;
this.$element.removeClass("is-open").attr({"aria-hidden":!0});this.$anchor.removeClass("hover").attr("aria-expanded",!1);if(this.classChanged){var b=this.getPositionClass();b&&this.$element.removeClass(b);this.$element.addClass(this.options.positionClass).css({height:"",width:""});this.classChanged=!1;this.counter=4;this.usedPositions.length=0}this.$element.trigger("hide.zf.dropdown",[this.$element])}},{key:"toggle",value:function(){this.$element.hasClass("is-open")?this.$anchor.data("hover")||this.close():
this.open()}},{key:"destroy",value:function(){this.$element.off(".zf.trigger").hide();this.$anchor.off(".zf.dropdown");Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={hoverDelay:250,hover:!1,hoverPane:!1,vOffset:1,hOffset:1,positionClass:"",trapFocus:!1,autoFocus:!1,closeOnClick:!1};Foundation.plugin(c,"Dropdown")}(jQuery);"use strict";
_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);Foundation.Nest.Feather(this.$element,"dropdown");this._init();Foundation.registerPlugin(this,"DropdownMenu");Foundation.Keyboard.register("DropdownMenu",{ENTER:"open",SPACE:"open",ARROW_RIGHT:"next",ARROW_UP:"up",ARROW_DOWN:"down",ARROW_LEFT:"previous",ESCAPE:"close"})}_createClass(c,[{key:"_init",value:function(){var b=this.$element.find("li.is-dropdown-submenu-parent");
this.$element.children(".is-dropdown-submenu-parent").children(".is-dropdown-submenu").addClass("first-sub");this.$menuItems=this.$element.find('[role="menuitem"]');this.$tabs=this.$element.children('[role="menuitem"]');this.$tabs.find("ul.is-dropdown-submenu").addClass(this.options.verticalClass);this.$element.hasClass(this.options.rightClass)||"right"===this.options.alignment||Foundation.rtl()||this.$element.parents(".top-bar-right").is("*")?(this.options.alignment="right",b.addClass("opens-left")):
b.addClass("opens-right");this.changed=!1;this._events()}},{key:"_events",value:function(){var c=this,d="ontouchstart"in window||"undefined"!==typeof window.ontouchstart,g=function(g){var j=b(g.target).parentsUntil("ul",".is-dropdown-submenu-parent"),k=j.hasClass("is-dropdown-submenu-parent"),l="true"===j.attr("data-is-click");j.children(".is-dropdown-submenu");if(k)if(l){if(c.options.closeOnClick&&!(!c.options.clickOpen&&!d||c.options.forceFollow&&d))g.stopImmediatePropagation(),g.preventDefault(),
c._hide(j)}else g.preventDefault(),g.stopImmediatePropagation(),c._show(j.children(".is-dropdown-submenu")),j.add(j.parentsUntil(c.$element,".is-dropdown-submenu-parent")).attr("data-is-click",!0)};if(this.options.clickOpen||d)this.$menuItems.on("click.zf.dropdownmenu touchstart.zf.dropdownmenu",g);if(!this.options.disableHover)this.$menuItems.on("mouseenter.zf.dropdownmenu",function(){var d=b(this);d.hasClass("is-dropdown-submenu-parent")&&(clearTimeout(c.delay),c.delay=setTimeout(function(){c._show(d.children(".is-dropdown-submenu"))},
c.options.hoverDelay))}).on("mouseleave.zf.dropdownmenu",function(){var d=b(this);if(d.hasClass("is-dropdown-submenu-parent")&&c.options.autoclose){if("true"===d.attr("data-is-click")&&c.options.clickOpen)return!1;clearTimeout(c.delay);c.delay=setTimeout(function(){c._hide(d)},c.options.closingTime)}});this.$menuItems.on("keydown.zf.dropdownmenu",function(d){var f=b(d.target).parentsUntil("ul",'[role="menuitem"]'),g=-1<c.$tabs.index(f),l=g?c.$tabs:f.siblings("li").add(f),m,n;l.each(function(c){b(this).is(f)&&
(m=l.eq(c-1),n=l.eq(c+1))});var q=function(){f.is(":last-child")||(n.children("a:first").focus(),d.preventDefault())},p=function(){m.children("a:first").focus();d.preventDefault()},s=function(){var b=f.children("ul.is-dropdown-submenu");b.length&&(c._show(b),f.find("li > a:first").focus(),d.preventDefault())},r=function(){var b=f.parent("ul").parent("li");b.children("a:first").focus();c._hide(b);d.preventDefault()},o={open:s,close:function(){c._hide(c.$element);c.$menuItems.find("a:first").focus();
d.preventDefault()},handled:function(){d.stopImmediatePropagation()}};g?c.$element.hasClass(c.options.verticalClass)?"left"===c.options.alignment?b.extend(o,{down:q,up:p,next:s,previous:r}):b.extend(o,{down:q,up:p,next:r,previous:s}):b.extend(o,{next:q,previous:p,down:s,up:r}):"left"===c.options.alignment?b.extend(o,{next:s,previous:r,down:q,up:p}):b.extend(o,{next:r,previous:s,down:q,up:p});Foundation.Keyboard.handleKey(d,"DropdownMenu",o)})}},{key:"_addBodyHandler",value:function(){var c=b(document.body),
d=this;c.off("mouseup.zf.dropdownmenu touchend.zf.dropdownmenu").on("mouseup.zf.dropdownmenu touchend.zf.dropdownmenu",function(b){d.$element.find(b.target).length||(d._hide(),c.off("mouseup.zf.dropdownmenu touchend.zf.dropdownmenu"))})}},{key:"_show",value:function(c){var d=this.$tabs.index(this.$tabs.filter(function(d,f){return 0<b(f).find(c).length}));this._hide(c.parent("li.is-dropdown-submenu-parent").siblings("li.is-dropdown-submenu-parent"),d);c.css("visibility","hidden").addClass("js-dropdown-active").attr({"aria-hidden":!1}).parent("li.is-dropdown-submenu-parent").addClass("is-active").attr({"aria-expanded":!0});
var g=Foundation.Box.ImNotTouchingYou(c,null,!0);g||(g="left"===this.options.alignment?"-right":"-left",d=c.parent(".is-dropdown-submenu-parent"),d.removeClass("opens"+g).addClass("opens-"+this.options.alignment),(g=Foundation.Box.ImNotTouchingYou(c,null,!0))||d.removeClass("opens-"+this.options.alignment).addClass("opens-inner"),this.changed=!0);c.css("visibility","");this.options.closeOnClick&&this._addBodyHandler();this.$element.trigger("show.zf.dropdownmenu",[c])}},{key:"_hide",value:function(b,
c){var d;d=b&&b.length?b:void 0!==c?this.$tabs.not(function(b){return b===c}):this.$element;if(d.hasClass("is-active")||0<d.find(".is-active").length){d.find("li.is-active").add(d).attr({"aria-expanded":!1,"data-is-click":!1}).removeClass("is-active");d.find("ul.js-dropdown-active").attr({"aria-hidden":!0}).removeClass("js-dropdown-active");if(this.changed||d.find("opens-inner").length){var h="left"===this.options.alignment?"right":"left";d.find("li.is-dropdown-submenu-parent").add(d).removeClass("opens-inner opens-"+
this.options.alignment).addClass("opens-"+h);this.changed=!1}this.$element.trigger("hide.zf.dropdownmenu",[d])}}},{key:"destroy",value:function(){this.$menuItems.off(".zf.dropdownmenu").removeAttr("data-is-click").removeClass("is-right-arrow is-left-arrow is-down-arrow opens-right opens-left opens-inner");b(document.body).off(".zf.dropdownmenu");Foundation.Nest.Burn(this.$element,"dropdown");Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={disableHover:!1,autoclose:!0,hoverDelay:50,clickOpen:!1,
closingTime:500,alignment:"left",closeOnClick:!0,verticalClass:"vertical",rightClass:"align-right",forceFollow:!0};Foundation.plugin(c,"DropdownMenu")}(jQuery);"use strict";_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();
function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this._init();Foundation.registerPlugin(this,"Equalizer")}_createClass(c,[{key:"_init",value:function(){var c=this.$element.attr("data-equalizer")||"",d=this.$element.find('[data-equalizer-watch="'+c+'"]');this.$watched=d.length?d:this.$element.find("[data-equalizer-watch]");this.$element.attr("data-resize",c||Foundation.GetYoDigits(6,"eq"));this.hasNested=
0<this.$element.find("[data-equalizer]").length;this.isNested=0<this.$element.parentsUntil(document.body,"[data-equalizer]").length;this.isOn=!1;this._bindHandler={onResizeMeBound:this._onResizeMe.bind(this),onPostEqualizedBound:this._onPostEqualized.bind(this)};var c=this.$element.find("img"),g;this.options.equalizeOn?(g=this._checkMQ(),b(window).on("changed.zf.mediaquery",this._checkMQ.bind(this))):this._events();if(void 0!==g&&!1===g||void 0===g)if(c.length)Foundation.onImagesLoaded(c,this._reflow.bind(this));
else this._reflow()}},{key:"_pauseEvents",value:function(){this.isOn=!1;this.$element.off({".zf.equalizer":this._bindHandler.onPostEqualizedBound,"resizeme.zf.trigger":this._bindHandler.onResizeMeBound})}},{key:"_onResizeMe",value:function(){this._reflow()}},{key:"_onPostEqualized",value:function(b){b.target!==this.$element[0]&&this._reflow()}},{key:"_events",value:function(){this._pauseEvents();if(this.hasNested)this.$element.on("postequalized.zf.equalizer",this._bindHandler.onPostEqualizedBound);
else this.$element.on("resizeme.zf.trigger",this._bindHandler.onResizeMeBound);this.isOn=!0}},{key:"_checkMQ",value:function(){var b=!Foundation.MediaQuery.atLeast(this.options.equalizeOn);b?this.isOn&&(this._pauseEvents(),this.$watched.css("height","auto")):this.isOn||this._events();return b}},{key:"_killswitch",value:function(){}},{key:"_reflow",value:function(){if(!this.options.equalizeOnStack&&this._isStacked())return this.$watched.css("height","auto"),!1;this.options.equalizeByRow?this.getHeightsByRow(this.applyHeightByRow.bind(this)):
this.getHeights(this.applyHeight.bind(this))}},{key:"_isStacked",value:function(){return this.$watched[0].getBoundingClientRect().top!==this.$watched[1].getBoundingClientRect().top}},{key:"getHeights",value:function(b){for(var c=[],d=0,h=this.$watched.length;d<h;d++)this.$watched[d].style.height="auto",c.push(this.$watched[d].offsetHeight);b(c)}},{key:"getHeightsByRow",value:function(c){var d=this.$watched.length?this.$watched.first().offset().top:0,g=[],h=0;g[h]=[];for(var j=0,k=this.$watched.length;j<
k;j++){this.$watched[j].style.height="auto";var l=b(this.$watched[j]).offset().top;l!=d&&(h++,g[h]=[],d=l);g[h].push([this.$watched[j],this.$watched[j].offsetHeight])}d=0;for(h=g.length;d<h;d++)j=b(g[d]).map(function(){return this[1]}).get(),j=Math.max.apply(null,j),g[d].push(j);c(g)}},{key:"applyHeight",value:function(b){b=Math.max.apply(null,b);this.$element.trigger("preequalized.zf.equalizer");this.$watched.css("height",b);this.$element.trigger("postequalized.zf.equalizer")}},{key:"applyHeightByRow",
value:function(c){this.$element.trigger("preequalized.zf.equalizer");for(var d=0,g=c.length;d<g;d++){var h=c[d].length,j=c[d][h-1];if(2>=h)b(c[d][0][0]).css({height:"auto"});else{this.$element.trigger("preequalizedrow.zf.equalizer");for(var k=0,h=h-1;k<h;k++)b(c[d][k][0]).css({height:j});this.$element.trigger("postequalizedrow.zf.equalizer")}}this.$element.trigger("postequalized.zf.equalizer")}},{key:"destroy",value:function(){this._pauseEvents();this.$watched.css("height","auto");Foundation.unregisterPlugin(this)}}]);
return c}();c.defaults={equalizeOnStack:!0,equalizeByRow:!1,equalizeOn:""};Foundation.plugin(c,"Equalizer")}(jQuery);"use strict";_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,f);this.rules=[];this.currentPath="";this._init();this._events();Foundation.registerPlugin(this,"Interchange")}_createClass(c,[{key:"_init",value:function(){this._addBreakpoints();this._generateRules();this._reflow()}},{key:"_events",value:function(){b(window).on("resize.zf.interchange",Foundation.util.throttle(this._reflow.bind(this),50))}},{key:"_reflow",value:function(){var b,
c;for(c in this.rules)if(this.rules.hasOwnProperty(c)){var d=this.rules[c];window.matchMedia(d.query).matches&&(b=d)}b&&this.replace(b.path)}},{key:"_addBreakpoints",value:function(){for(var b in Foundation.MediaQuery.queries)if(Foundation.MediaQuery.queries.hasOwnProperty(b)){var f=Foundation.MediaQuery.queries[b];c.SPECIAL_QUERIES[f.name]=f.value}}},{key:"_generateRules",value:function(){var b=[],f;f=this.options.rules?this.options.rules:this.$element.data("interchange").match(/\[.*?\]/g);for(var g in f)if(f.hasOwnProperty(g)){var h=
f[g].slice(1,-1).split(", "),j=h.slice(0,-1).join(""),h=h[h.length-1];c.SPECIAL_QUERIES[h]&&(h=c.SPECIAL_QUERIES[h]);b.push({path:j,query:h})}this.rules=b}},{key:"replace",value:function(c){if(this.currentPath!==c){var d=this;"IMG"===this.$element[0].nodeName?this.$element.attr("src",c).load(function(){d.currentPath=c}).trigger("replaced.zf.interchange"):c.match(/\.(gif|jpg|jpeg|png|svg|tiff)([?#].*)?/i)?this.$element.css({"background-image":"url("+c+")"}).trigger("replaced.zf.interchange"):b.get(c,
function(g){d.$element.html(g).trigger("replaced.zf.interchange");b(g).foundation();d.currentPath=c})}}},{key:"destroy",value:function(){}}]);return c}();c.defaults={rules:null};c.SPECIAL_QUERIES={landscape:"screen and (orientation: landscape)",portrait:"screen and (orientation: portrait)",retina:"only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min--moz-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min-device-pixel-ratio: 2), only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx)"};
Foundation.plugin(c,"Interchange")}(jQuery);"use strict";_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this._init();Foundation.registerPlugin(this,"Magellan")}_createClass(c,[{key:"_init",value:function(){var c=this.$element[0].id||Foundation.GetYoDigits(6,"magellan");this.$targets=b("[data-magellan-target]");this.$links=this.$element.find("a");this.$element.attr({"data-resize":c,"data-scroll":c,id:c});this.$active=b();this.scrollPos=parseInt(window.pageYOffset,
10);this._events()}},{key:"calcPoints",value:function(){var c=this,d=document.body,g=document.documentElement;this.points=[];this.winHeight=Math.round(Math.max(window.innerHeight,g.clientHeight));this.docHeight=Math.round(Math.max(d.scrollHeight,d.offsetHeight,g.clientHeight,g.scrollHeight,g.offsetHeight));this.$targets.each(function(){var d=b(this),f=Math.round(d.offset().top-c.options.threshold);d.targetPoint=f;c.points.push(f)})}},{key:"_events",value:function(){var c=this;b("html, body");b(window).one("load",
function(){c.options.deepLinking&&location.hash&&c.scrollToLoc(location.hash);c.calcPoints();c._updateActive()});this.$element.on({"resizeme.zf.trigger":this.reflow.bind(this),"scrollme.zf.trigger":this._updateActive.bind(this)}).on("click.zf.magellan",'a[href^="#"]',function(b){b.preventDefault();b=this.getAttribute("href");c.scrollToLoc(b)})}},{key:"scrollToLoc",value:function(c){c=Math.round(b(c).offset().top-this.options.threshold/2-this.options.barOffset);b("html, body").stop(!0).animate({scrollTop:c},
this.options.animationDuration,this.options.animationEasing)}},{key:"reflow",value:function(){this.calcPoints();this._updateActive()}},{key:"_updateActive",value:function(){var b=parseInt(window.pageYOffset,10),c;if(b+this.winHeight===this.docHeight)c=this.points.length-1;else if(b<this.points[0])c=0;else{var d=this.scrollPos<b,h=this;c=this.points.filter(function(c){return d?c-h.options.barOffset<=b:c-h.options.barOffset-h.options.threshold<=b});c=c.length?c.length-1:0}this.$active.removeClass(this.options.activeClass);
this.$active=this.$links.eq(c).addClass(this.options.activeClass);this.options.deepLinking&&(c=this.$active[0].getAttribute("href"),window.history.pushState?window.history.pushState(null,null,c):window.location.hash=c);this.scrollPos=b;this.$element.trigger("update.zf.magellan",[this.$active])}},{key:"destroy",value:function(){this.$element.off(".zf.trigger .zf.magellan").find("."+this.options.activeClass).removeClass(this.options.activeClass);if(this.options.deepLinking){var b=this.$active[0].getAttribute("href");
window.location.hash.replace(b,"")}Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={animationDuration:500,animationEasing:"linear",threshold:50,activeClass:"active",deepLinking:!1,barOffset:0};Foundation.plugin(c,"Magellan")}(jQuery);"use strict";
_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this.$lastTrigger=b();this.$triggers=b();this._init();this._events();Foundation.registerPlugin(this,"OffCanvas")}_createClass(c,[{key:"_init",value:function(){var c=this.$element.attr("id");this.$element.attr("aria-hidden","true");this.$triggers=b(document).find('[data-open="'+c+'"], [data-close="'+c+'"], [data-toggle="'+c+'"]').attr("aria-expanded","false").attr("aria-controls",
c);this.options.closeOnClick&&(b(".js-off-canvas-exit").length?this.$exiter=b(".js-off-canvas-exit"):(c=document.createElement("div"),c.setAttribute("class","js-off-canvas-exit"),b("[data-off-canvas-content]").append(c),this.$exiter=b(c)));this.options.isRevealed=this.options.isRevealed||RegExp(this.options.revealClass,"g").test(this.$element[0].className);this.options.isRevealed&&(this.options.revealOn=this.options.revealOn||this.$element[0].className.match(/(reveal-for-medium|reveal-for-large)/g)[0].split("-")[2],
this._setMQChecker());this.options.transitionTime||(this.options.transitionTime=1E3*parseFloat(window.getComputedStyle(b("[data-off-canvas-wrapper]")[0]).transitionDuration))}},{key:"_events",value:function(){this.$element.off(".zf.trigger .zf.offcanvas").on({"open.zf.trigger":this.open.bind(this),"close.zf.trigger":this.close.bind(this),"toggle.zf.trigger":this.toggle.bind(this),"keydown.zf.offcanvas":this._handleKeyboard.bind(this)});if(this.options.closeOnClick&&this.$exiter.length)this.$exiter.on({"click.zf.offcanvas":this.close.bind(this)})}},
{key:"_setMQChecker",value:function(){var c=this;b(window).on("changed.zf.mediaquery",function(){Foundation.MediaQuery.atLeast(c.options.revealOn)?c.reveal(!0):c.reveal(!1)}).one("load.zf.offcanvas",function(){Foundation.MediaQuery.atLeast(c.options.revealOn)&&c.reveal(!0)})}},{key:"reveal",value:function(b){var c=this.$element.find("[data-close]");b?(this.close(),this.isRevealed=!0,this.$element.off("open.zf.trigger toggle.zf.trigger"),c.length&&c.hide()):(this.isRevealed=!1,this.$element.on({"open.zf.trigger":this.open.bind(this),
"toggle.zf.trigger":this.toggle.bind(this)}),c.length&&c.show())}},{key:"open",value:function(c,d){if(!this.$element.hasClass("is-open")&&!this.isRevealed){var g=this;b(document.body);this.options.forceTop&&b("body").scrollTop(0);Foundation.Move(this.options.transitionTime,this.$element,function(){b("[data-off-canvas-wrapper]").addClass("is-off-canvas-open is-open-"+g.options.position);g.$element.addClass("is-open")});this.$triggers.attr("aria-expanded","true");this.$element.attr("aria-hidden","false").trigger("opened.zf.offcanvas");
this.options.closeOnClick&&this.$exiter.addClass("is-visible");d&&(this.$lastTrigger=d);if(this.options.autoFocus)this.$element.one(Foundation.transitionend(this.$element),function(){g.$element.find("a, button").eq(0).focus()});this.options.trapFocus&&(b("[data-off-canvas-content]").attr("tabindex","-1"),this._trapFocus())}}},{key:"_trapFocus",value:function(){var b=Foundation.Keyboard.findFocusable(this.$element),c=b.eq(0),d=b.eq(-1);b.off(".zf.offcanvas").on("keydown.zf.offcanvas",function(b){if(9===
b.which||9===b.keycode)if(b.target===d[0]&&!b.shiftKey&&(b.preventDefault(),c.focus()),b.target===c[0]&&b.shiftKey)b.preventDefault(),d.focus()})}},{key:"close",value:function(){this.$element.hasClass("is-open")&&!this.isRevealed&&(b("[data-off-canvas-wrapper]").removeClass("is-off-canvas-open is-open-"+this.options.position),this.$element.removeClass("is-open"),this.$element.attr("aria-hidden","true").trigger("closed.zf.offcanvas"),this.options.closeOnClick&&this.$exiter.removeClass("is-visible"),
this.$triggers.attr("aria-expanded","false"),this.options.trapFocus&&b("[data-off-canvas-content]").removeAttr("tabindex"))}},{key:"toggle",value:function(b,c){this.$element.hasClass("is-open")?this.close(b,c):this.open(b,c)}},{key:"_handleKeyboard",value:function(b){27===b.which&&(b.stopPropagation(),b.preventDefault(),this.close(),this.$lastTrigger.focus())}},{key:"destroy",value:function(){this.close();this.$element.off(".zf.trigger .zf.offcanvas");this.$exiter.off(".zf.offcanvas");Foundation.unregisterPlugin(this)}}]);
return c}();c.defaults={closeOnClick:!0,transitionTime:0,position:"left",forceTop:!0,isRevealed:!1,revealOn:null,autoFocus:!0,revealClass:"reveal-for-",trapFocus:!1};Foundation.plugin(c,"OffCanvas")}(jQuery);"use strict";_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();
function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this._init();Foundation.registerPlugin(this,"Orbit");Foundation.Keyboard.register("Orbit",{ltr:{ARROW_RIGHT:"next",ARROW_LEFT:"previous"},rtl:{ARROW_LEFT:"next",ARROW_RIGHT:"previous"}})}_createClass(c,[{key:"_init",value:function(){this.$wrapper=this.$element.find("."+this.options.containerClass);this.$slides=this.$element.find("."+this.options.slideClass);
var b=this.$element.find("img");this.$slides.filter(".is-active").length||this.$slides.eq(0).addClass("is-active");this.options.useMUI||this.$slides.addClass("no-motionui");if(b.length)Foundation.onImagesLoaded(b,this._prepareForOrbit.bind(this));else this._prepareForOrbit();this.options.bullets&&this._loadBullets();this._events();this.options.autoPlay&&1<this.$slides.length&&this.geoSync();this.options.accessible&&this.$wrapper.attr("tabindex",0)}},{key:"_loadBullets",value:function(){this.$bullets=
this.$element.find("."+this.options.boxOfBullets).find("button")}},{key:"geoSync",value:function(){var b=this;this.timer=new Foundation.Timer(this.$element,{duration:this.options.timerDelay,infinite:!1},function(){b.changeSlide(!0)});this.timer.start()}},{key:"_prepareForOrbit",value:function(){var b=this;this._setWrapperHeight(function(c){b._setSlideHeight(c)})}},{key:"_setWrapperHeight",value:function(c){var d=0,g,h=0;this.$slides.each(function(){g=this.getBoundingClientRect().height;b(this).attr("data-slide",
h);h&&b(this).css({position:"relative",display:"none"});d=g>d?g:d;h++});h===this.$slides.length&&(this.$wrapper.css({height:d}),c(d))}},{key:"_setSlideHeight",value:function(c){this.$slides.each(function(){b(this).css("max-height",c)})}},{key:"_events",value:function(){var c=this;if(1<this.$slides.length){if(this.options.swipe)this.$slides.off("swipeleft.zf.orbit swiperight.zf.orbit").on("swipeleft.zf.orbit",function(b){b.preventDefault();c.changeSlide(!0)}).on("swiperight.zf.orbit",function(b){b.preventDefault();
c.changeSlide(!1)});if(this.options.autoPlay&&(this.$slides.on("click.zf.orbit",function(){c.$element.data("clickedOn",c.$element.data("clickedOn")?!1:!0);c.timer[c.$element.data("clickedOn")?"pause":"start"]()}),this.options.pauseOnHover))this.$element.on("mouseenter.zf.orbit",function(){c.timer.pause()}).on("mouseleave.zf.orbit",function(){c.$element.data("clickedOn")||c.timer.start()});if(this.options.navButtons)this.$element.find("."+this.options.nextClass+", ."+this.options.prevClass).attr("tabindex",
0).on("click.zf.orbit touchend.zf.orbit",function(d){d.preventDefault();c.changeSlide(b(this).hasClass(c.options.nextClass))});if(this.options.bullets)this.$bullets.on("click.zf.orbit touchend.zf.orbit",function(){if(/is-active/g.test(this.className))return!1;var d=b(this).data("slide"),g=d>c.$slides.filter(".is-active").data("slide"),h=c.$slides.eq(d);c.changeSlide(g,h,d)});this.$wrapper.add(this.$bullets).on("keydown.zf.orbit",function(d){Foundation.Keyboard.handleKey(d,"Orbit",{next:function(){c.changeSlide(!0)},
previous:function(){c.changeSlide(!1)},handled:function(){b(d.target).is(c.$bullets)&&c.$bullets.filter(".is-active").focus()}})})}}},{key:"changeSlide",value:function(b,c,d){var h=this.$slides.filter(".is-active").eq(0);if(/mui/g.test(h[0].className))return!1;var j=this.$slides.first(),k=this.$slides.last(),l=b?"Right":"Left",m=b?"Left":"Right",n=this,q;q=c?c:b?this.options.infiniteWrap?h.next("."+this.options.slideClass).length?h.next("."+this.options.slideClass):j:h.next("."+this.options.slideClass):
this.options.infiniteWrap?h.prev("."+this.options.slideClass).length?h.prev("."+this.options.slideClass):k:h.prev("."+this.options.slideClass);q.length&&(this.options.bullets&&(d=d||this.$slides.index(q),this._updateBullets(d)),this.options.useMUI?(Foundation.Motion.animateIn(q.addClass("is-active").css({position:"absolute",top:0}),this.options["animInFrom"+l],function(){q.css({position:"relative",display:"block"}).attr("aria-live","polite")}),Foundation.Motion.animateOut(h.removeClass("is-active"),
this.options["animOutTo"+m],function(){h.removeAttr("aria-live");n.options.autoPlay&&!n.timer.isPaused&&n.timer.restart()})):(h.removeClass("is-active is-in").removeAttr("aria-live").hide(),q.addClass("is-active is-in").attr("aria-live","polite").show(),this.options.autoPlay&&!this.timer.isPaused&&this.timer.restart()),this.$element.trigger("slidechange.zf.orbit",[q]))}},{key:"_updateBullets",value:function(b){var c=this.$element.find("."+this.options.boxOfBullets).find(".is-active").removeClass("is-active").blur().find("span:last").detach();
this.$bullets.eq(b).addClass("is-active").append(c)}},{key:"destroy",value:function(){this.$element.off(".zf.orbit").find("*").off(".zf.orbit").end().hide();Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={bullets:!0,navButtons:!0,animInFromRight:"slide-in-right",animOutToRight:"slide-out-right",animInFromLeft:"slide-in-left",animOutToLeft:"slide-out-left",autoPlay:!0,timerDelay:5E3,infiniteWrap:!0,swipe:!0,pauseOnHover:!0,accessible:!0,containerClass:"orbit-container",slideClass:"orbit-slide",
boxOfBullets:"orbit-bullets",nextClass:"orbit-next",prevClass:"orbit-previous",useMUI:!0};Foundation.plugin(c,"Orbit")}(jQuery);"use strict";_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();
function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(d){_classCallCheck(this,c);this.$element=b(d);this.rules=this.$element.data("responsive-menu");this.currentPlugin=this.currentMq=null;this._init();this._events();Foundation.registerPlugin(this,"ResponsiveMenu")}_createClass(c,[{key:"_init",value:function(){if("string"===typeof this.rules){for(var c={},e=this.rules.split(" "),h=0;h<e.length;h++){var j=e[h].split("-"),k=1<j.length?j[0]:"small",j=1<j.length?j[1]:j[0];null!==d[j]&&(c[k]=d[j])}this.rules=c}b.isEmptyObject(this.rules)||
this._checkMediaQueries()}},{key:"_events",value:function(){var c=this;b(window).on("changed.zf.mediaquery",function(){c._checkMediaQueries()})}},{key:"_checkMediaQueries",value:function(){var c,e=this;b.each(this.rules,function(b){Foundation.MediaQuery.atLeast(b)&&(c=b)});c&&!(this.currentPlugin instanceof this.rules[c].plugin)&&(b.each(d,function(b,c){e.$element.removeClass(c.cssClass)}),this.$element.addClass(this.rules[c].cssClass),this.currentPlugin&&this.currentPlugin.destroy(),this.currentPlugin=
new this.rules[c].plugin(this.$element,{}))}},{key:"destroy",value:function(){this.currentPlugin.destroy();b(window).off(".zf.ResponsiveMenu");Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={};var d={dropdown:{cssClass:"dropdown",plugin:Foundation._plugins["dropdown-menu"]||null},drilldown:{cssClass:"drilldown",plugin:Foundation._plugins.drilldown||null},accordion:{cssClass:"accordion-menu",plugin:Foundation._plugins["accordion-menu"]||null}};Foundation.plugin(c,"ResponsiveMenu")}(jQuery);
"use strict";_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=b(e);this.options=b.extend({},c.defaults,this.$element.data(),f);this._init();this._events();Foundation.registerPlugin(this,"ResponsiveToggle")}_createClass(c,[{key:"_init",value:function(){var c=this.$element.data("responsive-toggle");c||console.error("Your tab bar needs an ID of a Menu as the value of data-tab-bar.");this.$targetMenu=b("#"+c);this.$toggler=this.$element.find("[data-toggle]");this._update()}},{key:"_events",
value:function(){this._updateMqHandler=this._update.bind(this);b(window).on("changed.zf.mediaquery",this._updateMqHandler);this.$toggler.on("click.zf.responsiveToggle",this.toggleMenu.bind(this))}},{key:"_update",value:function(){Foundation.MediaQuery.atLeast(this.options.hideFor)?(this.$element.hide(),this.$targetMenu.show()):(this.$element.show(),this.$targetMenu.hide())}},{key:"toggleMenu",value:function(){Foundation.MediaQuery.atLeast(this.options.hideFor)||(this.$targetMenu.toggle(0),this.$element.trigger("toggled.zf.responsiveToggle"))}},
{key:"destroy",value:function(){this.$element.off(".zf.responsiveToggle");this.$toggler.off(".zf.responsiveToggle");b(window).off("changed.zf.mediaquery",this._updateMqHandler);Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={hideFor:"medium"};Foundation.plugin(c,"ResponsiveToggle")}(jQuery);"use strict";
_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this._init();Foundation.registerPlugin(this,"Reveal");Foundation.Keyboard.register("Reveal",{ENTER:"open",SPACE:"open",ESCAPE:"close",TAB:"tab_forward",SHIFT_TAB:"tab_backward"})}_createClass(c,[{key:"_init",value:function(){this.id=this.$element.attr("id");this.isActive=!1;this.cached={mq:Foundation.MediaQuery.current};this.isMobile=/iP(ad|hone|od).*OS/.test(window.navigator.userAgent)||
/Android/.test(window.navigator.userAgent);this.$anchor=b('[data-open="'+this.id+'"]').length?b('[data-open="'+this.id+'"]'):b('[data-toggle="'+this.id+'"]');this.$anchor.attr({"aria-controls":this.id,"aria-haspopup":!0,tabindex:0});if(this.options.fullScreen||this.$element.hasClass("full"))this.options.fullScreen=!0,this.options.overlay=!1;this.options.overlay&&!this.$overlay&&(this.$overlay=this._makeOverlay(this.id));this.$element.attr({role:"dialog","aria-hidden":!0,"data-yeti-box":this.id,"data-resize":this.id});
this.$overlay?this.$element.detach().appendTo(this.$overlay):(this.$element.detach().appendTo(b("body")),this.$element.addClass("without-overlay"));this._events();if(this.options.deepLink&&window.location.hash==="#"+this.id)b(window).one("load.zf.reveal",this.open.bind(this))}},{key:"_makeOverlay",value:function(){return b("<div></div>").addClass("reveal-overlay").appendTo("body")}},{key:"_updatePosition",value:function(){var c=this.$element.outerWidth(),d=b(window).width(),g=this.$element.outerHeight(),
h=b(window).height(),c="auto"===this.options.hOffset?parseInt((d-c)/2,10):parseInt(this.options.hOffset,10);this.$element.css({top:("auto"===this.options.vOffset?g>h?parseInt(Math.min(100,h/10),10):parseInt((h-g)/4,10):parseInt(this.options.vOffset,10))+"px"});if(!this.$overlay||"auto"!==this.options.hOffset)this.$element.css({left:c+"px"}),this.$element.css({margin:"0px"})}},{key:"_events",value:function(){var c=this,d=this;this.$element.on({"open.zf.trigger":this.open.bind(this),"close.zf.trigger":function(g,
h){if(g.target===d.$element[0]||b(g.target).parents("[data-closable]")[0]===h)return c.close.apply(c)},"toggle.zf.trigger":this.toggle.bind(this),"resizeme.zf.trigger":function(){d._updatePosition()}});if(this.$anchor.length)this.$anchor.on("keydown.zf.reveal",function(b){if(13===b.which||32===b.which)b.stopPropagation(),b.preventDefault(),d.open()});if(this.options.closeOnClick&&this.options.overlay)this.$overlay.off(".zf.reveal").on("click.zf.reveal",function(c){c.target===d.$element[0]||b.contains(d.$element[0],
c.target)||d.close()});if(this.options.deepLink)b(window).on("popstate.zf.reveal:"+this.id,this._handleState.bind(this))}},{key:"_handleState",value:function(){window.location.hash==="#"+this.id&&!this.isActive?this.open():this.close()}},{key:"open",value:function(){var c=this;if(this.options.deepLink){var d="#"+this.id;window.history.pushState?window.history.pushState(null,null,d):window.location.hash=d}this.isActive=!0;this.$element.css({visibility:"hidden"}).show().scrollTop(0);this.options.overlay&&
this.$overlay.css({visibility:"hidden"}).show();this._updatePosition();this.$element.hide().css({visibility:""});this.$overlay&&(this.$overlay.css({visibility:""}).hide(),this.$element.hasClass("fast")?this.$overlay.addClass("fast"):this.$element.hasClass("slow")&&this.$overlay.addClass("slow"));this.options.multipleOpened||this.$element.trigger("closeme.zf.reveal",this.id);this.options.animationIn?function(){c.options.overlay&&Foundation.Motion.animateIn(c.$overlay,"fade-in");Foundation.Motion.animateIn(c.$element,
c.options.animationIn,function(){c.focusableElements=Foundation.Keyboard.findFocusable(c.$element);c.$element.attr({"aria-hidden":false,tabindex:-1}).focus();console.log("focus")})}():(this.options.overlay&&this.$overlay.show(0),this.$element.show(this.options.showDelay));this.$element.attr({"aria-hidden":!1,tabindex:-1}).focus();this.$element.trigger("open.zf.reveal");this.isMobile?(this.originalScrollPos=window.pageYOffset,b("html, body").addClass("is-reveal-open")):b("body").addClass("is-reveal-open");
setTimeout(function(){c._extraHandlers()},0)}},{key:"_extraHandlers",value:function(){var c=this;this.focusableElements=Foundation.Keyboard.findFocusable(this.$element);if(!this.options.overlay&&this.options.closeOnClick&&!this.options.fullScreen)b("body").on("click.zf.reveal",function(d){d.target===c.$element[0]||b.contains(c.$element[0],d.target)||c.close()});if(this.options.closeOnEsc)b(window).on("keydown.zf.reveal",function(b){Foundation.Keyboard.handleKey(b,"Reveal",{close:function(){c.options.closeOnEsc&&
(c.close(),c.$anchor.focus())}})});this.$element.on("keydown.zf.reveal",function(d){var g=b(this);Foundation.Keyboard.handleKey(d,"Reveal",{tab_forward:function(){if(c.$element.find(":focus").is(c.focusableElements.eq(-1)))return c.focusableElements.eq(0).focus(),!0;if(0===c.focusableElements.length)return!0},tab_backward:function(){if(c.$element.find(":focus").is(c.focusableElements.eq(0))||c.$element.is(":focus"))return c.focusableElements.eq(-1).focus(),!0;if(0===c.focusableElements.length)return!0},
open:function(){c.$element.find(":focus").is(c.$element.find("[data-close]"))?setTimeout(function(){c.$anchor.focus()},1):g.is(c.focusableElements)&&c.open()},close:function(){c.options.closeOnEsc&&(c.close(),c.$anchor.focus())},handled:function(b){b&&d.preventDefault()}})})}},{key:"close",value:function(){function c(){d.isMobile?(b("html, body").removeClass("is-reveal-open"),d.originalScrollPos&&(b("body").scrollTop(d.originalScrollPos),d.originalScrollPos=null)):b("body").removeClass("is-reveal-open");
d.$element.attr("aria-hidden",!0);d.$element.trigger("closed.zf.reveal")}if(!this.isActive||!this.$element.is(":visible"))return!1;var d=this;this.options.animationOut?(this.options.overlay?Foundation.Motion.animateOut(this.$overlay,"fade-out",c):c(),Foundation.Motion.animateOut(this.$element,this.options.animationOut)):(this.options.overlay?this.$overlay.hide(0,c):c(),this.$element.hide(this.options.hideDelay));this.options.closeOnEsc&&b(window).off("keydown.zf.reveal");!this.options.overlay&&this.options.closeOnClick&&
b("body").off("click.zf.reveal");this.$element.off("keydown.zf.reveal");this.options.resetOnClose&&this.$element.html(this.$element.html());this.isActive=!1;d.options.deepLink&&(window.history.replaceState?window.history.replaceState("",document.title,window.location.pathname):window.location.hash="")}},{key:"toggle",value:function(){this.isActive?this.close():this.open()}},{key:"destroy",value:function(){this.options.overlay&&(this.$element.appendTo(b("body")),this.$overlay.hide().off().remove());
this.$element.hide().off();this.$anchor.off(".zf");b(window).off(".zf.reveal:"+this.id);Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={animationIn:"",animationOut:"",showDelay:0,hideDelay:0,closeOnClick:!0,closeOnEsc:!0,multipleOpened:!1,vOffset:"auto",hOffset:"auto",fullScreen:!1,btmOffsetPct:10,overlay:!0,resetOnClose:!1,deepLink:!1};Foundation.plugin(c,"Reveal")}(jQuery);"use strict";
_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this._init();Foundation.registerPlugin(this,"Slider");Foundation.Keyboard.register("Slider",{ltr:{ARROW_RIGHT:"increase",ARROW_UP:"increase",ARROW_DOWN:"decrease",ARROW_LEFT:"decrease",SHIFT_ARROW_RIGHT:"increase_fast",SHIFT_ARROW_UP:"increase_fast",SHIFT_ARROW_DOWN:"decrease_fast",SHIFT_ARROW_LEFT:"decrease_fast"},rtl:{ARROW_LEFT:"increase",ARROW_RIGHT:"decrease",
SHIFT_ARROW_LEFT:"increase_fast",SHIFT_ARROW_RIGHT:"decrease_fast"}})}_createClass(c,[{key:"_init",value:function(){this.inputs=this.$element.find("input");this.handles=this.$element.find("[data-slider-handle]");this.$handle=this.handles.eq(0);this.$input=this.inputs.length?this.inputs.eq(0):b("#"+this.$handle.attr("aria-controls"));this.$fill=this.$element.find("[data-slider-fill]").css(this.options.vertical?"height":"width",0);var c=!1,d=this;if(this.options.disabled||this.$element.hasClass(this.options.disabledClass))this.options.disabled=
!0,this.$element.addClass(this.options.disabledClass);this.inputs.length||(this.inputs=b().add(this.$input),this.options.binding=!0);this._setInitAttr(0);this._events(this.$handle);this.handles[1]&&(this.options.doubleSided=!0,this.$handle2=this.handles.eq(1),this.$input2=1<this.inputs.length?this.inputs.eq(1):b("#"+this.$handle2.attr("aria-controls")),this.inputs[1]||(this.inputs=this.inputs.add(this.$input2)),c=!0,this._setHandlePos(this.$handle,this.options.initialStart,!0,function(){d._setHandlePos(d.$handle2,
d.options.initialEnd,true)}),this._setInitAttr(1),this._events(this.$handle2));c||this._setHandlePos(this.$handle,this.options.initialStart,!0)}},{key:"_setHandlePos",value:function(b,c,d,h){if(!this.$element.hasClass(this.options.disabledClass)){c=parseFloat(c);c<this.options.start?c=this.options.start:c>this.options.end&&(c=this.options.end);var j=this.options.doubleSided;if(j)if(0===this.handles.index(b))var k=parseFloat(this.$handle2.attr("aria-valuenow")),c=c>=k?k-this.options.step:c;else k=
parseFloat(this.$handle.attr("aria-valuenow")),c=c<=k?k+this.options.step:c;this.options.vertical&&!d&&(c=this.options.end-c);var l=this,m=(d=this.options.vertical)?"height":"width",n=d?"top":"left",d=b[0].getBoundingClientRect()[m],k=this.$element[0].getBoundingClientRect()[m],q=((c-this.options.start)/(this.options.end-this.options.start)).toFixed(2),p=(100*((k-d)*q/k)).toFixed(this.options.decimal),c=parseFloat(c.toFixed(this.options.decimal)),s={};this._setValues(b,c);j&&(c=0===this.handles.index(b),
j=~~(100*(d/k)),c?(s[n]=p+"%",c=parseFloat(this.$handle2[0].style[n])-p+j,h&&"function"===typeof h&&h()):(h=parseFloat(this.$handle[0].style[n]),c=p-(isNaN(h)?this.options.initialStart/((this.options.end-this.options.start)/100):h)+j),s["min-"+m]=c+"%");this.$element.one("finished.zf.animate",function(){l.$element.trigger("moved.zf.slider",[b])});h=this.$element.data("dragging")?1E3/60:this.options.moveTime;Foundation.Move(h,b,function(){b.css(n,p+"%");l.options.doubleSided?l.$fill.css(s):l.$fill.css(m,
q*100+"%")});clearTimeout(l.timeout);l.timeout=setTimeout(function(){l.$element.trigger("changed.zf.slider",[b])},l.options.changedDelay)}}},{key:"_setInitAttr",value:function(b){var c=this.inputs.eq(b).attr("id")||Foundation.GetYoDigits(6,"slider");this.inputs.eq(b).attr({id:c,max:this.options.end,min:this.options.start,step:this.options.step});this.handles.eq(b).attr({role:"slider","aria-controls":c,"aria-valuemax":this.options.end,"aria-valuemin":this.options.start,"aria-valuenow":0===b?this.options.initialStart:
this.options.initialEnd,"aria-orientation":this.options.vertical?"vertical":"horizontal",tabindex:0})}},{key:"_setValues",value:function(b,c){this.inputs.eq(this.options.doubleSided?this.handles.index(b):0).val(c);b.attr("aria-valuenow",c)}},{key:"_handleEvent",value:function(c,d,g){var h;if(g)h=this._adjustValue(null,g),c=!0;else{c.preventDefault();var j=this.options.vertical,g=j?"height":"width",k=j?"top":"left",l=j?c.pageY:c.pageX;this.$handle[0].getBoundingClientRect();h=this.$element[0].getBoundingClientRect()[g];
var j=j?b(window).scrollTop():b(window).scrollLeft(),m=this.$element.offset()[k];c.clientY===c.pageY&&(l+=j);c=l-m;l=0>c?0:c>h?h:c;offsetPct=l/h;h=(this.options.end-this.options.start)*offsetPct+this.options.start;Foundation.rtl()&&!this.options.vertical&&(h=this.options.end-h);h=this._adjustValue(null,h);c=!1;d||(d=Math.abs(this.$handle.position()[k]+this.$handle[g]()/2-l),g=Math.abs(this.$handle2.position()[k]+this.$handle2[g]()/2-l),d=d<=g?this.$handle:this.$handle2)}this._setHandlePos(d,h,c)}},
{key:"_adjustValue",value:function(b,c){var d,h=this.options.step,j=parseFloat(h/2),k,l;d=b?parseFloat(b.attr("aria-valuenow")):c;k=d%h;l=d-k;return 0===k?d:d>=l+j?l+h:l}},{key:"_events",value:function(c){var d=this,g;this.inputs.off("change.zf.slider").on("change.zf.slider",function(c){var e=d.inputs.index(b(this));d._handleEvent(c,d.handles.eq(e),b(this).val())});if(this.options.clickSelect)this.$element.off("click.zf.slider").on("click.zf.slider",function(c){if(d.$element.data("dragging"))return!1;
b(c.target).is("[data-slider-handle]")||(d.options.doubleSided?d._handleEvent(c):d._handleEvent(c,d.$handle))});if(this.options.draggable){this.handles.addTouch();var h=b("body");c.off("mousedown.zf.slider").on("mousedown.zf.slider",function(j){c.addClass("is-dragging");d.$fill.addClass("is-dragging");d.$element.data("dragging",!0);g=b(j.currentTarget);h.on("mousemove.zf.slider",function(b){b.preventDefault();d._handleEvent(b,g)}).on("mouseup.zf.slider",function(b){d._handleEvent(b,g);c.removeClass("is-dragging");
d.$fill.removeClass("is-dragging");d.$element.data("dragging",!1);h.off("mousemove.zf.slider mouseup.zf.slider")})}).on("selectstart.zf.slider touchmove.zf.slider",function(b){b.preventDefault()})}c.off("keydown.zf.slider").on("keydown.zf.slider",function(c){var e=b(this),g=d.options.doubleSided?d.handles.index(e):0,h=parseFloat(d.inputs.eq(g).val()),n;Foundation.Keyboard.handleKey(c,"Slider",{decrease:function(){n=h-d.options.step},increase:function(){n=h+d.options.step},decrease_fast:function(){n=
h-10*d.options.step},increase_fast:function(){n=h+10*d.options.step},handled:function(){c.preventDefault();d._setHandlePos(e,n,!0)}})})}},{key:"destroy",value:function(){this.handles.off(".zf.slider");this.inputs.off(".zf.slider");this.$element.off(".zf.slider");Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={start:0,end:100,step:1,initialStart:0,initialEnd:100,binding:!1,clickSelect:!0,vertical:!1,draggable:!0,disabled:!1,doubleSided:!1,decimal:2,moveTime:200,disabledClass:"disabled",
invertVertical:!1,changedDelay:500};Foundation.plugin(c,"Slider")}(jQuery);"use strict";_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this._init();Foundation.registerPlugin(this,"Sticky")}_createClass(c,[{key:"_init",value:function(){var c=this.$element.parent("[data-sticky-container]"),d=this.$element[0].id||Foundation.GetYoDigits(6,"sticky"),g=this;c.length||(this.wasWrapped=!0);this.$container=c.length?c:b(this.options.container).wrapInner(this.$element);this.$container.addClass(this.options.containerClass);
this.$element.addClass(this.options.stickyClass).attr({"data-resize":d});this.scrollCount=this.options.checkEvery;this.isStuck=!1;b(window).one("load.zf.sticky",function(){g.options.anchor!==""?g.$anchor=b("#"+g.options.anchor):g._parsePoints();g._setSizes(function(){g._calc(false)});g._events(d.split("-").reverse().join("-"))})}},{key:"_parsePoints",value:function(){for(var c=[""==this.options.topAnchor?1:this.options.topAnchor,""==this.options.btmAnchor?document.documentElement.scrollHeight:this.options.btmAnchor],
d={},g=0,h=c.length;g<h&&c[g];g++){var j;if("number"===typeof c[g])j=c[g];else{var k=c[g].split(":"),l=b("#"+k[0]);j=l.offset().top;k[1]&&"bottom"===k[1].toLowerCase()&&(j+=l[0].getBoundingClientRect().height)}d[g]=j}this.points=d}},{key:"_events",value:function(c){var d=this,g=this.scrollListener="scroll.zf."+c;this.isOn||(this.canStick&&(this.isOn=!0,b(window).off(g).on(g,function(){0===d.scrollCount?(d.scrollCount=d.options.checkEvery,d._setSizes(function(){d._calc(!1,window.pageYOffset)})):(d.scrollCount--,
d._calc(!1,window.pageYOffset))})),this.$element.off("resizeme.zf.trigger").on("resizeme.zf.trigger",function(){d._setSizes(function(){d._calc(false);d.canStick?d.isOn||d._events(c):d.isOn&&d._pauseListeners(g)})}))}},{key:"_pauseListeners",value:function(c){this.isOn=!1;b(window).off(c);this.$element.trigger("pause.zf.sticky")}},{key:"_calc",value:function(b,c){b&&this._setSizes();if(!this.canStick)return this.isStuck&&this._removeSticky(!0),!1;c||(c=window.pageYOffset);c>=this.topPoint?c<=this.bottomPoint?
this.isStuck||this._setSticky():this.isStuck&&this._removeSticky(!1):this.isStuck&&this._removeSticky(!0)}},{key:"_setSticky",value:function(){var b=this,c=this.options.stickTo,d="top"===c?"marginTop":"marginBottom",h="top"===c?"bottom":"top",j={};j[d]=this.options[d]+"em";j[c]=0;j[h]="auto";j.left=this.$container.offset().left+parseInt(window.getComputedStyle(this.$container[0])["padding-left"],10);this.isStuck=!0;this.$element.removeClass("is-anchored is-at-"+h).addClass("is-stuck is-at-"+c).css(j).trigger("sticky.zf.stuckto:"+
c);this.$element.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){b._setSizes()})}},{key:"_removeSticky",value:function(b){var c=this.options.stickTo,d={},h=(this.points?this.points[1]-this.points[0]:this.anchorHeight)-this.elemHeight,j=b?"top":"bottom";d["top"===c?"marginTop":"marginBottom"]=0;d.bottom="auto";d.top=b?0:h;d.left="";this.isStuck=!1;this.$element.removeClass("is-stuck is-at-"+c).addClass("is-anchored is-at-"+j).css(d).trigger("sticky.zf.unstuckfrom:"+
j)}},{key:"_setSizes",value:function(b){(this.canStick=Foundation.MediaQuery.atLeast(this.options.stickyOn))||b();var c=this.$container[0].getBoundingClientRect().width,d=window.getComputedStyle(this.$container[0]),h=parseInt(d["padding-right"],10);this.$anchor&&this.$anchor.length?this.anchorHeight=this.$anchor[0].getBoundingClientRect().height:this._parsePoints();this.$element.css({"max-width":c-h+"px"});c=this.$element[0].getBoundingClientRect().height||this.containerHeight;"none"==this.$element.css("display")&&
(c=0);this.containerHeight=c;this.$container.css({height:c});this.elemHeight=c;this.isStuck&&this.$element.css({left:this.$container.offset().left+parseInt(d["padding-left"],10)});this._setBreakPoints(c,function(){b&&b()})}},{key:"_setBreakPoints",value:function(b,c){if(!this.canStick)if(c)c();else return!1;var d=parseInt(window.getComputedStyle(document.body,null).fontSize,10)*this.options.marginTop,h=parseInt(window.getComputedStyle(document.body,null).fontSize,10)*this.options.marginBottom,j=this.points?
this.points[0]:this.$anchor.offset().top,k=this.points?this.points[1]:j+this.anchorHeight,l=window.innerHeight;"top"===this.options.stickTo?(j-=d,k-=b+d):"bottom"===this.options.stickTo&&(j-=l-(b+h),k-=l-h);this.topPoint=j;this.bottomPoint=k;c&&c()}},{key:"destroy",value:function(){this._removeSticky(!0);this.$element.removeClass(this.options.stickyClass+" is-anchored is-at-top").css({height:"",top:"",bottom:"","max-width":""}).off("resizeme.zf.trigger");this.$anchor&&this.$anchor.length&&this.$anchor.off("change.zf.sticky");
b(window).off(this.scrollListener);this.wasWrapped?this.$element.unwrap():this.$container.removeClass(this.options.containerClass).css({height:""});Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={container:"<div data-sticky-container></div>",stickTo:"top",anchor:"",topAnchor:"",btmAnchor:"",marginTop:1,marginBottom:1,stickyOn:"medium",stickyClass:"sticky",containerClass:"sticky-container",checkEvery:-1};Foundation.plugin(c,"Sticky")}(jQuery);"use strict";
_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this._init();Foundation.registerPlugin(this,"Tabs");Foundation.Keyboard.register("Tabs",{ENTER:"open",SPACE:"open",ARROW_RIGHT:"next",ARROW_UP:"previous",ARROW_DOWN:"next",ARROW_LEFT:"previous"})}_createClass(c,[{key:"_init",value:function(){var c=this;this.$tabTitles=this.$element.find("."+this.options.linkClass);this.$tabContent=b('[data-tabs-content="'+
this.$element[0].id+'"]');this.$tabTitles.each(function(){var d=b(this),f=d.find("a"),j=d.hasClass("is-active"),k=f[0].hash.slice(1),l=f[0].id?f[0].id:k+"-label",m=b("#"+k);d.attr({role:"presentation"});f.attr({role:"tab","aria-controls":k,"aria-selected":j,id:l});m.attr({role:"tabpanel","aria-hidden":!j,"aria-labelledby":l});j&&c.options.autoFocus&&f.focus()});if(this.options.matchHeight){var d=this.$tabContent.find("img");if(d.length)Foundation.onImagesLoaded(d,this._setHeight.bind(this));else this._setHeight()}this._events()}},
{key:"_events",value:function(){this._addKeyHandler();this._addClickHandler();this._setHeightMqHandler=null;this.options.matchHeight&&(this._setHeightMqHandler=this._setHeight.bind(this),b(window).on("changed.zf.mediaquery",this._setHeightMqHandler))}},{key:"_addClickHandler",value:function(){var c=this;this.$element.off("click.zf.tabs").on("click.zf.tabs","."+this.options.linkClass,function(d){d.preventDefault();d.stopPropagation();b(this).hasClass("is-active")||c._handleTabChange(b(this))})}},{key:"_addKeyHandler",
value:function(){var c=this;c.$element.find("li:first-of-type");c.$element.find("li:last-of-type");this.$tabTitles.off("keydown.zf.tabs").on("keydown.zf.tabs",function(d){if(9!==d.which){var g=b(this),h=g.parent("ul").children("li"),j,k;h.each(function(d){b(this).is(g)&&(c.options.wrapOnKeys?(j=0===d?h.last():h.eq(d-1),k=d===h.length-1?h.first():h.eq(d+1)):(j=h.eq(Math.max(0,d-1)),k=h.eq(Math.min(d+1,h.length-1))))});Foundation.Keyboard.handleKey(d,"Tabs",{open:function(){g.find('[role="tab"]').focus();
c._handleTabChange(g)},previous:function(){j.find('[role="tab"]').focus();c._handleTabChange(j)},next:function(){k.find('[role="tab"]').focus();c._handleTabChange(k)},handled:function(){d.stopPropagation();d.preventDefault()}})}})}},{key:"_handleTabChange",value:function(c){var d=c.find('[role="tab"]'),g=this.$tabContent.find(d[0].hash),h=this.$element.find("."+this.options.linkClass+".is-active").removeClass("is-active").find('[role="tab"]').attr({"aria-selected":"false"});b("#"+h.attr("aria-controls")).removeClass("is-active").attr({"aria-hidden":"true"});
c.addClass("is-active");d.attr({"aria-selected":"true"});g.addClass("is-active").attr({"aria-hidden":"false"});this.$element.trigger("change.zf.tabs",[c])}},{key:"selectTab",value:function(b){b="object"===typeof b?b[0].id:b;0>b.indexOf("#")&&(b="#"+b);this._handleTabChange(this.$tabTitles.find('[href="'+b+'"]').parent("."+this.options.linkClass))}},{key:"_setHeight",value:function(){var c=0;this.$tabContent.find("."+this.options.panelClass).css("height","").each(function(){var d=b(this),g=d.hasClass("is-active");
g||d.css({visibility:"hidden",display:"block"});var h=this.getBoundingClientRect().height;g||d.css({visibility:"",display:""});c=h>c?h:c}).css("height",c+"px")}},{key:"destroy",value:function(){this.$element.find("."+this.options.linkClass).off(".zf.tabs").hide().end().find("."+this.options.panelClass).hide();this.options.matchHeight&&null!=this._setHeightMqHandler&&b(window).off("changed.zf.mediaquery",this._setHeightMqHandler);Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={autoFocus:!1,
wrapOnKeys:!0,matchHeight:!1,linkClass:"tabs-title",panelClass:"tabs-panel"};Foundation.plugin(c,"Tabs")}(jQuery);"use strict";_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,e.data(),f);this.className="";this._init();this._events();Foundation.registerPlugin(this,"Toggler")}_createClass(c,[{key:"_init",value:function(){var c;this.options.animate?(c=this.options.animate.split(" "),this.animationIn=c[0],this.animationOut=c[1]||null):(c=this.$element.data("toggler"),this.className="."===c[0]?c.slice(1):c);c=this.$element[0].id;b('[data-open="'+c+'"], [data-close="'+
c+'"], [data-toggle="'+c+'"]').attr("aria-controls",c);this.$element.attr("aria-expanded",this.$element.is(":hidden")?!1:!0)}},{key:"_events",value:function(){this.$element.off("toggle.zf.trigger").on("toggle.zf.trigger",this.toggle.bind(this))}},{key:"toggle",value:function(){this[this.options.animate?"_toggleAnimate":"_toggleClass"]()}},{key:"_toggleClass",value:function(){this.$element.toggleClass(this.className);var b=this.$element.hasClass(this.className);b?this.$element.trigger("on.zf.toggler"):
this.$element.trigger("off.zf.toggler");this._updateARIA(b)}},{key:"_toggleAnimate",value:function(){var b=this;this.$element.is(":hidden")?Foundation.Motion.animateIn(this.$element,this.animationIn,function(){b._updateARIA(!0);this.trigger("on.zf.toggler")}):Foundation.Motion.animateOut(this.$element,this.animationOut,function(){b._updateARIA(!1);this.trigger("off.zf.toggler")})}},{key:"_updateARIA",value:function(b){this.$element.attr("aria-expanded",b?!0:!1)}},{key:"destroy",value:function(){this.$element.off(".zf.toggler");
Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={animate:!1};Foundation.plugin(c,"Toggler")}(jQuery);"use strict";_createClass=function(){function b(b,d){for(var e=0;e<d.length;e++){var f=d[e];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(c,d,e){d&&b(c.prototype,d);e&&b(c,e);return c}}();function _classCallCheck(b,c){if(!(b instanceof c))throw new TypeError("Cannot call a class as a function");}
!function(b){var c=function(){function c(e,f){_classCallCheck(this,c);this.$element=e;this.options=b.extend({},c.defaults,this.$element.data(),f);this.isClick=this.isActive=!1;this._init();Foundation.registerPlugin(this,"Tooltip")}_createClass(c,[{key:"_init",value:function(){var c=this.$element.attr("aria-describedby")||Foundation.GetYoDigits(6,"tooltip");this.options.positionClass=this.options.positionClass||this._getPositionClass(this.$element);this.options.tipText=this.options.tipText||this.$element.attr("title");
this.template=this.options.template?b(this.options.template):this._buildTemplate(c);this.template.appendTo(document.body).text(this.options.tipText).hide();this.$element.attr({title:"","aria-describedby":c,"data-yeti-box":c,"data-toggle":c,"data-resize":c}).addClass(this.triggerClass);this.usedPositions=[];this.counter=4;this.classChanged=!1;this._events()}},{key:"_getPositionClass",value:function(b){return!b?"":b=(b=b[0].className.match(/\b(top|left|right)\b/g))?b[0]:""}},{key:"_buildTemplate",value:function(c){var d=
(this.options.tooltipClass+" "+this.options.positionClass+" "+this.options.templateClasses).trim();return b("<div></div>").addClass(d).attr({role:"tooltip","aria-hidden":!0,"data-is-active":!1,"data-is-focus":!1,id:c})}},{key:"_reposition",value:function(b){this.usedPositions.push(b?b:"bottom");!b&&0>this.usedPositions.indexOf("top")?this.template.addClass("top"):"top"===b&&0>this.usedPositions.indexOf("bottom")?this.template.removeClass(b):"left"===b&&0>this.usedPositions.indexOf("right")?this.template.removeClass(b).addClass("right"):
"right"===b&&0>this.usedPositions.indexOf("left")?this.template.removeClass(b).addClass("left"):!b&&-1<this.usedPositions.indexOf("top")&&0>this.usedPositions.indexOf("left")?this.template.addClass("left"):"top"===b&&-1<this.usedPositions.indexOf("bottom")&&0>this.usedPositions.indexOf("left")?this.template.removeClass(b).addClass("left"):("left"===b&&-1<this.usedPositions.indexOf("right")&&0>this.usedPositions.indexOf("bottom")||"right"===b&&-1<this.usedPositions.indexOf("left")&&this.usedPositions.indexOf("bottom"),
this.template.removeClass(b));this.classChanged=!0;this.counter--}},{key:"_setPosition",value:function(){var b=this._getPositionClass(this.template),c=Foundation.Box.GetDimensions(this.template),d=Foundation.Box.GetDimensions(this.$element);if(c.width>=c.windowDims.width||!this.counter&&!Foundation.Box.ImNotTouchingYou(this.template))return this.template.offset(Foundation.Box.GetOffsets(this.template,this.$element,"center bottom",this.options.vOffset,this.options.hOffset,!0)).css({width:d.windowDims.width-
2*this.options.hOffset,height:"auto"}),!1;for(this.template.offset(Foundation.Box.GetOffsets(this.template,this.$element,"center "+(b||"bottom"),this.options.vOffset,this.options.hOffset));!Foundation.Box.ImNotTouchingYou(this.template)&&this.counter;)this._reposition(b),this._setPosition()}},{key:"show",value:function(){if("all"!==this.options.showOn&&!Foundation.MediaQuery.atLeast(this.options.showOn))return!1;this.template.css("visibility","hidden").show();this._setPosition();this.$element.trigger("closeme.zf.tooltip",
this.template.attr("id"));this.template.attr({"data-is-active":!0,"aria-hidden":!1});this.isActive=!0;this.template.stop().hide().css("visibility","").fadeIn(this.options.fadeInDuration,function(){});this.$element.trigger("show.zf.tooltip")}},{key:"hide",value:function(){var b=this;this.template.stop().attr({"aria-hidden":!0,"data-is-active":!1}).fadeOut(this.options.fadeOutDuration,function(){b.isActive=!1;b.isClick=!1;b.classChanged&&(b.template.removeClass(b._getPositionClass(b.template)).addClass(b.options.positionClass),
b.usedPositions=[],b.counter=4,b.classChanged=!1)});this.$element.trigger("hide.zf.tooltip")}},{key:"_events",value:function(){var b=this,c=!1;if(!this.options.disableHover)this.$element.on("mouseenter.zf.tooltip",function(){b.isActive||(b.timeout=setTimeout(function(){b.show()},b.options.hoverDelay))}).on("mouseleave.zf.tooltip",function(){clearTimeout(b.timeout);(!c||b.isClick&&!b.options.clickOpen)&&b.hide()});if(this.options.clickOpen)this.$element.on("mousedown.zf.tooltip",function(c){c.stopImmediatePropagation();
b.isClick||(b.isClick=!0,(b.options.disableHover||!b.$element.attr("tabindex"))&&!b.isActive&&b.show())});else this.$element.on("mousedown.zf.tooltip",function(c){c.stopImmediatePropagation();b.isClick=!0});if(!this.options.disableForTouch)this.$element.on("tap.zf.tooltip touchend.zf.tooltip",function(){b.isActive?b.hide():b.show()});this.$element.on({"close.zf.trigger":this.hide.bind(this)});this.$element.on("focus.zf.tooltip",function(){c=!0;if(b.isClick)return b.options.clickOpen||(c=!1),!1;b.show()}).on("focusout.zf.tooltip",
function(){c=!1;b.isClick=!1;b.hide()}).on("resizeme.zf.trigger",function(){b.isActive&&b._setPosition()})}},{key:"toggle",value:function(){this.isActive?this.hide():this.show()}},{key:"destroy",value:function(){this.$element.attr("title",this.template.text()).off(".zf.trigger .zf.tootip").removeAttr("aria-describedby").removeAttr("data-yeti-box").removeAttr("data-toggle").removeAttr("data-resize");this.template.remove();Foundation.unregisterPlugin(this)}}]);return c}();c.defaults={disableForTouch:!1,
hoverDelay:200,fadeInDuration:150,fadeOutDuration:150,disableHover:!1,templateClasses:"",tooltipClass:"tooltip",triggerClass:"has-tip",showOn:"small",template:"",tipText:"",touchCloseText:"Tap to close.",clickOpen:!0,positionClass:"",vOffset:10,hOffset:12};Foundation.plugin(c,"Tooltip")}(jQuery);
var UIUtil={showDialog:function(b,c,d,e){$(".dialog-modal-bg").detach();var f=$('<div class="dialog-modal-bg"></div>');f.css("z-index","100000").css("opacity",0);d||f.click(function(){UIUtil.hideAllDialogs();c&&c()});b.after(f);b.removeClass("hidden").css("z-index","100001").css("opacity",0).css("top","100px");b.css("left",(window.innerWidth-b.outerWidth())/2);e||(d=$('<a class="button-close" href="#">X</a>'),b.append(d),b.find(".button-close").unbind().click(function(){_log("dialog","close");UIUtil.hideDialog(b,
c);return!1}));b.find("input[type=submit]").unbind().click(function(){_log("dialog","close by submit");var b=$(this);UIUtil.hideDialog($(this).parents("div.dialog-modal"),function(){$(b.parents("form")[0]).submit()});return false});b.css("top",-b.outerHeight());b.outerHeight();f.fadeTo(200,0.8);b.css({top:"100px"});b.fadeTo(500,1);$(window).bind("keyup",function(){if(!event.metaKey&&event.which==27){_log("dialog","close by escape");UIUtil.hideDialog(b)}})},hideAllDialogs:function(){$(window).unbind("keyup");
$(".dialog-modal").each(function(b,c){var c=$(c),d=c.next();d.hasClass("dialog-modal-bg")&&d.fadeTo(250,0,function(){d.detach()});c.outerHeight();c.css({top:"-99999px"});c.fadeTo(500,0)})},hideDialog:function(b,c){$(window).unbind("keyup");var d=b.next();d.hasClass("dialog-modal-bg")&&d.fadeTo(250,0,function(){d.detach()});b.css({top:"-99999px"});c&&c();b.fadeTo(200,0)}},g_timeoutId;
$(document).ready(function(){g_standalone||(g_timeoutId=window.setInterval(function(){if(IDE.isDirty&&IDE.autosave&&IDE.currentProjectId){var b=Runtime.stage.captureScreenshot();IDE._doProjectSave(null,null,b,!1,!0,null)}else sendKeepAlive("");0<$(".messages").length&&Assignments.initMessaging()},3E5))});
function sendKeepAlive(b){$.ajax({type:"POST",url:"api/keepalive.aspx",data:b,success:function(b){"OK"!=b&&(window.clearInterval(g_timeoutId),$("body").append('<div id="timedout" class="idedialog"><span class="title">Oops</span><p>Sorry, your session has ended. Please login again from another tab to save.</p></div>'),$("#timedout").modal())}})}var Box2D={};
(function(b,c){function d(){}!(Object.prototype.defineProperty instanceof Function)&&(Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function)&&(Object.defineProperty=function(b,c,d){d.get instanceof Function&&b.__defineGetter__(c,d.get);d.set instanceof Function&&b.__defineSetter__(c,d.set)});b.inherit=function(b,c){d.prototype=c.prototype;b.prototype=new d;b.prototype.constructor=b};b.generateCallback=function(b,c){return function(){c.apply(b,
arguments)}};b.NVector=function(b){b===c&&(b=0);for(var d=Array(b||0),g=0;g<b;++g)d[g]=0;return d};b.is=function(b,d){return b===null?false:d instanceof Function&&b instanceof d||b.constructor.__implements!=c&&b.constructor.__implements[d]?true:false};b.parseUInt=function(b){return Math.abs(parseInt(b))}})(Box2D);var Vector=Array,Vector_a2j_Number=Box2D.NVector;"undefined"===typeof Box2D&&(Box2D={});"undefined"===typeof Box2D.Collision&&(Box2D.Collision={});
"undefined"===typeof Box2D.Collision.Shapes&&(Box2D.Collision.Shapes={});"undefined"===typeof Box2D.Common&&(Box2D.Common={});"undefined"===typeof Box2D.Common.Math&&(Box2D.Common.Math={});"undefined"===typeof Box2D.Dynamics&&(Box2D.Dynamics={});"undefined"===typeof Box2D.Dynamics.Contacts&&(Box2D.Dynamics.Contacts={});"undefined"===typeof Box2D.Dynamics.Controllers&&(Box2D.Dynamics.Controllers={});"undefined"===typeof Box2D.Dynamics.Joints&&(Box2D.Dynamics.Joints={});
(function(){function b(){b.b2AABB.apply(this,arguments)}function c(){c.b2Bound.apply(this,arguments)}function d(){d.b2BoundValues.apply(this,arguments);this.constructor===d&&this.b2BoundValues.apply(this,arguments)}function e(){e.b2Collision.apply(this,arguments)}function f(){f.b2ContactID.apply(this,arguments);this.constructor===f&&this.b2ContactID.apply(this,arguments)}function g(){g.b2ContactPoint.apply(this,arguments)}function h(){h.b2Distance.apply(this,arguments)}function j(){j.b2DistanceInput.apply(this,
arguments)}function k(){k.b2DistanceOutput.apply(this,arguments)}function l(){l.b2DistanceProxy.apply(this,arguments)}function m(){m.b2DynamicTree.apply(this,arguments);this.constructor===m&&this.b2DynamicTree.apply(this,arguments)}function n(){n.b2DynamicTreeBroadPhase.apply(this,arguments)}function q(){q.b2DynamicTreeNode.apply(this,arguments)}function p(){p.b2DynamicTreePair.apply(this,arguments)}function s(){s.b2Manifold.apply(this,arguments);this.constructor===s&&this.b2Manifold.apply(this,arguments)}
function r(){r.b2ManifoldPoint.apply(this,arguments);this.constructor===r&&this.b2ManifoldPoint.apply(this,arguments)}function o(){o.b2Point.apply(this,arguments)}function t(){t.b2RayCastInput.apply(this,arguments);this.constructor===t&&this.b2RayCastInput.apply(this,arguments)}function u(){u.b2RayCastOutput.apply(this,arguments)}function w(){w.b2Segment.apply(this,arguments)}function z(){z.b2SeparationFunction.apply(this,arguments)}function A(){A.b2Simplex.apply(this,arguments);this.constructor===
A&&this.b2Simplex.apply(this,arguments)}function C(){C.b2SimplexCache.apply(this,arguments)}function G(){G.b2SimplexVertex.apply(this,arguments)}function H(){H.b2TimeOfImpact.apply(this,arguments)}function K(){K.b2TOIInput.apply(this,arguments)}function P(){P.b2WorldManifold.apply(this,arguments);this.constructor===P&&this.b2WorldManifold.apply(this,arguments)}function T(){T.ClipVertex.apply(this,arguments)}function D(){D.Features.apply(this,arguments)}function F(){F.b2CircleShape.apply(this,arguments);
this.constructor===F&&this.b2CircleShape.apply(this,arguments)}function I(){I.b2EdgeChainDef.apply(this,arguments);this.constructor===I&&this.b2EdgeChainDef.apply(this,arguments)}function J(){J.b2EdgeShape.apply(this,arguments);this.constructor===J&&this.b2EdgeShape.apply(this,arguments)}function N(){N.b2MassData.apply(this,arguments)}function U(){U.b2PolygonShape.apply(this,arguments);this.constructor===U&&this.b2PolygonShape.apply(this,arguments)}function Q(){Q.b2Shape.apply(this,arguments);this.constructor===
Q&&this.b2Shape.apply(this,arguments)}function B(){B.b2Color.apply(this,arguments);this.constructor===B&&this.b2Color.apply(this,arguments)}function E(){E.b2Settings.apply(this,arguments)}function Z(){Z.b2Mat22.apply(this,arguments);this.constructor===Z&&this.b2Mat22.apply(this,arguments)}function O(){O.b2Mat33.apply(this,arguments);this.constructor===O&&this.b2Mat33.apply(this,arguments)}function M(){M.b2Math.apply(this,arguments)}function X(){X.b2Sweep.apply(this,arguments)}function aa(){aa.b2Transform.apply(this,
arguments);this.constructor===aa&&this.b2Transform.apply(this,arguments)}function Y(){Y.b2Vec2.apply(this,arguments);this.constructor===Y&&this.b2Vec2.apply(this,arguments)}function ba(){ba.b2Vec3.apply(this,arguments);this.constructor===ba&&this.b2Vec3.apply(this,arguments)}function da(){da.b2Body.apply(this,arguments);this.constructor===da&&this.b2Body.apply(this,arguments)}function ra(){ra.b2BodyDef.apply(this,arguments);this.constructor===ra&&this.b2BodyDef.apply(this,arguments)}function x(){x.b2ContactFilter.apply(this,
arguments)}function ja(){ja.b2ContactImpulse.apply(this,arguments)}function ka(){ka.b2ContactListener.apply(this,arguments)}function oa(){oa.b2ContactManager.apply(this,arguments);this.constructor===oa&&this.b2ContactManager.apply(this,arguments)}function pa(){pa.b2DebugDraw.apply(this,arguments);this.constructor===pa&&this.b2DebugDraw.apply(this,arguments)}function V(){V.b2DestructionListener.apply(this,arguments)}function va(){va.b2FilterData.apply(this,arguments)}function ta(){ta.b2Fixture.apply(this,
arguments);this.constructor===ta&&this.b2Fixture.apply(this,arguments)}function sa(){sa.b2FixtureDef.apply(this,arguments);this.constructor===sa&&this.b2FixtureDef.apply(this,arguments)}function Da(){Da.b2Island.apply(this,arguments);this.constructor===Da&&this.b2Island.apply(this,arguments)}function L(){L.b2TimeStep.apply(this,arguments)}function W(){W.b2World.apply(this,arguments);this.constructor===W&&this.b2World.apply(this,arguments)}function fa(){fa.b2CircleContact.apply(this,arguments)}function R(){R.b2Contact.apply(this,
arguments);this.constructor===R&&this.b2Contact.apply(this,arguments)}function v(){v.b2ContactConstraint.apply(this,arguments);this.constructor===v&&this.b2ContactConstraint.apply(this,arguments)}function Na(){Na.b2ContactConstraintPoint.apply(this,arguments)}function tb(){tb.b2ContactEdge.apply(this,arguments)}function kb(){kb.b2ContactFactory.apply(this,arguments);this.constructor===kb&&this.b2ContactFactory.apply(this,arguments)}function ea(){ea.b2ContactRegister.apply(this,arguments)}function ma(){ma.b2ContactResult.apply(this,
arguments)}function Ca(){Ca.b2ContactSolver.apply(this,arguments);this.constructor===Ca&&this.b2ContactSolver.apply(this,arguments)}function ub(){ub.b2EdgeAndCircleContact.apply(this,arguments)}function Va(){Va.b2NullContact.apply(this,arguments);this.constructor===Va&&this.b2NullContact.apply(this,arguments)}function nb(){nb.b2PolyAndCircleContact.apply(this,arguments)}function xb(){xb.b2PolyAndEdgeContact.apply(this,arguments)}function Fa(){Fa.b2PolygonContact.apply(this,arguments)}function Sa(){Sa.b2PositionSolverManifold.apply(this,
arguments);this.constructor===Sa&&this.b2PositionSolverManifold.apply(this,arguments)}function bb(){bb.b2BuoyancyController.apply(this,arguments)}function Ta(){Ta.b2ConstantAccelController.apply(this,arguments)}function Aa(){Aa.b2ConstantForceController.apply(this,arguments)}function xa(){xa.b2Controller.apply(this,arguments)}function Hb(){Hb.b2ControllerEdge.apply(this,arguments)}function Ia(){Ia.b2GravityController.apply(this,arguments)}function qb(){qb.b2TensorDampingController.apply(this,arguments)}
function Ma(){Ma.b2DistanceJoint.apply(this,arguments);this.constructor===Ma&&this.b2DistanceJoint.apply(this,arguments)}function cb(){cb.b2DistanceJointDef.apply(this,arguments);this.constructor===cb&&this.b2DistanceJointDef.apply(this,arguments)}function gb(){gb.b2FrictionJoint.apply(this,arguments);this.constructor===gb&&this.b2FrictionJoint.apply(this,arguments)}function Qa(){Qa.b2FrictionJointDef.apply(this,arguments);this.constructor===Qa&&this.b2FrictionJointDef.apply(this,arguments)}function qa(){qa.b2GearJoint.apply(this,
arguments);this.constructor===qa&&this.b2GearJoint.apply(this,arguments)}function za(){za.b2GearJointDef.apply(this,arguments);this.constructor===za&&this.b2GearJointDef.apply(this,arguments)}function ua(){ua.b2Jacobian.apply(this,arguments)}function hb(){hb.b2Joint.apply(this,arguments);this.constructor===hb&&this.b2Joint.apply(this,arguments)}function Ka(){Ka.b2JointDef.apply(this,arguments);this.constructor===Ka&&this.b2JointDef.apply(this,arguments)}function Pa(){Pa.b2JointEdge.apply(this,arguments)}
function yb(){yb.b2LineJoint.apply(this,arguments);this.constructor===yb&&this.b2LineJoint.apply(this,arguments)}function na(){na.b2LineJointDef.apply(this,arguments);this.constructor===na&&this.b2LineJointDef.apply(this,arguments)}function Fb(){Fb.b2MouseJoint.apply(this,arguments);this.constructor===Fb&&this.b2MouseJoint.apply(this,arguments)}function Ja(){Ja.b2MouseJointDef.apply(this,arguments);this.constructor===Ja&&this.b2MouseJointDef.apply(this,arguments)}function db(){db.b2PrismaticJoint.apply(this,
arguments);this.constructor===db&&this.b2PrismaticJoint.apply(this,arguments)}function Ib(){Ib.b2PrismaticJointDef.apply(this,arguments);this.constructor===Ib&&this.b2PrismaticJointDef.apply(this,arguments)}function Ab(){Ab.b2PulleyJoint.apply(this,arguments);this.constructor===Ab&&this.b2PulleyJoint.apply(this,arguments)}function vb(){vb.b2PulleyJointDef.apply(this,arguments);this.constructor===vb&&this.b2PulleyJointDef.apply(this,arguments)}function ob(){ob.b2RevoluteJoint.apply(this,arguments);
this.constructor===ob&&this.b2RevoluteJoint.apply(this,arguments)}function Ga(){Ga.b2RevoluteJointDef.apply(this,arguments);this.constructor===Ga&&this.b2RevoluteJointDef.apply(this,arguments)}function Ha(){Ha.b2WeldJoint.apply(this,arguments);this.constructor===Ha&&this.b2WeldJoint.apply(this,arguments)}function pb(){pb.b2WeldJointDef.apply(this,arguments);this.constructor===pb&&this.b2WeldJointDef.apply(this,arguments)}Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase";Box2D.Collision.b2AABB=
b;Box2D.Collision.b2Bound=c;Box2D.Collision.b2BoundValues=d;Box2D.Collision.b2Collision=e;Box2D.Collision.b2ContactID=f;Box2D.Collision.b2ContactPoint=g;Box2D.Collision.b2Distance=h;Box2D.Collision.b2DistanceInput=j;Box2D.Collision.b2DistanceOutput=k;Box2D.Collision.b2DistanceProxy=l;Box2D.Collision.b2DynamicTree=m;Box2D.Collision.b2DynamicTreeBroadPhase=n;Box2D.Collision.b2DynamicTreeNode=q;Box2D.Collision.b2DynamicTreePair=p;Box2D.Collision.b2Manifold=s;Box2D.Collision.b2ManifoldPoint=r;Box2D.Collision.b2Point=
o;Box2D.Collision.b2RayCastInput=t;Box2D.Collision.b2RayCastOutput=u;Box2D.Collision.b2Segment=w;Box2D.Collision.b2SeparationFunction=z;Box2D.Collision.b2Simplex=A;Box2D.Collision.b2SimplexCache=C;Box2D.Collision.b2SimplexVertex=G;Box2D.Collision.b2TimeOfImpact=H;Box2D.Collision.b2TOIInput=K;Box2D.Collision.b2WorldManifold=P;Box2D.Collision.ClipVertex=T;Box2D.Collision.Features=D;Box2D.Collision.Shapes.b2CircleShape=F;Box2D.Collision.Shapes.b2EdgeChainDef=I;Box2D.Collision.Shapes.b2EdgeShape=J;Box2D.Collision.Shapes.b2MassData=
N;Box2D.Collision.Shapes.b2PolygonShape=U;Box2D.Collision.Shapes.b2Shape=Q;Box2D.Common.b2internal="Box2D.Common.b2internal";Box2D.Common.b2Color=B;Box2D.Common.b2Settings=E;Box2D.Common.Math.b2Mat22=Z;Box2D.Common.Math.b2Mat33=O;Box2D.Common.Math.b2Math=M;Box2D.Common.Math.b2Sweep=X;Box2D.Common.Math.b2Transform=aa;Box2D.Common.Math.b2Vec2=Y;Box2D.Common.Math.b2Vec3=ba;Box2D.Dynamics.b2Body=da;Box2D.Dynamics.b2BodyDef=ra;Box2D.Dynamics.b2ContactFilter=x;Box2D.Dynamics.b2ContactImpulse=ja;Box2D.Dynamics.b2ContactListener=
ka;Box2D.Dynamics.b2ContactManager=oa;Box2D.Dynamics.b2DebugDraw=pa;Box2D.Dynamics.b2DestructionListener=V;Box2D.Dynamics.b2FilterData=va;Box2D.Dynamics.b2Fixture=ta;Box2D.Dynamics.b2FixtureDef=sa;Box2D.Dynamics.b2Island=Da;Box2D.Dynamics.b2TimeStep=L;Box2D.Dynamics.b2World=W;Box2D.Dynamics.Contacts.b2CircleContact=fa;Box2D.Dynamics.Contacts.b2Contact=R;Box2D.Dynamics.Contacts.b2ContactConstraint=v;Box2D.Dynamics.Contacts.b2ContactConstraintPoint=Na;Box2D.Dynamics.Contacts.b2ContactEdge=tb;Box2D.Dynamics.Contacts.b2ContactFactory=
kb;Box2D.Dynamics.Contacts.b2ContactRegister=ea;Box2D.Dynamics.Contacts.b2ContactResult=ma;Box2D.Dynamics.Contacts.b2ContactSolver=Ca;Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=ub;Box2D.Dynamics.Contacts.b2NullContact=Va;Box2D.Dynamics.Contacts.b2PolyAndCircleContact=nb;Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=xb;Box2D.Dynamics.Contacts.b2PolygonContact=Fa;Box2D.Dynamics.Contacts.b2PositionSolverManifold=Sa;Box2D.Dynamics.Controllers.b2BuoyancyController=bb;Box2D.Dynamics.Controllers.b2ConstantAccelController=
Ta;Box2D.Dynamics.Controllers.b2ConstantForceController=Aa;Box2D.Dynamics.Controllers.b2Controller=xa;Box2D.Dynamics.Controllers.b2ControllerEdge=Hb;Box2D.Dynamics.Controllers.b2GravityController=Ia;Box2D.Dynamics.Controllers.b2TensorDampingController=qb;Box2D.Dynamics.Joints.b2DistanceJoint=Ma;Box2D.Dynamics.Joints.b2DistanceJointDef=cb;Box2D.Dynamics.Joints.b2FrictionJoint=gb;Box2D.Dynamics.Joints.b2FrictionJointDef=Qa;Box2D.Dynamics.Joints.b2GearJoint=qa;Box2D.Dynamics.Joints.b2GearJointDef=za;
Box2D.Dynamics.Joints.b2Jacobian=ua;Box2D.Dynamics.Joints.b2Joint=hb;Box2D.Dynamics.Joints.b2JointDef=Ka;Box2D.Dynamics.Joints.b2JointEdge=Pa;Box2D.Dynamics.Joints.b2LineJoint=yb;Box2D.Dynamics.Joints.b2LineJointDef=na;Box2D.Dynamics.Joints.b2MouseJoint=Fb;Box2D.Dynamics.Joints.b2MouseJointDef=Ja;Box2D.Dynamics.Joints.b2PrismaticJoint=db;Box2D.Dynamics.Joints.b2PrismaticJointDef=Ib;Box2D.Dynamics.Joints.b2PulleyJoint=Ab;Box2D.Dynamics.Joints.b2PulleyJointDef=vb;Box2D.Dynamics.Joints.b2RevoluteJoint=
ob;Box2D.Dynamics.Joints.b2RevoluteJointDef=Ga;Box2D.Dynamics.Joints.b2WeldJoint=Ha;Box2D.Dynamics.Joints.b2WeldJointDef=pb})();Box2D.postDefs=[];
(function(){var b=Box2D.Collision.Shapes.b2CircleShape,c=Box2D.Collision.Shapes.b2PolygonShape,d=Box2D.Collision.Shapes.b2Shape,e=Box2D.Common.b2Settings,f=Box2D.Common.Math.b2Math,g=Box2D.Common.Math.b2Sweep,h=Box2D.Common.Math.b2Transform,j=Box2D.Common.Math.b2Vec2,k=Box2D.Collision.b2AABB,l=Box2D.Collision.b2Bound,m=Box2D.Collision.b2BoundValues,n=Box2D.Collision.b2Collision,q=Box2D.Collision.b2ContactID,p=Box2D.Collision.b2ContactPoint,s=Box2D.Collision.b2Distance,r=Box2D.Collision.b2DistanceInput,
o=Box2D.Collision.b2DistanceOutput,t=Box2D.Collision.b2DistanceProxy,u=Box2D.Collision.b2DynamicTree,w=Box2D.Collision.b2DynamicTreeBroadPhase,z=Box2D.Collision.b2DynamicTreeNode,A=Box2D.Collision.b2DynamicTreePair,C=Box2D.Collision.b2Manifold,G=Box2D.Collision.b2ManifoldPoint,H=Box2D.Collision.b2Point,K=Box2D.Collision.b2RayCastInput,P=Box2D.Collision.b2RayCastOutput,T=Box2D.Collision.b2Segment,D=Box2D.Collision.b2SeparationFunction,F=Box2D.Collision.b2Simplex,I=Box2D.Collision.b2SimplexCache,J=
Box2D.Collision.b2SimplexVertex,N=Box2D.Collision.b2TimeOfImpact,U=Box2D.Collision.b2TOIInput,Q=Box2D.Collision.b2WorldManifold,B=Box2D.Collision.ClipVertex,E=Box2D.Collision.Features,Z=Box2D.Collision.IBroadPhase;k.b2AABB=function(){this.lowerBound=new j;this.upperBound=new j};k.prototype.IsValid=function(){var b=this.upperBound.y-this.lowerBound.y;return this.upperBound.x-this.lowerBound.x>=0&&b>=0&&this.lowerBound.IsValid()&&this.upperBound.IsValid()};k.prototype.GetCenter=function(){return new j((this.lowerBound.x+
this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)};k.prototype.GetExtents=function(){return new j((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)};k.prototype.Contains=function(b){return this.lowerBound.x<=b.lowerBound.x&&this.lowerBound.y<=b.lowerBound.y&&b.upperBound.x<=this.upperBound.x&&b.upperBound.y<=this.upperBound.y};k.prototype.RayCast=function(b,c){var d=-Number.MAX_VALUE,e=Number.MAX_VALUE,f=c.p1.x,g=c.p1.y,h=c.p2.x-c.p1.x,j=c.p2.y-c.p1.y,k=
Math.abs(j),l=b.normal,m=0,o=0,n=0;if(Math.abs(h)<Number.MIN_VALUE){if(f<this.lowerBound.x||this.upperBound.x<f)return false}else{m=1/h;o=(this.lowerBound.x-f)*m;m=(this.upperBound.x-f)*m;n=-1;if(o>m){n=o;o=m;m=n;n=1}if(o>d){l.x=n;l.y=0;d=o}e=Math.min(e,m);if(d>e)return false}if(k<Number.MIN_VALUE){if(g<this.lowerBound.y||this.upperBound.y<g)return false}else{m=1/j;o=(this.lowerBound.y-g)*m;m=(this.upperBound.y-g)*m;n=-1;if(o>m){n=o;o=m;m=n;n=1}if(o>d){l.y=n;l.x=0;d=o}e=Math.min(e,m);if(d>e)return false}b.fraction=
d;return true};k.prototype.TestOverlap=function(b){var c=b.lowerBound.y-this.upperBound.y,d=this.lowerBound.y-b.upperBound.y;return b.lowerBound.x-this.upperBound.x>0||c>0||this.lowerBound.x-b.upperBound.x>0||d>0?false:true};k.Combine=function(b,c){var d=new k;d.Combine(b,c);return d};k.prototype.Combine=function(b,c){this.lowerBound.x=Math.min(b.lowerBound.x,c.lowerBound.x);this.lowerBound.y=Math.min(b.lowerBound.y,c.lowerBound.y);this.upperBound.x=Math.max(b.upperBound.x,c.upperBound.x);this.upperBound.y=
Math.max(b.upperBound.y,c.upperBound.y)};l.b2Bound=function(){};l.prototype.IsLower=function(){return(this.value&1)==0};l.prototype.IsUpper=function(){return(this.value&1)==1};l.prototype.Swap=function(b){var c=this.value,d=this.proxy,e=this.stabbingCount;this.value=b.value;this.proxy=b.proxy;this.stabbingCount=b.stabbingCount;b.value=c;b.proxy=d;b.stabbingCount=e};m.b2BoundValues=function(){};m.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number;this.lowerValues[0]=0;this.lowerValues[1]=
0;this.upperValues=new Vector_a2j_Number;this.upperValues[0]=0;this.upperValues[1]=0};n.b2Collision=function(){};n.ClipSegmentToLine=function(b,c,d,e){e===void 0&&(e=0);var f,g=0;f=c[0];var h=f.v;f=c[1];var j=f.v,k=d.x*h.x+d.y*h.y-e;f=d.x*j.x+d.y*j.y-e;k<=0&&b[g++].Set(c[0]);f<=0&&b[g++].Set(c[1]);if(k*f<0){d=k/(k-f);f=b[g];f=f.v;f.x=h.x+d*(j.x-h.x);f.y=h.y+d*(j.y-h.y);f=b[g];f.id=(k>0?c[0]:c[1]).id;++g}return g};n.EdgeSeparation=function(b,c,d,e,f){d===void 0&&(d=0);parseInt(b.m_vertexCount);var g=
b.m_vertices,b=b.m_normals,h=parseInt(e.m_vertexCount),j=e.m_vertices,k,l;k=c.R;l=b[d];b=k.col1.x*l.x+k.col2.x*l.y;e=k.col1.y*l.x+k.col2.y*l.y;k=f.R;var m=k.col1.x*b+k.col1.y*e;k=k.col2.x*b+k.col2.y*e;for(var o=0,n=Number.MAX_VALUE,s=0;s<h;++s){l=j[s];l=l.x*m+l.y*k;if(l<n){n=l;o=s}}l=g[d];k=c.R;d=c.position.x+(k.col1.x*l.x+k.col2.x*l.y);c=c.position.y+(k.col1.y*l.x+k.col2.y*l.y);l=j[o];k=f.R;g=f.position.x+(k.col1.x*l.x+k.col2.x*l.y);f=f.position.y+(k.col1.y*l.x+k.col2.y*l.y);return(g-d)*b+(f-c)*
e};n.FindMaxSeparation=function(b,c,d,e,f){var g=parseInt(c.m_vertexCount),h=c.m_normals,j,k;k=f.R;j=e.m_centroid;var l=f.position.x+(k.col1.x*j.x+k.col2.x*j.y),m=f.position.y+(k.col1.y*j.x+k.col2.y*j.y);k=d.R;j=c.m_centroid;l=l-(d.position.x+(k.col1.x*j.x+k.col2.x*j.y));m=m-(d.position.y+(k.col1.y*j.x+k.col2.y*j.y));k=l*d.R.col1.x+m*d.R.col1.y;for(var m=l*d.R.col2.x+m*d.R.col2.y,l=0,o=-Number.MAX_VALUE,s=0;s<g;++s){j=h[s];j=j.x*k+j.y*m;if(j>o){o=j;l=s}}h=n.EdgeSeparation(c,d,l,e,f);j=parseInt(l-
1>=0?l-1:g-1);k=n.EdgeSeparation(c,d,j,e,f);var m=parseInt(l+1<g?l+1:0),o=n.EdgeSeparation(c,d,m,e,f),p=0,q=0;if(k>h&&k>o){q=-1;s=j;p=k}else if(o>h){q=1;s=m;p=o}else{b[0]=l;return h}for(;;){l=q==-1?s-1>=0?s-1:g-1:s+1<g?s+1:0;h=n.EdgeSeparation(c,d,l,e,f);if(h>p){s=l;p=h}else break}b[0]=s;return p};n.FindIncidentEdge=function(b,c,d,e,f,g){e===void 0&&(e=0);parseInt(c.m_vertexCount);var h=c.m_normals,j=parseInt(f.m_vertexCount),c=f.m_vertices,f=f.m_normals,k;k=d.R;var d=h[e],h=k.col1.x*d.x+k.col2.x*
d.y,l=k.col1.y*d.x+k.col2.y*d.y;k=g.R;d=k.col1.x*h+k.col1.y*l;l=k.col2.x*h+k.col2.y*l;h=d;k=0;for(var m=Number.MAX_VALUE,o=0;o<j;++o){d=f[o];d=h*d.x+l*d.y;if(d<m){m=d;k=o}}f=parseInt(k);h=parseInt(f+1<j?f+1:0);j=b[0];d=c[f];k=g.R;j.v.x=g.position.x+(k.col1.x*d.x+k.col2.x*d.y);j.v.y=g.position.y+(k.col1.y*d.x+k.col2.y*d.y);j.id.features.referenceEdge=e;j.id.features.incidentEdge=f;j.id.features.incidentVertex=0;j=b[1];d=c[h];k=g.R;j.v.x=g.position.x+(k.col1.x*d.x+k.col2.x*d.y);j.v.y=g.position.y+(k.col1.y*
d.x+k.col2.y*d.y);j.id.features.referenceEdge=e;j.id.features.incidentEdge=h;j.id.features.incidentVertex=1};n.MakeClipPointVector=function(){var b=new Vector(2);b[0]=new B;b[1]=new B;return b};n.CollidePolygons=function(b,c,d,f,g){var h;b.m_pointCount=0;var j=c.m_radius+f.m_radius;n.s_edgeAO[0]=0;var k=n.FindMaxSeparation(n.s_edgeAO,c,d,f,g);h=n.s_edgeAO[0];if(!(k>j)){var l;n.s_edgeBO[0]=0;var m=n.FindMaxSeparation(n.s_edgeBO,f,g,c,d);l=n.s_edgeBO[0];if(!(m>j)){var o=0,s=0;if(m>0.98*k+0.001){k=f;
f=c;c=g;o=l;b.m_type=C.e_faceB;s=1}else{k=c;c=d;d=g;o=h;b.m_type=C.e_faceA;s=0}h=n.s_incidentEdge;n.FindIncidentEdge(h,k,c,o,f,d);l=parseInt(k.m_vertexCount);var g=k.m_vertices,k=g[o],p;p=o+1<l?g[parseInt(o+1)]:g[0];o=n.s_localTangent;o.Set(p.x-k.x,p.y-k.y);o.Normalize();g=n.s_localNormal;g.x=o.y;g.y=-o.x;f=n.s_planePoint;f.Set(0.5*(k.x+p.x),0.5*(k.y+p.y));m=n.s_tangent;l=c.R;m.x=l.col1.x*o.x+l.col2.x*o.y;m.y=l.col1.y*o.x+l.col2.y*o.y;var q=n.s_tangent2;q.x=-m.x;q.y=-m.y;o=n.s_normal;o.x=m.y;o.y=
-m.x;var t=n.s_v11,u=n.s_v12;t.x=c.position.x+(l.col1.x*k.x+l.col2.x*k.y);t.y=c.position.y+(l.col1.y*k.x+l.col2.y*k.y);u.x=c.position.x+(l.col1.x*p.x+l.col2.x*p.y);u.y=c.position.y+(l.col1.y*p.x+l.col2.y*p.y);c=o.x*t.x+o.y*t.y;l=m.x*u.x+m.y*u.y+j;p=n.s_clipPoints1;k=n.s_clipPoints2;u=n.ClipSegmentToLine(p,h,q,-m.x*t.x-m.y*t.y+j);if(!(u<2)){u=n.ClipSegmentToLine(k,p,m,l);if(!(u<2)){b.m_localPlaneNormal.SetV(g);b.m_localPoint.SetV(f);for(f=g=0;f<e.b2_maxManifoldPoints;++f){h=k[f];if(o.x*h.v.x+o.y*h.v.y-
c<=j){m=b.m_points[g];l=d.R;q=h.v.x-d.position.x;t=h.v.y-d.position.y;m.m_localPoint.x=q*l.col1.x+t*l.col1.y;m.m_localPoint.y=q*l.col2.x+t*l.col2.y;m.m_id.Set(h.id);m.m_id.features.flip=s;++g}}b.m_pointCount=g}}}}};n.CollideCircles=function(b,c,d,e,f){b.m_pointCount=0;var g,h;g=d.R;h=c.m_p;var j=d.position.x+(g.col1.x*h.x+g.col2.x*h.y),d=d.position.y+(g.col1.y*h.x+g.col2.y*h.y);g=f.R;h=e.m_p;j=f.position.x+(g.col1.x*h.x+g.col2.x*h.y)-j;f=f.position.y+(g.col1.y*h.x+g.col2.y*h.y)-d;g=c.m_radius+e.m_radius;
if(!(j*j+f*f>g*g)){b.m_type=C.e_circles;b.m_localPoint.SetV(c.m_p);b.m_localPlaneNormal.SetZero();b.m_pointCount=1;b.m_points[0].m_localPoint.SetV(e.m_p);b.m_points[0].m_id.key=0}};n.CollidePolygonAndCircle=function(b,c,d,e,f){var g=b.m_pointCount=0,h=0,j,k;k=f.R;j=e.m_p;var l=f.position.y+(k.col1.y*j.x+k.col2.y*j.y),g=f.position.x+(k.col1.x*j.x+k.col2.x*j.y)-d.position.x,h=l-d.position.y;k=d.R;d=g*k.col1.x+h*k.col1.y;k=g*k.col2.x+h*k.col2.y;for(var m=0,l=-Number.MAX_VALUE,f=c.m_radius+e.m_radius,
o=parseInt(c.m_vertexCount),n=c.m_vertices,c=c.m_normals,s=0;s<o;++s){j=n[s];g=d-j.x;h=k-j.y;j=c[s];g=j.x*g+j.y*h;if(g>f)return;if(g>l){l=g;m=s}}g=parseInt(m);h=parseInt(g+1<o?g+1:0);j=n[g];n=n[h];if(l<Number.MIN_VALUE){b.m_pointCount=1;b.m_type=C.e_faceA;b.m_localPlaneNormal.SetV(c[m]);b.m_localPoint.x=0.5*(j.x+n.x);b.m_localPoint.y=0.5*(j.y+n.y)}else{l=(d-n.x)*(j.x-n.x)+(k-n.y)*(j.y-n.y);if((d-j.x)*(n.x-j.x)+(k-j.y)*(n.y-j.y)<=0){if((d-j.x)*(d-j.x)+(k-j.y)*(k-j.y)>f*f)return;b.m_pointCount=1;b.m_type=
C.e_faceA;b.m_localPlaneNormal.x=d-j.x;b.m_localPlaneNormal.y=k-j.y;b.m_localPlaneNormal.Normalize();b.m_localPoint.SetV(j)}else if(l<=0){if((d-n.x)*(d-n.x)+(k-n.y)*(k-n.y)>f*f)return;b.m_pointCount=1;b.m_type=C.e_faceA;b.m_localPlaneNormal.x=d-n.x;b.m_localPlaneNormal.y=k-n.y;b.m_localPlaneNormal.Normalize();b.m_localPoint.SetV(n)}else{m=0.5*(j.x+n.x);j=0.5*(j.y+n.y);l=(d-m)*c[g].x+(k-j)*c[g].y;if(l>f)return;b.m_pointCount=1;b.m_type=C.e_faceA;b.m_localPlaneNormal.x=c[g].x;b.m_localPlaneNormal.y=
c[g].y;b.m_localPlaneNormal.Normalize();b.m_localPoint.Set(m,j)}}b.m_points[0].m_localPoint.SetV(e.m_p);b.m_points[0].m_id.key=0};n.TestOverlap=function(b,c){var d=c.lowerBound,e=b.upperBound,f=d.x-e.x,g=d.y-e.y,d=b.lowerBound,e=c.upperBound,h=d.y-e.y;return f>0||g>0||d.x-e.x>0||h>0?false:true};Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=n.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints1=n.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints2=
n.MakeClipPointVector();Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_localTangent=new j;Box2D.Collision.b2Collision.s_localNormal=new j;Box2D.Collision.b2Collision.s_planePoint=new j;Box2D.Collision.b2Collision.s_normal=new j;Box2D.Collision.b2Collision.s_tangent=new j;Box2D.Collision.b2Collision.s_tangent2=new j;Box2D.Collision.b2Collision.s_v11=new j;Box2D.Collision.b2Collision.s_v12=new j;
Box2D.Collision.b2Collision.b2CollidePolyTempVec=new j;Box2D.Collision.b2Collision.b2_nullFeature=255});q.b2ContactID=function(){this.features=new E};q.prototype.b2ContactID=function(){this.features._m_id=this};q.prototype.Set=function(b){this.key=b._key};q.prototype.Copy=function(){var b=new q;b.key=this.key;return b};Object.defineProperty(q.prototype,"key",{enumerable:false,configurable:true,get:function(){return this._key}});Object.defineProperty(q.prototype,"key",{enumerable:false,configurable:true,
set:function(b){b===void 0&&(b=0);this._key=b;this.features._referenceEdge=this._key&255;this.features._incidentEdge=(this._key&65280)>>8&255;this.features._incidentVertex=(this._key&16711680)>>16&255;this.features._flip=(this._key&4278190080)>>24&255}});p.b2ContactPoint=function(){this.position=new j;this.velocity=new j;this.normal=new j;this.id=new q};s.b2Distance=function(){};s.Distance=function(b,c,d){++s.b2_gjkCalls;var g=d.proxyA,h=d.proxyB,k=d.transformA,l=d.transformB,m=s.s_simplex;m.ReadCache(c,
g,k,h,l);var o=m.m_vertices,n=s.s_saveA,p=s.s_saveB,q=0;m.GetClosestPoint().LengthSquared();for(var t=0,u,r=0;r<20;){q=m.m_count;for(t=0;t<q;t++){n[t]=o[t].indexA;p[t]=o[t].indexB}switch(m.m_count){case 1:break;case 2:m.Solve2();break;case 3:m.Solve3();break;default:e.b2Assert(false)}if(m.m_count==3)break;u=m.GetClosestPoint();u.LengthSquared();t=m.GetSearchDirection();if(t.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;u=o[m.m_count];u.indexA=g.GetSupport(f.MulTMV(k.R,t.GetNegative()));
u.wA=f.MulX(k,g.GetVertex(u.indexA));u.indexB=h.GetSupport(f.MulTMV(l.R,t));u.wB=f.MulX(l,h.GetVertex(u.indexB));u.w=f.SubtractVV(u.wB,u.wA);++r;++s.b2_gjkIters;for(var B=false,t=0;t<q;t++)if(u.indexA==n[t]&&u.indexB==p[t]){B=true;break}if(B)break;++m.m_count}s.b2_gjkMaxIters=f.Max(s.b2_gjkMaxIters,r);m.GetWitnessPoints(b.pointA,b.pointB);b.distance=f.SubtractVV(b.pointA,b.pointB).Length();b.iterations=r;m.WriteCache(c);if(d.useRadii){c=g.m_radius;h=h.m_radius;if(b.distance>c+h&&b.distance>Number.MIN_VALUE){b.distance=
b.distance-(c+h);d=f.SubtractVV(b.pointB,b.pointA);d.Normalize();b.pointA.x=b.pointA.x+c*d.x;b.pointA.y=b.pointA.y+c*d.y;b.pointB.x=b.pointB.x-h*d.x;b.pointB.y=b.pointB.y-h*d.y}else{u=new j;u.x=0.5*(b.pointA.x+b.pointB.x);u.y=0.5*(b.pointA.y+b.pointB.y);b.pointA.x=b.pointB.x=u.x;b.pointA.y=b.pointB.y=u.y;b.distance=0}}};Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new F;Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3);Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)});
r.b2DistanceInput=function(){};o.b2DistanceOutput=function(){this.pointA=new j;this.pointB=new j};t.b2DistanceProxy=function(){};t.prototype.Set=function(f){switch(f.GetType()){case d.e_circleShape:f=f instanceof b?f:null;this.m_vertices=new Vector(1,true);this.m_vertices[0]=f.m_p;this.m_count=1;this.m_radius=f.m_radius;break;case d.e_polygonShape:f=f instanceof c?f:null;this.m_vertices=f.m_vertices;this.m_count=f.m_vertexCount;this.m_radius=f.m_radius;break;default:e.b2Assert(false)}};t.prototype.GetSupport=
function(b){for(var c=0,d=this.m_vertices[0].x*b.x+this.m_vertices[0].y*b.y,e=1;e<this.m_count;++e){var f=this.m_vertices[e].x*b.x+this.m_vertices[e].y*b.y;if(f>d){c=e;d=f}}return c};t.prototype.GetSupportVertex=function(b){for(var c=0,d=this.m_vertices[0].x*b.x+this.m_vertices[0].y*b.y,e=1;e<this.m_count;++e){var f=this.m_vertices[e].x*b.x+this.m_vertices[e].y*b.y;if(f>d){c=e;d=f}}return this.m_vertices[c]};t.prototype.GetVertexCount=function(){return this.m_count};t.prototype.GetVertex=function(b){b===
void 0&&(b=0);e.b2Assert(0<=b&&b<this.m_count);return this.m_vertices[b]};u.b2DynamicTree=function(){};u.prototype.b2DynamicTree=function(){this.m_freeList=this.m_root=null;this.m_insertionCount=this.m_path=0};u.prototype.CreateProxy=function(b,c){var d=this.AllocateNode(),f=e.b2_aabbExtension,g=e.b2_aabbExtension;d.aabb.lowerBound.x=b.lowerBound.x-f;d.aabb.lowerBound.y=b.lowerBound.y-g;d.aabb.upperBound.x=b.upperBound.x+f;d.aabb.upperBound.y=b.upperBound.y+g;d.userData=c;this.InsertLeaf(d);return d};
u.prototype.DestroyProxy=function(b){this.RemoveLeaf(b);this.FreeNode(b)};u.prototype.MoveProxy=function(b,c,d){e.b2Assert(b.IsLeaf());if(b.aabb.Contains(c))return false;this.RemoveLeaf(b);var f=e.b2_aabbExtension+e.b2_aabbMultiplier*(d.x>0?d.x:-d.x),d=e.b2_aabbExtension+e.b2_aabbMultiplier*(d.y>0?d.y:-d.y);b.aabb.lowerBound.x=c.lowerBound.x-f;b.aabb.lowerBound.y=c.lowerBound.y-d;b.aabb.upperBound.x=c.upperBound.x+f;b.aabb.upperBound.y=c.upperBound.y+d;this.InsertLeaf(b);return true};u.prototype.Rebalance=
function(b){b===void 0&&(b=0);if(this.m_root!=null)for(var c=0;c<b;c++){for(var d=this.m_root,e=0;d.IsLeaf()==false;){d=this.m_path>>e&1?d.child2:d.child1;e=e+1&31}++this.m_path;this.RemoveLeaf(d);this.InsertLeaf(d)}};u.prototype.GetFatAABB=function(b){return b.aabb};u.prototype.GetUserData=function(b){return b.userData};u.prototype.Query=function(b,c){if(this.m_root!=null){var d=new Vector,e=0;for(d[e++]=this.m_root;e>0;){var f=d[--e];if(f.aabb.TestOverlap(c))if(f.IsLeaf()){if(!b(f))break}else{d[e++]=
f.child1;d[e++]=f.child2}}}};u.prototype.RayCast=function(b,c){if(this.m_root!=null){var d=c.p1,e=c.p2,g=f.SubtractVV(d,e);g.Normalize();var g=f.CrossFV(1,g),h=f.AbsV(g),j=c.maxFraction,l=new k,m=0,o=0,m=d.x+j*(e.x-d.x),o=d.y+j*(e.y-d.y);l.lowerBound.x=Math.min(d.x,m);l.lowerBound.y=Math.min(d.y,o);l.upperBound.x=Math.max(d.x,m);l.upperBound.y=Math.max(d.y,o);var n=new Vector,s=0;for(n[s++]=this.m_root;s>0;){j=n[--s];if(j.aabb.TestOverlap(l)!=false){m=j.aabb.GetCenter();o=j.aabb.GetExtents();if(!(Math.abs(g.x*
(d.x-m.x)+g.y*(d.y-m.y))-h.x*o.x-h.y*o.y>0))if(j.IsLeaf()){m=new K;m.p1=c.p1;m.p2=c.p2;m.maxFraction=c.maxFraction;j=b(m,j);if(j==0)break;if(j>0){m=d.x+j*(e.x-d.x);o=d.y+j*(e.y-d.y);l.lowerBound.x=Math.min(d.x,m);l.lowerBound.y=Math.min(d.y,o);l.upperBound.x=Math.max(d.x,m);l.upperBound.y=Math.max(d.y,o)}}else{n[s++]=j.child1;n[s++]=j.child2}}}}};u.prototype.AllocateNode=function(){if(this.m_freeList){var b=this.m_freeList;this.m_freeList=b.parent;b.parent=null;b.child1=null;b.child2=null;return b}return new z};
u.prototype.FreeNode=function(b){b.parent=this.m_freeList;this.m_freeList=b};u.prototype.InsertLeaf=function(b){++this.m_insertionCount;if(this.m_root==null){this.m_root=b;this.m_root.parent=null}else{var c=b.aabb.GetCenter(),d=this.m_root;if(d.IsLeaf()==false){do var e=d.child1,d=d.child2,d=Math.abs((e.aabb.lowerBound.x+e.aabb.upperBound.x)/2-c.x)+Math.abs((e.aabb.lowerBound.y+e.aabb.upperBound.y)/2-c.y)<Math.abs((d.aabb.lowerBound.x+d.aabb.upperBound.x)/2-c.x)+Math.abs((d.aabb.lowerBound.y+d.aabb.upperBound.y)/
2-c.y)?e:d;while(d.IsLeaf()==false)}c=d.parent;e=this.AllocateNode();e.parent=c;e.userData=null;e.aabb.Combine(b.aabb,d.aabb);if(c){d.parent.child1==d?c.child1=e:c.child2=e;e.child1=d;e.child2=b;d.parent=e;b.parent=e;do{if(c.aabb.Contains(e.aabb))break;c.aabb.Combine(c.child1.aabb,c.child2.aabb);e=c;c=c.parent}while(c)}else{e.child1=d;e.child2=b;d.parent=e;this.m_root=b.parent=e}}};u.prototype.RemoveLeaf=function(b){if(b==this.m_root)this.m_root=null;else{var c=b.parent,d=c.parent,b=c.child1==b?c.child2:
c.child1;if(d){d.child1==c?d.child1=b:d.child2=b;b.parent=d;for(this.FreeNode(c);d;){c=d.aabb;d.aabb=k.Combine(d.child1.aabb,d.child2.aabb);if(c.Contains(d.aabb))break;d=d.parent}}else{this.m_root=b;b.parent=null;this.FreeNode(c)}}};w.b2DynamicTreeBroadPhase=function(){this.m_tree=new u;this.m_moveBuffer=new Vector;this.m_pairBuffer=new Vector;this.m_pairCount=0};w.prototype.CreateProxy=function(b,c){var d=this.m_tree.CreateProxy(b,c);++this.m_proxyCount;this.BufferMove(d);return d};w.prototype.DestroyProxy=
function(b){this.UnBufferMove(b);--this.m_proxyCount;this.m_tree.DestroyProxy(b)};w.prototype.MoveProxy=function(b,c,d){this.m_tree.MoveProxy(b,c,d)&&this.BufferMove(b)};w.prototype.TestOverlap=function(b,c){var d=this.m_tree.GetFatAABB(b),e=this.m_tree.GetFatAABB(c);return d.TestOverlap(e)};w.prototype.GetUserData=function(b){return this.m_tree.GetUserData(b)};w.prototype.GetFatAABB=function(b){return this.m_tree.GetFatAABB(b)};w.prototype.GetProxyCount=function(){return this.m_proxyCount};w.prototype.UpdatePairs=
function(b){for(var c=this,d=c.m_pairCount=0,e,d=0;d<c.m_moveBuffer.length;++d){e=c.m_moveBuffer[d];var f=c.m_tree.GetFatAABB(e);c.m_tree.Query(function(b){if(b==e)return true;c.m_pairCount==c.m_pairBuffer.length&&(c.m_pairBuffer[c.m_pairCount]=new A);var d=c.m_pairBuffer[c.m_pairCount];d.proxyA=b<e?b:e;d.proxyB=b>=e?b:e;++c.m_pairCount;return true},f)}for(d=c.m_moveBuffer.length=0;d<c.m_pairCount;){var f=c.m_pairBuffer[d],g=c.m_tree.GetUserData(f.proxyA),h=c.m_tree.GetUserData(f.proxyB);b(g,h);for(++d;d<
c.m_pairCount;){g=c.m_pairBuffer[d];if(g.proxyA!=f.proxyA||g.proxyB!=f.proxyB)break;++d}}};w.prototype.Query=function(b,c){this.m_tree.Query(b,c)};w.prototype.RayCast=function(b,c){this.m_tree.RayCast(b,c)};w.prototype.Validate=function(){};w.prototype.Rebalance=function(b){b===void 0&&(b=0);this.m_tree.Rebalance(b)};w.prototype.BufferMove=function(b){this.m_moveBuffer[this.m_moveBuffer.length]=b};w.prototype.UnBufferMove=function(b){this.m_moveBuffer.splice(parseInt(this.m_moveBuffer.indexOf(b)),
1)};w.prototype.ComparePairs=function(){return 0};w.__implements={};w.__implements[Z]=true;z.b2DynamicTreeNode=function(){this.aabb=new k};z.prototype.IsLeaf=function(){return this.child1==null};A.b2DynamicTreePair=function(){};C.b2Manifold=function(){this.m_pointCount=0};C.prototype.b2Manifold=function(){this.m_points=new Vector(e.b2_maxManifoldPoints);for(var b=0;b<e.b2_maxManifoldPoints;b++)this.m_points[b]=new G;this.m_localPlaneNormal=new j;this.m_localPoint=new j};C.prototype.Reset=function(){for(var b=
0;b<e.b2_maxManifoldPoints;b++)(this.m_points[b]instanceof G?this.m_points[b]:null).Reset();this.m_localPlaneNormal.SetZero();this.m_localPoint.SetZero();this.m_pointCount=this.m_type=0};C.prototype.Set=function(b){this.m_pointCount=b.m_pointCount;for(var c=0;c<e.b2_maxManifoldPoints;c++)(this.m_points[c]instanceof G?this.m_points[c]:null).Set(b.m_points[c]);this.m_localPlaneNormal.SetV(b.m_localPlaneNormal);this.m_localPoint.SetV(b.m_localPoint);this.m_type=b.m_type};C.prototype.Copy=function(){var b=
new C;b.Set(this);return b};Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1;Box2D.Collision.b2Manifold.e_faceA=2;Box2D.Collision.b2Manifold.e_faceB=4});G.b2ManifoldPoint=function(){this.m_localPoint=new j;this.m_id=new q};G.prototype.b2ManifoldPoint=function(){this.Reset()};G.prototype.Reset=function(){this.m_localPoint.SetZero();this.m_tangentImpulse=this.m_normalImpulse=0;this.m_id.key=0};G.prototype.Set=function(b){this.m_localPoint.SetV(b.m_localPoint);this.m_normalImpulse=
b.m_normalImpulse;this.m_tangentImpulse=b.m_tangentImpulse;this.m_id.Set(b.m_id)};H.b2Point=function(){this.p=new j};H.prototype.Support=function(){return this.p};H.prototype.GetFirstVertex=function(){return this.p};K.b2RayCastInput=function(){this.p1=new j;this.p2=new j};K.prototype.b2RayCastInput=function(b,c,d){b===void 0&&(b=null);c===void 0&&(c=null);d===void 0&&(d=1);b&&this.p1.SetV(b);c&&this.p2.SetV(c);this.maxFraction=d};P.b2RayCastOutput=function(){this.normal=new j};T.b2Segment=function(){this.p1=
new j;this.p2=new j};T.prototype.TestSegment=function(b,c,d,e){e===void 0&&(e=0);var f=d.p1,g=d.p2.x-f.x,h=d.p2.y-f.y,d=this.p2.y-this.p1.y,j=-(this.p2.x-this.p1.x),k=100*Number.MIN_VALUE,l=-(g*d+h*j);if(l>k){var m=f.x-this.p1.x,o=f.y-this.p1.y,f=m*d+o*j;if(0<=f&&f<=e*l){e=-g*o+h*m;if(-k*l<=e&&e<=l*(1+k)){f=f/l;e=Math.sqrt(d*d+j*j);b[0]=f;c.Set(d/e,j/e);return true}}}return false};T.prototype.Extend=function(b){this.ExtendForward(b);this.ExtendBackward(b)};T.prototype.ExtendForward=function(b){var c=
this.p2.x-this.p1.x,d=this.p2.y-this.p1.y,b=Math.min(c>0?(b.upperBound.x-this.p1.x)/c:c<0?(b.lowerBound.x-this.p1.x)/c:Number.POSITIVE_INFINITY,d>0?(b.upperBound.y-this.p1.y)/d:d<0?(b.lowerBound.y-this.p1.y)/d:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+c*b;this.p2.y=this.p1.y+d*b};T.prototype.ExtendBackward=function(b){var c=-this.p2.x+this.p1.x,d=-this.p2.y+this.p1.y,b=Math.min(c>0?(b.upperBound.x-this.p2.x)/c:c<0?(b.lowerBound.x-this.p2.x)/c:Number.POSITIVE_INFINITY,d>0?(b.upperBound.y-this.p2.y)/
d:d<0?(b.lowerBound.y-this.p2.y)/d:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+c*b;this.p1.y=this.p2.y+d*b};D.b2SeparationFunction=function(){this.m_localPoint=new j;this.m_axis=new j};D.prototype.Initialize=function(b,c,d,g,h){this.m_proxyA=c;this.m_proxyB=g;var k=parseInt(b.count);e.b2Assert(0<k&&k<3);var l,m,o,n,s=0,p=0;if(k==1){this.m_type=D.e_points;l=this.m_proxyA.GetVertex(b.indexA[0]);m=this.m_proxyB.GetVertex(b.indexB[0]);k=l;b=d.R;c=d.position.x+(b.col1.x*k.x+b.col2.x*k.y);g=d.position.y+
(b.col1.y*k.x+b.col2.y*k.y);k=m;b=h.R;o=h.position.x+(b.col1.x*k.x+b.col2.x*k.y);n=h.position.y+(b.col1.y*k.x+b.col2.y*k.y);this.m_axis.x=o-c;this.m_axis.y=n-g;this.m_axis.Normalize()}else{if(b.indexB[0]==b.indexB[1]){this.m_type=D.e_faceA;c=this.m_proxyA.GetVertex(b.indexA[0]);g=this.m_proxyA.GetVertex(b.indexA[1]);m=this.m_proxyB.GetVertex(b.indexB[0]);this.m_localPoint.x=0.5*(c.x+g.x);this.m_localPoint.y=0.5*(c.y+g.y);this.m_axis=f.CrossVF(f.SubtractVV(g,c),1);this.m_axis.Normalize();k=this.m_axis;
b=d.R;s=b.col1.x*k.x+b.col2.x*k.y;p=b.col1.y*k.x+b.col2.y*k.y;k=this.m_localPoint;b=d.R;c=d.position.x+(b.col1.x*k.x+b.col2.x*k.y);g=d.position.y+(b.col1.y*k.x+b.col2.y*k.y);k=m;b=h.R;o=h.position.x+(b.col1.x*k.x+b.col2.x*k.y);n=h.position.y+(b.col1.y*k.x+b.col2.y*k.y);s=(o-c)*s+(n-g)*p}else if(b.indexA[0]==b.indexA[0]){this.m_type=D.e_faceB;o=this.m_proxyB.GetVertex(b.indexB[0]);n=this.m_proxyB.GetVertex(b.indexB[1]);l=this.m_proxyA.GetVertex(b.indexA[0]);this.m_localPoint.x=0.5*(o.x+n.x);this.m_localPoint.y=
0.5*(o.y+n.y);this.m_axis=f.CrossVF(f.SubtractVV(n,o),1);this.m_axis.Normalize();k=this.m_axis;b=h.R;s=b.col1.x*k.x+b.col2.x*k.y;p=b.col1.y*k.x+b.col2.y*k.y;k=this.m_localPoint;b=h.R;o=h.position.x+(b.col1.x*k.x+b.col2.x*k.y);n=h.position.y+(b.col1.y*k.x+b.col2.y*k.y);k=l;b=d.R;c=d.position.x+(b.col1.x*k.x+b.col2.x*k.y);g=d.position.y+(b.col1.y*k.x+b.col2.y*k.y);s=(c-o)*s+(g-n)*p}else{c=this.m_proxyA.GetVertex(b.indexA[0]);g=this.m_proxyA.GetVertex(b.indexA[1]);o=this.m_proxyB.GetVertex(b.indexB[0]);
n=this.m_proxyB.GetVertex(b.indexB[1]);f.MulX(d,l);l=f.MulMV(d.R,f.SubtractVV(g,c));f.MulX(h,m);s=f.MulMV(h.R,f.SubtractVV(n,o));h=l.x*l.x+l.y*l.y;m=s.x*s.x+s.y*s.y;b=f.SubtractVV(s,l);d=l.x*b.x+l.y*b.y;b=s.x*b.x+s.y*b.y;l=l.x*s.x+l.y*s.y;p=h*m-l*l;s=0;p!=0&&(s=f.Clamp((l*b-d*m)/p,0,1));(l*s+b)/m<0&&(s=f.Clamp((l-d)/h,0,1));l=new j;l.x=c.x+s*(g.x-c.x);l.y=c.y+s*(g.y-c.y);m=new j;m.x=o.x+s*(n.x-o.x);m.y=o.y+s*(n.y-o.y);if(s==0||s==1){this.m_type=D.e_faceB;this.m_axis=f.CrossVF(f.SubtractVV(n,o),1);
this.m_axis.Normalize();this.m_localPoint=m}else{this.m_type=D.e_faceA;this.m_axis=f.CrossVF(f.SubtractVV(g,c),1);this.m_localPoint=l}}s<0&&this.m_axis.NegativeSelf()}};D.prototype.Evaluate=function(b,c){var d,g,h=0;switch(this.m_type){case D.e_points:d=f.MulTMV(b.R,this.m_axis);g=f.MulTMV(c.R,this.m_axis.GetNegative());d=this.m_proxyA.GetSupportVertex(d);g=this.m_proxyB.GetSupportVertex(g);d=f.MulX(b,d);g=f.MulX(c,g);return(g.x-d.x)*this.m_axis.x+(g.y-d.y)*this.m_axis.y;case D.e_faceA:h=f.MulMV(b.R,
this.m_axis);d=f.MulX(b,this.m_localPoint);g=f.MulTMV(c.R,h.GetNegative());g=this.m_proxyB.GetSupportVertex(g);g=f.MulX(c,g);return(g.x-d.x)*h.x+(g.y-d.y)*h.y;case D.e_faceB:h=f.MulMV(c.R,this.m_axis);g=f.MulX(c,this.m_localPoint);d=f.MulTMV(b.R,h.GetNegative());d=this.m_proxyA.GetSupportVertex(d);d=f.MulX(b,d);return(d.x-g.x)*h.x+(d.y-g.y)*h.y;default:e.b2Assert(false);return 0}};Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1;Box2D.Collision.b2SeparationFunction.e_faceA=
2;Box2D.Collision.b2SeparationFunction.e_faceB=4});F.b2Simplex=function(){this.m_v1=new J;this.m_v2=new J;this.m_v3=new J;this.m_vertices=new Vector(3)};F.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};F.prototype.ReadCache=function(b,c,d,g,h){e.b2Assert(0<=b.count&&b.count<=3);var j,k;this.m_count=b.count;for(var l=this.m_vertices,m=0;m<this.m_count;m++){var o=l[m];o.indexA=b.indexA[m];o.indexB=b.indexB[m];j=c.GetVertex(o.indexA);
k=g.GetVertex(o.indexB);o.wA=f.MulX(d,j);o.wB=f.MulX(h,k);o.w=f.SubtractVV(o.wB,o.wA);o.a=0}if(this.m_count>1){b=b.metric;j=this.GetMetric();if(j<0.5*b||2*b<j||j<Number.MIN_VALUE)this.m_count=0}if(this.m_count==0){o=l[0];o.indexA=0;o.indexB=0;j=c.GetVertex(0);k=g.GetVertex(0);o.wA=f.MulX(d,j);o.wB=f.MulX(h,k);o.w=f.SubtractVV(o.wB,o.wA);this.m_count=1}};F.prototype.WriteCache=function(b){b.metric=this.GetMetric();b.count=Box2D.parseUInt(this.m_count);for(var c=this.m_vertices,d=0;d<this.m_count;d++){b.indexA[d]=
Box2D.parseUInt(c[d].indexA);b.indexB[d]=Box2D.parseUInt(c[d].indexB)}};F.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var b=f.SubtractVV(this.m_v2.w,this.m_v1.w);return f.CrossVV(b,this.m_v1.w.GetNegative())>0?f.CrossFV(1,b):f.CrossVF(b,1);default:e.b2Assert(false);return new j}};F.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:e.b2Assert(false);return new j;case 1:return this.m_v1.w;case 2:return new j(this.m_v1.a*
this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:e.b2Assert(false);return new j}};F.prototype.GetWitnessPoints=function(b,c){switch(this.m_count){case 0:e.b2Assert(false);break;case 1:b.SetV(this.m_v1.wA);c.SetV(this.m_v1.wB);break;case 2:b.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;b.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;c.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;c.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*
this.m_v2.wB.y;break;case 3:c.x=b.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;c.y=b.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:e.b2Assert(false)}};F.prototype.GetMetric=function(){switch(this.m_count){case 0:e.b2Assert(false);return 0;case 1:return 0;case 2:return f.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return f.CrossVV(f.SubtractVV(this.m_v2.w,this.m_v1.w),f.SubtractVV(this.m_v3.w,this.m_v1.w));
default:e.b2Assert(false);return 0}};F.prototype.Solve2=function(){var b=this.m_v1.w,c=this.m_v2.w,d=f.SubtractVV(c,b),b=-(b.x*d.x+b.y*d.y);if(b<=0)this.m_count=this.m_v1.a=1;else{c=c.x*d.x+c.y*d.y;if(c<=0){this.m_count=this.m_v2.a=1;this.m_v1.Set(this.m_v2)}else{d=1/(c+b);this.m_v1.a=c*d;this.m_v2.a=b*d;this.m_count=2}}};F.prototype.Solve3=function(){var b=this.m_v1.w,c=this.m_v2.w,d=this.m_v3.w,e=f.SubtractVV(c,b),g=f.Dot(b,e),h=f.Dot(c,e),g=-g,j=f.SubtractVV(d,b),k=f.Dot(b,j),l=f.Dot(d,j),k=-k,
m=f.SubtractVV(d,c),o=f.Dot(c,m),m=f.Dot(d,m),o=-o,j=f.CrossVV(e,j),e=j*f.CrossVV(c,d),d=j*f.CrossVV(d,b),b=j*f.CrossVV(b,c);if(g<=0&&k<=0)this.m_count=this.m_v1.a=1;else if(h>0&&g>0&&b<=0){l=1/(h+g);this.m_v1.a=h*l;this.m_v2.a=g*l;this.m_count=2}else if(l>0&&k>0&&d<=0){h=1/(l+k);this.m_v1.a=l*h;this.m_v3.a=k*h;this.m_count=2;this.m_v2.Set(this.m_v3)}else if(h<=0&&o<=0){this.m_count=this.m_v2.a=1;this.m_v1.Set(this.m_v2)}else if(l<=0&&m<=0){this.m_count=this.m_v3.a=1;this.m_v1.Set(this.m_v3)}else if(m>
0&&o>0&&e<=0){h=1/(m+o);this.m_v2.a=m*h;this.m_v3.a=o*h;this.m_count=2;this.m_v1.Set(this.m_v3)}else{h=1/(e+d+b);this.m_v1.a=e*h;this.m_v2.a=d*h;this.m_v3.a=b*h;this.m_count=3}};I.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3);this.indexB=new Vector_a2j_Number(3)};J.b2SimplexVertex=function(){};J.prototype.Set=function(b){this.wA.SetV(b.wA);this.wB.SetV(b.wB);this.w.SetV(b.w);this.a=b.a;this.indexA=b.indexA;this.indexB=b.indexB};N.b2TimeOfImpact=function(){};N.TimeOfImpact=function(b){++N.b2_toiCalls;
var c=b.proxyA,d=b.proxyB,g=b.sweepA,h=b.sweepB;e.b2Assert(g.t0==h.t0);e.b2Assert(1-g.t0>Number.MIN_VALUE);var j=c.m_radius+d.m_radius,b=b.tolerance,k=0,l=0,m=0;N.s_cache.count=0;for(N.s_distanceInput.useRadii=false;;){g.GetTransform(N.s_xfA,k);h.GetTransform(N.s_xfB,k);N.s_distanceInput.proxyA=c;N.s_distanceInput.proxyB=d;N.s_distanceInput.transformA=N.s_xfA;N.s_distanceInput.transformB=N.s_xfB;s.Distance(N.s_distanceOutput,N.s_cache,N.s_distanceInput);if(N.s_distanceOutput.distance<=0){k=1;break}N.s_fcn.Initialize(N.s_cache,
c,N.s_xfA,d,N.s_xfB);var o=N.s_fcn.Evaluate(N.s_xfA,N.s_xfB);if(o<=0){k=1;break}l==0&&(m=o>j?f.Max(j-b,0.75*j):f.Max(o-b,0.02*j));if(o-m<0.5*b){if(l==0){k=1;break}break}var n=k,p=k,t=1;g.GetTransform(N.s_xfA,t);h.GetTransform(N.s_xfB,t);var q=N.s_fcn.Evaluate(N.s_xfA,N.s_xfB);if(q>=m){k=1;break}for(var u=0;;){var r=0,r=u&1?p+(m-o)*(t-p)/(q-o):0.5*(p+t);g.GetTransform(N.s_xfA,r);h.GetTransform(N.s_xfB,r);var B=N.s_fcn.Evaluate(N.s_xfA,N.s_xfB);if(f.Abs(B-m)<0.025*b){n=r;break}if(B>m){p=r;o=B}else{t=
r;q=B}++u;++N.b2_toiRootIters;if(u==50)break}N.b2_toiMaxRootIters=f.Max(N.b2_toiMaxRootIters,u);if(n<(1+100*Number.MIN_VALUE)*k)break;k=n;l++;++N.b2_toiIters;if(l==1E3)break}N.b2_toiMaxIters=f.Max(N.b2_toiMaxIters,l);return k};Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0;Box2D.Collision.b2TimeOfImpact.b2_toiIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0;Box2D.Collision.b2TimeOfImpact.s_cache=
new I;Box2D.Collision.b2TimeOfImpact.s_distanceInput=new r;Box2D.Collision.b2TimeOfImpact.s_xfA=new h;Box2D.Collision.b2TimeOfImpact.s_xfB=new h;Box2D.Collision.b2TimeOfImpact.s_fcn=new D;Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new o});U.b2TOIInput=function(){this.proxyA=new t;this.proxyB=new t;this.sweepA=new g;this.sweepB=new g};Q.b2WorldManifold=function(){this.m_normal=new j};Q.prototype.b2WorldManifold=function(){this.m_points=new Vector(e.b2_maxManifoldPoints);for(var b=0;b<e.b2_maxManifoldPoints;b++)this.m_points[b]=
new j};Q.prototype.Initialize=function(b,c,d,e,f){d===void 0&&(d=0);f===void 0&&(f=0);if(b.m_pointCount!=0){var g=0,h,j,k=0,l=0,m=0,o=0,n=0;switch(b.m_type){case C.e_circles:j=c.R;h=b.m_localPoint;g=c.position.x+j.col1.x*h.x+j.col2.x*h.y;c=c.position.y+j.col1.y*h.x+j.col2.y*h.y;j=e.R;h=b.m_points[0].m_localPoint;b=e.position.x+j.col1.x*h.x+j.col2.x*h.y;e=e.position.y+j.col1.y*h.x+j.col2.y*h.y;h=b-g;j=e-c;k=h*h+j*j;if(k>Number.MIN_VALUE*Number.MIN_VALUE){k=Math.sqrt(k);this.m_normal.x=h/k;this.m_normal.y=
j/k}else{this.m_normal.x=1;this.m_normal.y=0}h=c+d*this.m_normal.y;e=e-f*this.m_normal.y;this.m_points[0].x=0.5*(g+d*this.m_normal.x+(b-f*this.m_normal.x));this.m_points[0].y=0.5*(h+e);break;case C.e_faceA:j=c.R;h=b.m_localPlaneNormal;k=j.col1.x*h.x+j.col2.x*h.y;l=j.col1.y*h.x+j.col2.y*h.y;j=c.R;h=b.m_localPoint;m=c.position.x+j.col1.x*h.x+j.col2.x*h.y;o=c.position.y+j.col1.y*h.x+j.col2.y*h.y;this.m_normal.x=k;this.m_normal.y=l;for(g=0;g<b.m_pointCount;g++){j=e.R;h=b.m_points[g].m_localPoint;n=e.position.x+
j.col1.x*h.x+j.col2.x*h.y;h=e.position.y+j.col1.y*h.x+j.col2.y*h.y;this.m_points[g].x=n+0.5*(d-(n-m)*k-(h-o)*l-f)*k;this.m_points[g].y=h+0.5*(d-(n-m)*k-(h-o)*l-f)*l}break;case C.e_faceB:j=e.R;h=b.m_localPlaneNormal;k=j.col1.x*h.x+j.col2.x*h.y;l=j.col1.y*h.x+j.col2.y*h.y;j=e.R;h=b.m_localPoint;m=e.position.x+j.col1.x*h.x+j.col2.x*h.y;o=e.position.y+j.col1.y*h.x+j.col2.y*h.y;this.m_normal.x=-k;this.m_normal.y=-l;for(g=0;g<b.m_pointCount;g++){j=c.R;h=b.m_points[g].m_localPoint;n=c.position.x+j.col1.x*
h.x+j.col2.x*h.y;h=c.position.y+j.col1.y*h.x+j.col2.y*h.y;this.m_points[g].x=n+0.5*(f-(n-m)*k-(h-o)*l-d)*k;this.m_points[g].y=h+0.5*(f-(n-m)*k-(h-o)*l-d)*l}}}};B.ClipVertex=function(){this.v=new j;this.id=new q};B.prototype.Set=function(b){this.v.SetV(b.v);this.id.Set(b.id)};E.Features=function(){};Object.defineProperty(E.prototype,"referenceEdge",{enumerable:false,configurable:true,get:function(){return this._referenceEdge}});Object.defineProperty(E.prototype,"referenceEdge",{enumerable:false,configurable:true,
set:function(b){b===void 0&&(b=0);this._referenceEdge=b;this._m_id._key=this._m_id._key&4294967040|this._referenceEdge&255}});Object.defineProperty(E.prototype,"incidentEdge",{enumerable:false,configurable:true,get:function(){return this._incidentEdge}});Object.defineProperty(E.prototype,"incidentEdge",{enumerable:false,configurable:true,set:function(b){b===void 0&&(b=0);this._incidentEdge=b;this._m_id._key=this._m_id._key&4294902015|this._incidentEdge<<8&65280}});Object.defineProperty(E.prototype,
"incidentVertex",{enumerable:false,configurable:true,get:function(){return this._incidentVertex}});Object.defineProperty(E.prototype,"incidentVertex",{enumerable:false,configurable:true,set:function(b){b===void 0&&(b=0);this._incidentVertex=b;this._m_id._key=this._m_id._key&4278255615|this._incidentVertex<<16&16711680}});Object.defineProperty(E.prototype,"flip",{enumerable:false,configurable:true,get:function(){return this._flip}});Object.defineProperty(E.prototype,"flip",{enumerable:false,configurable:true,
set:function(b){b===void 0&&(b=0);this._flip=b;this._m_id._key=this._m_id._key&16777215|this._flip<<24&4278190080}})})();
(function(){var b=Box2D.Common.b2Settings,c=Box2D.Collision.Shapes.b2CircleShape,d=Box2D.Collision.Shapes.b2EdgeChainDef,e=Box2D.Collision.Shapes.b2EdgeShape,f=Box2D.Collision.Shapes.b2MassData,g=Box2D.Collision.Shapes.b2PolygonShape,h=Box2D.Collision.Shapes.b2Shape,j=Box2D.Common.Math.b2Mat22,k=Box2D.Common.Math.b2Math,l=Box2D.Common.Math.b2Transform,m=Box2D.Common.Math.b2Vec2,n=Box2D.Collision.b2Distance,q=Box2D.Collision.b2DistanceInput,p=Box2D.Collision.b2DistanceOutput,s=Box2D.Collision.b2DistanceProxy,
r=Box2D.Collision.b2SimplexCache;Box2D.inherit(c,Box2D.Collision.Shapes.b2Shape);c.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;c.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.m_p=new m};c.prototype.Copy=function(){var b=new c;b.Set(this);return b};c.prototype.Set=function(b){this.__super.Set.call(this,b);Box2D.is(b,c)&&this.m_p.SetV((b instanceof c?b:null).m_p)};c.prototype.TestPoint=function(b,c){var d=b.R,e=b.position.x+(d.col1.x*this.m_p.x+
d.col2.x*this.m_p.y),d=b.position.y+(d.col1.y*this.m_p.x+d.col2.y*this.m_p.y),e=c.x-e,d=c.y-d;return e*e+d*d<=this.m_radius*this.m_radius};c.prototype.RayCast=function(b,c,d){var e=d.R,f=c.p1.x-(d.position.x+(e.col1.x*this.m_p.x+e.col2.x*this.m_p.y)),d=c.p1.y-(d.position.y+(e.col1.y*this.m_p.x+e.col2.y*this.m_p.y)),e=c.p2.x-c.p1.x,g=c.p2.y-c.p1.y,h=f*e+d*g,j=e*e+g*g,k=h*h-j*(f*f+d*d-this.m_radius*this.m_radius);if(k<0||j<Number.MIN_VALUE)return false;h=-(h+Math.sqrt(k));if(0<=h&&h<=c.maxFraction*
j){h=h/j;b.fraction=h;b.normal.x=f+h*e;b.normal.y=d+h*g;b.normal.Normalize();return true}return false};c.prototype.ComputeAABB=function(b,c){var d=c.R,e=c.position.x+(d.col1.x*this.m_p.x+d.col2.x*this.m_p.y),d=c.position.y+(d.col1.y*this.m_p.x+d.col2.y*this.m_p.y);b.lowerBound.Set(e-this.m_radius,d-this.m_radius);b.upperBound.Set(e+this.m_radius,d+this.m_radius)};c.prototype.ComputeMass=function(c,d){d===void 0&&(d=0);c.mass=d*b.b2_pi*this.m_radius*this.m_radius;c.center.SetV(this.m_p);c.I=c.mass*
(0.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))};c.prototype.ComputeSubmergedArea=function(b,c,d,e){c===void 0&&(c=0);var d=k.MulX(d,this.m_p),f=-(k.Dot(b,d)-c);if(f<-this.m_radius+Number.MIN_VALUE)return 0;if(f>this.m_radius){e.SetV(d);return Math.PI*this.m_radius*this.m_radius}var c=this.m_radius*this.m_radius,g=f*f,f=c*(Math.asin(f/this.m_radius)+Math.PI/2)+f*Math.sqrt(c-g),c=-2/3*Math.pow(c-g,1.5)/f;e.x=d.x+b.x*c;e.y=d.y+b.y*c;return f};c.prototype.GetLocalPosition=
function(){return this.m_p};c.prototype.SetLocalPosition=function(b){this.m_p.SetV(b)};c.prototype.GetRadius=function(){return this.m_radius};c.prototype.SetRadius=function(b){b===void 0&&(b=0);this.m_radius=b};c.prototype.b2CircleShape=function(b){b===void 0&&(b=0);this.__super.b2Shape.call(this);this.m_type=h.e_circleShape;this.m_radius=b};d.b2EdgeChainDef=function(){};d.prototype.b2EdgeChainDef=function(){this.vertexCount=0;this.isALoop=true;this.vertices=[]};Box2D.inherit(e,Box2D.Collision.Shapes.b2Shape);
e.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;e.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.s_supportVec=new m;this.m_v1=new m;this.m_v2=new m;this.m_coreV1=new m;this.m_coreV2=new m;this.m_normal=new m;this.m_direction=new m;this.m_cornerDir1=new m;this.m_cornerDir2=new m};e.prototype.TestPoint=function(){return false};e.prototype.RayCast=function(b,c,d){var e,f=c.p2.x-c.p1.x,g=c.p2.y-c.p1.y;e=d.R;var h=d.position.x+(e.col1.x*this.m_v1.x+
e.col2.x*this.m_v1.y),j=d.position.y+(e.col1.y*this.m_v1.x+e.col2.y*this.m_v1.y),k=d.position.y+(e.col1.y*this.m_v2.x+e.col2.y*this.m_v2.y)-j,d=-(d.position.x+(e.col1.x*this.m_v2.x+e.col2.x*this.m_v2.y)-h);e=100*Number.MIN_VALUE;var l=-(f*k+g*d);if(l>e){var h=c.p1.x-h,m=c.p1.y-j,j=h*k+m*d;if(0<=j&&j<=c.maxFraction*l){c=-f*m+g*h;if(-e*l<=c&&c<=l*(1+e)){b.fraction=j/l;c=Math.sqrt(k*k+d*d);b.normal.x=k/c;b.normal.y=d/c;return true}}}return false};e.prototype.ComputeAABB=function(b,c){var d=c.R,e=c.position.x+
(d.col1.x*this.m_v1.x+d.col2.x*this.m_v1.y),f=c.position.y+(d.col1.y*this.m_v1.x+d.col2.y*this.m_v1.y),g=c.position.x+(d.col1.x*this.m_v2.x+d.col2.x*this.m_v2.y),d=c.position.y+(d.col1.y*this.m_v2.x+d.col2.y*this.m_v2.y);if(e<g){b.lowerBound.x=e;b.upperBound.x=g}else{b.lowerBound.x=g;b.upperBound.x=e}if(f<d){b.lowerBound.y=f;b.upperBound.y=d}else{b.lowerBound.y=d;b.upperBound.y=f}};e.prototype.ComputeMass=function(b){b.mass=0;b.center.SetV(this.m_v1);b.I=0};e.prototype.ComputeSubmergedArea=function(b,
c,d,e){c===void 0&&(c=0);var f=new m(b.x*c,b.y*c),g=k.MulX(d,this.m_v1),d=k.MulX(d,this.m_v2),h=k.Dot(b,g)-c,b=k.Dot(b,d)-c;if(h>0){if(b>0)return 0;g.x=-b/(h-b)*g.x+h/(h-b)*d.x;g.y=-b/(h-b)*g.y+h/(h-b)*d.y}else if(b>0){d.x=-b/(h-b)*g.x+h/(h-b)*d.x;d.y=-b/(h-b)*g.y+h/(h-b)*d.y}e.x=(f.x+g.x+d.x)/3;e.y=(f.y+g.y+d.y)/3;return 0.5*((g.x-f.x)*(d.y-f.y)-(g.y-f.y)*(d.x-f.x))};e.prototype.GetLength=function(){return this.m_length};e.prototype.GetVertex1=function(){return this.m_v1};e.prototype.GetVertex2=
function(){return this.m_v2};e.prototype.GetCoreVertex1=function(){return this.m_coreV1};e.prototype.GetCoreVertex2=function(){return this.m_coreV2};e.prototype.GetNormalVector=function(){return this.m_normal};e.prototype.GetDirectionVector=function(){return this.m_direction};e.prototype.GetCorner1Vector=function(){return this.m_cornerDir1};e.prototype.GetCorner2Vector=function(){return this.m_cornerDir2};e.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1};e.prototype.Corner2IsConvex=
function(){return this.m_cornerConvex2};e.prototype.GetFirstVertex=function(b){var c=b.R;return new m(b.position.x+(c.col1.x*this.m_coreV1.x+c.col2.x*this.m_coreV1.y),b.position.y+(c.col1.y*this.m_coreV1.x+c.col2.y*this.m_coreV1.y))};e.prototype.GetNextEdge=function(){return this.m_nextEdge};e.prototype.GetPrevEdge=function(){return this.m_prevEdge};e.prototype.Support=function(b,c,d){c===void 0&&(c=0);d===void 0&&(d=0);var e=b.R,f=b.position.x+(e.col1.x*this.m_coreV1.x+e.col2.x*this.m_coreV1.y),
g=b.position.y+(e.col1.y*this.m_coreV1.x+e.col2.y*this.m_coreV1.y),h=b.position.x+(e.col1.x*this.m_coreV2.x+e.col2.x*this.m_coreV2.y),b=b.position.y+(e.col1.y*this.m_coreV2.x+e.col2.y*this.m_coreV2.y);if(f*c+g*d>h*c+b*d){this.s_supportVec.x=f;this.s_supportVec.y=g}else{this.s_supportVec.x=h;this.s_supportVec.y=b}return this.s_supportVec};e.prototype.b2EdgeShape=function(c,d){this.__super.b2Shape.call(this);this.m_type=h.e_edgeShape;this.m_nextEdge=this.m_prevEdge=null;this.m_v1=c;this.m_v2=d;this.m_direction.Set(this.m_v2.x-
this.m_v1.x,this.m_v2.y-this.m_v1.y);this.m_length=this.m_direction.Normalize();this.m_normal.Set(this.m_direction.y,-this.m_direction.x);this.m_coreV1.Set(-b.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-b.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y);this.m_coreV2.Set(-b.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-b.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y);this.m_cornerDir1=this.m_normal;this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)};
e.prototype.SetPrevEdge=function(b,c,d,e){this.m_prevEdge=b;this.m_coreV1=c;this.m_cornerDir1=d;this.m_cornerConvex1=e};e.prototype.SetNextEdge=function(b,c,d,e){this.m_nextEdge=b;this.m_coreV2=c;this.m_cornerDir2=d;this.m_cornerConvex2=e};f.b2MassData=function(){this.mass=0;this.center=new m(0,0);this.I=0};Box2D.inherit(g,Box2D.Collision.Shapes.b2Shape);g.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;g.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)};
g.prototype.Copy=function(){var b=new g;b.Set(this);return b};g.prototype.Set=function(b){this.__super.Set.call(this,b);if(Box2D.is(b,g)){b=b instanceof g?b:null;this.m_centroid.SetV(b.m_centroid);this.m_vertexCount=b.m_vertexCount;this.Reserve(this.m_vertexCount);for(var c=0;c<this.m_vertexCount;c++){this.m_vertices[c].SetV(b.m_vertices[c]);this.m_normals[c].SetV(b.m_normals[c])}}};g.prototype.SetAsArray=function(b,c){c===void 0&&(c=0);for(var d=new Vector,e=0,f,e=0;e<b.length;++e){f=b[e];d.push(f)}this.SetAsVector(d,
c)};g.AsArray=function(b,c){c===void 0&&(c=0);var d=new g;d.SetAsArray(b,c);return d};g.prototype.SetAsVector=function(c,d){d===void 0&&(d=0);if(d==0)d=c.length;b.b2Assert(2<=d);this.m_vertexCount=d;this.Reserve(d);for(var e=0,e=0;e<this.m_vertexCount;e++)this.m_vertices[e].SetV(c[e]);for(e=0;e<this.m_vertexCount;++e){var f=parseInt(e),h=parseInt(e+1<this.m_vertexCount?e+1:0),f=k.SubtractVV(this.m_vertices[h],this.m_vertices[f]);b.b2Assert(f.LengthSquared()>Number.MIN_VALUE);this.m_normals[e].SetV(k.CrossVF(f,
1));this.m_normals[e].Normalize()}this.m_centroid=g.ComputeCentroid(this.m_vertices,this.m_vertexCount)};g.AsVector=function(b,c){c===void 0&&(c=0);var d=new g;d.SetAsVector(b,c);return d};g.prototype.SetAsBox=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set(-b,-c);this.m_vertices[1].Set(b,-c);this.m_vertices[2].Set(b,c);this.m_vertices[3].Set(-b,c);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,
0);this.m_centroid.SetZero()};g.AsBox=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);var d=new g;d.SetAsBox(b,c);return d};g.prototype.SetAsOrientedBox=function(b,c,d,e){b===void 0&&(b=0);c===void 0&&(c=0);d===void 0&&(d=null);e===void 0&&(e=0);this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set(-b,-c);this.m_vertices[1].Set(b,-c);this.m_vertices[2].Set(b,c);this.m_vertices[3].Set(-b,c);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,
0);this.m_centroid=d;b=new l;b.position=d;b.R.Set(e);for(d=0;d<this.m_vertexCount;++d){this.m_vertices[d]=k.MulX(b,this.m_vertices[d]);this.m_normals[d]=k.MulMV(b.R,this.m_normals[d])}};g.AsOrientedBox=function(b,c,d,e){b===void 0&&(b=0);c===void 0&&(c=0);d===void 0&&(d=null);e===void 0&&(e=0);var f=new g;f.SetAsOrientedBox(b,c,d,e);return f};g.prototype.SetAsEdge=function(b,c){this.m_vertexCount=2;this.Reserve(2);this.m_vertices[0].SetV(b);this.m_vertices[1].SetV(c);this.m_centroid.x=0.5*(b.x+c.x);
this.m_centroid.y=0.5*(b.y+c.y);this.m_normals[0]=k.CrossVF(k.SubtractVV(c,b),1);this.m_normals[0].Normalize();this.m_normals[1].x=-this.m_normals[0].x;this.m_normals[1].y=-this.m_normals[0].y};g.AsEdge=function(b,c){var d=new g;d.SetAsEdge(b,c);return d};g.prototype.TestPoint=function(b,c){var d;d=b.R;for(var e=c.x-b.position.x,f=c.y-b.position.y,g=e*d.col1.x+f*d.col1.y,h=e*d.col2.x+f*d.col2.y,j=0;j<this.m_vertexCount;++j){d=this.m_vertices[j];e=g-d.x;f=h-d.y;d=this.m_normals[j];if(d.x*e+d.y*f>0)return false}return true};
g.prototype.RayCast=function(b,c,d){var e=0,f=c.maxFraction,g=0,h=0,j,k,g=c.p1.x-d.position.x,h=c.p1.y-d.position.y;j=d.R;var l=g*j.col1.x+h*j.col1.y,m=g*j.col2.x+h*j.col2.y,g=c.p2.x-d.position.x,h=c.p2.y-d.position.y;j=d.R;c=g*j.col1.x+h*j.col1.y-l;j=g*j.col2.x+h*j.col2.y-m;for(var n=-1,s=0;s<this.m_vertexCount;++s){k=this.m_vertices[s];g=k.x-l;h=k.y-m;k=this.m_normals[s];g=k.x*g+k.y*h;h=k.x*c+k.y*j;if(h==0){if(g<0)return false}else if(h<0&&g<e*h){e=g/h;n=s}else h>0&&g<f*h&&(f=g/h);if(f<e-Number.MIN_VALUE)return false}if(n>=
0){b.fraction=e;j=d.R;k=this.m_normals[n];b.normal.x=j.col1.x*k.x+j.col2.x*k.y;b.normal.y=j.col1.y*k.x+j.col2.y*k.y;return true}return false};g.prototype.ComputeAABB=function(b,c){for(var d=c.R,e=this.m_vertices[0],f=c.position.x+(d.col1.x*e.x+d.col2.x*e.y),g=c.position.y+(d.col1.y*e.x+d.col2.y*e.y),h=f,j=g,k=1;k<this.m_vertexCount;++k)var e=this.m_vertices[k],l=c.position.x+(d.col1.x*e.x+d.col2.x*e.y),e=c.position.y+(d.col1.y*e.x+d.col2.y*e.y),f=f<l?f:l,g=g<e?g:e,h=h>l?h:l,j=j>e?j:e;b.lowerBound.x=
f-this.m_radius;b.lowerBound.y=g-this.m_radius;b.upperBound.x=h+this.m_radius;b.upperBound.y=j+this.m_radius};g.prototype.ComputeMass=function(b,c){c===void 0&&(c=0);if(this.m_vertexCount==2){b.center.x=0.5*(this.m_vertices[0].x+this.m_vertices[1].x);b.center.y=0.5*(this.m_vertices[0].y+this.m_vertices[1].y);b.mass=0;b.I=0}else{for(var d=0,e=0,f=0,g=0,h=1/3,j=0;j<this.m_vertexCount;++j)var k=this.m_vertices[j],l=j+1<this.m_vertexCount?this.m_vertices[parseInt(j+1)]:this.m_vertices[0],m=k.x-0,n=k.y-
0,s=l.x-0,p=l.y-0,q=m*p-n*s,r=0.5*q,f=f+r,d=d+r*h*(0+k.x+l.x),e=e+r*h*(0+k.y+l.y),k=m,g=g+q*(h*(0.25*(k*k+s*k+s*s)+(0*k+0*s))+0+(h*(0.25*(n*n+p*n+p*p)+(0*n+0*p))+0));b.mass=c*f;b.center.Set(d*(1/f),e*(1/f));b.I=c*g}};g.prototype.ComputeSubmergedArea=function(b,c,d,e){c===void 0&&(c=0);for(var g=k.MulTMV(d.R,b),h=c-k.Dot(b,d.position),j=new Vector_a2j_Number,l=0,n=-1,c=-1,s=false,b=b=0;b<this.m_vertexCount;++b){j[b]=k.Dot(g,this.m_vertices[b])-h;var p=j[b]<-Number.MIN_VALUE;if(b>0)if(p){if(!s){n=b-
1;l++}}else if(s){c=b-1;l++}s=p}switch(l){case 0:if(s){b=new f;this.ComputeMass(b,1);e.SetV(k.MulX(d,b.center));return b.mass}return 0;case 1:n==-1?n=this.m_vertexCount-1:c=this.m_vertexCount-1}b=parseInt((n+1)%this.m_vertexCount);g=parseInt((c+1)%this.m_vertexCount);h=(0-j[n])/(j[b]-j[n]);j=(0-j[c])/(j[g]-j[c]);n=new m(this.m_vertices[n].x*(1-h)+this.m_vertices[b].x*h,this.m_vertices[n].y*(1-h)+this.m_vertices[b].y*h);c=new m(this.m_vertices[c].x*(1-j)+this.m_vertices[g].x*j,this.m_vertices[c].y*
(1-j)+this.m_vertices[g].y*j);j=0;h=new m;for(l=this.m_vertices[b];b!=g;){b=(b+1)%this.m_vertexCount;s=b==g?c:this.m_vertices[b];p=0.5*((l.x-n.x)*(s.y-n.y)-(l.y-n.y)*(s.x-n.x));j=j+p;h.x=h.x+p*(n.x+l.x+s.x)/3;h.y=h.y+p*(n.y+l.y+s.y)/3;l=s}h.Multiply(1/j);e.SetV(k.MulX(d,h));return j};g.prototype.GetVertexCount=function(){return this.m_vertexCount};g.prototype.GetVertices=function(){return this.m_vertices};g.prototype.GetNormals=function(){return this.m_normals};g.prototype.GetSupport=function(b){for(var c=
0,d=this.m_vertices[0].x*b.x+this.m_vertices[0].y*b.y,e=1;e<this.m_vertexCount;++e){var f=this.m_vertices[e].x*b.x+this.m_vertices[e].y*b.y;if(f>d){c=e;d=f}}return c};g.prototype.GetSupportVertex=function(b){for(var c=0,d=this.m_vertices[0].x*b.x+this.m_vertices[0].y*b.y,e=1;e<this.m_vertexCount;++e){var f=this.m_vertices[e].x*b.x+this.m_vertices[e].y*b.y;if(f>d){c=e;d=f}}return this.m_vertices[c]};g.prototype.Validate=function(){return false};g.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this);
this.m_type=h.e_polygonShape;this.m_centroid=new m;this.m_vertices=new Vector;this.m_normals=new Vector};g.prototype.Reserve=function(b){b===void 0&&(b=0);for(var c=parseInt(this.m_vertices.length);c<b;c++){this.m_vertices[c]=new m;this.m_normals[c]=new m}};g.ComputeCentroid=function(b,c){c===void 0&&(c=0);for(var d=new m,e=0,f=1/3,g=0;g<c;++g){var h=b[g],j=g+1<c?b[parseInt(g+1)]:b[0],k=0.5*((h.x-0)*(j.y-0)-(h.y-0)*(j.x-0)),e=e+k;d.x=d.x+k*f*(0+h.x+j.x);d.y=d.y+k*f*(0+h.y+j.y)}d.x=d.x*(1/e);d.y=d.y*
(1/e);return d};g.ComputeOBB=function(b,c,d){d===void 0&&(d=0);for(var e=0,f=new Vector(d+1),e=0;e<d;++e)f[e]=c[e];f[d]=f[0];c=Number.MAX_VALUE;for(e=1;e<=d;++e){for(var g=f[parseInt(e-1)],h=f[e].x-g.x,j=f[e].y-g.y,k=Math.sqrt(h*h+j*j),h=h/k,j=j/k,l=-j,m=h,n=k=Number.MAX_VALUE,s=-Number.MAX_VALUE,p=-Number.MAX_VALUE,q=0;q<d;++q){var r=f[q].x-g.x,N=f[q].y-g.y,U=h*r+j*N,r=l*r+m*N;U<k&&(k=U);r<n&&(n=r);U>s&&(s=U);r>p&&(p=r)}q=(s-k)*(p-n);if(q<0.95*c){c=q;b.R.col1.x=h;b.R.col1.y=j;b.R.col2.x=l;b.R.col2.y=
m;h=0.5*(k+s);j=0.5*(n+p);l=b.R;b.center.x=g.x+(l.col1.x*h+l.col2.x*j);b.center.y=g.y+(l.col1.y*h+l.col2.y*j);b.extents.x=0.5*(s-k);b.extents.y=0.5*(p-n)}}};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new j});h.b2Shape=function(){};h.prototype.Copy=function(){return null};h.prototype.Set=function(b){this.m_radius=b.m_radius};h.prototype.GetType=function(){return this.m_type};h.prototype.TestPoint=function(){return false};h.prototype.RayCast=function(){return false};
h.prototype.ComputeAABB=function(){};h.prototype.ComputeMass=function(){};h.prototype.ComputeSubmergedArea=function(){return 0};h.TestOverlap=function(b,c,d,e){var f=new q;f.proxyA=new s;f.proxyA.Set(b);f.proxyB=new s;f.proxyB.Set(d);f.transformA=c;f.transformB=e;f.useRadii=true;b=new r;b.count=0;c=new p;n.Distance(c,b,f);return c.distance<10*Number.MIN_VALUE};h.prototype.b2Shape=function(){this.m_type=h.e_unknownShape;this.m_radius=b.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=
-1;Box2D.Collision.Shapes.b2Shape.e_circleShape=0;Box2D.Collision.Shapes.b2Shape.e_polygonShape=1;Box2D.Collision.Shapes.b2Shape.e_edgeShape=2;Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3;Box2D.Collision.Shapes.b2Shape.e_hitCollide=1;Box2D.Collision.Shapes.b2Shape.e_missCollide=0;Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=-1})})();
(function(){var b=Box2D.Common.b2Color,c=Box2D.Common.b2Settings,d=Box2D.Common.Math.b2Math;b.b2Color=function(){this._b=this._g=this._r=0};b.prototype.b2Color=function(b,c,g){b===void 0&&(b=0);c===void 0&&(c=0);g===void 0&&(g=0);this._r=Box2D.parseUInt(255*d.Clamp(b,0,1));this._g=Box2D.parseUInt(255*d.Clamp(c,0,1));this._b=Box2D.parseUInt(255*d.Clamp(g,0,1))};b.prototype.Set=function(b,c,g){b===void 0&&(b=0);c===void 0&&(c=0);g===void 0&&(g=0);this._r=Box2D.parseUInt(255*d.Clamp(b,0,1));this._g=
Box2D.parseUInt(255*d.Clamp(c,0,1));this._b=Box2D.parseUInt(255*d.Clamp(g,0,1))};Object.defineProperty(b.prototype,"r",{enumerable:false,configurable:true,set:function(b){b===void 0&&(b=0);this._r=Box2D.parseUInt(255*d.Clamp(b,0,1))}});Object.defineProperty(b.prototype,"g",{enumerable:false,configurable:true,set:function(b){b===void 0&&(b=0);this._g=Box2D.parseUInt(255*d.Clamp(b,0,1))}});Object.defineProperty(b.prototype,"b",{enumerable:false,configurable:true,set:function(b){b===void 0&&(b=0);this._b=
Box2D.parseUInt(255*d.Clamp(b,0,1))}});Object.defineProperty(b.prototype,"color",{enumerable:false,configurable:true,get:function(){return this._r<<16|this._g<<8|this._b}});c.b2Settings=function(){};c.b2MixFriction=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);return Math.sqrt(b*c)};c.b2MixRestitution=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);return b>c?b:c};c.b2Assert=function(b){if(!b)throw"Assertion Failed";};Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha";
Box2D.Common.b2Settings.USHRT_MAX=65535;Box2D.Common.b2Settings.b2_pi=Math.PI;Box2D.Common.b2Settings.b2_maxManifoldPoints=2;Box2D.Common.b2Settings.b2_aabbExtension=0.1;Box2D.Common.b2Settings.b2_aabbMultiplier=2;Box2D.Common.b2Settings.b2_polygonRadius=2*c.b2_linearSlop;Box2D.Common.b2Settings.b2_linearSlop=0.005;Box2D.Common.b2Settings.b2_angularSlop=2/180*c.b2_pi;Box2D.Common.b2Settings.b2_toiSlop=8*c.b2_linearSlop;Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32;Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=
32;Box2D.Common.b2Settings.b2_velocityThreshold=1;Box2D.Common.b2Settings.b2_maxLinearCorrection=0.2;Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*c.b2_pi;Box2D.Common.b2Settings.b2_maxTranslation=2;Box2D.Common.b2Settings.b2_maxTranslationSquared=c.b2_maxTranslation*c.b2_maxTranslation;Box2D.Common.b2Settings.b2_maxRotation=0.5*c.b2_pi;Box2D.Common.b2Settings.b2_maxRotationSquared=c.b2_maxRotation*c.b2_maxRotation;Box2D.Common.b2Settings.b2_contactBaumgarte=0.2;Box2D.Common.b2Settings.b2_timeToSleep=
0.5;Box2D.Common.b2Settings.b2_linearSleepTolerance=0.01;Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*c.b2_pi})})();
(function(){var b=Box2D.Common.Math.b2Mat22,c=Box2D.Common.Math.b2Mat33,d=Box2D.Common.Math.b2Math,e=Box2D.Common.Math.b2Sweep,f=Box2D.Common.Math.b2Transform,g=Box2D.Common.Math.b2Vec2,h=Box2D.Common.Math.b2Vec3;b.b2Mat22=function(){this.col1=new g;this.col2=new g};b.prototype.b2Mat22=function(){this.SetIdentity()};b.FromAngle=function(c){c===void 0&&(c=0);var d=new b;d.Set(c);return d};b.FromVV=function(c,d){var e=new b;e.SetVV(c,d);return e};b.prototype.Set=function(b){b===void 0&&(b=0);var c=
Math.cos(b),b=Math.sin(b);this.col1.x=c;this.col2.x=-b;this.col1.y=b;this.col2.y=c};b.prototype.SetVV=function(b,c){this.col1.SetV(b);this.col2.SetV(c)};b.prototype.Copy=function(){var c=new b;c.SetM(this);return c};b.prototype.SetM=function(b){this.col1.SetV(b.col1);this.col2.SetV(b.col2)};b.prototype.AddM=function(b){this.col1.x=this.col1.x+b.col1.x;this.col1.y=this.col1.y+b.col1.y;this.col2.x=this.col2.x+b.col2.x;this.col2.y=this.col2.y+b.col2.y};b.prototype.SetIdentity=function(){this.col1.x=
1;this.col2.x=0;this.col1.y=0;this.col2.y=1};b.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col1.y=0;this.col2.y=0};b.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)};b.prototype.GetInverse=function(b){var c=this.col1.x,d=this.col2.x,e=this.col1.y,f=this.col2.y,g=c*f-d*e;g!=0&&(g=1/g);b.col1.x=g*f;b.col2.x=-g*d;b.col1.y=-g*e;b.col2.y=g*c;return b};b.prototype.Solve=function(b,c,d){c===void 0&&(c=0);d===void 0&&(d=0);var e=this.col1.x,f=this.col2.x,g=this.col1.y,
h=this.col2.y,s=e*h-f*g;s!=0&&(s=1/s);b.x=s*(h*c-f*d);b.y=s*(e*d-g*c);return b};b.prototype.Abs=function(){this.col1.Abs();this.col2.Abs()};c.b2Mat33=function(){this.col1=new h;this.col2=new h;this.col3=new h};c.prototype.b2Mat33=function(b,c,d){b===void 0&&(b=null);c===void 0&&(c=null);d===void 0&&(d=null);if(!b&&!c&&!d){this.col1.SetZero();this.col2.SetZero();this.col3.SetZero()}else{this.col1.SetV(b);this.col2.SetV(c);this.col3.SetV(d)}};c.prototype.SetVVV=function(b,c,d){this.col1.SetV(b);this.col2.SetV(c);
this.col3.SetV(d)};c.prototype.Copy=function(){return new c(this.col1,this.col2,this.col3)};c.prototype.SetM=function(b){this.col1.SetV(b.col1);this.col2.SetV(b.col2);this.col3.SetV(b.col3)};c.prototype.AddM=function(b){this.col1.x=this.col1.x+b.col1.x;this.col1.y=this.col1.y+b.col1.y;this.col1.z=this.col1.z+b.col1.z;this.col2.x=this.col2.x+b.col2.x;this.col2.y=this.col2.y+b.col2.y;this.col2.z=this.col2.z+b.col2.z;this.col3.x=this.col3.x+b.col3.x;this.col3.y=this.col3.y+b.col3.y;this.col3.z=this.col3.z+
b.col3.z};c.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=1};c.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=0};c.prototype.Solve22=function(b,c,d){c===void 0&&(c=0);d===void 0&&(d=0);var e=this.col1.x,f=this.col2.x,g=this.col1.y,h=this.col2.y,s=e*h-f*g;s!=0&&(s=1/s);b.x=s*(h*c-f*d);
b.y=s*(e*d-g*c);return b};c.prototype.Solve33=function(b,c,d,e){c===void 0&&(c=0);d===void 0&&(d=0);e===void 0&&(e=0);var f=this.col1.x,g=this.col1.y,h=this.col1.z,s=this.col2.x,r=this.col2.y,o=this.col2.z,t=this.col3.x,u=this.col3.y,w=this.col3.z,z=f*(r*w-o*u)+g*(o*t-s*w)+h*(s*u-r*t);z!=0&&(z=1/z);b.x=z*(c*(r*w-o*u)+d*(o*t-s*w)+e*(s*u-r*t));b.y=z*(f*(d*w-e*u)+g*(e*t-c*w)+h*(c*u-d*t));b.z=z*(f*(r*e-o*d)+g*(o*c-s*e)+h*(s*d-r*c));return b};d.b2Math=function(){};d.IsValid=function(b){b===void 0&&(b=
0);return isFinite(b)};d.Dot=function(b,c){return b.x*c.x+b.y*c.y};d.CrossVV=function(b,c){return b.x*c.y-b.y*c.x};d.CrossVF=function(b,c){c===void 0&&(c=0);return new g(c*b.y,-c*b.x)};d.CrossFV=function(b,c){b===void 0&&(b=0);return new g(-b*c.y,b*c.x)};d.MulMV=function(b,c){return new g(b.col1.x*c.x+b.col2.x*c.y,b.col1.y*c.x+b.col2.y*c.y)};d.MulTMV=function(b,c){return new g(d.Dot(c,b.col1),d.Dot(c,b.col2))};d.MulX=function(b,c){var e=d.MulMV(b.R,c);e.x=e.x+b.position.x;e.y=e.y+b.position.y;return e};
d.MulXT=function(b,c){var e=d.SubtractVV(c,b.position),f=e.x*b.R.col1.x+e.y*b.R.col1.y;e.y=e.x*b.R.col2.x+e.y*b.R.col2.y;e.x=f;return e};d.AddVV=function(b,c){return new g(b.x+c.x,b.y+c.y)};d.SubtractVV=function(b,c){return new g(b.x-c.x,b.y-c.y)};d.Distance=function(b,c){var d=b.x-c.x,e=b.y-c.y;return Math.sqrt(d*d+e*e)};d.DistanceSquared=function(b,c){var d=b.x-c.x,e=b.y-c.y;return d*d+e*e};d.MulFV=function(b,c){b===void 0&&(b=0);return new g(b*c.x,b*c.y)};d.AddMM=function(c,e){return b.FromVV(d.AddVV(c.col1,
e.col1),d.AddVV(c.col2,e.col2))};d.MulMM=function(c,e){return b.FromVV(d.MulMV(c,e.col1),d.MulMV(c,e.col2))};d.MulTMM=function(c,e){var f=new g(d.Dot(c.col1,e.col1),d.Dot(c.col2,e.col1)),h=new g(d.Dot(c.col1,e.col2),d.Dot(c.col2,e.col2));return b.FromVV(f,h)};d.Abs=function(b){b===void 0&&(b=0);return b>0?b:-b};d.AbsV=function(b){return new g(d.Abs(b.x),d.Abs(b.y))};d.AbsM=function(c){return b.FromVV(d.AbsV(c.col1),d.AbsV(c.col2))};d.Min=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);return b<
c?b:c};d.MinV=function(b,c){return new g(d.Min(b.x,c.x),d.Min(b.y,c.y))};d.Max=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);return b>c?b:c};d.MaxV=function(b,c){return new g(d.Max(b.x,c.x),d.Max(b.y,c.y))};d.Clamp=function(b,c,d){b===void 0&&(b=0);c===void 0&&(c=0);d===void 0&&(d=0);return b<c?c:b>d?d:b};d.ClampV=function(b,c,e){return d.MaxV(c,d.MinV(b,e))};d.Swap=function(b,c){var d=b[0];b[0]=c[0];c[0]=d};d.Random=function(){return Math.random()*2-1};d.RandomRange=function(b,c){b===void 0&&
(b=0);c===void 0&&(c=0);var d=Math.random();return(c-b)*d+b};d.NextPowerOfTwo=function(b){b===void 0&&(b=0);b=b|b>>1&2147483647;b=b|b>>2&1073741823;b=b|b>>4&268435455;b=b|b>>8&16777215;return(b|b>>16&65535)+1};d.IsPowerOfTwo=function(b){b===void 0&&(b=0);return b>0&&(b&b-1)==0};Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new g(0,0);Box2D.Common.Math.b2Math.b2Mat22_identity=b.FromVV(new g(1,0),new g(0,1));Box2D.Common.Math.b2Math.b2Transform_identity=new f(d.b2Vec2_zero,d.b2Mat22_identity)});
e.b2Sweep=function(){this.localCenter=new g;this.c0=new g;this.c=new g};e.prototype.Set=function(b){this.localCenter.SetV(b.localCenter);this.c0.SetV(b.c0);this.c.SetV(b.c);this.a0=b.a0;this.a=b.a;this.t0=b.t0};e.prototype.Copy=function(){var b=new e;b.localCenter.SetV(this.localCenter);b.c0.SetV(this.c0);b.c.SetV(this.c);b.a0=this.a0;b.a=this.a;b.t0=this.t0;return b};e.prototype.GetTransform=function(b,c){c===void 0&&(c=0);b.position.x=(1-c)*this.c0.x+c*this.c.x;b.position.y=(1-c)*this.c0.y+c*this.c.y;
b.R.Set((1-c)*this.a0+c*this.a);var d=b.R;b.position.x=b.position.x-(d.col1.x*this.localCenter.x+d.col2.x*this.localCenter.y);b.position.y=b.position.y-(d.col1.y*this.localCenter.x+d.col2.y*this.localCenter.y)};e.prototype.Advance=function(b){b===void 0&&(b=0);if(this.t0<b&&1-this.t0>Number.MIN_VALUE){var c=(b-this.t0)/(1-this.t0);this.c0.x=(1-c)*this.c0.x+c*this.c.x;this.c0.y=(1-c)*this.c0.y+c*this.c.y;this.a0=(1-c)*this.a0+c*this.a;this.t0=b}};f.b2Transform=function(){this.position=new g;this.R=
new b};f.prototype.b2Transform=function(b,c){b===void 0&&(b=null);c===void 0&&(c=null);if(b){this.position.SetV(b);this.R.SetM(c)}};f.prototype.Initialize=function(b,c){this.position.SetV(b);this.R.SetM(c)};f.prototype.SetIdentity=function(){this.position.SetZero();this.R.SetIdentity()};f.prototype.Set=function(b){this.position.SetV(b.position);this.R.SetM(b.R)};f.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)};g.b2Vec2=function(){};g.prototype.b2Vec2=function(b,c){b===
void 0&&(b=0);c===void 0&&(c=0);this.x=b;this.y=c};g.prototype.SetZero=function(){this.y=this.x=0};g.prototype.Set=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);this.x=b;this.y=c};g.prototype.SetV=function(b){this.x=b.x;this.y=b.y};g.prototype.GetNegative=function(){return new g(-this.x,-this.y)};g.prototype.NegativeSelf=function(){this.x=-this.x;this.y=-this.y};g.Make=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);return new g(b,c)};g.prototype.Copy=function(){return new g(this.x,this.y)};
g.prototype.Add=function(b){this.x=this.x+b.x;this.y=this.y+b.y};g.prototype.Subtract=function(b){this.x=this.x-b.x;this.y=this.y-b.y};g.prototype.Multiply=function(b){b===void 0&&(b=0);this.x=this.x*b;this.y=this.y*b};g.prototype.MulM=function(b){var c=this.x;this.x=b.col1.x*c+b.col2.x*this.y;this.y=b.col1.y*c+b.col2.y*this.y};g.prototype.MulTM=function(b){var c=d.Dot(this,b.col1);this.y=d.Dot(this,b.col2);this.x=c};g.prototype.CrossVF=function(b){b===void 0&&(b=0);var c=this.x;this.x=b*this.y;this.y=
-b*c};g.prototype.CrossFV=function(b){b===void 0&&(b=0);var c=this.x;this.x=-b*this.y;this.y=b*c};g.prototype.MinV=function(b){this.x=this.x<b.x?this.x:b.x;this.y=this.y<b.y?this.y:b.y};g.prototype.MaxV=function(b){this.x=this.x>b.x?this.x:b.x;this.y=this.y>b.y?this.y:b.y};g.prototype.Abs=function(){if(this.x<0)this.x=-this.x;if(this.y<0)this.y=-this.y};g.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};g.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y};
g.prototype.Normalize=function(){var b=Math.sqrt(this.x*this.x+this.y*this.y);if(b<Number.MIN_VALUE)return 0;var c=1/b;this.x=this.x*c;this.y=this.y*c;return b};g.prototype.IsValid=function(){return d.IsValid(this.x)&&d.IsValid(this.y)};h.b2Vec3=function(){};h.prototype.b2Vec3=function(b,c,d){b===void 0&&(b=0);c===void 0&&(c=0);d===void 0&&(d=0);this.x=b;this.y=c;this.z=d};h.prototype.SetZero=function(){this.x=this.y=this.z=0};h.prototype.Set=function(b,c,d){b===void 0&&(b=0);c===void 0&&(c=0);d===
void 0&&(d=0);this.x=b;this.y=c;this.z=d};h.prototype.SetV=function(b){this.x=b.x;this.y=b.y;this.z=b.z};h.prototype.GetNegative=function(){return new h(-this.x,-this.y,-this.z)};h.prototype.NegativeSelf=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z};h.prototype.Copy=function(){return new h(this.x,this.y,this.z)};h.prototype.Add=function(b){this.x=this.x+b.x;this.y=this.y+b.y;this.z=this.z+b.z};h.prototype.Subtract=function(b){this.x=this.x-b.x;this.y=this.y-b.y;this.z=this.z-b.z};h.prototype.Multiply=
function(b){b===void 0&&(b=0);this.x=this.x*b;this.y=this.y*b;this.z=this.z*b}})();
(function(){var b=Box2D.Common.Math.b2Math,c=Box2D.Common.Math.b2Sweep,d=Box2D.Common.Math.b2Transform,e=Box2D.Common.Math.b2Vec2,f=Box2D.Common.b2Color,g=Box2D.Common.b2Settings,h=Box2D.Collision.b2AABB,j=Box2D.Collision.b2ContactPoint,k=Box2D.Collision.b2DynamicTreeBroadPhase,l=Box2D.Collision.b2RayCastInput,m=Box2D.Collision.b2RayCastOutput,n=Box2D.Collision.Shapes.b2CircleShape,q=Box2D.Collision.Shapes.b2EdgeShape,p=Box2D.Collision.Shapes.b2MassData,s=Box2D.Collision.Shapes.b2PolygonShape,r=Box2D.Collision.Shapes.b2Shape,
o=Box2D.Dynamics.b2Body,t=Box2D.Dynamics.b2BodyDef,u=Box2D.Dynamics.b2ContactFilter,w=Box2D.Dynamics.b2ContactImpulse,z=Box2D.Dynamics.b2ContactListener,A=Box2D.Dynamics.b2ContactManager,C=Box2D.Dynamics.b2DebugDraw,G=Box2D.Dynamics.b2DestructionListener,H=Box2D.Dynamics.b2FilterData,K=Box2D.Dynamics.b2Fixture,P=Box2D.Dynamics.b2FixtureDef,T=Box2D.Dynamics.b2Island,D=Box2D.Dynamics.b2TimeStep,F=Box2D.Dynamics.b2World,I=Box2D.Dynamics.Contacts.b2Contact,J=Box2D.Dynamics.Contacts.b2ContactFactory,N=
Box2D.Dynamics.Contacts.b2ContactSolver,U=Box2D.Dynamics.Joints.b2Joint,Q=Box2D.Dynamics.Joints.b2PulleyJoint;o.b2Body=function(){this.m_xf=new d;this.m_sweep=new c;this.m_linearVelocity=new e;this.m_force=new e};o.prototype.connectEdges=function(c,d,e){e===void 0&&(e=0);var f=Math.atan2(d.GetDirectionVector().y,d.GetDirectionVector().x),e=b.MulFV(Math.tan((f-e)*0.5),d.GetDirectionVector()),e=b.SubtractVV(e,d.GetNormalVector()),e=b.MulFV(g.b2_toiSlop,e),e=b.AddVV(e,d.GetVertex1()),h=b.AddVV(c.GetDirectionVector(),
d.GetDirectionVector());h.Normalize();var j=b.Dot(c.GetDirectionVector(),d.GetNormalVector())>0;c.SetNextEdge(d,e,h,j);d.SetPrevEdge(c,e,h,j);return f};o.prototype.CreateFixture=function(b){if(this.m_world.IsLocked()==true)return null;var c=new K;c.Create(this,this.m_xf,b);this.m_flags&o.e_activeFlag&&c.CreateProxy(this.m_world.m_contactManager.m_broadPhase,this.m_xf);c.m_next=this.m_fixtureList;this.m_fixtureList=c;++this.m_fixtureCount;c.m_body=this;c.m_density>0&&this.ResetMassData();this.m_world.m_flags=
this.m_world.m_flags|F.e_newFixture;return c};o.prototype.CreateFixture2=function(b,c){c===void 0&&(c=0);var d=new P;d.shape=b;d.density=c;return this.CreateFixture(d)};o.prototype.DestroyFixture=function(b){if(this.m_world.IsLocked()!=true){for(var c=this.m_fixtureList,d=null;c!=null;){if(c==b){d?d.m_next=b.m_next:this.m_fixtureList=b.m_next;break}d=c;c=c.m_next}for(c=this.m_contactList;c;){var d=c.contact,c=c.next,e=d.GetFixtureA(),f=d.GetFixtureB();(b==e||b==f)&&this.m_world.m_contactManager.Destroy(d)}this.m_flags&
o.e_activeFlag&&b.DestroyProxy(this.m_world.m_contactManager.m_broadPhase);b.Destroy();b.m_body=null;b.m_next=null;--this.m_fixtureCount;this.ResetMassData()}};o.prototype.SetPositionAndAngle=function(b,c){c===void 0&&(c=0);var d;if(this.m_world.IsLocked()!=true){this.m_xf.R.Set(c);this.m_xf.position.SetV(b);d=this.m_xf.R;var e=this.m_sweep.localCenter;this.m_sweep.c.x=d.col1.x*e.x+d.col2.x*e.y;this.m_sweep.c.y=d.col1.y*e.x+d.col2.y*e.y;this.m_sweep.c.x=this.m_sweep.c.x+this.m_xf.position.x;this.m_sweep.c.y=
this.m_sweep.c.y+this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_sweep.a0=this.m_sweep.a=c;e=this.m_world.m_contactManager.m_broadPhase;for(d=this.m_fixtureList;d;d=d.m_next)d.Synchronize(e,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}};o.prototype.SetTransform=function(b){this.SetPositionAndAngle(b.position,b.GetAngle())};o.prototype.GetTransform=function(){return this.m_xf};o.prototype.GetPosition=function(){return this.m_xf.position};o.prototype.SetPosition=
function(b){this.SetPositionAndAngle(b,this.GetAngle())};o.prototype.GetAngle=function(){return this.m_sweep.a};o.prototype.SetAngle=function(b){b===void 0&&(b=0);this.SetPositionAndAngle(this.GetPosition(),b)};o.prototype.GetWorldCenter=function(){return this.m_sweep.c};o.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter};o.prototype.SetLinearVelocity=function(b){this.m_type!=o.b2_staticBody&&this.m_linearVelocity.SetV(b)};o.prototype.GetLinearVelocity=function(){return this.m_linearVelocity};
o.prototype.SetAngularVelocity=function(b){b===void 0&&(b=0);if(this.m_type!=o.b2_staticBody)this.m_angularVelocity=b};o.prototype.GetAngularVelocity=function(){return this.m_angularVelocity};o.prototype.GetDefinition=function(){var b=new t;b.type=this.GetType();b.allowSleep=(this.m_flags&o.e_allowSleepFlag)==o.e_allowSleepFlag;b.angle=this.GetAngle();b.angularDamping=this.m_angularDamping;b.angularVelocity=this.m_angularVelocity;b.fixedRotation=(this.m_flags&o.e_fixedRotationFlag)==o.e_fixedRotationFlag;
b.bullet=(this.m_flags&o.e_bulletFlag)==o.e_bulletFlag;b.awake=(this.m_flags&o.e_awakeFlag)==o.e_awakeFlag;b.linearDamping=this.m_linearDamping;b.linearVelocity.SetV(this.GetLinearVelocity());b.position=this.GetPosition();b.userData=this.GetUserData();return b};o.prototype.ApplyForce=function(b,c){if(this.m_type==o.b2_dynamicBody){this.IsAwake()==false&&this.SetAwake(true);this.m_force.x=this.m_force.x+b.x;this.m_force.y=this.m_force.y+b.y;this.m_torque=this.m_torque+((c.x-this.m_sweep.c.x)*b.y-(c.y-
this.m_sweep.c.y)*b.x)}};o.prototype.ApplyTorque=function(b){b===void 0&&(b=0);if(this.m_type==o.b2_dynamicBody){this.IsAwake()==false&&this.SetAwake(true);this.m_torque=this.m_torque+b}};o.prototype.ApplyImpulse=function(b,c){if(this.m_type==o.b2_dynamicBody){this.IsAwake()==false&&this.SetAwake(true);this.m_linearVelocity.x=this.m_linearVelocity.x+this.m_invMass*b.x;this.m_linearVelocity.y=this.m_linearVelocity.y+this.m_invMass*b.y;this.m_angularVelocity=this.m_angularVelocity+this.m_invI*((c.x-
this.m_sweep.c.x)*b.y-(c.y-this.m_sweep.c.y)*b.x)}};o.prototype.Split=function(c){for(var d=this.GetLinearVelocity().Copy(),e=this.GetAngularVelocity(),f=this.GetWorldCenter(),g=this.m_world.CreateBody(this.GetDefinition()),h,j=this.m_fixtureList;j;)if(c(j)){var k=j.m_next;h?h.m_next=k:this.m_fixtureList=k;this.m_fixtureCount--;j.m_next=g.m_fixtureList;g.m_fixtureList=j;g.m_fixtureCount++;j.m_body=g;j=k}else{h=j;j=j.m_next}this.ResetMassData();g.ResetMassData();h=this.GetWorldCenter();c=g.GetWorldCenter();
h=b.AddVV(d,b.CrossFV(e,b.SubtractVV(h,f)));d=b.AddVV(d,b.CrossFV(e,b.SubtractVV(c,f)));this.SetLinearVelocity(h);g.SetLinearVelocity(d);this.SetAngularVelocity(e);g.SetAngularVelocity(e);this.SynchronizeFixtures();g.SynchronizeFixtures();return g};o.prototype.Merge=function(b){var c;for(c=b.m_fixtureList;c;){var d=c.m_next;b.m_fixtureCount--;c.m_next=this.m_fixtureList;this.m_fixtureList=c;this.m_fixtureCount++;c.m_body=f;c=d}e.m_fixtureCount=0;var e=this,f=b;e.GetWorldCenter();f.GetWorldCenter();
e.GetLinearVelocity().Copy();f.GetLinearVelocity().Copy();e.GetAngularVelocity();f.GetAngularVelocity();e.ResetMassData();this.SynchronizeFixtures()};o.prototype.GetMass=function(){return this.m_mass};o.prototype.GetInertia=function(){return this.m_I};o.prototype.GetMassData=function(b){b.mass=this.m_mass;b.I=this.m_I;b.center.SetV(this.m_sweep.localCenter)};o.prototype.SetMassData=function(c){g.b2Assert(this.m_world.IsLocked()==false);if(this.m_world.IsLocked()!=true&&this.m_type==o.b2_dynamicBody){this.m_invI=
this.m_I=this.m_invMass=0;this.m_mass=c.mass;if(this.m_mass<=0)this.m_mass=1;this.m_invMass=1/this.m_mass;if(c.I>0&&(this.m_flags&o.e_fixedRotationFlag)==0){this.m_I=c.I-this.m_mass*(c.center.x*c.center.x+c.center.y*c.center.y);this.m_invI=1/this.m_I}var d=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(c.center);this.m_sweep.c0.SetV(b.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x=this.m_linearVelocity.x+this.m_angularVelocity*-(this.m_sweep.c.y-
d.y);this.m_linearVelocity.y=this.m_linearVelocity.y+this.m_angularVelocity*+(this.m_sweep.c.x-d.x)}};o.prototype.ResetMassData=function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.SetZero();if(!(this.m_type==o.b2_staticBody||this.m_type==o.b2_kinematicBody)){for(var c=e.Make(0,0),d=this.m_fixtureList;d;d=d.m_next)if(d.m_density!=0){var f=d.GetMassData();this.m_mass=this.m_mass+f.mass;c.x=c.x+f.center.x*f.mass;c.y=c.y+f.center.y*f.mass;this.m_I=this.m_I+f.I}if(this.m_mass>
0){this.m_invMass=1/this.m_mass;c.x=c.x*this.m_invMass;c.y=c.y*this.m_invMass}else this.m_invMass=this.m_mass=1;if(this.m_I>0&&(this.m_flags&o.e_fixedRotationFlag)==0){this.m_I=this.m_I-this.m_mass*(c.x*c.x+c.y*c.y);this.m_I=this.m_I*this.m_inertiaScale;g.b2Assert(this.m_I>0);this.m_invI=1/this.m_I}else this.m_invI=this.m_I=0;d=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(c);this.m_sweep.c0.SetV(b.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x=
this.m_linearVelocity.x+this.m_angularVelocity*-(this.m_sweep.c.y-d.y);this.m_linearVelocity.y=this.m_linearVelocity.y+this.m_angularVelocity*+(this.m_sweep.c.x-d.x)}};o.prototype.GetWorldPoint=function(b){var c=this.m_xf.R,b=new e(c.col1.x*b.x+c.col2.x*b.y,c.col1.y*b.x+c.col2.y*b.y);b.x=b.x+this.m_xf.position.x;b.y=b.y+this.m_xf.position.y;return b};o.prototype.GetWorldVector=function(c){return b.MulMV(this.m_xf.R,c)};o.prototype.GetLocalPoint=function(c){return b.MulXT(this.m_xf,c)};o.prototype.GetLocalVector=
function(c){return b.MulTMV(this.m_xf.R,c)};o.prototype.GetLinearVelocityFromWorldPoint=function(b){return new e(this.m_linearVelocity.x-this.m_angularVelocity*(b.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(b.x-this.m_sweep.c.x))};o.prototype.GetLinearVelocityFromLocalPoint=function(b){var c=this.m_xf.R,b=new e(c.col1.x*b.x+c.col2.x*b.y,c.col1.y*b.x+c.col2.y*b.y);b.x=b.x+this.m_xf.position.x;b.y=b.y+this.m_xf.position.y;return new e(this.m_linearVelocity.x-this.m_angularVelocity*
(b.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(b.x-this.m_sweep.c.x))};o.prototype.GetLinearDamping=function(){return this.m_linearDamping};o.prototype.SetLinearDamping=function(b){b===void 0&&(b=0);this.m_linearDamping=b};o.prototype.GetAngularDamping=function(){return this.m_angularDamping};o.prototype.SetAngularDamping=function(b){b===void 0&&(b=0);this.m_angularDamping=b};o.prototype.SetType=function(b){b===void 0&&(b=0);if(this.m_type!=b){this.m_type=b;this.ResetMassData();
if(this.m_type==o.b2_staticBody){this.m_linearVelocity.SetZero();this.m_angularVelocity=0}this.SetAwake(true);this.m_force.SetZero();this.m_torque=0;for(b=this.m_contactList;b;b=b.next)b.contact.FlagForFiltering()}};o.prototype.GetType=function(){return this.m_type};o.prototype.SetBullet=function(b){this.m_flags=b?this.m_flags|o.e_bulletFlag:this.m_flags&~o.e_bulletFlag};o.prototype.IsBullet=function(){return(this.m_flags&o.e_bulletFlag)==o.e_bulletFlag};o.prototype.SetSleepingAllowed=function(b){if(b)this.m_flags=
this.m_flags|o.e_allowSleepFlag;else{this.m_flags=this.m_flags&~o.e_allowSleepFlag;this.SetAwake(true)}};o.prototype.SetAwake=function(b){if(b){this.m_flags=this.m_flags|o.e_awakeFlag;this.m_sleepTime=0}else{this.m_flags=this.m_flags&~o.e_awakeFlag;this.m_sleepTime=0;this.m_linearVelocity.SetZero();this.m_angularVelocity=0;this.m_force.SetZero();this.m_torque=0}};o.prototype.IsAwake=function(){return(this.m_flags&o.e_awakeFlag)==o.e_awakeFlag};o.prototype.SetFixedRotation=function(b){this.m_flags=
b?this.m_flags|o.e_fixedRotationFlag:this.m_flags&~o.e_fixedRotationFlag;this.ResetMassData()};o.prototype.IsFixedRotation=function(){return(this.m_flags&o.e_fixedRotationFlag)==o.e_fixedRotationFlag};o.prototype.SetActive=function(b){if(b!=this.IsActive()){var c;if(b){this.m_flags=this.m_flags|o.e_activeFlag;b=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=c.m_next)c.CreateProxy(b,this.m_xf)}else{this.m_flags=this.m_flags&~o.e_activeFlag;b=this.m_world.m_contactManager.m_broadPhase;
for(c=this.m_fixtureList;c;c=c.m_next)c.DestroyProxy(b);for(b=this.m_contactList;b;){c=b;b=b.next;this.m_world.m_contactManager.Destroy(c.contact)}this.m_contactList=null}}};o.prototype.IsActive=function(){return(this.m_flags&o.e_activeFlag)==o.e_activeFlag};o.prototype.IsSleepingAllowed=function(){return(this.m_flags&o.e_allowSleepFlag)==o.e_allowSleepFlag};o.prototype.GetFixtureList=function(){return this.m_fixtureList};o.prototype.GetJointList=function(){return this.m_jointList};o.prototype.GetControllerList=
function(){return this.m_controllerList};o.prototype.GetContactList=function(){return this.m_contactList};o.prototype.GetNext=function(){return this.m_next};o.prototype.GetUserData=function(){return this.m_userData};o.prototype.SetUserData=function(b){this.m_userData=b};o.prototype.GetWorld=function(){return this.m_world};o.prototype.b2Body=function(b,c){this.m_flags=0;if(b.bullet)this.m_flags=this.m_flags|o.e_bulletFlag;if(b.fixedRotation)this.m_flags=this.m_flags|o.e_fixedRotationFlag;if(b.allowSleep)this.m_flags=
this.m_flags|o.e_allowSleepFlag;if(b.awake)this.m_flags=this.m_flags|o.e_awakeFlag;if(b.active)this.m_flags=this.m_flags|o.e_activeFlag;this.m_world=c;this.m_xf.position.SetV(b.position);this.m_xf.R.Set(b.angle);this.m_sweep.localCenter.SetZero();this.m_sweep.t0=1;this.m_sweep.a0=this.m_sweep.a=b.angle;var d=this.m_xf.R,e=this.m_sweep.localCenter;this.m_sweep.c.x=d.col1.x*e.x+d.col2.x*e.y;this.m_sweep.c.y=d.col1.y*e.x+d.col2.y*e.y;this.m_sweep.c.x=this.m_sweep.c.x+this.m_xf.position.x;this.m_sweep.c.y=
this.m_sweep.c.y+this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_contactList=this.m_controllerList=this.m_jointList=null;this.m_controllerCount=0;this.m_next=this.m_prev=null;this.m_linearVelocity.SetV(b.linearVelocity);this.m_angularVelocity=b.angularVelocity;this.m_linearDamping=b.linearDamping;this.m_angularDamping=b.angularDamping;this.m_force.Set(0,0);this.m_sleepTime=this.m_torque=0;this.m_type=b.type;this.m_invMass=this.m_type==o.b2_dynamicBody?this.m_mass=1:this.m_mass=0;
this.m_invI=this.m_I=0;this.m_inertiaScale=b.inertiaScale;this.m_userData=b.userData;this.m_fixtureList=null;this.m_fixtureCount=0};o.prototype.SynchronizeFixtures=function(){var b=o.s_xf1;b.R.Set(this.m_sweep.a0);var c=b.R,d=this.m_sweep.localCenter;b.position.x=this.m_sweep.c0.x-(c.col1.x*d.x+c.col2.x*d.y);b.position.y=this.m_sweep.c0.y-(c.col1.y*d.x+c.col2.y*d.y);d=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=c.m_next)c.Synchronize(d,b,this.m_xf)};o.prototype.SynchronizeTransform=
function(){this.m_xf.R.Set(this.m_sweep.a);var b=this.m_xf.R,c=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(b.col1.x*c.x+b.col2.x*c.y);this.m_xf.position.y=this.m_sweep.c.y-(b.col1.y*c.x+b.col2.y*c.y)};o.prototype.ShouldCollide=function(b){if(this.m_type!=o.b2_dynamicBody&&b.m_type!=o.b2_dynamicBody)return false;for(var c=this.m_jointList;c;c=c.next)if(c.other==b&&c.joint.m_collideConnected==false)return false;return true};o.prototype.Advance=function(b){b===void 0&&(b=0);this.m_sweep.Advance(b);
this.m_sweep.c.SetV(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.SynchronizeTransform()};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new d;Box2D.Dynamics.b2Body.e_islandFlag=1;Box2D.Dynamics.b2Body.e_awakeFlag=2;Box2D.Dynamics.b2Body.e_allowSleepFlag=4;Box2D.Dynamics.b2Body.e_bulletFlag=8;Box2D.Dynamics.b2Body.e_fixedRotationFlag=16;Box2D.Dynamics.b2Body.e_activeFlag=32;Box2D.Dynamics.b2Body.b2_staticBody=0;Box2D.Dynamics.b2Body.b2_kinematicBody=1;Box2D.Dynamics.b2Body.b2_dynamicBody=
2});t.b2BodyDef=function(){this.position=new e;this.linearVelocity=new e};t.prototype.b2BodyDef=function(){this.userData=null;this.position.Set(0,0);this.angle=0;this.linearVelocity.Set(0,0);this.angularDamping=this.linearDamping=this.angularVelocity=0;this.awake=this.allowSleep=true;this.bullet=this.fixedRotation=false;this.type=o.b2_staticBody;this.active=true;this.inertiaScale=1};u.b2ContactFilter=function(){};u.prototype.ShouldCollide=function(b,c){var d=b.GetFilterData(),e=c.GetFilterData();
return d.groupIndex==e.groupIndex&&d.groupIndex!=0?d.groupIndex>0:(d.maskBits&e.categoryBits)!=0&&(d.categoryBits&e.maskBits)!=0};u.prototype.RayCollide=function(b,c){return!b?true:this.ShouldCollide(b instanceof K?b:null,c)};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new u});w.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(g.b2_maxManifoldPoints);this.tangentImpulses=new Vector_a2j_Number(g.b2_maxManifoldPoints)};z.b2ContactListener=function(){};
z.prototype.BeginContact=function(){};z.prototype.EndContact=function(){};z.prototype.PreSolve=function(){};z.prototype.PostSolve=function(){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new z});A.b2ContactManager=function(){};A.prototype.b2ContactManager=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=u.b2_defaultFilter;this.m_contactListener=z.b2_defaultListener;this.m_contactFactory=new J(this.m_allocator);this.m_broadPhase=new k};
A.prototype.AddPair=function(b,c){var d=b instanceof K?b:null,e=c instanceof K?c:null,f=d.GetBody(),g=e.GetBody();if(f!=g){for(var h=g.GetContactList();h;){if(h.other==f){var j=h.contact.GetFixtureA(),k=h.contact.GetFixtureB();if(j==d&&k==e||j==e&&k==d)return}h=h.next}if(g.ShouldCollide(f)!=false&&this.m_contactFilter.ShouldCollide(d,e)!=false){h=this.m_contactFactory.Create(d,e);d=h.GetFixtureA();e=h.GetFixtureB();f=d.m_body;g=e.m_body;h.m_prev=null;h.m_next=this.m_world.m_contactList;if(this.m_world.m_contactList!=
null)this.m_world.m_contactList.m_prev=h;this.m_world.m_contactList=h;h.m_nodeA.contact=h;h.m_nodeA.other=g;h.m_nodeA.prev=null;h.m_nodeA.next=f.m_contactList;if(f.m_contactList!=null)f.m_contactList.prev=h.m_nodeA;f.m_contactList=h.m_nodeA;h.m_nodeB.contact=h;h.m_nodeB.other=f;h.m_nodeB.prev=null;h.m_nodeB.next=g.m_contactList;if(g.m_contactList!=null)g.m_contactList.prev=h.m_nodeB;g.m_contactList=h.m_nodeB;++this.m_world.m_contactCount}}};A.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,
this.AddPair))};A.prototype.Destroy=function(b){var c=b.GetFixtureA(),d=b.GetFixtureB(),c=c.GetBody(),d=d.GetBody();b.IsTouching()&&this.m_contactListener.EndContact(b);if(b.m_prev)b.m_prev.m_next=b.m_next;if(b.m_next)b.m_next.m_prev=b.m_prev;if(b==this.m_world.m_contactList)this.m_world.m_contactList=b.m_next;if(b.m_nodeA.prev)b.m_nodeA.prev.next=b.m_nodeA.next;if(b.m_nodeA.next)b.m_nodeA.next.prev=b.m_nodeA.prev;if(b.m_nodeA==c.m_contactList)c.m_contactList=b.m_nodeA.next;if(b.m_nodeB.prev)b.m_nodeB.prev.next=
b.m_nodeB.next;if(b.m_nodeB.next)b.m_nodeB.next.prev=b.m_nodeB.prev;if(b.m_nodeB==d.m_contactList)d.m_contactList=b.m_nodeB.next;this.m_contactFactory.Destroy(b);--this.m_contactCount};A.prototype.Collide=function(){for(var b=this.m_world.m_contactList;b;){var c=b.GetFixtureA(),d=b.GetFixtureB(),e=c.GetBody(),f=d.GetBody();if(e.IsAwake()==false&&f.IsAwake()==false)b=b.GetNext();else{if(b.m_flags&I.e_filterFlag){if(f.ShouldCollide(e)==false){c=b;b=c.GetNext();this.Destroy(c);continue}if(this.m_contactFilter.ShouldCollide(c,
d)==false){c=b;b=c.GetNext();this.Destroy(c);continue}b.m_flags=b.m_flags&~I.e_filterFlag}if(this.m_broadPhase.TestOverlap(c.m_proxy,d.m_proxy)==false){c=b;b=c.GetNext();this.Destroy(c)}else{b.Update(this.m_contactListener);b=b.GetNext()}}}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new j});C.b2DebugDraw=function(){};C.prototype.b2DebugDraw=function(){};C.prototype.SetFlags=function(){};C.prototype.GetFlags=function(){};C.prototype.AppendFlags=function(){};C.prototype.ClearFlags=
function(){};C.prototype.SetSprite=function(){};C.prototype.GetSprite=function(){};C.prototype.SetDrawScale=function(){};C.prototype.GetDrawScale=function(){};C.prototype.SetLineThickness=function(){};C.prototype.GetLineThickness=function(){};C.prototype.SetAlpha=function(){};C.prototype.GetAlpha=function(){};C.prototype.SetFillAlpha=function(){};C.prototype.GetFillAlpha=function(){};C.prototype.SetXFormScale=function(){};C.prototype.GetXFormScale=function(){};C.prototype.DrawPolygon=function(){};
C.prototype.DrawSolidPolygon=function(){};C.prototype.DrawCircle=function(){};C.prototype.DrawSolidCircle=function(){};C.prototype.DrawSegment=function(){};C.prototype.DrawTransform=function(){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1;Box2D.Dynamics.b2DebugDraw.e_jointBit=2;Box2D.Dynamics.b2DebugDraw.e_aabbBit=4;Box2D.Dynamics.b2DebugDraw.e_pairBit=8;Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16;Box2D.Dynamics.b2DebugDraw.e_controllerBit=32});G.b2DestructionListener=
function(){};G.prototype.SayGoodbyeJoint=function(){};G.prototype.SayGoodbyeFixture=function(){};H.b2FilterData=function(){this.categoryBits=1;this.maskBits=65535;this.groupIndex=0};H.prototype.Copy=function(){var b=new H;b.categoryBits=this.categoryBits;b.maskBits=this.maskBits;b.groupIndex=this.groupIndex;return b};K.b2Fixture=function(){this.m_filter=new H};K.prototype.GetType=function(){return this.m_shape.GetType()};K.prototype.GetShape=function(){return this.m_shape};K.prototype.SetSensor=function(b){if(this.m_isSensor!=
b){this.m_isSensor=b;if(this.m_body!=null)for(b=this.m_body.GetContactList();b;){var c=b.contact,d=c.GetFixtureA(),e=c.GetFixtureB();if(d==this||e==this)c.SetSensor(d.IsSensor()||e.IsSensor());b=b.next}}};K.prototype.IsSensor=function(){return this.m_isSensor};K.prototype.SetFilterData=function(b){this.m_filter=b.Copy();if(!this.m_body)for(b=this.m_body.GetContactList();b;){var c=b.contact,d=c.GetFixtureA(),e=c.GetFixtureB();(d==this||e==this)&&c.FlagForFiltering();b=b.next}};K.prototype.GetFilterData=
function(){return this.m_filter.Copy()};K.prototype.GetBody=function(){return this.m_body};K.prototype.GetNext=function(){return this.m_next};K.prototype.GetUserData=function(){return this.m_userData};K.prototype.SetUserData=function(b){this.m_userData=b};K.prototype.TestPoint=function(b){return this.m_shape.TestPoint(this.m_body.GetTransform(),b)};K.prototype.RayCast=function(b,c){return this.m_shape.RayCast(b,c,this.m_body.GetTransform())};K.prototype.GetMassData=function(b){b===void 0&&(b=null);
b==null&&(b=new p);this.m_shape.ComputeMass(b,this.m_density);return b};K.prototype.SetDensity=function(b){b===void 0&&(b=0);this.m_density=b};K.prototype.GetDensity=function(){return this.m_density};K.prototype.GetFriction=function(){return this.m_friction};K.prototype.SetFriction=function(b){b===void 0&&(b=0);this.m_friction=b};K.prototype.GetRestitution=function(){return this.m_restitution};K.prototype.SetRestitution=function(b){b===void 0&&(b=0);this.m_restitution=b};K.prototype.GetAABB=function(){return this.m_aabb};
K.prototype.b2Fixture=function(){this.m_aabb=new h;this.m_shape=this.m_next=this.m_body=this.m_userData=null;this.m_restitution=this.m_friction=this.m_density=0};K.prototype.Create=function(b,c,d){this.m_userData=d.userData;this.m_friction=d.friction;this.m_restitution=d.restitution;this.m_body=b;this.m_next=null;this.m_filter=d.filter.Copy();this.m_isSensor=d.isSensor;this.m_shape=d.shape.Copy();this.m_density=d.density};K.prototype.Destroy=function(){this.m_shape=null};K.prototype.CreateProxy=function(b,
c){this.m_shape.ComputeAABB(this.m_aabb,c);this.m_proxy=b.CreateProxy(this.m_aabb,this)};K.prototype.DestroyProxy=function(b){if(this.m_proxy!=null){b.DestroyProxy(this.m_proxy);this.m_proxy=null}};K.prototype.Synchronize=function(c,d,e){if(this.m_proxy){var f=new h,g=new h;this.m_shape.ComputeAABB(f,d);this.m_shape.ComputeAABB(g,e);this.m_aabb.Combine(f,g);d=b.SubtractVV(e.position,d.position);c.MoveProxy(this.m_proxy,this.m_aabb,d)}};P.b2FixtureDef=function(){this.filter=new H};P.prototype.b2FixtureDef=
function(){this.userData=this.shape=null;this.friction=0.2;this.density=this.restitution=0;this.filter.categoryBits=1;this.filter.maskBits=65535;this.filter.groupIndex=0;this.isSensor=false};T.b2Island=function(){};T.prototype.b2Island=function(){this.m_bodies=new Vector;this.m_contacts=new Vector;this.m_joints=new Vector};T.prototype.Initialize=function(b,c,d,e,f,g){b===void 0&&(b=0);c===void 0&&(c=0);d===void 0&&(d=0);var h=0;this.m_bodyCapacity=b;this.m_contactCapacity=c;this.m_jointCapacity=d;
this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=e;this.m_listener=f;this.m_contactSolver=g;for(h=this.m_bodies.length;h<b;h++)this.m_bodies[h]=null;for(h=this.m_contacts.length;h<c;h++)this.m_contacts[h]=null;for(h=this.m_joints.length;h<d;h++)this.m_joints[h]=null};T.prototype.Clear=function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0};T.prototype.Solve=function(c,d,e){for(var f=0,h=0,j,f=0;f<this.m_bodyCount;++f){h=this.m_bodies[f];if(h.GetType()==o.b2_dynamicBody){h.m_linearVelocity.x=
h.m_linearVelocity.x+c.dt*(d.x+h.m_invMass*h.m_force.x);h.m_linearVelocity.y=h.m_linearVelocity.y+c.dt*(d.y+h.m_invMass*h.m_force.y);h.m_angularVelocity=h.m_angularVelocity+c.dt*h.m_invI*h.m_torque;h.m_linearVelocity.Multiply(b.Clamp(1-c.dt*h.m_linearDamping,0,1));h.m_angularVelocity=h.m_angularVelocity*b.Clamp(1-c.dt*h.m_angularDamping,0,1)}}this.m_contactSolver.Initialize(c,this.m_contacts,this.m_contactCount,this.m_allocator);d=this.m_contactSolver;d.InitVelocityConstraints(c);for(f=0;f<this.m_jointCount;++f){j=
this.m_joints[f];j.InitVelocityConstraints(c)}for(f=0;f<c.velocityIterations;++f){for(h=0;h<this.m_jointCount;++h){j=this.m_joints[h];j.SolveVelocityConstraints(c)}d.SolveVelocityConstraints()}for(f=0;f<this.m_jointCount;++f){j=this.m_joints[f];j.FinalizeVelocityConstraints()}d.FinalizeVelocityConstraints();for(f=0;f<this.m_bodyCount;++f){h=this.m_bodies[f];if(h.GetType()!=o.b2_staticBody){var k=c.dt*h.m_linearVelocity.x,l=c.dt*h.m_linearVelocity.y;if(k*k+l*l>g.b2_maxTranslationSquared){h.m_linearVelocity.Normalize();
h.m_linearVelocity.x=h.m_linearVelocity.x*g.b2_maxTranslation*c.inv_dt;h.m_linearVelocity.y=h.m_linearVelocity.y*g.b2_maxTranslation*c.inv_dt}k=c.dt*h.m_angularVelocity;if(k*k>g.b2_maxRotationSquared)h.m_angularVelocity=h.m_angularVelocity<0?-g.b2_maxRotation*c.inv_dt:g.b2_maxRotation*c.inv_dt;h.m_sweep.c0.SetV(h.m_sweep.c);h.m_sweep.a0=h.m_sweep.a;h.m_sweep.c.x=h.m_sweep.c.x+c.dt*h.m_linearVelocity.x;h.m_sweep.c.y=h.m_sweep.c.y+c.dt*h.m_linearVelocity.y;h.m_sweep.a=h.m_sweep.a+c.dt*h.m_angularVelocity;
h.SynchronizeTransform()}}for(f=0;f<c.positionIterations;++f){k=d.SolvePositionConstraints(g.b2_contactBaumgarte);l=true;for(h=0;h<this.m_jointCount;++h){j=this.m_joints[h];j=j.SolvePositionConstraints(g.b2_contactBaumgarte);l=l&&j}if(k&&l)break}this.Report(d.m_constraints);if(e){e=Number.MAX_VALUE;d=g.b2_linearSleepTolerance*g.b2_linearSleepTolerance;k=g.b2_angularSleepTolerance*g.b2_angularSleepTolerance;for(f=0;f<this.m_bodyCount;++f){h=this.m_bodies[f];if(h.GetType()!=o.b2_staticBody){if((h.m_flags&
o.e_allowSleepFlag)==0)e=h.m_sleepTime=0;if((h.m_flags&o.e_allowSleepFlag)==0||h.m_angularVelocity*h.m_angularVelocity>k||b.Dot(h.m_linearVelocity,h.m_linearVelocity)>d)e=h.m_sleepTime=0;else{h.m_sleepTime=h.m_sleepTime+c.dt;e=b.Min(e,h.m_sleepTime)}}}if(e>=g.b2_timeToSleep)for(f=0;f<this.m_bodyCount;++f){h=this.m_bodies[f];h.SetAwake(false)}}};T.prototype.SolveTOI=function(b){var c=0,d=0;this.m_contactSolver.Initialize(b,this.m_contacts,this.m_contactCount,this.m_allocator);for(var e=this.m_contactSolver,
c=0;c<this.m_jointCount;++c)this.m_joints[c].InitVelocityConstraints(b);for(c=0;c<b.velocityIterations;++c){e.SolveVelocityConstraints();for(d=0;d<this.m_jointCount;++d)this.m_joints[d].SolveVelocityConstraints(b)}for(c=0;c<this.m_bodyCount;++c){d=this.m_bodies[c];if(d.GetType()!=o.b2_staticBody){var f=b.dt*d.m_linearVelocity.x,h=b.dt*d.m_linearVelocity.y;if(f*f+h*h>g.b2_maxTranslationSquared){d.m_linearVelocity.Normalize();d.m_linearVelocity.x=d.m_linearVelocity.x*g.b2_maxTranslation*b.inv_dt;d.m_linearVelocity.y=
d.m_linearVelocity.y*g.b2_maxTranslation*b.inv_dt}f=b.dt*d.m_angularVelocity;if(f*f>g.b2_maxRotationSquared)d.m_angularVelocity=d.m_angularVelocity<0?-g.b2_maxRotation*b.inv_dt:g.b2_maxRotation*b.inv_dt;d.m_sweep.c0.SetV(d.m_sweep.c);d.m_sweep.a0=d.m_sweep.a;d.m_sweep.c.x=d.m_sweep.c.x+b.dt*d.m_linearVelocity.x;d.m_sweep.c.y=d.m_sweep.c.y+b.dt*d.m_linearVelocity.y;d.m_sweep.a=d.m_sweep.a+b.dt*d.m_angularVelocity;d.SynchronizeTransform()}}for(c=0;c<b.positionIterations;++c){f=e.SolvePositionConstraints(0.75);
h=true;for(d=0;d<this.m_jointCount;++d)var j=this.m_joints[d].SolvePositionConstraints(g.b2_contactBaumgarte),h=h&&j;if(f&&h)break}this.Report(e.m_constraints)};T.prototype.Report=function(b){if(this.m_listener!=null)for(var c=0;c<this.m_contactCount;++c){for(var d=this.m_contacts[c],e=b[c],f=0;f<e.pointCount;++f){T.s_impulse.normalImpulses[f]=e.points[f].normalImpulse;T.s_impulse.tangentImpulses[f]=e.points[f].tangentImpulse}this.m_listener.PostSolve(d,T.s_impulse)}};T.prototype.AddBody=function(b){b.m_islandIndex=
this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=b};T.prototype.AddContact=function(b){this.m_contacts[this.m_contactCount++]=b};T.prototype.AddJoint=function(b){this.m_joints[this.m_jointCount++]=b};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new w});D.b2TimeStep=function(){};D.prototype.Set=function(b){this.dt=b.dt;this.inv_dt=b.inv_dt;this.positionIterations=b.positionIterations;this.velocityIterations=b.velocityIterations;this.warmStarting=b.warmStarting};F.b2World=function(){this.s_stack=
new Vector;this.m_contactManager=new A;this.m_contactSolver=new N;this.m_island=new T};F.prototype.b2World=function(b,c){this.m_controllerList=this.m_jointList=this.m_contactList=this.m_bodyList=this.m_debugDraw=this.m_destructionListener=null;this.m_controllerCount=this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;F.m_warmStarting=true;F.m_continuousPhysics=true;this.m_allowSleep=c;this.m_gravity=b;this.m_inv_dt0=0;this.m_contactManager.m_world=this;this.m_groundBody=this.CreateBody(new t)};
F.prototype.SetDestructionListener=function(b){this.m_destructionListener=b};F.prototype.SetContactFilter=function(b){this.m_contactManager.m_contactFilter=b};F.prototype.SetContactListener=function(b){this.m_contactManager.m_contactListener=b};F.prototype.SetDebugDraw=function(b){this.m_debugDraw=b};F.prototype.SetBroadPhase=function(b){var c=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=b;for(var d=this.m_bodyList;d;d=d.m_next)for(var e=d.m_fixtureList;e;e=e.m_next)e.m_proxy=
b.CreateProxy(c.GetFatAABB(e.m_proxy),e)};F.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()};F.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()};F.prototype.CreateBody=function(b){if(this.IsLocked()==true)return null;b=new o(b,this);b.m_prev=null;if(b.m_next=this.m_bodyList)this.m_bodyList.m_prev=b;this.m_bodyList=b;++this.m_bodyCount;return b};F.prototype.DestroyBody=function(b){if(this.IsLocked()!=true){for(var c=b.m_jointList;c;){var d=
c,c=c.next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(d.joint);this.DestroyJoint(d.joint)}for(c=b.m_controllerList;c;){d=c;c=c.nextController;d.controller.RemoveBody(b)}for(c=b.m_contactList;c;){d=c;c=c.next;this.m_contactManager.Destroy(d.contact)}b.m_contactList=null;for(c=b.m_fixtureList;c;){d=c;c=c.m_next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(d);d.DestroyProxy(this.m_contactManager.m_broadPhase);d.Destroy()}b.m_fixtureList=null;b.m_fixtureCount=
0;if(b.m_prev)b.m_prev.m_next=b.m_next;if(b.m_next)b.m_next.m_prev=b.m_prev;if(b==this.m_bodyList)this.m_bodyList=b.m_next;--this.m_bodyCount}};F.prototype.CreateJoint=function(b){var c=U.Create(b,null);c.m_prev=null;if(c.m_next=this.m_jointList)this.m_jointList.m_prev=c;this.m_jointList=c;++this.m_jointCount;c.m_edgeA.joint=c;c.m_edgeA.other=c.m_bodyB;c.m_edgeA.prev=null;if(c.m_edgeA.next=c.m_bodyA.m_jointList)c.m_bodyA.m_jointList.prev=c.m_edgeA;c.m_bodyA.m_jointList=c.m_edgeA;c.m_edgeB.joint=c;
c.m_edgeB.other=c.m_bodyA;c.m_edgeB.prev=null;if(c.m_edgeB.next=c.m_bodyB.m_jointList)c.m_bodyB.m_jointList.prev=c.m_edgeB;c.m_bodyB.m_jointList=c.m_edgeB;var d=b.bodyA,e=b.bodyB;if(b.collideConnected==false)for(b=e.GetContactList();b;){b.other==d&&b.contact.FlagForFiltering();b=b.next}return c};F.prototype.DestroyJoint=function(b){var c=b.m_collideConnected;if(b.m_prev)b.m_prev.m_next=b.m_next;if(b.m_next)b.m_next.m_prev=b.m_prev;if(b==this.m_jointList)this.m_jointList=b.m_next;var d=b.m_bodyA,e=
b.m_bodyB;d.SetAwake(true);e.SetAwake(true);if(b.m_edgeA.prev)b.m_edgeA.prev.next=b.m_edgeA.next;if(b.m_edgeA.next)b.m_edgeA.next.prev=b.m_edgeA.prev;if(b.m_edgeA==d.m_jointList)d.m_jointList=b.m_edgeA.next;b.m_edgeA.prev=null;b.m_edgeA.next=null;if(b.m_edgeB.prev)b.m_edgeB.prev.next=b.m_edgeB.next;if(b.m_edgeB.next)b.m_edgeB.next.prev=b.m_edgeB.prev;if(b.m_edgeB==e.m_jointList)e.m_jointList=b.m_edgeB.next;b.m_edgeB.prev=null;b.m_edgeB.next=null;U.Destroy(b,null);--this.m_jointCount;if(c==false)for(b=
e.GetContactList();b;){b.other==d&&b.contact.FlagForFiltering();b=b.next}};F.prototype.AddController=function(b){b.m_next=this.m_controllerList;b.m_prev=null;this.m_controllerList=b;b.m_world=this;this.m_controllerCount++;return b};F.prototype.RemoveController=function(b){if(b.m_prev)b.m_prev.m_next=b.m_next;if(b.m_next)b.m_next.m_prev=b.m_prev;if(this.m_controllerList==b)this.m_controllerList=b.m_next;this.m_controllerCount--};F.prototype.CreateController=function(b){if(b.m_world!=this)throw Error("Controller can only be a member of one world");
b.m_next=this.m_controllerList;b.m_prev=null;if(this.m_controllerList)this.m_controllerList.m_prev=b;this.m_controllerList=b;++this.m_controllerCount;b.m_world=this;return b};F.prototype.DestroyController=function(b){b.Clear();if(b.m_next)b.m_next.m_prev=b.m_prev;if(b.m_prev)b.m_prev.m_next=b.m_next;if(b==this.m_controllerList)this.m_controllerList=b.m_next;--this.m_controllerCount};F.prototype.SetWarmStarting=function(b){F.m_warmStarting=b};F.prototype.SetContinuousPhysics=function(b){F.m_continuousPhysics=
b};F.prototype.GetBodyCount=function(){return this.m_bodyCount};F.prototype.GetJointCount=function(){return this.m_jointCount};F.prototype.GetContactCount=function(){return this.m_contactCount};F.prototype.SetGravity=function(b){this.m_gravity=b};F.prototype.GetGravity=function(){return this.m_gravity};F.prototype.GetGroundBody=function(){return this.m_groundBody};F.prototype.Step=function(b,c,d){b===void 0&&(b=0);c===void 0&&(c=0);d===void 0&&(d=0);if(this.m_flags&F.e_newFixture){this.m_contactManager.FindNewContacts();
this.m_flags=this.m_flags&~F.e_newFixture}this.m_flags=this.m_flags|F.e_locked;var e=F.s_timestep2;e.dt=b;e.velocityIterations=c;e.positionIterations=d;e.inv_dt=b>0?1/b:0;e.dtRatio=this.m_inv_dt0*b;e.warmStarting=F.m_warmStarting;this.m_contactManager.Collide();e.dt>0&&this.Solve(e);F.m_continuousPhysics&&e.dt>0&&this.SolveTOI(e);if(e.dt>0)this.m_inv_dt0=e.inv_dt;this.m_flags=this.m_flags&~F.e_locked};F.prototype.ClearForces=function(){for(var b=this.m_bodyList;b;b=b.m_next){b.m_force.SetZero();b.m_torque=
0}};F.prototype.DrawDebugData=function(){if(this.m_debugDraw!=null){this.m_debugDraw.m_sprite.graphics.clear();var b=this.m_debugDraw.GetFlags(),c,d,g;new e;new e;new e;var j;new h;new h;new e;new e;new e;new e;var k=new f(0,0,0);if(b&C.e_shapeBit)for(c=this.m_bodyList;c;c=c.m_next){j=c.m_xf;for(d=c.GetFixtureList();d;d=d.m_next){g=d.GetShape();c.IsActive()==false?k.Set(0.5,0.5,0.3):c.GetType()==o.b2_staticBody?k.Set(0.5,0.9,0.5):c.GetType()==o.b2_kinematicBody?k.Set(0.5,0.5,0.9):c.IsAwake()==false?
k.Set(0.6,0.6,0.6):k.Set(0.9,0.7,0.7);this.DrawShape(g,j,k)}}if(b&C.e_jointBit)for(c=this.m_jointList;c;c=c.m_next)this.DrawJoint(c);if(b&C.e_controllerBit)for(c=this.m_controllerList;c;c=c.m_next)c.Draw(this.m_debugDraw);if(b&C.e_pairBit){k.Set(0.3,0.9,0.9);for(c=this.m_contactManager.m_contactList;c;c=c.GetNext()){g=c.GetFixtureA();d=c.GetFixtureB();g=g.GetAABB().GetCenter();d=d.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(g,d,k)}}if(b&C.e_aabbBit){g=this.m_contactManager.m_broadPhase;j=[new e,
new e,new e,new e];for(c=this.m_bodyList;c;c=c.GetNext())if(c.IsActive()!=false)for(d=c.GetFixtureList();d;d=d.GetNext()){var l=g.GetFatAABB(d.m_proxy);j[0].Set(l.lowerBound.x,l.lowerBound.y);j[1].Set(l.upperBound.x,l.lowerBound.y);j[2].Set(l.upperBound.x,l.upperBound.y);j[3].Set(l.lowerBound.x,l.upperBound.y);this.m_debugDraw.DrawPolygon(j,4,k)}}if(b&C.e_centerOfMassBit)for(c=this.m_bodyList;c;c=c.m_next){j=F.s_xf;j.R=c.m_xf.R;j.position=c.GetWorldCenter();this.m_debugDraw.DrawTransform(j)}}};F.prototype.QueryAABB=
function(b,c){var d=this.m_contactManager.m_broadPhase;d.Query(function(c){return b(d.GetUserData(c))},c)};F.prototype.QueryShape=function(b,c,e){e===void 0&&(e=null);if(e==null){e=new d;e.SetIdentity()}var f=this.m_contactManager.m_broadPhase,g=new h;c.ComputeAABB(g,e);f.Query(function(d){d=f.GetUserData(d)instanceof K?f.GetUserData(d):null;return r.TestOverlap(c,e,d.GetShape(),d.GetBody().GetTransform())?b(d):true},g)};F.prototype.QueryPoint=function(b,c){var d=this.m_contactManager.m_broadPhase,
e=new h;e.lowerBound.Set(c.x-g.b2_linearSlop,c.y-g.b2_linearSlop);e.upperBound.Set(c.x+g.b2_linearSlop,c.y+g.b2_linearSlop);d.Query(function(e){e=d.GetUserData(e)instanceof K?d.GetUserData(e):null;return e.TestPoint(c)?b(e):true},e)};F.prototype.RayCast=function(b,c,d){var f=this.m_contactManager.m_broadPhase,g=new m,h=new l(c,d);f.RayCast(function(h,j){var k=f.GetUserData(j),k=k instanceof K?k:null;if(k.RayCast(g,h)){var l=g.fraction,m=new e((1-l)*c.x+l*d.x,(1-l)*c.y+l*d.y);return b(k,m,g.normal,
l)}return h.maxFraction},h)};F.prototype.RayCastOne=function(b,c){var d;this.RayCast(function(b,c,e,f){f===void 0&&(f=0);d=b;return f},b,c);return d};F.prototype.RayCastAll=function(b,c){var d=new Vector;this.RayCast(function(b){d[d.length]=b;return 1},b,c);return d};F.prototype.GetBodyList=function(){return this.m_bodyList};F.prototype.GetJointList=function(){return this.m_jointList};F.prototype.GetContactList=function(){return this.m_contactList};F.prototype.IsLocked=function(){return(this.m_flags&
F.e_locked)>0};F.prototype.Solve=function(b){for(var c,d=this.m_controllerList;d;d=d.m_next)d.Step(b);d=this.m_island;d.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(c=this.m_bodyList;c;c=c.m_next)c.m_flags=c.m_flags&~o.e_islandFlag;for(var e=this.m_contactList;e;e=e.m_next)e.m_flags=e.m_flags&~I.e_islandFlag;for(e=this.m_jointList;e;e=e.m_next)e.m_islandFlag=false;parseInt(this.m_bodyCount);for(var e=this.s_stack,
f=this.m_bodyList;f;f=f.m_next)if(!(f.m_flags&o.e_islandFlag)&&!(f.IsAwake()==false||f.IsActive()==false)&&f.GetType()!=o.b2_staticBody){d.Clear();var g=0;e[g++]=f;for(f.m_flags=f.m_flags|o.e_islandFlag;g>0;){c=e[--g];d.AddBody(c);c.IsAwake()==false&&c.SetAwake(true);if(c.GetType()!=o.b2_staticBody){for(var h,j=c.m_contactList;j;j=j.next)if(!(j.contact.m_flags&I.e_islandFlag)&&!(j.contact.IsSensor()==true||j.contact.IsEnabled()==false||j.contact.IsTouching()==false)){d.AddContact(j.contact);j.contact.m_flags=
j.contact.m_flags|I.e_islandFlag;h=j.other;if(!(h.m_flags&o.e_islandFlag)){e[g++]=h;h.m_flags=h.m_flags|o.e_islandFlag}}for(c=c.m_jointList;c;c=c.next)if(c.joint.m_islandFlag!=true){h=c.other;if(h.IsActive()!=false){d.AddJoint(c.joint);c.joint.m_islandFlag=true;if(!(h.m_flags&o.e_islandFlag)){e[g++]=h;h.m_flags=h.m_flags|o.e_islandFlag}}}}}d.Solve(b,this.m_gravity,this.m_allowSleep);for(g=0;g<d.m_bodyCount;++g){c=d.m_bodies[g];if(c.GetType()==o.b2_staticBody)c.m_flags=c.m_flags&~o.e_islandFlag}}for(g=
0;g<e.length;++g){if(!e[g])break;e[g]=null}for(c=this.m_bodyList;c;c=c.m_next)c.IsAwake()==false||c.IsActive()==false||c.GetType()!=o.b2_staticBody&&c.SynchronizeFixtures();this.m_contactManager.FindNewContacts()};F.prototype.SolveTOI=function(b){var c,d,e,f=this.m_island;f.Initialize(this.m_bodyCount,g.b2_maxTOIContactsPerIsland,g.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var h=F.s_queue;for(c=this.m_bodyList;c;c=c.m_next){c.m_flags=c.m_flags&~o.e_islandFlag;
c.m_sweep.t0=0}for(e=this.m_contactList;e;e=e.m_next)e.m_flags=e.m_flags&~(I.e_toiFlag|I.e_islandFlag);for(e=this.m_jointList;e;e=e.m_next)e.m_islandFlag=false;for(;;){var j=null,k=1;for(e=this.m_contactList;e;e=e.m_next)if(!(e.IsSensor()==true||e.IsEnabled()==false||e.IsContinuous()==false)){if(e.m_flags&I.e_toiFlag)c=e.m_toi;else{c=e.m_fixtureA;d=e.m_fixtureB;c=c.m_body;d=d.m_body;if((c.GetType()!=o.b2_dynamicBody||c.IsAwake()==false)&&(d.GetType()!=o.b2_dynamicBody||d.IsAwake()==false))continue;
var l=c.m_sweep.t0;if(c.m_sweep.t0<d.m_sweep.t0){l=d.m_sweep.t0;c.m_sweep.Advance(l)}else if(d.m_sweep.t0<c.m_sweep.t0){l=c.m_sweep.t0;d.m_sweep.Advance(l)}c=e.ComputeTOI(c.m_sweep,d.m_sweep);g.b2Assert(0<=c&&c<=1);if(c>0&&c<1){c=(1-c)*l+c;c>1&&(c=1)}e.m_toi=c;e.m_flags=e.m_flags|I.e_toiFlag}if(Number.MIN_VALUE<c&&c<k){j=e;k=c}}if(j==null||1-100*Number.MIN_VALUE<k)break;c=j.m_fixtureA;d=j.m_fixtureB;c=c.m_body;d=d.m_body;F.s_backupA.Set(c.m_sweep);F.s_backupB.Set(d.m_sweep);c.Advance(k);d.Advance(k);
j.Update(this.m_contactManager.m_contactListener);j.m_flags=j.m_flags&~I.e_toiFlag;if(j.IsSensor()==true||j.IsEnabled()==false){c.m_sweep.Set(F.s_backupA);d.m_sweep.Set(F.s_backupB);c.SynchronizeTransform();d.SynchronizeTransform()}else if(j.IsTouching()!=false){c.GetType()!=o.b2_dynamicBody&&(c=d);f.Clear();j=e=0;h[e+j++]=c;for(c.m_flags=c.m_flags|o.e_islandFlag;j>0;){c=h[e++];--j;f.AddBody(c);c.IsAwake()==false&&c.SetAwake(true);if(c.GetType()==o.b2_dynamicBody){for(d=c.m_contactList;d;d=d.next){if(f.m_contactCount==
f.m_contactCapacity)break;if(!(d.contact.m_flags&I.e_islandFlag)&&!(d.contact.IsSensor()==true||d.contact.IsEnabled()==false||d.contact.IsTouching()==false)){f.AddContact(d.contact);d.contact.m_flags=d.contact.m_flags|I.e_islandFlag;l=d.other;if(!(l.m_flags&o.e_islandFlag)){if(l.GetType()!=o.b2_staticBody){l.Advance(k);l.SetAwake(true)}h[e+j]=l;++j;l.m_flags=l.m_flags|o.e_islandFlag}}}for(c=c.m_jointList;c;c=c.next)if(f.m_jointCount!=f.m_jointCapacity&&c.joint.m_islandFlag!=true){l=c.other;if(l.IsActive()!=
false){f.AddJoint(c.joint);c.joint.m_islandFlag=true;if(!(l.m_flags&o.e_islandFlag)){if(l.GetType()!=o.b2_staticBody){l.Advance(k);l.SetAwake(true)}h[e+j]=l;++j;l.m_flags=l.m_flags|o.e_islandFlag}}}}}e=F.s_timestep;e.warmStarting=false;e.dt=(1-k)*b.dt;e.inv_dt=1/e.dt;e.dtRatio=0;e.velocityIterations=b.velocityIterations;e.positionIterations=b.positionIterations;f.SolveTOI(e);for(k=k=0;k<f.m_bodyCount;++k){c=f.m_bodies[k];c.m_flags=c.m_flags&~o.e_islandFlag;if(c.IsAwake()!=false&&c.GetType()==o.b2_dynamicBody){c.SynchronizeFixtures();
for(d=c.m_contactList;d;d=d.next)d.contact.m_flags=d.contact.m_flags&~I.e_toiFlag}}for(k=0;k<f.m_contactCount;++k){e=f.m_contacts[k];e.m_flags=e.m_flags&~(I.e_toiFlag|I.e_islandFlag)}for(k=0;k<f.m_jointCount;++k){e=f.m_joints[k];e.m_islandFlag=false}this.m_contactManager.FindNewContacts()}}};F.prototype.DrawJoint=function(b){var c=b.GetBodyA(),d=b.GetBodyB(),e=c.m_xf.position,f=d.m_xf.position,g=b.GetAnchorA(),h=b.GetAnchorB(),j=F.s_jointColor;switch(b.m_type){case U.e_distanceJoint:this.m_debugDraw.DrawSegment(g,
h,j);break;case U.e_pulleyJoint:c=b instanceof Q?b:null;b=c.GetGroundAnchorA();c=c.GetGroundAnchorB();this.m_debugDraw.DrawSegment(b,g,j);this.m_debugDraw.DrawSegment(c,h,j);this.m_debugDraw.DrawSegment(b,c,j);break;case U.e_mouseJoint:this.m_debugDraw.DrawSegment(g,h,j);break;default:c!=this.m_groundBody&&this.m_debugDraw.DrawSegment(e,g,j);this.m_debugDraw.DrawSegment(g,h,j);d!=this.m_groundBody&&this.m_debugDraw.DrawSegment(f,h,j)}};F.prototype.DrawShape=function(c,d,e){switch(c.m_type){case r.e_circleShape:var f=
c instanceof n?c:null;this.m_debugDraw.DrawSolidCircle(b.MulX(d,f.m_p),f.m_radius,d.R.col1,e);break;case r.e_polygonShape:for(var f=c instanceof s?c:null,c=parseInt(f.GetVertexCount()),g=f.GetVertices(),h=new Vector(c),f=0;f<c;++f)h[f]=b.MulX(d,g[f]);this.m_debugDraw.DrawSolidPolygon(h,c,e);break;case r.e_edgeShape:f=c instanceof q?c:null;this.m_debugDraw.DrawSegment(b.MulX(d,f.GetVertex1()),b.MulX(d,f.GetVertex2()),e)}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new D;Box2D.Dynamics.b2World.s_xf=
new d;Box2D.Dynamics.b2World.s_backupA=new c;Box2D.Dynamics.b2World.s_backupB=new c;Box2D.Dynamics.b2World.s_timestep=new D;Box2D.Dynamics.b2World.s_queue=new Vector;Box2D.Dynamics.b2World.s_jointColor=new f(0.5,0.8,0.8);Box2D.Dynamics.b2World.e_newFixture=1;Box2D.Dynamics.b2World.e_locked=2})})();
(function(){var b=Box2D.Collision.Shapes.b2CircleShape,c=Box2D.Collision.Shapes.b2EdgeShape,d=Box2D.Collision.Shapes.b2PolygonShape,e=Box2D.Collision.Shapes.b2Shape,f=Box2D.Dynamics.Contacts.b2CircleContact,g=Box2D.Dynamics.Contacts.b2Contact,h=Box2D.Dynamics.Contacts.b2ContactConstraint,j=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,k=Box2D.Dynamics.Contacts.b2ContactEdge,l=Box2D.Dynamics.Contacts.b2ContactFactory,m=Box2D.Dynamics.Contacts.b2ContactRegister,n=Box2D.Dynamics.Contacts.b2ContactResult,
q=Box2D.Dynamics.Contacts.b2ContactSolver,p=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,s=Box2D.Dynamics.Contacts.b2NullContact,r=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,o=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,t=Box2D.Dynamics.Contacts.b2PolygonContact,u=Box2D.Dynamics.Contacts.b2PositionSolverManifold,w=Box2D.Dynamics.b2Body,z=Box2D.Dynamics.b2TimeStep,A=Box2D.Common.b2Settings,C=Box2D.Common.Math.b2Mat22,G=Box2D.Common.Math.b2Math,H=Box2D.Common.Math.b2Vec2,K=Box2D.Collision.b2Collision,
P=Box2D.Collision.b2ContactID,T=Box2D.Collision.b2Manifold,D=Box2D.Collision.b2TimeOfImpact,F=Box2D.Collision.b2TOIInput,I=Box2D.Collision.b2WorldManifold;Box2D.inherit(f,Box2D.Dynamics.Contacts.b2Contact);f.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;f.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};f.Create=function(){return new f};f.Destroy=function(){};f.prototype.Reset=function(b,c){this.__super.Reset.call(this,b,c)};f.prototype.Evaluate=
function(){var c=this.m_fixtureA.GetBody(),d=this.m_fixtureB.GetBody();K.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof b?this.m_fixtureA.GetShape():null,c.m_xf,this.m_fixtureB.GetShape()instanceof b?this.m_fixtureB.GetShape():null,d.m_xf)};g.b2Contact=function(){this.m_nodeA=new k;this.m_nodeB=new k;this.m_manifold=new T;this.m_oldManifold=new T};g.prototype.GetManifold=function(){return this.m_manifold};g.prototype.GetWorldManifold=function(b){var c=this.m_fixtureA.GetBody(),
d=this.m_fixtureB.GetBody(),e=this.m_fixtureA.GetShape(),f=this.m_fixtureB.GetShape();b.Initialize(this.m_manifold,c.GetTransform(),e.m_radius,d.GetTransform(),f.m_radius)};g.prototype.IsTouching=function(){return(this.m_flags&g.e_touchingFlag)==g.e_touchingFlag};g.prototype.IsContinuous=function(){return(this.m_flags&g.e_continuousFlag)==g.e_continuousFlag};g.prototype.SetSensor=function(b){this.m_flags=b?this.m_flags|g.e_sensorFlag:this.m_flags&~g.e_sensorFlag};g.prototype.IsSensor=function(){return(this.m_flags&
g.e_sensorFlag)==g.e_sensorFlag};g.prototype.SetEnabled=function(b){this.m_flags=b?this.m_flags|g.e_enabledFlag:this.m_flags&~g.e_enabledFlag};g.prototype.IsEnabled=function(){return(this.m_flags&g.e_enabledFlag)==g.e_enabledFlag};g.prototype.GetNext=function(){return this.m_next};g.prototype.GetFixtureA=function(){return this.m_fixtureA};g.prototype.GetFixtureB=function(){return this.m_fixtureB};g.prototype.FlagForFiltering=function(){this.m_flags=this.m_flags|g.e_filterFlag};g.prototype.b2Contact=
function(){};g.prototype.Reset=function(b,c){b===void 0&&(b=null);c===void 0&&(c=null);this.m_flags=g.e_enabledFlag;if(!b||!c)this.m_fixtureB=this.m_fixtureA=null;else{if(b.IsSensor()||c.IsSensor())this.m_flags=this.m_flags|g.e_sensorFlag;var d=b.GetBody(),e=c.GetBody();if(d.GetType()!=w.b2_dynamicBody||d.IsBullet()||e.GetType()!=w.b2_dynamicBody||e.IsBullet())this.m_flags=this.m_flags|g.e_continuousFlag;this.m_fixtureA=b;this.m_fixtureB=c;this.m_manifold.m_pointCount=0;this.m_next=this.m_prev=null;
this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null}};g.prototype.Update=function(b){var c=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=c;this.m_flags=this.m_flags|g.e_enabledFlag;var d=false,c=(this.m_flags&g.e_touchingFlag)==g.e_touchingFlag,f=this.m_fixtureA.m_body,h=this.m_fixtureB.m_body,j=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);
if(this.m_flags&g.e_sensorFlag){if(j){d=this.m_fixtureA.GetShape();j=this.m_fixtureB.GetShape();f=f.GetTransform();h=h.GetTransform();d=e.TestOverlap(d,f,j,h)}this.m_manifold.m_pointCount=0}else{this.m_flags=f.GetType()!=w.b2_dynamicBody||f.IsBullet()||h.GetType()!=w.b2_dynamicBody||h.IsBullet()?this.m_flags|g.e_continuousFlag:this.m_flags&~g.e_continuousFlag;if(j){this.Evaluate();d=this.m_manifold.m_pointCount>0;for(j=0;j<this.m_manifold.m_pointCount;++j){var k=this.m_manifold.m_points[j];k.m_normalImpulse=
0;k.m_tangentImpulse=0;for(var l=k.m_id,m=0;m<this.m_oldManifold.m_pointCount;++m){var o=this.m_oldManifold.m_points[m];if(o.m_id.key==l.key){k.m_normalImpulse=o.m_normalImpulse;k.m_tangentImpulse=o.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;if(d!=c){f.SetAwake(true);h.SetAwake(true)}}this.m_flags=d?this.m_flags|g.e_touchingFlag:this.m_flags&~g.e_touchingFlag;c==false&&d==true&&b.BeginContact(this);c==true&&d==false&&b.EndContact(this);(this.m_flags&g.e_sensorFlag)==0&&b.PreSolve(this,
this.m_oldManifold)};g.prototype.Evaluate=function(){};g.prototype.ComputeTOI=function(b,c){g.s_input.proxyA.Set(this.m_fixtureA.GetShape());g.s_input.proxyB.Set(this.m_fixtureB.GetShape());g.s_input.sweepA=b;g.s_input.sweepB=c;g.s_input.tolerance=A.b2_linearSlop;return D.TimeOfImpact(g.s_input)};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1;Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2;Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4;Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=
8;Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16;Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32;Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64;Box2D.Dynamics.Contacts.b2Contact.s_input=new F});h.b2ContactConstraint=function(){this.localPlaneNormal=new H;this.localPoint=new H;this.normal=new H;this.normalMass=new C;this.K=new C};h.prototype.b2ContactConstraint=function(){this.points=new Vector(A.b2_maxManifoldPoints);for(var b=0;b<A.b2_maxManifoldPoints;b++)this.points[b]=new j};j.b2ContactConstraintPoint=
function(){this.localPoint=new H;this.rA=new H;this.rB=new H};k.b2ContactEdge=function(){};l.b2ContactFactory=function(){};l.prototype.b2ContactFactory=function(b){this.m_allocator=b;this.InitializeRegisters()};l.prototype.AddType=function(b,c,d,e){d===void 0&&(d=0);e===void 0&&(e=0);this.m_registers[d][e].createFcn=b;this.m_registers[d][e].destroyFcn=c;this.m_registers[d][e].primary=true;if(d!=e){this.m_registers[e][d].createFcn=b;this.m_registers[e][d].destroyFcn=c;this.m_registers[e][d].primary=
false}};l.prototype.InitializeRegisters=function(){this.m_registers=new Vector(e.e_shapeTypeCount);for(var b=0;b<e.e_shapeTypeCount;b++){this.m_registers[b]=new Vector(e.e_shapeTypeCount);for(var c=0;c<e.e_shapeTypeCount;c++)this.m_registers[b][c]=new m}this.AddType(f.Create,f.Destroy,e.e_circleShape,e.e_circleShape);this.AddType(r.Create,r.Destroy,e.e_polygonShape,e.e_circleShape);this.AddType(t.Create,t.Destroy,e.e_polygonShape,e.e_polygonShape);this.AddType(p.Create,p.Destroy,e.e_edgeShape,e.e_circleShape);
this.AddType(o.Create,o.Destroy,e.e_polygonShape,e.e_edgeShape)};l.prototype.Create=function(b,c){var d=parseInt(b.GetType()),e=parseInt(c.GetType()),d=this.m_registers[d][e];if(d.pool){e=d.pool;d.pool=e.m_next;d.poolCount--;e.Reset(b,c);return e}e=d.createFcn;if(e!=null){if(d.primary){e=e(this.m_allocator);e.Reset(b,c)}else{e=e(this.m_allocator);e.Reset(c,b)}return e}return null};l.prototype.Destroy=function(b){if(b.m_manifold.m_pointCount>0){b.m_fixtureA.m_body.SetAwake(true);b.m_fixtureB.m_body.SetAwake(true)}var c=
parseInt(b.m_fixtureA.GetType()),d=parseInt(b.m_fixtureB.GetType()),c=this.m_registers[c][d];c.poolCount++;b.m_next=c.pool;c.pool=b;c=c.destroyFcn;c(b,this.m_allocator)};m.b2ContactRegister=function(){};n.b2ContactResult=function(){this.position=new H;this.normal=new H;this.id=new P};q.b2ContactSolver=function(){this.m_step=new z;this.m_constraints=new Vector};q.prototype.b2ContactSolver=function(){};q.prototype.Initialize=function(b,c,d,e){d===void 0&&(d=0);var f;this.m_step.Set(b);this.m_allocator=
e;for(this.m_constraintCount=d;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new h;for(b=0;b<d;++b){f=c[b];var e=f.m_fixtureA,g=f.m_fixtureB,j=e.m_shape.m_radius,k=g.m_shape.m_radius,l=e.m_body,m=g.m_body,o=f.GetManifold(),n=A.b2MixFriction(e.GetFriction(),g.GetFriction()),s=A.b2MixRestitution(e.GetRestitution(),g.GetRestitution()),p=l.m_linearVelocity.x,t=l.m_linearVelocity.y,r=m.m_linearVelocity.x,u=m.m_linearVelocity.y,D=l.m_angularVelocity,w=m.m_angularVelocity;
A.b2Assert(o.m_pointCount>0);q.s_worldManifold.Initialize(o,l.m_xf,j,m.m_xf,k);g=q.s_worldManifold.m_normal.x;f=q.s_worldManifold.m_normal.y;e=this.m_constraints[b];e.bodyA=l;e.bodyB=m;e.manifold=o;e.normal.x=g;e.normal.y=f;e.pointCount=o.m_pointCount;e.friction=n;e.restitution=s;e.localPlaneNormal.x=o.m_localPlaneNormal.x;e.localPlaneNormal.y=o.m_localPlaneNormal.y;e.localPoint.x=o.m_localPoint.x;e.localPoint.y=o.m_localPoint.y;e.radius=j+k;e.type=o.m_type;for(j=0;j<e.pointCount;++j){n=o.m_points[j];
k=e.points[j];k.normalImpulse=n.m_normalImpulse;k.tangentImpulse=n.m_tangentImpulse;k.localPoint.SetV(n.m_localPoint);var n=k.rA.x=q.s_worldManifold.m_points[j].x-l.m_sweep.c.x,s=k.rA.y=q.s_worldManifold.m_points[j].y-l.m_sweep.c.y,F=k.rB.x=q.s_worldManifold.m_points[j].x-m.m_sweep.c.x,z=k.rB.y=q.s_worldManifold.m_points[j].y-m.m_sweep.c.y,I=n*f-s*g,C=F*f-z*g,I=I*I,C=C*C;k.normalMass=1/(l.m_invMass+m.m_invMass+l.m_invI*I+m.m_invI*C);var G=l.m_mass*l.m_invMass+m.m_mass*m.m_invMass,G=G+(l.m_mass*l.m_invI*
I+m.m_mass*m.m_invI*C);k.equalizedMass=1/G;C=f;G=-g;I=n*G-s*C;C=F*G-z*C;I=I*I;C=C*C;k.tangentMass=1/(l.m_invMass+m.m_invMass+l.m_invI*I+m.m_invI*C);k.velocityBias=0;n=e.normal.x*(r+-w*z-p- -D*s)+e.normal.y*(u+w*F-t-D*n);if(n<-A.b2_velocityThreshold)k.velocityBias=k.velocityBias+-e.restitution*n}if(e.pointCount==2){u=e.points[0];r=e.points[1];o=l.m_invMass;l=l.m_invI;p=m.m_invMass;m=m.m_invI;t=u.rA.x*f-u.rA.y*g;u=u.rB.x*f-u.rB.y*g;D=r.rA.x*f-r.rA.y*g;r=r.rB.x*f-r.rB.y*g;g=o+p+l*t*t+m*u*u;f=o+p+l*D*
D+m*r*r;m=o+p+l*t*D+m*u*r;if(g*g<100*(g*f-m*m)){e.K.col1.Set(g,m);e.K.col2.Set(m,f);e.K.GetInverse(e.normalMass)}else e.pointCount=1}}};q.prototype.InitVelocityConstraints=function(b){for(var c=0;c<this.m_constraintCount;++c){var d=this.m_constraints[c],e=d.bodyA,f=d.bodyB,g=e.m_invMass,h=e.m_invI,j=f.m_invMass,k=f.m_invI,l=d.normal.x,m=d.normal.y,o=m,n=-l,s=0,p=0;if(b.warmStarting){p=d.pointCount;for(s=0;s<p;++s){var q=d.points[s];q.normalImpulse=q.normalImpulse*b.dtRatio;q.tangentImpulse=q.tangentImpulse*
b.dtRatio;var t=q.normalImpulse*l+q.tangentImpulse*o,r=q.normalImpulse*m+q.tangentImpulse*n;e.m_angularVelocity=e.m_angularVelocity-h*(q.rA.x*r-q.rA.y*t);e.m_linearVelocity.x=e.m_linearVelocity.x-g*t;e.m_linearVelocity.y=e.m_linearVelocity.y-g*r;f.m_angularVelocity=f.m_angularVelocity+k*(q.rB.x*r-q.rB.y*t);f.m_linearVelocity.x=f.m_linearVelocity.x+j*t;f.m_linearVelocity.y=f.m_linearVelocity.y+j*r}}else{p=d.pointCount;for(s=0;s<p;++s){e=d.points[s];e.normalImpulse=0;e.tangentImpulse=0}}}};q.prototype.SolveVelocityConstraints=
function(){for(var b=0,c,d=0,e=0,f=0,g=0,h=0,j=0,k=0,l,m=0;m<this.m_constraintCount;++m){var f=this.m_constraints[m],o=f.bodyA,n=f.bodyB,s=o.m_angularVelocity,p=n.m_angularVelocity,q=o.m_linearVelocity,t=n.m_linearVelocity,r=o.m_invMass,u=o.m_invI,D=n.m_invMass,w=n.m_invI,j=f.normal.x,F=k=f.normal.y;l=-j;h=f.friction;for(b=0;b<f.pointCount;b++){c=f.points[b];d=t.x-p*c.rB.y-q.x+s*c.rA.y;e=t.y+p*c.rB.x-q.y-s*c.rA.x;d=d*F+e*l;d=c.tangentMass*-d;e=h*c.normalImpulse;e=G.Clamp(c.tangentImpulse+d,-e,e);
d=e-c.tangentImpulse;g=d*F;d=d*l;q.x=q.x-r*g;q.y=q.y-r*d;s=s-u*(c.rA.x*d-c.rA.y*g);t.x=t.x+D*g;t.y=t.y+D*d;p=p+w*(c.rB.x*d-c.rB.y*g);c.tangentImpulse=e}parseInt(f.pointCount);if(f.pointCount==1){c=f.points[0];d=t.x+-p*c.rB.y-q.x- -s*c.rA.y;e=t.y+p*c.rB.x-q.y-s*c.rA.x;f=d*j+e*k;d=-c.normalMass*(f-c.velocityBias);e=c.normalImpulse+d;e=e>0?e:0;d=e-c.normalImpulse;g=d*j;d=d*k;q.x=q.x-r*g;q.y=q.y-r*d;s=s-u*(c.rA.x*d-c.rA.y*g);t.x=t.x+D*g;t.y=t.y+D*d;p=p+w*(c.rB.x*d-c.rB.y*g);c.normalImpulse=e}else{c=f.points[0];
var b=f.points[1],d=c.normalImpulse,h=b.normalImpulse,A=(t.x-p*c.rB.y-q.x+s*c.rA.y)*j+(t.y+p*c.rB.x-q.y-s*c.rA.x)*k,z=(t.x-p*b.rB.y-q.x+s*b.rA.y)*j+(t.y+p*b.rB.x-q.y-s*b.rA.x)*k,e=A-c.velocityBias,g=z-b.velocityBias;l=f.K;e=e-(l.col1.x*d+l.col2.x*h);for(g=g-(l.col1.y*d+l.col2.y*h);;){l=f.normalMass;F=-(l.col1.x*e+l.col2.x*g);l=-(l.col1.y*e+l.col2.y*g);if(F>=0&&l>=0){d=F-d;h=l-h;f=d*j;d=d*k;j=h*j;k=h*k;q.x=q.x-r*(f+j);q.y=q.y-r*(d+k);s=s-u*(c.rA.x*d-c.rA.y*f+b.rA.x*k-b.rA.y*j);t.x=t.x+D*(f+j);t.y=
t.y+D*(d+k);p=p+w*(c.rB.x*d-c.rB.y*f+b.rB.x*k-b.rB.y*j);c.normalImpulse=F;b.normalImpulse=l;break}F=-c.normalMass*e;l=0;z=f.K.col1.y*F+g;if(F>=0&&z>=0){d=F-d;h=l-h;f=d*j;d=d*k;j=h*j;k=h*k;q.x=q.x-r*(f+j);q.y=q.y-r*(d+k);s=s-u*(c.rA.x*d-c.rA.y*f+b.rA.x*k-b.rA.y*j);t.x=t.x+D*(f+j);t.y=t.y+D*(d+k);p=p+w*(c.rB.x*d-c.rB.y*f+b.rB.x*k-b.rB.y*j);c.normalImpulse=F;b.normalImpulse=l;break}F=0;l=-b.normalMass*g;A=f.K.col2.x*l+e;if(l>=0&&A>=0){d=F-d;h=l-h;f=d*j;d=d*k;j=h*j;k=h*k;q.x=q.x-r*(f+j);q.y=q.y-r*(d+
k);s=s-u*(c.rA.x*d-c.rA.y*f+b.rA.x*k-b.rA.y*j);t.x=t.x+D*(f+j);t.y=t.y+D*(d+k);p=p+w*(c.rB.x*d-c.rB.y*f+b.rB.x*k-b.rB.y*j);c.normalImpulse=F;b.normalImpulse=l;break}l=F=0;A=e;z=g;if(A>=0&&z>=0){d=F-d;h=l-h;f=d*j;d=d*k;j=h*j;k=h*k;q.x=q.x-r*(f+j);q.y=q.y-r*(d+k);s=s-u*(c.rA.x*d-c.rA.y*f+b.rA.x*k-b.rA.y*j);t.x=t.x+D*(f+j);t.y=t.y+D*(d+k);p=p+w*(c.rB.x*d-c.rB.y*f+b.rB.x*k-b.rB.y*j);c.normalImpulse=F;b.normalImpulse=l;break}break}}o.m_angularVelocity=s;n.m_angularVelocity=p}};q.prototype.FinalizeVelocityConstraints=
function(){for(var b=0;b<this.m_constraintCount;++b)for(var c=this.m_constraints[b],d=c.manifold,e=0;e<c.pointCount;++e){var f=d.m_points[e],g=c.points[e];f.m_normalImpulse=g.normalImpulse;f.m_tangentImpulse=g.tangentImpulse}};q.prototype.SolvePositionConstraints=function(b){b===void 0&&(b=0);for(var c=0,d=0;d<this.m_constraintCount;d++){var e=this.m_constraints[d],f=e.bodyA,g=e.bodyB,h=f.m_mass*f.m_invMass,j=f.m_mass*f.m_invI,k=g.m_mass*g.m_invMass,l=g.m_mass*g.m_invI;q.s_psm.Initialize(e);for(var m=
q.s_psm.m_normal,o=0;o<e.pointCount;o++){var n=e.points[o],s=q.s_psm.m_points[o],p=q.s_psm.m_separations[o],t=s.x-f.m_sweep.c.x,r=s.y-f.m_sweep.c.y,u=s.x-g.m_sweep.c.x,s=s.y-g.m_sweep.c.y,c=c<p?c:p,p=G.Clamp(b*(p+A.b2_linearSlop),-A.b2_maxLinearCorrection,0),p=-n.equalizedMass*p,n=p*m.x,p=p*m.y;f.m_sweep.c.x=f.m_sweep.c.x-h*n;f.m_sweep.c.y=f.m_sweep.c.y-h*p;f.m_sweep.a=f.m_sweep.a-j*(t*p-r*n);f.SynchronizeTransform();g.m_sweep.c.x=g.m_sweep.c.x+k*n;g.m_sweep.c.y=g.m_sweep.c.y+k*p;g.m_sweep.a=g.m_sweep.a+
l*(u*p-s*n);g.SynchronizeTransform()}}return c>-1.5*A.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new I;Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new u});Box2D.inherit(p,Box2D.Dynamics.Contacts.b2Contact);p.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;p.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};p.Create=function(){return new p};p.Destroy=function(){};p.prototype.Reset=
function(b,c){this.__super.Reset.call(this,b,c)};p.prototype.Evaluate=function(){var d=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof c?this.m_fixtureA.GetShape():null,d.m_xf,this.m_fixtureB.GetShape()instanceof b?this.m_fixtureB.GetShape():null,e.m_xf)};p.prototype.b2CollideEdgeAndCircle=function(){};Box2D.inherit(s,Box2D.Dynamics.Contacts.b2Contact);s.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;
s.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};s.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)};s.prototype.Evaluate=function(){};Box2D.inherit(r,Box2D.Dynamics.Contacts.b2Contact);r.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;r.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};r.Create=function(){return new r};r.Destroy=function(){};r.prototype.Reset=function(b,
c){this.__super.Reset.call(this,b,c);A.b2Assert(b.GetType()==e.e_polygonShape);A.b2Assert(c.GetType()==e.e_circleShape)};r.prototype.Evaluate=function(){var c=this.m_fixtureA.m_body,e=this.m_fixtureB.m_body;K.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof d?this.m_fixtureA.GetShape():null,c.m_xf,this.m_fixtureB.GetShape()instanceof b?this.m_fixtureB.GetShape():null,e.m_xf)};Box2D.inherit(o,Box2D.Dynamics.Contacts.b2Contact);o.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;
o.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};o.Create=function(){return new o};o.Destroy=function(){};o.prototype.Reset=function(b,c){this.__super.Reset.call(this,b,c);A.b2Assert(b.GetType()==e.e_polygonShape);A.b2Assert(c.GetType()==e.e_edgeShape)};o.prototype.Evaluate=function(){var b=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof d?this.m_fixtureA.GetShape():
null,b.m_xf,this.m_fixtureB.GetShape()instanceof c?this.m_fixtureB.GetShape():null,e.m_xf)};o.prototype.b2CollidePolyAndEdge=function(){};Box2D.inherit(t,Box2D.Dynamics.Contacts.b2Contact);t.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;t.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};t.Create=function(){return new t};t.Destroy=function(){};t.prototype.Reset=function(b,c){this.__super.Reset.call(this,b,c)};t.prototype.Evaluate=function(){var b=
this.m_fixtureA.GetBody(),c=this.m_fixtureB.GetBody();K.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof d?this.m_fixtureA.GetShape():null,b.m_xf,this.m_fixtureB.GetShape()instanceof d?this.m_fixtureB.GetShape():null,c.m_xf)};u.b2PositionSolverManifold=function(){};u.prototype.b2PositionSolverManifold=function(){this.m_normal=new H;this.m_separations=new Vector_a2j_Number(A.b2_maxManifoldPoints);this.m_points=new Vector(A.b2_maxManifoldPoints);for(var b=0;b<A.b2_maxManifoldPoints;b++)this.m_points[b]=
new H};u.prototype.Initialize=function(b){A.b2Assert(b.pointCount>0);var c=0,d=0,e=0,f,g=0,h=0;switch(b.type){case T.e_circles:f=b.bodyA.m_xf.R;e=b.localPoint;c=b.bodyA.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y);d=b.bodyA.m_xf.position.y+(f.col1.y*e.x+f.col2.y*e.y);f=b.bodyB.m_xf.R;e=b.points[0].localPoint;g=b.bodyB.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y);f=b.bodyB.m_xf.position.y+(f.col1.y*e.x+f.col2.y*e.y);var e=g-c,h=f-d,j=e*e+h*h;if(j>Number.MIN_VALUE*Number.MIN_VALUE){j=Math.sqrt(j);this.m_normal.x=
e/j;this.m_normal.y=h/j}else{this.m_normal.x=1;this.m_normal.y=0}this.m_points[0].x=0.5*(c+g);this.m_points[0].y=0.5*(d+f);this.m_separations[0]=e*this.m_normal.x+h*this.m_normal.y-b.radius;break;case T.e_faceA:f=b.bodyA.m_xf.R;e=b.localPlaneNormal;this.m_normal.x=f.col1.x*e.x+f.col2.x*e.y;this.m_normal.y=f.col1.y*e.x+f.col2.y*e.y;f=b.bodyA.m_xf.R;e=b.localPoint;g=b.bodyA.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y);h=b.bodyA.m_xf.position.y+(f.col1.y*e.x+f.col2.y*e.y);f=b.bodyB.m_xf.R;for(c=0;c<b.pointCount;++c){e=
b.points[c].localPoint;d=b.bodyB.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y);e=b.bodyB.m_xf.position.y+(f.col1.y*e.x+f.col2.y*e.y);this.m_separations[c]=(d-g)*this.m_normal.x+(e-h)*this.m_normal.y-b.radius;this.m_points[c].x=d;this.m_points[c].y=e}break;case T.e_faceB:f=b.bodyB.m_xf.R;e=b.localPlaneNormal;this.m_normal.x=f.col1.x*e.x+f.col2.x*e.y;this.m_normal.y=f.col1.y*e.x+f.col2.y*e.y;f=b.bodyB.m_xf.R;e=b.localPoint;g=b.bodyB.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y);h=b.bodyB.m_xf.position.y+
(f.col1.y*e.x+f.col2.y*e.y);f=b.bodyA.m_xf.R;for(c=0;c<b.pointCount;++c){e=b.points[c].localPoint;d=b.bodyA.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y);e=b.bodyA.m_xf.position.y+(f.col1.y*e.x+f.col2.y*e.y);this.m_separations[c]=(d-g)*this.m_normal.x+(e-h)*this.m_normal.y-b.radius;this.m_points[c].Set(d,e)}this.m_normal.x=this.m_normal.x*-1;this.m_normal.y=this.m_normal.y*-1}};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new H;Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=
new H})})();
(function(){var b=Box2D.Common.Math.b2Mat22,c=Box2D.Common.Math.b2Math,d=Box2D.Common.Math.b2Vec2,e=Box2D.Common.b2Color,f=Box2D.Dynamics.Controllers.b2BuoyancyController,g=Box2D.Dynamics.Controllers.b2ConstantAccelController,h=Box2D.Dynamics.Controllers.b2ConstantForceController,j=Box2D.Dynamics.Controllers.b2Controller,k=Box2D.Dynamics.Controllers.b2ControllerEdge,l=Box2D.Dynamics.Controllers.b2GravityController,m=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(f,Box2D.Dynamics.Controllers.b2Controller);
f.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;f.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.normal=new d(0,-1);this.density=this.offset=0;this.velocity=new d(0,0);this.linearDrag=2;this.angularDrag=1;this.useDensity=false;this.useWorldGravity=true;this.gravity=null};f.prototype.Step=function(){if(this.m_bodyList){if(this.useWorldGravity)this.gravity=this.GetWorld().GetGravity().Copy();for(var b=this.m_bodyList;b;b=
b.nextBody){var c=b.body;if(c.IsAwake()!=false){for(var e=new d,f=new d,g=0,h=0,j=c.GetFixtureList();j;j=j.GetNext()){var k=new d,l=j.GetShape().ComputeSubmergedArea(this.normal,this.offset,c.GetTransform(),k),g=g+l;e.x=e.x+l*k.x;e.y=e.y+l*k.y;var m=0,m=1,h=h+l*m;f.x=f.x+l*k.x*m;f.y=f.y+l*k.y*m}e.x=e.x/g;e.y=e.y/g;f.x=f.x/h;f.y=f.y/h;if(!(g<Number.MIN_VALUE)){h=this.gravity.GetNegative();h.Multiply(this.density*g);c.ApplyForce(h,f);f=c.GetLinearVelocityFromWorldPoint(e);f.Subtract(this.velocity);
f.Multiply(-this.linearDrag*g);c.ApplyForce(f,e);c.ApplyTorque(-c.GetInertia()/c.GetMass()*g*c.GetAngularVelocity()*this.angularDrag)}}}}};f.prototype.Draw=function(b){var c=new d,f=new d;c.x=this.normal.x*this.offset+this.normal.y*1E3;c.y=this.normal.y*this.offset-this.normal.x*1E3;f.x=this.normal.x*this.offset-this.normal.y*1E3;f.y=this.normal.y*this.offset+this.normal.x*1E3;var g=new e(0,0,1);b.DrawSegment(c,f,g)};Box2D.inherit(g,Box2D.Dynamics.Controllers.b2Controller);g.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;
g.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.A=new d(0,0)};g.prototype.Step=function(b){for(var b=new d(this.A.x*b.dt,this.A.y*b.dt),c=this.m_bodyList;c;c=c.nextBody){var e=c.body;e.IsAwake()&&e.SetLinearVelocity(new d(e.GetLinearVelocity().x+b.x,e.GetLinearVelocity().y+b.y))}};Box2D.inherit(h,Box2D.Dynamics.Controllers.b2Controller);h.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;h.b2ConstantForceController=
function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.F=new d(0,0)};h.prototype.Step=function(){for(var b=this.m_bodyList;b;b=b.nextBody){var c=b.body;c.IsAwake()&&c.ApplyForce(this.F,c.GetWorldCenter())}};j.b2Controller=function(){};j.prototype.Step=function(){};j.prototype.Draw=function(){};j.prototype.AddBody=function(b){var c=new k;c.controller=this;c.body=b;c.nextBody=this.m_bodyList;c.prevBody=null;this.m_bodyList=c;if(c.nextBody)c.nextBody.prevBody=c;this.m_bodyCount++;
c.nextController=b.m_controllerList;c.prevController=null;b.m_controllerList=c;if(c.nextController)c.nextController.prevController=c;b.m_controllerCount++};j.prototype.RemoveBody=function(b){for(var c=b.m_controllerList;c&&c.controller!=this;)c=c.nextController;if(c.prevBody)c.prevBody.nextBody=c.nextBody;if(c.nextBody)c.nextBody.prevBody=c.prevBody;if(c.nextController)c.nextController.prevController=c.prevController;if(c.prevController)c.prevController.nextController=c.nextController;if(this.m_bodyList==
c)this.m_bodyList=c.nextBody;if(b.m_controllerList==c)b.m_controllerList=c.nextController;b.m_controllerCount--;this.m_bodyCount--};j.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)};j.prototype.GetNext=function(){return this.m_next};j.prototype.GetWorld=function(){return this.m_world};j.prototype.GetBodyList=function(){return this.m_bodyList};k.b2ControllerEdge=function(){};Box2D.inherit(l,Box2D.Dynamics.Controllers.b2Controller);l.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;
l.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.G=1;this.invSqr=true};l.prototype.Step=function(){var b=null,c=null,e=null,f=0,g=null,h=null,j=null,k=0,l=0,m=0;if(this.invSqr)for(b=this.m_bodyList;b;b=b.nextBody){c=b.body;e=c.GetWorldCenter();f=c.GetMass();for(g=this.m_bodyList;g!=b;g=g.nextBody){h=g.body;j=h.GetWorldCenter();k=j.x-e.x;l=j.y-e.y;m=k*k+l*l;if(!(m<Number.MIN_VALUE)){k=new d(k,l);k.Multiply(this.G/m/Math.sqrt(m)*f*h.GetMass());
c.IsAwake()&&c.ApplyForce(k,e);k.Multiply(-1);h.IsAwake()&&h.ApplyForce(k,j)}}}else for(b=this.m_bodyList;b;b=b.nextBody){c=b.body;e=c.GetWorldCenter();f=c.GetMass();for(g=this.m_bodyList;g!=b;g=g.nextBody){h=g.body;j=h.GetWorldCenter();k=j.x-e.x;l=j.y-e.y;m=k*k+l*l;if(!(m<Number.MIN_VALUE)){k=new d(k,l);k.Multiply(this.G/m*f*h.GetMass());c.IsAwake()&&c.ApplyForce(k,e);k.Multiply(-1);h.IsAwake()&&h.ApplyForce(k,j)}}}};Box2D.inherit(m,Box2D.Dynamics.Controllers.b2Controller);m.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;
m.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.T=new b;this.maxTimestep=0};m.prototype.SetAxisAligned=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);this.T.col1.x=-b;this.T.col1.y=0;this.T.col2.x=0;this.T.col2.y=-c;this.maxTimestep=b>0||c>0?1/Math.max(b,c):0};m.prototype.Step=function(b){b=b.dt;if(!(b<=Number.MIN_VALUE)){if(b>this.maxTimestep&&this.maxTimestep>0)b=this.maxTimestep;for(var e=this.m_bodyList;e;e=e.nextBody){var f=
e.body;if(f.IsAwake()){var g=f.GetWorldVector(c.MulMV(this.T,f.GetLocalVector(f.GetLinearVelocity())));f.SetLinearVelocity(new d(f.GetLinearVelocity().x+g.x*b,f.GetLinearVelocity().y+g.y*b))}}}}})();
(function(){var b=Box2D.Common.b2Settings,c=Box2D.Common.Math.b2Mat22,d=Box2D.Common.Math.b2Mat33,e=Box2D.Common.Math.b2Math,f=Box2D.Common.Math.b2Vec2,g=Box2D.Common.Math.b2Vec3,h=Box2D.Dynamics.Joints.b2DistanceJoint,j=Box2D.Dynamics.Joints.b2DistanceJointDef,k=Box2D.Dynamics.Joints.b2FrictionJoint,l=Box2D.Dynamics.Joints.b2FrictionJointDef,m=Box2D.Dynamics.Joints.b2GearJoint,n=Box2D.Dynamics.Joints.b2GearJointDef,q=Box2D.Dynamics.Joints.b2Jacobian,p=Box2D.Dynamics.Joints.b2Joint,s=Box2D.Dynamics.Joints.b2JointDef,
r=Box2D.Dynamics.Joints.b2JointEdge,o=Box2D.Dynamics.Joints.b2LineJoint,t=Box2D.Dynamics.Joints.b2LineJointDef,u=Box2D.Dynamics.Joints.b2MouseJoint,w=Box2D.Dynamics.Joints.b2MouseJointDef,z=Box2D.Dynamics.Joints.b2PrismaticJoint,A=Box2D.Dynamics.Joints.b2PrismaticJointDef,C=Box2D.Dynamics.Joints.b2PulleyJoint,G=Box2D.Dynamics.Joints.b2PulleyJointDef,H=Box2D.Dynamics.Joints.b2RevoluteJoint,K=Box2D.Dynamics.Joints.b2RevoluteJointDef,P=Box2D.Dynamics.Joints.b2WeldJoint,T=Box2D.Dynamics.Joints.b2WeldJointDef;
Box2D.inherit(h,Box2D.Dynamics.Joints.b2Joint);h.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;h.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new f;this.m_localAnchor2=new f;this.m_u=new f};h.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};h.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};h.prototype.GetReactionForce=function(b){b===void 0&&(b=0);
return new f(b*this.m_impulse*this.m_u.x,b*this.m_impulse*this.m_u.y)};h.prototype.GetReactionTorque=function(){return 0};h.prototype.GetLength=function(){return this.m_length};h.prototype.SetLength=function(b){b===void 0&&(b=0);this.m_length=b};h.prototype.GetFrequency=function(){return this.m_frequencyHz};h.prototype.SetFrequency=function(b){b===void 0&&(b=0);this.m_frequencyHz=b};h.prototype.GetDampingRatio=function(){return this.m_dampingRatio};h.prototype.SetDampingRatio=function(b){b===void 0&&
(b=0);this.m_dampingRatio=b};h.prototype.b2DistanceJoint=function(b){this.__super.b2Joint.call(this,b);this.m_localAnchor1.SetV(b.localAnchorA);this.m_localAnchor2.SetV(b.localAnchorB);this.m_length=b.length;this.m_frequencyHz=b.frequencyHz;this.m_dampingRatio=b.dampingRatio;this.m_bias=this.m_gamma=this.m_impulse=0};h.prototype.InitVelocityConstraints=function(c){var d,e=0,f=this.m_bodyA,g=this.m_bodyB;d=f.m_xf.R;var h=this.m_localAnchor1.x-f.m_sweep.localCenter.x,j=this.m_localAnchor1.y-f.m_sweep.localCenter.y,
e=d.col1.x*h+d.col2.x*j,j=d.col1.y*h+d.col2.y*j,h=e;d=g.m_xf.R;var k=this.m_localAnchor2.x-g.m_sweep.localCenter.x,l=this.m_localAnchor2.y-g.m_sweep.localCenter.y,e=d.col1.x*k+d.col2.x*l,l=d.col1.y*k+d.col2.y*l,k=e;this.m_u.x=g.m_sweep.c.x+k-f.m_sweep.c.x-h;this.m_u.y=g.m_sweep.c.y+l-f.m_sweep.c.y-j;e=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);e>b.b2_linearSlop?this.m_u.Multiply(1/e):this.m_u.SetZero();d=h*this.m_u.y-j*this.m_u.x;var m=k*this.m_u.y-l*this.m_u.x;d=f.m_invMass+f.m_invI*
d*d+g.m_invMass+g.m_invI*m*m;this.m_mass=d!=0?1/d:0;if(this.m_frequencyHz>0){var e=e-this.m_length,m=2*Math.PI*this.m_frequencyHz,o=this.m_mass*m*m;this.m_gamma=c.dt*(2*this.m_mass*this.m_dampingRatio*m+c.dt*o);this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0;this.m_bias=e*c.dt*o*this.m_gamma;this.m_mass=d+this.m_gamma;this.m_mass=this.m_mass!=0?1/this.m_mass:0}if(c.warmStarting){this.m_impulse=this.m_impulse*c.dtRatio;c=this.m_impulse*this.m_u.x;d=this.m_impulse*this.m_u.y;f.m_linearVelocity.x=f.m_linearVelocity.x-
f.m_invMass*c;f.m_linearVelocity.y=f.m_linearVelocity.y-f.m_invMass*d;f.m_angularVelocity=f.m_angularVelocity-f.m_invI*(h*d-j*c);g.m_linearVelocity.x=g.m_linearVelocity.x+g.m_invMass*c;g.m_linearVelocity.y=g.m_linearVelocity.y+g.m_invMass*d;g.m_angularVelocity=g.m_angularVelocity+g.m_invI*(k*d-l*c)}else this.m_impulse=0};h.prototype.SolveVelocityConstraints=function(){var b,c=this.m_bodyA,d=this.m_bodyB;b=c.m_xf.R;var e=this.m_localAnchor1.x-c.m_sweep.localCenter.x,f=this.m_localAnchor1.y-c.m_sweep.localCenter.y,
g=b.col1.x*e+b.col2.x*f,f=b.col1.y*e+b.col2.y*f,e=g;b=d.m_xf.R;var h=this.m_localAnchor2.x-d.m_sweep.localCenter.x,j=this.m_localAnchor2.y-d.m_sweep.localCenter.y,g=b.col1.x*h+b.col2.x*j,j=b.col1.y*h+b.col2.y*j,h=g,g=-this.m_mass*(this.m_u.x*(d.m_linearVelocity.x+-d.m_angularVelocity*j-(c.m_linearVelocity.x+-c.m_angularVelocity*f))+this.m_u.y*(d.m_linearVelocity.y+d.m_angularVelocity*h-(c.m_linearVelocity.y+c.m_angularVelocity*e))+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse=this.m_impulse+
g;b=g*this.m_u.x;g=g*this.m_u.y;c.m_linearVelocity.x=c.m_linearVelocity.x-c.m_invMass*b;c.m_linearVelocity.y=c.m_linearVelocity.y-c.m_invMass*g;c.m_angularVelocity=c.m_angularVelocity-c.m_invI*(e*g-f*b);d.m_linearVelocity.x=d.m_linearVelocity.x+d.m_invMass*b;d.m_linearVelocity.y=d.m_linearVelocity.y+d.m_invMass*g;d.m_angularVelocity=d.m_angularVelocity+d.m_invI*(h*g-j*b)};h.prototype.SolvePositionConstraints=function(){var c;if(this.m_frequencyHz>0)return true;var d=this.m_bodyA,f=this.m_bodyB;c=
d.m_xf.R;var g=this.m_localAnchor1.x-d.m_sweep.localCenter.x,h=this.m_localAnchor1.y-d.m_sweep.localCenter.y,j=c.col1.x*g+c.col2.x*h,h=c.col1.y*g+c.col2.y*h,g=j;c=f.m_xf.R;var k=this.m_localAnchor2.x-f.m_sweep.localCenter.x,l=this.m_localAnchor2.y-f.m_sweep.localCenter.y,j=c.col1.x*k+c.col2.x*l,l=c.col1.y*k+c.col2.y*l,k=j,j=f.m_sweep.c.x+k-d.m_sweep.c.x-g,m=f.m_sweep.c.y+l-d.m_sweep.c.y-h;c=Math.sqrt(j*j+m*m);j=j/c;m=m/c;c=c-this.m_length;c=e.Clamp(c,-b.b2_maxLinearCorrection,b.b2_maxLinearCorrection);
var o=-this.m_mass*c;this.m_u.Set(j,m);j=o*this.m_u.x;m=o*this.m_u.y;d.m_sweep.c.x=d.m_sweep.c.x-d.m_invMass*j;d.m_sweep.c.y=d.m_sweep.c.y-d.m_invMass*m;d.m_sweep.a=d.m_sweep.a-d.m_invI*(g*m-h*j);f.m_sweep.c.x=f.m_sweep.c.x+f.m_invMass*j;f.m_sweep.c.y=f.m_sweep.c.y+f.m_invMass*m;f.m_sweep.a=f.m_sweep.a+f.m_invI*(k*m-l*j);d.SynchronizeTransform();f.SynchronizeTransform();return e.Abs(c)<b.b2_linearSlop};Box2D.inherit(j,Box2D.Dynamics.Joints.b2JointDef);j.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;
j.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new f;this.localAnchorB=new f};j.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this);this.type=p.e_distanceJoint;this.length=1;this.dampingRatio=this.frequencyHz=0};j.prototype.Initialize=function(b,c,d,e){this.bodyA=b;this.bodyB=c;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(d));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(e));b=e.x-d.x;d=e.y-d.y;this.length=
Math.sqrt(b*b+d*d);this.dampingRatio=this.frequencyHz=0};Box2D.inherit(k,Box2D.Dynamics.Joints.b2Joint);k.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;k.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new f;this.m_localAnchorB=new f;this.m_linearMass=new c;this.m_linearImpulse=new f};k.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};k.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};
k.prototype.GetReactionForce=function(b){b===void 0&&(b=0);return new f(b*this.m_linearImpulse.x,b*this.m_linearImpulse.y)};k.prototype.GetReactionTorque=function(b){b===void 0&&(b=0);return b*this.m_angularImpulse};k.prototype.SetMaxForce=function(b){b===void 0&&(b=0);this.m_maxForce=b};k.prototype.GetMaxForce=function(){return this.m_maxForce};k.prototype.SetMaxTorque=function(b){b===void 0&&(b=0);this.m_maxTorque=b};k.prototype.GetMaxTorque=function(){return this.m_maxTorque};k.prototype.b2FrictionJoint=
function(b){this.__super.b2Joint.call(this,b);this.m_localAnchorA.SetV(b.localAnchorA);this.m_localAnchorB.SetV(b.localAnchorB);this.m_linearMass.SetZero();this.m_angularMass=0;this.m_linearImpulse.SetZero();this.m_angularImpulse=0;this.m_maxForce=b.maxForce;this.m_maxTorque=b.maxTorque};k.prototype.InitVelocityConstraints=function(b){var d,e=0,f=this.m_bodyA,g=this.m_bodyB;d=f.m_xf.R;var h=this.m_localAnchorA.x-f.m_sweep.localCenter.x,j=this.m_localAnchorA.y-f.m_sweep.localCenter.y,e=d.col1.x*h+
d.col2.x*j,j=d.col1.y*h+d.col2.y*j,h=e;d=g.m_xf.R;var k=this.m_localAnchorB.x-g.m_sweep.localCenter.x,l=this.m_localAnchorB.y-g.m_sweep.localCenter.y,e=d.col1.x*k+d.col2.x*l,l=d.col1.y*k+d.col2.y*l,k=e;d=f.m_invMass;var e=g.m_invMass,m=f.m_invI,o=g.m_invI,n=new c;n.col1.x=d+e;n.col2.x=0;n.col1.y=0;n.col2.y=d+e;n.col1.x=n.col1.x+m*j*j;n.col2.x=n.col2.x+-m*h*j;n.col1.y=n.col1.y+-m*h*j;n.col2.y=n.col2.y+m*h*h;n.col1.x=n.col1.x+o*l*l;n.col2.x=n.col2.x+-o*k*l;n.col1.y=n.col1.y+-o*k*l;n.col2.y=n.col2.y+
o*k*k;n.GetInverse(this.m_linearMass);this.m_angularMass=m+o;if(this.m_angularMass>0)this.m_angularMass=1/this.m_angularMass;if(b.warmStarting){this.m_linearImpulse.x=this.m_linearImpulse.x*b.dtRatio;this.m_linearImpulse.y=this.m_linearImpulse.y*b.dtRatio;this.m_angularImpulse=this.m_angularImpulse*b.dtRatio;b=this.m_linearImpulse;f.m_linearVelocity.x=f.m_linearVelocity.x-d*b.x;f.m_linearVelocity.y=f.m_linearVelocity.y-d*b.y;f.m_angularVelocity=f.m_angularVelocity-m*(h*b.y-j*b.x+this.m_angularImpulse);
g.m_linearVelocity.x=g.m_linearVelocity.x+e*b.x;g.m_linearVelocity.y=g.m_linearVelocity.y+e*b.y;g.m_angularVelocity=g.m_angularVelocity+o*(k*b.y-l*b.x+this.m_angularImpulse)}else{this.m_linearImpulse.SetZero();this.m_angularImpulse=0}};k.prototype.SolveVelocityConstraints=function(b){var c,d=0,g=this.m_bodyA,h=this.m_bodyB,j=g.m_linearVelocity,k=g.m_angularVelocity,l=h.m_linearVelocity,m=h.m_angularVelocity,o=g.m_invMass,n=h.m_invMass,s=g.m_invI,p=h.m_invI;c=g.m_xf.R;var q=this.m_localAnchorA.x-g.m_sweep.localCenter.x,
t=this.m_localAnchorA.y-g.m_sweep.localCenter.y,d=c.col1.x*q+c.col2.x*t,t=c.col1.y*q+c.col2.y*t,q=d;c=h.m_xf.R;var r=this.m_localAnchorB.x-h.m_sweep.localCenter.x,u=this.m_localAnchorB.y-h.m_sweep.localCenter.y,d=c.col1.x*r+c.col2.x*u,u=c.col1.y*r+c.col2.y*u,r=d,d=-this.m_angularMass*(m-k),w=this.m_angularImpulse;c=b.dt*this.m_maxTorque;this.m_angularImpulse=e.Clamp(this.m_angularImpulse+d,-c,c);d=this.m_angularImpulse-w;k=k-s*d;m=m+p*d;c=e.MulMV(this.m_linearMass,new f(-(l.x-m*u-j.x+k*t),-(l.y+m*
r-j.y-k*q)));d=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(c);c=b.dt*this.m_maxForce;if(this.m_linearImpulse.LengthSquared()>c*c){this.m_linearImpulse.Normalize();this.m_linearImpulse.Multiply(c)}c=e.SubtractVV(this.m_linearImpulse,d);j.x=j.x-o*c.x;j.y=j.y-o*c.y;k=k-s*(q*c.y-t*c.x);l.x=l.x+n*c.x;l.y=l.y+n*c.y;m=m+p*(r*c.y-u*c.x);g.m_angularVelocity=k;h.m_angularVelocity=m};k.prototype.SolvePositionConstraints=function(){return true};Box2D.inherit(l,Box2D.Dynamics.Joints.b2JointDef);l.prototype.__super=
Box2D.Dynamics.Joints.b2JointDef.prototype;l.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new f;this.localAnchorB=new f};l.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this);this.type=p.e_frictionJoint;this.maxTorque=this.maxForce=0};l.prototype.Initialize=function(b,c,d){this.bodyA=b;this.bodyB=c;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(d));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(d))};Box2D.inherit(m,
Box2D.Dynamics.Joints.b2Joint);m.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;m.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_groundAnchor1=new f;this.m_groundAnchor2=new f;this.m_localAnchor1=new f;this.m_localAnchor2=new f;this.m_J=new q};m.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};m.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};m.prototype.GetReactionForce=
function(b){b===void 0&&(b=0);return new f(b*this.m_impulse*this.m_J.linearB.x,b*this.m_impulse*this.m_J.linearB.y)};m.prototype.GetReactionTorque=function(b){b===void 0&&(b=0);var c=this.m_bodyB.m_xf.R,d=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,e=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e;return b*(this.m_impulse*this.m_J.angularB-f*this.m_impulse*this.m_J.linearB.y+e*this.m_impulse*this.m_J.linearB.x)};m.prototype.GetRatio=
function(){return this.m_ratio};m.prototype.SetRatio=function(b){b===void 0&&(b=0);this.m_ratio=b};m.prototype.b2GearJoint=function(b){this.__super.b2Joint.call(this,b);var c=parseInt(b.joint1.m_type),d=parseInt(b.joint2.m_type);this.m_prismatic2=this.m_revolute2=this.m_prismatic1=this.m_revolute1=null;var e=0,f=0;this.m_ground1=b.joint1.GetBodyA();this.m_bodyA=b.joint1.GetBodyB();if(c==p.e_revoluteJoint){this.m_revolute1=b.joint1 instanceof H?b.joint1:null;this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1);
this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2);e=this.m_revolute1.GetJointAngle()}else{this.m_prismatic1=b.joint1 instanceof z?b.joint1:null;this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1);this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2);e=this.m_prismatic1.GetJointTranslation()}this.m_ground2=b.joint2.GetBodyA();this.m_bodyB=b.joint2.GetBodyB();if(d==p.e_revoluteJoint){this.m_revolute2=b.joint2 instanceof H?b.joint2:null;this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1);
this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2);f=this.m_revolute2.GetJointAngle()}else{this.m_prismatic2=b.joint2 instanceof z?b.joint2:null;this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1);this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2);f=this.m_prismatic2.GetJointTranslation()}this.m_ratio=b.ratio;this.m_constant=e+this.m_ratio*f;this.m_impulse=0};m.prototype.InitVelocityConstraints=function(b){var c=this.m_ground1,d=this.m_ground2,e=this.m_bodyA,f=this.m_bodyB,
g=0,h=0,j=0,k=0,l=0,m=0;this.m_J.SetZero();if(this.m_revolute1){this.m_J.angularA=-1;m=m+e.m_invI}else{c=c.m_xf.R;h=this.m_prismatic1.m_localXAxis1;g=c.col1.x*h.x+c.col2.x*h.y;h=c.col1.y*h.x+c.col2.y*h.y;c=e.m_xf.R;j=this.m_localAnchor1.x-e.m_sweep.localCenter.x;k=this.m_localAnchor1.y-e.m_sweep.localCenter.y;l=c.col1.x*j+c.col2.x*k;k=c.col1.y*j+c.col2.y*k;j=l*h-k*g;this.m_J.linearA.Set(-g,-h);this.m_J.angularA=-j;m=m+(e.m_invMass+e.m_invI*j*j)}if(this.m_revolute2){this.m_J.angularB=-this.m_ratio;
m=m+this.m_ratio*this.m_ratio*f.m_invI}else{c=d.m_xf.R;h=this.m_prismatic2.m_localXAxis1;g=c.col1.x*h.x+c.col2.x*h.y;h=c.col1.y*h.x+c.col2.y*h.y;c=f.m_xf.R;j=this.m_localAnchor2.x-f.m_sweep.localCenter.x;k=this.m_localAnchor2.y-f.m_sweep.localCenter.y;l=c.col1.x*j+c.col2.x*k;k=c.col1.y*j+c.col2.y*k;j=l*h-k*g;this.m_J.linearB.Set(-this.m_ratio*g,-this.m_ratio*h);this.m_J.angularB=-this.m_ratio*j;m=m+this.m_ratio*this.m_ratio*(f.m_invMass+f.m_invI*j*j)}this.m_mass=m>0?1/m:0;if(b.warmStarting){e.m_linearVelocity.x=
e.m_linearVelocity.x+e.m_invMass*this.m_impulse*this.m_J.linearA.x;e.m_linearVelocity.y=e.m_linearVelocity.y+e.m_invMass*this.m_impulse*this.m_J.linearA.y;e.m_angularVelocity=e.m_angularVelocity+e.m_invI*this.m_impulse*this.m_J.angularA;f.m_linearVelocity.x=f.m_linearVelocity.x+f.m_invMass*this.m_impulse*this.m_J.linearB.x;f.m_linearVelocity.y=f.m_linearVelocity.y+f.m_invMass*this.m_impulse*this.m_J.linearB.y;f.m_angularVelocity=f.m_angularVelocity+f.m_invI*this.m_impulse*this.m_J.angularB}else this.m_impulse=
0};m.prototype.SolveVelocityConstraints=function(){var b=this.m_bodyA,c=this.m_bodyB,d=-this.m_mass*this.m_J.Compute(b.m_linearVelocity,b.m_angularVelocity,c.m_linearVelocity,c.m_angularVelocity);this.m_impulse=this.m_impulse+d;b.m_linearVelocity.x=b.m_linearVelocity.x+b.m_invMass*d*this.m_J.linearA.x;b.m_linearVelocity.y=b.m_linearVelocity.y+b.m_invMass*d*this.m_J.linearA.y;b.m_angularVelocity=b.m_angularVelocity+b.m_invI*d*this.m_J.angularA;c.m_linearVelocity.x=c.m_linearVelocity.x+c.m_invMass*
d*this.m_J.linearB.x;c.m_linearVelocity.y=c.m_linearVelocity.y+c.m_invMass*d*this.m_J.linearB.y;c.m_angularVelocity=c.m_angularVelocity+c.m_invI*d*this.m_J.angularB};m.prototype.SolvePositionConstraints=function(){var c=this.m_bodyA,d=this.m_bodyB,e=0,f=0,e=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),f=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation(),e=-this.m_mass*(this.m_constant-(e+this.m_ratio*f));c.m_sweep.c.x=
c.m_sweep.c.x+c.m_invMass*e*this.m_J.linearA.x;c.m_sweep.c.y=c.m_sweep.c.y+c.m_invMass*e*this.m_J.linearA.y;c.m_sweep.a=c.m_sweep.a+c.m_invI*e*this.m_J.angularA;d.m_sweep.c.x=d.m_sweep.c.x+d.m_invMass*e*this.m_J.linearB.x;d.m_sweep.c.y=d.m_sweep.c.y+d.m_invMass*e*this.m_J.linearB.y;d.m_sweep.a=d.m_sweep.a+d.m_invI*e*this.m_J.angularB;c.SynchronizeTransform();d.SynchronizeTransform();return 0<b.b2_linearSlop};Box2D.inherit(n,Box2D.Dynamics.Joints.b2JointDef);n.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;
n.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)};n.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this);this.type=p.e_gearJoint;this.joint2=this.joint1=null;this.ratio=1};q.b2Jacobian=function(){this.linearA=new f;this.linearB=new f};q.prototype.SetZero=function(){this.linearA.SetZero();this.angularA=0;this.linearB.SetZero();this.angularB=0};q.prototype.Set=function(b,c,d,e){c===void 0&&(c=0);e===void 0&&(e=0);this.linearA.SetV(b);this.angularA=
c;this.linearB.SetV(d);this.angularB=e};q.prototype.Compute=function(b,c,d,e){c===void 0&&(c=0);e===void 0&&(e=0);return this.linearA.x*b.x+this.linearA.y*b.y+this.angularA*c+(this.linearB.x*d.x+this.linearB.y*d.y)+this.angularB*e};p.b2Joint=function(){this.m_edgeA=new r;this.m_edgeB=new r;this.m_localCenterA=new f;this.m_localCenterB=new f};p.prototype.GetType=function(){return this.m_type};p.prototype.GetAnchorA=function(){return null};p.prototype.GetAnchorB=function(){return null};p.prototype.GetReactionForce=
function(){return null};p.prototype.GetReactionTorque=function(){return 0};p.prototype.GetBodyA=function(){return this.m_bodyA};p.prototype.GetBodyB=function(){return this.m_bodyB};p.prototype.GetNext=function(){return this.m_next};p.prototype.GetUserData=function(){return this.m_userData};p.prototype.SetUserData=function(b){this.m_userData=b};p.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()};p.Create=function(b){var c=null;switch(b.type){case p.e_distanceJoint:c=
new h(b instanceof j?b:null);break;case p.e_mouseJoint:c=new u(b instanceof w?b:null);break;case p.e_prismaticJoint:c=new z(b instanceof A?b:null);break;case p.e_revoluteJoint:c=new H(b instanceof K?b:null);break;case p.e_pulleyJoint:c=new C(b instanceof G?b:null);break;case p.e_gearJoint:c=new m(b instanceof n?b:null);break;case p.e_lineJoint:c=new o(b instanceof t?b:null);break;case p.e_weldJoint:c=new P(b instanceof T?b:null);break;case p.e_frictionJoint:c=new k(b instanceof l?b:null)}return c};
p.Destroy=function(){};p.prototype.b2Joint=function(c){b.b2Assert(c.bodyA!=c.bodyB);this.m_type=c.type;this.m_next=this.m_prev=null;this.m_bodyA=c.bodyA;this.m_bodyB=c.bodyB;this.m_collideConnected=c.collideConnected;this.m_islandFlag=false;this.m_userData=c.userData};p.prototype.InitVelocityConstraints=function(){};p.prototype.SolveVelocityConstraints=function(){};p.prototype.FinalizeVelocityConstraints=function(){};p.prototype.SolvePositionConstraints=function(){return false};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=
0;Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1;Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2;Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3;Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4;Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5;Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6;Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7;Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8;Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9;Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0;Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=
1;Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2;Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3});s.b2JointDef=function(){};s.prototype.b2JointDef=function(){this.type=p.e_unknownJoint;this.bodyB=this.bodyA=this.userData=null;this.collideConnected=false};r.b2JointEdge=function(){};Box2D.inherit(o,Box2D.Dynamics.Joints.b2Joint);o.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;o.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new f;this.m_localAnchor2=
new f;this.m_localXAxis1=new f;this.m_localYAxis1=new f;this.m_axis=new f;this.m_perp=new f;this.m_K=new c;this.m_impulse=new f};o.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};o.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};o.prototype.GetReactionForce=function(b){b===void 0&&(b=0);return new f(b*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),b*(this.m_impulse.x*this.m_perp.y+
(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))};o.prototype.GetReactionTorque=function(b){b===void 0&&(b=0);return b*this.m_impulse.y};o.prototype.GetJointTranslation=function(){var b=this.m_bodyA,c=this.m_bodyB,d=b.GetWorldPoint(this.m_localAnchor1),e=c.GetWorldPoint(this.m_localAnchor2),c=e.x-d.x,d=e.y-d.y,b=b.GetWorldVector(this.m_localXAxis1);return b.x*c+b.y*d};o.prototype.GetJointSpeed=function(){var b=this.m_bodyA,c=this.m_bodyB,d;d=b.m_xf.R;var e=this.m_localAnchor1.x-b.m_sweep.localCenter.x,
f=this.m_localAnchor1.y-b.m_sweep.localCenter.y,g=d.col1.x*e+d.col2.x*f,f=d.col1.y*e+d.col2.y*f,e=g;d=c.m_xf.R;var h=this.m_localAnchor2.x-c.m_sweep.localCenter.x,j=this.m_localAnchor2.y-c.m_sweep.localCenter.y,g=d.col1.x*h+d.col2.x*j,j=d.col1.y*h+d.col2.y*j,h=g;d=c.m_sweep.c.x+h-(b.m_sweep.c.x+e);var g=c.m_sweep.c.y+j-(b.m_sweep.c.y+f),k=b.GetWorldVector(this.m_localXAxis1),l=b.m_linearVelocity,m=c.m_linearVelocity,b=b.m_angularVelocity,c=c.m_angularVelocity;return d*-b*k.y+g*b*k.x+(k.x*(m.x+-c*
j-l.x- -b*f)+k.y*(m.y+c*h-l.y-b*e))};o.prototype.IsLimitEnabled=function(){return this.m_enableLimit};o.prototype.EnableLimit=function(b){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableLimit=b};o.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};o.prototype.GetUpperLimit=function(){return this.m_upperTranslation};o.prototype.SetLimits=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_lowerTranslation=
b;this.m_upperTranslation=c};o.prototype.IsMotorEnabled=function(){return this.m_enableMotor};o.prototype.EnableMotor=function(b){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableMotor=b};o.prototype.SetMotorSpeed=function(b){b===void 0&&(b=0);this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_motorSpeed=b};o.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};o.prototype.SetMaxMotorForce=function(b){b===void 0&&(b=0);this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);
this.m_maxMotorForce=b};o.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce};o.prototype.GetMotorForce=function(){return this.m_motorImpulse};o.prototype.b2LineJoint=function(b){this.__super.b2Joint.call(this,b);this.m_localAnchor1.SetV(b.localAnchorA);this.m_localAnchor2.SetV(b.localAnchorB);this.m_localXAxis1.SetV(b.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_impulse.SetZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=
b.lowerTranslation;this.m_upperTranslation=b.upperTranslation;this.m_maxMotorForce=b.maxMotorForce;this.m_motorSpeed=b.motorSpeed;this.m_enableLimit=b.enableLimit;this.m_enableMotor=b.enableMotor;this.m_limitState=p.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};o.prototype.InitVelocityConstraints=function(c){var d=this.m_bodyA,f=this.m_bodyB,g,h=0;this.m_localCenterA.SetV(d.GetLocalCenter());this.m_localCenterB.SetV(f.GetLocalCenter());var j=d.GetTransform();f.GetTransform();g=d.m_xf.R;
var k=this.m_localAnchor1.x-this.m_localCenterA.x,l=this.m_localAnchor1.y-this.m_localCenterA.y,h=g.col1.x*k+g.col2.x*l,l=g.col1.y*k+g.col2.y*l,k=h;g=f.m_xf.R;var m=this.m_localAnchor2.x-this.m_localCenterB.x,o=this.m_localAnchor2.y-this.m_localCenterB.y,h=g.col1.x*m+g.col2.x*o,o=g.col1.y*m+g.col2.y*o,m=h;g=f.m_sweep.c.x+m-d.m_sweep.c.x-k;h=f.m_sweep.c.y+o-d.m_sweep.c.y-l;this.m_invMassA=d.m_invMass;this.m_invMassB=f.m_invMass;this.m_invIA=d.m_invI;this.m_invIB=f.m_invI;this.m_axis.SetV(e.MulMV(j.R,
this.m_localXAxis1));this.m_a1=(g+k)*this.m_axis.y-(h+l)*this.m_axis.x;this.m_a2=m*this.m_axis.y-o*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;this.m_perp.SetV(e.MulMV(j.R,this.m_localYAxis1));this.m_s1=(g+k)*this.m_perp.y-(h+l)*this.m_perp.x;this.m_s2=m*this.m_perp.y-o*this.m_perp.x;j=this.m_invMassA;k=this.m_invMassB;l=this.m_invIA;m=this.m_invIB;
this.m_K.col1.x=j+k+l*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2;this.m_K.col1.y=l*this.m_s1*this.m_a1+m*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=j+k+l*this.m_a1*this.m_a1+m*this.m_a2*this.m_a2;if(this.m_enableLimit){g=this.m_axis.x*g+this.m_axis.y*h;if(e.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b.b2_linearSlop)this.m_limitState=p.e_equalLimits;else if(g<=this.m_lowerTranslation){if(this.m_limitState!=p.e_atLowerLimit){this.m_limitState=p.e_atLowerLimit;this.m_impulse.y=
0}}else if(g>=this.m_upperTranslation){if(this.m_limitState!=p.e_atUpperLimit){this.m_limitState=p.e_atUpperLimit;this.m_impulse.y=0}}else{this.m_limitState=p.e_inactiveLimit;this.m_impulse.y=0}}else this.m_limitState=p.e_inactiveLimit;if(this.m_enableMotor==false)this.m_motorImpulse=0;if(c.warmStarting){this.m_impulse.x=this.m_impulse.x*c.dtRatio;this.m_impulse.y=this.m_impulse.y*c.dtRatio;this.m_motorImpulse=this.m_motorImpulse*c.dtRatio;c=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*
this.m_axis.x;g=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y;h=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1;j=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;d.m_linearVelocity.x=d.m_linearVelocity.x-this.m_invMassA*c;d.m_linearVelocity.y=d.m_linearVelocity.y-this.m_invMassA*g;d.m_angularVelocity=d.m_angularVelocity-this.m_invIA*h;f.m_linearVelocity.x=f.m_linearVelocity.x+this.m_invMassB*c;f.m_linearVelocity.y=
f.m_linearVelocity.y+this.m_invMassB*g;f.m_angularVelocity=f.m_angularVelocity+this.m_invIB*j}else{this.m_impulse.SetZero();this.m_motorImpulse=0}};o.prototype.SolveVelocityConstraints=function(b){var c=this.m_bodyA,d=this.m_bodyB,g=c.m_linearVelocity,h=c.m_angularVelocity,j=d.m_linearVelocity,k=d.m_angularVelocity,l=0,m=0,o=0,n=0;if(this.m_enableMotor&&this.m_limitState!=p.e_equalLimits){n=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(j.x-g.x)+this.m_axis.y*(j.y-g.y)+this.m_a2*k-this.m_a1*
h));l=this.m_motorImpulse;m=b.dt*this.m_maxMotorForce;this.m_motorImpulse=e.Clamp(this.m_motorImpulse+n,-m,m);n=this.m_motorImpulse-l;l=n*this.m_axis.x;m=n*this.m_axis.y;o=n*this.m_a1;n=n*this.m_a2;g.x=g.x-this.m_invMassA*l;g.y=g.y-this.m_invMassA*m;h=h-this.m_invIA*o;j.x=j.x+this.m_invMassB*l;j.y=j.y+this.m_invMassB*m;k=k+this.m_invIB*n}m=this.m_perp.x*(j.x-g.x)+this.m_perp.y*(j.y-g.y)+this.m_s2*k-this.m_s1*h;if(this.m_enableLimit&&this.m_limitState!=p.e_inactiveLimit){o=this.m_axis.x*(j.x-g.x)+
this.m_axis.y*(j.y-g.y)+this.m_a2*k-this.m_a1*h;l=this.m_impulse.Copy();b=this.m_K.Solve(new f,-m,-o);this.m_impulse.Add(b);if(this.m_limitState==p.e_atLowerLimit)this.m_impulse.y=e.Max(this.m_impulse.y,0);else if(this.m_limitState==p.e_atUpperLimit)this.m_impulse.y=e.Min(this.m_impulse.y,0);m=-m-(this.m_impulse.y-l.y)*this.m_K.col2.x;o=this.m_K.col1.x!=0?m/this.m_K.col1.x+l.x:l.x;this.m_impulse.x=o;b.x=this.m_impulse.x-l.x;b.y=this.m_impulse.y-l.y;l=b.x*this.m_perp.x+b.y*this.m_axis.x;m=b.x*this.m_perp.y+
b.y*this.m_axis.y;o=b.x*this.m_s1+b.y*this.m_a1;n=b.x*this.m_s2+b.y*this.m_a2}else{b=this.m_K.col1.x!=0?-m/this.m_K.col1.x:0;this.m_impulse.x=this.m_impulse.x+b;l=b*this.m_perp.x;m=b*this.m_perp.y;o=b*this.m_s1;n=b*this.m_s2}g.x=g.x-this.m_invMassA*l;g.y=g.y-this.m_invMassA*m;h=h-this.m_invIA*o;j.x=j.x+this.m_invMassB*l;j.y=j.y+this.m_invMassB*m;k=k+this.m_invIB*n;c.m_linearVelocity.SetV(g);c.m_angularVelocity=h;d.m_linearVelocity.SetV(j);d.m_angularVelocity=k};o.prototype.SolvePositionConstraints=
function(){var d=this.m_bodyA,g=this.m_bodyB,h=d.m_sweep.c,j=d.m_sweep.a,k=g.m_sweep.c,l=g.m_sweep.a,m,o=0,n=0,s=0,p=0,q=0,t=0,n=false,r=0,u=c.FromAngle(j),s=c.FromAngle(l);m=u;var t=this.m_localAnchor1.x-this.m_localCenterA.x,w=this.m_localAnchor1.y-this.m_localCenterA.y,o=m.col1.x*t+m.col2.x*w,w=m.col1.y*t+m.col2.y*w,t=o;m=s;s=this.m_localAnchor2.x-this.m_localCenterB.x;p=this.m_localAnchor2.y-this.m_localCenterB.y;o=m.col1.x*s+m.col2.x*p;p=m.col1.y*s+m.col2.y*p;s=o;m=k.x+s-h.x-t;o=k.y+p-h.y-w;
if(this.m_enableLimit){this.m_axis=e.MulMV(u,this.m_localXAxis1);this.m_a1=(m+t)*this.m_axis.y-(o+w)*this.m_axis.x;this.m_a2=s*this.m_axis.y-p*this.m_axis.x;var A=this.m_axis.x*m+this.m_axis.y*o;if(e.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b.b2_linearSlop){r=e.Clamp(A,-b.b2_maxLinearCorrection,b.b2_maxLinearCorrection);q=e.Abs(A);n=true}else if(A<=this.m_lowerTranslation){r=e.Clamp(A-this.m_lowerTranslation+b.b2_linearSlop,-b.b2_maxLinearCorrection,0);q=this.m_lowerTranslation-A;n=
true}else if(A>=this.m_upperTranslation){r=e.Clamp(A-this.m_upperTranslation+b.b2_linearSlop,0,b.b2_maxLinearCorrection);q=A-this.m_upperTranslation;n=true}}this.m_perp=e.MulMV(u,this.m_localYAxis1);this.m_s1=(m+t)*this.m_perp.y-(o+w)*this.m_perp.x;this.m_s2=s*this.m_perp.y-p*this.m_perp.x;u=new f;w=this.m_perp.x*m+this.m_perp.y*o;q=e.Max(q,e.Abs(w));t=0;if(n){n=this.m_invMassA;s=this.m_invMassB;p=this.m_invIA;m=this.m_invIB;this.m_K.col1.x=n+s+p*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2;this.m_K.col1.y=
p*this.m_s1*this.m_a1+m*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=n+s+p*this.m_a1*this.m_a1+m*this.m_a2*this.m_a2;this.m_K.Solve(u,-w,-r)}else{n=this.m_invMassA;s=this.m_invMassB;p=this.m_invIA;m=this.m_invIB;r=n+s+p*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2;u.x=r!=0?-w/r:0;u.y=0}r=u.x*this.m_perp.x+u.y*this.m_axis.x;n=u.x*this.m_perp.y+u.y*this.m_axis.y;w=u.x*this.m_s1+u.y*this.m_a1;u=u.x*this.m_s2+u.y*this.m_a2;h.x=h.x-this.m_invMassA*r;h.y=h.y-this.m_invMassA*n;j=j-this.m_invIA*
w;k.x=k.x+this.m_invMassB*r;k.y=k.y+this.m_invMassB*n;l=l+this.m_invIB*u;d.m_sweep.a=j;g.m_sweep.a=l;d.SynchronizeTransform();g.SynchronizeTransform();return q<=b.b2_linearSlop&&t<=b.b2_angularSlop};Box2D.inherit(t,Box2D.Dynamics.Joints.b2JointDef);t.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;t.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new f;this.localAnchorB=new f;this.localAxisA=new f};t.prototype.b2LineJointDef=
function(){this.__super.b2JointDef.call(this);this.type=p.e_lineJoint;this.localAxisA.Set(1,0);this.enableLimit=false;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=false;this.motorSpeed=this.maxMotorForce=0};t.prototype.Initialize=function(b,c,d,e){this.bodyA=b;this.bodyB=c;this.localAnchorA=this.bodyA.GetLocalPoint(d);this.localAnchorB=this.bodyB.GetLocalPoint(d);this.localAxisA=this.bodyA.GetLocalVector(e)};Box2D.inherit(u,Box2D.Dynamics.Joints.b2Joint);u.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;
u.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new c;this.K1=new c;this.K2=new c;this.m_localAnchor=new f;this.m_target=new f;this.m_impulse=new f;this.m_mass=new c;this.m_C=new f};u.prototype.GetAnchorA=function(){return this.m_target};u.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)};u.prototype.GetReactionForce=function(b){b===void 0&&(b=0);return new f(b*this.m_impulse.x,b*this.m_impulse.y)};u.prototype.GetReactionTorque=
function(){return 0};u.prototype.GetTarget=function(){return this.m_target};u.prototype.SetTarget=function(b){this.m_bodyB.IsAwake()==false&&this.m_bodyB.SetAwake(true);this.m_target=b};u.prototype.GetMaxForce=function(){return this.m_maxForce};u.prototype.SetMaxForce=function(b){b===void 0&&(b=0);this.m_maxForce=b};u.prototype.GetFrequency=function(){return this.m_frequencyHz};u.prototype.SetFrequency=function(b){b===void 0&&(b=0);this.m_frequencyHz=b};u.prototype.GetDampingRatio=function(){return this.m_dampingRatio};
u.prototype.SetDampingRatio=function(b){b===void 0&&(b=0);this.m_dampingRatio=b};u.prototype.b2MouseJoint=function(b){this.__super.b2Joint.call(this,b);this.m_target.SetV(b.target);var c=this.m_target.x-this.m_bodyB.m_xf.position.x,d=this.m_target.y-this.m_bodyB.m_xf.position.y,e=this.m_bodyB.m_xf.R;this.m_localAnchor.x=c*e.col1.x+d*e.col1.y;this.m_localAnchor.y=c*e.col2.x+d*e.col2.y;this.m_maxForce=b.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=b.frequencyHz;this.m_dampingRatio=b.dampingRatio;
this.m_gamma=this.m_beta=0};u.prototype.InitVelocityConstraints=function(b){var c=this.m_bodyB,d=c.GetMass(),e=2*Math.PI*this.m_frequencyHz,f=d*e*e;this.m_gamma=b.dt*(2*d*this.m_dampingRatio*e+b.dt*f);this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0;this.m_beta=b.dt*f*this.m_gamma;var f=c.m_xf.R,d=this.m_localAnchor.x-c.m_sweep.localCenter.x,e=this.m_localAnchor.y-c.m_sweep.localCenter.y,g=f.col1.x*d+f.col2.x*e,e=f.col1.y*d+f.col2.y*e,d=g,f=c.m_invMass,g=c.m_invI;this.K1.col1.x=f;this.K1.col2.x=0;this.K1.col1.y=
0;this.K1.col2.y=f;this.K2.col1.x=g*e*e;this.K2.col2.x=-g*d*e;this.K2.col1.y=-g*d*e;this.K2.col2.y=g*d*d;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.col1.x=this.K.col1.x+this.m_gamma;this.K.col2.y=this.K.col2.y+this.m_gamma;this.K.GetInverse(this.m_mass);this.m_C.x=c.m_sweep.c.x+d-this.m_target.x;this.m_C.y=c.m_sweep.c.y+e-this.m_target.y;c.m_angularVelocity=c.m_angularVelocity*0.98;this.m_impulse.x=this.m_impulse.x*b.dtRatio;this.m_impulse.y=this.m_impulse.y*b.dtRatio;c.m_linearVelocity.x=c.m_linearVelocity.x+
f*this.m_impulse.x;c.m_linearVelocity.y=c.m_linearVelocity.y+f*this.m_impulse.y;c.m_angularVelocity=c.m_angularVelocity+g*(d*this.m_impulse.y-e*this.m_impulse.x)};u.prototype.SolveVelocityConstraints=function(b){var c=this.m_bodyB,d,e=0,f=0;d=c.m_xf.R;var g=this.m_localAnchor.x-c.m_sweep.localCenter.x,h=this.m_localAnchor.y-c.m_sweep.localCenter.y,e=d.col1.x*g+d.col2.x*h,h=d.col1.y*g+d.col2.y*h,g=e,e=c.m_linearVelocity.x+-c.m_angularVelocity*h,j=c.m_linearVelocity.y+c.m_angularVelocity*g;d=this.m_mass;
e=e+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;f=j+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;j=-(d.col1.x*e+d.col2.x*f);f=-(d.col1.y*e+d.col2.y*f);d=this.m_impulse.x;e=this.m_impulse.y;this.m_impulse.x=this.m_impulse.x+j;this.m_impulse.y=this.m_impulse.y+f;b=b.dt*this.m_maxForce;this.m_impulse.LengthSquared()>b*b&&this.m_impulse.Multiply(b/this.m_impulse.Length());j=this.m_impulse.x-d;f=this.m_impulse.y-e;c.m_linearVelocity.x=c.m_linearVelocity.x+c.m_invMass*j;c.m_linearVelocity.y=
c.m_linearVelocity.y+c.m_invMass*f;c.m_angularVelocity=c.m_angularVelocity+c.m_invI*(g*f-h*j)};u.prototype.SolvePositionConstraints=function(){return true};Box2D.inherit(w,Box2D.Dynamics.Joints.b2JointDef);w.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;w.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.target=new f};w.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this);this.type=p.e_mouseJoint;this.maxForce=0;this.frequencyHz=
5;this.dampingRatio=0.7};Box2D.inherit(z,Box2D.Dynamics.Joints.b2Joint);z.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;z.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new f;this.m_localAnchor2=new f;this.m_localXAxis1=new f;this.m_localYAxis1=new f;this.m_axis=new f;this.m_perp=new f;this.m_K=new d;this.m_impulse=new g};z.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};z.prototype.GetAnchorB=
function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};z.prototype.GetReactionForce=function(b){b===void 0&&(b=0);return new f(b*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),b*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))};z.prototype.GetReactionTorque=function(b){b===void 0&&(b=0);return b*this.m_impulse.y};z.prototype.GetJointTranslation=function(){var b=this.m_bodyA,c=this.m_bodyB,d=b.GetWorldPoint(this.m_localAnchor1),
e=c.GetWorldPoint(this.m_localAnchor2),c=e.x-d.x,d=e.y-d.y,b=b.GetWorldVector(this.m_localXAxis1);return b.x*c+b.y*d};z.prototype.GetJointSpeed=function(){var b=this.m_bodyA,c=this.m_bodyB,d;d=b.m_xf.R;var e=this.m_localAnchor1.x-b.m_sweep.localCenter.x,f=this.m_localAnchor1.y-b.m_sweep.localCenter.y,g=d.col1.x*e+d.col2.x*f,f=d.col1.y*e+d.col2.y*f,e=g;d=c.m_xf.R;var h=this.m_localAnchor2.x-c.m_sweep.localCenter.x,j=this.m_localAnchor2.y-c.m_sweep.localCenter.y,g=d.col1.x*h+d.col2.x*j,j=d.col1.y*h+
d.col2.y*j,h=g;d=c.m_sweep.c.x+h-(b.m_sweep.c.x+e);var g=c.m_sweep.c.y+j-(b.m_sweep.c.y+f),k=b.GetWorldVector(this.m_localXAxis1),l=b.m_linearVelocity,m=c.m_linearVelocity,b=b.m_angularVelocity,c=c.m_angularVelocity;return d*-b*k.y+g*b*k.x+(k.x*(m.x+-c*j-l.x- -b*f)+k.y*(m.y+c*h-l.y-b*e))};z.prototype.IsLimitEnabled=function(){return this.m_enableLimit};z.prototype.EnableLimit=function(b){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableLimit=b};z.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};
z.prototype.GetUpperLimit=function(){return this.m_upperTranslation};z.prototype.SetLimits=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_lowerTranslation=b;this.m_upperTranslation=c};z.prototype.IsMotorEnabled=function(){return this.m_enableMotor};z.prototype.EnableMotor=function(b){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableMotor=b};z.prototype.SetMotorSpeed=function(b){b===void 0&&(b=0);this.m_bodyA.SetAwake(true);
this.m_bodyB.SetAwake(true);this.m_motorSpeed=b};z.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};z.prototype.SetMaxMotorForce=function(b){b===void 0&&(b=0);this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_maxMotorForce=b};z.prototype.GetMotorForce=function(){return this.m_motorImpulse};z.prototype.b2PrismaticJoint=function(b){this.__super.b2Joint.call(this,b);this.m_localAnchor1.SetV(b.localAnchorA);this.m_localAnchor2.SetV(b.localAnchorB);this.m_localXAxis1.SetV(b.localAxisA);
this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=b.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=b.lowerTranslation;this.m_upperTranslation=b.upperTranslation;this.m_maxMotorForce=b.maxMotorForce;this.m_motorSpeed=b.motorSpeed;this.m_enableLimit=b.enableLimit;this.m_enableMotor=b.enableMotor;this.m_limitState=p.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};z.prototype.InitVelocityConstraints=
function(c){var d=this.m_bodyA,f=this.m_bodyB,g,h=0;this.m_localCenterA.SetV(d.GetLocalCenter());this.m_localCenterB.SetV(f.GetLocalCenter());var j=d.GetTransform();f.GetTransform();g=d.m_xf.R;var k=this.m_localAnchor1.x-this.m_localCenterA.x,l=this.m_localAnchor1.y-this.m_localCenterA.y,h=g.col1.x*k+g.col2.x*l,l=g.col1.y*k+g.col2.y*l,k=h;g=f.m_xf.R;var m=this.m_localAnchor2.x-this.m_localCenterB.x,o=this.m_localAnchor2.y-this.m_localCenterB.y,h=g.col1.x*m+g.col2.x*o,o=g.col1.y*m+g.col2.y*o,m=h;g=
f.m_sweep.c.x+m-d.m_sweep.c.x-k;h=f.m_sweep.c.y+o-d.m_sweep.c.y-l;this.m_invMassA=d.m_invMass;this.m_invMassB=f.m_invMass;this.m_invIA=d.m_invI;this.m_invIB=f.m_invI;this.m_axis.SetV(e.MulMV(j.R,this.m_localXAxis1));this.m_a1=(g+k)*this.m_axis.y-(h+l)*this.m_axis.x;this.m_a2=m*this.m_axis.y-o*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;if(this.m_motorMass>Number.MIN_VALUE)this.m_motorMass=1/this.m_motorMass;this.m_perp.SetV(e.MulMV(j.R,
this.m_localYAxis1));this.m_s1=(g+k)*this.m_perp.y-(h+l)*this.m_perp.x;this.m_s2=m*this.m_perp.y-o*this.m_perp.x;j=this.m_invMassA;k=this.m_invMassB;l=this.m_invIA;m=this.m_invIB;this.m_K.col1.x=j+k+l*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2;this.m_K.col1.y=l*this.m_s1+m*this.m_s2;this.m_K.col1.z=l*this.m_s1*this.m_a1+m*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=l+m;this.m_K.col2.z=l*this.m_a1+m*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=
j+k+l*this.m_a1*this.m_a1+m*this.m_a2*this.m_a2;if(this.m_enableLimit){g=this.m_axis.x*g+this.m_axis.y*h;if(e.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b.b2_linearSlop)this.m_limitState=p.e_equalLimits;else if(g<=this.m_lowerTranslation){if(this.m_limitState!=p.e_atLowerLimit){this.m_limitState=p.e_atLowerLimit;this.m_impulse.z=0}}else if(g>=this.m_upperTranslation){if(this.m_limitState!=p.e_atUpperLimit){this.m_limitState=p.e_atUpperLimit;this.m_impulse.z=0}}else{this.m_limitState=p.e_inactiveLimit;
this.m_impulse.z=0}}else this.m_limitState=p.e_inactiveLimit;if(this.m_enableMotor==false)this.m_motorImpulse=0;if(c.warmStarting){this.m_impulse.x=this.m_impulse.x*c.dtRatio;this.m_impulse.y=this.m_impulse.y*c.dtRatio;this.m_motorImpulse=this.m_motorImpulse*c.dtRatio;c=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x;g=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y;h=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+
this.m_impulse.z)*this.m_a1;j=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;d.m_linearVelocity.x=d.m_linearVelocity.x-this.m_invMassA*c;d.m_linearVelocity.y=d.m_linearVelocity.y-this.m_invMassA*g;d.m_angularVelocity=d.m_angularVelocity-this.m_invIA*h;f.m_linearVelocity.x=f.m_linearVelocity.x+this.m_invMassB*c;f.m_linearVelocity.y=f.m_linearVelocity.y+this.m_invMassB*g;f.m_angularVelocity=f.m_angularVelocity+this.m_invIB*j}else{this.m_impulse.SetZero();
this.m_motorImpulse=0}};z.prototype.SolveVelocityConstraints=function(b){var c=this.m_bodyA,d=this.m_bodyB,h=c.m_linearVelocity,j=c.m_angularVelocity,k=d.m_linearVelocity,l=d.m_angularVelocity,m=0,o=0,n=0,s=0;if(this.m_enableMotor&&this.m_limitState!=p.e_equalLimits){s=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(k.x-h.x)+this.m_axis.y*(k.y-h.y)+this.m_a2*l-this.m_a1*j));m=this.m_motorImpulse;b=b.dt*this.m_maxMotorForce;this.m_motorImpulse=e.Clamp(this.m_motorImpulse+s,-b,b);s=this.m_motorImpulse-
m;m=s*this.m_axis.x;o=s*this.m_axis.y;n=s*this.m_a1;s=s*this.m_a2;h.x=h.x-this.m_invMassA*m;h.y=h.y-this.m_invMassA*o;j=j-this.m_invIA*n;k.x=k.x+this.m_invMassB*m;k.y=k.y+this.m_invMassB*o;l=l+this.m_invIB*s}n=this.m_perp.x*(k.x-h.x)+this.m_perp.y*(k.y-h.y)+this.m_s2*l-this.m_s1*j;o=l-j;if(this.m_enableLimit&&this.m_limitState!=p.e_inactiveLimit){b=this.m_axis.x*(k.x-h.x)+this.m_axis.y*(k.y-h.y)+this.m_a2*l-this.m_a1*j;m=this.m_impulse.Copy();b=this.m_K.Solve33(new g,-n,-o,-b);this.m_impulse.Add(b);
if(this.m_limitState==p.e_atLowerLimit)this.m_impulse.z=e.Max(this.m_impulse.z,0);else if(this.m_limitState==p.e_atUpperLimit)this.m_impulse.z=e.Min(this.m_impulse.z,0);n=-n-(this.m_impulse.z-m.z)*this.m_K.col3.x;o=-o-(this.m_impulse.z-m.z)*this.m_K.col3.y;o=this.m_K.Solve22(new f,n,o);o.x=o.x+m.x;o.y=o.y+m.y;this.m_impulse.x=o.x;this.m_impulse.y=o.y;b.x=this.m_impulse.x-m.x;b.y=this.m_impulse.y-m.y;b.z=this.m_impulse.z-m.z;m=b.x*this.m_perp.x+b.z*this.m_axis.x;o=b.x*this.m_perp.y+b.z*this.m_axis.y;
n=b.x*this.m_s1+b.y+b.z*this.m_a1;s=b.x*this.m_s2+b.y+b.z*this.m_a2}else{b=this.m_K.Solve22(new f,-n,-o);this.m_impulse.x=this.m_impulse.x+b.x;this.m_impulse.y=this.m_impulse.y+b.y;m=b.x*this.m_perp.x;o=b.x*this.m_perp.y;n=b.x*this.m_s1+b.y;s=b.x*this.m_s2+b.y}h.x=h.x-this.m_invMassA*m;h.y=h.y-this.m_invMassA*o;j=j-this.m_invIA*n;k.x=k.x+this.m_invMassB*m;k.y=k.y+this.m_invMassB*o;l=l+this.m_invIB*s;c.m_linearVelocity.SetV(h);c.m_angularVelocity=j;d.m_linearVelocity.SetV(k);d.m_angularVelocity=l};
z.prototype.SolvePositionConstraints=function(){var d=this.m_bodyA,h=this.m_bodyB,j=d.m_sweep.c,k=d.m_sweep.a,l=h.m_sweep.c,m=h.m_sweep.a,o,n=0,s=0,p=0,q=0,t=0,s=false,r=0,u=c.FromAngle(k),w=c.FromAngle(m);o=u;var t=this.m_localAnchor1.x-this.m_localCenterA.x,A=this.m_localAnchor1.y-this.m_localCenterA.y,n=o.col1.x*t+o.col2.x*A,A=o.col1.y*t+o.col2.y*A,t=n;o=w;w=this.m_localAnchor2.x-this.m_localCenterB.x;p=this.m_localAnchor2.y-this.m_localCenterB.y;n=o.col1.x*w+o.col2.x*p;p=o.col1.y*w+o.col2.y*p;
w=n;o=l.x+w-j.x-t;n=l.y+p-j.y-A;if(this.m_enableLimit){this.m_axis=e.MulMV(u,this.m_localXAxis1);this.m_a1=(o+t)*this.m_axis.y-(n+A)*this.m_axis.x;this.m_a2=w*this.m_axis.y-p*this.m_axis.x;var z=this.m_axis.x*o+this.m_axis.y*n;if(e.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b.b2_linearSlop){r=e.Clamp(z,-b.b2_maxLinearCorrection,b.b2_maxLinearCorrection);q=e.Abs(z);s=true}else if(z<=this.m_lowerTranslation){r=e.Clamp(z-this.m_lowerTranslation+b.b2_linearSlop,-b.b2_maxLinearCorrection,0);
q=this.m_lowerTranslation-z;s=true}else if(z>=this.m_upperTranslation){r=e.Clamp(z-this.m_upperTranslation+b.b2_linearSlop,0,b.b2_maxLinearCorrection);q=z-this.m_upperTranslation;s=true}}this.m_perp=e.MulMV(u,this.m_localYAxis1);this.m_s1=(o+t)*this.m_perp.y-(n+A)*this.m_perp.x;this.m_s2=w*this.m_perp.y-p*this.m_perp.x;u=new g;A=this.m_perp.x*o+this.m_perp.y*n;w=m-k-this.m_refAngle;q=e.Max(q,e.Abs(A));t=e.Abs(w);if(s){s=this.m_invMassA;p=this.m_invMassB;o=this.m_invIA;n=this.m_invIB;this.m_K.col1.x=
s+p+o*this.m_s1*this.m_s1+n*this.m_s2*this.m_s2;this.m_K.col1.y=o*this.m_s1+n*this.m_s2;this.m_K.col1.z=o*this.m_s1*this.m_a1+n*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=o+n;this.m_K.col2.z=o*this.m_a1+n*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=s+p+o*this.m_a1*this.m_a1+n*this.m_a2*this.m_a2;this.m_K.Solve33(u,-A,-w,-r)}else{s=this.m_invMassA;p=this.m_invMassB;o=this.m_invIA;n=this.m_invIB;r=o*this.m_s1+n*this.m_s2;z=o+n;this.m_K.col1.Set(s+
p+o*this.m_s1*this.m_s1+n*this.m_s2*this.m_s2,r,0);this.m_K.col2.Set(r,z,0);r=this.m_K.Solve22(new f,-A,-w);u.x=r.x;u.y=r.y;u.z=0}r=u.x*this.m_perp.x+u.z*this.m_axis.x;s=u.x*this.m_perp.y+u.z*this.m_axis.y;A=u.x*this.m_s1+u.y+u.z*this.m_a1;u=u.x*this.m_s2+u.y+u.z*this.m_a2;j.x=j.x-this.m_invMassA*r;j.y=j.y-this.m_invMassA*s;k=k-this.m_invIA*A;l.x=l.x+this.m_invMassB*r;l.y=l.y+this.m_invMassB*s;m=m+this.m_invIB*u;d.m_sweep.a=k;h.m_sweep.a=m;d.SynchronizeTransform();h.SynchronizeTransform();return q<=
b.b2_linearSlop&&t<=b.b2_angularSlop};Box2D.inherit(A,Box2D.Dynamics.Joints.b2JointDef);A.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;A.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new f;this.localAnchorB=new f;this.localAxisA=new f};A.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this);this.type=p.e_prismaticJoint;this.localAxisA.Set(1,0);this.referenceAngle=0;this.enableLimit=false;this.upperTranslation=
this.lowerTranslation=0;this.enableMotor=false;this.motorSpeed=this.maxMotorForce=0};A.prototype.Initialize=function(b,c,d,e){this.bodyA=b;this.bodyB=c;this.localAnchorA=this.bodyA.GetLocalPoint(d);this.localAnchorB=this.bodyB.GetLocalPoint(d);this.localAxisA=this.bodyA.GetLocalVector(e);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};Box2D.inherit(C,Box2D.Dynamics.Joints.b2Joint);C.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;C.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,
arguments);this.m_groundAnchor1=new f;this.m_groundAnchor2=new f;this.m_localAnchor1=new f;this.m_localAnchor2=new f;this.m_u1=new f;this.m_u2=new f};C.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};C.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};C.prototype.GetReactionForce=function(b){b===void 0&&(b=0);return new f(b*this.m_impulse*this.m_u2.x,b*this.m_impulse*this.m_u2.y)};C.prototype.GetReactionTorque=function(){return 0};
C.prototype.GetGroundAnchorA=function(){var b=this.m_ground.m_xf.position.Copy();b.Add(this.m_groundAnchor1);return b};C.prototype.GetGroundAnchorB=function(){var b=this.m_ground.m_xf.position.Copy();b.Add(this.m_groundAnchor2);return b};C.prototype.GetLength1=function(){var b=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),c=b.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),b=b.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y);return Math.sqrt(c*c+b*b)};C.prototype.GetLength2=function(){var b=
this.m_bodyB.GetWorldPoint(this.m_localAnchor2),c=b.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor2.x),b=b.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor2.y);return Math.sqrt(c*c+b*b)};C.prototype.GetRatio=function(){return this.m_ratio};C.prototype.b2PulleyJoint=function(b){this.__super.b2Joint.call(this,b);this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=b.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=b.groundAnchorA.y-this.m_ground.m_xf.position.y;
this.m_groundAnchor2.x=b.groundAnchorB.x-this.m_ground.m_xf.position.x;this.m_groundAnchor2.y=b.groundAnchorB.y-this.m_ground.m_xf.position.y;this.m_localAnchor1.SetV(b.localAnchorA);this.m_localAnchor2.SetV(b.localAnchorB);this.m_ratio=b.ratio;this.m_constant=b.lengthA+this.m_ratio*b.lengthB;this.m_maxLength1=e.Min(b.maxLengthA,this.m_constant-this.m_ratio*C.b2_minPulleyLength);this.m_maxLength2=e.Min(b.maxLengthB,(this.m_constant-C.b2_minPulleyLength)/this.m_ratio);this.m_limitImpulse2=this.m_limitImpulse1=
this.m_impulse=0};C.prototype.InitVelocityConstraints=function(c){var d=this.m_bodyA,e=this.m_bodyB,f;f=d.m_xf.R;var g=this.m_localAnchor1.x-d.m_sweep.localCenter.x,h=this.m_localAnchor1.y-d.m_sweep.localCenter.y,j=f.col1.x*g+f.col2.x*h,h=f.col1.y*g+f.col2.y*h,g=j;f=e.m_xf.R;var k=this.m_localAnchor2.x-e.m_sweep.localCenter.x,l=this.m_localAnchor2.y-e.m_sweep.localCenter.y,j=f.col1.x*k+f.col2.x*l,l=f.col1.y*k+f.col2.y*l,k=j;f=e.m_sweep.c.x+k;var j=e.m_sweep.c.y+l,m=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,
o=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(d.m_sweep.c.x+g-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),d.m_sweep.c.y+h-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y));this.m_u2.Set(f-m,j-o);f=this.m_u1.Length();j=this.m_u2.Length();f>b.b2_linearSlop?this.m_u1.Multiply(1/f):this.m_u1.SetZero();j>b.b2_linearSlop?this.m_u2.Multiply(1/j):this.m_u2.SetZero();if(this.m_constant-f-this.m_ratio*j>0){this.m_state=p.e_inactiveLimit;this.m_impulse=0}else this.m_state=
p.e_atUpperLimit;if(f<this.m_maxLength1){this.m_limitState1=p.e_inactiveLimit;this.m_limitImpulse1=0}else this.m_limitState1=p.e_atUpperLimit;if(j<this.m_maxLength2){this.m_limitState2=p.e_inactiveLimit;this.m_limitImpulse2=0}else this.m_limitState2=p.e_atUpperLimit;f=g*this.m_u1.y-h*this.m_u1.x;j=k*this.m_u2.y-l*this.m_u2.x;this.m_limitMass1=d.m_invMass+d.m_invI*f*f;this.m_limitMass2=e.m_invMass+e.m_invI*j*j;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;this.m_limitMass1=
1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;if(c.warmStarting){this.m_impulse=this.m_impulse*c.dtRatio;this.m_limitImpulse1=this.m_limitImpulse1*c.dtRatio;this.m_limitImpulse2=this.m_limitImpulse2*c.dtRatio;c=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x;f=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y;j=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x;m=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;d.m_linearVelocity.x=
d.m_linearVelocity.x+d.m_invMass*c;d.m_linearVelocity.y=d.m_linearVelocity.y+d.m_invMass*f;d.m_angularVelocity=d.m_angularVelocity+d.m_invI*(g*f-h*c);e.m_linearVelocity.x=e.m_linearVelocity.x+e.m_invMass*j;e.m_linearVelocity.y=e.m_linearVelocity.y+e.m_invMass*m;e.m_angularVelocity=e.m_angularVelocity+e.m_invI*(k*m-l*j)}else this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0};C.prototype.SolveVelocityConstraints=function(){var b=this.m_bodyA,c=this.m_bodyB,d;d=b.m_xf.R;var f=this.m_localAnchor1.x-
b.m_sweep.localCenter.x,g=this.m_localAnchor1.y-b.m_sweep.localCenter.y,h=d.col1.x*f+d.col2.x*g,g=d.col1.y*f+d.col2.y*g,f=h;d=c.m_xf.R;var j=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,h=d.col1.x*j+d.col2.x*k,k=d.col1.y*j+d.col2.y*k,j=h,l=0,m=0;if(this.m_state==p.e_atUpperLimit){d=b.m_linearVelocity.x+-b.m_angularVelocity*g;h=b.m_linearVelocity.y+b.m_angularVelocity*f;l=c.m_linearVelocity.x+-c.m_angularVelocity*k;m=c.m_linearVelocity.y+c.m_angularVelocity*
j;d=-(this.m_u1.x*d+this.m_u1.y*h)-this.m_ratio*(this.m_u2.x*l+this.m_u2.y*m);m=this.m_pulleyMass*-d;d=this.m_impulse;this.m_impulse=e.Max(0,this.m_impulse+m);m=this.m_impulse-d;d=-m*this.m_u1.x;h=-m*this.m_u1.y;l=-this.m_ratio*m*this.m_u2.x;m=-this.m_ratio*m*this.m_u2.y;b.m_linearVelocity.x=b.m_linearVelocity.x+b.m_invMass*d;b.m_linearVelocity.y=b.m_linearVelocity.y+b.m_invMass*h;b.m_angularVelocity=b.m_angularVelocity+b.m_invI*(f*h-g*d);c.m_linearVelocity.x=c.m_linearVelocity.x+c.m_invMass*l;c.m_linearVelocity.y=
c.m_linearVelocity.y+c.m_invMass*m;c.m_angularVelocity=c.m_angularVelocity+c.m_invI*(j*m-k*l)}if(this.m_limitState1==p.e_atUpperLimit){d=b.m_linearVelocity.x+-b.m_angularVelocity*g;h=b.m_linearVelocity.y+b.m_angularVelocity*f;d=-(this.m_u1.x*d+this.m_u1.y*h);m=-this.m_limitMass1*d;d=this.m_limitImpulse1;this.m_limitImpulse1=e.Max(0,this.m_limitImpulse1+m);m=this.m_limitImpulse1-d;d=-m*this.m_u1.x;h=-m*this.m_u1.y;b.m_linearVelocity.x=b.m_linearVelocity.x+b.m_invMass*d;b.m_linearVelocity.y=b.m_linearVelocity.y+
b.m_invMass*h;b.m_angularVelocity=b.m_angularVelocity+b.m_invI*(f*h-g*d)}if(this.m_limitState2==p.e_atUpperLimit){l=c.m_linearVelocity.x+-c.m_angularVelocity*k;m=c.m_linearVelocity.y+c.m_angularVelocity*j;d=-(this.m_u2.x*l+this.m_u2.y*m);m=-this.m_limitMass2*d;d=this.m_limitImpulse2;this.m_limitImpulse2=e.Max(0,this.m_limitImpulse2+m);m=this.m_limitImpulse2-d;l=-m*this.m_u2.x;m=-m*this.m_u2.y;c.m_linearVelocity.x=c.m_linearVelocity.x+c.m_invMass*l;c.m_linearVelocity.y=c.m_linearVelocity.y+c.m_invMass*
m;c.m_angularVelocity=c.m_angularVelocity+c.m_invI*(j*m-k*l)}};C.prototype.SolvePositionConstraints=function(){var c=this.m_bodyA,d=this.m_bodyB,f,g=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,h=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,j=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,k=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,l=0,m=0,o=0,n=0,s=0,q=0,t=0,r=0;if(this.m_state==p.e_atUpperLimit){f=c.m_xf.R;l=this.m_localAnchor1.x-c.m_sweep.localCenter.x;m=this.m_localAnchor1.y-
c.m_sweep.localCenter.y;s=f.col1.x*l+f.col2.x*m;m=f.col1.y*l+f.col2.y*m;l=s;f=d.m_xf.R;o=this.m_localAnchor2.x-d.m_sweep.localCenter.x;n=this.m_localAnchor2.y-d.m_sweep.localCenter.y;s=f.col1.x*o+f.col2.x*n;n=f.col1.y*o+f.col2.y*n;o=s;f=c.m_sweep.c.x+l;s=c.m_sweep.c.y+m;q=d.m_sweep.c.x+o;t=d.m_sweep.c.y+n;this.m_u1.Set(f-g,s-h);this.m_u2.Set(q-j,t-k);f=this.m_u1.Length();s=this.m_u2.Length();f>b.b2_linearSlop?this.m_u1.Multiply(1/f):this.m_u1.SetZero();s>b.b2_linearSlop?this.m_u2.Multiply(1/s):this.m_u2.SetZero();
f=this.m_constant-f-this.m_ratio*s;r=e.Max(r,-f);f=e.Clamp(f+b.b2_linearSlop,-b.b2_maxLinearCorrection,0);t=-this.m_pulleyMass*f;f=-t*this.m_u1.x;s=-t*this.m_u1.y;q=-this.m_ratio*t*this.m_u2.x;t=-this.m_ratio*t*this.m_u2.y;c.m_sweep.c.x=c.m_sweep.c.x+c.m_invMass*f;c.m_sweep.c.y=c.m_sweep.c.y+c.m_invMass*s;c.m_sweep.a=c.m_sweep.a+c.m_invI*(l*s-m*f);d.m_sweep.c.x=d.m_sweep.c.x+d.m_invMass*q;d.m_sweep.c.y=d.m_sweep.c.y+d.m_invMass*t;d.m_sweep.a=d.m_sweep.a+d.m_invI*(o*t-n*q);c.SynchronizeTransform();
d.SynchronizeTransform()}if(this.m_limitState1==p.e_atUpperLimit){f=c.m_xf.R;l=this.m_localAnchor1.x-c.m_sweep.localCenter.x;m=this.m_localAnchor1.y-c.m_sweep.localCenter.y;s=f.col1.x*l+f.col2.x*m;m=f.col1.y*l+f.col2.y*m;l=s;f=c.m_sweep.c.x+l;s=c.m_sweep.c.y+m;this.m_u1.Set(f-g,s-h);f=this.m_u1.Length();if(f>b.b2_linearSlop){this.m_u1.x=this.m_u1.x*(1/f);this.m_u1.y=this.m_u1.y*(1/f)}else this.m_u1.SetZero();f=this.m_maxLength1-f;r=e.Max(r,-f);f=e.Clamp(f+b.b2_linearSlop,-b.b2_maxLinearCorrection,
0);t=-this.m_limitMass1*f;f=-t*this.m_u1.x;s=-t*this.m_u1.y;c.m_sweep.c.x=c.m_sweep.c.x+c.m_invMass*f;c.m_sweep.c.y=c.m_sweep.c.y+c.m_invMass*s;c.m_sweep.a=c.m_sweep.a+c.m_invI*(l*s-m*f);c.SynchronizeTransform()}if(this.m_limitState2==p.e_atUpperLimit){f=d.m_xf.R;o=this.m_localAnchor2.x-d.m_sweep.localCenter.x;n=this.m_localAnchor2.y-d.m_sweep.localCenter.y;s=f.col1.x*o+f.col2.x*n;n=f.col1.y*o+f.col2.y*n;o=s;q=d.m_sweep.c.x+o;t=d.m_sweep.c.y+n;this.m_u2.Set(q-j,t-k);s=this.m_u2.Length();if(s>b.b2_linearSlop){this.m_u2.x=
this.m_u2.x*(1/s);this.m_u2.y=this.m_u2.y*(1/s)}else this.m_u2.SetZero();f=this.m_maxLength2-s;r=e.Max(r,-f);f=e.Clamp(f+b.b2_linearSlop,-b.b2_maxLinearCorrection,0);t=-this.m_limitMass2*f;q=-t*this.m_u2.x;t=-t*this.m_u2.y;d.m_sweep.c.x=d.m_sweep.c.x+d.m_invMass*q;d.m_sweep.c.y=d.m_sweep.c.y+d.m_invMass*t;d.m_sweep.a=d.m_sweep.a+d.m_invI*(o*t-n*q);d.SynchronizeTransform()}return r<b.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2});Box2D.inherit(G,
Box2D.Dynamics.Joints.b2JointDef);G.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;G.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.groundAnchorA=new f;this.groundAnchorB=new f;this.localAnchorA=new f;this.localAnchorB=new f};G.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this);this.type=p.e_pulleyJoint;this.groundAnchorA.Set(-1,1);this.groundAnchorB.Set(1,1);this.localAnchorA.Set(-1,0);this.localAnchorB.Set(1,
0);this.maxLengthB=this.lengthB=this.maxLengthA=this.lengthA=0;this.ratio=1;this.collideConnected=true};G.prototype.Initialize=function(b,c,d,e,f,g,h){h===void 0&&(h=0);this.bodyA=b;this.bodyB=c;this.groundAnchorA.SetV(d);this.groundAnchorB.SetV(e);this.localAnchorA=this.bodyA.GetLocalPoint(f);this.localAnchorB=this.bodyB.GetLocalPoint(g);b=f.x-d.x;d=f.y-d.y;this.lengthA=Math.sqrt(b*b+d*d);d=g.x-e.x;e=g.y-e.y;this.lengthB=Math.sqrt(d*d+e*e);this.ratio=h;h=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=
h-this.ratio*C.b2_minPulleyLength;this.maxLengthB=(h-C.b2_minPulleyLength)/this.ratio};Box2D.inherit(H,Box2D.Dynamics.Joints.b2Joint);H.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;H.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new c;this.K1=new c;this.K2=new c;this.K3=new c;this.impulse3=new g;this.impulse2=new f;this.reduced=new f;this.m_localAnchor1=new f;this.m_localAnchor2=new f;this.m_impulse=new g;this.m_mass=new d};H.prototype.GetAnchorA=
function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};H.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};H.prototype.GetReactionForce=function(b){b===void 0&&(b=0);return new f(b*this.m_impulse.x,b*this.m_impulse.y)};H.prototype.GetReactionTorque=function(b){b===void 0&&(b=0);return b*this.m_impulse.z};H.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle};H.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-
this.m_bodyA.m_angularVelocity};H.prototype.IsLimitEnabled=function(){return this.m_enableLimit};H.prototype.EnableLimit=function(b){this.m_enableLimit=b};H.prototype.GetLowerLimit=function(){return this.m_lowerAngle};H.prototype.GetUpperLimit=function(){return this.m_upperAngle};H.prototype.SetLimits=function(b,c){b===void 0&&(b=0);c===void 0&&(c=0);this.m_lowerAngle=b;this.m_upperAngle=c};H.prototype.IsMotorEnabled=function(){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);return this.m_enableMotor};
H.prototype.EnableMotor=function(b){this.m_enableMotor=b};H.prototype.SetMotorSpeed=function(b){b===void 0&&(b=0);this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_motorSpeed=b};H.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};H.prototype.SetMaxMotorTorque=function(b){b===void 0&&(b=0);this.m_maxMotorTorque=b};H.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque};H.prototype.b2RevoluteJoint=function(b){this.__super.b2Joint.call(this,b);this.m_localAnchor1.SetV(b.localAnchorA);
this.m_localAnchor2.SetV(b.localAnchorB);this.m_referenceAngle=b.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;this.m_lowerAngle=b.lowerAngle;this.m_upperAngle=b.upperAngle;this.m_maxMotorTorque=b.maxMotorTorque;this.m_motorSpeed=b.motorSpeed;this.m_enableLimit=b.enableLimit;this.m_enableMotor=b.enableMotor;this.m_limitState=p.e_inactiveLimit};H.prototype.InitVelocityConstraints=function(c){var d=this.m_bodyA,f=this.m_bodyB,g,h=0;g=d.m_xf.R;var j=this.m_localAnchor1.x-d.m_sweep.localCenter.x,
k=this.m_localAnchor1.y-d.m_sweep.localCenter.y,h=g.col1.x*j+g.col2.x*k,k=g.col1.y*j+g.col2.y*k,j=h;g=f.m_xf.R;var l=this.m_localAnchor2.x-f.m_sweep.localCenter.x,m=this.m_localAnchor2.y-f.m_sweep.localCenter.y,h=g.col1.x*l+g.col2.x*m,m=g.col1.y*l+g.col2.y*m,l=h;g=d.m_invMass;var h=f.m_invMass,o=d.m_invI,n=f.m_invI;this.m_mass.col1.x=g+h+k*k*o+m*m*n;this.m_mass.col2.x=-k*j*o-m*l*n;this.m_mass.col3.x=-k*o-m*n;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=g+h+j*j*o+l*l*n;this.m_mass.col3.y=
j*o+l*n;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=o+n;this.m_motorMass=1/(o+n);if(this.m_enableMotor==false)this.m_motorImpulse=0;if(this.m_enableLimit){var s=f.m_sweep.a-d.m_sweep.a-this.m_referenceAngle;if(e.Abs(this.m_upperAngle-this.m_lowerAngle)<2*b.b2_angularSlop)this.m_limitState=p.e_equalLimits;else if(s<=this.m_lowerAngle){if(this.m_limitState!=p.e_atLowerLimit)this.m_impulse.z=0;this.m_limitState=p.e_atLowerLimit}else if(s>=this.m_upperAngle){if(this.m_limitState!=
p.e_atUpperLimit)this.m_impulse.z=0;this.m_limitState=p.e_atUpperLimit}else{this.m_limitState=p.e_inactiveLimit;this.m_impulse.z=0}}else this.m_limitState=p.e_inactiveLimit;if(c.warmStarting){this.m_impulse.x=this.m_impulse.x*c.dtRatio;this.m_impulse.y=this.m_impulse.y*c.dtRatio;this.m_motorImpulse=this.m_motorImpulse*c.dtRatio;c=this.m_impulse.x;s=this.m_impulse.y;d.m_linearVelocity.x=d.m_linearVelocity.x-g*c;d.m_linearVelocity.y=d.m_linearVelocity.y-g*s;d.m_angularVelocity=d.m_angularVelocity-o*
(j*s-k*c+this.m_motorImpulse+this.m_impulse.z);f.m_linearVelocity.x=f.m_linearVelocity.x+h*c;f.m_linearVelocity.y=f.m_linearVelocity.y+h*s;f.m_angularVelocity=f.m_angularVelocity+n*(l*s-m*c+this.m_motorImpulse+this.m_impulse.z)}else{this.m_impulse.SetZero();this.m_motorImpulse=0}};H.prototype.SolveVelocityConstraints=function(b){var c=this.m_bodyA,d=this.m_bodyB,f=0,g=0,h=0,j=0,k=0,l=c.m_linearVelocity,m=c.m_angularVelocity,o=d.m_linearVelocity,n=d.m_angularVelocity,s=c.m_invMass,q=d.m_invMass,t=
c.m_invI,r=d.m_invI;if(this.m_enableMotor&&this.m_limitState!=p.e_equalLimits){g=this.m_motorMass*-(n-m-this.m_motorSpeed);h=this.m_motorImpulse;j=b.dt*this.m_maxMotorTorque;this.m_motorImpulse=e.Clamp(this.m_motorImpulse+g,-j,j);g=this.m_motorImpulse-h;m=m-t*g;n=n+r*g}if(this.m_enableLimit&&this.m_limitState!=p.e_inactiveLimit){var b=c.m_xf.R,g=this.m_localAnchor1.x-c.m_sweep.localCenter.x,h=this.m_localAnchor1.y-c.m_sweep.localCenter.y,f=b.col1.x*g+b.col2.x*h,h=b.col1.y*g+b.col2.y*h,g=f,b=d.m_xf.R,
j=this.m_localAnchor2.x-d.m_sweep.localCenter.x,k=this.m_localAnchor2.y-d.m_sweep.localCenter.y,f=b.col1.x*j+b.col2.x*k,k=b.col1.y*j+b.col2.y*k,j=f,b=o.x+-n*k-l.x- -m*h,u=o.y+n*j-l.y-m*g;this.m_mass.Solve33(this.impulse3,-b,-u,-(n-m));if(this.m_limitState==p.e_equalLimits)this.m_impulse.Add(this.impulse3);else if(this.m_limitState==p.e_atLowerLimit){f=this.m_impulse.z+this.impulse3.z;if(f<0){this.m_mass.Solve22(this.reduced,-b,-u);this.impulse3.x=this.reduced.x;this.impulse3.y=this.reduced.y;this.impulse3.z=
-this.m_impulse.z;this.m_impulse.x=this.m_impulse.x+this.reduced.x;this.m_impulse.y=this.m_impulse.y+this.reduced.y;this.m_impulse.z=0}}else if(this.m_limitState==p.e_atUpperLimit){f=this.m_impulse.z+this.impulse3.z;if(f>0){this.m_mass.Solve22(this.reduced,-b,-u);this.impulse3.x=this.reduced.x;this.impulse3.y=this.reduced.y;this.impulse3.z=-this.m_impulse.z;this.m_impulse.x=this.m_impulse.x+this.reduced.x;this.m_impulse.y=this.m_impulse.y+this.reduced.y;this.m_impulse.z=0}}l.x=l.x-s*this.impulse3.x;
l.y=l.y-s*this.impulse3.y;m=m-t*(g*this.impulse3.y-h*this.impulse3.x+this.impulse3.z);o.x=o.x+q*this.impulse3.x;o.y=o.y+q*this.impulse3.y;n=n+r*(j*this.impulse3.y-k*this.impulse3.x+this.impulse3.z)}else{b=c.m_xf.R;g=this.m_localAnchor1.x-c.m_sweep.localCenter.x;h=this.m_localAnchor1.y-c.m_sweep.localCenter.y;f=b.col1.x*g+b.col2.x*h;h=b.col1.y*g+b.col2.y*h;g=f;b=d.m_xf.R;j=this.m_localAnchor2.x-d.m_sweep.localCenter.x;k=this.m_localAnchor2.y-d.m_sweep.localCenter.y;f=b.col1.x*j+b.col2.x*k;k=b.col1.y*
j+b.col2.y*k;j=f;this.m_mass.Solve22(this.impulse2,-(o.x+-n*k-l.x- -m*h),-(o.y+n*j-l.y-m*g));this.m_impulse.x=this.m_impulse.x+this.impulse2.x;this.m_impulse.y=this.m_impulse.y+this.impulse2.y;l.x=l.x-s*this.impulse2.x;l.y=l.y-s*this.impulse2.y;m=m-t*(g*this.impulse2.y-h*this.impulse2.x);o.x=o.x+q*this.impulse2.x;o.y=o.y+q*this.impulse2.y;n=n+r*(j*this.impulse2.y-k*this.impulse2.x)}c.m_linearVelocity.SetV(l);c.m_angularVelocity=m;d.m_linearVelocity.SetV(o);d.m_angularVelocity=n};H.prototype.SolvePositionConstraints=
function(){var c=0,d,f=this.m_bodyA,g=this.m_bodyB,h=0,j=0,k=0,l=0;if(this.m_enableLimit&&this.m_limitState!=p.e_inactiveLimit){var c=g.m_sweep.a-f.m_sweep.a-this.m_referenceAngle,m=0;if(this.m_limitState==p.e_equalLimits){c=e.Clamp(c-this.m_lowerAngle,-b.b2_maxAngularCorrection,b.b2_maxAngularCorrection);m=-this.m_motorMass*c;h=e.Abs(c)}else if(this.m_limitState==p.e_atLowerLimit){c=c-this.m_lowerAngle;h=-c;c=e.Clamp(c+b.b2_angularSlop,-b.b2_maxAngularCorrection,0);m=-this.m_motorMass*c}else if(this.m_limitState==
p.e_atUpperLimit){h=c=c-this.m_upperAngle;c=e.Clamp(c-b.b2_angularSlop,0,b.b2_maxAngularCorrection);m=-this.m_motorMass*c}f.m_sweep.a=f.m_sweep.a-f.m_invI*m;g.m_sweep.a=g.m_sweep.a+g.m_invI*m;f.SynchronizeTransform();g.SynchronizeTransform()}d=f.m_xf.R;m=this.m_localAnchor1.x-f.m_sweep.localCenter.x;c=this.m_localAnchor1.y-f.m_sweep.localCenter.y;j=d.col1.x*m+d.col2.x*c;c=d.col1.y*m+d.col2.y*c;m=j;d=g.m_xf.R;var o=this.m_localAnchor2.x-g.m_sweep.localCenter.x,n=this.m_localAnchor2.y-g.m_sweep.localCenter.y,
j=d.col1.x*o+d.col2.x*n,n=d.col1.y*o+d.col2.y*n,o=j,k=g.m_sweep.c.x+o-f.m_sweep.c.x-m,l=g.m_sweep.c.y+n-f.m_sweep.c.y-c,s=k*k+l*l;d=Math.sqrt(s);var j=f.m_invMass,q=g.m_invMass,t=f.m_invI,r=g.m_invI,u=10*b.b2_linearSlop;if(s>u*u){s=1/(j+q);k=s*-k;l=s*-l;f.m_sweep.c.x=f.m_sweep.c.x-0.5*j*k;f.m_sweep.c.y=f.m_sweep.c.y-0.5*j*l;g.m_sweep.c.x=g.m_sweep.c.x+0.5*q*k;g.m_sweep.c.y=g.m_sweep.c.y+0.5*q*l;k=g.m_sweep.c.x+o-f.m_sweep.c.x-m;l=g.m_sweep.c.y+n-f.m_sweep.c.y-c}this.K1.col1.x=j+q;this.K1.col2.x=0;
this.K1.col1.y=0;this.K1.col2.y=j+q;this.K2.col1.x=t*c*c;this.K2.col2.x=-t*m*c;this.K2.col1.y=-t*m*c;this.K2.col2.y=t*m*m;this.K3.col1.x=r*n*n;this.K3.col2.x=-r*o*n;this.K3.col1.y=-r*o*n;this.K3.col2.y=r*o*o;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.AddM(this.K3);this.K.Solve(H.tImpulse,-k,-l);k=H.tImpulse.x;l=H.tImpulse.y;f.m_sweep.c.x=f.m_sweep.c.x-f.m_invMass*k;f.m_sweep.c.y=f.m_sweep.c.y-f.m_invMass*l;f.m_sweep.a=f.m_sweep.a-f.m_invI*(m*l-c*k);g.m_sweep.c.x=g.m_sweep.c.x+g.m_invMass*k;
g.m_sweep.c.y=g.m_sweep.c.y+g.m_invMass*l;g.m_sweep.a=g.m_sweep.a+g.m_invI*(o*l-n*k);f.SynchronizeTransform();g.SynchronizeTransform();return d<=b.b2_linearSlop&&h<=b.b2_angularSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new f});Box2D.inherit(K,Box2D.Dynamics.Joints.b2JointDef);K.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;K.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new f;
this.localAnchorB=new f};K.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this);this.type=p.e_revoluteJoint;this.localAnchorA.Set(0,0);this.localAnchorB.Set(0,0);this.motorSpeed=this.maxMotorTorque=this.upperAngle=this.lowerAngle=this.referenceAngle=0;this.enableMotor=this.enableLimit=false};K.prototype.Initialize=function(b,c,d){this.bodyA=b;this.bodyB=c;this.localAnchorA=this.bodyA.GetLocalPoint(d);this.localAnchorB=this.bodyB.GetLocalPoint(d);this.referenceAngle=this.bodyB.GetAngle()-
this.bodyA.GetAngle()};Box2D.inherit(P,Box2D.Dynamics.Joints.b2Joint);P.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;P.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new f;this.m_localAnchorB=new f;this.m_impulse=new g;this.m_mass=new d};P.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};P.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};P.prototype.GetReactionForce=
function(b){b===void 0&&(b=0);return new f(b*this.m_impulse.x,b*this.m_impulse.y)};P.prototype.GetReactionTorque=function(b){b===void 0&&(b=0);return b*this.m_impulse.z};P.prototype.b2WeldJoint=function(b){this.__super.b2Joint.call(this,b);this.m_localAnchorA.SetV(b.localAnchorA);this.m_localAnchorB.SetV(b.localAnchorB);this.m_referenceAngle=b.referenceAngle;this.m_impulse.SetZero();this.m_mass=new d};P.prototype.InitVelocityConstraints=function(b){var c,d=0,e=this.m_bodyA,f=this.m_bodyB;c=e.m_xf.R;
var g=this.m_localAnchorA.x-e.m_sweep.localCenter.x,h=this.m_localAnchorA.y-e.m_sweep.localCenter.y,d=c.col1.x*g+c.col2.x*h,h=c.col1.y*g+c.col2.y*h,g=d;c=f.m_xf.R;var j=this.m_localAnchorB.x-f.m_sweep.localCenter.x,k=this.m_localAnchorB.y-f.m_sweep.localCenter.y,d=c.col1.x*j+c.col2.x*k,k=c.col1.y*j+c.col2.y*k,j=d;c=e.m_invMass;var d=f.m_invMass,l=e.m_invI,m=f.m_invI;this.m_mass.col1.x=c+d+h*h*l+k*k*m;this.m_mass.col2.x=-h*g*l-k*j*m;this.m_mass.col3.x=-h*l-k*m;this.m_mass.col1.y=this.m_mass.col2.x;
this.m_mass.col2.y=c+d+g*g*l+j*j*m;this.m_mass.col3.y=g*l+j*m;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=l+m;if(b.warmStarting){this.m_impulse.x=this.m_impulse.x*b.dtRatio;this.m_impulse.y=this.m_impulse.y*b.dtRatio;this.m_impulse.z=this.m_impulse.z*b.dtRatio;e.m_linearVelocity.x=e.m_linearVelocity.x-c*this.m_impulse.x;e.m_linearVelocity.y=e.m_linearVelocity.y-c*this.m_impulse.y;e.m_angularVelocity=e.m_angularVelocity-l*(g*this.m_impulse.y-h*this.m_impulse.x+
this.m_impulse.z);f.m_linearVelocity.x=f.m_linearVelocity.x+d*this.m_impulse.x;f.m_linearVelocity.y=f.m_linearVelocity.y+d*this.m_impulse.y;f.m_angularVelocity=f.m_angularVelocity+m*(j*this.m_impulse.y-k*this.m_impulse.x+this.m_impulse.z)}else this.m_impulse.SetZero()};P.prototype.SolveVelocityConstraints=function(){var b,c=0,d=this.m_bodyA,e=this.m_bodyB,f=d.m_linearVelocity,h=d.m_angularVelocity,j=e.m_linearVelocity,k=e.m_angularVelocity,l=d.m_invMass,m=e.m_invMass,o=d.m_invI,n=e.m_invI;b=d.m_xf.R;
var s=this.m_localAnchorA.x-d.m_sweep.localCenter.x,p=this.m_localAnchorA.y-d.m_sweep.localCenter.y,c=b.col1.x*s+b.col2.x*p,p=b.col1.y*s+b.col2.y*p,s=c;b=e.m_xf.R;var q=this.m_localAnchorB.x-e.m_sweep.localCenter.x,t=this.m_localAnchorB.y-e.m_sweep.localCenter.y,c=b.col1.x*q+b.col2.x*t,t=b.col1.y*q+b.col2.y*t,q=c;b=j.x-k*t-f.x+h*p;var c=j.y+k*q-f.y-h*s,r=k-h,u=new g;this.m_mass.Solve33(u,-b,-c,-r);this.m_impulse.Add(u);f.x=f.x-l*u.x;f.y=f.y-l*u.y;h=h-o*(s*u.y-p*u.x+u.z);j.x=j.x+m*u.x;j.y=j.y+m*u.y;
k=k+n*(q*u.y-t*u.x+u.z);d.m_angularVelocity=h;e.m_angularVelocity=k};P.prototype.SolvePositionConstraints=function(){var c,d=0,f=this.m_bodyA,h=this.m_bodyB;c=f.m_xf.R;var j=this.m_localAnchorA.x-f.m_sweep.localCenter.x,k=this.m_localAnchorA.y-f.m_sweep.localCenter.y,d=c.col1.x*j+c.col2.x*k,k=c.col1.y*j+c.col2.y*k,j=d;c=h.m_xf.R;var l=this.m_localAnchorB.x-h.m_sweep.localCenter.x,m=this.m_localAnchorB.y-h.m_sweep.localCenter.y,d=c.col1.x*l+c.col2.x*m,m=c.col1.y*l+c.col2.y*m,l=d;c=f.m_invMass;var d=
h.m_invMass,o=f.m_invI,n=h.m_invI,s=h.m_sweep.c.x+l-f.m_sweep.c.x-j,p=h.m_sweep.c.y+m-f.m_sweep.c.y-k,q=h.m_sweep.a-f.m_sweep.a-this.m_referenceAngle,t=10*b.b2_linearSlop,r=Math.sqrt(s*s+p*p),u=e.Abs(q);if(r>t){o=o*1;n=n*1}this.m_mass.col1.x=c+d+k*k*o+m*m*n;this.m_mass.col2.x=-k*j*o-m*l*n;this.m_mass.col3.x=-k*o-m*n;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=c+d+j*j*o+l*l*n;this.m_mass.col3.y=j*o+l*n;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=
o+n;t=new g;this.m_mass.Solve33(t,-s,-p,-q);f.m_sweep.c.x=f.m_sweep.c.x-c*t.x;f.m_sweep.c.y=f.m_sweep.c.y-c*t.y;f.m_sweep.a=f.m_sweep.a-o*(j*t.y-k*t.x+t.z);h.m_sweep.c.x=h.m_sweep.c.x+d*t.x;h.m_sweep.c.y=h.m_sweep.c.y+d*t.y;h.m_sweep.a=h.m_sweep.a+n*(l*t.y-m*t.x+t.z);f.SynchronizeTransform();h.SynchronizeTransform();return r<=b.b2_linearSlop&&u<=b.b2_angularSlop};Box2D.inherit(T,Box2D.Dynamics.Joints.b2JointDef);T.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;T.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,
arguments);this.localAnchorA=new f;this.localAnchorB=new f};T.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this);this.type=p.e_weldJoint;this.referenceAngle=0};T.prototype.Initialize=function(b,c,d){this.bodyA=b;this.bodyB=c;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(d));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(d));this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}})();
(function(){var b=Box2D.Dynamics.b2DebugDraw;b.b2DebugDraw=function(){this.m_xformScale=this.m_fillAlpha=this.m_alpha=this.m_lineThickness=this.m_drawScale=1;var b=this;this.m_sprite={graphics:{clear:function(){b.m_ctx.clearRect(0,0,b.m_ctx.canvas.width,b.m_ctx.canvas.height)}}}};b.prototype._color=function(b,d){return"rgba("+((b&16711680)>>16)+","+((b&65280)>>8)+","+(b&255)+","+d+")"};b.prototype.b2DebugDraw=function(){this.m_drawFlags=0};b.prototype.SetFlags=function(b){b===void 0&&(b=0);this.m_drawFlags=
b};b.prototype.GetFlags=function(){return this.m_drawFlags};b.prototype.AppendFlags=function(b){b===void 0&&(b=0);this.m_drawFlags=this.m_drawFlags|b};b.prototype.ClearFlags=function(b){b===void 0&&(b=0);this.m_drawFlags=this.m_drawFlags&~b};b.prototype.SetSprite=function(b){this.m_ctx=b};b.prototype.GetSprite=function(){return this.m_ctx};b.prototype.SetDrawScale=function(b){b===void 0&&(b=0);this.m_drawScale=b};b.prototype.GetDrawScale=function(){return this.m_drawScale};b.prototype.SetLineThickness=
function(b){b===void 0&&(b=0);this.m_lineThickness=b;this.m_ctx.strokeWidth=b};b.prototype.GetLineThickness=function(){return this.m_lineThickness};b.prototype.SetAlpha=function(b){b===void 0&&(b=0);this.m_alpha=b};b.prototype.GetAlpha=function(){return this.m_alpha};b.prototype.SetFillAlpha=function(b){b===void 0&&(b=0);this.m_fillAlpha=b};b.prototype.GetFillAlpha=function(){return this.m_fillAlpha};b.prototype.SetXFormScale=function(b){b===void 0&&(b=0);this.m_xformScale=b};b.prototype.GetXFormScale=
function(){return this.m_xformScale};b.prototype.DrawPolygon=function(b,d,e){if(d){var f=this.m_ctx,g=this.m_drawScale;f.beginPath();f.strokeStyle=this._color(e.color,this.m_alpha);f.moveTo(b[0].x*g,b[0].y*g);for(e=1;e<d;e++)f.lineTo(b[e].x*g,b[e].y*g);f.lineTo(b[0].x*g,b[0].y*g);f.closePath();f.stroke()}};b.prototype.DrawSolidPolygon=function(b,d,e){if(d){var f=this.m_ctx,g=this.m_drawScale;f.beginPath();f.strokeStyle=this._color(e.color,this.m_alpha);f.fillStyle=this._color(e.color,this.m_fillAlpha);
f.moveTo(b[0].x*g,b[0].y*g);for(e=1;e<d;e++)f.lineTo(b[e].x*g,b[e].y*g);f.lineTo(b[0].x*g,b[0].y*g);f.closePath();f.fill();f.stroke()}};b.prototype.DrawCircle=function(b,d,e){if(d){var f=this.m_ctx,g=this.m_drawScale;f.beginPath();f.strokeStyle=this._color(e.color,this.m_alpha);f.arc(b.x*g,b.y*g,d*g,0,Math.PI*2,true);f.closePath();f.stroke()}};b.prototype.DrawSolidCircle=function(b,d,e,f){if(d){var g=this.m_ctx,h=this.m_drawScale,j=b.x*h,k=b.y*h;g.moveTo(0,0);g.beginPath();g.strokeStyle=this._color(f.color,
this.m_alpha);g.fillStyle=this._color(f.color,this.m_fillAlpha);g.arc(j,k,d*h,0,Math.PI*2,true);g.moveTo(j,k);g.lineTo((b.x+e.x*d)*h,(b.y+e.y*d)*h);g.closePath();g.fill();g.stroke()}};b.prototype.DrawSegment=function(b,d,e){var f=this.m_ctx,g=this.m_drawScale;f.strokeStyle=this._color(e.color,this.m_alpha);f.beginPath();f.moveTo(b.x*g,b.y*g);f.lineTo(d.x*g,d.y*g);f.closePath();f.stroke()};b.prototype.DrawTransform=function(b){var d=this.m_ctx,e=this.m_drawScale;d.beginPath();d.strokeStyle=this._color(16711680,
this.m_alpha);d.moveTo(b.position.x*e,b.position.y*e);d.lineTo((b.position.x+this.m_xformScale*b.R.col1.x)*e,(b.position.y+this.m_xformScale*b.R.col1.y)*e);d.strokeStyle=this._color(65280,this.m_alpha);d.moveTo(b.position.x*e,b.position.y*e);d.lineTo((b.position.x+this.m_xformScale*b.R.col2.x)*e,(b.position.y+this.m_xformScale*b.R.col2.y)*e);d.closePath();d.stroke()}})();var i;for(i=0;i<Box2D.postDefs.length;++i)Box2D.postDefs[i]();delete Box2D.postDefs;
(function(b,c){function d(d,e){function h(b){return l.preferFlash&&Ka&&!l.ignoreFlash&&l.flash[b]!==c&&l.flash[b]}function j(b){return function(c){var d=this._s;d&&d._a?c=b.call(this,c):(d&&d.id?l._wD(d.id+": Ignoring "+c.type):l._wD("HTML5::Ignoring "+c.type),c=null);return c}}this.setupOptions={url:d||null,flashVersion:8,debugMode:true,debugFlash:false,useConsole:true,consoleOnly:true,waitForWindowLoad:false,bgColor:"#ffffff",useHighPerformance:false,flashPollingInterval:null,html5PollingInterval:null,
flashLoadTimeout:1E3,wmode:null,allowScriptAccess:"always",useFlashBlock:false,useHTML5Audio:true,forceUseGlobalHTML5Audio:false,ignoreMobileRestrictions:false,html5Test:/^(probably|maybe)$/i,preferFlash:false,noSWFCache:false,idPrefix:"sound"};this.defaultOptions={autoLoad:false,autoPlay:false,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:true,multiShotEvents:false,
position:null,pan:0,stream:true,to:null,type:null,usePolicyFile:false,volume:100};this.flash9Options={isMovieStar:null,usePeakData:false,useWaveformData:false,useEQData:false,onbufferchange:null,ondataerror:null};this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null};this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:true},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac",
"audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:false},ogg:{type:["audio/ogg; codecs=vorbis"],required:false},opus:{type:["audio/ogg; codecs=opus","audio/opus"],required:false},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:false}};this.movieID="sm2-container";this.id=e||"sm2movie";this.debugID="soundmanager-debug";this.debugURLParam=/([#?&])debug=1/i;this.versionNumber="V2.97a.20150601";this.altURL=this.movieURL=this.version=null;this.enabled=
this.swfLoaded=false;this.oMC=null;this.sounds={};this.soundIDs=[];this.didFlashBlock=this.muted=false;this.filePattern=null;this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i};this.features={buffering:false,peakData:false,waveformData:false,eqData:false,movieStar:false};this.sandbox={type:null,types:{remote:"remote (domain-based) rules",localWithFile:"local with file access (no internet access)",localWithNetwork:"local with network (internet access only, no local access)",localTrusted:"local, trusted (local+internet access)"},
description:null,noRemote:null,noLocal:null};this.html5={usingFlash:null};this.flash={};this.ignoreFlash=this.html5Only=false;var k,l=this,m=null,n=null,q,p=navigator.userAgent,s=b.location.href.toString(),r=document,o,t,u,w,z=[],A=true,C,G=false,H=false,K=false,P=false,T=false,D,F=0,I,J,N,U,Q,B,E,Z,O,M,X,aa,Y,ba,da,ra,x,ja,ka,oa,pa,V,va=["log","info","warn","error"],ta,sa,Da,L=null,W=null,fa,R,v,Na,tb,kb,ea,ma,Ca=false,ub=false,Va,nb,xb,Fa=0,Sa=null,bb,Ta=[],Aa,xa=null,Hb,Ia,qb,Ma,cb,gb,Qa,qa,za=
Array.prototype.slice,ua=false,hb,Ka,Pa,yb,na,Fb,Ja,db,Ib=0,Ab,vb=p.match(/(ipad|iphone|ipod)/i),ob=p.match(/android/i),Ga=p.match(/msie/i),Ha=p.match(/webkit/i),pb=p.match(/safari/i)&&!p.match(/chrome/i),Rb=p.match(/opera/i),Mb=p.match(/(mobile|pre\/|xoom)/i)||vb||ob,$b=!s.match(/usehtml5audio/i)&&!s.match(/sm2\-ignorebadua/i)&&pb&&!p.match(/silk/i)&&p.match(/OS X 10_6_([3-7])/i),ac=b.console!==c&&console.log!==c,Nb=r.hasFocus!==c?r.hasFocus():null,Ya=pb&&(r.hasFocus===c||!r.hasFocus()),bc=!Ya,gc=
/(mp3|mp4|mpa|m4a|m4b)/i,Za=r.location?r.location.protocol.match(/http/i):null,Sb=Za?"":"http://",Tb=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,jb=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","m4b","mp4v","3gp","3g2"],sb=RegExp("\\.("+jb.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i;this.useAltURL=!Za;var hc;try{hc=Audio!==c&&(Rb&&opera!==c&&10>opera.version()?new Audio(null):new Audio).canPlayType!==c}catch(nc){hc=
false}this.hasHTML5=hc;this.setup=function(b){var d=!l.url;b!==c&&K&&xa&&l.ok()&&(b.flashVersion!==c||b.url!==c||b.html5Test!==c)&&ea(fa("setupLate"));N(b);if(!ua)if(Mb){if(!l.setupOptions.ignoreMobileRestrictions||l.setupOptions.forceUseGlobalHTML5Audio){Ta.push(Y.globalHTML5);ua=true}}else l.setupOptions.forceUseGlobalHTML5Audio&&(Ta.push(Y.globalHTML5),ua=true);if(!Ab&&Mb)if(l.setupOptions.ignoreMobileRestrictions)Ta.push(Y.ignoreMobile);else if(l.setupOptions.useHTML5Audio&&!l.setupOptions.preferFlash||
l._wD(Y.mobileUA),l.setupOptions.useHTML5Audio=true,l.setupOptions.preferFlash=false,vb)l.ignoreFlash=true;else if(ob&&!p.match(/android\s2\.3/i)||!ob){l._wD(Y.globalHTML5);ua=true}b&&(d&&x&&b.url!==c&&l.beginDelayedInit(),x||b.url===c||"complete"!==r.readyState||setTimeout(da,1));Ab=true;return l};this.supported=this.ok=function(){return xa?K&&!P:l.useHTML5Audio&&l.hasHTML5};this.getMovie=function(c){return q(c)||r[c]||b[c]};this.createSound=function(b,d){function e(){g=tb(g);l.sounds[g.id]=new k(g);
l.soundIDs.push(g.id);return l.sounds[g.id]}var f,g;f=null;f="soundManager.createSound(): "+fa(K?"notOK":"notReady");if(!K||!l.ok())return ea(f),false;d!==c&&(b={id:b,url:d});g=J(b);g.url=bb(g.url);g.id===c&&(g.id=l.setupOptions.idPrefix+Ib++);g.id.toString().charAt(0).match(/^[0-9]$/)&&l._wD("soundManager.createSound(): "+fa("badID",g.id),2);l._wD("soundManager.createSound(): "+g.id+(g.url?" ("+g.url+")":""),1);if(ma(g.id,true))return l._wD("soundManager.createSound(): "+g.id+" exists",1),l.sounds[g.id];
if(Ia(g)){f=e();l.html5Only||l._wD(g.id+": Using HTML5");f._setup_html5(g)}else{if(l.html5Only)return l._wD(g.id+": No HTML5 support for this sound, and no Flash. Exiting."),e();if(l.html5.usingFlash&&g.url&&g.url.match(/data\:/i))return l._wD(g.id+": data: URIs not supported via Flash. Exiting."),e();8<w&&(null===g.isMovieStar&&(g.isMovieStar=!(!g.serverURL&&!(g.type&&g.type.match(Tb)||g.url&&g.url.match(sb)))),g.isMovieStar&&(l._wD("soundManager.createSound(): using MovieStar handling"),1<g.loops&&
D("noNSLoop")));g=kb(g,"soundManager.createSound(): ");f=e();8===w?n._createSound(g.id,g.loops||1,g.usePolicyFile):(n._createSound(g.id,g.url,g.usePeakData,g.useWaveformData,g.useEQData,g.isMovieStar,g.isMovieStar?g.bufferTime:false,g.loops||1,g.serverURL,g.duration||null,g.autoPlay,true,g.autoLoad,g.usePolicyFile),g.serverURL||(f.connected=true,g.onconnect&&g.onconnect.apply(f)));g.serverURL||!g.autoLoad&&!g.autoPlay||f.load(g)}!g.serverURL&&g.autoPlay&&f.play();return f};this.destroySound=function(b,
c){if(!ma(b))return false;var d=l.sounds[b],e;d.stop();d._iO={};d.unload();for(e=0;e<l.soundIDs.length;e++)if(l.soundIDs[e]===b){l.soundIDs.splice(e,1);break}c||d.destruct(true);delete l.sounds[b];return true};this.load=function(b,c){return ma(b)?l.sounds[b].load(c):false};this.unload=function(b){return ma(b)?l.sounds[b].unload():false};this.onposition=this.onPosition=function(b,c,d,e){return ma(b)?l.sounds[b].onposition(c,d,e):false};this.clearOnPosition=function(b,c,d){return ma(b)?l.sounds[b].clearOnPosition(c,
d):false};this.start=this.play=function(b,c){var d=null,e=c&&!(c instanceof Object);if(!K||!l.ok())return ea("soundManager.play(): "+fa(K?"notOK":"notReady")),false;if(ma(b,e))e&&(c={url:c});else{if(!e)return false;e&&(c={url:c});c&&c.url&&(l._wD('soundManager.play(): Attempting to create "'+b+'"',1),c.id=b,d=l.createSound(c).play())}null===d&&(d=l.sounds[b].play(c));return d};this.setPosition=function(b,c){return ma(b)?l.sounds[b].setPosition(c):false};this.stop=function(b){if(!ma(b))return false;
l._wD("soundManager.stop("+b+")",1);return l.sounds[b].stop()};this.stopAll=function(){var b;l._wD("soundManager.stopAll()",1);for(b in l.sounds)l.sounds.hasOwnProperty(b)&&l.sounds[b].stop()};this.pause=function(b){return ma(b)?l.sounds[b].pause():false};this.pauseAll=function(){var b;for(b=l.soundIDs.length-1;0<=b;b--)l.sounds[l.soundIDs[b]].pause()};this.resume=function(b){return ma(b)?l.sounds[b].resume():false};this.resumeAll=function(){var b;for(b=l.soundIDs.length-1;0<=b;b--)l.sounds[l.soundIDs[b]].resume()};
this.togglePause=function(b){return ma(b)?l.sounds[b].togglePause():false};this.setPan=function(b,c){return ma(b)?l.sounds[b].setPan(c):false};this.setVolume=function(b,d){var e,f;if(b===c||isNaN(b)||d!==c)return ma(b)?l.sounds[b].setVolume(d):false;e=0;for(f=l.soundIDs.length;e<f;e++)l.sounds[l.soundIDs[e]].setVolume(b)};this.mute=function(b){var c=0;b instanceof String&&(b=null);if(b){if(!ma(b))return false;l._wD('soundManager.mute(): Muting "'+b+'"');return l.sounds[b].mute()}l._wD("soundManager.mute(): Muting all sounds");
for(c=l.soundIDs.length-1;0<=c;c--)l.sounds[l.soundIDs[c]].mute();return l.muted=true};this.muteAll=function(){l.mute()};this.unmute=function(b){b instanceof String&&(b=null);if(b){if(!ma(b))return false;l._wD('soundManager.unmute(): Unmuting "'+b+'"');return l.sounds[b].unmute()}l._wD("soundManager.unmute(): Unmuting all sounds");for(b=l.soundIDs.length-1;0<=b;b--)l.sounds[l.soundIDs[b]].unmute();l.muted=false;return true};this.unmuteAll=function(){l.unmute()};this.toggleMute=function(b){return ma(b)?
l.sounds[b].toggleMute():false};this.getMemoryUse=function(){var b=0;n&&8!==w&&(b=parseInt(n._getMemoryUse(),10));return b};this.disable=function(d){var e;d===c&&(d=false);if(P)return false;P=true;D("shutdown",1);for(e=l.soundIDs.length-1;0<=e;e--)ta(l.sounds[l.soundIDs[e]]);I(d);qa.remove(b,"load",E);return true};this.canPlayMIME=function(b){var c;l.hasHTML5&&(c=qb({type:b}));!c&&xa&&(c=b&&l.ok()?!!(8<w&&b.match(Tb)||b.match(l.mimePattern)):null);return c};this.canPlayURL=function(b){var c;l.hasHTML5&&
(c=qb({url:b}));!c&&xa&&(c=b&&l.ok()?!!b.match(l.filePattern):null);return c};this.canPlayLink=function(b){return b.type!==c&&b.type&&l.canPlayMIME(b.type)?true:l.canPlayURL(b.href)};this.getSoundById=function(b,c){if(!b)return null;var d=l.sounds[b];d||c||l._wD('soundManager.getSoundById(): Sound "'+b+'" not found.',2);return d};this.onready=function(c,d){if("function"===typeof c){K&&l._wD(fa("queue","onready"));d||(d=b);Q("onready",c,d);B()}else throw fa("needFunction","onready");return true};this.ontimeout=
function(c,d){if("function"===typeof c){K&&l._wD(fa("queue","ontimeout"));d||(d=b);Q("ontimeout",c,d);B({type:"ontimeout"})}else throw fa("needFunction","ontimeout");return true};this._writeDebug=function(b,d){var e,f;if(!l.setupOptions.debugMode)return false;if(ac&&l.useConsole){if(d&&"object"===typeof d)console.log(b,d);else if(va[d]!==c)console[va[d]](b);else console.log(b);if(l.consoleOnly)return true}e=q("soundmanager-debug");if(!e)return false;f=r.createElement("div");0===++F%2&&(f.className=
"sm2-alt");d=d===c?0:parseInt(d,10);f.appendChild(r.createTextNode(b));d&&(2<=d&&(f.style.fontWeight="bold"),3===d&&(f.style.color="#ff3333"));e.insertBefore(f,e.firstChild);return true};-1!==s.indexOf("sm2-debug=alert")&&(this._writeDebug=function(c){b.alert(c)});this._wD=this._writeDebug;this._debug=function(){var b,c;D("currentObj",1);b=0;for(c=l.soundIDs.length;b<c;b++)l.sounds[l.soundIDs[b]]._debug()};this.reboot=function(c,d){l.soundIDs.length&&l._wD("Destroying "+l.soundIDs.length+" SMSound object"+
(1!==l.soundIDs.length?"s":"")+"...");var e,f,g;for(e=l.soundIDs.length-1;0<=e;e--)l.sounds[l.soundIDs[e]].destruct();if(n)try{Ga&&(W=n.innerHTML);L=n.parentNode.removeChild(n)}catch(h){D("badRemove",2)}W=L=xa=n=null;l.enabled=x=K=Ca=ub=G=H=P=ua=l.swfLoaded=false;l.soundIDs=[];l.sounds={};Ib=0;Ab=false;if(c)z=[];else for(e in z)if(z.hasOwnProperty(e)){f=0;for(g=z[e].length;f<g;f++)z[e][f].fired=false}d||l._wD("soundManager: Rebooting...");l.html5={usingFlash:null};l.flash={};l.html5Only=false;l.ignoreFlash=
false;b.setTimeout(function(){d||l.beginDelayedInit()},20);return l};this.reset=function(){D("reset");return l.reboot(true,true)};this.getMoviePercent=function(){return n&&"PercentLoaded"in n?n.PercentLoaded():null};this.beginDelayedInit=function(){T=true;da();setTimeout(function(){if(ub)return false;ka();ba();return ub=true},20);Z()};this.destruct=function(){l._wD("soundManager.destruct()");l.disable(true)};k=function(b){var d,e,f=this,g,h,j,k,o,s,p=false,q=[],t=0,L,r,u=null,v;e=d=null;this.sID=
this.id=b.id;this.url=b.url;this._iO=this.instanceOptions=this.options=J(b);this.pan=this.options.pan;this.volume=this.options.volume;this.isHTML5=false;this._a=null;v=this.url?false:true;this.id3={};this._debug=function(){l._wD(f.id+": Merged options:",f.options)};this.load=function(b){var d=null,e;b!==c?f._iO=J(b,f.options):(b=f.options,f._iO=b,u&&u!==f.url&&(D("manURL"),f._iO.url=f.url,f.url=null));f._iO.url||(f._iO.url=f.url);f._iO.url=bb(f._iO.url);e=f.instanceOptions=f._iO;l._wD(f.id+": load ("+
e.url+")");if(!e.url&&!f.url)return l._wD(f.id+": load(): url is unassigned. Exiting.",2),f;f.isHTML5||8!==w||f.url||e.autoPlay||l._wD(f.id+": Flash 8 load() limitation: Wait for onload() before calling play().",1);if(e.url===f.url&&0!==f.readyState&&2!==f.readyState)return D("onURL",1),3===f.readyState&&e.onload&&db(f,function(){e.onload.apply(f,[!!f.duration])}),f;f.loaded=false;f.readyState=1;f.playState=0;f.id3={};if(Ia(e)){d=f._setup_html5(e);d._called_load?l._wD(f.id+": Ignoring request to load again"):
(f._html5_canplay=false,f.url!==e.url&&(l._wD(D("manURL")+": "+e.url),f._a.src=e.url,f.setPosition(0)),f._a.autobuffer="auto",f._a.preload="auto",f._a._called_load=true)}else{if(l.html5Only)return l._wD(f.id+": No flash support. Exiting."),f;if(f._iO.url&&f._iO.url.match(/data\:/i))return l._wD(f.id+": data: URIs not supported via Flash. Exiting."),f;try{f.isHTML5=false;f._iO=kb(tb(e));f._iO.autoPlay&&(f._iO.position||f._iO.from)&&(l._wD(f.id+": Disabling autoPlay because of non-zero offset case"),
f._iO.autoPlay=false);e=f._iO;8===w?n._load(f.id,e.url,e.stream,e.autoPlay,e.usePolicyFile):n._load(f.id,e.url,!!e.stream,!!e.autoPlay,e.loops||1,!!e.autoLoad,e.usePolicyFile)}catch(g){D("smError",2);C("onload",false);oa({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:true})}}f.url=e.url;return f};this.unload=function(){0!==f.readyState&&(l._wD(f.id+": unload()"),f.isHTML5?(k(),f._a&&(f._a.pause(),u=cb(f._a))):8===w?n._unload(f.id,"about:blank"):n._unload(f.id),g());return f};this.destruct=function(b){l._wD(f.id+
": Destruct");f.isHTML5?(k(),f._a&&(f._a.pause(),cb(f._a),ua||j(),f._a._s=null,f._a=null)):(f._iO.onfailure=null,n._destroySound(f.id));b||l.destroySound(f.id,true)};this.start=this.play=function(b,d){var e,g,h,j,k,m=true,m=null;e=f.id+": play(): ";d=d===c?true:d;b||(b={});f.url&&(f._iO.url=f.url);f._iO=J(f._iO,f.options);f._iO=J(b,f._iO);f._iO.url=bb(f._iO.url);f.instanceOptions=f._iO;if(!f.isHTML5&&f._iO.serverURL&&!f.connected)return f.getAutoPlay()||(l._wD(e+" Netstream not connected yet - setting autoPlay"),
f.setAutoPlay(true)),f;Ia(f._iO)&&(f._setup_html5(f._iO),o());1!==f.playState||f.paused||((g=f._iO.multiShot)?l._wD(e+"Already playing (multi-shot)",1):(l._wD(e+"Already playing (one-shot)",1),f.isHTML5&&f.setPosition(f._iO.position),m=f));if(null!==m)return m;b.url&&b.url!==f.url&&(f.readyState||f.isHTML5||8!==w||!v?f.load(f._iO):v=false);f.loaded?l._wD(e.substr(0,e.lastIndexOf(":"))):0===f.readyState?(l._wD(e+"Attempting to load"),f.isHTML5||l.html5Only?f.isHTML5?f.load(f._iO):(l._wD(e+"Unsupported type. Exiting."),
m=f):(f._iO.autoPlay=true,f.load(f._iO)),f.instanceOptions=f._iO):2===f.readyState?(l._wD(e+"Could not load - exiting",2),m=f):l._wD(e+"Loading - attempting to play...");if(null!==m)return m;!f.isHTML5&&9===w&&0<f.position&&f.position===f.duration&&(l._wD(e+"Sound at end, resetting to position: 0"),b.position=0);if(f.paused&&0<=f.position&&(!f._iO.serverURL||0<f.position)){l._wD(e+"Resuming from paused state",1);f.resume()}else{f._iO=J(b,f._iO);if((!f.isHTML5&&null!==f._iO.position&&0<f._iO.position||
null!==f._iO.from&&0<f._iO.from||null!==f._iO.to)&&0===f.instanceCount&&0===f.playState&&!f._iO.serverURL){g=function(){f._iO=J(b,f._iO);f.play(f._iO)};f.isHTML5&&!f._html5_canplay?(l._wD(e+"Beginning load for non-zero offset case"),f.load({_oncanplay:g}),m=false):f.isHTML5||f.loaded||f.readyState&&2===f.readyState||(l._wD(e+"Preloading for non-zero offset case"),f.load({onload:g}),m=false);if(null!==m)return m;f._iO=r()}(!f.instanceCount||f._iO.multiShotEvents||f.isHTML5&&f._iO.multiShot&&!ua||!f.isHTML5&&
8<w&&!f.getAutoPlay())&&f.instanceCount++;f._iO.onposition&&0===f.playState&&s(f);f.playState=1;f.paused=false;f.position=f._iO.position===c||isNaN(f._iO.position)?0:f._iO.position;f.isHTML5||(f._iO=kb(tb(f._iO)));f._iO.onplay&&d&&(f._iO.onplay.apply(f),p=true);f.setVolume(f._iO.volume,true);f.setPan(f._iO.pan,true);f.isHTML5?2>f.instanceCount?(o(),e=f._setup_html5(),f.setPosition(f._iO.position),e.play()):(l._wD(f.id+": Cloning Audio() for instance #"+f.instanceCount+"..."),h=new Audio(f._iO.url),
j=function(){qa.remove(h,"ended",j);f._onfinish(f);cb(h);h=null},k=function(){qa.remove(h,"canplay",k);try{h.currentTime=f._iO.position/1E3}catch(b){ea(f.id+": multiShot play() failed to apply position of "+f._iO.position/1E3)}h.play()},qa.add(h,"ended",j),f._iO.volume!==c&&(h.volume=Math.max(0,Math.min(1,f._iO.volume/100))),f.muted&&(h.muted=true),f._iO.position?qa.add(h,"canplay",k):h.play()):(m=n._start(f.id,f._iO.loops||1,9===w?f.position:f.position/1E3,f._iO.multiShot||false),9!==w||m||(l._wD(e+
"No sound hardware, or 32-sound ceiling hit",2),f._iO.onplayerror&&f._iO.onplayerror.apply(f)))}return f};this.stop=function(b){var c=f._iO;1===f.playState&&(l._wD(f.id+": stop()"),f._onbufferchange(0),f._resetOnPosition(0),f.paused=false,f.isHTML5||(f.playState=0),L(),c.to&&f.clearOnPosition(c.to),f.isHTML5?f._a&&(b=f.position,f.setPosition(0),f.position=b,f._a.pause(),f.playState=0,f._onTimer(),k()):(n._stop(f.id,b),c.serverURL&&f.unload()),f.instanceCount=0,f._iO={},c.onstop&&c.onstop.apply(f));
return f};this.setAutoPlay=function(b){l._wD(f.id+": Autoplay turned "+(b?"on":"off"));f._iO.autoPlay=b;f.isHTML5||(n._setAutoPlay(f.id,b),b&&!f.instanceCount&&1===f.readyState&&(f.instanceCount++,l._wD(f.id+": Incremented instance count to "+f.instanceCount)))};this.getAutoPlay=function(){return f._iO.autoPlay};this.setPosition=function(b){b===c&&(b=0);var d=f.isHTML5?Math.max(b,0):Math.min(f.duration||f._iO.duration,Math.max(b,0));f.position=d;b=f.position/1E3;f._resetOnPosition(f.position);f._iO.position=
d;if(f.isHTML5){if(f._a){if(f._html5_canplay){if(f._a.currentTime!==b){l._wD(f.id+": setPosition("+b+")");try{f._a.currentTime=b;(0===f.playState||f.paused)&&f._a.pause()}catch(e){l._wD(f.id+": setPosition("+b+") failed: "+e.message,2)}}}else if(b)return l._wD(f.id+": setPosition("+b+"): Cannot seek yet, sound not ready",2),f;f.paused&&f._onTimer(true)}}else{b=9===w?f.position:b;f.readyState&&2!==f.readyState&&n._setPosition(f.id,b,f.paused||!f.playState,f._iO.multiShot)}return f};this.pause=function(b){if(f.paused||
0===f.playState&&1!==f.readyState)return f;l._wD(f.id+": pause()");f.paused=true;f.isHTML5?(f._setup_html5().pause(),k()):(b||b===c)&&n._pause(f.id,f._iO.multiShot);f._iO.onpause&&f._iO.onpause.apply(f);return f};this.resume=function(){var b=f._iO;if(!f.paused)return f;l._wD(f.id+": resume()");f.paused=false;f.playState=1;f.isHTML5?(f._setup_html5().play(),o()):(b.isMovieStar&&!b.serverURL&&f.setPosition(f.position),n._pause(f.id,b.multiShot));!p&&b.onplay?(b.onplay.apply(f),p=true):b.onresume&&b.onresume.apply(f);
return f};this.togglePause=function(){l._wD(f.id+": togglePause()");if(0===f.playState)return f.play({position:9!==w||f.isHTML5?f.position/1E3:f.position}),f;f.paused?f.resume():f.pause();return f};this.setPan=function(b,d){b===c&&(b=0);d===c&&(d=false);f.isHTML5||n._setPan(f.id,b);f._iO.pan=b;d||(f.pan=b,f.options.pan=b);return f};this.setVolume=function(b,d){b===c&&(b=100);d===c&&(d=false);f.isHTML5?f._a&&(l.muted&&!f.muted&&(f.muted=true,f._a.muted=true),f._a.volume=Math.max(0,Math.min(1,b/100))):
n._setVolume(f.id,l.muted&&!f.muted||f.muted?0:b);f._iO.volume=b;d||(f.volume=b,f.options.volume=b);return f};this.mute=function(){f.muted=true;f.isHTML5?f._a&&(f._a.muted=true):n._setVolume(f.id,0);return f};this.unmute=function(){f.muted=false;var b=f._iO.volume!==c;f.isHTML5?f._a&&(f._a.muted=false):n._setVolume(f.id,b?f._iO.volume:f.options.volume);return f};this.toggleMute=function(){return f.muted?f.unmute():f.mute()};this.onposition=this.onPosition=function(b,d,e){q.push({position:parseInt(b,
10),method:d,scope:e!==c?e:f,fired:false});return f};this.clearOnPosition=function(b,c){var d,b=parseInt(b,10);if(isNaN(b))return false;for(d=0;d<q.length;d++)b!==q[d].position||c&&c!==q[d].method||(q[d].fired&&t--,q.splice(d,1))};this._processOnPosition=function(){var b,c;b=q.length;if(!b||!f.playState||t>=b)return false;for(--b;0<=b;b--){c=q[b];!c.fired&&f.position>=c.position&&(c.fired=true,t++,c.method.apply(c.scope,[c.position]))}return true};this._resetOnPosition=function(b){var c,d;c=q.length;
if(!c)return false;for(--c;0<=c;c--){d=q[c];d.fired&&b<=d.position&&(d.fired=false,t--)}return true};r=function(){var b=f._iO,c=b.from,d=b.to,e,g;g=function(){l._wD(f.id+': "To" time of '+d+" reached.");f.clearOnPosition(d,g);f.stop()};e=function(){l._wD(f.id+': Playing "from" '+c);if(null!==d&&!isNaN(d))f.onPosition(d,g)};null===c||isNaN(c)||(b.position=c,b.multiShot=false,e());return b};s=function(){var b,c=f._iO.onposition;if(c)for(b in c)if(c.hasOwnProperty(b))f.onPosition(parseInt(b,10),c[b])};
L=function(){var b,c=f._iO.onposition;if(c)for(b in c)c.hasOwnProperty(b)&&f.clearOnPosition(parseInt(b,10))};o=function(){f.isHTML5&&Va(f)};k=function(){f.isHTML5&&nb(f)};g=function(b){b||(q=[],t=0);p=false;f._hasTimer=null;f._a=null;f._html5_canplay=false;f.bytesLoaded=null;f.bytesTotal=null;f.duration=f._iO&&f._iO.duration?f._iO.duration:null;f.durationEstimate=null;f.buffered=[];f.eqData=[];f.eqData.left=[];f.eqData.right=[];f.failures=0;f.isBuffering=false;f.instanceOptions={};f.instanceCount=
0;f.loaded=false;f.metadata={};f.readyState=0;f.muted=false;f.paused=false;f.peakData={left:0,right:0};f.waveformData={left:[],right:[]};f.playState=0;f.position=null;f.id3={}};g();this._onTimer=function(b){var c,g=false,h={};if(f._hasTimer||b)return f._a&&(b||(0<f.playState||1===f.readyState)&&!f.paused)&&(c=f._get_html5_duration(),c!==d&&(d=c,f.duration=c,g=true),f.durationEstimate=f.duration,c=1E3*f._a.currentTime||0,c!==e&&(e=c,g=true),(g||b)&&f._whileplaying(c,h,h,h,h)),g};this._get_html5_duration=
function(){var b=f._iO;return(b=f._a&&f._a.duration?1E3*f._a.duration:b&&b.duration?b.duration:null)&&!isNaN(b)&&Infinity!==b?b:null};this._apply_loop=function(b,c){!b.loop&&1<c&&l._wD("Note: Native HTML5 looping is infinite.",1);b.loop=1<c?"loop":""};this._setup_html5=function(b){var b=J(f._iO,b),c=ua?m:f._a,d=decodeURI(b.url),e;ua?d===decodeURI(hb)&&(e=true):d===decodeURI(u)&&(e=true);if(c){if(c._s)if(ua)c._s&&c._s.playState&&!e&&c._s.stop();else if(!ua&&d===decodeURI(u))return f._apply_loop(c,
b.loops),c;e||(u&&g(false),c.src=b.url,hb=u=f.url=b.url,c._called_load=false)}else{b.autoLoad||b.autoPlay?(f._a=new Audio(b.url),f._a.load()):f._a=Rb&&10>opera.version()?new Audio(null):new Audio;c=f._a;c._called_load=false;ua&&(m=c)}f.isHTML5=true;f._a=c;c._s=f;h();f._apply_loop(c,b.loops);b.autoLoad||b.autoPlay?f.load():(c.autobuffer=false,c.preload="auto");return c};h=function(){if(f._a._added_events)return false;var b;f._a._added_events=true;for(b in na)na.hasOwnProperty(b)&&f._a&&f._a.addEventListener(b,
na[b],false);return true};j=function(){var b;l._wD(f.id+": Removing event listeners");f._a._added_events=false;for(b in na)na.hasOwnProperty(b)&&f._a&&f._a.removeEventListener(b,na[b],false)};this._onload=function(b){var c=!!b||!f.isHTML5&&8===w&&f.duration,b=f.id+": ";l._wD(b+(c?"onload()":"Failed to load / invalid sound?"+(f.duration?" -":" Zero-length duration reported.")+" ("+f.url+")"),c?1:2);c||f.isHTML5||(true===l.sandbox.noRemote&&l._wD(b+fa("noNet"),1),true===l.sandbox.noLocal&&l._wD(b+fa("noLocal"),
1));f.loaded=c;f.readyState=c?3:2;f._onbufferchange(0);f._iO.onload&&db(f,function(){f._iO.onload.apply(f,[c])});return true};this._onbufferchange=function(b){if(0===f.playState||b&&f.isBuffering||!b&&!f.isBuffering)return false;f.isBuffering=1===b;f._iO.onbufferchange&&(l._wD(f.id+": Buffer state change: "+b),f._iO.onbufferchange.apply(f,[b]));return true};this._onsuspend=function(){f._iO.onsuspend&&(l._wD(f.id+": Playback suspended"),f._iO.onsuspend.apply(f));return true};this._onfailure=function(b,
c,d){f.failures++;l._wD(f.id+": Failure ("+f.failures+"): "+b);if(f._iO.onfailure&&1===f.failures)f._iO.onfailure(b,c,d);else l._wD(f.id+": Ignoring failure")};this._onwarning=function(b,c,d){if(f._iO.onwarning)f._iO.onwarning(b,c,d)};this._onfinish=function(){var b=f._iO.onfinish;f._onbufferchange(0);f._resetOnPosition(0);f.instanceCount&&(f.instanceCount--,f.instanceCount||(L(),f.playState=0,f.paused=false,f.instanceCount=0,f.instanceOptions={},f._iO={},k(),f.isHTML5&&(f.position=0)),f.instanceCount&&
!f._iO.multiShotEvents||!b||(l._wD(f.id+": onfinish()"),db(f,function(){b.apply(f)})))};this._whileloading=function(b,c,d,e){var g=f._iO;f.bytesLoaded=b;f.bytesTotal=c;f.duration=Math.floor(d);f.bufferLength=e;f.durationEstimate=f.isHTML5||g.isMovieStar?f.duration:g.duration?f.duration>g.duration?f.duration:g.duration:parseInt(f.bytesTotal/f.bytesLoaded*f.duration,10);f.isHTML5||(f.buffered=[{start:0,end:f.duration}]);(3!==f.readyState||f.isHTML5)&&g.whileloading&&g.whileloading.apply(f)};this._whileplaying=
function(b,d,e,g,h){var j=f._iO;if(isNaN(b)||null===b)return false;f.position=Math.max(0,b);f._processOnPosition();!f.isHTML5&&8<w&&(j.usePeakData&&d!==c&&d&&(f.peakData={left:d.leftPeak,right:d.rightPeak}),j.useWaveformData&&e!==c&&e&&(f.waveformData={left:e.split(","),right:g.split(",")}),j.useEQData&&h!==c&&h&&h.leftEQ&&(b=h.leftEQ.split(","),f.eqData=b,f.eqData.left=b,h.rightEQ!==c&&h.rightEQ&&(f.eqData.right=h.rightEQ.split(","))));1===f.playState&&(f.isHTML5||8!==w||f.position||!f.isBuffering||
f._onbufferchange(0),j.whileplaying&&j.whileplaying.apply(f));return true};this._oncaptiondata=function(b){l._wD(f.id+": Caption data received.");f.captiondata=b;f._iO.oncaptiondata&&f._iO.oncaptiondata.apply(f,[b])};this._onmetadata=function(b,c){l._wD(f.id+": Metadata received.");var d={},e,g;e=0;for(g=b.length;e<g;e++)d[b[e]]=c[e];f.metadata=d;f._iO.onmetadata&&f._iO.onmetadata.call(f,f.metadata)};this._onid3=function(b,c){l._wD(f.id+": ID3 data received.");var d=[],e,g;e=0;for(g=b.length;e<g;e++)d[b[e]]=
c[e];f.id3=J(f.id3,d);f._iO.onid3&&f._iO.onid3.apply(f)};this._onconnect=function(b){b=1===b;l._wD(f.id+": "+(b?"Connected.":"Failed to connect? - "+f.url),b?1:2);if(f.connected=b){f.failures=0;ma(f.id)&&(f.getAutoPlay()?f.play(c,f.getAutoPlay()):f._iO.autoLoad&&f.load());f._iO.onconnect&&f._iO.onconnect.apply(f,[b])}};this._ondataerror=function(b){0<f.playState&&(l._wD(f.id+": Data error: "+b),f._iO.ondataerror&&f._iO.ondataerror.apply(f))};this._debug()};ja=function(){return r.body||r.getElementsByTagName("div")[0]};
q=function(b){return r.getElementById(b)};J=function(b,d){var e=b||{},f,g;f=d===c?l.defaultOptions:d;for(g in f)f.hasOwnProperty(g)&&e[g]===c&&(e[g]="object"!==typeof f[g]||null===f[g]?f[g]:J(e[g],f[g]));return e};db=function(c,d){c.isHTML5||8!==w?d():b.setTimeout(d,0)};U={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1};N=function(b,d){var e,f=true,g=d!==c,h=l.setupOptions;if(b===c){f=[];for(e in h)h.hasOwnProperty(e)&&f.push(e);for(e in U)U.hasOwnProperty(e)&&("object"===
typeof l[e]?f.push(e+": {...}"):l[e]instanceof Function?f.push(e+": function() {...}"):f.push(e));l._wD(fa("setup",f.join(", ")));return false}for(e in b)if(b.hasOwnProperty(e))if("object"!==typeof b[e]||null===b[e]||b[e]instanceof Array||b[e]instanceof RegExp)g&&U[d]!==c?l[d][e]=b[e]:h[e]!==c?(l.setupOptions[e]=b[e],l[e]=b[e]):U[e]===c?(ea(fa(l[e]===c?"setupUndef":"setupError",e),2),f=false):l[e]instanceof Function?l[e].apply(l,b[e]instanceof Array?b[e]:[b[e]]):l[e]=b[e];else if(U[e]===c){ea(fa(l[e]===
c?"setupUndef":"setupError",e),2);f=false}else return N(b[e],e);return f};qa=function(){function c(b){var b=za.call(b),d=b.length;e?(b[1]="on"+b[1],3<d&&b.pop()):3===d&&b.push(false);return b}function d(b,c){var g=b.shift(),h=[f[c]];if(e)g[h](b[0],b[1]);else g[h].apply(g,b)}var e=b.attachEvent,f={add:e?"attachEvent":"addEventListener",remove:e?"detachEvent":"removeEventListener"};return{add:function(){d(c(arguments),"add")},remove:function(){d(c(arguments),"remove")}}}();na={abort:j(function(){l._wD(this._s.id+
": abort")}),canplay:j(function(){var b=this._s,d;if(b._html5_canplay)return true;b._html5_canplay=true;l._wD(b.id+": canplay");b._onbufferchange(0);d=b._iO.position===c||isNaN(b._iO.position)?null:b._iO.position/1E3;if(this.currentTime!==d){l._wD(b.id+": canplay: Setting position to "+d);try{this.currentTime=d}catch(e){l._wD(b.id+": canplay: Setting position of "+d+" failed: "+e.message,2)}}b._iO._oncanplay&&b._iO._oncanplay()}),canplaythrough:j(function(){var b=this._s;b.loaded||(b._onbufferchange(0),
b._whileloading(b.bytesLoaded,b.bytesTotal,b._get_html5_duration()),b._onload(true))}),durationchange:j(function(){var b=this._s,c;c=b._get_html5_duration();isNaN(c)||c===b.duration||(l._wD(this._s.id+": durationchange ("+c+")"+(b.duration?", previously "+b.duration:"")),b.durationEstimate=b.duration=c)}),ended:j(function(){var b=this._s;l._wD(b.id+": ended");b._onfinish()}),error:j(function(){l._wD(this._s.id+": HTML5 error, code "+this.error.code);this._s._onload(false)}),loadeddata:j(function(){var b=
this._s;l._wD(b.id+": loadeddata");b._loaded||pb||(b.duration=b._get_html5_duration())}),loadedmetadata:j(function(){l._wD(this._s.id+": loadedmetadata")}),loadstart:j(function(){l._wD(this._s.id+": loadstart");this._s._onbufferchange(1)}),play:j(function(){this._s._onbufferchange(0)}),playing:j(function(){l._wD(this._s.id+": playing "+String.fromCharCode(9835));this._s._onbufferchange(0)}),progress:j(function(b){var c=this._s,d,e,f,g="progress"===b.type,h=b.target.buffered,j=b.loaded||0,k=b.total||
1;c.buffered=[];if(h&&h.length){d=0;for(e=h.length;d<e;d++)c.buffered.push({start:1E3*h.start(d),end:1E3*h.end(d)});d=1E3*(h.end(0)-h.start(0));j=Math.min(1,d/(1E3*b.target.duration));if(g&&1<h.length){f=[];e=h.length;for(d=0;d<e;d++)f.push(1E3*b.target.buffered.start(d)+"-"+1E3*b.target.buffered.end(d));l._wD(this._s.id+": progress, timeRanges: "+f.join(", "))}g&&!isNaN(j)&&l._wD(this._s.id+": progress, "+Math.floor(100*j)+"% loaded")}isNaN(j)||(c._whileloading(j,k,c._get_html5_duration()),j&&k&&
j===k&&na.canplaythrough.call(this,b))}),ratechange:j(function(){l._wD(this._s.id+": ratechange")}),suspend:j(function(b){var c=this._s;l._wD(this._s.id+": suspend");na.progress.call(this,b);c._onsuspend()}),stalled:j(function(){l._wD(this._s.id+": stalled")}),timeupdate:j(function(){this._s._onTimer()}),waiting:j(function(){var b=this._s;l._wD(this._s.id+": waiting");b._onbufferchange(1)})};Ia=function(b){return b&&(b.type||b.url||b.serverURL)?b.serverURL||b.type&&h(b.type)?false:b.type?qb({type:b.type}):
qb({url:b.url})||l.html5Only||b.url.match(/data\:/i):false};cb=function(b){var d;b&&(d=pb?"about:blank":l.html5.canPlayType("audio/wav")?"data:audio/wave;base64,/UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQIAAAD//w==":"about:blank",b.src=d,b._called_unload!==c&&(b._called_load=false));ua&&(hb=null);return d};qb=function(b){if(!l.useHTML5Audio||!l.hasHTML5)return false;var d=b.url||null,b=b.type||null,e=l.audioFormats,f;if(b&&l.html5[b]!==c)return l.html5[b]&&!h(b);if(!Ma){Ma=[];for(f in e)e.hasOwnProperty(f)&&
(Ma.push(f),e[f].related&&(Ma=Ma.concat(e[f].related)));Ma=RegExp("\\.("+Ma.join("|")+")(\\?.*)?$","i")}(f=d?d.toLowerCase().match(Ma):null)&&f.length?f=f[1]:b&&(d=b.indexOf(";"),f=(-1!==d?b.substr(0,d):b).substr(6));f&&l.html5[f]!==c?d=l.html5[f]&&!h(f):(b="audio/"+f,d=l.html5.canPlayType({type:b}),d=(l.html5[f]=d)&&l.html5[b]&&!h(b));return d};Qa=function(){function b(c){var e,f=e=false;if(!d||"function"!==typeof d.canPlayType)return e;if(c instanceof Array){j=0;for(e=c.length;j<e;j++)if(l.html5[c[j]]||
d.canPlayType(c[j]).match(l.html5Test)){f=true;l.html5[c[j]]=true;l.flash[c[j]]=!!c[j].match(gc)}e=f}else{c=d&&"function"===typeof d.canPlayType?d.canPlayType(c):false;e=!(!c||!c.match(l.html5Test))}return e}if(!l.useHTML5Audio||!l.hasHTML5)return xa=l.html5.usingFlash=true,false;var d=Audio!==c?Rb&&10>opera.version()?new Audio(null):new Audio:null,e,f,g={},h,j;h=l.audioFormats;for(e in h)if(h.hasOwnProperty(e)&&(f="audio/"+e,g[e]=b(h[e].type),g[f]=g[e],e.match(gc)?(l.flash[e]=true,l.flash[f]=true):
(l.flash[e]=false,l.flash[f]=false),h[e]&&h[e].related))for(j=h[e].related.length-1;0<=j;j--){g["audio/"+h[e].related[j]]=g[e];l.html5[h[e].related[j]]=g[e];l.flash[h[e].related[j]]=g[e]}g.canPlayType=d?b:null;l.html5=J(l.html5,g);l.html5.usingFlash=Hb();xa=l.html5.usingFlash;return true};Y={notReady:"Unavailable - wait until onready() has fired.",notOK:"Audio support is not available.",domError:"soundManagerexception caught while appending SWF to DOM.",spcWmode:"Removing wmode, preventing known SWF loading issue(s)",
swf404:"soundManager: Verify that %s is a valid path.",tryDebug:"Try soundManager.debugFlash = true for more security details (output goes to SWF.)",checkSWF:"See SWF output for more debug info.",localFail:"soundManager: Non-HTTP page ("+r.location.protocol+" URL?) Review Flash player security settings for this special case:\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/",waitFocus:"soundManager: Special case: Waiting for SWF to load with window focus...",
waitForever:"soundManager: Waiting indefinitely for Flash (will recover if unblocked)...",waitSWF:"soundManager: Waiting for 100% SWF load...",needFunction:"soundManager: Function object expected for %s",badID:'Sound ID "%s" should be a string, starting with a non-numeric character',currentObj:"soundManager: _debug(): Current sound objects",waitOnload:"soundManager: Waiting for window.onload()",docLoaded:"soundManager: Document already loaded",onload:"soundManager: initComplete(): calling soundManager.onload()",
onloadOK:"soundManager.onload() complete",didInit:"soundManager: init(): Already called?",secNote:"Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html",badRemove:"soundManager: Failed to remove Flash node.",shutdown:"soundManager.disable(): Shutting down",queue:"soundManager: Queueing %s handler",smError:"SMSound.load(): Exception: JS-Flash communication failed, or JS error.",
fbTimeout:"No flash response, applying .swf_timedout CSS...",fbLoaded:"Flash loaded",fbHandler:"soundManager: flashBlockHandler()",manURL:"SMSound.load(): Using manually-assigned URL",onURL:"soundManager.load(): current URL already assigned.",badFV:'soundManager.flashVersion must be 8 or 9. "%s" is invalid. Reverting to %s.',as2loop:"Note: Setting stream:false so looping can work (flash 8 limitation)",noNSLoop:"Note: Looping not implemented for MovieStar formats",needfl9:"Note: Switching to flash 9, required for MP4 formats.",
mfTimeout:"Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case",needFlash:"soundManager: Fatal error: Flash is needed to play some required formats, but is not available.",gotFocus:"soundManager: Got window focus.",policy:"Enabling usePolicyFile for data access",setup:"soundManager.setup(): allowed parameters: %s",setupError:'soundManager.setup(): "%s" cannot be assigned with this method.',setupUndef:'soundManager.setup(): Could not find option "%s"',setupLate:"soundManager.setup(): url, flashVersion and html5Test property changes will not take effect until reboot().",
noURL:"soundManager: Flash URL required. Call soundManager.setup({url:...}) to get started.",sm2Loaded:"SoundManager 2: Ready. "+String.fromCharCode(10003),reset:"soundManager.reset(): Removing event callbacks",mobileUA:"Mobile UA detected, preferring HTML5 by default.",globalHTML5:"Using singleton HTML5 Audio() pattern for this device.",ignoreMobile:"Ignoring mobile restrictions for this device."};fa=function(){var b,c,d,e;b=za.call(arguments);c=b.shift();if((e=Y&&Y[c]?Y[c]:"")&&b&&b.length){c=0;
for(d=b.length;c<d;c++)e=e.replace("%s",b[c])}return e};tb=function(b){8===w&&1<b.loops&&b.stream&&(D("as2loop"),b.stream=false);return b};kb=function(b,c){b&&!b.usePolicyFile&&(b.onid3||b.usePeakData||b.useWaveformData||b.useEQData)&&(l._wD((c||"")+fa("policy")),b.usePolicyFile=true);return b};ea=function(b){ac&&console.warn!==c?console.warn(b):l._wD(b)};o=function(){return false};ta=function(b){for(var c in b)b.hasOwnProperty(c)&&"function"===typeof b[c]&&(b[c]=o)};sa=function(b){b===c&&(b=false);
(P||b)&&l.disable(b)};Da=function(b){if(b)if(b.match(/\.swf(\?.*)?$/i)){if(b.substr(b.toLowerCase().lastIndexOf(".swf?")+4))return b}else b.lastIndexOf("/")!==b.length-1&&(b=b+"/");b=(b&&-1!==b.lastIndexOf("/")?b.substr(0,b.lastIndexOf("/")+1):"./")+l.movieURL;l.noSWFCache&&(b=b+("?ts="+(new Date).getTime()));return b};X=function(){w=parseInt(l.flashVersion,10);8!==w&&9!==w&&(l._wD(fa("badFV",w,8)),l.flashVersion=w=8);var b=l.debugMode||l.debugFlash?"_debug.swf":".swf";l.useHTML5Audio&&!l.html5Only&&
l.audioFormats.mp4.required&&9>w&&(l._wD(fa("needfl9")),l.flashVersion=w=9);l.version=l.versionNumber+(l.html5Only?" (HTML5-only mode)":9===w?" (AS3/Flash 9)":" (AS2/Flash 8)");8<w?(l.defaultOptions=J(l.defaultOptions,l.flash9Options),l.features.buffering=true,l.defaultOptions=J(l.defaultOptions,l.movieStarOptions),l.filePatterns.flash9=RegExp("\\.(mp3|"+jb.join("|")+")(\\?.*)?$","i"),l.features.movieStar=true):l.features.movieStar=false;l.filePattern=l.filePatterns[8!==w?"flash9":"flash8"];l.movieURL=
(8===w?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",b);l.features.peakData=l.features.waveformData=l.features.eqData=8<w};pa=function(b,c){if(!n)return false;n._setPolling(b,c)};V=function(){l.debugURLParam.test(s)&&(l.setupOptions.debugMode=l.debugMode=true);if(q(l.debugID))return false;var b,c,d,e;if(l.debugMode&&!(q(l.debugID)||ac&&l.useConsole&&l.consoleOnly)){b=r.createElement("div");b.id=l.debugID+"-toggle";c={position:"fixed",bottom:"0px",right:"0px",width:"1.2em",height:"1.2em",
lineHeight:"1.2em",margin:"2px",textAlign:"center",border:"1px solid #999",cursor:"pointer",background:"#fff",color:"#333",zIndex:10001};b.appendChild(r.createTextNode("-"));b.onclick=Na;b.title="Toggle SM2 debug console";p.match(/msie 6/i)&&(b.style.position="absolute",b.style.cursor="hand");for(e in c)c.hasOwnProperty(e)&&(b.style[e]=c[e]);c=r.createElement("div");c.id=l.debugID;c.style.display=l.debugMode?"block":"none";if(l.debugMode&&!q(b.id)){try{d=ja();d.appendChild(b)}catch(f){throw Error(fa("domError")+
" \n"+f.toString());}d.appendChild(c)}}};ma=this.getSoundById;D=function(b,c){return b?l._wD(fa(b),c):""};Na=function(){var b=q(l.debugID),c=q(l.debugID+"-toggle");if(!b)return false;A?(c.innerHTML="+",b.style.display="none"):(c.innerHTML="-",b.style.display="block");A=!A};C=function(d,e,f){if(b.sm2Debugger!==c)try{sm2Debugger.handleEvent(d,e,f)}catch(g){return false}return true};v=function(){var b=[];l.debugMode&&b.push("sm2_debug");l.debugFlash&&b.push("flash_debug");l.useHighPerformance&&b.push("high_performance");
return b.join(" ")};R=function(){var b=fa("fbHandler"),c=l.getMoviePercent(),d={type:"FLASHBLOCK"};if(l.html5Only)return false;l.ok()?(l.didFlashBlock&&l._wD(b+": Unblocked"),l.oMC&&(l.oMC.className=[v(),"movieContainer","swf_loaded"+(l.didFlashBlock?" swf_unblocked":"")].join(" "))):(xa&&(l.oMC.className=v()+" movieContainer "+(null===c?"swf_timedout":"swf_error"),l._wD(b+": "+fa("fbTimeout")+(c?" ("+fa("fbLoaded")+")":""))),l.didFlashBlock=true,B({type:"ontimeout",ignoreInit:true,error:d}),oa(d))};
Q=function(b,d,e){z[b]===c&&(z[b]=[]);z[b].push({method:d,scope:e||null,fired:false})};B=function(b){b||(b={type:l.ok()?"onready":"ontimeout"});if(!K&&b&&!b.ignoreInit||"ontimeout"===b.type&&(l.ok()||P&&!b.ignoreInit))return false;var c={success:b&&b.ignoreInit?l.ok():!P},d=b&&b.type?z[b.type]||[]:[],e=[],f,c=[c],g=xa&&!l.ok();b.error&&(c[0].error=b.error);b=0;for(f=d.length;b<f;b++)true!==d[b].fired&&e.push(d[b]);if(e.length){b=0;for(f=e.length;b<f;b++){e[b].scope?e[b].method.apply(e[b].scope,c):
e[b].method.apply(this,c);g||(e[b].fired=true)}}return true};E=function(){b.setTimeout(function(){l.useFlashBlock&&R();B();"function"===typeof l.onload&&(D("onload",1),l.onload.apply(b),D("onloadOK",1));l.waitForWindowLoad&&qa.add(b,"load",E)},1)};Pa=function(){if(Ka!==c)return Ka;var d=false,e=navigator,f=e.plugins,g,h=b.ActiveXObject;if(f&&f.length)(e=e.mimeTypes)&&e["application/x-shockwave-flash"]&&e["application/x-shockwave-flash"].enabledPlugin&&e["application/x-shockwave-flash"].enabledPlugin.description&&
(d=true);else if(h!==c&&!p.match(/MSAppHost/i)){try{g=new h("ShockwaveFlash.ShockwaveFlash")}catch(j){g=null}d=!!g}return Ka=d};Hb=function(){var b,c,d=l.audioFormats;vb&&p.match(/os (1|2|3_0|3_1)\s/i)?(l.hasHTML5=false,l.html5Only=true,l.oMC&&(l.oMC.style.display="none")):l.useHTML5Audio&&(l.html5&&l.html5.canPlayType||(l._wD("SoundManager: No HTML5 Audio() support detected."),l.hasHTML5=false),$b&&l._wD("soundManager: Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - "+
(Ka?"will use flash fallback for MP3/MP4, if available":" would use flash fallback for MP3/MP4, but none detected."),1));if(l.useHTML5Audio&&l.hasHTML5)for(c in Aa=true,d)d.hasOwnProperty(c)&&d[c].required&&(l.html5.canPlayType(d[c].type)?l.preferFlash&&(l.flash[c]||l.flash[d[c].type])&&(b=true):(Aa=false,b=true));l.ignoreFlash&&(b=false,Aa=true);l.html5Only=l.hasHTML5&&l.useHTML5Audio&&!b;return!l.html5Only};bb=function(b){var c,d,e=0;if(b instanceof Array){c=0;for(d=b.length;c<d;c++)if(b[c]instanceof
Object){if(l.canPlayMIME(b[c].type)){e=c;break}}else if(l.canPlayURL(b[c])){e=c;break}b[e].url&&(b[e]=b[e].url);b=b[e]}return b};Va=function(b){b._hasTimer||(b._hasTimer=true,!Mb&&l.html5PollingInterval&&(null===Sa&&0===Fa&&(Sa=setInterval(xb,l.html5PollingInterval)),Fa++))};nb=function(b){b._hasTimer&&(b._hasTimer=false,!Mb&&l.html5PollingInterval&&Fa--)};xb=function(){var b;if(null!==Sa&&!Fa)return clearInterval(Sa),Sa=null,false;for(b=l.soundIDs.length-1;0<=b;b--)l.sounds[l.soundIDs[b]].isHTML5&&
l.sounds[l.soundIDs[b]]._hasTimer&&l.sounds[l.soundIDs[b]]._onTimer()};oa=function(d){d=d!==c?d:{};"function"===typeof l.onerror&&l.onerror.apply(b,[{type:d.type!==c?d.type:null}]);d.fatal!==c&&d.fatal&&l.disable()};yb=function(){if(!$b||!Pa())return false;var b=l.audioFormats,c,d;for(d in b)if(b.hasOwnProperty(d)&&("mp3"===d||"mp4"===d)&&(l._wD("soundManager: Using flash fallback for "+d+" format"),l.html5[d]=false,b[d]&&b[d].related))for(c=b[d].related.length-1;0<=c;c--)l.html5[b[d].related[c]]=
false};this._setSandboxType=function(b){var d=l.sandbox;d.type=b;d.description=d.types[d.types[b]!==c?b:"unknown"];"localWithFile"===d.type?(d.noRemote=true,d.noLocal=false,D("secNote",2)):"localWithNetwork"===d.type?(d.noRemote=false,d.noLocal=true):"localTrusted"===d.type&&(d.noRemote=false,d.noLocal=false)};this._externalInterfaceOK=function(b){if(l.swfLoaded)return false;var c;C("swf",true);C("flashtojs",true);l.swfLoaded=true;Ya=false;$b&&yb();if(!b||b.replace(/\+dev/i,"")!==l.versionNumber.replace(/\+dev/i,
""))return c='soundManager: Fatal: JavaScript file build "'+l.versionNumber+'" does not match Flash SWF build "'+b+'" at '+l.url+". Ensure both are up-to-date.",setTimeout(function(){throw Error(c);},0),false;setTimeout(u,Ga?100:1)};ka=function(b,d){function e(){var b=[],c,d=[];c="SoundManager "+l.version+(!l.html5Only&&l.useHTML5Audio?l.hasHTML5?" + HTML5 audio":", no HTML5 audio support":"");l.html5Only?l.html5PollingInterval&&b.push("html5PollingInterval ("+l.html5PollingInterval+"ms)"):(l.preferFlash&&
b.push("preferFlash"),l.useHighPerformance&&b.push("useHighPerformance"),l.flashPollingInterval&&b.push("flashPollingInterval ("+l.flashPollingInterval+"ms)"),l.html5PollingInterval&&b.push("html5PollingInterval ("+l.html5PollingInterval+"ms)"),l.wmode&&b.push("wmode ("+l.wmode+")"),l.debugFlash&&b.push("debugFlash"),l.useFlashBlock&&b.push("flashBlock"));b.length&&(d=d.concat([b.join(" + ")]));l._wD(c+(d.length?" + "+d.join(", "):""),1);Fb()}function f(b,c){return'<param name="'+b+'" value="'+c+
'" />'}if(G&&H)return false;if(l.html5Only)return X(),e(),l.oMC=q(l.movieID),u(),H=G=true,false;var g=d||l.url,h=l.altURL||g,j=ja(),k=v(),m=null,m=r.getElementsByTagName("html")[0],o,n,s,m=m&&m.dir&&m.dir.match(/rtl/i),b=b===c?l.id:b;X();l.url=Da(Za?g:h);d=l.url;l.wmode=!l.wmode&&l.useHighPerformance?"transparent":l.wmode;null!==l.wmode&&(p.match(/msie 8/i)||!Ga&&!l.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(Ta.push(Y.spcWmode),l.wmode=null);j={name:b,id:b,src:d,quality:"high",
allowScriptAccess:l.allowScriptAccess,bgcolor:l.bgColor,pluginspage:Sb+"www.macromedia.com/go/getflashplayer",title:"JS/Flash audio component (SoundManager 2)",type:"application/x-shockwave-flash",wmode:l.wmode,hasPriority:"true"};l.debugFlash&&(j.FlashVars="debug=1");l.wmode||delete j.wmode;if(Ga){g=r.createElement("div");n=['<object id="'+b+'" data="'+d+'" type="'+j.type+'" title="'+j.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',
f("movie",d),f("AllowScriptAccess",l.allowScriptAccess),f("quality",j.quality),l.wmode?f("wmode",l.wmode):"",f("bgcolor",l.bgColor),f("hasPriority","true"),l.debugFlash?f("FlashVars",j.FlashVars):"","</object>"].join("")}else for(o in g=r.createElement("embed"),j)j.hasOwnProperty(o)&&g.setAttribute(o,j[o]);V();k=v();if(j=ja())if(l.oMC=q(l.movieID)||r.createElement("div"),l.oMC.id){s=l.oMC.className;l.oMC.className=(s?s+" ":"movieContainer")+(k?" "+k:"");l.oMC.appendChild(g);Ga&&(o=l.oMC.appendChild(r.createElement("div")),
o.className="sm2-object-box",o.innerHTML=n);H=true}else{l.oMC.id=l.movieID;l.oMC.className="movieContainer "+k;o=k=null;l.useFlashBlock||(l.useHighPerformance?k={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(k={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},m&&(k.left=Math.abs(parseInt(k.left,10))+"px")));Ha&&(l.oMC.style.zIndex=1E4);if(!l.debugFlash)for(s in k)k.hasOwnProperty(s)&&(l.oMC.style[s]=k[s]);try{Ga||l.oMC.appendChild(g);
j.appendChild(l.oMC);Ga&&(o=l.oMC.appendChild(r.createElement("div")),o.className="sm2-object-box",o.innerHTML=n);H=true}catch(t){throw Error(fa("domError")+" \n"+t.toString());}}G=true;e();return true};ba=function(){if(l.html5Only)return ka(),false;if(n)return false;if(!l.url)return D("noURL"),false;(n=l.getMovie(l.id))||(L?(Ga?l.oMC.innerHTML=W:l.oMC.appendChild(L),L=null,G=true):ka(l.id,l.url),n=l.getMovie(l.id));"function"===typeof l.oninitmovie&&setTimeout(l.oninitmovie,1);Ja();return true};
Z=function(){setTimeout(O,1E3)};M=function(){b.setTimeout(function(){ea("soundManager: useFlashBlock is false, 100% HTML5 mode is possible. Rebooting with preferFlash: false...");l.setup({preferFlash:false}).reboot();l.didFlashBlock=true;l.beginDelayedInit()},1)};O=function(){var c,d=false;if(!l.url||Ca)return false;Ca=true;qa.remove(b,"load",Z);if(Ka&&Ya&&!Nb)return D("waitFocus"),false;K||(c=l.getMoviePercent(),0<c&&100>c&&(d=true));setTimeout(function(){c=l.getMoviePercent();if(d)return Ca=false,
l._wD(fa("waitSWF")),b.setTimeout(Z,1),false;K||(l._wD("soundManager: No Flash response within expected time. Likely causes: "+(0===c?"SWF load failed, ":"")+"Flash blocked or JS-Flash security error."+(l.debugFlash?" "+fa("checkSWF"):""),2),!Za&&c&&(D("localFail",2),l.debugFlash||D("tryDebug",2)),0===c&&l._wD(fa("swf404",l.url),1),C("flashtojs",false,": Timed out"+(Za?" (Check flash security or flash blockers)":" (No plugin/missing SWF?)")));!K&&bc&&(null===c?l.useFlashBlock||0===l.flashLoadTimeout?
(l.useFlashBlock&&R(),D("waitForever")):!l.useFlashBlock&&Aa?M():(D("waitForever"),B({type:"ontimeout",ignoreInit:true,error:{type:"INIT_FLASHBLOCK"}})):0===l.flashLoadTimeout?D("waitForever"):!l.useFlashBlock&&Aa?M():sa(true))},l.flashLoadTimeout)};aa=function(){if(Nb||!Ya)return qa.remove(b,"focus",aa),true;Nb=bc=true;D("gotFocus");Ca=false;Z();qa.remove(b,"focus",aa);return true};Ja=function(){Ta.length&&(l._wD("SoundManager 2: "+Ta.join(" "),1),Ta=[])};Fb=function(){Ja();var b,c=[];if(l.useHTML5Audio&&
l.hasHTML5){for(b in l.audioFormats)l.audioFormats.hasOwnProperty(b)&&c.push(b+" = "+l.html5[b]+(!l.html5[b]&&xa&&l.flash[b]?" (using flash)":l.preferFlash&&l.flash[b]&&xa?" (preferring flash)":l.html5[b]?"":" ("+(l.audioFormats[b].required?"required, ":"")+"and no flash support)"));l._wD("SoundManager 2 HTML5 support: "+c.join(", "),1)}};I=function(c){if(K)return false;if(l.html5Only)return D("sm2Loaded",1),K=true,E(),C("onload",true),true;var d=true,e;l.useFlashBlock&&l.flashLoadTimeout&&!l.getMoviePercent()||
(K=true);e={type:!Ka&&xa?"NO_FLASH":"INIT_TIMEOUT"};l._wD("SoundManager 2 "+(P?"failed to load":"loaded")+" ("+(P?"Flash security/load error":"OK")+") "+String.fromCharCode(P?10006:10003),P?2:1);P||c?(l.useFlashBlock&&l.oMC&&(l.oMC.className=v()+" "+(null===l.getMoviePercent()?"swf_timedout":"swf_error")),B({type:"ontimeout",error:e,ignoreInit:true}),C("onload",false),oa(e),d=false):C("onload",true);P||(l.waitForWindowLoad&&!T?(D("waitOnload"),qa.add(b,"load",E)):(l.waitForWindowLoad&&T&&D("docLoaded"),
E()));return d};t=function(){var b,d=l.setupOptions;for(b in d)d.hasOwnProperty(b)&&(l[b]===c?l[b]=d[b]:l[b]!==d[b]&&(l.setupOptions[b]=l[b]))};u=function(){if(K)return D("didInit"),false;if(l.html5Only)return K||(qa.remove(b,"load",l.beginDelayedInit),l.enabled=true,I()),true;ba();try{n._externalInterfaceTest(false);pa(true,l.flashPollingInterval||(l.useHighPerformance?10:50));l.debugMode||n._disableDebug();l.enabled=true;C("jstoflash",true);l.html5Only||qa.add(b,"unload",o)}catch(c){return l._wD("js/flash exception: "+
c.toString()),C("jstoflash",false),oa({type:"JS_TO_FLASH_EXCEPTION",fatal:true}),sa(true),I(),false}I();qa.remove(b,"load",l.beginDelayedInit);return true};da=function(){if(x)return false;x=true;t();V();!Ka&&l.hasHTML5&&(l._wD("SoundManager 2: No Flash detected"+(l.useHTML5Audio?". Trying HTML5-only mode.":", enabling HTML5."),1),l.setup({useHTML5Audio:true,preferFlash:false}));Qa();!Ka&&xa&&(Ta.push(Y.needFlash),l.setup({flashLoadTimeout:1}));r.removeEventListener&&r.removeEventListener("DOMContentLoaded",
da,false);ba();return true};gb=function(){"complete"===r.readyState&&(da(),r.detachEvent("onreadystatechange",gb));return true};ra=function(){T=true;da();qa.remove(b,"load",ra)};Pa();qa.add(b,"focus",aa);qa.add(b,"load",Z);qa.add(b,"load",ra);r.addEventListener?r.addEventListener("DOMContentLoaded",da,false):r.attachEvent?r.attachEvent("onreadystatechange",gb):(C("onload",false),oa({type:"NO_DOM2_EVENTS",fatal:true}))}if(!b||!b.document)throw Error("SoundManager requires a browser with window and document objects.");
var e=null;b.SM2_DEFER!==c&&SM2_DEFER||(e=new d);"object"===typeof module&&module&&"object"===typeof module.exports?(module.exports.SoundManager=d,module.exports.soundManager=e):"function"===typeof define&&define.amd&&define(function(){return{constructor:d,getInstance:function(c){!b.soundManager&&c instanceof Function&&(c=c(d),c instanceof d&&(b.soundManager=c));return b.soundManager}}});b.SoundManager=d;b.soundManager=e})(window);
function FilterUtils(){this.HSVtoRGB=function(b,c,f){var g,h,j,k=Math.floor(b*6),l=b*6-k,b=f*(1-c),m=f*(1-l*c),c=f*(1-(1-l)*c);switch(k%6){case 0:g=f;h=c;j=b;break;case 1:g=m;h=f;j=b;break;case 2:g=b;h=f;j=c;break;case 3:g=b;h=m;j=f;break;case 4:g=c;h=b;j=f;break;case 5:g=f;h=b;j=m}return[g*255,h*255,j*255]};this.RGBtoHSV=function(b,c,f){var b=b/255,c=c/255,f=f/255,g=Math.max(b,c,f),h=Math.min(b,c,f),j,k=g-h;if(g===h)j=0;else{switch(g){case b:j=(c-f)/k+(c<f?6:0);break;case c:j=(f-b)/k+2;break;case f:j=
(b-c)/k+4}j=j/6}return[j,g===0?0:k/g,g]};this.getPixel=function(b,c,f,g,h){var j=(f*g+c)*4;return c<0||c>=g||f<0||f>=h?[b[(this.clampPixel(f,0,h-1)*g+this.clampPixel(c,0,g-1))*4],b[(this.clampPixel(f,0,h-1)*g+this.clampPixel(c,0,g-1))*4+1],b[(this.clampPixel(f,0,h-1)*g+this.clampPixel(c,0,g-1))*4+2],b[(this.clampPixel(f,0,h-1)*g+this.clampPixel(c,0,g-1))*4+3]]:[b[j],b[j+1],b[j+2],b[j+3]]};var b=false,c;this.gaussianRandom=function(){if(b)return b=false,c;var d,e,f;do{d=2*Math.random()-1;e=2*Math.random()-
1;f=d*d+e*e}while(f>=1||f===0);f=Math.sqrt(-2*Math.log(f)/f);c=e*f;b=true;return d*f};this.clampPixel=function(b,c,f){return b<c?c:b>f?f:b};this.triangle=function(b){b=this.mod(b,1);return 2*(b<0.5?b:1-b)};this.mod=function(b,c){var f=parseInt(b/c,10),b=b-f*c;return b<0?b+c:b};this.mixColors=function(b,c,f){var g=this.linearInterpolate(b,c[0],f[0]),h=this.linearInterpolate(b,c[1],f[1]),j=this.linearInterpolate(b,c[2],f[2]),b=this.linearInterpolate(b,c[3],f[3]);return[g,h,j,b]};this.linearInterpolate=
function(b,c,f){return c+b*(f-c)};this.bilinearInterpolate=function(b,c,f,g,h,j){var k=f[0],l=f[1],m=f[2],n=g[0],q=g[1],p=g[2],s=h[0],r=h[1],o=h[2],t=h[3],u=j[0],w=j[1],h=j[2],z=j[3],j=1-b,A=1-c,f=j*f[3]+b*g[3];return[A*(j*k+b*n)+c*(j*s+b*u),A*(j*l+b*q)+c*(j*r+b*w),A*(j*m+b*p)+c*(j*o+b*h),A*f+c*(j*t+b*z)]};this.tableFilter=function(b,c,f,g){for(var h=0;h<g;h++)for(var j=0;j<f;j++)for(var k=(h*f+j)*4,l=0;l<3;l++)b[k+l]=c[b[k+l]]};this.convolveFilter=function(b,c,f,g){var h=[],j,k;j=k=Math.sqrt(c.length);
j=parseInt(j/2,10);for(var l=parseInt(k/2,10),m=0;m<g;m++)for(var n=0;n<f;n++){for(var q=(m*f+n)*4,p=0,s=0,r=0,o=-j;o<=j;o++)for(var t=m+o,t=0<=t&&t<g?t*f:m*f,u=k*(o+j)+l,w=-l;w<=l;w++){var z=c[u+w];if(z!==0){var A=n+w;0<=A&&A<f||(A=n);A=(t+A)*4;p=p+z*b[A];s=s+z*b[A+1];r=r+z*b[A+2]}}h[q]=parseInt(p+0.5,10);h[q+1]=parseInt(s+0.5,10);h[q+2]=parseInt(r+0.5,10);h[q+3]=b[q+3]}for(c=0;c<h.length;c++)b[c]=h[c]};this.transformFilter=function(b,c,f,g){for(var h=[],j=[],k=0;k<b.length;k++)j[k]=b[k];for(k=0;k<
g;k++)for(var l=0;l<f;l++){var m=(k*f+l)*4;c.apply(this,[l,k,h]);var n=Math.floor(h[0]),q=Math.floor(h[1]),p=h[0]-n,s=h[1]-q,r,o,t;n>=0&&n<f-1&&q>=0&&q<g-1?(n=(f*q+n)*4,r=[b[n],b[n+1],b[n+2],b[n+3]],o=[b[n+4],b[n+5],b[n+6],b[n+7]],t=[b[n+f*4],b[n+f*4+1],b[n+f*4+2],b[n+f*4+3]],n=[b[n+(f+1)*4],b[n+(f+1)*4+1],b[n+(f+1)*4+2],b[n+(f+1)*4+3]]):(r=this.getPixel(b,n,q,f,g),o=this.getPixel(b,n+1,q,f,g),t=this.getPixel(b,n,q+1,f,g),n=this.getPixel(b,n+1,q+1,f,g));p=this.bilinearInterpolate(p,s,r,o,t,n);j[m]=
p[0];j[m+1]=p[1];j[m+2]=p[2];j[m+3]=p[3]}for(c=0;c<j.length;c++)b[c]=j[c]}}
function BlurFilter(){this.name="Blur";this.isDirAnimatable=false;this.defaultValues={amount:3};this.valueRanges={amount:{min:0,max:10}};this.filter=function(b,c){var d=b.width,e=d<<2,f=b.height,g=b.data,h;h=c.amount;h<0&&(h=0);h=h>=2.5?0.98711*h-0.9633:h>=0.5?3.97156-4.14554*Math.sqrt(1-0.26891*h):2*h*(3.97156-4.14554*Math.sqrt(0.865545));var j=h*h,k=j*h,l=1.57825+2.44413*h+1.4281*j+0.422205*k;h=(2.44413*h+2.85619*j+1.26661*k)/l;for(var j=-(1.4281*j+1.26661*k)/l,k=0.422205*k/l,l=1-(h+j+k),m=0,n,
q,p,s,r,o,m=0;m<3;m++)for(var t=0;t<f;t++){n=t*e+m;q=t*e+(d-1<<2)+m;for(o=r=s=g[n];n<=q;n=n+4){p=l*g[n]+h*s+j*r+k*o;g[n]=p;o=r;r=s;s=p}n=t*e+(d-1<<2)+m;q=t*e+m;for(o=r=s=g[n];n>=q;n=n-4){p=l*g[n]+h*s+j*r+k*o;g[n]=p;o=r;r=s;s=p}}for(m=0;m<3;m++)for(t=0;t<d;t++){n=(t<<2)+m;q=(f-1)*e+(t<<2)+m;for(o=r=s=g[n];n<=q;n=n+e){p=l*g[n]+h*s+j*r+k*o;g[n]=p;o=r;r=s;s=p}n=(f-1)*e+(t<<2)+m;q=(t<<2)+m;for(o=r=s=g[n];n>=q;n=n-e){p=l*g[n]+h*s+j*r+k*o;g[n]=p;o=r;r=s;s=p}}}}
function BrightnessFilter(){this.name="Brightness";this.isDirAnimatable=true;this.defaultValues={amount:0};this.valueRanges={amount:{min:-1,max:1}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;for(var h=d.amount===void 0?this.defaultValues.amount:d.amount,j=0;j<f;j++)for(var k=0;k<e;k++){var l=(j*e+k)*4,m=b.RGBtoHSV(g[l],g[l+1],g[l+2]);m[2]=m[2]+h;m[2]<0?m[2]=0:m[2]>1&&(m[2]=1);for(var m=b.HSVtoRGB(m[0],m[1],m[2]),n=0;n<3;n++)g[l+
n]=m[n]}}}function BumpFilter(){this.name="Bump";this.isDirAnimatable=true;this.defaultValues={};this.valueRanges={};var b=new FilterUtils;this.filter=function(c){b.convolveFilter(c.data,[-1,-1,0,-1,1,1,0,1,1],c.width,c.height)}}
function CircleSmearFilter(){this.name="Circle Smear";this.isDirAnimatable=false;this.defaultValues={size:4,density:0.5,mix:0.5};this.valueRanges={size:{min:1,max:10},density:{min:0,max:1},mix:{min:0,max:1}};var b=new FilterUtils;this.filter=function(c,d){for(var e=c.width,f=c.height,g=c.data,h=[],j=0;j<g.length;j++)h[j]=g[j];if(d===void 0)d=this.defaultValues;var k=d.size===void 0?this.defaultValues.size:d.size;k<1&&(k=1);for(var k=parseInt(k,10),j=d.mix===void 0?this.defaultValues.mix:d.mix,k=k+
1,l=k*k,m=parseInt(2*(d.density===void 0?this.defaultValues.density:d.density)/30*e*f/2,10),n=0;n<m;n++)for(var q=(Math.random()*Math.pow(2,32)&2147483647)%e,p=(Math.random()*Math.pow(2,32)&2147483647)%f,s=[g[(p*e+q)*4],g[(p*e+q)*4+1],g[(p*e+q)*4+2],g[(p*e+q)*4+3]],r=q-k;r<q+k+1;r++)for(var o=p-k;o<p+k+1;o++){var t=(r-q)*(r-q)+(o-p)*(o-p);if(r>=0&&r<e&&o>=0&&o<f&&t<=l)for(var t=b.mixColors(j,[h[(o*e+r)*4],h[(o*e+r)*4+1],h[(o*e+r)*4+2],h[(o*e+r)*4+3]],s),u=0;u<3;u++)h[(o*e+r)*4+u]=t[u]}for(e=0;e<h.length;e++)g[e]=
h[e]}}
function ContrastFilter(){this.name="Contrast";this.isDirAnimatable=true;this.defaultValues={amount:1};this.valueRanges={amount:{min:0,max:2}};if(FilterUtils){var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;var h=d.amount===void 0?this.defaultValues.amount:d.amount;h<0&&(h=0);for(var j=[],k=0;k<256;k++)j[k]=parseInt(255*((k/255-0.5)*h+0.5),10);b.tableFilter(g,j,e,f)}}else console&&console.error("Unable to find filterutils.js, please include this file! (Required by "+this.name+
" filter)")}
function CrossSmearFilter(){this.name="Cross Smear";this.isDirAnimatable=false;this.defaultValues={distance:8,density:0.5,mix:0.5};this.valueRanges={distance:{min:0,max:30},density:{min:0,max:1},mix:{min:0,max:1}};var b=new FilterUtils;this.filter=function(c,d){for(var e=c.width,f=c.height,g=c.data,h=[],j=0;j<g.length;j++)h[j]=g[j];if(d===void 0)d=this.defaultValues;j=d.distance===void 0?this.defaultValues.distance:d.distance;j<0&&(j=0);for(var j=parseInt(j,10),k=d.mix===void 0?this.defaultValues.mix:d.mix,
l=parseInt(2*(d.density===void 0?this.defaultValues.density:d.density)*e*f/(j+1),10),m=0;m<l;m++){for(var n=(Math.random()*Math.pow(2,32)&2147483647)%e,q=(Math.random()*Math.pow(2,32)&2147483647)%f,p=Math.random()*Math.pow(2,32)%j+1,s=[g[(q*e+n)*4],g[(q*e+n)*4+1],g[(q*e+n)*4+2],g[(q*e+n)*4+3]],r,o,t=n-p;t<n+p+1;t++)if(t>=0&&t<e){r=[h[(q*e+t)*4],h[(q*e+t)*4+1],h[(q*e+t)*4+2],h[(q*e+t)*4+3]];r=b.mixColors(k,r,s);for(o=0;o<3;o++)h[(q*e+t)*4+o]=r[o]}for(t=q-p;t<q+p+1;t++)if(t>=0&&t<f){r=[h[(t*e+n)*4],
h[(t*e+n)*4+1],h[(t*e+n)*4+2],h[(t*e+n)*4+3]];r=b.mixColors(k,r,s);for(o=0;o<3;o++)h[(t*e+n)*4+o]=r[o]}}for(e=0;e<h.length;e++)g[e]=h[e]}}
function DiffusionFilter(){this.name="Diffusion";this.isDirAnimatable=false;this.defaultValues={scale:4};this.valueRanges={scale:{min:1,max:100}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;for(var h=d.scale===void 0?this.defaultValues.scale:d.scale,j=[],k=[],l=0;l<256;l++){var m=Math.PI*2*l/256;j[l]=h*Math.sin(m);k[l]=h*Math.cos(m)}transInverse=function(b,c,d){var e=parseInt(Math.random()*255,10),f=Math.random();d[0]=b+f*j[e];
d[1]=c+f*k[e]};b.transformFilter(g,transInverse,e,f)}}
function DitherFilter(){this.name="Dither";this.isDirAnimatable=false;this.defaultValues={levels:3,color:true};this.valueRanges={levels:{min:2,max:30},color:{min:false,max:true}};new FilterUtils;this.filter=function(b,c){var d=b.width,e=b.height,f=b.data,g=[],h,j;for(j=0;j<f.length;j++)g[j]=0;if(c===void 0)c=this.defaultValues;var k=c.levels===void 0?this.defaultValues.levels:c.levels,l=c.color===void 0?this.defaultValues.color:c.color;k<=1&&(k=1);var m=[0,0,0,0,0,7,3,5,1],n=0,q=[];for(h=0;h<k;h++)q[h]=
parseInt(255*h/(k-1),10);var p=[];for(h=0;h<256;h++)p[h]=parseInt(k*h/256,10);for(k=0;k<e;k++){var s=(k&1)==1,r;s?(n=(k*d+d-1)*4,r=-1):(n=k*d*4,r=1);for(var o=0;o<d;o++){var t=f[n],u=f[n+1],w=f[n+2];l||(t=u=w=parseInt((t+u+w)/3,10));var z=q[p[t]],A=q[p[u]];h=q[p[w]];g[n]=z;g[n+1]=A;g[n+2]=h;g[n+3]=f[n+3];var z=t-z,A=u-A,C=w-h;for(h=-1;h<=1;h++)if(t=h+k,0<=t&&t<e)for(j=-1;j<=1;j++)if(t=j+o,0<=t&&t<d){var G;G=s?m[(h+1)*3-j+1]:m[(h+1)*3+j+1];if(G!==0){var H=s?n-j*4:n+j*4,t=f[H],u=f[H+1],w=f[H+2];G=G/
16;t=t+z*G;u=u+A*G;w=w+C*G;f[H]=t;f[H+1]=u;f[H+2]=w}}n=n+r*4}}for(j=0;j<g.length;j++)f[j]=g[j]}}
function EdgeFilter(){this.name="Edge Detection";this.isDirAnimatable=true;this.defaultValues={};this.valueRanges={};var b=[-1,-2,-1,0,0,0,1,2,1],c=[-1,0,1,-2,0,2,-1,0,1];this.filter=function(d){for(var e=d.width,f=d.height,d=d.data,g=[],h=0;h<f;h++)for(var j=0;j<e;j++){var k=(h*e+j)*4,l=0,m=bh=gh=0;bv=gv=0;for(var n=-1;n<=1;n++)for(var q=h+n,q=q>=0&&q<f?q*e*4:h*e*4,p=3*(n+1)+1,s=-1;s<=1;s++){var r=j+s;r>=0&&r<e||(r=j);var r=r*4,o=d[q+r],t=d[q+r+1],r=d[q+r+2],u=b[p+s],w=c[p+s],l=l+parseInt(u*o,10);
bh=bh+parseInt(u*t,10);gh=gh+parseInt(u*r,10);m=m+parseInt(w*o,10);gv=gv+parseInt(w*t,10);bv=bv+parseInt(w*r,10)}o=parseInt(Math.sqrt(l*l+m*m)/1.8,10);t=parseInt(Math.sqrt(gh*gh+gv*gv)/1.8,10);r=parseInt(Math.sqrt(bh*bh+bv*bv)/1.8,10);g[k]=o;g[k+1]=t;g[k+2]=r;g[k+3]=d[k+3]}for(e=0;e<g.length;e++)d[e]=g[e]}}
function EmbossFilter(){this.name="Emboss";this.isDirAnimatable=false;this.defaultValues={height:1,angle:135,elevation:30};this.valueRanges={height:{min:1,max:10},angle:{min:0,max:360},elevation:{min:0,max:180}};this.filter=function(b,c){var d=b.width,e=b.height,f=b.data;if(c===void 0)c=this.defaultValues;for(var g=c.height===void 0?this.defaultValues.height:c.height,h=c.angle===void 0?this.defaultValues.angle:c.angle,j=c.elevation===void 0?this.defaultValues.elevation:c.elevation,h=h/180*Math.PI,
j=j/180*Math.PI,k=3*g,g=[],l=0;l<f.length;l=l+4)g[l/4]=(f[l]+f[l+1]+f[l+2])/3;var m,n,q,p,l=parseInt(Math.cos(h)*Math.cos(j)*255.9,10),h=parseInt(Math.sin(h)*Math.cos(j)*255.9,10),j=parseInt(Math.sin(j)*255.9,10);q=parseInt(1530/k,10);k=q*q;q=q*j;for(var s=0,r=0;r<e;r++,s=s+d)for(var o=s,t=o+d,u=t+d,w=0;w<d;w++,o++,t++,u++){var z=(r*d+w)*4;r!==0&&r<e-2&&w!==0&&w<d-2?(m=g[o-1]+g[t-1]+g[u-1]-g[o+1]-g[t+1]-g[u+1],n=g[u-1]+g[u]+g[u+1]-g[o-1]-g[o]-g[o+1],m=m===0&&n===0?j:(p=m*l+n*h+q)<0?0:parseInt(p/Math.sqrt(m*
m+n*n+k),10)):m=j;f[z]=f[z+1]=f[z+2]=m}}}function ExposureFilter(){this.name="Exposure";this.isDirAnimatable=true;this.defaultValues={exposure:1};this.valueRanges={exposure:{min:0,max:5}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;for(var h=d.exposure===void 0?this.defaultValues.exposure:d.exposure,j=[],k=0;k<256;k++)j[k]=parseInt(255*(1-Math.exp(-(k/255)*h)),10);b.tableFilter(g,j,e,f)}}
function GainFilter(){this.name="Gain/Bias";this.isDirAnimatable=true;this.defaultValues={gain:0.5,bias:0.5};this.valueRanges={gain:{min:0,max:1},bias:{min:0,max:1}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;for(var h=d.gain===void 0?this.defaultValues.gain:d.gain,j=d.bias===void 0?this.defaultValues.bias:d.bias,k=[],l=0;l<256;l++){var m=l/255,n=(1/h-2)*(1-2*m),m=m<0.5?m/(n+1):(n-m)/(n-1),m=m/((1/j-2)*(1-m)+1);k[l]=parseInt(255*
m,10)}b.tableFilter(g,k,e,f)}}
function GammaFilter(){this.name="Gamma";this.isDirAnimatable=true;this.defaultValues={amount:1};this.valueRanges={amount:{min:0,max:2}};this.filter=function(b,c){var d=b.width,e=b.height,f=b.data;if(c===void 0)c=this.defaultValues;var g=c.amount===void 0?this.defaultValues.amount:c.amount;g<0&&(g=0);if(FilterUtils){for(var h=new FilterUtils,j=[],k=0;k<256;k++)j[k]=255*Math.pow(k/255,1/g)+0.5;h.tableFilter(f,j,d,e)}else console&&console.error("Unable to find filterutils.js, please include this file! (Required by "+this.name+
" filter)")}}function GrayscaleFilter(){this.name="Grayscale";this.isDirAnimatable=true;this.defaultValues={};this.valueRanges={};this.filter=function(b){for(var c=b.width,d=b.height,b=b.data,e=0;e<d;e++)for(var f=0;f<c;f++){var g=(e*c+f)*4;b[g]=b[g+1]=b[g+2]=b[g]*0.3+b[g+1]*0.59+b[g+2]*0.11}}}
function HueFilter(){this.name="Hue";this.isDirAnimatable=true;this.defaultValues={amount:0};this.valueRanges={amount:{min:-1,max:1}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;for(var h=d.amount===void 0?this.defaultValues.amount:d.amount,j=0;j<f;j++)for(var k=0;k<e;k++){var l=(j*e+k)*4,m=b.RGBtoHSV(g[l],g[l+1],g[l+2]);for(m[0]=m[0]+h;m[0]<0;)m[0]=m[0]+360;for(var m=b.HSVtoRGB(m[0],m[1],m[2]),n=0;n<3;n++)g[l+n]=m[n]}}}
function InvertFilter(){this.name="Invert";this.isDirAnimatable=true;this.defaultValues={};this.valueRanges={};this.filter=function(b){for(var c=b.width,d=b.height,b=b.data,e=0;e<d;e++)for(var f=0;f<c;f++)for(var g=(e*c+f)*4,h=0;h<3;h++)b[g+h]=255-b[g+h]}}
function KaleidoscopeFilter(){this.name="Kaleidoscope";this.isDirAnimatable=false;this.defaultValues={angle:0,rotation:0,sides:3,centerX:0.5,centerY:0.5};this.valueRanges={angle:{min:0,max:360},rotation:{min:0,max:360},sides:{min:1,max:30},centerX:{min:0,max:1},centerY:{min:0,max:1}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;var h=d.angle===void 0?this.defaultValues.angle:d.angle,j=d.rotation===void 0?this.defaultValues.rotation:
d.rotation,k=d.sides===void 0?this.defaultValues.sides:d.sides,l=e*(d.centerX===void 0?this.defaultValues.centerX:d.centerX),m=f*(d.centerY===void 0?this.defaultValues.centerY:d.centerY),h=h/180*Math.PI,j=j/180*Math.PI;b.transformFilter(g,function(c,d,e){var c=c-l,f=d-m,d=Math.sqrt(c*c+f*f),c=Math.atan2(f,c)-h-j,c=b.triangle(c/Math.PI*k*0.5),c=c+h;e[0]=l+d*Math.cos(c);e[1]=m+d*Math.sin(c)},e,f)}}
function LensDistortionFilter(){this.name="Lens Distortion";this.isDirAnimatable=false;this.defaultValues={refraction:1.5,radius:50,centerX:0.5,centerY:0.5};this.valueRanges={refraction:{min:1,max:10},radius:{min:1,max:200},centerX:{min:0,max:1},centerY:{min:0,max:1}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;var h=d.refraction===void 0?this.defaultValues.refraction:d.refraction,j=d.radius===void 0?this.defaultValues.radius:
d.radius,k=j*j,l=e*(d.centerX===void 0?this.defaultValues.centerX:d.centerX),m=f*(d.centerY===void 0?this.defaultValues.centerY:d.centerY);b.transformFilter(g,function(b,c,d){var e=b-l,f=c-m,g=e*e,j=f*f;if(j>=k-k*g/k){d[0]=b;d[1]=c}else{var u=1/h,w=Math.sqrt((1-g/k-j/k)*k),z=w*w,e=Math.acos(e/Math.sqrt(g+z)),g=Math.PI/2-e,g=Math.asin(Math.sin(g)*u),g=Math.PI/2-e-g;d[0]=b-Math.tan(g)*w;b=Math.acos(f/Math.sqrt(j+z));g=Math.PI/2-b;g=Math.asin(Math.sin(g)*u);g=Math.PI/2-b-g;d[1]=c-Math.tan(g)*w}},e,f)}}
function LineSmearFilter(){this.name="Line Smear";this.isDirAnimatable=false;this.defaultValues={distance:8,density:0.5,angle:0,mix:0.5};this.valueRanges={distance:{min:1,max:30},density:{min:0,max:1},angle:{min:0,max:360},mix:{min:0,max:1}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data,h=[],j;for(j=0;j<g.length;j++)h[j]=g[j];if(d===void 0)d=this.defaultValues;var k=d.distance===void 0?this.defaultValues.distance:d.distance;k<1&&(k=1);for(var k=parseInt(k,10),l=
d.density===void 0?this.defaultValues.density:d.density,m=d.angle===void 0?this.defaultValues.angle:d.angle,n=d.mix===void 0?this.defaultValues.mix:d.mix,m=m/180*Math.PI,q=Math.sin(m),m=Math.cos(m),l=parseInt(2*l*e*f/2,10),p=0;p<l;p++){var s=(Math.random()*Math.pow(2,32)&2147483647)%e,r=(Math.random()*Math.pow(2,32)&2147483647)%f,o=(Math.random()*Math.pow(2,32)&2147483647)%k+1,t=[g[(r*e+s)*4],g[(r*e+s)*4+1],g[(r*e+s)*4+2],g[(r*e+s)*4+3]],u=parseInt(o*m,10),o=parseInt(o*q,10),w=s-u,z=r-o,s=s+u,r=r+
o,A,C,G,H;G=s<w?-1:1;H=r<z?-1:1;var u=s-w,o=r-z,u=Math.abs(u),o=Math.abs(o),K;if(w<e&&w>=0&&z<f&&z>=0){j=[h[(z*e+w)*4],h[(z*e+w)*4+1],h[(z*e+w)*4+2],h[(z*e+w)*4+3]];K=b.mixColors(n,j,t);for(j=0;j<3;j++)h[(z*e+w)*4+j]=K[j]}if(Math.abs(u)>Math.abs(o)){A=2*o-u;C=2*o;for(u=2*(o-u);w!=s;)if(A<=0?A=A+C:(A=A+u,z=z+H),w=w+G,w<e&&w>=0&&z<f&&z>=0){j=[h[(z*e+w)*4],h[(z*e+w)*4+1],h[(z*e+w)*4+2],h[(z*e+w)*4+3]];K=b.mixColors(n,j,t);for(j=0;j<3;j++)h[(z*e+w)*4+j]=K[j]}}else{A=2*u-o;C=2*u;for(u=2*(u-o);z!=r;)if(A<=
0?A=A+C:(A=A+u,w=w+G),z=z+H,w<e&&w>=0&&z<f&&z>=0){j=[h[(z*e+w)*4],h[(z*e+w)*4+1],h[(z*e+w)*4+2],h[(z*e+w)*4+3]];K=b.mixColors(n,j,t);for(j=0;j<3;j++)h[(z*e+w)*4+j]=K[j]}}}for(j=0;j<h.length;j++)g[j]=h[j]}}
function MaximumFilter(){this.name="Maximum";this.isDirAnimatable=true;this.defaultValues={};this.valueRanges={};this.filter=function(b){for(var c=b.width,d=b.height,b=b.data,e=[],f=0;f<d;f++)for(var g=0;g<c;g++){for(var h=(f*c+g)*4,j=0,k=0,l=0,m=-1;m<=1;m++){var n=f+m;if(n>=0&&n<d)for(var q=-1;q<=1;q++){var p=g+q;p>=0&&p<c&&(p=(n*c+p)*4,j=Math.max(j,b[p]),k=Math.max(k,b[p+1]),l=Math.max(l,b[p+2]))}}e[h]=j;e[h+1]=k;e[h+2]=l;e[h+3]=b[h+3]}for(c=0;c<e.length;c++)b[c]=e[c]}}
function MedianFilter(){this.name="Median";this.isDirAnimatable=false;this.defaultValues={};this.valueRanges={};this.filter=function(b){for(var c=b.width,d=b.height,b=b.data,e=[],f=0;f<d;f++)for(var g=0;g<c;g++){for(var h=(f*c+g)*4,j=[],k=[],l=[],m=-1;m<=1;m++){var n=f+m;if(n>=0&&n<d)for(var q=-1;q<=1;q++){var p=g+q;p>=0&&p<c&&(p=(n*c+p)*4,j.push(b[p]),k.push(b[p+1]),l.push(b[p+2]))}}m=function(b,c){return b-c};j.sort(m);k.sort(m);l.sort(m);e[h]=j[4];e[h+1]=k[4];e[h+2]=l[4];e[h+3]=b[h+3]}for(c=0;c<
e.length;c++)b[c]=e[c]}}
function MinimumFilter(){this.name="Minimum";this.isDirAnimatable=true;this.defaultValues={};this.valueRanges={};this.filter=function(b){for(var c=b.width,d=b.height,b=b.data,e=[],f=0;f<d;f++)for(var g=0;g<c;g++){for(var h=(f*c+g)*4,j=255,k=255,l=255,m=-1;m<=1;m++){var n=f+m;if(n>=0&&n<d)for(var q=-1;q<=1;q++){var p=g+q;p>=0&&p<c&&(p=(n*c+p)*4,j=Math.min(j,b[p]),k=Math.min(k,b[p+1]),l=Math.min(l,b[p+2]))}}e[h]=j;e[h+1]=k;e[h+2]=l;e[h+3]=b[h+3]}for(c=0;c<e.length;c++)b[c]=e[c]}}
function NoiseFilter(){this.name="Noise";this.isDirAnimatable=true;this.defaultValues={amount:25,density:1,monochrome:true};this.valueRanges={amount:{min:0,max:100},density:{min:0,max:1},monochrome:{min:false,max:true}};this.filter=function(b,c){var d=b.width,e=b.height,f=b.data;if(c===void 0)c=this.defaultValues;for(var g=c.amount===void 0?this.defaultValues.amount:c.amount,h=c.density===void 0?this.defaultValues.density:c.density,j=c.monochrome===void 0?this.defaultValues.monochrome:c.monochrome,
k=0;k<e;k++)for(var l=0;l<d;l++){var m=(k*d+l)*4;if(Math.random()<=h){var n;if(j){n=parseInt((2*Math.random()-1)*g,10);f[m]=f[m]+n;f[m+1]=f[m+1]+n;f[m+2]=f[m+2]+n}else for(var q=0;q<3;q++){n=parseInt((2*Math.random()-1)*g,10);f[m+q]=f[m+q]+n}}}}}
function OilFilter(){this.name="Oil Painting";this.isDirAnimatable=false;this.defaultValues={range:3};this.valueRanges={range:{min:0,max:5}};this.filter=function(b,c){var d=b.width,e=b.height,f=b.data,g=[];if(c===void 0)c=this.defaultValues;for(var h=c.range===void 0?this.defaultValues.range:c.range,h=parseInt(h,10),j=[],k=[],l=[],m=[],n=[],q=[],p=0;p<e;p++)for(var s=0;s<d;s++){for(var r=(p*d+s)*4,o=0;o<256;o++)j[o]=k[o]=l[o]=m[o]=n[o]=q[o]=0;for(o=-h;o<=h;o++){var t=p+o;if(0<=t&&t<e)for(var t=t*
d,u=-h;u<=h;u++){var w=s+u;if(0<=w&&w<d){var z=f[(t+w)*4],A=f[(t+w)*4+1],w=f[(t+w)*4+2],C=z*256/256,G=A*256/256,H=w*256/256;m[C]=m[C]+z;n[G]=n[G]+A;q[H]=q[H]+w;j[C]++;k[G]++;l[H]++}}}u=t=o=0;for(z=1;z<256;z++){j[z]>j[o]&&(o=z);k[z]>k[t]&&(t=z);l[z]>l[u]&&(u=z)}o=m[o]/j[o];t=n[t]/k[t];u=q[u]/l[u];g[r]=o;g[r+1]=t;g[r+2]=u;g[r+3]=f[r+3]}for(d=0;d<g.length;d++)f[d]=g[d]}}
function OpacityFilter(){this.name="Opacity";this.isDirAnimatable=true;this.defaultValues={amount:1};this.valueRanges={amount:{min:0,max:1}};this.filter=function(b,c){var d=b.width,e=b.height,f=b.data;if(c===void 0)c=this.defaultValues;for(var g=c.amount===void 0?this.defaultValues.amount:c.amount,h=0;h<e;h++)for(var j=0;j<d;j++)f[(h*d+j)*4+3]=255*g}}
function PinchFilter(){this.name="Pinch/Whirl";this.isDirAnimatable=false;this.defaultValues={amount:0.5,radius:100,angle:0,centerX:0.5,centerY:0.5};this.valueRanges={amount:{min:-1,max:1},radius:{min:1,max:200},angle:{min:0,max:360},centerX:{min:0,max:1},centerY:{min:0,max:1}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;var h=d.amount===void 0?this.defaultValues.amount:d.amount,j=d.angle===void 0?this.defaultValues.angle:d.angle,
k=d.centerX===void 0?this.defaultValues.centerX:d.centerX,l=d.centerY===void 0?this.defaultValues.centerY:d.centerY,m=d.radius===void 0?this.defaultValues.radius:d.radius,n=m*m,j=j/180*Math.PI,q=e*k,p=f*l;b.transformFilter(g,function(b,c,d){var e=b-q,f=c-p,g=e*e+f*f;g>n||g===0?(d[0]=b,d[1]=c):(b=Math.sqrt(g/n),c=Math.pow(Math.sin(Math.PI*0.5*b),-h),e=e*c,f=f*c,b=1-b,c=j*b*b,b=Math.sin(c),c=Math.cos(c),d[0]=q+c*e-b*f,d[1]=p+b*e+c*f)},e,f)}}
function PixelationFilter(){this.name="Pixelation";this.isDirAnimatable=false;this.defaultValues={size:5};this.valueRanges={size:{min:1,max:50}};this.filter=function(b,c){var d=b.width,e=b.height,f=b.data;if(c===void 0)c=this.defaultValues;for(var g=c.size===void 0?this.defaultValues.size:c.size,g=parseInt(g,10),h,j,k,l=0;l<e;l=l+g)for(var m=0;m<d;m=m+g){var n=Math.min(g,d-m),q=Math.min(g,e-l),p=n*q,s=0,r=0,o=0;for(h=l;h<l+q;h++)for(j=m;j<m+n;j++){k=(h*d+j)*4;s=s+f[k];r=r+f[k+1];o=o+f[k+2]}for(h=
l;h<l+q;h++)for(j=m;j<m+n;j++){k=(h*d+j)*4;f[k]=s/p;f[k+1]=r/p;f[k+2]=o/p}}}}
function PosterizeFilter(){this.name="Posterize";this.isDirAnimatable=false;this.defaultValues={levels:6};this.valueRanges={levels:{min:2,max:30}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;var h=d.levels===void 0?this.defaultValues.levels:parseInt(d.levels,10);if(!(h<=1)){for(var j=[],k=0;k<256;k++)j[k]=parseInt(255*parseInt(k*h/256,10)/(h-1),10);b.tableFilter(g,j,e,f)}}}
function RGBAdjustFilter(){this.name="RGBAdjust";this.isDirAnimatable=true;this.defaultValues={red:1,green:1,blue:1};this.valueRanges={red:{min:0,max:2},green:{min:0,max:2},blue:{min:0,max:2}};this.filter=function(b,c){var d=b.width,e=b.height,f=b.data;if(c===void 0)c=this.defaultValues;var g=c.red===void 0?this.defaultValues.red:c.red,h=c.green===void 0?this.defaultValues.green:c.green,j=c.blue===void 0?this.defaultValues.blue:c.blue;g<0&&(g=0);h<0&&(h=0);j<0&&(j=0);for(var k=0;k<e;k++)for(var l=
0;l<d;l++){var m=(k*d+l)*4;f[m]=f[m]*g;f[m+1]=f[m+1]*h;f[m+2]=f[m+2]*j}}}
function SaturationFilter(){this.name="Saturation";this.isDirAnimatable=true;this.defaultValues={amount:1};this.valueRanges={amount:{min:0,max:2}};this.filter=function(b,c){var d=b.width,e=b.height,f=b.data;if(c===void 0)c=this.defaultValues;for(var g=c.amount===void 0?this.defaultValues.amount:c.amount,h=(1-g)*0.3+g,j=(1-g)*0.3,k=(1-g)*0.3,l=(1-g)*0.59,m=(1-g)*0.59+g,n=(1-g)*0.59,q=(1-g)*0.11,p=(1-g)*0.11,g=(1-g)*0.11+g,s=0;s<e;s++)for(var r=0;r<d;r++){var o=(s*d+r)*4,t=f[o],u=f[o+1],w=f[o+2];f[o]=
h*t+l*u+q*w;f[o+1]=j*t+m*u+p*w;f[o+2]=k*t+n*u+g*w}}}
function SawtoothRippleFilter(){this.name="Sawtooth Ripples";this.isDirAnimatable=false;this.defaultValues={xAmplitude:5,yAmplitude:5,xWavelength:16,yWavelength:16};this.valueRanges={xAmplitude:{min:0,max:30},yAmplitude:{min:0,max:30},xWavelength:{min:1,max:50},yWavelength:{min:1,max:50}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;var h=d.xAmplitude===void 0?this.defaultValues.xAmplitude:d.xAmplitude,j=d.yAmplitude===void 0?
this.defaultValues.yAmplitude:d.yAmplitude,k=d.xWavelength===void 0?this.defaultValues.xWavelength:d.xWavelength,l=d.yWavelength===void 0?this.defaultValues.yWavelength:d.yWavelength;b.transformFilter(g,function(c,d,e){var f=c/l,g=b.mod(d/k,1),f=b.mod(f,1);e[0]=c+h*g;e[1]=d+j*f},e,f)}}
function SepiaFilter(){this.name="Sepia";this.isDirAnimatable=true;this.defaultValues={amount:10};this.valueRanges={amount:{min:0,max:30}};new FilterUtils;this.filter=function(b,c){var d=b.width,e=b.height,f=b.data;if(c===void 0)c=this.defaultValues;for(var g=c.amount===void 0?this.defaultValues.amount:c.amount,g=g*2.55,h=0;h<e;h++)for(var j=0;j<d;j++){var k=(h*d+j)*4,l,m,n;l=m=n=f[k]*0.3+f[k+1]*0.59+f[k+2]*0.11;l=l+40;m=m+20;n=n-g;f[k]=l;f[k+1]=m;f[k+2]=n}}}
function SharpenFilter(){this.name="Sharpen";this.isDirAnimatable=true;this.defaultValues={};this.valueRanges={};var b=new FilterUtils;this.filter=function(c){b.convolveFilter(c.data,[0,-0.2,0,-0.2,1.8,-0.2,0,-0.2,0],c.width,c.height)}}
function SineRippleFilter(){this.name="Sine Ripples";this.isDirAnimatable=false;this.defaultValues={xAmplitude:5,yAmplitude:5,xWavelength:16,yWavelength:16};this.valueRanges={xAmplitude:{min:0,max:30},yAmplitude:{min:0,max:30},xWavelength:{min:1,max:50},yWavelength:{min:1,max:50}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;var h=d.xAmplitude===void 0?this.defaultValues.xAmplitude:d.xAmplitude,j=d.yAmplitude===void 0?this.defaultValues.yAmplitude:
d.yAmplitude,k=d.xWavelength===void 0?this.defaultValues.xWavelength:d.xWavelength,l=d.yWavelength===void 0?this.defaultValues.yWavelength:d.yWavelength;b.transformFilter(g,function(b,c,d){var e=Math.sin(b/l);d[0]=b+h*Math.sin(c/k);d[1]=c+j*e},e,f)}}
function SolarizeFilter(){this.name="Solarize";this.isDirAnimatable=true;this.defaultValues={};this.valueRanges={};var b=new FilterUtils;this.filter=function(c){for(var d=c.width,e=c.height,c=c.data,f=[],g=0;g<256;g++)f[g]=parseInt(255*(g/255>0.5?2*(g/255-0.5):2*(0.5-g/255)),10);b.tableFilter(c,f,d,e)}}
function SparkleFilter(){this.name="Sparkle";this.isDirAnimatable=false;this.defaultValues={rays:50,size:25,amount:50,randomness:25,centerX:0.5,centerY:0.5};this.valueRanges={rays:{min:1,max:100},size:{min:1,max:200},amount:{min:0,max:100},randomness:{min:0,max:50},centerX:{min:0,max:1},centerY:{min:0,max:1}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;for(var h=d.rays===void 0?this.defaultValues.rays:d.rays,h=parseInt(h,10),
j=d.size===void 0?this.defaultValues.size:d.size,k=d.amount===void 0?this.defaultValues.amount:d.amount,l=d.randomness===void 0?this.defaultValues.randomness:d.randomness,m=(d.centerX===void 0?this.defaultValues.centerX:d.centerX)*e,n=(d.centerY===void 0?this.defaultValues.centerY:d.centerY)*f,q=[],p=0;p<h;p++)q[p]=j+l/100*j*b.gaussianRandom();for(l=0;l<f;l++)for(p=0;p<e;p++){var s=(l*e+p)*4,r=p-m,o=l-n,t=r*r+o*o,r=(Math.atan2(o,r)+Math.PI)/(Math.PI*2)*h,o=parseInt(r,10),r=r-o;j!==0&&(o=b.linearInterpolate(r,
q[o%h],q[(o+1)%h]),t=o*o/(t+1.0E-4),t=Math.pow(t,(100-k)/50),r=r-0.5,r=1-r*r,r=r*t);r=b.clampPixel(r,0,1);t=b.mixColors(r,[g[s],g[s+1],g[s+2],g[s+3]],[255,255,255,255]);for(r=0;r<3;r++)g[s+r]=t[r]}}}
function SquareSmearFilter(){this.name="Square Smear";this.isDirAnimatable=false;this.defaultValues={size:4,density:0.5,mix:0.5};this.valueRanges={size:{min:1,max:10},density:{min:0,max:1},mix:{min:0,max:1}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data,h=[],j;for(j=0;j<g.length;j++)h[j]=g[j];if(d===void 0)d=this.defaultValues;j=d.size===void 0?this.defaultValues.size:d.size;j<1&&(j=1);j=parseInt(j,10);for(var k=d.mix===void 0?this.defaultValues.mix:d.mix,l=j+1,
m=parseInt(2*(d.density===void 0?this.defaultValues.density:d.density)/30*e*f/2,10),n=0;n<m;n++)for(var q=(Math.random()*Math.pow(2,32)&2147483647)%e,p=(Math.random()*Math.pow(2,32)&2147483647)%f,s=[g[(p*e+q)*4],g[(p*e+q)*4+1],g[(p*e+q)*4+2],g[(p*e+q)*4+3]],r=q-l;r<q+l+1;r++)for(var o=p-l;o<p+l+1;o++)if(r>=0&&r<e&&o>=0&&o<f){var t=b.mixColors(k,[h[(o*e+r)*4],h[(o*e+r)*4+1],h[(o*e+r)*4+2],h[(o*e+r)*4+3]],s);for(j=0;j<3;j++)h[(o*e+r)*4+j]=t[j]}for(j=0;j<h.length;j++)g[j]=h[j]}}
function ThresholdFilter(){this.name="Black & White";this.isDirAnimatable=true;this.defaultValues={threshold:127};this.valueRanges={threshold:{min:0,max:255}};this.filter=function(b,c){var d=b.width,e=b.height,f=b.data;if(c===void 0)c=this.defaultValues;for(var g=c.threshold===void 0?this.defaultValues.threshold:c.threshold,h=0;h<e;h++)for(var j=0;j<d;j++){var k=(h*d+j)*4,l=0;(f[k]+f[k+1]+f[k+2])/3>g&&(l=255);f[k]=f[k+1]=f[k+2]=l}}}
function TriangleRippleFilter(){this.name="Triangle Ripples";this.isDirAnimatable=false;this.defaultValues={xAmplitude:5,yAmplitude:5,xWavelength:16,yWavelength:16};this.valueRanges={xAmplitude:{min:0,max:30},yAmplitude:{min:0,max:30},xWavelength:{min:1,max:50},yWavelength:{min:1,max:50}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;var h=d.xAmplitude===void 0?this.defaultValues.xAmplitude:d.xAmplitude,j=d.yAmplitude===void 0?
this.defaultValues.yAmplitude:d.yAmplitude,k=d.xWavelength===void 0?this.defaultValues.xWavelength:d.xWavelength,l=d.yWavelength===void 0?this.defaultValues.yWavelength:d.yWavelength;b.transformFilter(g,function(c,d,e){var f=c/l,g=b.triangle(d/k,1),f=b.triangle(f,1);e[0]=c+h*g;e[1]=d+j*f},e,f)}}
function TwirlFilter(){this.name="Twirl";this.isDirAnimatable=false;this.defaultValues={radius:100,angle:180,centerX:0.5,centerY:0.5};this.valueRanges={radius:{min:1,max:200},angle:{min:0,max:360},centerX:{min:0,max:1},centerY:{min:0,max:1}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;var h=d.angle===void 0?this.defaultValues.angle:d.angle,j=d.centerX===void 0?this.defaultValues.centerX:d.centerX,k=d.centerY===void 0?this.defaultValues.centerY:
d.centerY,l=d.radius===void 0?this.defaultValues.radius:d.radius,m=l*l,h=h/180*Math.PI,n=e*j,q=f*k;b.transformFilter(g,function(b,c,d){var e=b-n,f=c-q,g=e*e+f*f;g>m?(d[0]=b,d[1]=c):(g=Math.sqrt(g),b=Math.atan2(f,e)+h*(l-g)/l,d[0]=n+g*Math.cos(b),d[1]=q+g*Math.sin(b))},e,f)}}
function VignetteFilter(){this.name="Vignette";this.isDirAnimatable=false;this.defaultValues={amount:0.3};this.valueRanges={amount:{min:0,max:1}};this.filter=function(b,c){var d=b.width,e=b.height,f=b.data,g=[];if(c===void 0)c=this.defaultValues;var g=c.amount===void 0?this.defaultValues.amount:c.amount,h=document.createElement("canvas");h.width=d;h.height=e;var h=h.getContext("2d"),j;j=Math.sqrt(Math.pow(d/2,2)+Math.pow(e/2,2));h.putImageData(b,0,0);h.globalCompositeOperation="source-over";j=h.createRadialGradient(d/
2,e/2,0,d/2,e/2,j);j.addColorStop(0,"rgba(0,0,0,0)");j.addColorStop(0.5,"rgba(0,0,0,0)");j.addColorStop(1,"rgba(0,0,0,"+g+")");h.fillStyle=j;h.fillRect(0,0,d,e);g=h.getImageData(0,0,d,e).data;for(d=0;d<g.length;d++)f[d]=g[d]}}
function WaterRippleFilter(){this.name="Water Ripples";this.isDirAnimatable=false;this.defaultValues={phase:0,radius:50,wavelength:16,amplitude:10,centerX:0.5,centerY:0.5};this.valueRanges={phase:{min:0,max:100},radius:{min:1,max:200},wavelength:{min:1,max:100},amplitude:{min:1,max:100},centerX:{min:0,max:1},centerY:{min:0,max:1}};var b=new FilterUtils;this.filter=function(c,d){var e=c.width,f=c.height,g=c.data;if(d===void 0)d=this.defaultValues;var h=d.wavelength===void 0?this.defaultValues.wavelength:
d.wavelength,j=d.amplitude===void 0?this.defaultValues.amplitude:d.amplitude,k=d.phase===void 0?this.defaultValues.phase:d.phase,l=d.radius===void 0?this.defaultValues.radius:d.radius,m=l*l,n=e*(d.centerX===void 0?this.defaultValues.centerX:d.centerX),q=f*(d.centerY===void 0?this.defaultValues.centerY:d.centerY);b.transformFilter(g,function(b,c,d){var e=b-n,f=c-q,g=e*e+f*f;if(g>m){d[0]=b;d[1]=c}else{var g=Math.sqrt(g),w=j*Math.sin(g/h*Math.PI*2-k),w=w*((l-g)/l);g!==0&&(w=w*(h/g));d[0]=b+e*w;d[1]=
c+f*w}},e,f)}}
var JSManipulate={blur:new BlurFilter,brightness:new BrightnessFilter,bump:new BumpFilter,circlesmear:new CircleSmearFilter,contrast:new ContrastFilter,crosssmear:new CrossSmearFilter,diffusion:new DiffusionFilter,dither:new DitherFilter,edge:new EdgeFilter,emboss:new EmbossFilter,exposure:new ExposureFilter,gain:new GainFilter,gamma:new GammaFilter,grayscale:new GrayscaleFilter,hue:new HueFilter,invert:new InvertFilter,kaleidoscope:new KaleidoscopeFilter,lensdistortion:new LensDistortionFilter,linesmear:new LineSmearFilter,
maximum:new MaximumFilter,median:new MedianFilter,minimum:new MinimumFilter,noise:new NoiseFilter,oil:new OilFilter,opacity:new OpacityFilter,pinch:new PinchFilter,pixelate:new PixelationFilter,posterize:new PosterizeFilter,rgbadjust:new RGBAdjustFilter,saturation:new SaturationFilter,sawtoothripple:new SawtoothRippleFilter,sepia:new SepiaFilter,sharpen:new SharpenFilter,sineripple:new SineRippleFilter,solarize:new SolarizeFilter,sparkle:new SparkleFilter,squaresmear:new SquareSmearFilter,threshold:new ThresholdFilter,
triangleripple:new TriangleRippleFilter,twirl:new TwirlFilter,vignette:new VignetteFilter,waterripple:new WaterRippleFilter};
(function(b){function c(b){this.ok=false;b.charAt(0)=="#"&&(b=b.substr(1,6));var b=b.replace(/ /g,""),b=b.toLowerCase(),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",
darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",
gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",
lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",
oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",
slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},f;for(f in e)b==f&&(b=e[f]);var g=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(b){return[parseInt(b[1]),parseInt(b[2]),parseInt(b[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,
example:["#00ff00","336699"],process:function(b){return[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(b){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]}}];for(f=0;f<g.length;f++){var h=g[f].process,j=g[f].re.exec(b);if(j){channels=h(j);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r;this.g=this.g<0||isNaN(this.g)?
0:this.g>255?255:this.g;this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b;this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var b=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);b.length==1&&(b="0"+b);c.length==1&&(c="0"+c);d.length==1&&(d="0"+d);return"#"+b+c+d};this.getHelpXML=function(){for(var b=[],d=0;d<g.length;d++)for(var f=g[d].example,h=0;h<f.length;h++)b[b.length]=f[h];for(var j in e)b[b.length]=j;f=document.createElement("ul");
f.setAttribute("id","rgbcolor-examples");for(d=0;d<b.length;d++)try{var p=document.createElement("li"),s=new c(b[d]),r=document.createElement("div");r.style.cssText="margin: 3px; border: 1px solid black; background:"+s.toHex()+"; color:"+s.toHex();r.appendChild(document.createTextNode("test"));var o=document.createTextNode(" "+b[d]+" -> "+s.toRGB()+" -> "+s.toHex());p.appendChild(r);p.appendChild(o);f.appendChild(p)}catch(t){}return f}}if(typeof define!=="undefined"&&define.amd)define(function(){return c});
else if(typeof module!=="undefined"&&module.exports)module.exports=c;b.RGBColor=c})("undefined"!==typeof window?window:this);
(function(b,c){if(typeof define!=="undefined"&&define.amd)define("canvgModule",["rgbcolor","stackblur"],c);else if(typeof module!=="undefined"&&module.exports)module.exports=c(require("rgbcolor"),require("stackblur"));b.canvg=c(b.RGBColor,b.stackBlur)})("undefined"!==typeof window?window:this,function(b,c){function d(b){var c=[0,0,0],d=function(d,e){var f=b.match(d);if(f!=null){c[e]=c[e]+f.length;b=b.replace(d," ")}},b=b.replace(/:not\(([^\)]*)\)/g,"     $1 "),b=b.replace(/{[\s\S]*/gm," ");d(h,1);
d(j,0);d(k,1);d(l,2);d(m,1);d(n,1);b=b.replace(/[\*\s\+>~]/g," ");b=b.replace(/[#\.]/g," ");d(q,2);return c.join("")}function e(e){var f={opts:e,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3E4,log:function(){}};if(f.opts.log==true&&typeof console!="undefined")f.log=function(b){console.log(b)};f.init=function(b){var c=0;f.UniqueId=function(){c++;return"canvg"+c};f.Definitions={};f.Styles={};f.StylesSpecificity={};f.Animations=[];f.Images=[];f.ctx=b;f.ViewPort=new function(){this.viewPorts=[];this.Clear=function(){this.viewPorts=
[]};this.SetCurrent=function(b,c){this.viewPorts.push({width:b,height:c})};this.RemoveCurrent=function(){this.viewPorts.pop()};this.Current=function(){return this.viewPorts[this.viewPorts.length-1]};this.width=function(){return this.Current().width};this.height=function(){return this.Current().height};this.ComputeSize=function(b){return b!=null&&typeof b=="number"?b:b=="x"?this.width():b=="y"?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}};f.init();f.ImagesLoaded=
function(){for(var b=0;b<f.Images.length;b++)if(!f.Images[b].loaded)return false;return true};f.trim=function(b){return b.replace(/^\s+|\s+$/g,"")};f.compressSpaces=function(b){return b.replace(/[\s\r\t\n]+/gm," ")};f.ajax=function(b){var c;if(c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")){c.open("GET",b,false);c.send(null);return c.responseText}return null};f.parseXml=function(b){if(typeof Windows!="undefined"&&typeof Windows.Data!="undefined"&&typeof Windows.Data.Xml!=
"undefined"){var c=new Windows.Data.Xml.Dom.XmlDocument,d=new Windows.Data.Xml.Dom.XmlLoadSettings;d.prohibitDtd=false;c.loadXml(b,d);return c}if(window.DOMParser)return(new DOMParser).parseFromString(b,"text/xml");b=b.replace(/<!DOCTYPE svg[^>]*>/,"");c=new ActiveXObject("Microsoft.XMLDOM");c.async="false";c.loadXML(b);return c};f.Property=function(b,c){this.name=b;this.value=c};f.Property.prototype.getValue=function(){return this.value};f.Property.prototype.hasValue=function(){return this.value!=
null&&this.value!==""};f.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var b=parseFloat(this.value);(this.value+"").match(/%$/)&&(b=b/100);return b};f.Property.prototype.valueOrDefault=function(b){return this.hasValue()?this.value:b};f.Property.prototype.numValueOrDefault=function(b){return this.hasValue()?this.numValue():b};f.Property.prototype.addOpacity=function(c){var d=this.value;if(c.value!=null&&c.value!=""&&typeof this.value=="string"){var e=new b(this.value);e.ok&&(d=
"rgba("+e.r+", "+e.g+", "+e.b+", "+c.numValue()+")")}return new f.Property(this.name,d)};f.Property.prototype.getDefinition=function(){var b=this.value.match(/#([^\)'"]+)/);b&&(b=b[1]);if(!b)b=this.value;return f.Definitions[b]};f.Property.prototype.isUrlDefinition=function(){return this.value.indexOf("url(")==0};f.Property.prototype.getFillStyleDefinition=function(b,c){var d=this.getDefinition();if(d!=null&&d.createGradient)return d.createGradient(f.ctx,b,c);if(d!=null&&d.createPattern){if(d.getHrefAttribute().hasValue()){var e=
d.attribute("patternTransform"),d=d.getHrefAttribute().getDefinition();if(e.hasValue())d.attribute("patternTransform",true).value=e.value}return d.createPattern(f.ctx,b)}return null};f.Property.prototype.getDPI=function(){return 96};f.Property.prototype.getEM=function(b){var c=12,d=new f.Property("fontSize",f.Font.Parse(f.ctx.font).fontSize);d.hasValue()&&(c=d.toPixels(b));return c};f.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")};f.Property.prototype.toPixels=
function(b,c){if(!this.hasValue())return 0;var d=this.value+"";if(d.match(/em$/))return this.numValue()*this.getEM(b);if(d.match(/ex$/))return this.numValue()*this.getEM(b)/2;if(d.match(/px$/))return this.numValue();if(d.match(/pt$/))return this.numValue()*this.getDPI(b)*(1/72);if(d.match(/pc$/))return this.numValue()*15;if(d.match(/cm$/))return this.numValue()*this.getDPI(b)/2.54;if(d.match(/mm$/))return this.numValue()*this.getDPI(b)/25.4;if(d.match(/in$/))return this.numValue()*this.getDPI(b);
if(d.match(/%$/))return this.numValue()*f.ViewPort.ComputeSize(b);d=this.numValue();return c&&d<1?d*f.ViewPort.ComputeSize(b):d};f.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var b=this.value+"";if(b.match(/s$/))return this.numValue()*1E3;b.match(/ms$/);return this.numValue()};f.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var b=this.value+"";return b.match(/deg$/)?this.numValue()*(Math.PI/180):b.match(/grad$/)?this.numValue()*(Math.PI/200):b.match(/rad$/)?
this.numValue():this.numValue()*(Math.PI/180)};var h={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};f.Property.prototype.toTextBaseline=function(){return!this.hasValue()?null:h[this.value]};f.Font=new function(){this.Styles="normal|italic|oblique|inherit";this.Variants="normal|small-caps|inherit";this.Weights=
"normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";this.CreateFont=function(b,c,d,e,g,h){h=h!=null?this.Parse(h):this.CreateFont("","","","","",f.ctx.font);return{fontFamily:g||h.fontFamily,fontSize:e||h.fontSize,fontStyle:b||h.fontStyle,fontWeight:d||h.fontWeight,fontVariant:c||h.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var b=this;this.Parse=function(c){for(var d={},c=f.trim(f.compressSpaces(c||
"")).split(" "),e=false,g=false,h=false,j=false,k="",l=0;l<c.length;l++)if(!g&&b.Styles.indexOf(c[l])!=-1){if(c[l]!="inherit")d.fontStyle=c[l];g=true}else if(!j&&b.Variants.indexOf(c[l])!=-1){if(c[l]!="inherit")d.fontVariant=c[l];g=j=true}else if(!h&&b.Weights.indexOf(c[l])!=-1){if(c[l]!="inherit")d.fontWeight=c[l];g=j=h=true}else if(e)c[l]!="inherit"&&(k=k+c[l]);else{if(c[l]!="inherit")d.fontSize=c[l].split("/")[0];g=j=h=e=true}if(k!="")d.fontFamily=k;return d}};f.ToNumberArray=function(b){for(var b=
f.trim(f.compressSpaces((b||"").replace(/,/g," "))).split(" "),c=0;c<b.length;c++)b[c]=parseFloat(b[c]);return b};f.Point=function(b,c){this.x=b;this.y=c};f.Point.prototype.angleTo=function(b){return Math.atan2(b.y-this.y,b.x-this.x)};f.Point.prototype.applyTransform=function(b){var c=this.x*b[1]+this.y*b[3]+b[5];this.x=this.x*b[0]+this.y*b[2]+b[4];this.y=c};f.CreatePoint=function(b){b=f.ToNumberArray(b);return new f.Point(b[0],b[1])};f.CreatePath=function(b){for(var b=f.ToNumberArray(b),c=[],d=0;d<
b.length;d=d+2)c.push(new f.Point(b[d],b[d+1]));return c};f.BoundingBox=function(b,c,d,e){this.y2=this.x2=this.y1=this.x1=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(b,c){if(b!=null){if(isNaN(this.x1)||isNaN(this.x2))this.x2=this.x1=b;if(b<this.x1)this.x1=b;if(b>this.x2)this.x2=b}if(c!=null){if(isNaN(this.y1)||isNaN(this.y2))this.y2=this.y1=c;if(c<
this.y1)this.y1=c;if(c>this.y2)this.y2=c}};this.addX=function(b){this.addPoint(b,null)};this.addY=function(b){this.addPoint(null,b)};this.addBoundingBox=function(b){this.addPoint(b.x1,b.y1);this.addPoint(b.x2,b.y2)};this.addQuadraticCurve=function(b,c,d,e,f,g){d=b+2/3*(d-b);e=c+2/3*(e-c);this.addBezierCurve(b,c,d,d+1/3*(f-b),e,e+1/3*(g-c),f,g)};this.addBezierCurve=function(b,c,d,e,f,g,h,j){var k=[b,c],l=[d,e],m=[f,g],n=[h,j];this.addPoint(k[0],k[1]);this.addPoint(n[0],n[1]);for(i=0;i<=1;i++){b=function(b){return Math.pow(1-
b,3)*k[i]+3*Math.pow(1-b,2)*b*l[i]+3*(1-b)*Math.pow(b,2)*m[i]+Math.pow(b,3)*n[i]};c=6*k[i]-12*l[i]+6*m[i];d=-3*k[i]+9*l[i]-9*m[i]+3*n[i];e=3*l[i]-3*k[i];if(d==0){if(c!=0){c=-e/c;if(0<c&&c<1){i==0&&this.addX(b(c));i==1&&this.addY(b(c))}}}else{e=Math.pow(c,2)-4*e*d;if(!(e<0)){f=(-c+Math.sqrt(e))/(2*d);if(0<f&&f<1){i==0&&this.addX(b(f));i==1&&this.addY(b(f))}c=(-c-Math.sqrt(e))/(2*d);if(0<c&&c<1){i==0&&this.addX(b(c));i==1&&this.addY(b(c))}}}}};this.isPointInBox=function(b,c){return this.x1<=b&&b<=this.x2&&
this.y1<=c&&c<=this.y2};this.addPoint(b,c);this.addPoint(d,e)};f.Transform=function(b){var c=this;this.Type={};this.Type.translate=function(b){this.p=f.CreatePoint(b);this.apply=function(b){b.translate(this.p.x||0,this.p.y||0)};this.unapply=function(b){b.translate(-1*this.p.x||0,-1*this.p.y||0)};this.applyToPoint=function(b){b.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}};this.Type.rotate=function(b){b=f.ToNumberArray(b);this.angle=new f.Property("angle",b[0]);this.cx=b[1]||0;this.cy=b[2]||
0;this.apply=function(b){b.translate(this.cx,this.cy);b.rotate(this.angle.toRadians());b.translate(-this.cx,-this.cy)};this.unapply=function(b){b.translate(this.cx,this.cy);b.rotate(-1*this.angle.toRadians());b.translate(-this.cx,-this.cy)};this.applyToPoint=function(b){var c=this.angle.toRadians();b.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]);b.applyTransform([Math.cos(c),Math.sin(c),-Math.sin(c),Math.cos(c),0,0]);b.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}};this.Type.scale=function(b){this.p=
f.CreatePoint(b);this.apply=function(b){b.scale(this.p.x||1,this.p.y||this.p.x||1)};this.unapply=function(b){b.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)};this.applyToPoint=function(b){b.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}};this.Type.matrix=function(b){this.m=f.ToNumberArray(b);this.apply=function(b){b.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])};this.unapply=function(b){var c=this.m[0],d=this.m[2],e=this.m[4],f=this.m[1],g=this.m[3],h=this.m[5],j=1/(c*
(g*1-h*0)-d*(f*1-h*0)+e*(f*0-g*0));b.transform(j*(g*1-h*0),j*(h*0-f*1),j*(e*0-d*1),j*(c*1-e*0),j*(d*h-e*g),j*(e*f-c*h))};this.applyToPoint=function(b){b.applyTransform(this.m)}};this.Type.SkewBase=function(b){this.base=c.Type.matrix;this.base(b);this.angle=new f.Property("angle",b)};this.Type.SkewBase.prototype=new this.Type.matrix;this.Type.skewX=function(b){this.base=c.Type.SkewBase;this.base(b);this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]};this.Type.skewX.prototype=new this.Type.SkewBase;
this.Type.skewY=function(b){this.base=c.Type.SkewBase;this.base(b);this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]};this.Type.skewY.prototype=new this.Type.SkewBase;this.transforms=[];this.apply=function(b){for(var c=0;c<this.transforms.length;c++)this.transforms[c].apply(b)};this.unapply=function(b){for(var c=this.transforms.length-1;c>=0;c--)this.transforms[c].unapply(b)};this.applyToPoint=function(b){for(var c=0;c<this.transforms.length;c++)this.transforms[c].applyToPoint(b)};for(var b=f.trim(f.compressSpaces(b)).replace(/\)([a-zA-Z])/g,
") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),d=0;d<b.length;d++){var e=f.trim(b[d].split("(")[0]),g=b[d].split("(")[1].replace(")",""),h=this.Type[e];if(typeof h!="undefined"){g=new h(g);g.type=e;this.transforms.push(g)}}};f.AspectRatio=function(b,c,d,e,g,h,j,k,l,m){var c=f.compressSpaces(c),c=c.replace(/^defer\s/,""),n=c.split(" ")[0]||"xMidYMid",c=c.split(" ")[1]||"meet",p=d/e,q=g/h,r=Math.min(p,q),I=Math.max(p,q);if(c=="meet"){e=e*r;h=h*r}if(c=="slice"){e=e*I;h=h*I}l=new f.Property("refX",
l);m=new f.Property("refY",m);if(l.hasValue()&&m.hasValue())b.translate(-r*l.toPixels("x"),-r*m.toPixels("y"));else{n.match(/^xMid/)&&(c=="meet"&&r==q||c=="slice"&&I==q)&&b.translate(d/2-e/2,0);n.match(/YMid$/)&&(c=="meet"&&r==p||c=="slice"&&I==p)&&b.translate(0,g/2-h/2);n.match(/^xMax/)&&(c=="meet"&&r==q||c=="slice"&&I==q)&&b.translate(d-e,0);n.match(/YMax$/)&&(c=="meet"&&r==p||c=="slice"&&I==p)&&b.translate(0,g-h)}n=="none"?b.scale(p,q):c=="meet"?b.scale(r,r):c=="slice"&&b.scale(I,I);b.translate(j==
null?0:-j,k==null?0:-k)};f.Element={};f.EmptyProperty=new f.Property("EMPTY","");f.Element.ElementBase=function(b){this.attributes={};this.styles={};this.stylesSpecificity={};this.children=[];this.attribute=function(b,c){var d=this.attributes[b];if(d!=null)return d;if(c==true){d=new f.Property(b,"");this.attributes[b]=d}return d||f.EmptyProperty};this.getHrefAttribute=function(){for(var b in this.attributes)if(b=="href"||b.match(/:href$/))return this.attributes[b];return f.EmptyProperty};this.style=
function(b,c,d){var e=this.styles[b];if(e!=null)return e;var g=this.attribute(b);if(g!=null&&g.hasValue())return this.styles[b]=g;if(d!=true){d=this.parent;if(d!=null){d=d.style(b);if(d!=null&&d.hasValue())return d}}if(c==true){e=new f.Property(b,"");this.styles[b]=e}return e||f.EmptyProperty};this.render=function(b){if(this.style("display").value!="none"&&this.style("visibility").value!="hidden"){b.save();if(this.style("mask").hasValue()){var c=this.style("mask").getDefinition();c!=null&&c.apply(b,
this)}else if(this.style("filter").hasValue()){c=this.style("filter").getDefinition();c!=null&&c.apply(b,this)}else{this.setContext(b);this.renderChildren(b);this.clearContext(b)}b.restore()}};this.setContext=function(){};this.clearContext=function(){};this.renderChildren=function(b){for(var c=0;c<this.children.length;c++)this.children[c].render(b)};this.addChild=function(b,c){var d=b;c&&(d=f.CreateElement(b));d.parent=this;d.type!="title"&&this.children.push(d)};this.addStylesFromStyleDefinition=
function(){for(var c in f.Styles)if(c[0]!="@"&&g(b,c)){var d=f.Styles[c],e=f.StylesSpecificity[c];if(d!=null)for(var h in d){var j=this.stylesSpecificity[h];typeof j=="undefined"&&(j="000");if(e>j){this.styles[h]=d[h];this.stylesSpecificity[h]=e}}}};var c=/^[A-Z-]+$/;if(b!=null&&b.nodeType==1){for(var d=0;d<b.attributes.length;d++){var e=b.attributes[d],h=c.test(e.nodeName)?e.nodeName.toLowerCase():e.nodeName;this.attributes[h]=new f.Property(h,e.value)}this.addStylesFromStyleDefinition();if(this.attribute("style").hasValue()){c=
this.attribute("style").value.split(";");for(d=0;d<c.length;d++)if(f.trim(c[d])!=""){h=c[d].split(":");e=f.trim(h[0]);h=f.trim(h[1]);this.styles[e]=new f.Property(e,h)}}this.attribute("id").hasValue()&&f.Definitions[this.attribute("id").value]==null&&(f.Definitions[this.attribute("id").value]=this);for(d=0;d<b.childNodes.length;d++){c=b.childNodes[d];c.nodeType==1&&this.addChild(c,true);if(this.captureTextNodes&&(c.nodeType==3||c.nodeType==4))f.compressSpaces(c.value||c.text||c.textContent||"")!=
""&&this.addChild(new f.Element.tspan(c),false)}}};f.Element.RenderedElementBase=function(b){this.base=f.Element.ElementBase;this.base(b);this.setContext=function(b){if(this.style("fill").isUrlDefinition()){var c=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));if(c!=null)b.fillStyle=c}else if(this.style("fill").hasValue()){c=this.style("fill");if(c.value=="currentColor")c.value=this.style("color").value;if(c.value!="inherit")b.fillStyle=c.value=="none"?"rgba(0,0,0,0)":c.value}if(this.style("fill-opacity").hasValue()){c=
new f.Property("fill",b.fillStyle);c=c.addOpacity(this.style("fill-opacity"));b.fillStyle=c.value}if(this.style("stroke").isUrlDefinition()){c=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));if(c!=null)b.strokeStyle=c}else if(this.style("stroke").hasValue()){c=this.style("stroke");if(c.value=="currentColor")c.value=this.style("color").value;if(c.value!="inherit")b.strokeStyle=c.value=="none"?"rgba(0,0,0,0)":c.value}if(this.style("stroke-opacity").hasValue()){c=new f.Property("stroke",
b.strokeStyle);c=c.addOpacity(this.style("stroke-opacity"));b.strokeStyle=c.value}if(this.style("stroke-width").hasValue()){c=this.style("stroke-width").toPixels();b.lineWidth=c==0?0.001:c}if(this.style("stroke-linecap").hasValue())b.lineCap=this.style("stroke-linecap").value;if(this.style("stroke-linejoin").hasValue())b.lineJoin=this.style("stroke-linejoin").value;if(this.style("stroke-miterlimit").hasValue())b.miterLimit=this.style("stroke-miterlimit").value;if(this.style("stroke-dasharray").hasValue()&&
this.style("stroke-dasharray").value!="none"){c=f.ToNumberArray(this.style("stroke-dasharray").value);if(typeof b.setLineDash!="undefined")b.setLineDash(c);else if(typeof b.webkitLineDash!="undefined")b.webkitLineDash=c;else if(typeof b.mozDash!="undefined"&&!(c.length==1&&c[0]==0))b.mozDash=c;c=this.style("stroke-dashoffset").numValueOrDefault(1);if(typeof b.lineDashOffset!="undefined")b.lineDashOffset=c;else if(typeof b.webkitLineDashOffset!="undefined")b.webkitLineDashOffset=c;else if(typeof b.mozDashOffset!=
"undefined")b.mozDashOffset=c}if(typeof b.font!="undefined")b.font=f.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString();this.style("transform",false,true).hasValue()&&(new f.Transform(this.style("transform",false,true).value)).apply(b);if(this.style("clip-path",false,true).hasValue()){c=this.style("clip-path",false,true).getDefinition();
c!=null&&c.apply(b)}if(this.style("opacity").hasValue())b.globalAlpha=this.style("opacity").numValue()}};f.Element.RenderedElementBase.prototype=new f.Element.ElementBase;f.Element.PathElementBase=function(b){this.base=f.Element.RenderedElementBase;this.base(b);this.path=function(b){b!=null&&b.beginPath();return new f.BoundingBox};this.renderChildren=function(b){this.path(b);f.Mouse.checkPath(this,b);b.fillStyle!=""&&(this.style("fill-rule").valueOrDefault("inherit")!="inherit"?b.fill(this.style("fill-rule").value):
b.fill());b.strokeStyle!=""&&b.stroke();var c=this.getMarkers();if(c!=null){if(this.style("marker-start").isUrlDefinition()){var d=this.style("marker-start").getDefinition();d.render(b,c[0][0],c[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var d=this.style("marker-mid").getDefinition(),e=1;e<c.length-1;e++)d.render(b,c[e][0],c[e][1]);if(this.style("marker-end").isUrlDefinition()){d=this.style("marker-end").getDefinition();d.render(b,c[c.length-1][0],c[c.length-1][1])}}};this.getBoundingBox=
function(){return this.path()};this.getMarkers=function(){return null}};f.Element.PathElementBase.prototype=new f.Element.RenderedElementBase;f.Element.svg=function(b){this.base=f.Element.RenderedElementBase;this.base(b);this.baseClearContext=this.clearContext;this.clearContext=function(b){this.baseClearContext(b);f.ViewPort.RemoveCurrent()};this.baseSetContext=this.setContext;this.setContext=function(b){b.strokeStyle="rgba(0,0,0,0)";b.lineCap="butt";b.lineJoin="miter";b.miterLimit=4;if(typeof b.font!=
"undefined"&&typeof window.getComputedStyle!="undefined")b.font=window.getComputedStyle(b.canvas).getPropertyValue("font");this.baseSetContext(b);if(!this.attribute("x").hasValue())this.attribute("x",true).value=0;if(!this.attribute("y").hasValue())this.attribute("y",true).value=0;b.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var c=f.ViewPort.width(),d=f.ViewPort.height();if(!this.attribute("width").hasValue())this.attribute("width",true).value="100%";if(!this.attribute("height").hasValue())this.attribute("height",
true).value="100%";if(typeof this.root=="undefined"){var c=this.attribute("width").toPixels("x"),d=this.attribute("height").toPixels("y"),e=0,g=0;if(this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()){e=-this.attribute("refX").toPixels("x");g=-this.attribute("refY").toPixels("y")}if(this.attribute("overflow").valueOrDefault("hidden")!="visible"){b.beginPath();b.moveTo(e,g);b.lineTo(c,g);b.lineTo(c,d);b.lineTo(e,d);b.closePath();b.clip()}}f.ViewPort.SetCurrent(c,d);if(this.attribute("viewBox").hasValue()){var e=
f.ToNumberArray(this.attribute("viewBox").value),g=e[0],h=e[1],c=e[2],d=e[3];f.AspectRatio(b,this.attribute("preserveAspectRatio").value,f.ViewPort.width(),c,f.ViewPort.height(),d,g,h,this.attribute("refX").value,this.attribute("refY").value);f.ViewPort.RemoveCurrent();f.ViewPort.SetCurrent(e[2],e[3])}}};f.Element.svg.prototype=new f.Element.RenderedElementBase;f.Element.rect=function(b){this.base=f.Element.PathElementBase;this.base(b);this.path=function(b){var c=this.attribute("x").toPixels("x"),
d=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y"),h=this.attribute("rx").toPixels("x"),j=this.attribute("ry").toPixels("y");this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(j=h);this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(h=j);h=Math.min(h,e/2);j=Math.min(j,g/2);if(b!=null){b.beginPath();b.moveTo(c+h,d);b.lineTo(c+e-h,d);b.quadraticCurveTo(c+e,d,c+e,d+j);b.lineTo(c+e,d+g-j);b.quadraticCurveTo(c+
e,d+g,c+e-h,d+g);b.lineTo(c+h,d+g);b.quadraticCurveTo(c,d+g,c,d+g-j);b.lineTo(c,d+j);b.quadraticCurveTo(c,d,c+h,d);b.closePath()}return new f.BoundingBox(c,d,c+e,d+g)}};f.Element.rect.prototype=new f.Element.PathElementBase;f.Element.circle=function(b){this.base=f.Element.PathElementBase;this.base(b);this.path=function(b){var c=this.attribute("cx").toPixels("x"),d=this.attribute("cy").toPixels("y"),e=this.attribute("r").toPixels();if(b!=null){b.beginPath();b.arc(c,d,e,0,Math.PI*2,true);b.closePath()}return new f.BoundingBox(c-
e,d-e,c+e,d+e)}};f.Element.circle.prototype=new f.Element.PathElementBase;f.Element.ellipse=function(b){this.base=f.Element.PathElementBase;this.base(b);this.path=function(b){var c=4*((Math.sqrt(2)-1)/3),d=this.attribute("rx").toPixels("x"),e=this.attribute("ry").toPixels("y"),g=this.attribute("cx").toPixels("x"),h=this.attribute("cy").toPixels("y");if(b!=null){b.beginPath();b.moveTo(g,h-e);b.bezierCurveTo(g+c*d,h-e,g+d,h-c*e,g+d,h);b.bezierCurveTo(g+d,h+c*e,g+c*d,h+e,g,h+e);b.bezierCurveTo(g-c*d,
h+e,g-d,h+c*e,g-d,h);b.bezierCurveTo(g-d,h-c*e,g-c*d,h-e,g,h-e);b.closePath()}return new f.BoundingBox(g-d,h-e,g+d,h+e)}};f.Element.ellipse.prototype=new f.Element.PathElementBase;f.Element.line=function(b){this.base=f.Element.PathElementBase;this.base(b);this.getPoints=function(){return[new f.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new f.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]};this.path=function(b){var c=this.getPoints();
if(b!=null){b.beginPath();b.moveTo(c[0].x,c[0].y);b.lineTo(c[1].x,c[1].y)}return new f.BoundingBox(c[0].x,c[0].y,c[1].x,c[1].y)};this.getMarkers=function(){var b=this.getPoints(),c=b[0].angleTo(b[1]);return[[b[0],c],[b[1],c]]}};f.Element.line.prototype=new f.Element.PathElementBase;f.Element.polyline=function(b){this.base=f.Element.PathElementBase;this.base(b);this.points=f.CreatePath(this.attribute("points").value);this.path=function(b){var c=new f.BoundingBox(this.points[0].x,this.points[0].y);
if(b!=null){b.beginPath();b.moveTo(this.points[0].x,this.points[0].y)}for(var d=1;d<this.points.length;d++){c.addPoint(this.points[d].x,this.points[d].y);b!=null&&b.lineTo(this.points[d].x,this.points[d].y)}return c};this.getMarkers=function(){for(var b=[],c=0;c<this.points.length-1;c++)b.push([this.points[c],this.points[c].angleTo(this.points[c+1])]);b.length>0&&b.push([this.points[this.points.length-1],b[b.length-1][1]]);return b}};f.Element.polyline.prototype=new f.Element.PathElementBase;f.Element.polygon=
function(b){this.base=f.Element.polyline;this.base(b);this.basePath=this.path;this.path=function(b){var c=this.basePath(b);if(b!=null){b.lineTo(this.points[0].x,this.points[0].y);b.closePath()}return c}};f.Element.polygon.prototype=new f.Element.polyline;f.Element.path=function(b){this.base=f.Element.PathElementBase;this.base(b);for(var b=this.attribute("d").value,b=b.replace(/,/gm," "),c=0;c<2;c++)b=b.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");b=b.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,
"$1 $2");b=b.replace(/([0-9])([+\-])/gm,"$1 $2");for(c=0;c<2;c++)b=b.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");b=b.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");b=f.compressSpaces(b);b=f.trim(b);this.PathParser=new function(b){this.tokens=b.split(" ");this.reset=function(){this.i=-1;this.previousCommand=this.command="";this.start=new f.Point(0,0);this.control=new f.Point(0,0);this.current=new f.Point(0,0);this.points=[];this.angles=[]};this.isEnd=function(){return this.i>=this.tokens.length-
1};this.isCommandOrEnd=function(){return this.isEnd()?true:this.tokens[this.i+1].match(/^[A-Za-z]$/)!=null};this.isRelativeCommand=function(){switch(this.command){case "m":case "l":case "h":case "v":case "c":case "s":case "q":case "t":case "a":case "z":return true}return false};this.getToken=function(){this.i++;return this.tokens[this.i]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken()};this.getPoint=
function(){return this.makeAbsolute(new f.Point(this.getScalar(),this.getScalar()))};this.getAsControlPoint=function(){var b=this.getPoint();return this.control=b};this.getAsCurrentPoint=function(){var b=this.getPoint();return this.current=b};this.getReflectedControlPoint=function(){return this.previousCommand.toLowerCase()!="c"&&this.previousCommand.toLowerCase()!="s"&&this.previousCommand.toLowerCase()!="q"&&this.previousCommand.toLowerCase()!="t"?this.current:new f.Point(2*this.current.x-this.control.x,
2*this.current.y-this.control.y)};this.makeAbsolute=function(b){if(this.isRelativeCommand()){b.x=b.x+this.current.x;b.y=b.y+this.current.y}return b};this.addMarker=function(b,c,d){d!=null&&(this.angles.length>0&&this.angles[this.angles.length-1]==null)&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(d));this.addMarkerAngle(b,c==null?null:c.angleTo(b))};this.addMarkerAngle=function(b,c){this.points.push(b);this.angles.push(c)};this.getMarkerPoints=function(){return this.points};
this.getMarkerAngles=function(){for(var b=0;b<this.angles.length;b++)if(this.angles[b]==null)for(var c=b+1;c<this.angles.length;c++)if(this.angles[c]!=null){this.angles[b]=this.angles[c];break}return this.angles}}(b);this.path=function(b){var c=this.PathParser;c.reset();var d=new f.BoundingBox;for(b!=null&&b.beginPath();!c.isEnd();){c.nextCommand();switch(c.command){case "M":case "m":var e=c.getAsCurrentPoint();c.addMarker(e);d.addPoint(e.x,e.y);b!=null&&b.moveTo(e.x,e.y);for(c.start=c.current;!c.isCommandOrEnd();){e=
c.getAsCurrentPoint();c.addMarker(e,c.start);d.addPoint(e.x,e.y);b!=null&&b.lineTo(e.x,e.y)}break;case "L":case "l":for(;!c.isCommandOrEnd();){var g=c.current,e=c.getAsCurrentPoint();c.addMarker(e,g);d.addPoint(e.x,e.y);b!=null&&b.lineTo(e.x,e.y)}break;case "H":case "h":for(;!c.isCommandOrEnd();){e=new f.Point((c.isRelativeCommand()?c.current.x:0)+c.getScalar(),c.current.y);c.addMarker(e,c.current);c.current=e;d.addPoint(c.current.x,c.current.y);b!=null&&b.lineTo(c.current.x,c.current.y)}break;case "V":case "v":for(;!c.isCommandOrEnd();){e=
new f.Point(c.current.x,(c.isRelativeCommand()?c.current.y:0)+c.getScalar());c.addMarker(e,c.current);c.current=e;d.addPoint(c.current.x,c.current.y);b!=null&&b.lineTo(c.current.x,c.current.y)}break;case "C":case "c":for(;!c.isCommandOrEnd();){var h=c.current,g=c.getPoint(),j=c.getAsControlPoint(),e=c.getAsCurrentPoint();c.addMarker(e,j,g);d.addBezierCurve(h.x,h.y,g.x,g.y,j.x,j.y,e.x,e.y);b!=null&&b.bezierCurveTo(g.x,g.y,j.x,j.y,e.x,e.y)}break;case "S":case "s":for(;!c.isCommandOrEnd();){h=c.current;
g=c.getReflectedControlPoint();j=c.getAsControlPoint();e=c.getAsCurrentPoint();c.addMarker(e,j,g);d.addBezierCurve(h.x,h.y,g.x,g.y,j.x,j.y,e.x,e.y);b!=null&&b.bezierCurveTo(g.x,g.y,j.x,j.y,e.x,e.y)}break;case "Q":case "q":for(;!c.isCommandOrEnd();){h=c.current;j=c.getAsControlPoint();e=c.getAsCurrentPoint();c.addMarker(e,j,j);d.addQuadraticCurve(h.x,h.y,j.x,j.y,e.x,e.y);b!=null&&b.quadraticCurveTo(j.x,j.y,e.x,e.y)}break;case "T":case "t":for(;!c.isCommandOrEnd();){h=c.current;j=c.getReflectedControlPoint();
c.control=j;e=c.getAsCurrentPoint();c.addMarker(e,j,j);d.addQuadraticCurve(h.x,h.y,j.x,j.y,e.x,e.y);b!=null&&b.quadraticCurveTo(j.x,j.y,e.x,e.y)}break;case "A":case "a":for(;!c.isCommandOrEnd();){var h=c.current,k=c.getScalar(),l=c.getScalar(),g=c.getScalar()*(Math.PI/180),m=c.getScalar(),j=c.getScalar(),e=c.getAsCurrentPoint(),n=new f.Point(Math.cos(g)*(h.x-e.x)/2+Math.sin(g)*(h.y-e.y)/2,-Math.sin(g)*(h.x-e.x)/2+Math.cos(g)*(h.y-e.y)/2),o=Math.pow(n.x,2)/Math.pow(k,2)+Math.pow(n.y,2)/Math.pow(l,
2);if(o>1){k=k*Math.sqrt(o);l=l*Math.sqrt(o)}m=(m==j?-1:1)*Math.sqrt((Math.pow(k,2)*Math.pow(l,2)-Math.pow(k,2)*Math.pow(n.y,2)-Math.pow(l,2)*Math.pow(n.x,2))/(Math.pow(k,2)*Math.pow(n.y,2)+Math.pow(l,2)*Math.pow(n.x,2)));isNaN(m)&&(m=0);var p=new f.Point(m*k*n.y/l,m*-l*n.x/k),h=new f.Point((h.x+e.x)/2+Math.cos(g)*p.x-Math.sin(g)*p.y,(h.y+e.y)/2+Math.sin(g)*p.x+Math.cos(g)*p.y),q=function(b,c){return(b[0]*c[0]+b[1]*c[1])/(Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2))*Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],
2)))},r=function(b,c){return(b[0]*c[1]<b[1]*c[0]?-1:1)*Math.acos(q(b,c))},m=r([1,0],[(n.x-p.x)/k,(n.y-p.y)/l]),o=[(n.x-p.x)/k,(n.y-p.y)/l],p=[(-n.x-p.x)/k,(-n.y-p.y)/l],n=r(o,p);if(q(o,p)<=-1)n=Math.PI;q(o,p)>=1&&(n=0);o=1-j?1:-1;p=m+o*(n/2);r=new f.Point(h.x+k*Math.cos(p),h.y+l*Math.sin(p));c.addMarkerAngle(r,p-o*Math.PI/2);c.addMarkerAngle(e,p-o*Math.PI);d.addPoint(e.x,e.y);if(b!=null){q=k>l?k:l;e=k>l?1:k/l;k=k>l?l/k:1;b.translate(h.x,h.y);b.rotate(g);b.scale(e,k);b.arc(0,0,q,m,m+n,1-j);b.scale(1/
e,1/k);b.rotate(-g);b.translate(-h.x,-h.y)}}break;case "Z":case "z":b!=null&&b.closePath();c.current=c.start}}return d};this.getMarkers=function(){for(var b=this.PathParser.getMarkerPoints(),c=this.PathParser.getMarkerAngles(),d=[],e=0;e<b.length;e++)d.push([b[e],c[e]]);return d}};f.Element.path.prototype=new f.Element.PathElementBase;f.Element.pattern=function(b){this.base=f.Element.ElementBase;this.base(b);this.createPattern=function(b){var c=this.attribute("width").toPixels("x",true),d=this.attribute("height").toPixels("y",
true),e=new f.Element.svg;e.attributes.viewBox=new f.Property("viewBox",this.attribute("viewBox").value);e.attributes.width=new f.Property("width",c+"px");e.attributes.height=new f.Property("height",d+"px");e.attributes.transform=new f.Property("transform",this.attribute("patternTransform").value);e.children=this.children;var g=document.createElement("canvas");g.width=c;g.height=d;c=g.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&c.translate(this.attribute("x").toPixels("x",
true),this.attribute("y").toPixels("y",true));for(d=-1;d<=1;d++)for(var h=-1;h<=1;h++){c.save();e.attributes.x=new f.Property("x",d*g.width);e.attributes.y=new f.Property("y",h*g.height);e.render(c);c.restore()}return b.createPattern(g,"repeat")}};f.Element.pattern.prototype=new f.Element.ElementBase;f.Element.marker=function(b){this.base=f.Element.ElementBase;this.base(b);this.baseRender=this.render;this.render=function(b,c,d){b.translate(c.x,c.y);this.attribute("orient").valueOrDefault("auto")==
"auto"&&b.rotate(d);this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"&&b.scale(b.lineWidth,b.lineWidth);b.save();var e=new f.Element.svg;e.attributes.viewBox=new f.Property("viewBox",this.attribute("viewBox").value);e.attributes.refX=new f.Property("refX",this.attribute("refX").value);e.attributes.refY=new f.Property("refY",this.attribute("refY").value);e.attributes.width=new f.Property("width",this.attribute("markerWidth").value);e.attributes.height=new f.Property("height",
this.attribute("markerHeight").value);e.attributes.fill=new f.Property("fill",this.attribute("fill").valueOrDefault("black"));e.attributes.stroke=new f.Property("stroke",this.attribute("stroke").valueOrDefault("none"));e.children=this.children;e.render(b);b.restore();this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"&&b.scale(1/b.lineWidth,1/b.lineWidth);this.attribute("orient").valueOrDefault("auto")=="auto"&&b.rotate(-d);b.translate(-c.x,-c.y)}};f.Element.marker.prototype=
new f.Element.ElementBase;f.Element.defs=function(b){this.base=f.Element.ElementBase;this.base(b);this.render=function(){}};f.Element.defs.prototype=new f.Element.ElementBase;f.Element.GradientBase=function(b){this.base=f.Element.ElementBase;this.base(b);this.stops=[];for(b=0;b<this.children.length;b++){var c=this.children[b];c.type=="stop"&&this.stops.push(c)}this.getGradient=function(){};this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")};this.attributesToInherit=
["gradientUnits"];this.inheritStopContainer=function(b){for(var c=0;c<this.attributesToInherit.length;c++){var d=this.attributesToInherit[c];if(!this.attribute(d).hasValue()&&b.attribute(d).hasValue())this.attribute(d,true).value=b.attribute(d).value}};this.createGradient=function(b,c,d){var e=this;if(this.getHrefAttribute().hasValue()){e=this.getHrefAttribute().getDefinition();this.inheritStopContainer(e)}var g=function(b){return d.hasValue()?(new f.Property("color",b)).addOpacity(d).value:b},b=
this.getGradient(b,c);if(b==null)return g(e.stops[e.stops.length-1].color);for(c=0;c<e.stops.length;c++)b.addColorStop(e.stops[c].offset,g(e.stops[c].color));if(this.attribute("gradientTransform").hasValue()){e=f.ViewPort.viewPorts[0];g=new f.Element.rect;g.attributes.x=new f.Property("x",-f.MAX_VIRTUAL_PIXELS/3);g.attributes.y=new f.Property("y",-f.MAX_VIRTUAL_PIXELS/3);g.attributes.width=new f.Property("width",f.MAX_VIRTUAL_PIXELS);g.attributes.height=new f.Property("height",f.MAX_VIRTUAL_PIXELS);
c=new f.Element.g;c.attributes.transform=new f.Property("transform",this.attribute("gradientTransform").value);c.children=[g];g=new f.Element.svg;g.attributes.x=new f.Property("x",0);g.attributes.y=new f.Property("y",0);g.attributes.width=new f.Property("width",e.width);g.attributes.height=new f.Property("height",e.height);g.children=[c];c=document.createElement("canvas");c.width=e.width;c.height=e.height;e=c.getContext("2d");e.fillStyle=b;g.render(e);return e.createPattern(c,"no-repeat")}return b}};
f.Element.GradientBase.prototype=new f.Element.ElementBase;f.Element.linearGradient=function(b){this.base=f.Element.GradientBase;this.base(b);this.attributesToInherit.push("x1");this.attributesToInherit.push("y1");this.attributesToInherit.push("x2");this.attributesToInherit.push("y2");this.getGradient=function(b,c){var d=this.gradientUnits()=="objectBoundingBox"?c.getBoundingBox():null;if(!this.attribute("x1").hasValue()&&!this.attribute("y1").hasValue()&&!this.attribute("x2").hasValue()&&!this.attribute("y2").hasValue()){this.attribute("x1",
true).value=0;this.attribute("y1",true).value=0;this.attribute("x2",true).value=1;this.attribute("y2",true).value=0}var e=this.gradientUnits()=="objectBoundingBox"?d.x()+d.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),f=this.gradientUnits()=="objectBoundingBox"?d.y()+d.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),g=this.gradientUnits()=="objectBoundingBox"?d.x()+d.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),
d=this.gradientUnits()=="objectBoundingBox"?d.y()+d.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return e==g&&f==d?null:b.createLinearGradient(e,f,g,d)}};f.Element.linearGradient.prototype=new f.Element.GradientBase;f.Element.radialGradient=function(b){this.base=f.Element.GradientBase;this.base(b);this.attributesToInherit.push("cx");this.attributesToInherit.push("cy");this.attributesToInherit.push("r");this.attributesToInherit.push("fx");this.attributesToInherit.push("fy");
this.getGradient=function(b,c){var d=c.getBoundingBox();if(!this.attribute("cx").hasValue())this.attribute("cx",true).value="50%";if(!this.attribute("cy").hasValue())this.attribute("cy",true).value="50%";if(!this.attribute("r").hasValue())this.attribute("r",true).value="50%";var e=this.gradientUnits()=="objectBoundingBox"?d.x()+d.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),f=this.gradientUnits()=="objectBoundingBox"?d.y()+d.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),
g=e,h=f;this.attribute("fx").hasValue()&&(g=this.gradientUnits()=="objectBoundingBox"?d.x()+d.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x"));this.attribute("fy").hasValue()&&(h=this.gradientUnits()=="objectBoundingBox"?d.y()+d.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));d=this.gradientUnits()=="objectBoundingBox"?(d.width()+d.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return b.createRadialGradient(g,h,0,e,
f,d)}};f.Element.radialGradient.prototype=new f.Element.GradientBase;f.Element.stop=function(b){this.base=f.Element.ElementBase;this.base(b);this.offset=this.attribute("offset").numValue();if(this.offset<0)this.offset=0;if(this.offset>1)this.offset=1;b=this.style("stop-color",true);if(b.value==="")b.value="#000";this.style("stop-opacity").hasValue()&&(b=b.addOpacity(this.style("stop-opacity")));this.color=b.value};f.Element.stop.prototype=new f.Element.ElementBase;f.Element.AnimateBase=function(b){this.base=
f.Element.ElementBase;this.base(b);f.Animations.push(this);this.duration=0;this.begin=this.attribute("begin").toMilliseconds();this.maxDuration=this.begin+this.attribute("dur").toMilliseconds();this.getProperty=function(){var b=this.attribute("attributeType").value,c=this.attribute("attributeName").value;return b=="CSS"?this.parent.style(c,true):this.parent.attribute(c,true)};this.initialValue=null;this.initialUnits="";this.removed=false;this.calcValue=function(){return""};this.update=function(b){if(this.initialValue==
null){this.initialValue=this.getProperty().value;this.initialUnits=this.getProperty().getUnits()}if(this.duration>this.maxDuration){if(this.attribute("repeatCount").value=="indefinite"||this.attribute("repeatDur").value=="indefinite")this.duration=0;else if(this.attribute("fill").valueOrDefault("remove")=="freeze"&&!this.frozen){this.frozen=true;this.parent.animationFrozen=true;this.parent.animationFrozenValue=this.getProperty().value}else if(this.attribute("fill").valueOrDefault("remove")=="remove"&&
!this.removed){this.removed=true;this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue;return true}return false}this.duration=this.duration+b;b=false;if(this.begin<this.duration){b=this.calcValue();this.attribute("type").hasValue()&&(b=this.attribute("type").value+"("+b+")");this.getProperty().value=b;b=true}return b};this.from=this.attribute("from");this.to=this.attribute("to");this.values=this.attribute("values");if(this.values.hasValue())this.values.value=
this.values.value.split(";");this.progress=function(){var b={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var c=b.progress*(this.values.value.length-1),d=Math.floor(c),e=Math.ceil(c);b.from=new f.Property("from",parseFloat(this.values.value[d]));b.to=new f.Property("to",parseFloat(this.values.value[e]));b.progress=(c-d)/(e-d)}else{b.from=this.from;b.to=this.to}return b}};f.Element.AnimateBase.prototype=new f.Element.ElementBase;f.Element.animate=function(b){this.base=
f.Element.AnimateBase;this.base(b);this.calcValue=function(){var b=this.progress();return b.from.numValue()+(b.to.numValue()-b.from.numValue())*b.progress+this.initialUnits}};f.Element.animate.prototype=new f.Element.AnimateBase;f.Element.animateColor=function(c){this.base=f.Element.AnimateBase;this.base(c);this.calcValue=function(){var c=this.progress(),d=new b(c.from.value),e=new b(c.to.value);if(d.ok&&e.ok){var f=d.g+(e.g-d.g)*c.progress,g=d.b+(e.b-d.b)*c.progress;return"rgb("+parseInt(d.r+(e.r-
d.r)*c.progress,10)+","+parseInt(f,10)+","+parseInt(g,10)+")"}return this.attribute("from").value}};f.Element.animateColor.prototype=new f.Element.AnimateBase;f.Element.animateTransform=function(b){this.base=f.Element.AnimateBase;this.base(b);this.calcValue=function(){for(var b=this.progress(),c=f.ToNumberArray(b.from.value),d=f.ToNumberArray(b.to.value),e="",g=0;g<c.length;g++)e=e+(c[g]+(d[g]-c[g])*b.progress+" ");return e}};f.Element.animateTransform.prototype=new f.Element.animate;f.Element.font=
function(b){this.base=f.Element.ElementBase;this.base(b);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.isArabic=this.isRTL=false;this.missingGlyph=this.fontFace=null;this.glyphs=[];for(b=0;b<this.children.length;b++){var c=this.children[b];if(c.type=="font-face"){this.fontFace=c;c.style("font-family").hasValue()&&(f.Definitions[c.style("font-family").value]=this)}else if(c.type=="missing-glyph")this.missingGlyph=c;else if(c.type=="glyph")if(c.arabicForm!=""){this.isArabic=this.isRTL=
true;typeof this.glyphs[c.unicode]=="undefined"&&(this.glyphs[c.unicode]=[]);this.glyphs[c.unicode][c.arabicForm]=c}else this.glyphs[c.unicode]=c}};f.Element.font.prototype=new f.Element.ElementBase;f.Element.fontface=function(b){this.base=f.Element.ElementBase;this.base(b);this.ascent=this.attribute("ascent").value;this.descent=this.attribute("descent").value;this.unitsPerEm=this.attribute("units-per-em").numValue()};f.Element.fontface.prototype=new f.Element.ElementBase;f.Element.missingglyph=function(b){this.base=
f.Element.path;this.base(b);this.horizAdvX=0};f.Element.missingglyph.prototype=new f.Element.path;f.Element.glyph=function(b){this.base=f.Element.path;this.base(b);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.unicode=this.attribute("unicode").value;this.arabicForm=this.attribute("arabic-form").value};f.Element.glyph.prototype=new f.Element.path;f.Element.text=function(b){this.captureTextNodes=true;this.base=f.Element.RenderedElementBase;this.base(b);this.baseSetContext=this.setContext;
this.setContext=function(b){this.baseSetContext(b);var c=this.style("dominant-baseline").toTextBaseline();c==null&&(c=this.style("alignment-baseline").toTextBaseline());if(c!=null)b.textBaseline=c};this.getBoundingBox=function(){var b=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),d=this.parent.style("font-size").numValueOrDefault(f.Font.Parse(f.ctx.font).fontSize);return new f.BoundingBox(b,c-d,b+Math.floor(d*2/3)*this.children[0].getText().length,c)};this.renderChildren=function(b){this.x=
this.attribute("x").toPixels("x");this.y=this.attribute("y").toPixels("y");if(this.attribute("dx").hasValue())this.x=this.x+this.attribute("dx").toPixels("x");if(this.attribute("dy").hasValue())this.y=this.y+this.attribute("dy").toPixels("y");this.x=this.x+this.getAnchorDelta(b,this,0);for(var c=0;c<this.children.length;c++)this.renderChild(b,this,this,c)};this.getAnchorDelta=function(b,c,d){var e=this.style("text-anchor").valueOrDefault("start");if(e!="start"){for(var f=0,g=d;g<c.children.length;g++){var h=
c.children[g];if(g>d&&h.attribute("x").hasValue())break;f=f+h.measureTextRecursive(b)}return-1*(e=="end"?f:f/2)}return 0};this.renderChild=function(b,c,d,e){var f=d.children[e];if(f.attribute("x").hasValue()){f.x=f.attribute("x").toPixels("x")+c.getAnchorDelta(b,d,e);if(f.attribute("dx").hasValue())f.x=f.x+f.attribute("dx").toPixels("x")}else{if(f.attribute("dx").hasValue())c.x=c.x+f.attribute("dx").toPixels("x");f.x=c.x}c.x=f.x+f.measureText(b);if(f.attribute("y").hasValue()){f.y=f.attribute("y").toPixels("y");
if(f.attribute("dy").hasValue())f.y=f.y+f.attribute("dy").toPixels("y")}else{if(f.attribute("dy").hasValue())c.y=c.y+f.attribute("dy").toPixels("y");f.y=c.y}c.y=f.y;f.render(b);for(e=0;e<f.children.length;e++)c.renderChild(b,c,f,e)}};f.Element.text.prototype=new f.Element.RenderedElementBase;f.Element.TextElementBase=function(b){this.base=f.Element.RenderedElementBase;this.base(b);this.getGlyph=function(b,c,d){var e=c[d],f=null;if(b.isArabic){var g="isolated";if((d==0||c[d-1]==" ")&&d<c.length-2&&
c[d+1]!=" ")g="terminal";d>0&&(c[d-1]!=" "&&d<c.length-2&&c[d+1]!=" ")&&(g="medial");if(d>0&&c[d-1]!=" "&&(d==c.length-1||c[d+1]==" "))g="initial";if(typeof b.glyphs[e]!="undefined"){f=b.glyphs[e][g];f==null&&b.glyphs[e].type=="glyph"&&(f=b.glyphs[e])}}else f=b.glyphs[e];if(f==null)f=b.missingGlyph;return f};this.renderChildren=function(b){var c=this.parent.style("font-family").getDefinition();if(c!=null){var d=this.parent.style("font-size").numValueOrDefault(f.Font.Parse(f.ctx.font).fontSize),e=
this.parent.style("font-style").valueOrDefault(f.Font.Parse(f.ctx.font).fontStyle),g=this.getText();c.isRTL&&(g=g.split("").reverse().join(""));for(var h=f.ToNumberArray(this.parent.attribute("dx").value),j=0;j<g.length;j++){var k=this.getGlyph(c,g,j),l=d/c.fontFace.unitsPerEm;b.translate(this.x,this.y);b.scale(l,-l);var m=b.lineWidth;b.lineWidth=b.lineWidth*c.fontFace.unitsPerEm/d;e=="italic"&&b.transform(1,0,0.4,1,0,0);k.render(b);e=="italic"&&b.transform(1,0,-0.4,1,0,0);b.lineWidth=m;b.scale(1/
l,-1/l);b.translate(-this.x,-this.y);this.x=this.x+d*(k.horizAdvX||c.horizAdvX)/c.fontFace.unitsPerEm;if(typeof h[j]!="undefined"&&!isNaN(h[j]))this.x=this.x+h[j]}}else{b.fillStyle!=""&&b.fillText(f.compressSpaces(this.getText()),this.x,this.y);b.strokeStyle!=""&&b.strokeText(f.compressSpaces(this.getText()),this.x,this.y)}};this.getText=function(){};this.measureTextRecursive=function(b){for(var c=this.measureText(b),d=0;d<this.children.length;d++)c=c+this.children[d].measureTextRecursive(b);return c};
this.measureText=function(b){var c=this.parent.style("font-family").getDefinition();if(c!=null){var b=this.parent.style("font-size").numValueOrDefault(f.Font.Parse(f.ctx.font).fontSize),d=0,e=this.getText();c.isRTL&&(e=e.split("").reverse().join(""));for(var g=f.ToNumberArray(this.parent.attribute("dx").value),h=0;h<e.length;h++){var j=this.getGlyph(c,e,h),d=d+(j.horizAdvX||c.horizAdvX)*b/c.fontFace.unitsPerEm;typeof g[h]!="undefined"&&!isNaN(g[h])&&(d=d+g[h])}return d}c=f.compressSpaces(this.getText());
if(!b.measureText)return c.length*10;b.save();this.setContext(b);c=b.measureText(c).width;b.restore();return c}};f.Element.TextElementBase.prototype=new f.Element.RenderedElementBase;f.Element.tspan=function(b){this.captureTextNodes=true;this.base=f.Element.TextElementBase;this.base(b);this.text=f.compressSpaces(b.value||b.text||b.textContent||"");this.getText=function(){return this.children.length>0?"":this.text}};f.Element.tspan.prototype=new f.Element.TextElementBase;f.Element.tref=function(b){this.base=
f.Element.TextElementBase;this.base(b);this.getText=function(){var b=this.getHrefAttribute().getDefinition();if(b!=null)return b.children[0].getText()}};f.Element.tref.prototype=new f.Element.TextElementBase;f.Element.a=function(b){this.base=f.Element.TextElementBase;this.base(b);this.hasText=b.childNodes.length>0;for(var c=0;c<b.childNodes.length;c++)if(b.childNodes[c].nodeType!=3)this.hasText=false;this.text=this.hasText?b.childNodes[0].value:"";this.getText=function(){return this.text};this.baseRenderChildren=
this.renderChildren;this.renderChildren=function(b){if(this.hasText){this.baseRenderChildren(b);var c=new f.Property("fontSize",f.Font.Parse(f.ctx.font).fontSize);f.Mouse.checkBoundingBox(this,new f.BoundingBox(this.x,this.y-c.toPixels("y"),this.x+this.measureText(b),this.y))}else if(this.children.length>0){c=new f.Element.g;c.children=this.children;c.parent=this;c.render(b)}};this.onclick=function(){window.open(this.getHrefAttribute().value)};this.onmousemove=function(){f.ctx.canvas.style.cursor=
"pointer"}};f.Element.a.prototype=new f.Element.TextElementBase;f.Element.image=function(b){this.base=f.Element.RenderedElementBase;this.base(b);var c=this.getHrefAttribute().value;if(c!=""){var d=c.match(/\.svg$/);f.Images.push(this);this.loaded=false;if(d){this.img=f.ajax(c);this.loaded=true}else{this.img=document.createElement("img");if(f.opts.useCORS==true)this.img.crossOrigin="Anonymous";var e=this;this.img.onload=function(){e.loaded=true};this.img.onerror=function(){f.log('ERROR: image "'+c+
'" not found');e.loaded=true};this.img.src=c}this.renderChildren=function(b){var c=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),g=this.attribute("width").toPixels("x"),h=this.attribute("height").toPixels("y");if(!(g==0||h==0)){b.save();if(d)b.drawSvg(this.img,c,e,g,h);else{b.translate(c,e);f.AspectRatio(b,this.attribute("preserveAspectRatio").value,g,this.img.width,h,this.img.height,0,0);b.drawImage(this.img,0,0)}b.restore()}};this.getBoundingBox=function(){var b=this.attribute("x").toPixels("x"),
c=this.attribute("y").toPixels("y"),d=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y");return new f.BoundingBox(b,c,b+d,c+e)}}};f.Element.image.prototype=new f.Element.RenderedElementBase;f.Element.g=function(b){this.base=f.Element.RenderedElementBase;this.base(b);this.getBoundingBox=function(){for(var b=new f.BoundingBox,c=0;c<this.children.length;c++)b.addBoundingBox(this.children[c].getBoundingBox());return b}};f.Element.g.prototype=new f.Element.RenderedElementBase;
f.Element.symbol=function(b){this.base=f.Element.RenderedElementBase;this.base(b);this.render=function(){}};f.Element.symbol.prototype=new f.Element.RenderedElementBase;f.Element.style=function(b){this.base=f.Element.ElementBase;this.base(b);for(var c="",e=0;e<b.childNodes.length;e++)c=c+b.childNodes[e].data;c=c.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");c=f.compressSpaces(c);b=c.split("}");for(e=0;e<b.length;e++)if(f.trim(b[e])!="")for(var g=b[e].split("{"),c=g[0].split(","),
g=g[1].split(";"),h=0;h<c.length;h++){var j=f.trim(c[h]);if(j!=""){for(var k=f.Styles[j]||{},l=0;l<g.length;l++){var m=g[l].indexOf(":"),n=g[l].substr(0,m),m=g[l].substr(m+1,g[l].length-m);n!=null&&m!=null&&(k[f.trim(n)]=new f.Property(f.trim(n),f.trim(m)))}f.Styles[j]=k;f.StylesSpecificity[j]=d(j);if(j=="@font-face"){j=k["font-family"].value.replace(/"/g,"");k=k.src.value.split(",");for(l=0;l<k.length;l++)if(k[l].indexOf('format("svg")')>0){n=k[l].indexOf("url");m=k[l].indexOf(")",n);n=k[l].substr(n+
5,m-n-6);n=f.parseXml(f.ajax(n)).getElementsByTagName("font");for(m=0;m<n.length;m++){var p=f.CreateElement(n[m]);f.Definitions[j]=p}}}}}};f.Element.style.prototype=new f.Element.ElementBase;f.Element.use=function(b){this.base=f.Element.RenderedElementBase;this.base(b);this.baseSetContext=this.setContext;this.setContext=function(b){this.baseSetContext(b);this.attribute("x").hasValue()&&b.translate(this.attribute("x").toPixels("x"),0);this.attribute("y").hasValue()&&b.translate(0,this.attribute("y").toPixels("y"))};
var c=this.getHrefAttribute().getDefinition();this.path=function(b){c!=null&&c.path(b)};this.getBoundingBox=function(){if(c!=null)return c.getBoundingBox()};this.renderChildren=function(b){if(c!=null){var d=c;if(c.type=="symbol"){d=new f.Element.svg;d.type="svg";d.attributes.viewBox=new f.Property("viewBox",c.attribute("viewBox").value);d.attributes.preserveAspectRatio=new f.Property("preserveAspectRatio",c.attribute("preserveAspectRatio").value);d.attributes.overflow=new f.Property("overflow",c.attribute("overflow").value);
d.children=c.children}if(d.type=="svg"){this.attribute("width").hasValue()&&(d.attributes.width=new f.Property("width",this.attribute("width").value));this.attribute("height").hasValue()&&(d.attributes.height=new f.Property("height",this.attribute("height").value))}var e=d.parent;d.parent=null;d.render(b);d.parent=e}}};f.Element.use.prototype=new f.Element.RenderedElementBase;f.Element.mask=function(b){this.base=f.Element.ElementBase;this.base(b);this.apply=function(b,c){var d=this.attribute("x").toPixels("x"),
e=this.attribute("y").toPixels("y"),g=this.attribute("width").toPixels("x"),h=this.attribute("height").toPixels("y");if(g==0&&h==0){h=new f.BoundingBox;for(d=0;d<this.children.length;d++)h.addBoundingBox(this.children[d].getBoundingBox());d=Math.floor(h.x1);e=Math.floor(h.y1);g=Math.floor(h.width());h=Math.floor(h.height())}var j=c.attribute("mask").value;c.attribute("mask").value="";var k=document.createElement("canvas");k.width=d+g;k.height=e+h;var l=k.getContext("2d");this.renderChildren(l);var m=
document.createElement("canvas");m.width=d+g;m.height=e+h;var n=m.getContext("2d");c.render(n);n.globalCompositeOperation="destination-in";n.fillStyle=l.createPattern(k,"no-repeat");n.fillRect(0,0,d+g,e+h);b.fillStyle=n.createPattern(m,"no-repeat");b.fillRect(0,0,d+g,e+h);c.attribute("mask").value=j};this.render=function(){}};f.Element.mask.prototype=new f.Element.ElementBase;f.Element.clipPath=function(b){this.base=f.Element.ElementBase;this.base(b);this.apply=function(b){var c=CanvasRenderingContext2D.prototype.beginPath;
CanvasRenderingContext2D.prototype.beginPath=function(){};var d=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){};c.call(b);for(var e=0;e<this.children.length;e++){var g=this.children[e];if(typeof g.path!="undefined"){var h=null;if(g.style("transform",false,true).hasValue()){h=new f.Transform(g.style("transform",false,true).value);h.apply(b)}g.path(b);CanvasRenderingContext2D.prototype.closePath=d;h&&h.unapply(b)}}d.call(b);b.clip();CanvasRenderingContext2D.prototype.beginPath=
c;CanvasRenderingContext2D.prototype.closePath=d};this.render=function(){}};f.Element.clipPath.prototype=new f.Element.ElementBase;f.Element.filter=function(b){this.base=f.Element.ElementBase;this.base(b);this.apply=function(b,c){var d=c.getBoundingBox(),e=Math.floor(d.x1),f=Math.floor(d.y1),g=Math.floor(d.width()),d=Math.floor(d.height()),h=c.style("filter").value;c.style("filter").value="";for(var j=0,k=0,l=0;l<this.children.length;l++)var m=this.children[l].extraFilterDistance||0,j=Math.max(j,
m),k=Math.max(k,m);m=document.createElement("canvas");m.width=g+2*j;m.height=d+2*k;var n=m.getContext("2d");n.translate(-e+j,-f+k);c.render(n);for(l=0;l<this.children.length;l++)typeof this.children[l].apply=="function"&&this.children[l].apply(n,0,0,g+2*j,d+2*k);b.drawImage(m,0,0,g+2*j,d+2*k,e-j,f-k,g+2*j,d+2*k);c.style("filter",true).value=h};this.render=function(){}};f.Element.filter.prototype=new f.Element.ElementBase;f.Element.feMorphology=function(b){this.base=f.Element.ElementBase;this.base(b);
this.apply=function(){}};f.Element.feMorphology.prototype=new f.Element.ElementBase;f.Element.feComposite=function(b){this.base=f.Element.ElementBase;this.base(b);this.apply=function(){}};f.Element.feComposite.prototype=new f.Element.ElementBase;f.Element.feColorMatrix=function(b){function c(b,e){var f=d[b];return f*(f<0?e-255:e)}this.base=f.Element.ElementBase;this.base(b);var d=f.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case "saturate":b=
d[0];d=[0.213+0.787*b,0.715-0.715*b,0.072-0.072*b,0,0,0.213-0.213*b,0.715+0.285*b,0.072-0.072*b,0,0,0.213-0.213*b,0.715-0.715*b,0.072+0.928*b,0,0,0,0,0,1,0,0,0,0,0,1];break;case "hueRotate":var e=d[0]*Math.PI/180,b=function(b,c,d){return b+Math.cos(e)*c+Math.sin(e)*d},d=[b(0.213,0.787,-0.213),b(0.715,-0.715,-0.715),b(0.072,-0.072,0.928),0,0,b(0.213,-0.213,0.143),b(0.715,0.285,0.14),b(0.072,-0.072,-0.283),0,0,b(0.213,-0.213,-0.787),b(0.715,-0.715,0.715),b(0.072,0.928,0.072),0,0,0,0,0,1,0,0,0,0,0,1];
break;case "luminanceToAlpha":d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0,1]}this.apply=function(b,d,e,f,g){for(var h=b.getImageData(0,0,f,g),e=0;e<g;e++)for(d=0;d<f;d++){var j=h.data[e*f*4+d*4+0],k=h.data[e*f*4+d*4+1],l=h.data[e*f*4+d*4+2],m=h.data[e*f*4+d*4+3],n=c(0,j)+c(1,k)+c(2,l)+c(3,m)+c(4,1);h.data[e*f*4+d*4+0]=n;n=c(5,j)+c(6,k)+c(7,l)+c(8,m)+c(9,1);h.data[e*f*4+d*4+1]=n;n=c(10,j)+c(11,k)+c(12,l)+c(13,m)+c(14,1);h.data[e*f*4+d*4+2]=n;j=c(15,j)+c(16,k)+c(17,l)+c(18,m)+
c(19,1);h.data[e*f*4+d*4+3]=j}b.clearRect(0,0,f,g);b.putImageData(h,0,0)}};f.Element.feColorMatrix.prototype=new f.Element.ElementBase;f.Element.feGaussianBlur=function(b){this.base=f.Element.ElementBase;this.base(b);this.extraFilterDistance=this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue());this.apply=function(b,d,e,g,h){if(typeof c.canvasRGBA=="undefined")f.log("ERROR: StackBlur.js must be included for blur to work");else{b.canvas.id=f.UniqueId();b.canvas.style.display="none";
document.body.appendChild(b.canvas);c.canvasRGBA(b.canvas.id,d,e,g,h,this.blurRadius);document.body.removeChild(b.canvas)}}};f.Element.feGaussianBlur.prototype=new f.Element.ElementBase;f.Element.title=function(){};f.Element.title.prototype=new f.Element.ElementBase;f.Element.desc=function(){};f.Element.desc.prototype=new f.Element.ElementBase;f.Element.MISSING=function(b){f.log("ERROR: Element '"+b.nodeName+"' not yet implemented.")};f.Element.MISSING.prototype=new f.Element.ElementBase;f.CreateElement=
function(b){var c=b.nodeName.replace(/^[^:]+:/,""),c=c.replace(/\-/g,""),d=null,d=typeof f.Element[c]!="undefined"?new f.Element[c](b):new f.Element.MISSING(b);d.type=b.nodeName;return d};f.load=function(b,c){f.loadXml(b,f.ajax(c))};f.loadXml=function(b,c){f.loadXmlDoc(b,f.parseXml(c))};f.loadXmlDoc=function(b,c){f.init(b);var d=function(c){for(var d=b.canvas;d;){c.x=c.x-d.offsetLeft;c.y=c.y-d.offsetTop;d=d.offsetParent}if(window.scrollX)c.x=c.x+window.scrollX;if(window.scrollY)c.y=c.y+window.scrollY;
return c};if(f.opts.ignoreMouse!=true){b.canvas.onclick=function(b){b=d(new f.Point(b!=null?b.clientX:event.clientX,b!=null?b.clientY:event.clientY));f.Mouse.onclick(b.x,b.y)};b.canvas.onmousemove=function(b){b=d(new f.Point(b!=null?b.clientX:event.clientX,b!=null?b.clientY:event.clientY));f.Mouse.onmousemove(b.x,b.y)}}var e=f.CreateElement(c.documentElement);e.root=true;e.addStylesFromStyleDefinition();var g=true,h=function(){f.ViewPort.Clear();b.canvas.parentNode&&f.ViewPort.SetCurrent(b.canvas.parentNode.clientWidth,
b.canvas.parentNode.clientHeight);if(f.opts.ignoreDimensions!=true){if(e.style("width").hasValue()){b.canvas.width=e.style("width").toPixels("x");b.canvas.style.width=b.canvas.width+"px"}if(e.style("height").hasValue()){b.canvas.height=e.style("height").toPixels("y");b.canvas.style.height=b.canvas.height+"px"}}var d=b.canvas.clientWidth||b.canvas.width,h=b.canvas.clientHeight||b.canvas.height;if(f.opts.ignoreDimensions==true&&e.style("width").hasValue()&&e.style("height").hasValue()){d=e.style("width").toPixels("x");
h=e.style("height").toPixels("y")}f.ViewPort.SetCurrent(d,h);if(f.opts.offsetX!=null)e.attribute("x",true).value=f.opts.offsetX;if(f.opts.offsetY!=null)e.attribute("y",true).value=f.opts.offsetY;if(f.opts.scaleWidth!=null||f.opts.scaleHeight!=null){var j=null,k=null,l=f.ToNumberArray(e.attribute("viewBox").value);f.opts.scaleWidth!=null&&(e.attribute("width").hasValue()?j=e.attribute("width").toPixels("x")/f.opts.scaleWidth:isNaN(l[2])||(j=l[2]/f.opts.scaleWidth));f.opts.scaleHeight!=null&&(e.attribute("height").hasValue()?
k=e.attribute("height").toPixels("y")/f.opts.scaleHeight:isNaN(l[3])||(k=l[3]/f.opts.scaleHeight));j==null&&(j=k);k==null&&(k=j);e.attribute("width",true).value=f.opts.scaleWidth;e.attribute("height",true).value=f.opts.scaleHeight;e.style("transform",true,true).value+=" scale("+1/j+","+1/k+")"}f.opts.ignoreClear!=true&&b.clearRect(0,0,d,h);e.render(b);if(g){g=false;typeof f.opts.renderCallback=="function"&&f.opts.renderCallback(c)}},j=true;if(f.ImagesLoaded()){j=false;h()}f.intervalID=setInterval(function(){var b=
false;if(j&&f.ImagesLoaded()){j=false;b=true}f.opts.ignoreMouse!=true&&(b=b|f.Mouse.hasEvents());if(f.opts.ignoreAnimation!=true)for(var c=0;c<f.Animations.length;c++)b=b|f.Animations[c].update(1E3/f.FRAMERATE);typeof f.opts.forceRedraw=="function"&&f.opts.forceRedraw()==true&&(b=true);if(b){h();f.Mouse.runEvents()}},1E3/f.FRAMERATE)};f.stop=function(){f.intervalID&&clearInterval(f.intervalID)};f.Mouse=new function(){this.events=[];this.hasEvents=function(){return this.events.length!=0};this.onclick=
function(b,c){this.events.push({type:"onclick",x:b,y:c,run:function(b){if(b.onclick)b.onclick()}})};this.onmousemove=function(b,c){this.events.push({type:"onmousemove",x:b,y:c,run:function(b){if(b.onmousemove)b.onmousemove()}})};this.eventElements=[];this.checkPath=function(b,c){for(var d=0;d<this.events.length;d++){var e=this.events[d];c.isPointInPath&&c.isPointInPath(e.x,e.y)&&(this.eventElements[d]=b)}};this.checkBoundingBox=function(b,c){for(var d=0;d<this.events.length;d++){var e=this.events[d];
c.isPointInBox(e.x,e.y)&&(this.eventElements[d]=b)}};this.runEvents=function(){f.ctx.canvas.style.cursor="";for(var b=0;b<this.events.length;b++)for(var c=this.events[b],d=this.eventElements[b];d;){c.run(d);d=d.parent}this.events=[];this.eventElements=[]}};return f}var f=function(b,c,d){if(b==null&&c==null&&d==null){c=document.querySelectorAll("svg");for(b=0;b<c.length;b++){var d=c[b],g=document.createElement("canvas");g.width=d.clientWidth;g.height=d.clientHeight;d.parentNode.insertBefore(g,d);d.parentNode.removeChild(d);
var h=document.createElement("div");h.appendChild(d);f(g,h.innerHTML)}}else{typeof b=="string"&&(b=document.getElementById(b));b.svg!=null&&b.svg.stop();d=e(d||{});if(!(b.childNodes.length==1&&b.childNodes[0].nodeName=="OBJECT"))b.svg=d;b=b.getContext("2d");typeof c.documentElement!="undefined"?d.loadXmlDoc(b,c):c.substr(0,1)=="<"?d.loadXml(b,c):d.load(b,c)}},g;if(typeof Element.prototype.matches!="undefined")g=function(b,c){return b.matches(c)};else if(typeof Element.prototype.webkitMatchesSelector!=
"undefined")g=function(b,c){return b.webkitMatchesSelector(c)};else if(typeof Element.prototype.mozMatchesSelector!="undefined")g=function(b,c){return b.mozMatchesSelector(c)};else if(typeof Element.prototype.msMatchesSelector!="undefined")g=function(b,c){return b.msMatchesSelector(c)};else if(typeof Element.prototype.oMatchesSelector!="undefined")g=function(b,c){return b.oMatchesSelector(c)};else{if(typeof jQuery==="function"||typeof Zepto==="function")g=function(b,c){return $(b).is(c)};if(typeof g===
"undefined")g=Sizzle.matchesSelector}var h=/(\[[^\]]+\])/g,j=/(#[^\s\+>~\.\[:]+)/g,k=/(\.[^\s\+>~\.\[:]+)/g,l=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,m=/(:[\w-]+\([^\)]*\))/gi,n=/(:[^\s\+>~\.\[:]+)/g,q=/([^\s\+>~\.\[:]+)/g;if(typeof CanvasRenderingContext2D!="undefined")CanvasRenderingContext2D.prototype.drawSvg=function(b,c,d,e,g,h){var c={ignoreMouse:true,ignoreAnimation:true,ignoreDimensions:true,ignoreClear:true,offsetX:c,offsetY:d,scaleWidth:e,scaleHeight:g},j;for(j in h)h.hasOwnProperty(j)&&
(c[j]=h[j]);f(this.canvas,b,c)};return f});function fmod(b,c){return b%c}function sign(b){return b>0?1:-1}function smoothstep(b,c,d){if(d<b)return 0;if(d>c)return 1;b=(d-b)/(c-b);return b*b*(3-2*b)}function clamp(b,c,d){return b<c?c:b>d?d:b}function step(b,c){return c<b?0:1}function mix(b,c,d){return b+(c-b)*Math.min(Math.max(d,0),1)}function over(b,c){return 1-(1-b)*(1-c)}function tri(b,c){c=c/(2*Math.PI);c=c%1;c<0&&(c=1+c);return-1+2*(c<b?c/b:1-(c-b)/(1-b))}
function saw(b,c){var d=b%1;return d<c?d/c:1-(d-c)/(1-c)}function sqr(b,c){return c=Math.sin(c)>b?1:-1}function grad(b,c){var b=b<<13^b,d=c;b*(b*b*15731+789221)+1376312589&536870912&&(d=-c);return d}function noise(b){var c=Math.floor(b),d=b-c,b=d*d*d*(d*(d*6-15)+10),e=grad(c+0,d+0),c=grad(c+1,d-1);return e+(c-e)*b}function cellnoise(b){b=Math.floor(b);b=b<<13^b;return(b*(b*b*15731+789221)+1376312589>>14&65535)/65535}function frac(b){return b%1}
function SineGenerator(b){var c={alive:true},d=sampleRate/b,e=0;c.generate=function(b,c,h){for(;h;h--){var j=Math.sin(e/d*2*Math.PI);b[c++]+=j;b[c++]+=j;e++}};return c}function SquareGenerator(b,c){var d={alive:true},e=sampleRate/b,f=0;d.generate=function(b,d,j){for(;j;j--){var k=f/e%1>c?1:-1;b[d++]+=k;b[d++]+=k;f++}};return d}
function ADSRGenerator(b,c,d,e,f,g){var h={alive:true},j=sampleRate*e,k=sampleRate*(e+f),l=(c-d)/(k-j),m=null,n=null,q=d/(sampleRate*g),p=0;h.noteOff=function(){if(!h.released){m=p;h.released=true;n=m+sampleRate*g}};h.generate=function(e,f,g){if(h.alive){for(var t=Array(g*2),u=0;u<g*2;u++)t[u]=0;b.generate(t,0,g);for(childOffset=0;g;)if(m!=null)if(p<n)for(;g&&p<n;){u=d-q*(p-m);e[f++]+=t[childOffset++]*u;e[f++]+=t[childOffset++]*u;p++;g--}else{h.alive=false;break}else if(p<j)for(;g&&p<j;){u=c*p/j;
e[f++]+=t[childOffset++]*u;e[f++]+=t[childOffset++]*u;p++;g--}else if(p<k)for(;g&&p<k;){u=c-l*(p-j);e[f++]+=t[childOffset++]*u;e[f++]+=t[childOffset++]*u;p++;g--}else for(;g;){e[f++]+=t[childOffset++]*d;e[f++]+=t[childOffset++]*d;p++;g--}}};return h}function midiToFrequency(b){return 440*Math.pow(2,(b-69)/12)}
PianoProgram={attackAmplitude:0.2,sustainAmplitude:0.1,attackTime:0.02,decayTime:0.3,releaseTime:0.02,createNote:function(b,c){var d=midiToFrequency(b);return ADSRGenerator(SineGenerator(d),this.attackAmplitude*(c/128),this.sustainAmplitude*(c/128),this.attackTime,this.decayTime,this.releaseTime)}};StringProgram={createNote:function(b,c){var d=midiToFrequency(b);return ADSRGenerator(SineGenerator(d),0.5*(c/128),0.2*(c/128),0.4,0.8,0.4)}};
function Synth(b){function c(b,c,g){for(var h=g;h<g+b*2;h++)c[h]=0;for(h=d.length-1;h>=0;h--){d[h].generate(c,g,b);d[h].alive||d.splice(h,1)}}var d=[];return{sampleRate:b,addGenerator:function(b){d.push(b)},generate:function(b){var d=Array(b*2);c(b,d,0);return d},generateIntoBuffer:c}}
function AudioSynthGenerator(b,c){var d={alive:true,released:false,decayTime:0.3,releaseTime:1,endTime:null,_sampleRate:44100,_volume:1,_mod:[function(b,c,d,e){return 1*Math.sin(2*Math.PI*(b/c)*d+e)},function(b,c,d,e){return 1*Math.sin(2*Math.PI*b/c*d+e)},function(b,c,d,e){return 1*Math.sin(4*Math.PI*b/c*d+e)},function(b,c,d,e){return 1*Math.sin(8*Math.PI*b/c*d+e)},function(b,c,d,e){return 1*Math.sin(0.5*Math.PI*b/c*d+e)},function(b,c,d,e){return 1*Math.sin(0.25*Math.PI*b/c*d+e)},function(b,c,d,e){return 0.5*
Math.sin(2*Math.PI*b/c*d+e)},function(b,c,d,e){return 0.5*Math.sin(4*Math.PI*b/c*d+e)},function(b,c,d,e){return 0.5*Math.sin(8*Math.PI*b/c*d+e)},function(b,c,d,e){return 0.5*Math.sin(0.5*Math.PI*b/c*d+e)},function(b,c,d,e){return 0.5*Math.sin(0.25*Math.PI*b/c*d+e)}],_temp:{}},e=0,f=0;d.noteOff=function(){if(!d.released){d.released=true;d.endTime=f+d.releaseTime}};d.generate=function(g,h,j){for(var k=this._sampleRate,l=this._volume,m=b.attack(k,c,l),n=b.dampen(k,c,l),q=b.wave.bind({modulate:this._mod,
vars:this._temp}),p=0,p=0,s=e;e<=s+j;e++){p=e<=k*m?l*(e/(k*m)):l*Math.pow(1-(e-k*m)/(k*(2-m)),n);p=p*Math.min(Math.max(q(e,k,c,l),-1),1);g[h++]=p;g[h++]=p;f=f+e/k}if(d.endTime&&f>d.endTime)d.alive=false};return d}
AudioSynthPianoProgram={createNote:function(b,c){var d=midiToFrequency(b);return AudioSynthGenerator({name:"piano",attack:function(){return 0.002},dampen:function(b,c,d){return Math.pow(0.5*Math.log(c*d/b),2)},wave:function(b,c,d){var h=this.modulate[0];return this.modulate[1](b,c,d,Math.pow(h(b,c,d,0),2)+0.75*h(b,c,d,0.25)+0.1*h(b,c,d,0.5))}},d,c)}};
AudioSynthOrganProgram={createNote:function(b,c){var d=midiToFrequency(b);return AudioSynthGenerator({name:"organ",attack:function(){return 0.3},dampen:function(b,c){return 1+c*0.01},wave:function(b,c,d){var h=this.modulate[0];return this.modulate[1](b,c,d,h(b,c,d,0)+0.5*h(b,c,d,0.25)+0.25*h(b,c,d,0.5))}},d,c)}};
AudioSynthAcousticProgram={createNote:function(b,c){var d=midiToFrequency(b);return AudioSynthGenerator({name:"acoustic",attack:function(){return 0.002},dampen:function(){return 1},wave:function(b,c,d){b=this.vars;b.valueTable=!b.valueTable?[]:b.valueTable;if(typeof b.playVal=="undefined")b.playVal=0;if(typeof b.periodCount=="undefined")b.periodCount=0;var h=b.valueTable,j=b.playVal,k=b.periodCount,d=c/d,l=Math.floor((d-Math.floor(d))*100),c=false;if(h.length<=Math.ceil(d)){h.push(Math.round(Math.random())*
2-1);return h[h.length-1]}h[j]=(h[j>=h.length-1?0:j+1]+h[j])*0.5;if(j>=Math.floor(d))if(j<Math.ceil(d)){if(k%100>=l){c=true;h[j+1]=(h[0]+h[j+1])*0.5;b.periodCount++}}else c=true;h=h[j];c?b.playVal=0:b.playVal++;return h}},d,c)}};
AudioSynthEDMProgram={createNote:function(b,c){var d=midiToFrequency(b);return AudioSynthGenerator({name:"edm",attack:function(){return 0.002},dampen:function(){return 1},wave:function(b,c,d){var h=this.modulate[0],j=this.modulate.slice(1);return j[0](b,c,d,j[9](b,c,d,j[2](b,c,d,Math.pow(h(b,c,d,0),3)+Math.pow(h(b,c,d,0.5),5)+Math.pow(h(b,c,d,1),7)))+j[8](b,c,d,h(b,c,d,1.75)))}},d,c)}};
function SoundToyGenerator(b,c){var d={alive:true,released:false,endTime:null,releaseTime:1},e=0,f=0;d.noteOff=function(){if(!d.released){d.released=true;d.endTime=f+d.releaseTime}};d.generate=function(g,h,j){for(var k=e;e<k+j;e++){f=e/44100;var l=b(2*Math.PI*c,f);g[h++]+=l;g[h++]+=l}if(d.endTime&&f>d.endTime)d.alive=false};return d}
function SoundToyPiano1Function(b,c){var d=0.6*Math.sin(1*b*c)*Math.exp(-8.0E-4*b*c),d=d+0.3*Math.sin(2*b*c)*Math.exp(-0.001*b*c),d=d+0.1*Math.sin(4*b*c)*Math.exp(-0.0015*b*c),d=(d+0.2*d*d*d)*(0.9+0.1*Math.cos(70*c));return d=2*d*Math.exp(-22*c)+d}
function SoundToyPiano2Function(b,c){var d=c=c+1.5E-4*noise(12*c),e;e=fmod(c*b*0.2,1);var f=50*e*(e-1)*(e-0.2)*(e-(0.15+0.6*d))*(e-(0.65-0.5*d));e=fmod(c*b*0.401,1);var g=50*e*(e-1)*(e-0.4)*(e-(0.12+0.65*d))*(e-(0.67-0.55*d));e=fmod(c*b*0.399,1);d=50*e*(e-1)*(e-0.8)*(e-(0.14+0.55*d))*(e-(0.66-0.65*d));f=f+0.02*noise(1E3*c);return(f/(c*b*0.0015+0.1)+g/(c*b*0.002+0.1)+d/(c*b*0.0025+0.1))/3}
function SoundToySpacePianoFunction(b,c){var d=1-c,e=Math.sin(c*b*0.5)*Math.log(c+0.3)*d,f=Math.sin(c*b)*c*0.4,g=fmod(d,0.075)*Math.cos(Math.pow(d,3)*b)*c*2;return(e+f+g)*d}
function SoundToyBellFunction(b,c){var d=0.1*Math.exp(-c/1)*Math.sin(0.56*b*c),d=d+0.067*Math.exp(-c/0.9)*Math.sin(0.56*b*c),d=d+0.1*Math.exp(-c/0.65)*Math.sin(0.92*b*c),d=d+0.18*Math.exp(-c/0.55)*Math.sin(0.92*b*c),d=d+0.267*Math.exp(-c/0.325)*Math.sin(1.19*b*c),d=d+0.167*Math.exp(-c/0.35)*Math.sin(1.7*b*c),d=d+0.146*Math.exp(-c/0.25)*Math.sin(2*b*c),d=d+0.133*Math.exp(-c/0.2)*Math.sin(2.74*b*c),d=d+0.133*Math.exp(-c/0.15)*Math.sin(3*b*c),d=d+0.1*Math.exp(-c/0.1)*Math.sin(3.76*b*c);return d=d+0.133*
Math.exp(-c/0.075)*Math.sin(4.07*b*c)}function SoundToyGuitarFunction(b,c){var d=Math.cos(0.251*b*c),e=0.5*Math.cos(1*b*c+3.14*d)*Math.exp(-7.0E-4*b*c),e=e+0.2*Math.cos(2*b*c+3.14*d)*Math.exp(-9.0E-4*b*c),e=e+0.2*Math.cos(4*b*c+3.14*d)*Math.exp(-0.0016*b*c),e=e+0.1*Math.cos(8*b*c+3.14*d)*Math.exp(-0.002*b*c),e=e*(0.9+0.1*Math.cos(70*c));return e=2*e*Math.exp(-22*c)+e}function SoundToyFluteFunction(b,c){var d=6*c*Math.exp(-2*c)*Math.sin(b*c);return d=d*(0.8+0.2*Math.cos(16*c))}
function SoundToyRhythmFunction(b,c){var d=fmod(c,0.5),e=0.2*noise(32E3*d)*Math.exp(-32*d),e=e+1*noise(3200*d)*Math.exp(-32*d),e=e+7*Math.cos(320-100*Math.exp(-10*d))*Math.exp(-4*d),d=fmod(c+0.15,1),e=e+0.5*noise(32E3*d)*Math.exp(-64*d),d=fmod(c+0.25,1),e=e+1*noise(32E3*d)*Math.exp(-32*d),c=c+0.25,f=sign(Math.sin(3.14155*c)),d=fmod(c,0.5),e=e+2*Math.cos(6.2831*(105+11*f)*c)*Math.exp(-6*d),d=fmod(c,0.125)/0.125,e=e+1.4*noise(320*d)*Math.exp(-32*d),f=c+0.05*Math.cos(c*6.2831),d=fmod(f,0.018)/0.018,
f=0.5+0.4*Math.cos(6.2831*f),d=saw(d,f),d=-1+2*d;return(e+d*d*d*1.5)*0.6}function SoundToyDrum1Function(b,c){return Math.max(-1,Math.min(1,8*Math.sin(3E3*c*Math.exp(-6*c))))}function SoundToyDrum2Function(b,c){var d=0.5*noise(32E3*c)*Math.exp(-32*c),d=d+2*noise(3200*c)*Math.exp(-32*c);return d=d+3*Math.cos(400*(1-c)*c)*Math.exp(-4*c)}function SoundToyDrum3Function(b,c){var d=Math.sin((1E3-2500*c)*c),d=d+0.2*Math.random(),d=d*Math.exp(-12*c);return d*8}
function SoundToyOrgan1Function(b,c){var d=0.6*Math.cos(b*c)*Math.exp(-4*c),d=d+0.4*Math.cos(2*b*c)*Math.exp(-3*c),d=d+0.01*Math.cos(4*b*c)*Math.exp(-1*c),d=d*d*d+d*d*d*d*d+d*d,e=0.5+0.5*Math.cos(8*c),d=Math.sin(d*e*3.14);return d=d*30*c*Math.exp(-0.1*c)}function SoundToyOrgan2Function(b,c){var d=fmod(c,6.2831/b)*b/6.2831;a=0.7+0.3*Math.cos(6.2831*c);y=-1+2*saw(d,a);y=y*y*y;return y=15*y*c*Math.exp(-5*c)}
function SoundToyOrgan3Function(b,c){var d=0.5+0.5*Math.cos(0+c*12),e=0.5+0.5*Math.cos(1+c*8),f=0.5+0.5*Math.cos(2+c*4),d=saw(0.25*b*c,d)*Math.exp(-2*c),d=d+saw(0.125*b*c,e)*Math.exp(-3*c),d=d+saw(0.0625*b*c,f)*Math.exp(-4*c);return d=d*(0.8+0.2*Math.cos(64*c))}
function SoundToyOrgan4Function(b,c){var d=0.001*Math.cos(5*c),e=1*(saw((1+d)*0.1*b*c,1)-0.5),e=e+0.7*(saw((2.01+d)*0.1*b*c,1)-0.5),e=e+0.5*(saw((4.02+d)*0.1*b*c,1)-0.5),e=e+0.2*(saw((8.02+d)*0.1*b*c,1)-0.5),e=e*20*c*Math.exp(-4*c);return e=e*(0.9+0.1*Math.cos(40*c))}
function SoundToyFM1Function(b,c){var d=Math.sin(12*Math.sin(0.5*b*c)+Math.sin(8*Math.sin(0.15*b*c))),e=(d*d-1.05)*Math.sin(0.005*b*c),f=0.5*Math.random()*Math.log(8*c),d=0.3333*(d+e+f)*3*Math.exp(-1*c)*Math.exp(-2*c),d=Math.exp(2*d);return(d-1)/(d+1)}
function SoundToyFM2Function(b,c){var d=Math.sin(Math.sin(0.2*b*c)-Math.tan(0.5*b*c)),e=Math.sin(Math.sin(0.2*b*c)+Math.sin(2*b*c)),f=Math.sin(Math.sin(0.4*b*c)-Math.sin(2*b*c)),g=1.2*Math.random(),d=0.25*(d+e+f+g),d=(0.25+Math.sin(0.005*b*c))*Math.sin(d*c),d=d*Math.exp(-4*c)*Math.exp(-1.5*c)*40,d=Math.exp(2*d);return(d-1)/(d+1)}function SoundToyFM3Function(b,c){var d=0,e=Math.tan(0.025*b*c)+2*Math.sin(b*c)+Math.random(),e=Math.sin(e*c),f=-0.93*c,d=Math.exp(2*((1-f)*e+f*d));return(d-1)/(d+1)}
SoundToyPiano1Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyPiano1Function,d,c)}};SoundToyPiano2Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyPiano2Function,d,c)}};SoundToySpacePianoProgram={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToySpacePianoFunction,d,c)}};
SoundToyBellProgram={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyBellFunction,d,c)}};SoundToyGuitarProgram={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyGuitarFunction,d,c)}};SoundToyFluteProgram={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyFluteFunction,d,c)}};SoundToyRythmProgram={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyRhythmFunction,d,c)}};
SoundToyDrum1Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyDrum1Function,d,c)}};SoundToyDrum2Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyDrum2Function,d,c)}};SoundToyDrum3Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyDrum3Function,d,c)}};
SoundToyOrgan1Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyOrgan1Function,d,c)}};SoundToyOrgan2Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyOrgan2Function,d,c)}};SoundToyOrgan3Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyOrgan3Function,d,c)}};
SoundToyOrgan4Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyOrgan4Function,d,c)}};SoundToyFM1Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyFM1Function,d,c)}};SoundToyFM2Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyFM2Function,d,c)}};SoundToyFM3Program={createNote:function(b,c){var d=midiToFrequency(b);return SoundToyGenerator(SoundToyFM3Function,d,c)}};
PROGRAMS={41:StringProgram,42:StringProgram,43:StringProgram,44:StringProgram,45:StringProgram,46:StringProgram,47:StringProgram,49:StringProgram,50:StringProgram};PROGRAMS[1]=AudioSynthPianoProgram;PROGRAMS[2]=PianoProgram;PROGRAMS[4]=SoundToyPiano1Program;PROGRAMS[5]=SoundToyPiano2Program;PROGRAMS[6]=SoundToySpacePianoProgram;PROGRAMS[17]=AudioSynthOrganProgram;PROGRAMS[18]=SoundToyOrgan1Program;PROGRAMS[19]=SoundToyOrgan2Program;PROGRAMS[20]=SoundToyOrgan3Program;PROGRAMS[21]=SoundToyOrgan4Program;
PROGRAMS[25]=AudioSynthAcousticProgram;PROGRAMS[27]=SoundToyGuitarProgram;PROGRAMS[43]=StringProgram;PROGRAMS[74]=SoundToyFluteProgram;PROGRAMS[90]=AudioSynthEDMProgram;PROGRAMS[91]=SoundToyRythmProgram;PROGRAMS[92]=SoundToyFM1Program;PROGRAMS[93]=SoundToyFM2Program;PROGRAMS[94]=SoundToyFM3Program;PROGRAMS[113]=SoundToyBellProgram;PROGRAMS[115]=SoundToyDrum1Program;PROGRAMS[116]=SoundToyDrum3Program;PROGRAMS[119]=SoundToyDrum2Program;for(i=0;128>i;i++)null==PROGRAMS[i]&&(PROGRAMS[i]=AudioSynthPianoProgram);
var sampleRate=44100;
function AudioPlayer(b,c){c||(c={});var d=c.latency||1,e=d*100,f=new Audio,g=window.AudioContext||window.webkitAudioContext,h=false;if(f.mozSetup){f.mozSetup(2,sampleRate);var j=[],k=d*2*sampleRate,l=Math.floor(d*sampleRate),m=function(){if(j.length){var c=f.mozWriteAudio(j);j=j.slice(c)}j.length<k&&!b.finished&&(j=j.concat(b.generate(l)));!h&&(!b.finished||j.length)&&setTimeout(m,e)};m();return{type:"Firefox Audio",stop:function(){h=true}}}if(g){d=new g;sampleRate=d.sampleRate;var n;n=d.createScriptProcessor?
d.createScriptProcessor(4096,0,2):d.createJavaScriptNode(4096,0,2);n.onaudioprocess=function(c){if(b.finished)n.disconnect();else for(var d=c.outputBuffer.getChannelData(0),c=c.outputBuffer.getChannelData(1),e=b.generate(4096),f=0;f<4096;++f){d[f]=e[f*2];c[f]=e[f*2+1]}};n.connect(d.destination);return{stop:function(){n.disconnect();h=true},type:"Webkit Audio"}}g=document.createElement("div");g.innerHTML='<embed type="application/x-shockwave-flash" id="da-swf" src="/ext/midi/da.swf" width="8" height="8" allowScriptAccess="always" style="position: fixed; left:-10px;" />';
document.body.appendChild(g);var q=document.getElementById("da-swf"),p=d*1E3,l=d*sampleRate,m=function(){if(q.bufferedDuration()<p){for(var c=b.generate(l),d=Array(c.length),f=c.length-1;f!=0;f--)d[f]=Math.floor(c[f]*32768);q.write(d.join(" "))}!h&&!b.finished&&setTimeout(m,e)},s=function(){q.write?m():setTimeout(s,10)};s();return{stop:function(){q.stop();h=true},bufferedDuration:function(){return q.bufferedDuration()},type:"Flash Audio"}}
var spine={radDeg:180/Math.PI,degRad:Math.PI/180,temp:[],Float32Array:"undefined"===typeof Float32Array?Array:Float32Array,Uint16Array:"undefined"===typeof Uint16Array?Array:Uint16Array,BoneData:function(b,c){this.name=b;this.parent=c}};spine.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:!0,inheritRotation:!0,flipX:!1,flipY:!1};spine.BlendMode={normal:0,additive:1,multiply:2,screen:3};spine.SlotData=function(b,c){this.name=b;this.boneData=c};
spine.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,blendMode:spine.BlendMode.normal};spine.IkConstraintData=function(b){this.name=b;this.bones=[]};spine.IkConstraintData.prototype={target:null,bendDirection:1,mix:1};spine.Bone=function(b,c,d){this.data=b;this.skeleton=c;this.parent=d;this.setToSetupPose()};spine.Bone.yDown=!1;
spine.Bone.prototype={x:0,y:0,rotation:0,rotationIK:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,worldFlipX:!1,worldFlipY:!1,updateWorldTransform:function(){var b=this.parent;if(b){this.worldX=this.x*b.m00+this.y*b.m01+b.worldX;this.worldY=this.x*b.m10+this.y*b.m11+b.worldY;if(this.data.inheritScale){this.worldScaleX=b.worldScaleX*this.scaleX;this.worldScaleY=b.worldScaleY*this.scaleY}else{this.worldScaleX=this.scaleX;
this.worldScaleY=this.scaleY}this.worldRotation=this.data.inheritRotation?b.worldRotation+this.rotationIK:this.rotationIK;this.worldFlipX=b.worldFlipX!=this.flipX;this.worldFlipY=b.worldFlipY!=this.flipY}else{var b=this.skeleton.flipX,c=this.skeleton.flipY;this.worldX=b?-this.x:this.x;this.worldY=c!=spine.Bone.yDown?-this.y:this.y;this.worldScaleX=this.scaleX;this.worldScaleY=this.scaleY;this.worldRotation=this.rotationIK;this.worldFlipX=b!=this.flipX;this.worldFlipY=c!=this.flipY}c=this.worldRotation*
spine.degRad;b=Math.cos(c);c=Math.sin(c);if(this.worldFlipX){this.m00=-b*this.worldScaleX;this.m01=c*this.worldScaleY}else{this.m00=b*this.worldScaleX;this.m01=-c*this.worldScaleY}if(this.worldFlipY!=spine.Bone.yDown){this.m10=-c*this.worldScaleX;this.m11=-b*this.worldScaleY}else{this.m10=c*this.worldScaleX;this.m11=b*this.worldScaleY}},setToSetupPose:function(){var b=this.data;this.x=b.x;this.y=b.y;this.rotationIK=this.rotation=b.rotation;this.scaleX=b.scaleX;this.scaleY=b.scaleY;this.flipX=b.flipX;
this.flipY=b.flipY},worldToLocal:function(b){var c=b[0]-this.worldX,d=b[1]-this.worldY,e=this.m00,f=this.m10,g=this.m01,h=this.m11;if(this.worldFlipX!=(this.worldFlipY!=spine.Bone.yDown)){e=-e;h=-h}var j=1/(e*h-g*f);b[0]=c*e*j-d*g*j;b[1]=d*h*j-c*f*j},localToWorld:function(b){var c=b[0],d=b[1];b[0]=c*this.m00+d*this.m01+this.worldX;b[1]=c*this.m10+d*this.m11+this.worldY}};spine.Slot=function(b,c){this.data=b;this.bone=c;this.setToSetupPose()};
spine.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,attachmentVertices:[],setAttachment:function(b){this.attachment=b;this._attachmentTime=this.bone.skeleton.time;this.attachmentVertices.length=0},setAttachmentTime:function(b){this._attachmentTime=this.bone.skeleton.time-b},getAttachmentTime:function(){return this.bone.skeleton.time-this._attachmentTime},setToSetupPose:function(){var b=this.data;this.r=b.r;this.g=b.g;this.b=b.b;this.a=b.a;for(var c=this.bone.skeleton.data.slots,
d=0,e=c.length;d<e;d++)if(c[d]==b){this.setAttachment(!b.attachmentName?null:this.bone.skeleton.getAttachmentBySlotIndex(d,b.attachmentName));break}}};spine.IkConstraint=function(b,c){this.data=b;this.mix=b.mix;this.bendDirection=b.bendDirection;this.bones=[];for(var d=0,e=b.bones.length;d<e;d++)this.bones.push(c.findBone(b.bones[d].name));this.target=c.findBone(b.target.name)};
spine.IkConstraint.prototype={apply:function(){var b=this.target,c=this.bones;switch(c.length){case 1:spine.IkConstraint.apply1(c[0],b.worldX,b.worldY,this.mix);break;case 2:spine.IkConstraint.apply2(c[0],c[1],b.worldX,b.worldY,this.bendDirection,this.mix)}}};
spine.IkConstraint.apply1=function(b,c,d,e){var f=!b.data.inheritRotation||!b.parent?0:b.parent.worldRotation,g=b.rotation,c=Math.atan2(d-b.worldY,c-b.worldX)*spine.radDeg;b.worldFlipX!=(b.worldFlipY!=spine.Bone.yDown)&&(c=-c);b.rotationIK=g+(c-f-g)*e};
spine.IkConstraint.apply2=function(b,c,d,e,f,g){var h=c.rotation,j=b.rotation;if(g){var k,l,m=spine.temp;if(k=b.parent){m[0]=d;m[1]=e;k.worldToLocal(m);d=(m[0]-b.x)*k.worldScaleX;e=(m[1]-b.y)*k.worldScaleY}else{d=d-b.x;e=e-b.y}if(c.parent==b){k=c.x;l=c.y}else{m[0]=c.x;m[1]=c.y;c.parent.localToWorld(m);b.worldToLocal(m);k=m[0];l=m[1]}m=k*b.worldScaleX;l=l*b.worldScaleY;k=Math.atan2(l,m);l=Math.sqrt(m*m+l*l);var m=c.data.length*c.worldScaleX,n=2*l*m;if(n<1.0E-4)c.rotationIK=h+(Math.atan2(e,d)*spine.radDeg-
j-h)*g;else{n=(d*d+e*e-l*l-m*m)/n;n<-1?n=-1:n>1&&(n=1);f=Math.acos(n)*f;l=l+m*n;m=m*Math.sin(f);d=(Math.atan2(e*l-d*m,d*l+e*m)-k)*spine.radDeg-j;d>180?d=d-360:d<-180&&(d=d+360);b.rotationIK=j+d*g;d=(f+k)*spine.radDeg-h;d>180?d=d-360:d<-180&&(d=d+360);c.rotationIK=h+(d+b.worldRotation-c.parent.worldRotation)*g}}else{c.rotationIK=h;b.rotationIK=j}};spine.Skin=function(b){this.name=b;this.attachments={}};
spine.Skin.prototype={addAttachment:function(b,c,d){this.attachments[b+":"+c]=d},getAttachment:function(b,c){return this.attachments[b+":"+c]},_attachAll:function(b,c){for(var d in c.attachments){var e=d.indexOf(":"),f=parseInt(d.substring(0,e)),g=d.substring(e+1),e=b.slots[f];if(e.attachment&&e.attachment.name==g)(f=this.getAttachment(f,g))&&e.setAttachment(f)}}};spine.Animation=function(b,c,d){this.name=b;this.timelines=c;this.duration=d};
spine.Animation.prototype={apply:function(b,c,d,e,f){if(e&&this.duration!=0){d=d%this.duration;c=c%this.duration}for(var e=this.timelines,g=0,h=e.length;g<h;g++)e[g].apply(b,c,d,f,1)},mix:function(b,c,d,e,f,g){if(e&&this.duration!=0){d=d%this.duration;c=c%this.duration}for(var e=this.timelines,h=0,j=e.length;h<j;h++)e[h].apply(b,c,d,f,g)}};
spine.Animation.binarySearch=function(b,c,d){var e=0,f=Math.floor(b.length/d)-2;if(!f)return d;for(var g=f>>>1;;){b[(g+1)*d]<=c?e=g+1:f=g;if(e==f)return(e+1)*d;g=e+f>>>1}};spine.Animation.binarySearch1=function(b,c){var d=0,e=b.length-2;if(!e)return 1;for(var f=e>>>1;;){b[f+1]<=c?d=f+1:e=f;if(d==e)return d+1;f=d+e>>>1}};spine.Animation.linearSearch=function(b,c,d){for(var e=0,f=b.length-d;e<=f;e=e+d)if(b[e]>c)return e;return-1};spine.Curves=function(){this.curves=[]};
spine.Curves.prototype={setLinear:function(b){this.curves[b*19]=0},setStepped:function(b){this.curves[b*19]=1},setCurve:function(b,c,d,e,f){var g=0.1*0.1,h=g*0.1,j=3*0.1,k=3*g,l=6*g,g=6*h,m=-c*2+e,n=-d*2+f,e=(c-e)*3+1,f=(d-f)*3+1,c=c*j+m*k+e*h,d=d*j+n*k+f*h,h=m*l+e*g,l=n*l+f*g,n=e*g,g=f*g,b=b*19,e=this.curves;e[b++]=2;f=c;j=d;for(k=b+19-1;b<k;b=b+2){e[b]=f;e[b+1]=j;c=c+h;d=d+l;h=h+n;l=l+g;f=f+c;j=j+d}},getCurvePercent:function(b,c){var c=c<0?0:c>1?1:c,d=this.curves,e=b*19,f=d[e];if(f===0)return c;
if(f==1)return 0;e++;for(var f=0,g=e,h=e+19-1;e<h;e=e+2){f=d[e];if(f>=c){if(e==g)h=g=0;else{g=d[e-2];h=d[e-1]}return h+(d[e+1]-h)*(c-g)/(f-g)}}d=d[e-1];return d+(1-d)*(c-f)/(1-f)}};spine.RotateTimeline=function(b){this.curves=new spine.Curves(b);this.frames=[];this.frames.length=b*2};
spine.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(b,c,d){b=b*2;this.frames[b]=c;this.frames[b+1]=d},apply:function(b,c,d,e,f){c=this.frames;if(!(d<c[0])){b=b.bones[this.boneIndex];if(d>=c[c.length-2])c=b.data.rotation+c[c.length-1]-b.rotation;else{for(var g=spine.Animation.binarySearch(c,d,2),e=c[g-1],h=c[g],d=1-(d-h)/(c[g-2]-h),d=this.curves.getCurvePercent(g/2-1,d),c=c[g+1]-e;c>180;)c=c-360;for(;c<-180;)c=c+360;c=b.data.rotation+
(e+c*d)-b.rotation}for(;c>180;)c=c-360;for(;c<-180;)c=c+360;b.rotation=b.rotation+c*f}}};spine.TranslateTimeline=function(b){this.curves=new spine.Curves(b);this.frames=[];this.frames.length=b*3};
spine.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(b,c,d,e){b=b*3;this.frames[b]=c;this.frames[b+1]=d;this.frames[b+2]=e},apply:function(b,c,d,e,f){c=this.frames;if(!(d<c[0])){b=b.bones[this.boneIndex];if(d>=c[c.length-3]){b.x=b.x+(b.data.x+c[c.length-2]-b.x)*f;b.y=b.y+(b.data.y+c[c.length-1]-b.y)*f}else{var e=spine.Animation.binarySearch(c,d,3),g=c[e-2],h=c[e-1],j=c[e],d=1-(d-j)/(c[e+-3]-j),d=this.curves.getCurvePercent(e/3-1,d);
b.x=b.x+(b.data.x+g+(c[e+1]-g)*d-b.x)*f;b.y=b.y+(b.data.y+h+(c[e+2]-h)*d-b.y)*f}}}};spine.ScaleTimeline=function(b){this.curves=new spine.Curves(b);this.frames=[];this.frames.length=b*3};
spine.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(b,c,d,e){b=b*3;this.frames[b]=c;this.frames[b+1]=d;this.frames[b+2]=e},apply:function(b,c,d,e,f){c=this.frames;if(!(d<c[0])){b=b.bones[this.boneIndex];if(d>=c[c.length-3]){b.scaleX=b.scaleX+(b.data.scaleX*c[c.length-2]-b.scaleX)*f;b.scaleY=b.scaleY+(b.data.scaleY*c[c.length-1]-b.scaleY)*f}else{var e=spine.Animation.binarySearch(c,d,3),g=c[e-2],h=c[e-1],j=c[e],d=1-(d-j)/(c[e+-3]-j),d=
this.curves.getCurvePercent(e/3-1,d);b.scaleX=b.scaleX+(b.data.scaleX*(g+(c[e+1]-g)*d)-b.scaleX)*f;b.scaleY=b.scaleY+(b.data.scaleY*(h+(c[e+2]-h)*d)-b.scaleY)*f}}}};spine.ColorTimeline=function(b){this.curves=new spine.Curves(b);this.frames=[];this.frames.length=b*5};
spine.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(b,c,d,e,f,g){b=b*5;this.frames[b]=c;this.frames[b+1]=d;this.frames[b+2]=e;this.frames[b+3]=f;this.frames[b+4]=g},apply:function(b,c,d,e,f){c=this.frames;if(!(d<c[0])){var g,h;if(d>=c[c.length-5]){e=c.length-1;d=c[e-3];g=c[e-2];h=c[e-1];c=c[e]}else{var e=spine.Animation.binarySearch(c,d,5),j=c[e-4];g=c[e-3];h=c[e-2];var k=c[e-1],l=c[e],l=1-(d-l)/(c[e-5]-l),l=this.curves.getCurvePercent(e/
5-1,l),d=j+(c[e+1]-j)*l;g=g+(c[e+2]-g)*l;h=h+(c[e+3]-h)*l;c=k+(c[e+4]-k)*l}b=b.slots[this.slotIndex];if(f<1){b.r=b.r+(d-b.r)*f;b.g=b.g+(g-b.g)*f;b.b=b.b+(h-b.b)*f;b.a=b.a+(c-b.a)*f}else{b.r=d;b.g=g;b.b=h;b.a=c}}}};spine.AttachmentTimeline=function(b){this.curves=new spine.Curves(b);this.frames=[];this.frames.length=b;this.attachmentNames=[];this.attachmentNames.length=b};
spine.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(b,c,d){this.frames[b]=c;this.attachmentNames[b]=d},apply:function(b,c,d){var e=this.frames;if(d<e[0])c>d&&this.apply(b,c,Number.MAX_VALUE,null,0);else{c>d&&(c=-1);d=d>=e[e.length-1]?e.length-1:spine.Animation.binarySearch1(e,d)-1;if(!(e[d]<c)){c=this.attachmentNames[d];b.slots[this.slotIndex].setAttachment(!c?null:b.getAttachmentBySlotIndex(this.slotIndex,c))}}}};
spine.EventTimeline=function(b){this.frames=[];this.frames.length=b;this.events=[];this.events.length=b};
spine.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(b,c,d){this.frames[b]=c;this.events[b]=d},apply:function(b,c,d,e,f){if(e){var g=this.frames,h=g.length;if(c>d){this.apply(b,c,Number.MAX_VALUE,e,f);c=-1}else if(c>=g[h-1])return;if(!(d<g[0])){if(c<g[0])b=0;else{b=spine.Animation.binarySearch1(g,c);for(c=g[b];b>0;){if(g[b-1]!=c)break;b--}}for(c=this.events;b<h&&d>=g[b];b++)e.push(c[b])}}}};
spine.DrawOrderTimeline=function(b){this.frames=[];this.frames.length=b;this.drawOrders=[];this.drawOrders.length=b};
spine.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(b,c,d){this.frames[b]=c;this.drawOrders[b]=d},apply:function(b,c,d){c=this.frames;if(!(d<c[0])){var e;e=d>=c[c.length-1]?c.length-1:spine.Animation.binarySearch1(c,d)-1;d=b.drawOrder;c=b.slots;if(e=this.drawOrders[e]){f=0;for(g=e.length;f<g;f++)d[f]=b.slots[e[f]]}else for(var f=0,g=c.length;f<g;f++)d[f]=c[f]}}};
spine.FfdTimeline=function(b){this.curves=new spine.Curves(b);this.frames=[];this.frames.length=b;this.frameVertices=[];this.frameVertices.length=b};
spine.FfdTimeline.prototype={slotIndex:0,attachment:0,getFrameCount:function(){return this.frames.length},setFrame:function(b,c,d){this.frames[b]=c;this.frameVertices[b]=d},apply:function(b,c,d,e,f){c=b.slots[this.slotIndex];if(c.attachment==this.attachment){var g=this.frames;if(!(d<g[0])){e=this.frameVertices;b=e[0].length;c=c.attachmentVertices;c.length!=b&&(f=1);c.length=b;if(d>=g[g.length-1]){d=e[g.length-1];if(f<1)for(e=0;e<b;e++)c[e]=c[e]+(d[e]-c[e])*f;else for(e=0;e<b;e++)c[e]=d[e]}else{var h=
spine.Animation.binarySearch1(g,d),j=g[h],d=1-(d-j)/(g[h-1]-j),d=this.curves.getCurvePercent(h-1,d<0?0:d>1?1:d),g=e[h-1],h=e[h];if(f<1)for(e=0;e<b;e++){j=g[e];c[e]=c[e]+(j+(h[e]-j)*d-c[e])*f}else for(e=0;e<b;e++){j=g[e];c[e]=j+(h[e]-j)*d}}}}}};spine.IkConstraintTimeline=function(b){this.curves=new spine.Curves(b);this.frames=[];this.frames.length=b*3};
spine.IkConstraintTimeline.prototype={ikConstraintIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(b,c,d,e){b=b*3;this.frames[b]=c;this.frames[b+1]=d;this.frames[b+2]=e},apply:function(b,c,d,e,f){c=this.frames;if(!(d<c[0])){b=b.ikConstraints[this.ikConstraintIndex];if(d>=c[c.length-3]){b.mix=b.mix+(c[c.length-2]-b.mix)*f;b.bendDirection=c[c.length-1]}else{var e=spine.Animation.binarySearch(c,d,3),g=c[e+-2],h=c[e],d=1-(d-h)/(c[e+-3]-h),d=this.curves.getCurvePercent(e/
3-1,d);b.mix=b.mix+(g+(c[e+1]-g)*d-b.mix)*f;b.bendDirection=c[e+-1]}}}};spine.FlipXTimeline=function(b){this.curves=new spine.Curves(b);this.frames=[];this.frames.length=b*2};
spine.FlipXTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(b,c,d){b=b*2;this.frames[b]=c;this.frames[b+1]=d?1:0},apply:function(b,c,d){var e=this.frames;if(d<e[0])c>d&&this.apply(b,c,Number.MAX_VALUE,null,0);else{c>d&&(c=-1);d=(d>=e[e.length-2]?e.length:spine.Animation.binarySearch(e,d,2))-2;if(!(e[d]<c))b.bones[this.boneIndex].flipX=e[d+1]!=0}}};
spine.FlipYTimeline=function(b){this.curves=new spine.Curves(b);this.frames=[];this.frames.length=b*2};
spine.FlipYTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(b,c,d){b=b*2;this.frames[b]=c;this.frames[b+1]=d?1:0},apply:function(b,c,d){var e=this.frames;if(d<e[0])c>d&&this.apply(b,c,Number.MAX_VALUE,null,0);else{c>d&&(c=-1);d=(d>=e[e.length-2]?e.length:spine.Animation.binarySearch(e,d,2))-2;if(!(e[d]<c))b.bones[this.boneIndex].flipY=e[d+1]!=0}}};
spine.SkeletonData=function(){this.bones=[];this.slots=[];this.skins=[];this.events=[];this.animations=[];this.ikConstraints=[]};
spine.SkeletonData.prototype={name:null,defaultSkin:null,width:0,height:0,version:null,hash:null,findBone:function(b){for(var c=this.bones,d=0,e=c.length;d<e;d++)if(c[d].name==b)return c[d];return null},findBoneIndex:function(b){for(var c=this.bones,d=0,e=c.length;d<e;d++)if(c[d].name==b)return d;return-1},findSlot:function(b){for(var c=this.slots,d=0,e=c.length;d<e;d++)if(c[d].name==b)return slot[d];return null},findSlotIndex:function(b){for(var c=this.slots,d=0,e=c.length;d<e;d++)if(c[d].name==
b)return d;return-1},findSkin:function(b){for(var c=this.skins,d=0,e=c.length;d<e;d++)if(c[d].name==b)return c[d];return null},findEvent:function(b){for(var c=this.events,d=0,e=c.length;d<e;d++)if(c[d].name==b)return c[d];return null},findAnimation:function(b){for(var c=this.animations,d=0,e=c.length;d<e;d++)if(c[d].name==b)return c[d];return null},findIkConstraint:function(b){for(var c=this.ikConstraints,d=0,e=c.length;d<e;d++)if(c[d].name==b)return c[d];return null}};
spine.Skeleton=function(b){this.data=b;this.bones=[];for(var c=0,d=b.bones.length;c<d;c++){var e=b.bones[c],f=!e.parent?null:this.bones[b.bones.indexOf(e.parent)];this.bones.push(new spine.Bone(e,this,f))}this.slots=[];this.drawOrder=[];c=0;for(d=b.slots.length;c<d;c++){e=b.slots[c];f=this.bones[b.bones.indexOf(e.boneData)];e=new spine.Slot(e,f);this.slots.push(e);this.drawOrder.push(e)}this.ikConstraints=[];c=0;for(d=b.ikConstraints.length;c<d;c++)this.ikConstraints.push(new spine.IkConstraint(b.ikConstraints[c],
this));this.boneCache=[];this.updateCache()};
spine.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateCache:function(){var b=this.ikConstraints,c=b.length,d=c+1,e=this.boneCache;if(e.length>d)e.length=d;for(var f=0,g=e.length;f<g;f++)e[f].length=0;for(;e.length<d;)e[e.length]=[];var d=e[0],h=this.bones,f=0,g=h.length;a:for(;f<g;f++){var j=h[f],k=j;do{for(var l=0;l<c;l++)for(var m=b[l],n=m.bones[0],m=m.bones[m.bones.length-1];;){if(k==m){e[l].push(j);e[l+1].push(j);continue a}if(m==n)break;m=m.parent}k=k.parent}while(k);
d[d.length]=j}},updateWorldTransform:function(){for(var b=this.bones,c=0,d=b.length;c<d;c++){var e=b[c];e.rotationIK=e.rotation}c=0;for(b=this.boneCache.length-1;;){for(var d=this.boneCache[c],e=0,f=d.length;e<f;e++)d[e].updateWorldTransform();if(c==b)break;this.ikConstraints[c].apply();c++}},setToSetupPose:function(){this.setBonesToSetupPose();this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var b=this.bones,c=0,d=b.length;c<d;c++)b[c].setToSetupPose();b=this.ikConstraints;c=0;for(d=
b.length;c<d;c++){var e=b[c];e.bendDirection=e.data.bendDirection;e.mix=e.data.mix}},setSlotsToSetupPose:function(){for(var b=this.slots,c=this.drawOrder,d=0,e=b.length;d<e;d++){c[d]=b[d];b[d].setToSetupPose(d)}},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(b){for(var c=this.bones,d=0,e=c.length;d<e;d++)if(c[d].data.name==b)return c[d];return null},findBoneIndex:function(b){for(var c=this.bones,d=0,e=c.length;d<e;d++)if(c[d].data.name==b)return d;return-1},
findSlot:function(b){for(var c=this.slots,d=0,e=c.length;d<e;d++)if(c[d].data.name==b)return c[d];return null},findSlotIndex:function(b){for(var c=this.slots,d=0,e=c.length;d<e;d++)if(c[d].data.name==b)return d;return-1},setSkinByName:function(b){var c=this.data.findSkin(b);if(!c)throw"Skin not found: "+b;this.setSkin(c)},setSkin:function(b){if(b)if(this.skin)b._attachAll(this,this.skin);else for(var c=this.slots,d=0,e=c.length;d<e;d++){var f=c[d],g=f.data.attachmentName;if(g)(g=b.getAttachment(d,
g))&&f.setAttachment(g)}this.skin=b},getAttachmentBySlotName:function(b,c){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(b),c)},getAttachmentBySlotIndex:function(b,c){if(this.skin){var d=this.skin.getAttachment(b,c);if(d)return d}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(b,c):null},setAttachment:function(b,c){for(var d=this.slots,e=0,f=d.length;e<f;e++){var g=d[e];if(g.data.name==b){d=null;if(c){d=this.getAttachmentBySlotIndex(e,c);if(!d)throw"Attachment not found: "+
c+", for slot: "+b;}g.setAttachment(d);return}}throw"Slot not found: "+b;},findIkConstraint:function(b){for(var c=this.ikConstraints,d=0,e=c.length;d<e;d++)if(c[d].data.name==b)return c[d];return null},update:function(b){this.time=this.time+b}};spine.EventData=function(b){this.name=b};spine.EventData.prototype={intValue:0,floatValue:0,stringValue:null};spine.Event=function(b){this.data=b};spine.Event.prototype={intValue:0,floatValue:0,stringValue:null};
spine.AttachmentType={region:0,boundingbox:1,mesh:2,skinnedmesh:3};spine.RegionAttachment=function(b){this.name=b;this.offset=[];this.offset.length=8;this.uvs=[];this.uvs.length=8};
spine.RegionAttachment.prototype={type:spine.AttachmentType.region,x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(b,c,d,e,f){var g=this.uvs;if(f){g[2]=b;g[3]=e;g[4]=b;g[5]=c;g[6]=d;g[7]=c;g[0]=d;g[1]=e}else{g[0]=b;g[1]=e;g[2]=b;g[3]=c;g[4]=d;g[5]=c;g[6]=d;g[7]=e}},updateOffset:function(){var b=this.width/this.regionOriginalWidth*
this.scaleX,c=this.height/this.regionOriginalHeight*this.scaleY,d=-this.width/2*this.scaleX+this.regionOffsetX*b,e=-this.height/2*this.scaleY+this.regionOffsetY*c,f=d+this.regionWidth*b,b=e+this.regionHeight*c,b=f=e=d=0,c=this.rotation*spine.degRad,g=Math.cos(c),h=Math.sin(c),c=d*g+this.x,d=d*h,j=e*g+this.y,e=e*h,k=f*g+this.x,f=f*h,g=b*g+this.y,b=b*h,h=this.offset;h[0]=c-e;h[1]=j+d;h[2]=c-b;h[3]=g+d;h[4]=k-b;h[5]=g+f;h[6]=k-e;h[7]=j+f},computeVertices:function(b,c,d,e){var b=b+d.worldX,c=c+d.worldY,
f=d.m00,g=d.m01,h=d.m10,d=d.m11,j=this.offset;e[0]=j[0]*f+j[1]*g+b;e[1]=j[0]*h+j[1]*d+c;e[2]=j[2]*f+j[3]*g+b;e[3]=j[2]*h+j[3]*d+c;e[4]=j[4]*f+j[5]*g+b;e[5]=j[4]*h+j[5]*d+c;e[6]=j[6]*f+j[7]*g+b;e[7]=j[6]*h+j[7]*d+c}};spine.MeshAttachment=function(b){this.name=b};
spine.MeshAttachment.prototype={type:spine.AttachmentType.mesh,vertices:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var b=this.regionU2-this.regionU,c=this.regionV2-this.regionV,d=this.regionUVs.length;if(!this.uvs||this.uvs.length!=
d)this.uvs=new spine.Float32Array(d);if(this.regionRotate)for(var e=0;e<d;e=e+2){this.uvs[e]=this.regionU+this.regionUVs[e+1]*b;this.uvs[e+1]=this.regionV+c-this.regionUVs[e]*c}else for(e=0;e<d;e=e+2){this.uvs[e]=this.regionU+this.regionUVs[e]*b;this.uvs[e+1]=this.regionV+this.regionUVs[e+1]*c}},computeWorldVertices:function(b,c,d,e){var f=d.bone,b=b+f.worldX,c=c+f.worldY,g=f.m00,h=f.m01,j=f.m10,f=f.m11,k=this.vertices,l=k.length;if(d.attachmentVertices.length==l)k=d.attachmentVertices;for(d=0;d<
l;d=d+2){var m=k[d],n=k[d+1];e[d]=m*g+n*h+b;e[d+1]=m*j+n*f+c}}};spine.SkinnedMeshAttachment=function(b){this.name=b};
spine.SkinnedMeshAttachment.prototype={type:spine.AttachmentType.skinnedmesh,bones:null,weights:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var b=this.regionU2-this.regionU,c=this.regionV2-this.regionV,d=this.regionUVs.length;if(!this.uvs||
this.uvs.length!=d)this.uvs=new spine.Float32Array(d);if(this.regionRotate)for(var e=0;e<d;e=e+2){this.uvs[e]=this.regionU+this.regionUVs[e+1]*b;this.uvs[e+1]=this.regionV+c-this.regionUVs[e]*c}else for(e=0;e<d;e=e+2){this.uvs[e]=this.regionU+this.regionUVs[e]*b;this.uvs[e+1]=this.regionV+this.regionUVs[e+1]*c}},computeWorldVertices:function(b,c,d,e){var f=d.bone.skeleton.bones,g=this.weights,h=this.bones,j=0,k=0,l=0,m=0,n=h.length,q,p,s,r,o,t;if(d.attachmentVertices.length)for(var u=d.attachmentVertices;k<
n;j=j+2){p=q=0;for(d=h[k++]+k;k<d;k++,l=l+3,m=m+2){s=f[h[k]];r=g[l]+u[m];o=g[l+1]+u[m+1];t=g[l+2];q=q+(r*s.m00+o*s.m01+s.worldX)*t;p=p+(r*s.m10+o*s.m11+s.worldY)*t}e[j]=q+b;e[j+1]=p+c}else for(;k<n;j=j+2){p=q=0;for(d=h[k++]+k;k<d;k++,l=l+3){s=f[h[k]];r=g[l];o=g[l+1];t=g[l+2];q=q+(r*s.m00+o*s.m01+s.worldX)*t;p=p+(r*s.m10+o*s.m11+s.worldY)*t}e[j]=q+b;e[j+1]=p+c}}};spine.BoundingBoxAttachment=function(b){this.name=b;this.vertices=[]};
spine.BoundingBoxAttachment.prototype={type:spine.AttachmentType.boundingbox,computeWorldVertices:function(b,c,d,e){for(var b=b+d.worldX,c=c+d.worldY,f=d.m00,g=d.m01,h=d.m10,d=d.m11,j=this.vertices,k=0,l=j.length;k<l;k=k+2){var m=j[k],n=j[k+1];e[k]=m*f+n*g+b;e[k+1]=m*h+n*d+c}}};spine.AnimationStateData=function(b){this.skeletonData=b;this.animationToMixTime={}};
spine.AnimationStateData.prototype={defaultMix:0,setMixByName:function(b,c,d){var e=this.skeletonData.findAnimation(b);if(!e)throw"Animation not found: "+b;b=this.skeletonData.findAnimation(c);if(!b)throw"Animation not found: "+c;this.setMix(e,b,d)},setMix:function(b,c,d){this.animationToMixTime[b.name+":"+c.name]=d},getMix:function(b,c){var d=b.name+":"+c.name;return this.animationToMixTime.hasOwnProperty(d)?this.animationToMixTime[d]:this.defaultMix}};spine.TrackEntry=function(){};
spine.TrackEntry.prototype={next:null,previous:null,animation:null,loop:!1,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,mix:1,onStart:null,onEnd:null,onComplete:null,onEvent:null};spine.AnimationState=function(b){this.data=b;this.tracks=[];this.events=[]};
spine.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(b){for(var b=b*this.timeScale,c=0;c<this.tracks.length;c++){var d=this.tracks[c];if(d){d.time=d.time+b*d.timeScale;if(d.previous){var e=b*d.previous.timeScale;d.previous.time=d.previous.time+e;d.mixTime=d.mixTime+e}if(e=d.next){e.time=d.lastTime-e.delay;e.time>=0&&this.setCurrent(c,e)}else!d.loop&&d.lastTime>=d.endTime&&this.clearTrack(c)}}},apply:function(b){for(var c=0;c<this.tracks.length;c++){var d=
this.tracks[c];if(d){this.events.length=0;var e=d.time,f=d.lastTime,g=d.endTime,h=d.loop;!h&&e>g&&(e=g);var j=d.previous;if(j){var k=j.time;if(!j.loop&&k>j.endTime)k=j.endTime;j.animation.apply(b,k,k,j.loop,null);j=d.mixTime/d.mixDuration*d.mix;if(j>=1){j=1;d.previous=null}d.animation.mix(b,d.lastTime,e,h,this.events,j)}else d.mix==1?d.animation.apply(b,d.lastTime,e,h,this.events):d.animation.mix(b,d.lastTime,e,h,this.events,d.mix);j=0;for(k=this.events.length;j<k;j++){var l=this.events[j];if(d.onEvent)d.onEvent(c,
l);if(this.onEvent)this.onEvent(c,l)}if(h?f%g>e%g:f<g&&e>=g){e=Math.floor(e/g);if(d.onComplete)d.onComplete(c,e);if(this.onComplete)this.onComplete(c,e)}d.lastTime=d.time}}},clearTracks:function(){for(var b=0,c=this.tracks.length;b<c;b++)this.clearTrack(b);this.tracks.length=0},clearTrack:function(b){if(!(b>=this.tracks.length)){var c=this.tracks[b];if(c){if(c.onEnd)c.onEnd(b);if(this.onEnd)this.onEnd(b);this.tracks[b]=null}}},_expandToIndex:function(b){if(b<this.tracks.length)return this.tracks[b];
for(;b>=this.tracks.length;)this.tracks.push(null);return null},setCurrent:function(b,c){var d=this._expandToIndex(b);if(d){var e=d.previous;d.previous=null;if(d.onEnd)d.onEnd(b);if(this.onEnd)this.onEnd(b);c.mixDuration=this.data.getMix(d.animation,c.animation);if(c.mixDuration>0){c.mixTime=0;c.previous=e&&d.mixTime/d.mixDuration<0.5?e:d}}this.tracks[b]=c;if(c.onStart)c.onStart(b);if(this.onStart)this.onStart(b)},setAnimationByName:function(b,c,d){var e=this.data.skeletonData.findAnimation(c);if(!e)throw"Animation not found: "+
c;return this.setAnimation(b,e,d)},setAnimation:function(b,c,d){var e=new spine.TrackEntry;e.animation=c;e.loop=d;e.endTime=c.duration;this.setCurrent(b,e);return e},addAnimationByName:function(b,c,d,e){var f=this.data.skeletonData.findAnimation(c);if(!f)throw"Animation not found: "+c;return this.addAnimation(b,f,d,e)},addAnimation:function(b,c,d,e){var f=new spine.TrackEntry;f.animation=c;f.loop=d;f.endTime=c.duration;if(d=this._expandToIndex(b)){for(;d.next;)d=d.next;d.next=f}else this.tracks[b]=
f;e<=0&&(e=d?e+(d.endTime-this.data.getMix(d.animation,c)):0);f.delay=e;return f},getCurrent:function(b){return b>=this.tracks.length?null:this.tracks[b]}};spine.SkeletonJson=function(b){this.attachmentLoader=b};
spine.SkeletonJson.prototype={scale:1,readSkeletonData:function(b,c){var d=new spine.SkeletonData;d.name=c;var e=b.skeleton;if(e){d.hash=e.hash;d.version=e.spine;d.width=e.width||0;d.height=e.height||0}for(var f=b.bones,e=0,g=f.length;e<g;e++){var h=f[e],j=null;if(h.parent){j=d.findBone(h.parent);if(!j)throw"Parent bone not found: "+h.parent;}j=new spine.BoneData(h.name,j);j.length=(h.length||0)*this.scale;j.x=(h.x||0)*this.scale;j.y=(h.y||0)*this.scale;j.rotation=h.rotation||0;j.scaleX=h.hasOwnProperty("scaleX")?
h.scaleX:1;j.scaleY=h.hasOwnProperty("scaleY")?h.scaleY:1;j.inheritScale=h.hasOwnProperty("inheritScale")?h.inheritScale:true;j.inheritRotation=h.hasOwnProperty("inheritRotation")?h.inheritRotation:true;d.bones.push(j)}if(j=b.ik){e=0;for(g=j.length;e<g;e++){for(var h=j[e],k=new spine.IkConstraintData(h.name),f=h.bones,l=0,m=f.length;l<m;l++){var n=d.findBone(f[l]);if(!n)throw"IK bone not found: "+f[l];k.bones.push(n)}k.target=d.findBone(h.target);if(!k.target)throw"Target bone not found: "+h.target;
k.bendDirection=!h.hasOwnProperty("bendPositive")||h.bendPositive?1:-1;k.mix=h.hasOwnProperty("mix")?h.mix:1;d.ikConstraints.push(k)}}f=b.slots;e=0;for(g=f.length;e<g;e++){h=f[e];j=d.findBone(h.bone);if(!j)throw"Slot bone not found: "+h.bone;j=new spine.SlotData(h.name,j);if(k=h.color){j.r=this.toColor(k,0);j.g=this.toColor(k,1);j.b=this.toColor(k,2);j.a=this.toColor(k,3)}j.attachmentName=h.attachment;j.blendMode=spine.BlendMode[h.blend||"normal"];d.slots.push(j)}var e=b.skins,q;for(q in e)if(e.hasOwnProperty(q)){var g=
e[q],f=new spine.Skin(q),p;for(p in g)if(g.hasOwnProperty(p)){var j=d.findSlotIndex(p),h=g[p],s;for(s in h)if(h.hasOwnProperty(s))(k=this.readAttachment(f,s,h[s]))&&f.addAttachment(j,s,k)}d.skins.push(f);if(f.name=="default")d.defaultSkin=f}q=b.events;for(var r in q)if(q.hasOwnProperty(r)){p=q[r];s=new spine.EventData(r);s.intValue=p["int"]||0;s.floatValue=p["float"]||0;s.stringValue=p.string||null;d.events.push(s)}r=b.animations;for(var o in r)r.hasOwnProperty(o)&&this.readAnimation(o,r[o],d);return d},
readAttachment:function(b,c,d){var c=d.name||c,e=spine.AttachmentType[d.type||"region"],f=d.path||c,g=this.scale;if(e==spine.AttachmentType.region){b=this.attachmentLoader.newRegionAttachment(b,c,f);if(!b)return null;b.path=f;b.x=(d.x||0)*g;b.y=(d.y||0)*g;b.scaleX=d.hasOwnProperty("scaleX")?d.scaleX:1;b.scaleY=d.hasOwnProperty("scaleY")?d.scaleY:1;b.rotation=d.rotation||0;b.width=(d.width||0)*g;b.height=(d.height||0)*g;if(f=d.color){b.r=this.toColor(f,0);b.g=this.toColor(f,1);b.b=this.toColor(f,2);
b.a=this.toColor(f,3)}b.updateOffset();return b}if(e==spine.AttachmentType.mesh){b=this.attachmentLoader.newMeshAttachment(b,c,f);if(!b)return null;b.path=f;b.vertices=this.getFloatArray(d,"vertices",g);b.triangles=this.getIntArray(d,"triangles");b.regionUVs=this.getFloatArray(d,"uvs",1);b.updateUVs();if(f=d.color){b.r=this.toColor(f,0);b.g=this.toColor(f,1);b.b=this.toColor(f,2);b.a=this.toColor(f,3)}b.hullLength=(d.hull||0)*2;if(d.edges)b.edges=this.getIntArray(d,"edges");b.width=(d.width||0)*g;
b.height=(d.height||0)*g;return b}if(e==spine.AttachmentType.skinnedmesh){b=this.attachmentLoader.newSkinnedMeshAttachment(b,c,f);if(!b)return null;b.path=f;for(var h=this.getFloatArray(d,"uvs",1),f=this.getFloatArray(d,"vertices",1),j=[],k=[],c=0,e=f.length;c<e;){var l=f[c++]|0;k[k.length]=l;for(l=c+l*4;c<l;){k[k.length]=f[c];j[j.length]=f[c+1]*g;j[j.length]=f[c+2]*g;j[j.length]=f[c+3];c=c+4}}b.bones=k;b.weights=j;b.triangles=this.getIntArray(d,"triangles");b.regionUVs=h;b.updateUVs();if(f=d.color){b.r=
this.toColor(f,0);b.g=this.toColor(f,1);b.b=this.toColor(f,2);b.a=this.toColor(f,3)}b.hullLength=(d.hull||0)*2;if(d.edges)b.edges=this.getIntArray(d,"edges");b.width=(d.width||0)*g;b.height=(d.height||0)*g;return b}if(e==spine.AttachmentType.boundingbox){b=this.attachmentLoader.newBoundingBoxAttachment(b,c);f=d.vertices;c=0;for(e=f.length;c<e;c++)b.vertices.push(f[c]*g);return b}throw"Unknown attachment type: "+e;},readAnimation:function(b,c,d){var e=[],f=0,g=c.slots,h;for(h in g)if(g.hasOwnProperty(h)){var j=
g[h],k=d.findSlotIndex(h),l;for(l in j)if(j.hasOwnProperty(l)){var m=j[l];if(l=="color"){var n=new spine.ColorTimeline(m.length);n.slotIndex=k;for(var q=0,p=0,s=m.length;p<s;p++){var r=m[p],o=r.color,t=this.toColor(o,0),u=this.toColor(o,1),w=this.toColor(o,2),o=this.toColor(o,3);n.setFrame(q,r.time,t,u,w,o);this.readCurve(n,q,r);q++}e.push(n);f=Math.max(f,n.frames[n.getFrameCount()*5-5])}else if(l=="attachment"){n=new spine.AttachmentTimeline(m.length);n.slotIndex=k;p=q=0;for(s=m.length;p<s;p++){r=
m[p];n.setFrame(q++,r.time,r.name)}e.push(n);f=Math.max(f,n.frames[n.getFrameCount()-1])}else throw"Invalid timeline type for a slot: "+l+" ("+h+")";}}var k=c.bones,z;for(z in k)if(k.hasOwnProperty(z)){j=d.findBoneIndex(z);if(j==-1)throw"Bone not found: "+z;g=k[z];for(l in g)if(g.hasOwnProperty(l)){m=g[l];if(l=="rotate"){n=new spine.RotateTimeline(m.length);n.boneIndex=j;p=q=0;for(s=m.length;p<s;p++){r=m[p];n.setFrame(q,r.time,r.angle);this.readCurve(n,q,r);q++}e.push(n);f=Math.max(f,n.frames[n.getFrameCount()*
2-2])}else if(l=="translate"||l=="scale"){t=1;if(l=="scale")n=new spine.ScaleTimeline(m.length);else{n=new spine.TranslateTimeline(m.length);t=this.scale}n.boneIndex=j;p=q=0;for(s=m.length;p<s;p++){r=m[p];u=(r.x||0)*t;n.setFrame(q,r.time,u,(r.y||0)*t);this.readCurve(n,q,r);q++}e.push(n);f=Math.max(f,n.frames[n.getFrameCount()*3-3])}else if(l=="flipX"||l=="flipY"){n=(u=l=="flipX")?new spine.FlipXTimeline(m.length):new spine.FlipYTimeline(m.length);n.boneIndex=j;t=u?"x":"y";p=q=0;for(s=m.length;p<s;p++){r=
m[p];n.setFrame(q,r.time,r[t]||false);q++}e.push(n);f=Math.max(f,n.frames[n.getFrameCount()*2-2])}else throw"Invalid timeline type for a bone: "+l+" ("+z+")";}}var k=c.ik,A;for(A in k)if(k.hasOwnProperty(A)){q=d.findIkConstraint(A);m=k[A];n=new spine.IkConstraintTimeline(m.length);n.ikConstraintIndex=d.ikConstraints.indexOf(q);p=q=0;for(s=m.length;p<s;p++){r=m[p];j=r.hasOwnProperty("mix")?r.mix:1;l=!r.hasOwnProperty("bendPositive")||r.bendPositive?1:-1;n.setFrame(q,r.time,j,l);this.readCurve(n,q,
r);q++}e.push(n);f=Math.max(f,n.frames[n.frameCount*3-3])}z=c.ffd;for(var C in z){g=d.findSkin(C);j=z[C];for(h in j){var k=d.findSlotIndex(h),t=j[h],G;for(G in t){m=t[G];n=new spine.FfdTimeline(m.length);u=g.getAttachment(k,G);if(!u)throw"FFD attachment not found: "+G;n.slotIndex=k;n.attachment=u;o=(w=u.type==spine.AttachmentType.mesh)?u.vertices.length:u.weights.length/3*2;p=q=0;for(s=m.length;p<s;p++){var r=m[p],H;if(r.vertices){var K=r.vertices;H=[];H.length=o;var P=r.offset||0;A=K.length;if(this.scale==
1)for(l=0;l<A;l++)H[l+P]=K[l];else for(l=0;l<A;l++)H[l+P]=K[l]*this.scale;if(w){K=u.vertices;l=0;for(A=H.length;l<A;l++)H[l]=H[l]+K[l]}}else if(w)H=u.vertices;else{H=[];H.length=o}n.setFrame(q,r.time,H);this.readCurve(n,q,r);q++}e[e.length]=n;f=Math.max(f,n.frames[n.frameCount-1])}}}(h=c.drawOrder)||(h=c.draworder);if(h){n=new spine.DrawOrderTimeline(h.length);m=d.slots.length;p=q=0;for(s=h.length;p<s;p++){C=h[p];G=null;if(C.offsets){G=[];G.length=m;for(l=m-1;l>=0;l--)G[l]=-1;r=C.offsets;j=[];j.length=
m-r.length;l=g=z=0;for(A=r.length;l<A;l++){t=r[l];k=d.findSlotIndex(t.slot);if(k==-1)throw"Slot not found: "+t.slot;for(;z!=k;)j[g++]=z++;G[z+t.offset]=z++}for(;z<m;)j[g++]=z++;for(l=m-1;l>=0;l--)G[l]==-1&&(G[l]=j[--g])}n.setFrame(q++,C.time,G)}e.push(n);f=Math.max(f,n.frames[n.getFrameCount()-1])}if(c=c.events){n=new spine.EventTimeline(c.length);p=q=0;for(s=c.length;p<s;p++){h=c[p];m=d.findEvent(h.name);if(!m)throw"Event not found: "+h.name;C=new spine.Event(m);C.intValue=h.hasOwnProperty("int")?
h["int"]:m.intValue;C.floatValue=h.hasOwnProperty("float")?h["float"]:m.floatValue;C.stringValue=h.hasOwnProperty("string")?h.string:m.stringValue;n.setFrame(q++,h.time,C)}e.push(n);f=Math.max(f,n.frames[n.getFrameCount()-1])}d.animations.push(new spine.Animation(b,e,f))},readCurve:function(b,c,d){(d=d.curve)?d=="stepped"?b.curves.setStepped(c):d instanceof Array&&b.curves.setCurve(c,d[0],d[1],d[2],d[3]):b.curves.setLinear(c)},toColor:function(b,c){if(b.length!=8)throw"Color hexidecimal length must be 8, recieved: "+
b;return parseInt(b.substring(c*2,c*2+2),16)/255},getFloatArray:function(b,c,d){var b=b[c],c=new spine.Float32Array(b.length),e=0,f=b.length;if(d==1)for(;e<f;e++)c[e]=b[e];else for(;e<f;e++)c[e]=b[e]*d;return c},getIntArray:function(b,c){for(var d=b[c],e=new spine.Uint16Array(d.length),f=0,g=d.length;f<g;f++)e[f]=d[f]|0;return e}};
spine.Atlas=function(b,c){this.textureLoader=c;this.pages=[];this.regions=[];var d=new spine.AtlasReader(b),e=[];e.length=4;for(var f=null;;){var g=d.readLine();if(g===null)break;g=d.trim(g);if(g.length)if(f){var h=new spine.AtlasRegion;h.name=g;h.page=f;h.rotate=d.readValue()=="true";d.readTuple(e);var g=parseInt(e[0]),j=parseInt(e[1]);d.readTuple(e);var k=parseInt(e[0]),l=parseInt(e[1]);h.u=g/f.width;h.v=j/f.height;if(h.rotate){h.u2=(g+l)/f.width;h.v2=(j+k)/f.height}else{h.u2=(g+k)/f.width;h.v2=
(j+l)/f.height}h.x=g;h.y=j;h.width=Math.abs(k);h.height=Math.abs(l);if(d.readTuple(e)==4){h.splits=[parseInt(e[0]),parseInt(e[1]),parseInt(e[2]),parseInt(e[3])];if(d.readTuple(e)==4){h.pads=[parseInt(e[0]),parseInt(e[1]),parseInt(e[2]),parseInt(e[3])];d.readTuple(e)}}h.originalWidth=parseInt(e[0]);h.originalHeight=parseInt(e[1]);d.readTuple(e);h.offsetX=parseInt(e[0]);h.offsetY=parseInt(e[1]);h.index=parseInt(d.readValue());this.regions.push(h)}else{f=new spine.AtlasPage;f.name=g;if(d.readTuple(e)==
2){f.width=parseInt(e[0]);f.height=parseInt(e[1]);d.readTuple(e)}f.format=spine.Atlas.Format[e[0]];d.readTuple(e);f.minFilter=spine.Atlas.TextureFilter[e[0]];f.magFilter=spine.Atlas.TextureFilter[e[1]];h=d.readValue();f.uWrap=spine.Atlas.TextureWrap.clampToEdge;f.vWrap=spine.Atlas.TextureWrap.clampToEdge;if(h=="x")f.uWrap=spine.Atlas.TextureWrap.repeat;else if(h=="y")f.vWrap=spine.Atlas.TextureWrap.repeat;else if(h=="xy")f.uWrap=f.vWrap=spine.Atlas.TextureWrap.repeat;c.load(f,g,this);this.pages.push(f)}else f=
null}};spine.Atlas.prototype={findRegion:function(b){for(var c=this.regions,d=0,e=c.length;d<e;d++)if(c[d].name==b)return c[d];return null},dispose:function(){for(var b=this.pages,c=0,d=b.length;c<d;c++)this.textureLoader.unload(b[c].rendererObject)},updateUVs:function(b){for(var c=this.regions,d=0,e=c.length;d<e;d++){var f=c[d];if(f.page==b){f.u=f.x/b.width;f.v=f.y/b.height;if(f.rotate){f.u2=(f.x+f.height)/b.width;f.v2=(f.y+f.width)/b.height}else{f.u2=(f.x+f.width)/b.width;f.v2=(f.y+f.height)/b.height}}}}};
spine.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6};spine.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6};spine.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2};spine.AtlasPage=function(){};spine.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0};spine.AtlasRegion=function(){};
spine.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null};spine.AtlasReader=function(b){this.lines=b.split(/\r\n|\r|\n/)};
spine.AtlasReader.prototype={index:0,trim:function(b){return b.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var b=this.readLine(),c=b.indexOf(":");if(c==-1)throw"Invalid line: "+b;return this.trim(b.substring(c+1))},readTuple:function(b){var c=this.readLine(),d=c.indexOf(":");if(d==-1)throw"Invalid line: "+c;for(var e=0,d=d+1;e<3;e++){var f=c.indexOf(",",d);if(f==-1)break;b[e]=this.trim(c.substr(d,f-d));d=f+
1}b[e]=this.trim(c.substring(d));return e+1}};spine.AtlasAttachmentLoader=function(b){this.atlas=b};
spine.AtlasAttachmentLoader.prototype={newRegionAttachment:function(b,c,d){b=this.atlas.findRegion(d);if(!b)throw"Region not found in atlas: "+d+" (region attachment: "+c+")";c=new spine.RegionAttachment(c);c.rendererObject=b;c.setUVs(b.u,b.v,b.u2,b.v2,b.rotate);c.regionOffsetX=b.offsetX;c.regionOffsetY=b.offsetY;c.regionWidth=b.width;c.regionHeight=b.height;c.regionOriginalWidth=b.originalWidth;c.regionOriginalHeight=b.originalHeight;return c},newMeshAttachment:function(b,c,d){b=this.atlas.findRegion(d);
if(!b)throw"Region not found in atlas: "+d+" (mesh attachment: "+c+")";c=new spine.MeshAttachment(c);c.rendererObject=b;c.regionU=b.u;c.regionV=b.v;c.regionU2=b.u2;c.regionV2=b.v2;c.regionRotate=b.rotate;c.regionOffsetX=b.offsetX;c.regionOffsetY=b.offsetY;c.regionWidth=b.width;c.regionHeight=b.height;c.regionOriginalWidth=b.originalWidth;c.regionOriginalHeight=b.originalHeight;return c},newSkinnedMeshAttachment:function(b,c,d){b=this.atlas.findRegion(d);if(!b)throw"Region not found in atlas: "+d+
" (skinned mesh attachment: "+c+")";c=new spine.SkinnedMeshAttachment(c);c.rendererObject=b;c.regionU=b.u;c.regionV=b.v;c.regionU2=b.u2;c.regionV2=b.v2;c.regionRotate=b.rotate;c.regionOffsetX=b.offsetX;c.regionOffsetY=b.offsetY;c.regionWidth=b.width;c.regionHeight=b.height;c.regionOriginalWidth=b.originalWidth;c.regionOriginalHeight=b.originalHeight;return c},newBoundingBoxAttachment:function(b,c){return new spine.BoundingBoxAttachment(c)}};
spine.SkeletonBounds=function(){this.polygonPool=[];this.polygons=[];this.boundingBoxes=[]};
spine.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(b,c){for(var d=b.slots,e=d.length,f=b.x,g=b.y,h=this.boundingBoxes,j=this.polygonPool,k=this.polygons,l=h.length=0,m=k.length;l<m;l++)j.push(k[l]);for(l=k.length=0;l<e;l++){var m=d[l],n=m.attachment;if(n&&n.type==spine.AttachmentType.boundingbox){h.push(n);var q=j.length,p;if(q>0){p=j[q-1];j.splice(q-1,1)}else p=[];k.push(p);p.length=n.vertices.length;n.computeWorldVertices(f,g,m.bone,p)}}c&&this.aabbCompute()},aabbCompute:function(){for(var b=
this.polygons,c=Number.MAX_VALUE,d=Number.MAX_VALUE,e=Number.MIN_VALUE,f=Number.MIN_VALUE,g=0,h=b.length;g<h;g++)for(var j=b[g],k=0,l=j.length;k<l;k=k+2)var m=j[k],n=j[k+1],c=Math.min(c,m),d=Math.min(d,n),e=Math.max(e,m),f=Math.max(f,n);this.minX=c;this.minY=d;this.maxX=e;this.maxY=f},aabbContainsPoint:function(b,c){return b>=this.minX&&b<=this.maxX&&c>=this.minY&&c<=this.maxY},aabbIntersectsSegment:function(b,c,d,e){var f=this.minX,g=this.minY,h=this.maxX,j=this.maxY;if(b<=f&&d<=f||c<=g&&e<=g||b>=
h&&d>=h||c>=j&&e>=j)return false;d=(e-c)/(d-b);e=d*(f-b)+c;if(e>g&&e<j)return true;e=d*(h-b)+c;if(e>g&&e<j)return true;g=(g-c)/d+b;if(g>f&&g<h)return true;g=(j-c)/d+b;return g>f&&g<h?true:false},aabbIntersectsSkeleton:function(b){return this.minX<b.maxX&&this.maxX>b.minX&&this.minY<b.maxY&&this.maxY>b.minY},containsPoint:function(b,c){for(var d=this.polygons,e=0,f=d.length;e<f;e++)if(this.polygonContainsPoint(d[e],b,c))return this.boundingBoxes[e];return null},intersectsSegment:function(b,c,d,e){for(var f=
this.polygons,g=0,h=f.length;g<h;g++)if(f[g].intersectsSegment(b,c,d,e))return this.boundingBoxes[g];return null},polygonContainsPoint:function(b,c,d){for(var e=b.length,f=e-2,g=false,h=0;h<e;h=h+2){var j=b[h+1],k=b[f+1];if(j<d&&k>=d||k<d&&j>=d){var l=b[h];l+(d-j)/(k-j)*(b[f]-l)<c&&(g=!g)}f=h}return g},polygonIntersectsSegment:function(b,c,d,e,f){for(var g=b.length,h=c-e,j=d-f,k=c*f-d*e,l=b[g-2],m=b[g-1],n=0;n<g;n=n+2){var q=b[n],p=b[n+1],s=l*p-m*q,r=l-q,o=m-p,t=h*o-j*r,r=(k*r-h*s)/t;if((r>=l&&r<=
q||r>=q&&r<=l)&&(r>=c&&r<=e||r>=e&&r<=c)){l=(k*o-j*s)/t;if((l>=m&&l<=p||l>=p&&l<=m)&&(l>=d&&l<=f||l>=f&&l<=d))return true}l=q;m=p}return false},getPolygon:function(b){b=this.boundingBoxes.indexOf(b);return b==-1?null:this.polygons[b]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}};spine.SkeletonImageBounds=function(){this.polygonPool=[];this.polygons=[]};
spine.SkeletonImageBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(b,c){for(var d=b.slots,e=d.length,f=b.x,g=b.y,h=this.polygonPool,j=this.polygons,k=0,l=j.length;k<l;k++)h.push(j[k]);for(k=j.length=0;k<e;k++){var l=d[k],m=l.attachment;if(m&&m.type==spine.AttachmentType.region){var n=h.length,q;if(n>0){q=h[n-1];h.splice(n-1,1)}else q=[];j.push(q);q.length=8;m.computeVertices(f,g,l.bone,q)}}c&&this.aabbCompute()},aabbCompute:function(){for(var b=this.polygons,c=Number.MAX_VALUE,d=Number.MAX_VALUE,
e=Number.MIN_VALUE,f=Number.MIN_VALUE,g=0,h=b.length;g<h;g++)for(var j=b[g],k=0,l=j.length;k<l;k=k+2)var m=j[k],n=j[k+1],c=Math.min(c,m),d=Math.min(d,n),e=Math.max(e,m),f=Math.max(f,n);this.minX=c;this.minY=d;this.maxX=e;this.maxY=f},aabbContainsPoint:function(b,c){return b>=this.minX&&b<=this.maxX&&c>=this.minY&&c<=this.maxY},aabbIntersectsSegment:function(b,c,d,e){var f=this.minX,g=this.minY,h=this.maxX,j=this.maxY;if(b<=f&&d<=f||c<=g&&e<=g||b>=h&&d>=h||c>=j&&e>=j)return false;d=(e-c)/(d-b);e=d*
(f-b)+c;if(e>g&&e<j)return true;e=d*(h-b)+c;if(e>g&&e<j)return true;g=(g-c)/d+b;if(g>f&&g<h)return true;g=(j-c)/d+b;return g>f&&g<h?true:false},aabbIntersectsSkeleton:function(b){return this.minX<b.maxX&&this.maxX>b.minX&&this.minY<b.maxY&&this.maxY>b.minY},containsPoint:function(b,c){for(var d=this.polygons,e=0,f=d.length;e<f;e++)if(this.polygonContainsPoint(d[e],b,c))return this.boundingBoxes[e];return null},intersectsSegment:function(b,c,d,e){for(var f=this.polygons,g=0,h=f.length;g<h;g++)if(f[g].intersectsSegment(b,
c,d,e))return this.boundingBoxes[g];return null},polygonContainsPoint:function(b,c,d){for(var e=b.length,f=e-2,g=false,h=0;h<e;h=h+2){var j=b[h+1],k=b[f+1];if(j<d&&k>=d||k<d&&j>=d){var l=b[h];l+(d-j)/(k-j)*(b[f]-l)<c&&(g=!g)}f=h}return g},polygonIntersectsSegment:function(b,c,d,e,f){for(var g=b.length,h=c-e,j=d-f,k=c*f-d*e,l=b[g-2],m=b[g-1],n=0;n<g;n=n+2){var q=b[n],p=b[n+1],s=l*p-m*q,r=l-q,o=m-p,t=h*o-j*r,r=(k*r-h*s)/t;if((r>=l&&r<=q||r>=q&&r<=l)&&(r>=c&&r<=e||r>=e&&r<=c)){l=(k*o-j*s)/t;if((l>=m&&
l<=p||l>=p&&l<=m)&&(l>=d&&l<=f||l>=f&&l<=d))return true}l=q;m=p}return false},getPolygon:function(b){b=this.boundingBoxes.indexOf(b);return b==-1?null:this.polygons[b]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}};
(function(b,c){function d(b,c,e,f){d._super_.call(this);this.reset(b,c,e,f)}function e(b,c,d,f){e._super_.call(this);this.x=b;this.y=c;this.width=d;this.height=f}function f(b,c){f._super_.call(this);this.x=b;this.y=c}function g(b,c,d){g._super_.call(this);this.x=b;this.y=c;this.radius=d;this.angle=0;this.center={x:this.x,y:this.y}}function h(b,c,d,e,f){h._super_.call(this);d-b>=0?(this.x1=b,this.y1=c,this.x2=d,this.y2=e):(this.x1=d,this.y1=e,this.x2=b,this.y2=c);this.dx=this.x2-this.x1;this.dy=this.y2-
this.y1;this.minx=Math.min(this.x1,this.x2);this.miny=Math.min(this.y1,this.y2);this.maxx=Math.max(this.x1,this.x2);this.maxy=Math.max(this.y1,this.y2);this.dot=this.x2*this.y1-this.x1*this.y2;this.xxyy=this.dx*this.dx+this.dy*this.dy;this.gradient=this.getGradient();this.length=this.getLength();this.direction=x.Util.initValue(f,">")}function j(){this.vector=new x.Vector2D(0,0);this.random=0;this.crossType="dead";this.alert=true}function k(b,c){k._super_.call(this,b,c);(this.gl=this.element.getContext("experimental-webgl",
{antialias:true,stencil:false,depth:false}))||alert("Sorry your browser do not suppest WebGL!");this.initVar();this.setMaxRadius();this.initShaders();this.initBuffers();this.gl.blendEquation(this.gl.FUNC_ADD);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.enable(this.gl.BLEND)}function l(b,c,d){l._super_.call(this,b,c);this.context=this.element.getContext("2d");this.rectangle=this.imageData=null;this.rectangle=d;this.createImageData(d)}function m(b,c){m._super_.call(this,
b,c);this.stroke=null;this.context=this.element.getContext("2d");this.bufferCache={}}function n(b,c,d){n._super_.call(this,b,c);this.stroke=d}function q(b,c){q._super_.call(this,b,c);this.stroke=null}function p(b,c,d){this.proton=b;this.element=c;this.stroke=d}function s(b,c,d){this.element=d;this.type=x.Util.initValue(b,"canvas");this.proton=c;this.renderer=this.getRenderer()}function r(c,d,e){this.mouseTarget=x.Util.initValue(c,b);this.ease=x.Util.initValue(d,0.7);this._allowEmitting=false;this.initEventHandler();
r._super_.call(this,e)}function o(b){this.selfBehaviours=[];o._super_.call(this,b)}function t(b){this.initializes=[];this.particles=[];this.behaviours=[];this.emitTime=0;this.emitTotalTimes=-1;this.damping=0.006;this.bindEmitter=true;this.rate=new x.Rate(1,0.1);t._super_.call(this,b);this.id="emitter_"+t.ID++}function u(b,c,d,e){u._super_.call(this,d,e);this.distanceVec=new x.Vector2D;this.centerPoint=x.Util.initValue(b,new x.Vector2D);this.force=x.Util.initValue(this.normalizeValue(c),100);this.name=
"GravityWell"}function w(b,c,d,e){w._super_.call(this,d,e);this.reset(b,c);this.name="Color"}function z(b,c,d,e,f){z._super_.call(this,e,f);this.reset(b,c,d);this.name="Rotate"}function A(b,c,d,e){A._super_.call(this,d,e);this.reset(b,c);this.name="Scale"}function C(b,c,d,e){C._super_.call(this,d,e);this.reset(b,c);this.name="Alpha"}function G(b,c,d,e){G._super_.call(this,d,e);this.reset(b,c);this.name="CrossZone"}function H(b,c,d,e,f){H._super_.call(this,e,f);this.reset(b,c,d);this.name="Collision"}
function K(b,c,d){K._super_.call(this,0,b,c,d);this.name="Gravity"}function P(b,c,d,e,f){P._super_.call(this,b,c,d,e,f);this.force=this.force*-1;this.name="Repulsion"}function T(b,c,d,e,f){T._super_.call(this,e,f);this.reset(b,c,d);this.time=0;this.name="RandomDrift"}function D(b,c,d,e,f){D._super_.call(this,e,f);this.targetPosition=x.Util.initValue(b,new x.Vector2D);this.radius=x.Util.initValue(d,1E3);this.force=x.Util.initValue(this.normalizeValue(c),100);this.radiusSq=this.radius*this.radius;this.attractionForce=
new x.Vector2D;this.lengthSq=0;this.name="Attraction"}function F(b,c,d,e){F._super_.call(this,d,e);this.force=this.normalizeForce(new x.Vector2D(b,c));this.name="Force"}function I(b,c,d){I._super_.call(this);this.image=this.setSpanValue(b);this.w=x.Util.initValue(c,20);this.h=x.Util.initValue(d,this.w)}function J(b,c,d){J._super_.call(this);this.radius=x.Util.setSpanValue(b,c,d)}function N(b,c,d){N._super_.call(this);this.massPan=x.Util.setSpanValue(b,c,d)}function U(b,c,d){U._super_.call(this);this.rPan=
x.Util.setSpanValue(b);this.thaPan=x.Util.setSpanValue(c);this.type=x.Util.initValue(d,"vector")}function Q(b){Q._super_.call(this);this.zone=x.Util.initValue(b,new x.PointZone)}function B(b,c,d){B._super_.call(this);this.lifePan=x.Util.setSpanValue(b,c,d)}function E(){}function Z(b,c){this.numPan=x.Util.initValue(b,1);this.timePan=x.Util.initValue(c,1);this.numPan=x.Util.setSpanValue(this.numPan);this.timePan=x.Util.setSpanValue(this.timePan);this.nextTime=this.startTime=0;this.init()}function O(b,
c){this.id="Behaviour_"+O.id++;this.life=x.Util.initValue(b,Infinity);this.easing=x.ease.setEasingByName(c);this.age=0;this.energy=1;this.dead=false;this.parents=[];this.name="Behaviour"}function M(b,c,d,e){this.x=b;this.y=c;this.width=d;this.height=e;this.bottom=this.y+this.height;this.right=this.x+this.width}function X(b){x.Util.isArray(b)?this.colorArr=b:this.colorArr=[b]}function aa(b,c,d){this.isArray=false;x.Util.isArray(b)?(this.isArray=true,this.a=b):(this.a=x.Util.initValue(b,1),this.b=x.Util.initValue(c,
this.a),this.center=x.Util.initValue(d,false))}function Y(b,c){this.proParticleCount=x.Util.initValue(b,0);this.releaseTime=x.Util.initValue(c,-1);this.poolList=[];for(var d=this.timeoutID=0;d<this.proParticleCount;d++)this.add();this.releaseTime>0&&(this.timeoutID=setTimeout(this.release,this.releaseTime/1E3))}function ba(b){this.id="particle_"+ba.ID++;this.reset(true);x.Util.setPrototypeByObject(this,b)}function da(){this.mats=[];for(var b=this.size=0;b<20;b++)this.mats.push(x.Mat3.create([0,0,
0,0,0,0,0,0,0]))}function ra(){this.initialize()}function x(b,c){this.proParticleCount=x.Util.initValue(b,x.POOL_MAX);this.integrationType=x.Util.initValue(c,x.EULER);this.emitters=[];this.renderers=[];this.oldTime=this.time=0;x.pool=new x.ParticlePool(this.proParticleCount);x.integrator=new x.NumericalIntegration(this.integrationType)}x.POOL_MAX=1E3;x.TIME_STEP=60;x.MEASURE=100;x.EULER="euler";x.RK2="runge-kutta2";x.RK4="runge-kutta4";x.VERLET="verlet";x.PARTICLE_CREATED="partilcleCreated";x.PARTICLE_UPDATE=
"partilcleUpdate";x.PARTICLE_SLEEP="particleSleep";x.PARTICLE_DEAD="partilcleDead";x.PROTON_UPDATE="protonUpdate";x.PROTON_UPDATE_AFTER="protonUpdateAfter";x.EMITTER_ADDED="emitterAdded";x.EMITTER_REMOVED="emitterRemoved";x.amendChangeTabsBug=true;x.TextureBuffer={};x.TextureCanvasBuffer={};x.prototype={addRender:function(b){b.proton=this;this.renderers.push(b.proton)},addEmitter:function(b){this.emitters.push(b);b.parent=this;this.dispatchEvent(new x.Event({type:x.EMITTER_ADDED,emitter:b}))},removeEmitter:function(b){this.emitters.splice(this.emitters.indexOf(b),
1);b.parent=null;this.dispatchEvent(new x.Event({type:x.EMITTER_REMOVED,emitter:b}))},update:function(){this.dispatchEvent(new x.Event({type:x.PROTON_UPDATE}));this.oldTime||(this.oldTime=(new Date).getTime());var b=(new Date).getTime();this.elapsed=(b-this.oldTime)/1E3;x.amendChangeTabsBug&&this.amendChangeTabsBug();this.oldTime=b;if(this.elapsed>0)for(b=0;b<this.emitters.length;b++)this.emitters[b].update(this.elapsed);this.dispatchEvent(new x.Event({type:x.PROTON_UPDATE_AFTER}))},amendChangeTabsBug:function(){this.elapsed>
0.5&&(this.oldTime=(new Date).getTime(),this.elapsed=0)},getCount:function(){for(var b=0,c=this.emitters.length,d=0;d<c;d++)b=b+this.emitters[d].particles.length;return b},destory:function(){for(var b=this.emitters.length,c=0;c<b;c++){this.emitters[c].destory();delete this.emitters[c]}this.emitters=[];this.oldTime=this.time=0;x.pool.release()}};b.Proton=x;var ja=ra.prototype;ra.initialize=function(b){b.addEventListener=ja.addEventListener;b.removeEventListener=ja.removeEventListener;b.removeAllEventListeners=
ja.removeAllEventListeners;b.hasEventListener=ja.hasEventListener;b.dispatchEvent=ja.dispatchEvent};ja._listeners=null;ja.initialize=function(){};ja.addEventListener=function(b,c){var d=this._listeners;d?this.removeEventListener(b,c):d=this._listeners={};var e=d[b];e||(e=d[b]=[]);e.push(c);return c};ja.removeEventListener=function(b,c){var d=this._listeners;if(d){var e=d[b];if(e)for(var f=0,g=e.length;f<g;f++)if(e[f]==c){g==1?delete d[b]:e.splice(f,1);break}}};ja.removeAllEventListeners=function(b){b?
this._listeners&&delete this._listeners[b]:this._listeners=null};ja.dispatchEvent=function(b){var c=false,d=this._listeners;if(b&&d){d=d[b.type];if(!d)return c;for(var d=d.slice(),e=0,f=d.length;e<f;e++)var g=d[e],c=c||g(b)}return!!c};ja.hasEventListener=function(b){var c=this._listeners;return!!c&&!!c[b]};x.EventDispatcher=ra;x.EventDispatcher.initialize(x.prototype);x.Event=function(b){this.type=b.type;this.particle=b.particle;this.emitter=b.emitter};var ka=ka||{initValue:function(b,d){return b=
b!=null&&b!=c?b:d},isArray:function(b){return typeof b=="object"&&b.hasOwnProperty("length")},destroyArray:function(b){b.length=0},destroyObject:function(b){for(var c in b)delete b[c]},getVector2D:function(b,c){return typeof b=="object"?b:new x.Vector2D(b,c)},judgeVector2D:function(b){var c="";if(b.hasOwnProperty("x")||b.hasOwnProperty("y")||b.hasOwnProperty("p")||b.hasOwnProperty("position"))c=c+"p";if(b.hasOwnProperty("vx")||b.hasOwnProperty("vx")||b.hasOwnProperty("v")||b.hasOwnProperty("velocity"))c=
c+"v";if(b.hasOwnProperty("ax")||b.hasOwnProperty("ax")||b.hasOwnProperty("a")||b.hasOwnProperty("accelerate"))c=c+"a";return c},setVector2DByObject:function(b,c){c.hasOwnProperty("x")&&(b.p.x=c.x);c.hasOwnProperty("y")&&(b.p.y=c.y);c.hasOwnProperty("vx")&&(b.v.x=c.vx);c.hasOwnProperty("vy")&&(b.v.y=c.vy);c.hasOwnProperty("ax")&&(b.a.x=c.ax);c.hasOwnProperty("ay")&&(b.a.y=c.ay);c.hasOwnProperty("p")&&particle.p.copy(c.p);c.hasOwnProperty("v")&&particle.v.copy(c.v);c.hasOwnProperty("a")&&particle.a.copy(c.a);
c.hasOwnProperty("position")&&particle.p.copy(c.position);c.hasOwnProperty("velocity")&&particle.v.copy(c.velocity);c.hasOwnProperty("accelerate")&&particle.a.copy(c.accelerate)},addPrototypeByObject:function(b,c,d){for(var e in c)d?d.indexOf(e)<0&&(b[e]=x.Util.getSpanValue(c[e])):b[e]=x.Util.getSpanValue(c[e]);return b},setPrototypeByObject:function(b,c,d){for(var e in c)b.hasOwnProperty(e)&&(d?d.indexOf(e)<0&&(b[e]=x.Util.getSpanValue(c[e])):b[e]=x.Util.getSpanValue(c[e]));return b},setSpanValue:function(b,
c,d){return b instanceof x.Span?b:c?d?new x.Span(b,c,d):new x.Span(b,c):new x.Span(b)},getSpanValue:function(b){return b instanceof x.Span?b.getValue():b},inherits:function(b,c){b._super_=c;if(Object.create)b.prototype=Object.create(c.prototype,{constructor:{value:c}});else{var d=function(){};d.prototype=c.prototype;b.prototype=new d;b.prototype.constructor=b}},getImageData:function(b,c,d){b.drawImage(c,d.x,d.y);c=b.getImageData(d.x,d.y,d.width,d.height);b.clearRect(d.x,d.y,d.width,d.height);return c},
getImage:function(b,c,d,e){typeof b=="string"?this.loadAndSetImage(b,c,d,e):typeof b=="object"?this.loadAndSetImage(b.src,c,d,e):b instanceof Image&&this.loadedImage(b.src,c,d,e,b)},loadedImage:function(b,c,d,e,f){c.target=f;c.transform.src=b;x.TextureBuffer[b]||(x.TextureBuffer[b]=c.target);if(d)if(x.TextureCanvasBuffer[b])c.transform.canvas=x.TextureCanvasBuffer[b];else{d=x.WebGLUtil.nhpot(c.target.width);f=x.WebGLUtil.nhpot(c.target.height);c.transform.canvas=x.DomUtil.createCanvas("canvas"+b,
d,f);c.transform.canvas.getContext("2d").drawImage(c.target,0,0,c.target.width,c.target.height);x.TextureCanvasBuffer[b]=c.transform.canvas}e&&e(c)},loadAndSetImage:function(b,c,d,e){if(x.TextureBuffer[b])this.loadedImage(b,c,d,e,x.TextureBuffer[b]);else{var f=this,g=new Image;g.onload=function(g){f.loadedImage(b,c,d,e,g.target)};g.src=b}},hexToRGB:function(b){var c=b.charAt(0)=="#"?b.substring(1,7):b,b=parseInt(c.substring(0,2),16),d=parseInt(c.substring(2,4),16),c=parseInt(c.substring(4,6),16);
return{r:b,g:d,b:c}},rgbToHex:function(b){return"rgb("+b.r+", "+b.g+", "+b.b+")"}};x.Util=ka;var oa=oa||{ipot:function(b){return(b&b-1)==0},nhpot:function(b){--b;for(var c=1;c<32;c=c<<1)b=b|b>>c;return b+1},makeTranslation:function(b,c){return[1,0,0,0,1,0,b,c,1]},makeRotation:function(b){var c=Math.cos(b),b=Math.sin(b);return[c,-b,0,b,c,0,0,0,1]},makeScale:function(b,c){return[b,0,0,0,c,0,0,0,1]},matrixMultiply:function(b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],j=b[5],k=b[6],l=b[7],m=b[8],n=c[0],
o=c[1],p=c[2],q=c[3],s=c[4],r=c[5],t=c[6],u=c[7],w=c[8];return[d*n+e*q+f*t,d*o+e*s+f*u,d*p+e*r+f*w,g*n+h*q+j*t,g*o+h*s+j*u,g*p+h*r+j*w,k*n+l*q+m*t,k*o+l*s+m*u,k*p+l*r+m*w]}};x.WebGLUtil=oa;var pa=pa||{createCanvas:function(b,c,d,e){var f=document.createElement("canvas");f.id=b;f.width=c;f.height=d;f.style.position=e?e:"absolute";f.style.opacity=0;this.transformDom(f,-500,-500,0,0);return f},transformDom:function(b,c,d,e,f){b.style.WebkitTransform="translate("+c+"px, "+d+"px) scale("+e+") rotate("+
f+"deg)";b.style.MozTransform="translate("+c+"px, "+d+"px) scale("+e+") rotate("+f+"deg)";b.style.OTransform="translate("+c+"px, "+d+"px) scale("+e+") rotate("+f+"deg)";b.style.msTransform="translate("+c+"px, "+d+"px) scale("+e+") rotate("+f+"deg)";b.style.transform="translate("+c+"px, "+d+"px) scale("+e+") rotate("+f+"deg)"}};x.DomUtil=pa;da.prototype.set=function(b,c){c==0?x.Mat3.set(b,this.mats[0]):x.Mat3.multiply(this.mats[c-1],b,this.mats[c]);this.size=Math.max(this.size,c+1)};da.prototype.push=
function(b){this.size==0?x.Mat3.set(b,this.mats[0]):x.Mat3.multiply(this.mats[this.size-1],b,this.mats[this.size]);this.size++};da.prototype.pop=function(){this.size>0&&this.size--};da.prototype.top=function(){return this.mats[this.size-1]};x.MStack=da;ba.ID=0;ba.prototype={getDirection:function(){return Math.atan2(this.v.x,-this.v.y)*(180/Math.PI)},reset:function(b){this.life=Infinity;this.age=0;this.energy=1;this.sleep=this.dead=false;this.parent=this.sprite=this.target=null;this.mass=1;this.radius=
10;this.scale=this.alpha=1;this.rotation=0;this.color=null;this.easing=x.ease.setEasingByName(x.easeLinear);b?(this.transform={},this.p=new x.Vector2D,this.v=new x.Vector2D,this.a=new x.Vector2D,this.old={p:new x.Vector2D,v:new x.Vector2D,a:new x.Vector2D},this.behaviours=[]):(x.Util.destroyObject(this.transform),this.p.set(0,0),this.v.set(0,0),this.a.set(0,0),this.old.p.set(0,0),this.old.v.set(0,0),this.old.a.set(0,0),this.removeAllBehaviours());this.transform.rgb={r:255,g:255,b:255};return this},
update:function(b,c){if(!this.sleep){this.age=this.age+b;var d=this.behaviours.length,e;for(e=0;e<d;e++)this.behaviours[e]&&this.behaviours[e].applyBehaviour(this,b,c)}if(this.age>=this.life)this.destory();else{d=this.easing(this.age/this.life);this.energy=Math.max(1-d,0)}},addBehaviour:function(b){this.behaviours.push(b);b.hasOwnProperty("parents")&&b.parents.push(this);b.initialize(this)},addBehaviours:function(b){var c=b.length,d;for(d=0;d<c;d++)this.addBehaviour(b[d])},removeBehaviour:function(b){b=
this.behaviours.indexOf(b);if(b>-1){b=this.behaviours.splice(b,1);b.parents=null}},removeAllBehaviours:function(){x.Util.destroyArray(this.behaviours)},destory:function(){this.removeAllBehaviours();this.energy=0;this.dead=true;this.parent=null}};x.Particle=ba;Y.prototype={create:function(b){return b?new newTypeParticle:new x.Particle},getCount:function(){return this.poolList.length},add:function(){return this.poolList.push(this.create())},get:function(){return this.poolList.length===0?this.create():
this.poolList.pop().reset()},set:function(b){if(this.poolList.length<x.POOL_MAX)return this.poolList.push(b)},release:function(){for(var b=0;b<this.poolList.length;b++){this.poolList[b].destory&&this.poolList[b].destory();delete this.poolList[b]}this.poolList=[]}};x.ParticlePool=Y;var V={randomAToB:function(b,c,d){return d?Math.floor(Math.random()*(c-b))+b:b+Math.random()*(c-b)},randomFloating:function(b,c,d){return V.randomAToB(b-c,b+c,d)},randomZone:function(){},degreeTransform:function(b){return b*
Math.PI/180},toColor16:function(b){return"#"+b.toString(16)},randomColor:function(){return"#"+("00000"+(Math.random()*16777216<<0).toString(16)).slice(-6)}};x.MathUtils=V;ka=function(b){this.type=x.Util.initValue(b,x.EULER)};ka.prototype={integrate:function(b,c,d){this.eulerIntegrate(b,c,d)},eulerIntegrate:function(b,c,d){b.sleep||(b.old.p.copy(b.p),b.old.v.copy(b.v),b.a.multiplyScalar(1/b.mass),b.v.add(b.a.multiplyScalar(c)),b.p.add(b.old.v.multiplyScalar(c)),d&&b.v.multiplyScalar(d),b.a.clear())}};
x.NumericalIntegration=ka;ka=function(b,c){this.x=b||0;this.y=c||0};ka.prototype={set:function(b,c){this.x=b;this.y=c;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setComponent:function(b,c){switch(b){case 0:this.x=c;break;case 1:this.y=c;break;default:throw Error("index is out of range: "+b);}},getGradient:function(){if(this.x!=0)return Math.atan2(this.y,this.x);if(this.y>0)return Math.PI/2;if(this.y<0)return-Math.PI/2},getComponent:function(b){switch(b){case 0:return this.x;
case 1:return this.y;default:throw Error("index is out of range: "+b);}},copy:function(b){this.x=b.x;this.y=b.y;return this},add:function(b,d){if(d!==c)return this.addVectors(b,d);this.x=this.x+b.x;this.y=this.y+b.y;return this},addXY:function(b,c){this.x=this.x+b;this.y=this.y+c;return this},addVectors:function(b,c){this.x=b.x+c.x;this.y=b.y+c.y;return this},addScalar:function(b){this.x=this.x+b;this.y=this.y+b;return this},sub:function(b,d){if(d!==c)return this.subVectors(b,d);this.x=this.x-b.x;
this.y=this.y-b.y;return this},subVectors:function(b,c){this.x=b.x-c.x;this.y=b.y-c.y;return this},multiplyScalar:function(b){this.x=this.x*b;this.y=this.y*b;return this},divideScalar:function(b){b!==0?(this.x=this.x/b,this.y=this.y/b):this.set(0,0);return this},min:function(b){this.x>b.x&&(this.x=b.x);this.y>b.y&&(this.y=b.y);return this},max:function(b){this.x<b.x&&(this.x=b.x);this.y<b.y&&(this.y=b.y);return this},clamp:function(b,c){this.x<b.x?this.x=b.x:this.x>c.x&&(this.x=c.x);this.y<b.y?this.y=
b.y:this.y>c.y&&(this.y=c.y);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(b){return Math.sqrt(this.distanceToSquared(b))},rotate:function(b){var c=this.x,d=this.y;this.x=c*Math.cos(b)+d*Math.sin(b);this.y=-c*Math.sin(b)+d*Math.cos(b);
return this},distanceToSquared:function(b){var c=this.x-b.x,b=this.y-b.y;return c*c+b*b},setLength:function(b){var c=this.length();c!==0&&b!==c&&this.multiplyScalar(b/c);return this},lerp:function(b,c){this.x=this.x+(b.x-this.x)*c;this.y=this.y+(b.y-this.y)*c;return this},equals:function(b){return b.x===this.x&&b.y===this.y},toArray:function(){return[this.x,this.y]},clear:function(){this.y=this.x=0;return this},clone:function(){return new x.Vector2D(this.x,this.y)}};x.Vector2D=ka;ka=function(b,c){this.r=
Math.abs(b)||0;this.tha=c||0};ka.prototype={set:function(b,c){this.r=b;this.tha=c;return this},setR:function(b){this.r=b;return this},setTha:function(b){this.tha=b;return this},copy:function(b){this.r=b.r;this.tha=b.tha;return this},toVector:function(){return new x.Vector2D(this.getX(),this.getY())},getX:function(){return this.r*Math.sin(this.tha)},getY:function(){return-this.r*Math.cos(this.tha)},normalize:function(){this.r=1;return this},equals:function(b){return b.r===this.r&&b.tha===this.tha},
toArray:function(){return[this.r,this.tha]},clear:function(){this.tha=this.r=0;return this},clone:function(){return new x.Polar2D(this.r,this.tha)}};x.Polar2D=ka;aa.prototype={getValue:function(b){return this.isArray?this.a[Math.floor(this.a.length*Math.random())]:this.center?x.MathUtils.randomFloating(this.a,this.b,b):x.MathUtils.randomAToB(this.a,this.b,b)}};x.Span=aa;x.getSpan=function(b,c,d){return new x.Span(b,c,d)};x.Util.inherits(X,x.Span);X.prototype.getValue=function(){var b=this.colorArr[Math.floor(this.colorArr.length*
Math.random())];return b=="random"||b=="Random"?x.MathUtils.randomColor():b};x.ColorSpan=X;M.prototype={contains:function(b,c){return b<=this.right&&b>=this.x&&c<=this.bottom&&c>=this.y?true:false}};x.Rectangle=M;var va=va||{create:function(b){var c=new Float32Array(9);b&&this.set(b,c);return c},set:function(b,c){for(var d=0;d<9;d++)c[d]=b[d];return c},multiply:function(b,c,d){var e=b[0],f=b[1],g=b[2],h=b[3],j=b[4],k=b[6],b=b[7],l=c[0],m=c[1],n=c[2],o=c[3],p=c[4],q=c[6],c=c[7];d[0]=l*e+m*h;d[1]=l*
f+m*j;d[2]=g*n;d[3]=o*e+p*h;d[4]=o*f+p*j;d[6]=q*e+c*h+k;d[7]=q*f+c*j+b;return d},inverse:function(b,c){var d=b[0],e=b[1],f=b[3],g=b[4],h=b[6],j=b[7],k=-f,l;l=1/(d*g+e*k);c[0]=g*l;c[1]=-e*l;c[3]=k*l;c[4]=d*l;c[6]=(j*f-g*h)*l;c[7]=(-j*d+e*h)*l;return c},multiplyVec2:function(b,c,d){var e=c[0],c=c[1];d[0]=e*b[0]+c*b[3]+b[6];d[1]=e*b[1]+c*b[4]+b[7];return d}};x.Mat3=va;O.id=0;O.prototype={reset:function(b,c){this.life=x.Util.initValue(b,Infinity);this.easing=x.Util.initValue(c,x.ease.setEasingByName(x.easeLinear))},
normalizeForce:function(b){return b.multiplyScalar(x.MEASURE)},normalizeValue:function(b){return b*x.MEASURE},initialize:function(){},applyBehaviour:function(b,c){this.age=this.age+c;if(this.age>=this.life||this.dead){this.energy=0;this.dead=true;this.destory()}else{var d=this.easing(b.age/b.life);this.energy=Math.max(1-d,0)}},destory:function(){var b=this.parents.length,c;for(c=0;c<b;c++)this.parents[c].removeBehaviour(this);this.parents=[]}};x.Behaviour=O;Z.prototype={init:function(){this.startTime=
0;this.nextTime=this.timePan.getValue()},getValue:function(b){this.startTime=this.startTime+b;if(this.startTime>=this.nextTime){this.startTime=0;this.nextTime=this.timePan.getValue();return this.numPan.b==1?this.numPan.getValue(false)>0.5?1:0:this.numPan.getValue(true)}return 0}};x.Rate=Z;E.prototype.reset=function(){};E.prototype.init=function(b,c){c?this.initialize(c):this.initialize(b)};E.prototype.initialize=function(){};x.Initialize=E;x.InitializeUtil={initialize:function(b,c,d){var e=d.length,
f;for(f=0;f<e;f++)d[f]instanceof x.Initialize?d[f].init(b,c):x.InitializeUtil.init(b,c,d[f]);x.InitializeUtil.bindEmitter(b,c)},init:function(b,c,d){x.Util.setPrototypeByObject(c,d);x.Util.setVector2DByObject(c,d)},bindEmitter:function(b,c){b.bindEmitter&&(c.p.add(b.p),c.v.add(b.v),c.a.add(b.a),c.v.rotate(x.MathUtils.degreeTransform(b.rotation)))}};x.Util.inherits(B,x.Initialize);B.prototype.initialize=function(b){this.lifePan.a==Infinity?b.life=Infinity:b.life=this.lifePan.getValue()};x.Life=B;x.Util.inherits(Q,
x.Initialize);Q.prototype.reset=function(b){this.zone=x.Util.initValue(b,new x.PointZone)};Q.prototype.initialize=function(b){this.zone.getPosition();b.p.x=this.zone.vector.x;b.p.y=this.zone.vector.y};x.Position=Q;x.P=Q;x.Util.inherits(U,x.Initialize);U.prototype.reset=function(b,c,d){this.rPan=x.Util.setSpanValue(b);this.thaPan=x.Util.setSpanValue(c);this.type=x.Util.initValue(d,"vector")};U.prototype.normalizeVelocity=function(b){return b*x.MEASURE};U.prototype.initialize=function(b){if(this.type==
"p"||this.type=="P"||this.type=="polar"){var c=new x.Polar2D(this.normalizeVelocity(this.rPan.getValue()),this.thaPan.getValue()*Math.PI/180);b.v.x=c.getX();b.v.y=c.getY()}else{b.v.x=this.normalizeVelocity(this.rPan.getValue());b.v.y=this.normalizeVelocity(this.thaPan.getValue())}};x.Velocity=U;x.V=U;x.Util.inherits(N,x.Initialize);N.prototype.initialize=function(b){b.mass=this.massPan.getValue()};x.Mass=N;x.Util.inherits(J,x.Initialize);J.prototype.reset=function(b,c,d){this.radius=x.Util.setSpanValue(b,
c,d)};J.prototype.initialize=function(b){b.radius=this.radius.getValue();b.transform.oldRadius=b.radius};x.Radius=J;x.Util.inherits(I,x.Initialize);I.prototype.initialize=function(b){var c=this.image.getValue();typeof c=="string"?b.target={width:this.w,height:this.h,src:c}:b.target=c};I.prototype.setSpanValue=function(b){return b instanceof x.ColorSpan?b:new x.ColorSpan(b)};x.ImageTarget=I;x.Util.inherits(F,x.Behaviour);F.prototype.reset=function(b,c,d,e){this.force=this.normalizeForce(new x.Vector2D(b,
c));d&&F._super_.prototype.reset.call(this,d,e)};F.prototype.applyBehaviour=function(b,c,d){F._super_.prototype.applyBehaviour.call(this,b,c,d);b.a.add(this.force)};x.Force=F;x.F=F;x.Util.inherits(D,x.Behaviour);D.prototype.reset=function(b,c,d,e,f){this.targetPosition=x.Util.initValue(b,new x.Vector2D);this.radius=x.Util.initValue(d,1E3);this.force=x.Util.initValue(this.normalizeValue(c),100);this.radiusSq=this.radius*this.radius;this.attractionForce=new x.Vector2D;this.lengthSq=0;e&&D._super_.prototype.reset.call(this,
e,f)};D.prototype.applyBehaviour=function(b,c,d){D._super_.prototype.applyBehaviour.call(this,b,c,d);this.attractionForce.copy(this.targetPosition);this.attractionForce.sub(b.p);this.lengthSq=this.attractionForce.lengthSq();this.lengthSq>4.0E-6&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.multiplyScalar(1-this.lengthSq/this.radiusSq),this.attractionForce.multiplyScalar(this.force),b.a.add(this.attractionForce))};x.Attraction=D;x.Util.inherits(T,x.Behaviour);
T.prototype.reset=function(b,c,d,e,f){this.panFoce=new x.Vector2D(b,c);this.panFoce=this.normalizeForce(this.panFoce);this.delay=d;e&&T._super_.prototype.reset.call(this,e,f)};T.prototype.applyBehaviour=function(b,c,d){T._super_.prototype.applyBehaviour.call(this,b,c,d);this.time=this.time+c;this.time>=this.delay&&(b.a.addXY(x.MathUtils.randomAToB(-this.panFoce.x,this.panFoce.x),x.MathUtils.randomAToB(-this.panFoce.y,this.panFoce.y)),this.time=0)};x.RandomDrift=T;x.Util.inherits(P,x.Attraction);P.prototype.reset=
function(b,c,d,e,f){P._super_.prototype.reset.call(this,b,c,d,e,f);this.force=this.force*-1};x.Repulsion=P;x.Util.inherits(K,x.Force);K.prototype.reset=function(b,c,d){K._super_.prototype.reset.call(this,0,b,c,d)};x.Gravity=K;x.G=K;x.Util.inherits(H,x.Behaviour);H.prototype.reset=function(b,c,d,e,f){this.emitter=x.Util.initValue(b,null);this.mass=x.Util.initValue(c,true);this.callback=x.Util.initValue(d,null);this.collisionPool=[];this.delta=new x.Vector2D;e&&H._super_.prototype.reset.call(this,e,
f)};H.prototype.applyBehaviour=function(b,c,d){for(var c=this.emitter?this.emitter.particles.slice(d):this.pool.slice(d),e,f,g,h,j=c.length,k=0;k<j;k++){d=c[k];d!==b&&(this.delta.copy(d.p),this.delta.sub(b.p),e=this.delta.lengthSq(),distance=b.radius+d.radius,e<=distance*distance&&(f=distance-Math.sqrt(e),f=f+0.5,totalMass=b.mass+d.mass,g=this.mass?d.mass/totalMass:0.5,h=this.mass?b.mass/totalMass:0.5,b.p.add(this.delta.clone().normalize().multiplyScalar(f*-g)),d.p.add(this.delta.normalize().multiplyScalar(f*
h)),this.callback&&this.callback(b,d)))}};x.Collision=H;x.Util.inherits(G,x.Behaviour);G.prototype.reset=function(b,c,d,e){this.zone=b;this.zone.crossType=x.Util.initValue(c,"dead");d&&G._super_.prototype.reset.call(this,d,e)};G.prototype.applyBehaviour=function(b,c,d){G._super_.prototype.applyBehaviour.call(this,b,c,d);this.zone.crossing(b)};x.CrossZone=G;x.Util.inherits(C,x.Behaviour);C.prototype.reset=function(b,d,e,f){d==null||d==c?this.same=true:this.same=false;this.a=x.Util.setSpanValue(x.Util.initValue(b,
1));this.b=x.Util.setSpanValue(d);e&&C._super_.prototype.reset.call(this,e,f)};C.prototype.initialize=function(b){b.transform.alphaA=this.a.getValue();this.same?b.transform.alphaB=b.transform.alphaA:b.transform.alphaB=this.b.getValue()};C.prototype.applyBehaviour=function(b,c,d){C._super_.prototype.applyBehaviour.call(this,b,c,d);b.alpha=b.transform.alphaB+(b.transform.alphaA-b.transform.alphaB)*this.energy;b.alpha<0.001&&(b.alpha=0)};x.Alpha=C;x.Util.inherits(A,x.Behaviour);A.prototype.reset=function(b,
d,e,f){d==null||d==c?this.same=true:this.same=false;this.a=x.Util.setSpanValue(x.Util.initValue(b,1));this.b=x.Util.setSpanValue(d);e&&A._super_.prototype.reset.call(this,e,f)};A.prototype.initialize=function(b){b.transform.scaleA=this.a.getValue();b.transform.oldRadius=b.radius;this.same?b.transform.scaleB=b.transform.scaleA:b.transform.scaleB=this.b.getValue()};A.prototype.applyBehaviour=function(b,c,d){A._super_.prototype.applyBehaviour.call(this,b,c,d);b.scale=b.transform.scaleB+(b.transform.scaleA-
b.transform.scaleB)*this.energy;b.scale<1.0E-4&&(b.scale=0);b.radius=b.transform.oldRadius*b.scale};x.Scale=A;x.Util.inherits(z,x.Behaviour);z.prototype.reset=function(b,d,e,f,g){d==null||d==c?this.same=true:this.same=false;this.a=x.Util.setSpanValue(x.Util.initValue(b,"Velocity"));this.b=x.Util.setSpanValue(x.Util.initValue(d,0));this.style=x.Util.initValue(e,"to");f&&z._super_.prototype.reset.call(this,f,g)};z.prototype.initialize=function(b){b.rotation=this.a.getValue();b.transform.rotationA=this.a.getValue();
this.same||(b.transform.rotationB=this.b.getValue())};z.prototype.applyBehaviour=function(b,c,d){z._super_.prototype.applyBehaviour.call(this,b,c,d);if(this.same){if(this.a.a=="V"||this.a.a=="Velocity"||this.a.a=="v")b.rotation=b.getDirection()}else this.style=="to"||this.style=="TO"||this.style=="_"?b.rotation=b.rotation+(b.transform.rotationB+(b.transform.rotationA-b.transform.rotationB)*this.energy):b.rotation=b.rotation+b.transform.rotationB};x.Rotate=z;x.Util.inherits(w,x.Behaviour);w.prototype.reset=
function(b,c,d,e){this.color1=this.setSpanValue(b);this.color2=this.setSpanValue(c);d&&w._super_.prototype.reset.call(this,d,e)};w.prototype.initialize=function(b){b.color=this.color1.getValue();b.transform.beginRGB=x.Util.hexToRGB(b.color);this.color2&&(b.transform.endRGB=x.Util.hexToRGB(this.color2.getValue()))};w.prototype.applyBehaviour=function(b,c,d){this.color2?(w._super_.prototype.applyBehaviour.call(this,b,c,d),b.transform.rgb.r=b.transform.endRGB.r+(b.transform.beginRGB.r-b.transform.endRGB.r)*
this.energy,b.transform.rgb.g=b.transform.endRGB.g+(b.transform.beginRGB.g-b.transform.endRGB.g)*this.energy,b.transform.rgb.b=b.transform.endRGB.b+(b.transform.beginRGB.b-b.transform.endRGB.b)*this.energy,b.transform.rgb.r=parseInt(b.transform.rgb.r,10),b.transform.rgb.g=parseInt(b.transform.rgb.g,10),b.transform.rgb.b=parseInt(b.transform.rgb.b,10)):(b.transform.rgb.r=b.transform.beginRGB.r,b.transform.rgb.g=b.transform.beginRGB.g,b.transform.rgb.b=b.transform.beginRGB.b)};w.prototype.setSpanValue=
function(b){return b?b instanceof x.ColorSpan?b:new x.ColorSpan(b):null};x.Color=w;x.Util.inherits(u,x.Behaviour);u.prototype.reset=function(b,c,d,e){this.distanceVec=new x.Vector2D;this.centerPoint=x.Util.initValue(b,new x.Vector2D);this.force=x.Util.initValue(this.normalizeValue(c),100);d&&u._super_.prototype.reset.call(this,d,e)};u.prototype.initialize=function(){};u.prototype.applyBehaviour=function(b,c){this.distanceVec.set(this.centerPoint.x-b.p.x,this.centerPoint.y-b.p.y);var d=this.distanceVec.lengthSq();
if(d!=0){var e=this.distanceVec.length(),d=this.force*c/(d*e);b.v.x=b.v.x+d*this.distanceVec.x;b.v.y=b.v.y+d*this.distanceVec.y}};x.GravityWell=u;t.ID=0;x.Util.inherits(t,x.Particle);x.EventDispatcher.initialize(t.prototype);t.prototype.emit=function(b,c){this.emitTime=0;this.emitTotalTimes=x.Util.initValue(b,Infinity);c==true||c=="life"||c=="destroy"?b=="once"?this.life=1:this.life=this.emitTotalTimes:isNaN(c)||(this.life=c);this.rate.init()};t.prototype.stopEmit=function(){this.emitTotalTimes=-1;
this.emitTime=0};t.prototype.removeAllParticles=function(){for(var b=0;b<this.particles.length;b++)this.particles[b].dead=true};t.prototype.createParticle=function(b,c){var d=x.pool.get();this.setupParticle(d,b,c);this.dispatchEvent(new x.Event({type:x.PARTICLE_CREATED,particle:d}));return d};t.prototype.addSelfInitialize=function(b){b.init?b.init(this):this.initAll()};t.prototype.addInitialize=function(){var b=arguments.length,c;for(c=0;c<b;c++)this.initializes.push(arguments[c])};t.prototype.removeInitialize=
function(b){b=this.initializes.indexOf(b);b>-1&&this.initializes.splice(b,1)};t.prototype.removeInitializers=function(){x.Util.destroyArray(this.initializes)};t.prototype.addBehaviour=function(){var b=arguments.length,c;for(c=0;c<b;c++){this.behaviours.push(arguments[c]);arguments[c].hasOwnProperty("parents")&&arguments[c].parents.push(this)}};t.prototype.removeBehaviour=function(b){b=this.behaviours.indexOf(b);b>-1&&this.behaviours.splice(b,1)};t.prototype.removeAllBehaviours=function(){x.Util.destroyArray(this.behaviours)};
t.prototype.integrate=function(b){var c=1-this.damping;x.integrator.integrate(this,b,c);var d=this.particles.length,e;for(e=0;e<d;e++){var f=this.particles[e];f.update(b,e);x.integrator.integrate(f,b,c);this.dispatchEvent(new x.Event({type:x.PARTICLE_UPDATE,particle:f}))}};t.prototype.emitting=function(b){if(this.emitTotalTimes=="once"){var b=this.rate.getValue(99999),c;for(c=0;c<b;c++)this.createParticle();this.emitTotalTimes="none"}else if(!isNaN(this.emitTotalTimes)){this.emitTime=this.emitTime+
b;if(this.emitTime<this.emitTotalTimes){b=this.rate.getValue(b);for(c=0;c<b;c++)this.createParticle()}}};t.prototype.update=function(b){this.age=this.age+b;(this.age>=this.life||this.dead)&&this.destroy();this.emitting(b);this.integrate(b);var c;for(c=this.particles.length-1;c>=0;c--){b=this.particles[c];b.dead&&(x.pool.set(b),this.particles.splice(c,1),this.dispatchEvent(new x.Event({type:x.PARTICLE_DEAD,particle:b})))}};t.prototype.setupParticle=function(b,c,d){var e=this.initializes,f=this.behaviours;
c&&(c instanceof Array?e=c:e=[c]);d&&(d instanceof Array?f=d:f=[d]);x.InitializeUtil.initialize(this,b,e);b.addBehaviours(f);b.parent=this;this.particles.push(b)};t.prototype.destroy=function(){this.dead=true;this.emitTotalTimes=-1;this.particles.length==0&&(this.removeInitializers(),this.removeAllBehaviours(),this.parent&&this.parent.removeEmitter(this))};x.Emitter=t;x.Util.inherits(o,x.Emitter);o.prototype.addSelfBehaviour=function(){var b=arguments.length,c;for(c=0;c<b;c++)this.selfBehaviours.push(arguments[c])};
o.prototype.removeSelfBehaviour=function(b){b=this.selfBehaviours.indexOf(b);b>-1&&this.selfBehaviours.splice(b,1)};o.prototype.update=function(b){o._super_.prototype.update.call(this,b);if(!this.sleep){var c=this.selfBehaviours.length,d;for(d=0;d<c;d++)this.selfBehaviours[d].applyBehaviour(this,b,d)}};x.BehaviourEmitter=o;x.Util.inherits(r,x.Emitter);r.prototype.initEventHandler=function(){var b=this;this.mousemoveHandler=function(c){b.mousemove.call(b,c)};this.mousedownHandler=function(c){b.mousedown.call(b,
c)};this.mouseupHandler=function(c){b.mouseup.call(b,c)};this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,false)};r.prototype.emit=function(){this._allowEmitting=true};r.prototype.stopEmit=function(){this._allowEmitting=false};r.prototype.mousemove=function(b){if(b.layerX||b.layerX==0){this.p.x=this.p.x+(b.layerX-this.p.x)*this.ease;this.p.y=this.p.y+(b.layerY-this.p.y)*this.ease}else if(b.offsetX||b.offsetX==0){this.p.x=this.p.x+(b.offsetX-this.p.x)*this.ease;this.p.y=this.p.y+
(b.offsetY-this.p.y)*this.ease}this._allowEmitting&&r._super_.prototype.emit.call(this,"once")};r.prototype.destroy=function(){r._super_.prototype.destroy.call(this);this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,false)};x.FollowEmitter=r;var ta=ta||{easeLinear:function(b){return b},easeInQuad:function(b){return Math.pow(b,2)},easeOutQuad:function(b){return-(Math.pow(b-1,2)-1)},easeInOutQuad:function(b){return(b=b/0.5)<1?0.5*Math.pow(b,2):-0.5*((b=b-2)*b-2)},easeInCubic:function(b){return Math.pow(b,
3)},easeOutCubic:function(b){return Math.pow(b-1,3)+1},easeInOutCubic:function(b){return(b=b/0.5)<1?0.5*Math.pow(b,3):0.5*(Math.pow(b-2,3)+2)},easeInQuart:function(b){return Math.pow(b,4)},easeOutQuart:function(b){return-(Math.pow(b-1,4)-1)},easeInOutQuart:function(b){return(b=b/0.5)<1?0.5*Math.pow(b,4):-0.5*((b=b-2)*Math.pow(b,3)-2)},easeInSine:function(b){return-Math.cos(b*(Math.PI/2))+1},easeOutSine:function(b){return Math.sin(b*(Math.PI/2))},easeInOutSine:function(b){return-0.5*(Math.cos(Math.PI*
b)-1)},easeInExpo:function(b){return b===0?0:Math.pow(2,10*(b-1))},easeOutExpo:function(b){return b===1?1:-Math.pow(2,-10*b)+1},easeInOutExpo:function(b){return b===0?0:b===1?1:(b=b/0.5)<1?0.5*Math.pow(2,10*(b-1)):0.5*(-Math.pow(2,-10*--b)+2)},easeInCirc:function(b){return-(Math.sqrt(1-b*b)-1)},easeOutCirc:function(b){return Math.sqrt(1-Math.pow(b-1,2))},easeInOutCirc:function(b){return(b=b/0.5)<1?-0.5*(Math.sqrt(1-b*b)-1):0.5*(Math.sqrt(1-(b=b-2)*b)+1)},easeInBack:function(b){return b*b*(2.70158*
b-1.70158)},easeOutBack:function(b){return(b=b-1)*b*(2.70158*b+1.70158)+1},easeInOutBack:function(b){var c=1.70158;return(b=b/0.5)<1?0.5*b*b*(((c=c*1.525)+1)*b-c):0.5*((b=b-2)*b*(((c=c*1.525)+1)*b+c)+2)},setEasingByName:function(b){switch(b){case "easeLinear":return x.ease.easeLinear;case "easeInQuad":return x.ease.easeInQuad;case "easeOutQuad":return x.ease.easeOutQuad;case "easeInOutQuad":return x.ease.easeInOutQuad;case "easeInCubic":return x.ease.easeInCubic;case "easeOutCubic":return x.ease.easeOutCubic;
case "easeInOutCubic":return x.ease.easeInOutCubic;case "easeInQuart":return x.ease.easeInQuart;case "easeOutQuart":return x.ease.easeOutQuart;case "easeInOutQuart":return x.ease.easeInOutQuart;case "easeInSine":return x.ease.easeInSine;case "easeOutSine":return x.ease.easeOutSine;case "easeInOutSine":return x.ease.easeInOutSine;case "easeInExpo":return x.ease.easeInExpo;case "easeOutExpo":return x.ease.easeOutExpo;case "easeInOutExpo":return x.ease.easeInOutExpo;case "easeInCirc":return x.ease.easeInCirc;
case "easeOutCirc":return x.ease.easeOutCirc;case "easeInOutCirc":return x.ease.easeInOutCirc;case "easeInBack":return x.ease.easeInBack;case "easeOutBack":return x.ease.easeOutBack;case "easeInOutBack":return x.ease.easeInOutBack;default:return x.ease.easeLinear}}};x.ease=ta;x.easeLinear="easeLinear";x.easeInQuad="easeInQuad";x.easeOutQuad="easeOutQuad";x.easeInOutQuad="easeInOutQuad";x.easeInCubic="easeInCubic";x.easeOutCubic="easeOutCubic";x.easeInOutCubic="easeInOutCubic";x.easeInQuart="easeInQuart";
x.easeOutQuart="easeOutQuart";x.easeInOutQuart="easeInOutQuart";x.easeInSine="easeInSine";x.easeOutSine="easeOutSine";x.easeInOutSine="easeInOutSine";x.easeInExpo="easeInExpo";x.easeOutExpo="easeOutExpo";x.easeInOutExpo="easeInOutExpo";x.easeInCirc="easeInCirc";x.easeOutCirc="easeOutCirc";x.easeInOutCirc="easeInOutCirc";x.easeInBack="easeInBack";x.easeOutBack="easeOutBack";x.easeInOutBack="easeInOutBack";s.prototype={start:function(){this.addEventHandler();this.renderer.start()},stop:function(){this.renderer.stop()},
resize:function(b,c){this.renderer.resize(b,c)},setStroke:function(b,c){this.renderer.hasOwnProperty("stroke")?this.renderer.setStroke(b,c):alert("Sorry this renderer do not suppest stroke method!")},createImageData:function(b){this.renderer instanceof x.PixelRender&&this.renderer.createImageData(b)},setMaxRadius:function(b){this.renderer instanceof x.WebGLRender&&this.renderer.setMaxRadius(b)},blendEquation:function(b){this.renderer instanceof x.WebGLRender&&this.renderer.blendEquation(b)},blendFunc:function(b,
c){this.renderer instanceof x.WebGLRender&&this.renderer.blendFunc(b,c)},setType:function(b){this.type=b;this.renderer=this.getRenderer()},getRenderer:function(){switch(this.type){case "dom":return new x.DomRender(this.proton,this.element);case "canvas":return new x.CanvasRender(this.proton,this.element);case "webgl":return new x.WebGLRender(this.proton,this.element);case "easel":return new x.EaselRender(this.proton,this.element);case "easeljs":return new x.EaselRender(this.proton,this.element);case "pixel":return new x.PixelRender(this.proton,
this.element);default:return new x.BaseRender(this.proton,this.element)}},render:function(b){this.renderer.render(b)},addEventHandler:function(){this.onProtonUpdate&&(this.renderer.onProtonUpdate=this.onProtonUpdate);this.onParticleCreated&&(this.renderer.onParticleCreated=this.onParticleCreated);this.onParticleUpdate&&(this.renderer.onParticleUpdate=this.onParticleUpdate);this.onParticleDead&&(this.renderer.onParticleDead=this.onParticleDead)}};x.Renderer=s;p.prototype={start:function(){var b=this;
this.proton.addEventListener(x.PROTON_UPDATE,function(){b.onProtonUpdate.call(b)});this.proton.addEventListener(x.PROTON_UPDATE_AFTER,function(){b.onProtonUpdateAfter.call(b)});this.proton.addEventListener(x.EMITTER_ADDED,function(c){b.onEmitterAdded.call(b,c.emitter)});this.proton.addEventListener(x.EMITTER_REMOVED,function(c){b.onEmitterRemoved.call(b,c.emitter)});var c=this.proton.emitters.length,d;for(d=0;d<c;d++)this.addEmitterListener(this.proton.emitters[d])},resize:function(){},addEmitterListener:function(b){var c=
this;b.addEventListener(x.PARTICLE_CREATED,function(b){c.onParticleCreated.call(c,b.particle)});b.addEventListener(x.PARTICLE_UPDATE,function(b){c.onParticleUpdate.call(c,b.particle)});b.addEventListener(x.PARTICLE_DEAD,function(b){c.onParticleDead.call(c,b.particle)})},stop:function(){var b=this.proton.emitters.length,c;this.proton.removeAllEventListeners();for(c=0;c<b;c++)this.proton.emitters[c].removeAllEventListeners()},onEmitterAdded:function(b){this.addEmitterListener(b)},onEmitterRemoved:function(b){b.removeAllEventListeners()},
onProtonUpdate:function(){},onProtonUpdateAfter:function(){},onParticleCreated:function(){},onParticleUpdate:function(){},onParticleDead:function(){}};x.BaseRender=p;x.Util.inherits(q,x.BaseRender);q.prototype.start=function(){q._super_.prototype.start.call(this)};q.prototype.setStroke=function(b,c){b=x.Util.initValue(b,"#000000");c=x.Util.initValue(c,1);this.stroke={color:b,thinkness:c}};q.prototype.onProtonUpdate=function(){};q.prototype.onParticleCreated=function(b){if(b.target){var c=this;x.Util.getImage(b.target,
b,false,function(b){c.setImgInDIV.call(c,b)})}else{b.transform.canvas=x.DomUtil.createCanvas(b.id+"_canvas",b.radius+1,b.radius+1,"absolute");b.transform.bakOldRadius=b.radius;this.stroke?(b.transform.canvas.width=2*b.radius+this.stroke.thinkness*2,b.transform.canvas.height=2*b.radius+this.stroke.thinkness*2):(b.transform.canvas.width=2*b.radius+1,b.transform.canvas.height=2*b.radius+1);b.transform.context=b.transform.canvas.getContext("2d");b.transform.context.fillStyle=b.color;b.transform.context.beginPath();
b.transform.context.arc(b.radius,b.radius,b.radius,0,Math.PI*2,true);this.stroke&&(b.transform.context.strokeStyle=this.stroke.color,b.transform.context.lineWidth=this.stroke.thinkness,b.transform.context.stroke());b.transform.context.closePath();b.transform.context.fill();this.element.appendChild(b.transform.canvas)}};q.prototype.onParticleUpdate=function(b){b.target?b.target instanceof Image&&(b.transform.canvas.style.opacity=b.alpha,x.DomUtil.transformDom(b.transform.canvas,b.p.x-b.target.width/
2,b.p.y-b.target.height/2,b.scale,b.rotation)):(b.transform.canvas.style.opacity=b.alpha,b.transform.oldRadius?x.DomUtil.transformDom(b.transform.canvas,b.p.x-b.transform.oldRadius,b.p.y-b.transform.oldRadius,b.scale,b.rotation):x.DomUtil.transformDom(b.transform.canvas,b.p.x-b.transform.bakOldRadius,b.p.y-b.transform.bakOldRadius,b.scale,b.rotation))};q.prototype.onParticleDead=function(b){b.transform.canvas&&this.element.removeChild(b.transform.canvas)};q.prototype.setImgInDIV=function(b){b.transform.canvas=
x.DomUtil.createCanvas(b.id+"_canvas",b.target.width+1,b.target.height+1,"absolute",b.p.x-b.radius,b.p.y-b.radius);b.transform.context=b.transform.canvas.getContext("2d");b.transform.context.drawImage(b.target,0,0,b.target.width,b.target.height);this.element.appendChild(b.transform.canvas)};x.DomRender=q;x.Util.inherits(n,x.BaseRender);n.prototype.resize=function(){};n.prototype.start=function(){n._super_.prototype.start.call(this)};n.prototype.onProtonUpdate=function(){};n.prototype.onParticleCreated=
function(b){if(b.target){b.target=b.target.clone();b.target.parent||(!b.target.image||(b.target.regX=b.target.image.width/2,b.target.regY=b.target.image.height/2),this.element.addChild(b.target))}else{var c=new createjs.Graphics;this.stroke&&(this.stroke==true?c.beginStroke("#000000"):this.stroke instanceof String&&c.beginStroke(this.stroke));c.beginFill(b.color).drawCircle(0,0,b.radius);c=new createjs.Shape(c);b.target=c;this.element.addChild(b.target)}};n.prototype.onParticleUpdate=function(b){b.target&&
(b.target.x=b.p.x,b.target.y=b.p.y,b.target.alpha=b.alpha,b.target.scaleX=b.target.scaleY=b.scale,b.target.rotation=b.rotation)};n.prototype.onParticleDead=function(b){b.target&&b.target.parent&&b.target.parent.removeChild(b.target)};x.EaselRender=n;x.Util.inherits(m,x.BaseRender);m.prototype.resize=function(b,c){this.element.width=b;this.element.height=c};m.prototype.start=function(){m._super_.prototype.start.call(this)};m.prototype.setStroke=function(b,c){b=x.Util.initValue(b,"#000000");c=x.Util.initValue(c,
1);this.stroke={color:b,thinkness:c}};m.prototype.onProtonUpdate=function(){this.context.clearRect(0,0,this.element.width,this.element.height)};m.prototype.onParticleCreated=function(b){b.target?x.Util.getImage(b.target,b,false):b.color=b.color?b.color:"#ff0000"};m.prototype.onParticleUpdate=function(b){if(b.target){if(b.target instanceof Image){var c=b.target.width*b.scale|0,d=b.target.height*b.scale|0,e=b.p.x-c/2,f=b.p.y-d/2;if(b.color){b.transform.buffer||(b.transform.buffer=this.getBuffer(b.target));
var g=b.transform.buffer.getContext("2d");g.clearRect(0,0,b.transform.buffer.width,b.transform.buffer.height);g.globalAlpha=b.alpha;g.drawImage(b.target,0,0);g.globalCompositeOperation="source-atop";g.fillStyle=x.Util.rgbToHex(b.transform.rgb);g.fillRect(0,0,b.transform.buffer.width,b.transform.buffer.height);g.globalCompositeOperation="source-over";g.globalAlpha=1;this.context.drawImage(b.transform.buffer,0,0,b.transform.buffer.width,b.transform.buffer.height,e,f,c,d)}else{this.context.save();this.context.globalAlpha=
b.alpha;this.context.translate(b.p.x,b.p.y);this.context.rotate(x.MathUtils.degreeTransform(b.rotation));this.context.translate(-b.p.x,-b.p.y);this.context.drawImage(b.target,0,0,b.target.width,b.target.height,e,f,c,d);this.context.globalAlpha=1;this.context.restore()}}}else{b.transform.rgb?this.context.fillStyle="rgba("+b.transform.rgb.r+","+b.transform.rgb.g+","+b.transform.rgb.b+","+b.alpha+")":this.context.fillStyle=b.color;this.context.beginPath();this.context.arc(b.p.x,b.p.y,b.radius,0,Math.PI*
2,true);this.stroke&&(this.context.strokeStyle=this.stroke.color,this.context.lineWidth=this.stroke.thinkness,this.context.stroke());this.context.closePath();this.context.fill()}};m.prototype.onParticleDead=function(){};m.prototype.getBuffer=function(b){if(b instanceof Image){var c=b.width+"_"+b.height,d=this.bufferCache[c];d||(d=document.createElement("canvas"),d.width=b.width,d.height=b.height,this.bufferCache[c]=d);return d}};x.CanvasRender=m;x.Util.inherits(l,x.BaseRender);l.prototype.resize=
function(b,c){this.element.width=b;this.element.height=c};l.prototype.createImageData=function(b){b?this.rectangle=b:this.rectangle=new x.Rectangle(0,0,this.element.width,this.element.height);this.imageData=this.context.createImageData(this.rectangle.width,this.rectangle.height);this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)};l.prototype.start=function(){l._super_.prototype.start.call(this)};l.prototype.onProtonUpdate=function(){this.context.clearRect(this.rectangle.x,
this.rectangle.y,this.rectangle.width,this.rectangle.height);this.imageData=this.context.getImageData(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height)};l.prototype.onProtonUpdateAfter=function(){this.context.putImageData(this.imageData,this.rectangle.x,this.rectangle.y)};l.prototype.onParticleCreated=function(){};l.prototype.onParticleUpdate=function(b){this.imageData&&this.setPixel(this.imageData,Math.floor(b.p.x-this.rectangle.x),Math.floor(b.p.y-this.rectangle.y),b)};
l.prototype.setPixel=function(b,c,d,e){var f=e.transform.rgb;if(!(c<0||c>this.element.width||d<0||d>this.elementwidth)){c=((d>>0)*b.width+(c>>0))*4;b.data[c]=f.r;b.data[c+1]=f.g;b.data[c+2]=f.b;b.data[c+3]=e.alpha*255}};l.prototype.onParticleDead=function(){};x.PixelRender=l;x.Util.inherits(k,x.BaseRender);k.prototype.resize=function(b,c){this.umat[4]=-2;this.umat[7]=1;this.smat[0]=1/b;this.smat[4]=1/c;this.mstack.set(this.umat,0);this.mstack.set(this.smat,1);this.gl.viewport(0,0,b,c);this.element.width=
b;this.element.height=c};k.prototype.setMaxRadius=function(b){this.circleCanvasURL=this.createCircle(b)};k.prototype.getVertexShader=function(){return"uniform vec2 viewport;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 tMat;\nvarying vec2 vTextureCoord;\nvarying float alpha;\nvoid main() {\nvec3 v = tMat * vec3(aVertexPosition, 1.0);\ngl_Position = vec4(v.x, v.y, 0, 1);\nvTextureCoord = aTextureCoord;\nalpha = tMat[0][2];\n}"};k.prototype.getFragmentShader=function(){return"precision mediump float;\nvarying vec2 vTextureCoord;\nvarying float alpha;\nuniform sampler2D uSampler;\nuniform vec4 color;\nuniform bool useTexture;\nuniform vec3 uColor;\nvoid main() {\nvec4 textureColor = texture2D(uSampler, vTextureCoord);\ngl_FragColor = textureColor * vec4(uColor, 1.0);\ngl_FragColor.w *= alpha;\n}"};
k.prototype.initVar=function(){this.mstack=new x.MStack;this.umat=x.Mat3.create([2,0,1,0,-2,0,-1,1,1]);this.smat=x.Mat3.create([0.01,0,1,0,0.01,0,0,0,1]);this.texturebuffers={}};k.prototype.start=function(){k._super_.prototype.start.call(this);this.resize(this.element.width,this.element.height)};k.prototype.blendEquation=function(b){this.gl.blendEquation(this.gl[b])};k.prototype.blendFunc=function(b,c){this.gl.blendFunc(this.gl[b],this.gl[c])};k.prototype.getShader=function(b,c,d){var e;d?e=b.createShader(b.FRAGMENT_SHADER):
e=b.createShader(b.VERTEX_SHADER);b.shaderSource(e,c);b.compileShader(e);if(!b.getShaderParameter(e,b.COMPILE_STATUS)){alert(b.getShaderInfoLog(e));return null}return e};k.prototype.initShaders=function(){var b=this.getShader(this.gl,this.getFragmentShader(),true),c=this.getShader(this.gl,this.getVertexShader(),false);this.sprogram=this.gl.createProgram();this.gl.attachShader(this.sprogram,c);this.gl.attachShader(this.sprogram,b);this.gl.linkProgram(this.sprogram);this.gl.getProgramParameter(this.sprogram,
this.gl.LINK_STATUS)||alert("Could not initialise shaders");this.gl.useProgram(this.sprogram);this.sprogram.vpa=this.gl.getAttribLocation(this.sprogram,"aVertexPosition");this.sprogram.tca=this.gl.getAttribLocation(this.sprogram,"aTextureCoord");this.gl.enableVertexAttribArray(this.sprogram.tca);this.gl.enableVertexAttribArray(this.sprogram.vpa);this.sprogram.tMatUniform=this.gl.getUniformLocation(this.sprogram,"tMat");this.sprogram.samplerUniform=this.gl.getUniformLocation(this.sprogram,"uSampler");
this.sprogram.useTex=this.gl.getUniformLocation(this.sprogram,"useTexture");this.sprogram.color=this.gl.getUniformLocation(this.sprogram,"uColor");this.gl.uniform1i(this.sprogram.useTex,1)};k.prototype.initBuffers=function(){this.unitIBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,3,1,0,2,3]),this.gl.STATIC_DRAW);for(var b=[],c=0;c<100;c++)b.push(c);idx=new Uint16Array(b);this.unitI33=
this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitI33);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,idx,this.gl.STATIC_DRAW);b=[];for(c=0;c<100;c++)b.push(c,c+1,c+2);idx=new Uint16Array(b);this.stripBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.stripBuffer);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,idx,this.gl.STATIC_DRAW)};k.prototype.createCircle=function(b){this.circleCanvasRadius=x.WebGLUtil.nhpot(x.Util.initValue(b,32));
var b=x.DomUtil.createCanvas("circle_canvas",this.circleCanvasRadius*2,this.circleCanvasRadius*2),c=b.getContext("2d");c.beginPath();c.arc(this.circleCanvasRadius,this.circleCanvasRadius,this.circleCanvasRadius,0,Math.PI*2,true);c.closePath();c.fillStyle="#FFF";c.fill();return b.toDataURL()};k.prototype.setImgInCanvas=function(b){var c=b.target.width,d=b.target.height,e=x.WebGLUtil.nhpot(b.target.width),f=x.WebGLUtil.nhpot(b.target.height),g=b.target.width/e,h=b.target.height/f;this.texturebuffers[b.transform.src]||
(this.texturebuffers[b.transform.src]=[this.gl.createTexture(),this.gl.createBuffer(),this.gl.createBuffer()]);b.transform.texture=this.texturebuffers[b.transform.src][0];b.transform.vcBuffer=this.texturebuffers[b.transform.src][1];b.transform.tcBuffer=this.texturebuffers[b.transform.src][2];this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.transform.tcBuffer);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,g,0,0,h,h,h]),this.gl.STATIC_DRAW);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.transform.vcBuffer);
this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,c,0,0,d,c,d]),this.gl.STATIC_DRAW);e=b.transform.canvas.getContext("2d").getImageData(0,0,e,f);this.gl.bindTexture(this.gl.TEXTURE_2D,b.transform.texture);this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_NEAREST);this.gl.generateMipmap(this.gl.TEXTURE_2D);
b.transform.textureLoaded=true;b.transform.textureWidth=c;b.transform.textureHeight=d};k.prototype.setStroke=function(){};k.prototype.onProtonUpdate=function(){};k.prototype.onParticleCreated=function(b){var c=this;b.transform.textureLoaded=false;b.transform.tmat=x.Mat3.create();b.transform.tmat[8]=1;b.transform.imat=x.Mat3.create();b.transform.imat[8]=1;b.target?x.Util.getImage(b.target,b,true,function(b){c.setImgInCanvas.call(c,b);b.transform.oldScale=1}):x.Util.getImage(this.circleCanvasURL,b,
true,function(b){c.setImgInCanvas.call(c,b);b.transform.oldScale=b.radius/c.circleCanvasRadius})};k.prototype.onParticleUpdate=function(b){b.transform.textureLoaded&&(this.updateMatrix(b),this.gl.uniform3f(this.sprogram.color,b.transform.rgb.r/255,b.transform.rgb.g/255,b.transform.rgb.b/255),this.gl.uniformMatrix3fv(this.sprogram.tMatUniform,false,this.mstack.top()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.transform.vcBuffer),this.gl.vertexAttribPointer(this.sprogram.vpa,2,this.gl.FLOAT,false,0,
0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.transform.tcBuffer),this.gl.vertexAttribPointer(this.sprogram.tca,2,this.gl.FLOAT,false,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,b.transform.texture),this.gl.uniform1i(this.sprogram.samplerUniform,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.unitIBuffer),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0),this.mstack.pop())};k.prototype.onParticleDead=function(){};k.prototype.updateMatrix=function(b){var c=x.WebGLUtil.makeTranslation(-b.transform.textureWidth/
2,-b.transform.textureHeight/2),d=x.WebGLUtil.makeTranslation(b.p.x,b.p.y),e=x.WebGLUtil.makeRotation(b.rotation*(Math.PI/180)),f=b.scale*b.transform.oldScale,f=x.WebGLUtil.makeScale(f,f),c=x.WebGLUtil.matrixMultiply(c,f),c=x.WebGLUtil.matrixMultiply(c,e),c=x.WebGLUtil.matrixMultiply(c,d);x.Mat3.inverse(c,b.transform.imat);c[2]=b.alpha;this.mstack.push(c)};x.WebGLRender=k;j.prototype={getPosition:function(){},crossing:function(){}};x.Zone=j;x.Util.inherits(h,x.Zone);h.prototype.getPosition=function(){this.random=
Math.random();this.vector.x=this.x1+this.random*this.length*Math.cos(this.gradient);this.vector.y=this.y1+this.random*this.length*Math.sin(this.gradient);return this.vector};h.prototype.getDirection=function(b,c){var d=-this.dx;return(this.dy*b+d*c+this.dot)*(d==0?1:d)>0?true:false};h.prototype.getDistance=function(b,c){return(this.dy*b+-this.dx*c+this.dot)/Math.sqrt(this.xxyy)};h.prototype.getSymmetric=function(b){var c=b.getGradient(),c=2*(this.getGradient()-c),d=b.x,e=b.y;b.x=d*Math.cos(c)-e*Math.sin(c);
b.y=d*Math.sin(c)+e*Math.cos(c);return b};h.prototype.getGradient=function(){return Math.atan2(this.dy,this.dx)};h.prototype.getRange=function(b,c){Math.abs(this.getGradient())<=Math.PI/4?b.p.x<this.maxx&&b.p.x>this.minx&&c():b.p.y<this.maxy&&b.p.y>this.miny&&c()};h.prototype.getLength=function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)};h.prototype.crossing=function(b){var c=this;this.crossType=="dead"?this.direction==">"||this.direction=="R"||this.direction=="right"||this.direction=="down"?
this.getRange(b,function(){c.getDirection(b.p.x,b.p.y)&&(b.dead=true)}):this.getRange(b,function(){c.getDirection(b.p.x,b.p.y)||(b.dead=true)}):this.crossType=="bound"?this.getRange(b,function(){c.getDistance(b.p.x,b.p.y)<=b.radius&&(c.dx==0?b.v.x=b.v.x*-1:c.dy==0?b.v.y=b.v.y*-1:c.getSymmetric(b.v))}):this.crossType=="cross"&&this.alert&&(alert("Sorry lineZone does not support cross method"),this.alert=false)};x.LineZone=h;x.Util.inherits(g,x.Zone);g.prototype.getPosition=function(){this.random=Math.random();
this.angle=Math.PI*2*Math.random();this.vector.x=this.x+this.random*this.radius*Math.cos(this.angle);this.vector.y=this.y+this.random*this.radius*Math.sin(this.angle);return this.vector};g.prototype.setCenter=function(b,c){this.center.x=b;this.center.y=c};g.prototype.crossing=function(b){var c=b.p.distanceTo(this.center);this.crossType=="dead"?c-b.radius>this.radius&&(b.dead=true):this.crossType=="bound"?c+b.radius>=this.radius&&this.getSymmetric(b):this.crossType=="cross"&&this.alert&&(alert("Sorry CircleZone does not support cross method"),
this.alert=false)};g.prototype.getSymmetric=function(b){var c=b.v.getGradient(),c=2*(this.getGradient(b)-c),d=b.v.x,e=b.v.y;b.v.x=d*Math.cos(c)-e*Math.sin(c);b.v.y=d*Math.sin(c)+e*Math.cos(c)};g.prototype.getGradient=function(b){return-Math.PI/2+Math.atan2(b.p.y-this.center.y,b.p.x-this.center.x)};x.CircleZone=g;x.Util.inherits(f,x.Zone);f.prototype.getPosition=function(){this.vector.x=this.x;this.vector.y=this.y;return this.vector};f.prototype.crossing=function(){this.alert&&(alert("Sorry PointZone does not support crossing method"),
this.alert=false)};x.PointZone=f;x.Util.inherits(e,x.Zone);e.prototype.getPosition=function(){this.vector.x=this.x+Math.random()*this.width;this.vector.y=this.y+Math.random()*this.height;return this.vector};e.prototype.crossing=function(b){this.crossType=="dead"?(b.p.x+b.radius<this.x?b.dead=true:b.p.x-b.radius>this.x+this.width&&(b.dead=true),b.p.y+b.radius<this.y?b.dead=true:b.p.y-b.radius>this.y+this.height&&(b.dead=true)):this.crossType=="bound"?(b.p.x-b.radius<this.x?(b.p.x=this.x+b.radius,b.v.x=
b.v.x*-1):b.p.x+b.radius>this.x+this.width&&(b.p.x=this.x+this.width-b.radius,b.v.x=b.v.x*-1),b.p.y-b.radius<this.y?(b.p.y=this.y+b.radius,b.v.y=b.v.y*-1):b.p.y+b.radius>this.y+this.height&&(b.p.y=this.y+this.height-b.radius,b.v.y=b.v.y*-1)):this.crossType=="cross"&&(b.p.x+b.radius<this.x&&b.v.x<=0?b.p.x=this.x+this.width+b.radius:b.p.x-b.radius>this.x+this.width&&b.v.x>=0&&(b.p.x=this.x-b.radius),b.p.y+b.radius<this.y&&b.v.y<=0?b.p.y=this.y+this.height+b.radius:b.p.y-b.radius>this.y+this.height&&
b.v.y>=0&&(b.p.y=this.y-b.radius))};x.RectZone=e;x.Util.inherits(d,x.Zone);d.prototype.reset=function(b,c,d,e){this.imageData=b;this.x=x.Util.initValue(c,0);this.y=x.Util.initValue(d,0);this.d=x.Util.initValue(e,2);this.vectors=[];this.setVectors()};d.prototype.setVectors=function(){var b,c,d=this.imageData.width,e=this.imageData.height;for(b=0;b<d;b=b+this.d)for(c=0;c<e;c=c+this.d)this.imageData.data[((c>>0)*d+(b>>0))*4+3]>0&&this.vectors.push({x:b+this.x,y:c+this.y});return this.vector};d.prototype.getBound=
function(b,c){return this.imageData.data[((c>>0)*this.imageData.width+(b>>0))*4+3]>0?true:false};d.prototype.getPosition=function(){return this.vector.copy(this.vectors[Math.floor(Math.random()*this.vectors.length)])};d.prototype.getColor=function(b,c){var b=b-this.x,c=c-this.y,d=((c>>0)*this.imageData.width+(b>>0))*4;return{r:this.imageData.data[d],g:this.imageData.data[d+1],b:this.imageData.data[d+2],a:this.imageData.data[d+3]}};d.prototype.crossing=function(b){this.crossType=="dead"?this.getBound(b.p.x-
this.x,b.p.y-this.y)?b.dead=true:b.dead=false:this.crossType=="bound"&&(this.getBound(b.p.x-this.x,b.p.y-this.y)||b.v.negate())};x.ImageZone=d;var sa=function(){if(b.console&&b.console.log){var c=arguments;if(typeof arguments[0]=="string")if(arguments[0].indexOf("+")==0){var d=parseInt(arguments[0]);sa.once<d&&(delete c[0],console.log(c),sa.once++)}else console.log(c);else console.log(c)}};sa.once=0;x.log=sa;var Da=Da||{addEventListener:function(b,c){b.addEventListener(x.PROTON_UPDATE,function(){c()})},
setStyle:function(b){b=x.Util.hexToRGB(b||"#ff0000");return"rgba("+b.r+","+b.g+","+b.b+",0.5)"},drawZone:function(b,c,d,e){var f=c.getContext("2d"),g=this.setStyle();this.addEventListener(b,function(){e&&f.clearRect(0,0,c.width,c.height);d instanceof x.PointZone?(f.beginPath(),f.fillStyle=g,f.arc(d.x,d.y,10,0,Math.PI*2,true),f.fill(),f.closePath()):d instanceof x.LineZone?(f.beginPath(),f.strokeStyle=g,f.moveTo(d.x1,d.y1),f.lineTo(d.x2,d.y2),f.stroke(),f.closePath()):d instanceof x.RectZone?(f.beginPath(),
f.strokeStyle=g,f.drawRect(d.x,d.y,d.width,d.height),f.stroke(),f.closePath()):d instanceof x.CircleZone&&(f.beginPath(),f.strokeStyle=g,f.arc(d.x,d.y,d.radius,0,Math.PI*2,true),f.stroke(),f.closePath())})},drawEmitter:function(b,c,d,e){var f=c.getContext("2d"),g=this.setStyle();this.addEventListener(b,function(){e&&f.clearRect(0,0,c.width,c.height);f.beginPath();f.fillStyle=g;f.arc(d.p.x,d.p.y,10,0,Math.PI*2,true);f.fill();f.closePath()})},test:{},setTest:function(b,c){this.test[b]=c},getTest:function(b){return this.test.hasOwnProperty(b)?
this.test[b]:false}};x.Debug=Da})(window);
(function(){for(var b=0,c=["ms","moz","webkit","o"],d=0;d<c.length&&!window.requestAnimationFrame;++d){window.requestAnimationFrame=window[c[d]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[c[d]+"CancelAnimationFrame"]||window[c[d]+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(c){var d=(new Date).getTime(),g=Math.max(0,16-(d-b)),h=window.setTimeout(function(){c(d+g)},g);b=d+g;return h});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(b){clearTimeout(b)})})();function _log(){}function setPreference(b,c){prefs[b]=c;$.ajax({url:"api/userpref.aspx",type:"POST",data:"n="+escape(b)+"&v="+escape(c)})}function getPreference(b,c){$.ajax({url:"api/userpref.aspx",type:"POST",data:"n="+escape(b),success:function(b){c&&typeof c=="function"&&c(b)}})}function getFileExt(b){var c=b.lastIndexOf(".");return c>0&&c+1<b.length?b.substring(c):""}
function getFilename(b){var c=b.lastIndexOf("/");c>=0&&c+1<b.length&&(b=b.substring(c+1));c=b.lastIndexOf(".");return c>0&&c+1<b.length?b.substring(0,c):b}function measureText(b,c){var d=$("canvas")[0].getContext();d.save();d.font=b;var e=d.measureText(c);d.restore();return e}
function mergeLists(b,c,d){if(typeof c=="object"&&c.indexOf)if(d)for(var e=0;e<c.length;e++){for(var f=c[e],g=false,h=0;h<b.length;h++)if(d(b[h],f)){if(b[h].count!==void 0)b[h].count=b[h].count+c[e].count;g=true;break}g||b.push(f)}else for(e=0;e<c.length;e++)b.indexOf(c[e])<0&&b.push(c[e]);else if(d){g=false;for(h=0;h<b.length;h++)if(d(b[h],c)){if(b[h].count!==void 0)b[h].count=b[h].count+c.count;g=true;break}g||b.push(c)}else b.indexOf(c)<0&&b.push(c);return b}
function findStepByFunc(b){if(g_steps[b])return g_steps[b];for(var c=0;c<g_varBlocks.length;c++)if(g_varBlocks[c].func&&g_varBlocks[c].func==b)return g_varBlocks[c];for(c=0;c<g_listBlocks.length;c++)if(g_listBlocks[c].func&&g_listBlocks[c].func==b)return g_listBlocks[c];return null}function makeBlockByName(b){var c=null;(b=findStepByFunc(b))&&(c=b.value?new Label(b):new Block(b));return c}function ifArrayMakeString(b){return b instanceof Array?b.join(" "):b instanceof Object?JSON.stringify(b):b}
function coerceToNumber(b){(b=parseFloat(b))||(b=b.length==1?b.charCodeAt(0):0);return b}
function valueToNative(b){if(b=="true"||b===true)return true;if(b=="false"||b===false)return false;if(b instanceof Array||b instanceof Object)return b;var c=""+b,d=c;if(d.indexOf(".")>=0){if(d.indexOf("e")<0)for(;d.charAt(d.length-1)=="0";)d=d.substring(0,d.length-1);else{for(var e=true,f=0;f<d.length;f++){var g=d.charAt(f);if(g!="."&&g!="e"&&g!="-"&&g!="+"&&(g<"0"||g>"9")){e=false;break}}if(e)return parseFloat(d)}d.charAt(d.length-1)=="."&&(d=d.substring(0,d.length-1))}b=parseFloat(b);return""+b==
d||""+b=="0"+d?b:c}function animate(b,c,d){var e=Date.now(),f=0,f=window.setInterval(function(){var g=Date.now();if(g<e+b)c(g-e,b);else{c(b,b);window.clearInterval(f);d&&d()}},1E3/30)}
function getScrollVectors(b){var c=0,d=0;b.originalEvent.wheelDelta&&(d=b.originalEvent.wheelDelta/120*120);b.originalEvent.axis!==void 0&&(b.originalEvent.axis===b.originalEvent.HORIZONTAL_AXIS?c=-1*b.originalEvent.detail/3*120:b.originalEvent.axis===b.originalEvent.VERTICAL_AXIS&&(d=-1*b.originalEvent.detail/3*120));b.originalEvent.wheelDeltaY!==void 0&&(d=b.originalEvent.wheelDeltaY/120*120);b.originalEvent.wheelDeltaX!==void 0&&(c=b.originalEvent.wheelDeltaX/120*120);return{x:c,y:d}}
function findPos(b){return $(b).offset()}
function parseColor(b){var c=0,d=0,e=0,f=1;if(typeof b=="string"&&b.substring(0,5)=="rgba("&&b.charAt(b.length-1)==")"){d=b.indexOf(",");c=parseInt($.trim(b.substr(5,d-5)));e=b.indexOf(",",d+1);d=parseInt($.trim(b.substr(d+1,e-d)));f=b.indexOf(",",e+1);e=parseInt($.trim(b.substr(e+1,f-e)));f=parseFloat($.trim(b.substr(f+1,b.length-f)))}else if(typeof b=="string"&&b.substring(0,4)=="rgb("&&b.charAt(b.length-1)==")"){d=b.indexOf(",");c=parseInt($.trim(b.substr(4,d-4)));e=b.indexOf(",",d+1);d=parseInt($.trim(b.substr(d+
1,e-d)));e=parseInt($.trim(b.substr(e+1,b.length-e)))}else{typeof b=="string"&&b.charAt(0)!="#"?b="#"+parseInt(b).toString(16):typeof b=="number"&&(b="#"+b.toString(16));c=parseInt(b.substring(1,3),16);d=parseInt(b.substring(3,5),16);e=parseInt(b.substring(5),16)}return{r:c,g:d,b:e,a:f}}function getColorComponents(b){var b=parseColor(b),c=rgbToHsv(b.r,b.g,b.b),d=200*c[0],e=c[1],c=c[2],b="rgba("+b.r+","+b.g+","+b.b+","+b.a+")";return[b,d,c==1?50+50*(1-e):50*c]}
function rgbToHsl(b,c,d){var b=b/255,c=c/255,d=d/255,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h=(e+f)/2;if(e==f)g=f=0;else{var j=e-f,f=h>0.5?j/(2-e-f):j/(e+f);switch(e){case b:g=(c-d)/j+(c<d?6:0);break;case c:g=(d-b)/j+2;break;case d:g=(b-c)/j+4}g=g/6}return[g,f,h]}
function hslToRgb(b,c,d){if(c==0)d=c=b=d;else var e=function(b,c,d){d<0&&(d=d+1);d>1&&(d=d-1);return d<1/6?b+(c-b)*6*d:d<0.5?c:d<2/3?b+(c-b)*(2/3-d)*6:b},f=d<0.5?d*(1+c):d+c-d*c,g=2*d-f,d=e(g,f,b+1/3),c=e(g,f,b),b=e(g,f,b-1/3);return[d*255,c*255,b*255]}function rgbToHsv(b,c,d){var b=b/255,c=c/255,d=d/255,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h=e-f;if(e==f)g=0;else{switch(e){case b:g=(c-d)/h+(c<d?6:0);break;case c:g=(d-b)/h+2;break;case d:g=(b-c)/h+4}g=g/6}return[g,e==0?0:h/e,e]}
function hsvToRgb(b,c,d){var e,f,g,h=Math.floor(b*6),j=b*6-h,b=d*(1-c),k=d*(1-j*c),c=d*(1-(1-j)*c);switch(h%6){case 0:e=d;f=c;g=b;break;case 1:e=k;f=d;g=b;break;case 2:e=b;f=d;g=c;break;case 3:e=b;f=k;g=d;break;case 4:e=c;f=b;g=d;break;case 5:e=d;f=b;g=k}return[e*255,f*255,g*255]}
CanvasRenderingContext2D.prototype.dashedLine=function(b,c,d,e,f){f||(f=2);this.save();var g=b,h=c;this.beginPath();this.moveTo(b,c);var j=d-b,k=e-c,f=Math.floor(Math.sqrt(j*j+k*k)/f),j=j/f,k=k/f;this.strokeStyle="#000";for(var l=0;l++<f;){b=b+j;c=c+k;this[l%2==0?"moveTo":"lineTo"](b,c);this.lineTo(b,c)}this[l%2==0?"moveTo":"lineTo"](d,e);this.stroke();this.closePath();this.beginPath();this.moveTo(g,h);b=g;c=h;this.strokeStyle="#fff";for(l=1;l++<f;){b=b+j;c=c+k;this[l%2==0?"moveTo":"lineTo"](b,c);
this.lineTo(b,c)}this[l%2==0?"moveTo":"lineTo"](d,e);this.stroke();this.closePath();this.restore()};
function breakLines(b,c,d){for(var e=0,f=[],g=b.split("\\n"),h=0;h<g.length;h++){var b=g[h],j=c.measureText(b);if(j.width>d){for(var k="",b=b.split(/ +/),l=0;l<b.length;){j=c.measureText(k+b[l]+" ");if(j.width>d)if(k==""){for(var m=b[l]&&b[l].length>1?b[l][0]:"",n=false,q=1;q<b[l].length;q++){j=b[l][q];if(c.measureText(m+j).width>d){n=true;f.push(m);j=c.measureText(m);if(j.width>e)e=j.width;b[l]=b[l].substring(q);break}else m=m+j}if(!n){f.push(m);l++}}else{f.push(k);j=c.measureText(k);if(j.width>
e)e=j.width;k=""}else{k!=""&&(k=k+" ");k=k+b[l];l++}}if(k!=""||h<g.length-1){f.push(k);j=c.measureText(k);if(j.width>e)e=j.width}}else{f.push(b);j=c.measureText(b);if(j.width>e)e=j.width}}return{lines:f,textWidth:e}}function firstLetterToUpper(b){return b.charAt(0).toUpperCase()+b.slice(1)}function firstLetterToLower(b){return b.charAt(0).toLowerCase()+b.slice(1)}function toUCWord(b){return b.replace(/\w\S*/g,function(b){return b.charAt(0).toUpperCase()+b.substr(1)})}
function formatText(){var b=arguments[0];if(b){var c=Array.prototype.slice.call(arguments,1);return b.replace(/{(\d+)}/g,function(b,e){return typeof c[e]!="undefined"?c[e]:b})}return""}
function generateImageFromUrl(b,c){var d=RegExp(/avatar:\/\/([0-9a-zA-Z]+)\/([0-9a-zA-Z ]+)\/([0-9]+)/).exec(b);if(d&&d.length==4)Avatar.queueFrame(d[1],d[2],d[3],Avatar.totalFrames,c);else if(b=="avatar://spine"){var e=new Image;e.src=Sprites._blankImg;window.setTimeout(function(){c(e)},1)}else if(b.indexOf("spine://")==0){b=b.substring(8);d=JSON.parse(b);WinSpine.generatePreview(d.skeletonType,d.skeletonParts,function(b){var d=new Image;d.src=b;c(d)})}else if(b.indexOf("block://")==0){var b=b.substring(8),
f=b.lastIndexOf("/"),d=1;if(f>0){d=parseFloat(b.substring(f+1))*0.7;b=b.substring(0,f)}f=JSON.parse(b);f=ObjectIO.deserializeScriptStep(f);f.getImage(c,d)}else{if(b.indexOf(".svg")>0){e=new Image;e.onload=function(){var d=document.createElement("canvas");d.width=e.width;d.height=e.height;try{canvg(d,b,{renderCallback:function(){var e=new Image;if(c){e.onload=function(){c(e)};e.onerror=function(){e.onload=function(){c&&c(e)};e.src=Sprites._blankImg}}e.src=d.toDataURL("image/png");e.origSrc=b}})}catch(f){var j=
new Image;if(c){j.onload=function(){c(j)};j.onerror=function(){j.onload=function(){c&&c(j)};j.src=Sprites._blankImg}}j.src=d.toDataURL("image/png");j.origSrc=b}};e.onerror=function(){e.onload=function(){c&&c(e)};e.src=Sprites._blankImg}}else{e=new Image;if(c){e.onload=function(){c(e)};e.onerror=function(){e.src="ide/imgs/blank.png"}}}e.src=b}}
function loadJs(b){var c=document.createElement("script");c.setAttribute("type","text/javascript");c.setAttribute("src",b);document.getElementsByTagName("head")[0].appendChild(c)}
function timeDifference(b){var b=b*1E3,c=Date.now()-b;if(c<0){b=Date.now();c=0}b=new Date(b);if(c<36E5){c=Math.round(c/6E4);return c==1?"1 min ago":c+" mins ago"}if(c<864E5){c=Math.round(c/36E5);return c==1?"1 hour ago":c+" hours ago"}return c<2592E6&&Math.round(c/864E5)==1?"yesterday":b.getMonth()+1+"/"+b.getDate()+"/"+b.getFullYear()}function cloneObj(b){if(b==null||typeof b!="object")return b;var c=new b.constructor,d;for(d in b)c[d]=cloneObj(b[d]);return c}window.g_loc||(g_loc={loctext:{}});
g_loc.loadLocale=function(b,c,d,e,f){$.ajax({url:b,success:function(b){var b=JSON.parse(b),h=b["default"];if(b[c])for(var j in b[c])h[j]=b[c][j];if(b[c+"-"+d])for(j in b[c+"-"+d])h[j]=b[c+"-"+d][j];if(!f)for(j in h)g_loc.loctext[j]=h[j];e&&e(h)}})};g_loc.formatText=function(){var b=arguments[0],c=Array.prototype.slice.call(arguments,1),d=g_loc.loctext[b];return b&&d?d.replace(/{(\d+)}/g,function(b,d){d=parseInt(d);return typeof c[d-1]!="undefined"?""+c[d-1]:b}):""};
g_loc.formatTextDefault=function(){var b=arguments[0],c=arguments[1],d=Array.prototype.slice.call(arguments,2),e=g_loc.loctext[b];return b&&e?e.replace(/{(\d+)}/g,function(b,c){c=parseInt(c);return typeof d[c-1]!="undefined"?""+d[c-1]:b}):c?c.replace(/{(\d+)}/g,function(b,c){c=parseInt(c);return typeof d[c-1]!="undefined"?""+d[c-1]:b}):b};g_loc.formatDate=function(){};g_loc.formatNumber=function(){};g_loc.formatCurrency=function(){};g_loc.getText=function(b,c){return!g_loc.loctext[b]?c:g_loc.loctext[b]};
function ff_matchTolerance(b,c,d){var e=c.data[d],f=c.data[d+1],g=c.data[d+2],c=c.data[d+3];return e>=b[0]&&(e<=b[4]&&f>=b[1]&&f<=b[5]&&g>=b[2]&&g<=b[6]&&c>=b[3]&&c<=b[7])&&!(e==b[8]&&f==b[9]&&g==b[10]&&c==255)}
function ff_floodFill(b,c,d,e,f){var b=Math.floor(b),c=Math.floor(c),g=[[b,c]],h=d.canvas.width,j=d.canvas.height,k=(c*h+b)*4,l=d.getImageData(0,0,h,j);if(e.charAt(0)=="#"){e=e.substring(1,7);e=[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)]}else if(e.substring(0,4)=="rgb("){e=e.substring(4,e.length-1).split(",");e=[parseInt(e[0].trim()),parseInt(e[1].trim()),parseInt(e[2].trim())]}else return;for(f=[l.data[k]-f,l.data[k+1]-f,l.data[k+2]-f,l.data[k+3]-f,
l.data[k]+f,l.data[k+1]+f,l.data[k+2]+f,l.data[k+3]+f,e[0],e[1],e[2]];g.length;){c=g.pop();b=c[0];c=c[1];for(k=(c*h+b)*4;c-- >=0&&ff_matchTolerance(f,l,k);)k=k-h*4;k=k+h*4;++c;for(var m=false,n=false;c++<j-1&&ff_matchTolerance(f,l,k);){l.data[k]=e[0];l.data[k+1]=e[1];l.data[k+2]=e[2];l.data[k+3]=255;if(b>0)if(ff_matchTolerance(f,l,k-4)){if(!m){g.push([b-1,c]);m=true}}else m&&(m=false);if(b<h-1)if(ff_matchTolerance(f,l,k+4)){if(!n){g.push([b+1,c]);n=true}}else if(ff_matchTolerance(f,l,k+4-h*4)){if(!m){g.push([b+
1,c-1]);m=true}}else n&&(n=false);k=k+h*4}}d.putImageData(l,0,0)}
var cornerRadius=2,labelRadius=6,labelAnyRadius=3,labelStrokeWidth=1,minLabelHeight=11,minLabelWidth=80,labelHorzPadding=3,labelVertPadding=2,labelBottomPadding=4,slotHeight=6,slotWidth=20,slotTaper=2,slotBegin=20,startBlockTopHeight=7,startBlockTopWidth=40,startBlockRadius=18,emptyContainerHeight=15,containerSeparator=10,containerLeft=15,defaultStepOutlineColor="#fff",defaultStepColor="#ccc",defaultStepFontColor="#000",defaultFontCommentColor="#020",defaultFontColor="#fff",defaultInputFontColor=
"#333333",defaultInputFontColorFocus="#fff",defaultInputBgColor="rgba(255,255,255,.7)",defaultInputBgColorFocus="rgba(255,255,255,.9)",defaultInputLineColor="rgba(255,255,255,.7)",defaultInputCodeFontColor="#404040",defaultInputCodeFontColorFocus="#fff",defaultInputCodeBgColor="#fff",defaultInputCodeBgColorFocus="#fff",defaultInputCodeLineColor="rgba(0,0,0,.7)",defaultLabelFontWeight="normal",defaultLabelFont="Open Sans",defaultCodeLabelFont="Droid Sans Mono",defaultLabelFontSize=13,defaultLabelInputFontWeight=
"normal",defaultLabelInputFont="Open Sans",defaultCodeLabelInputFont="Droid Sans Mono",defaultLabelInputFontSize=13,defaultLabelColor="#999",defaultLabelOutlineColor="#666",defaultLabelLeftPadding=4,slotSelectionBounds=10,valueSelectionBounds=10,selectionBgColor="#E6E6FA",selectionStrokeColor="#000",selectionTextColor="#000",selectionWidth=4,outlineColor="#0f0",outlineWidth=10,dropdownColor="#fff",buttonStrokeColor="#dc8425",buttonFillColor="#fac206",buttonAddLabel=" + ",buttonRemoveLabel=" - ",buttonEditLabel=
"edit",noteFontHeight=12,noteFont="Arial",notePadding=4,checkboxWidth=14,checkboxHeight=14,checkboxPadRight=6,checkboxOffset=4,bubblePadding=10,bubbleFontLinePadding=4,buttonOffsetX=0,buttonOffsetY=14,buttonPadding=4,buttonSidePadding=10,buttonSkew=4,windowPadding=0,windowBorder=4,resMargin=4,resPadding=4,resBorder=1,disabledBlockAlpha=0.2,disabledLabelAlpha=0.1,disabledFillColor="#555",disabledStrokeColor="#ccc",hilightFillColor="#0f0",hilightStrokeColor="#0f0",hilightShadowColor="#0f0",blockLabelColor=
"#ffffff",blockStrokeColor="rgba(0,0,0,.1)",g_defaultStepColor=["#e85c41","#e85c41","rgba(0,0,0,.1)","#fff",!1],g_catColor={common:["#db5800","#db5800","rgba(0,0,0,.1)","#fff",!1],events:["#f7990f","#f7990f","rgba(0,0,0,.1)","#fff",!1],flow:["#db5800","#db5800","rgba(0,0,0,.1)","#fff",!1],library:["#0f59ae","#0f59ae","rgba(0,0,0,.1)","#fff",!1],motion:["#3067e2","#3067e2","rgba(0,0,0,.1)","#fff",!1],animation:["#04a8a8","#04a8a8","rgba(0,0,0,.1)","#fff",!1],looks:["#6050a5","#6050a5","rgba(0,0,0,.1)",
"#fff",!1],looksbg:["#6050a5","#6050a5","rgba(0,0,0,.1)","#fff",!1],particles:["#9d2ed3","#9d2ed3","rgba(0,0,0,.1)","#fff",!1],sensing:["#4e8cc4","#4e8cc4","rgba(0,0,0,.1)","#fff",!1],sound:["#9e49b2","#9e49b2","rgba(0,0,0,.1)","#fff",!1],operator:["#5fad3e","#5fad3e","rgba(0,0,0,.1)","#fff",!1],pen:["#2b995d","#2b995d","rgba(0,0,0,.1)","#fff",!1],physics:["#cc4848","#cc4848","rgba(0,0,0,.1)","#fff",!1],"var":["#b56684","#b56684","rgba(0,0,0,.1)","#fff",!1],variables:["#b56684","#b56684","rgba(0,0,0,.1)",
"#fff",!1],localvar:["#b56684","#b56684","rgba(0,0,0,.1)","#fff",!1],properties:["#b56684","#b56684","rgba(0,0,0,.1)","#fff",!1],comment:["#ffffeb","#ffffeb","rgba(0,0,0,.1)","#fff",!1],list:["#cc5a5a","#cc5a5a","rgba(0,0,0,.1)","#fff",!1],obj:["#cc5a5a","#cc5a5a","rgba(0,0,0,.1)","#fff",!1],functions:["#857bc6","#857bc6","rgba(0,0,0,.1)","#fff",!1],network:["#db5800","#db5800","rgba(0,0,0,.1)","#fff",!1],system:["#db5800","#db5800","rgba(0,0,0,.1)","#fff",!1],hardware:["#4f8738","#4f8738","rgba(0,0,0,.1)",
"#fff",!1],mcpe:["#af7c4f","#af7c4f","rgba(0,0,0,.1)","#fff",!1],nop:["#333333","#333333","rgba(0,0,0,.1)","#fff",!1],player:["#3bb5af","#3bb5af","rgba(0,0,0,.1)","#fff",!1],world:["#9d2ed3","#9d2ed3","rgba(0,0,0,.1)","#fff",!1],block:["#907eff","#907eff","rgba(0,0,0,.1)","#fff",!1],drone:["#0f59ae","#0f59ae","rgba(0,0,0,.1)","#fff",!1],inventory:["#ee4a4b","#ee4a4b","rgba(0,0,0,.1)","#fff",!1],utilities:["#0f59ae","#0f59ae","rgba(0,0,0,.1)","#fff",!1]},g_blockCodeColor=["#404969","#404969","rgba(0,0,0,.1)",
"#fff",!1];embedUrl="ide/embedded?p=";shareUrl="/play?p=";var g_ord=" 1st 2nd 3rd 4th 5th 6th 7th 8th 9th 10th".split(" ");helpHoverTimeout=2E3;videoUpdateInterval=100;undoLimit=50;
function Label(b){this.cat=b.cat!==void 0?b.cat:"flow";this.func=b.func!==void 0?b.func:"nop";this.id=b.id!==void 0?b.id:0;this.watchable=b.watchable!==void 0?b.watchable:false;this.watching=b.watching!==void 0?b.watching:false;if(b.value)this.value=b.value;this.draggable=b.draggable!==void 0?b.draggable:true;this.hidden=b.hidden!==void 0?b.hidden:false;this.parent=null;this._children=[];this.hilight=false;this.marked=b.marked!==void 0?b.marked:false;this.color=g_catColor[b.cat]!==void 0?g_catColor[b.cat]:
g_defaultStepColor;if(b.note)this.note=b.note;this.height=this.width=this.y=this.x=0;var c;if(b.name){this.name=b.name;this.func=="valueControlCall"||this.func=="valueControlCallLibrary"?this.label=c=b.label?b.label:b.name?b.name:"":c=b.name}else c=b.label!==void 0?b.label:"";this.labelText=c;window.RenderCode&&this.func&&(c=RenderCode.getCodeStartLabel(this));var d,b=[];do{d=Blocks.revLabel.exec(c);d!=null&&(d[1]=="choice:"?d[3]?b.push(["choice",d[2],d[3]]):b.push(["choice",d[2],null]):d[3]?b.push([d[2],
d[3]]):d[2]=="boolean"?b.push([d[2],"false"]):d[2]=="number"?b.push([d[2],"0"]):d[2]=="color"?d[3]?b.push([d[2],d[3]]):b.push([d[2],""]):b.push([d[2],""]))}while(d!=null);d=g_defaultStepColor[3];c=c.split(Blocks.reLabel);for(var e=0;e<c.length;e++){if(c[e].length>0){var f=c[e],g=f.indexOf("\n");if(g===0)if(f.length>1){this.add(new LabelBreak);this.add(new LabelText({label:f.substring(1),color:d}))}else this.add(new LabelBreak);else if(g>0){this.add(new LabelText({label:f.substring(0,g),color:d}));
this.add(new LabelBreak);this.add(new LabelText({label:f.substring(g+1),color:d}))}else this.add(new LabelText({label:f,color:d}));d=g_defaultStepColor[3]}if(e<c.length-1){f=b[e];if(f[0]=="varargs"){this.add(new LabelButton({label:buttonRemoveLabel,func:f[1],callback:"removeInput"}));this.add(new LabelButton({label:buttonAddLabel,func:f[1],callback:"addInput"}))}else if(f[0]=="button")this.add(new LabelButton({label:f[1],callback:"callback_"+f[1]}));else if(f[0]=="image")this.add(new LabelImg({label:f[1]}));
else if(f[0]=="choice"){var h=f[1],g=g_choice_lists[f[1]];f[2]?h=f[2]:g&&(h=g[0]);this.add(new LabelInput({type:"choice",choices:g,label:h}))}else if(f[0]=="where")this.add(new LabelInput({type:"where",choices:["mouse-pointer","edge","left edge","right edge","top edge","bottom edge","any","self"],label:f[1]?f[1]:"mouse-pointer"}));else if(f[0]=="actor")this.add(new LabelInput({type:"actor",choices:["self","any","stage"],label:f[1]?f[1]:"any"}));else if(f[0]=="actortiles")this.add(new LabelInput({type:"actortiles",
choices:["self","any","stage"],label:f[1]?f[1]:"self"}));else if(f[0]=="tiles")this.add(new LabelInput({type:"tiles",choices:["empty"],label:f[1]?f[1]:"empty"}));else if(f[0]=="whereall")this.add(new LabelInput({type:"whereall",choices:["mouse-pointer","edge","left edge","right edge","top edge","bottom edge","any","self"],label:f[1]?f[1]:"mouse-pointer"}));else if(f[0]=="stageproperty")this.add(new LabelInput({type:"stageproperty",choices:g_choice_lists.stageproperty,label:f[1]?f[1]:"width"}));else if(f[0]==
"method")this.add(new LabelInput({type:"method",choices:[],label:f[1]}));else if(f[0]=="level")this.add(new LabelInput({type:"level",choices:[],label:f[1]}));else if(f[0]=="scenes")this.add(new LabelInput({type:"scenes",choices:[],label:f[1]}));else if(f[0]=="costumes")this.add(new LabelInput({type:"costumes",choices:[],label:f[1]}));else if(f[0]=="sounds")this.add(new LabelInput({type:"sounds",choices:[],label:f[1]}));else if(f[0]=="properties")this.add(new LabelInput({type:"properties",choices:[],
label:f[1]}));else if(f[0]=="variables")this.add(new LabelInput({type:"variables",choices:[],label:f[1]}));else if(f[0]=="lists")this.add(new LabelInput({type:"lists",choices:[],label:f[1]}));else if(f[0]=="events")this.add(new LabelInput({type:"events",choices:[],label:f[1]}));else if(f[0]=="charparts")this.add(new LabelInput({type:"charparts",choices:[],label:f[1]}));else if(f[0]=="charskins")this.add(new LabelInput({type:"charskins",choices:[],label:f[1]}));else if(f[0]=="animations")this.add(new LabelInput({type:"animations",
choices:[],label:f[1]}));else if(f[0]=="param"){g=new LabelInput({type:"string",label:f[1]});g._child=new Label({cat:"functions",name:f[1],value:"string",func:"valueParam"});g._child.parent=g;this.add(g)}else if(f[0]=="scriptvar"){g=new LabelInput({type:"string",label:f[1]});g._child=new Label({cat:"localvar",name:f[1],value:"string",func:"valueScriptVar"});g._child.parent=g;this.add(g)}else if(f[0]=="color")f[1]=="reset"?d=g_defaultStepColor[3]:Blocks.reHexColor.test(f[1])?d="#"+f[1]:g_choice_lists.color?
this.add(new LabelInput({type:"choice",choices:g_choice_lists.color,label:h})):f[1]?this.add(new LabelInput({type:f[0],label:f[1]})):this.add(new LabelInput({type:f[0],label:"#ffffff"}));else if(g_choice_lists[f[0]]){g=g_choice_lists[f[0]];this.add(new LabelInput({type:"custom",choices:g,label:f[1]}))}else if(f[0]=="choice"){h=f[1];g=g_choice_lists[h];f[2]?h=f[2]:g&&(h=g[0]);this.add(new LabelInput({type:"choice",choices:g,label:h}))}else this.add(new LabelInput({type:f[0],label:f[1]}))}}}
Label.prototype.reRender=function(){var b=ObjectIO.genValueObj(this),b=ObjectIO.deserializeScriptStep(b);this.cat=b.cat;this.func=b.func;this.watchable=b.watchable;this.watching=b.watching;if(b.value)this.value=b.value;this.draggable=b.draggable;this.hidden=b.hidden;this._children=b._children;for(var c=0;c<this._children.length;c++)this._children[c].parent=this;this.hilight=b.hilight;this.marked=b.marked;this.color=b.color;if(b.note)this.note=b.note;this.labelText=b.labelText;this._computeBlockBounds()};
Label.prototype.convertToBlock=function(){var b=new Block({cat:this.cat,func:this.func,id:this.id,name:this.name,hasFlap:true,hasSlot:true,marked:this.marked});b.label=this.copy();b.labelText=this.labelText;b.label.parent=b;b.label.draggable=false;return b};Label.prototype.setHeight=function(b){this.height=b};
Label.prototype.addArg=function(){for(var b=0;b<this._children.length;b++)if(this._children[b]instanceof LabelButton&&this._children[b].label==buttonAddLabel){this.addInput(this._children[b]);break}};Label.prototype.removeArg=function(){for(var b=0;b<this._children.length;b++)if(this._children[b]instanceof LabelButton&&this._children[b].label==buttonRemoveLabel){this.removeInput(this._children[b]);break}};
Label.prototype.removeInput=function(b){for(var c=-1,d=this._children.length-1;d>=0;d--)if(this._children[d]==b){c=d;break}if(c>0){c--;if(this._children[c]instanceof LabelInput){this.remove(c);this.getRoot()._computeBlockBounds();window.WinCode&&WinCode.draw()}}};
Label.prototype.addInput=function(b){for(var c=-1,d=this._children.length-1;d>=0;d--)if(this._children[d]==b){c=d;break}if(c>=0){c--;c<0&&(c=0);d=null;if(b.func)if(b.func=="valueScriptVar"){d=new LabelInput({type:"string"});d._child=new Label({cat:"localvar",name:"var",value:"var",func:"valueScriptVar"});d._child.parent=d}else d=b.func=="actor"?new LabelInput({type:"actor",choices:["self","all"],label:"actor"}):new LabelInput({type:"string"});else d=new LabelInput({type:"string"});this.add(d,c);this.getRoot()._computeBlockBounds();
window.WinCode&&WinCode.draw()}};Label.prototype.callback_edit=function(){var b=this.getSocketAtChild(0);WinExpressions.show(b.label,function(c,d){if(b._child)b._child.parent=null;b._child=d;b.label=c;d.hidden=true;d.parent=b})};Label.prototype.callback_editfn=function(){window.WinTools&&WinTools.cmdEditFunction(this.parent)};
Label.prototype.callback_add=function(){var b=this.parent;b._containers.splice(b._containers.length-1,0,null);var c=window.RenderCode?RenderCode.getElseIfLabel(this):"else if {boolean} then {button:remove}",c=new Label({label:c,cat:this.cat});c.parent=b;c.draggable=false;b._containerLabels.splice(b._containerLabels.length-1,0,c);this.getRoot()._computeBounds()};
Label.prototype.callback_remove=function(){for(var b=this.parent,c=-1,d=0;d<b._containerLabels.length;d++)if(b._containerLabels[d]==this){c=d;break}if(c>=0){b._containers.splice(c+1,1);b._containerLabels.splice(c,1)}this.getRoot()._computeBounds()};Label.prototype.setDisabled=function(b){this.disabled=b;for(var c=0;c<this._children.length;c++)this._children[c].setDisabled(b)};
Label.prototype.selectInBounds=function(b,c,d,e){this.showSelected=!(b>this.x+this.width||b+d<this.x||c>this.y+this.height||c+e<this.y)};Label.prototype.setSelected=function(b,c){this.showSelected=b;for(var d=0;d<this._children.length;d++)this._children[d].setSelected(b,c)};Label.prototype.setOutline=function(b){this.showOutline=b;for(var c=0;c<this._children.length;c++)this._children[c].setOutline(b)};
Label.prototype.copy=function(){var b=new Label({cat:this.cat,watchable:this.watchable,watching:this.watching,func:this.func,name:this.name,label:this.label,value:this.value,draggable:this.draggable,color:this.color});b.x=this.x;b.y=this.y;b.width=this.width;b.height=this.height;b.labelText=this.labelText;if(this.marked)b.marked=true;if(this.locked)b.locked=true;if(this.tags&&this.tags.length>0){b.tags=[];for(var c=0;c<this.tags.length;c++)b.tags.push(this.tags[c])}for(c=0;c<this._children.length;c++){b._children[c]=
this._children[c].copy();b._children[c].parent=b}return b};Label.prototype.getImage=function(b,c){c||(c=1);this._computeBounds();var d=$('<canvas style="display:none;position:absolute;left:0px;top:0px;z-index:100000;" width="'+(this.width+1)*c+'" height="'+(this.height+1)*c+'"></canvas>'),e=d[0].getContext("2d");e.translateX=0;e.translateY=0;e.offsetX=0;e.offsetY=0;e.translate(0.5,0.5);e.scale(c,c);this.draw(e);var e=d[0].toDataURL(),f=new Image;if(b)f.onload=function(){b(f)};f.src=e;d.detach();return f};
Label.prototype.add=function(b,c){c===void 0||this._children.length==0?this._children.push(b):c<=this._children.length?this._children.splice(c,0,b):this._children.push(b);b.parent=this;this.getRoot()._computeBlockBounds()};Label.prototype.remove=function(b){b===void 0?this._children.pop():b>=0&&b<this._children.length&&this._children.splice(b,1)};
Label.prototype.setValue=function(b,c){for(var d=0,e=0;e<this._children.length;e++)if(this._children[e]instanceof LabelInput){if(b==d){if(c instanceof Label){this._children[e]._child=c;c.parent=this._children[e];if(c.hidden&&c.text)this._children[e].label=c.text}else if(this._children[e].type!="object")this._children[e].label=c;this.getRoot()._computeBounds();break}d++}};
Label.prototype.ensureSockets=function(b){for(var c=-1,d=0,e=0;e<this._children.length;e++)this._children[e]instanceof LabelInput?d++:this._children[e]instanceof LabelButton&&c<0&&(c=e);if(b>d&&c>=0)for(e=0;e<b-d;e++){var f=new LabelInput({});f.parent=this;this._children.splice(c,0,f)}return d};Label.prototype.getSockets=function(){for(var b=[],c=0;c<this._children.length;c++)this._children[c]instanceof LabelInput&&b.push(this._children[c]);return b};
Label.prototype.getNumSockets=function(){for(var b=0,c=0;c<this._children.length;c++)this._children[c]instanceof LabelInput&&b++;return b};Label.prototype.getSocketAtChild=function(b){for(var c=0,d=0;d<this._children.length;d++)if(this._children[d]instanceof LabelInput){if(b==c)return this._children[d];c++}return null};
Label.prototype.indexForBlockInChildren=function(b){for(var c=0,d=0;d<this._children.length;d++)if(this._children[d]instanceof LabelInput){if(this._children[d]==b||this._children[d]._child==b)return c;c++}return-1};Label.prototype.detach=function(){if(this.parent!=null){if(this.parent._child==this)this.parent._child=null;else for(var b=this.parent._children,c=0;c<b.length;c++)if(b[c]==this){b.splice(c,1);break}b=this.parent;this.parent=null;b._computeBounds()}};
Label.prototype.detachSelected=function(){if(this.showSelected){this.showSelected=false;var b=this.parent;if(b!=null&&b instanceof LabelInput){for(var b=b.parent,c=0;c<b._children.length;c++)if(b._children[c]instanceof LabelInput&&b._children[c]._child==this){b._children[c].child=null;break}this.parent=null;b._computeBounds()}this.setSelected(false,true)}};Label.prototype.getRoot=function(){for(var b=this;b.parent!=null;)b=b.parent;return b};Label.prototype._computeBounds=function(){this.getRoot()._computeBlockBounds()};
Label.prototype._computeBlockBounds=function(){for(var b=0,c=labelHorzPadding,d=c,e=labelVertPadding,f=0,g=0;g<this._children.length;g++){var h=this._children[g];h.x=this.x+labelRadius+c;h.y=this.y+e;h._computeBlockBounds();if(h.width<0){c=labelHorzPadding;for(e=e+(b+labelVertPadding);f<g;f++){h=this._children[f];h.setHeight(b)}b=0;f=g+1}else{c=c+h.width;if(h.height>b)b=h.height}c>d&&(d=c)}if(f>=0&&f<this._children.length)for(;f<g;f++){h=this._children[f];h.setHeight(b)}b=e+b+labelBottomPadding;this.width=
d+labelRadius*2;this.setHeight(b);if(this.parent instanceof Block){if(this.width<minLabelWidth)this.width=minLabelWidth;this.height<minLabelHeight&&this.setHeight(minLabelHeight)}};Label.prototype.getMaxWidth=function(){return this.width};Label.prototype.getChildAtPoint=function(b,c){if(this.locked)return null;if(b>=this.x&&b<=this.x+this.width&&c>=this.y&c<=this.y+this.height){for(var d=0;d<this._children.length;d++){var e=this._children[d].getChildAtPoint(b,c);if(e!=null)return e}return this}return null};
Label.prototype.getInputAtPoint=function(b,c){if(b>=this.x&&b<=this.x+this.width&&c>=this.y&c<=this.y+this.height)for(var d=0;d<this._children.length;d++){var e=this._children[d].getInputAtPoint(b,c);if(e!=null)return e}return null};Label.prototype.nearValue=function(b,c){if(this._children.length>0)for(var d=0;d<this._children.length;d++){var e=this._children[d].nearValue(b,c);if(e)return e}return null};
Label.prototype.objNearValue=function(b){if(this._children.length>0)for(var c=0;c<this._children.length;c++){var d=this._children[c].objNearValue(b);if(d)return d}return null};Label.prototype.getContainerPos=function(b){for(var c=0,d=0;d<this._children.length;d++)if(this._children[d]instanceof LabelInput){if(b==c){b=this._children[d];return[b.x+b.width/2,b.y+b.height/2]}c++}return null};Label.prototype.draw=function(b){this.showOutline&&this._drawOutline(b);this._draw(b)};
Label.prototype._draw=function(b){if(this.draggable){b.save();b.lineWidth=labelStrokeWidth;if(this.showSelected){b.fillStyle=selectionBgColor;b.strokeStyle=selectionStrokeColor}else if(window.RenderCode&&RenderCode.isCode()){b.fillStyle=g_blockCodeColor[0];b.strokeStyle=g_blockCodeColor[2]}else{b.fillStyle=this.color[0];b.strokeStyle=this.color[2]}if(this.hilight){b.shadowColor=hilightShadowColor;b.shadowBlur=20;b.fillStyle=hilightFillColor}else if(this.disabled){b.globalAlpha=disabledLabelAlpha;
if(disabledFillColor)b.fillStyle=disabledFillColor;if(disabledStrokeColor)b.strokeStyle=disabledStrokeColor}else if(this.marked&&Blocks.showMarked)b.globalAlpha=0.5;b.translate(this.x,this.y);if(this.value=="boolean"){b.beginPath();b.moveTo(0,this.height/2);b.lineTo(this.height/4,this.height);b.lineTo(this.height/4,this.height);b.lineTo(this.width-this.height/4,this.height);b.lineTo(this.width,this.height/2);b.lineTo(this.width-this.height/4,0);b.lineTo(this.height/4,0)}else if(this.type=="object"){b.fillStyle=
"rgba(255, 255, 255, 0.6)";b.beginPath();b.moveTo(0,labelAnyRadius);b.arcTo(0,0,labelAnyRadius,0,labelAnyRadius);b.lineTo(width-labelAnyRadius,0);b.arcTo(width,0,width,labelAnyRadius,labelAnyRadius);b.lineTo(width,height-labelAnyRadius);b.arcTo(width,height,width-labelAnyRadius,height,labelAnyRadius);b.lineTo(labelAnyRadius,height);b.arcTo(0,height,0,height-labelAnyRadius,labelAnyRadius)}else if(this.value=="number"){var c=this.height/2;b.beginPath();b.moveTo(0,c);b.arcTo(0,0,c,0,c);b.lineTo(this.width-
c,0);b.arcTo(this.width,0,this.width,c,c);b.lineTo(this.width,this.height-c);b.arcTo(this.width,this.height,this.width-c,this.height,c);b.lineTo(c,this.height);b.arcTo(0,this.height,0,this.height-c,c)}else{b.beginPath();b.moveTo(0,labelRadius);b.arcTo(0,0,labelRadius,0,labelRadius);b.lineTo(this.width-labelRadius,0);b.arcTo(this.width,0,this.width,labelRadius,labelRadius);b.lineTo(this.width,this.height-labelRadius);b.arcTo(this.width,this.height,this.width-labelRadius,this.height,labelRadius);b.lineTo(labelRadius,
this.height);b.arcTo(0,this.height,0,this.height-labelRadius,labelRadius)}b.closePath();b.fill();b.stroke();b.restore()}for(c=0;c<this._children.length;c++)this._children[c]._draw(b);if(this.showDragHandle||this.parent&&this.parent.showDragHandle){b.save();b.translate(this.x,this.y);b.strokeStyle="#555";b.globalAlpha=0.3;b.lineWidth=1;for(c=7.5;c<slotBegin+slotWidth;c=c+3){b.beginPath();b.moveTo(c,1);b.lineTo(c,this.height-slotHeight-2);b.closePath();b.stroke()}b.restore()}};
Label.prototype._drawOutline=function(b){if(this.draggable){b.save();b.fillStyle=outlineColor;b.strokeStyle=outlineColor;b.lineWidth=outlineWidth;b.lineCap="round";b.translate(this.x,this.y);b.beginPath();b.moveTo(0,labelRadius);b.arcTo(0,0,labelRadius,0,labelRadius);b.lineTo(this.width-labelRadius,0);b.arcTo(this.width,0,this.width,labelRadius,labelRadius);b.lineTo(this.width,this.height-labelRadius);b.arcTo(this.width,this.height,this.width-labelRadius,this.height,labelRadius);b.lineTo(labelRadius,
this.height);b.arcTo(0,this.height,0,this.height-labelRadius,labelRadius);b.closePath();b.stroke();b.restore()}};function LabelText(b){this.parent=null;this.label=b.label!==void 0?b.label:null;this.fontSize=b.fontSize!==void 0?b.fontSize:defaultLabelFontSize;this.color=b.color!==void 0?b.color:g_defaultStepColor[3];this.height=this.width=this.y=this.x=0}LabelText.prototype.setHeight=function(b){this.height=b};LabelText.prototype.getMaxWidth=function(){return this.width};
LabelText.prototype.setDisabled=function(b){this.disabled=b};LabelText.prototype.setSelected=function(b){this.showSelected=b};LabelText.prototype.setOutline=function(b){this.showOutline=b};LabelText.prototype.copy=function(){return new LabelText({label:this.label,fontSize:this.fontSize,color:this.color})};LabelText.prototype.setText=function(b){this.label=b;this._computeBlockBounds()};LabelText.prototype.getText=function(){return this.label};
LabelText.prototype.detach=function(){if(label.parent!=null){for(var b=label.parent._children,c=0;c<b.length;c++)if(b[c]==this){b.splice(c,1);break}label.parent=null}};LabelText.prototype.getRoot=function(){for(var b=this;b.parent!=null;)b=b.parent;return b};LabelText.prototype._computeBounds=function(){this.getRoot()._computeBlockBounds()};
LabelText.prototype._computeBlockBounds=function(){this.width=(window.RenderCode&&RenderCode.isCode()?Blocks.measureText(this.label,defaultCodeLabelFont):Blocks.measureText(this.label)).width;this.height=this.fontSize+6};LabelText.prototype.getChildAtPoint=function(){return null};LabelText.prototype.getInputAtPoint=function(){return null};LabelText.prototype.nearValue=function(){return null};LabelText.prototype.objNearValue=function(){return null};LabelText.prototype.draw=function(b){this._draw(b)};
LabelText.prototype._draw=function(b){b.save();b.textAlign="left";b.textBaseline="middle";b.font=window.RenderCode&&RenderCode.isCode()?defaultLabelFontWeight+" "+this.fontSize+"px "+defaultCodeLabelFont:defaultLabelFontWeight+" "+this.fontSize+"px "+defaultLabelFont;if(this.disabled){b.globalAlpha=disabledBlockAlpha;if(disabledStrokeColor)b.fillStyle=b.strokeStyle=disabledStrokeColor}else if(this.showSelected){b.fillStyle=selectionTextColor;b.strokeStyle=selectionTextColor}else{b.strokeStyle=this.color;
b.fillStyle=this.color}b.fillText(this.label,this.x,this.y+this.height/2);b.restore()};function LabelBreak(){this.parent=null;this.y=this.x=0;this.height=this.width=-1}LabelBreak.prototype.setHeight=function(b){this.height=b};LabelBreak.prototype.getMaxWidth=function(){return this.width};LabelBreak.prototype.setDisabled=function(b){this.disabled=b};LabelBreak.prototype.setSelected=function(b){this.showSelected=b};LabelBreak.prototype.setOutline=function(b){this.showOutline=b};
LabelBreak.prototype.copy=function(){return new LabelBreak};LabelBreak.prototype.setText=function(b){this.label=b;this._computeBlockBounds()};LabelBreak.prototype.getText=function(){return this.label};LabelBreak.prototype.detach=function(){if(label.parent!=null){for(var b=label.parent._children,c=0;c<b.length;c++)if(b[c]==this){b.splice(c,1);break}label.parent=null}};LabelBreak.prototype.getRoot=function(){for(var b=this;b.parent!=null;)b=b.parent;return b};LabelBreak.prototype._computeBounds=function(){this.getRoot()._computeBlockBounds()};
LabelBreak.prototype._computeBlockBounds=function(){};LabelBreak.prototype.getChildAtPoint=function(){return null};LabelBreak.prototype.getInputAtPoint=function(){return null};LabelBreak.prototype.nearValue=function(){return null};LabelBreak.prototype.objNearValue=function(){return null};LabelBreak.prototype.draw=function(b){this._draw(b)};LabelBreak.prototype._draw=function(){};
function LabelImg(b){this.parent=null;this.label=b.label!==void 0?b.label:null;this.img=Blocks.getImage(this.label);this.height=this.width=this.y=this.x=0}LabelImg.prototype.setHeight=function(b){this.height=b};LabelImg.prototype.getMaxWidth=function(){return this.width};LabelImg.prototype.setDisabled=function(b){this.disabled=b};LabelImg.prototype.setSelected=function(b){this.showSelected=b};LabelImg.prototype.setOutline=function(b){this.showOutline=b};LabelImg.prototype.copy=function(){return new LabelImg({label:this.label})};
LabelImg.prototype.detach=function(){if(label.parent!=null){for(var b=label.parent._children,c=0;c<b.length;c++)if(b[c]==this){b.splice(c,1);break}label.parent=null}};LabelImg.prototype.getRoot=function(){for(var b=this;b.parent!=null;)b=b.parent;return b};LabelImg.prototype._computeBounds=function(){this.getRoot()._computeBlockBounds()};LabelImg.prototype._computeBlockBounds=function(){this.imgWidth=this.width=this.img.width*16/this.img.height;this.imgHeight=this.height=16};
LabelImg.prototype.getChildAtPoint=function(){return null};LabelImg.prototype.getInputAtPoint=function(){return null};LabelImg.prototype.nearValue=function(){return null};LabelImg.prototype.objNearValue=function(){return null};LabelImg.prototype.draw=function(b){this._draw(b)};LabelImg.prototype._draw=function(b){this.img&&this.img.ready&&b.drawImage(this.img,this.x+(this.width-this.imgWidth)/2,this.y+(this.height-this.imgHeight)/2,this.imgWidth,this.imgHeight)};
function LabelButton(b){this.parent=null;this.img=b.img!==void 0?b.img:null;this.label=b.label!==void 0?b.label:null;if(this.label=="add"||this.label==buttonAddLabel){this.label=buttonAddLabel;this.img=Blocks.getImage("ide/imgs/button-add.png")}else if(this.label=="remove"||this.label==buttonRemoveLabel){this.label=buttonRemoveLabel;this.img=Blocks.getImage("ide/imgs/button-remove.png")}else if(this.label=="edit"||this.label=="editfn"){this.label=buttonEditLabel;this.img=Blocks.getImage("ide/imgs/button-edit.png")}this.color=
b.color!==void 0?b.color:g_defaultStepColor;this.fontSize=b.fontSize!==void 0?b.fontSize:defaultLabelFontSize;this.color=b.color!==void 0?b.color:g_defaultStepColor;this.func=b.func!==void 0?b.func:null;this.callback=b.callback!==void 0?b.callback:null;this.height=this.width=this.y=this.x=0}LabelButton.prototype.setHeight=function(b){this.height=b};LabelButton.prototype.getMaxWidth=function(){return this.width};LabelButton.prototype.setDisabled=function(b){this.disabled=b};
LabelButton.prototype.setSelected=function(b){this.showSelected=b};LabelButton.prototype.setOutline=function(b){this.showOutline=b};LabelButton.prototype.copy=function(){return new LabelButton({label:this.label,img:this.img,fontSize:this.fontSize,color:this.color,func:this.func,callback:this.callback})};LabelButton.prototype.setText=function(b){this.label=b;this._computeBlockBounds()};LabelButton.prototype.getText=function(){return this.label};
LabelButton.prototype.detach=function(){if(label.parent!=null){for(var b=label.parent._children,c=0;c<b.length;c++)if(b[c]==this){b.splice(c,1);break}label.parent=null}};LabelButton.prototype.getRoot=function(){for(var b=this;b.parent!=null;)b=b.parent;return b};LabelButton.prototype._computeBounds=function(){this.getRoot()._computeBlockBounds()};
LabelButton.prototype._computeBlockBounds=function(){if(this.img){this.imgWidth=this.width=this.img.width*16/this.img.height;this.imgHeight=this.height=16}else if(this.label==buttonAddLabel||this.label==buttonRemoveLabel)this.width=24;else{this.width=Blocks.measureText(this.label).width+labelRadius*2;if(this.width<10)this.width=10}this.height=this.fontSize+6};LabelButton.prototype.getChildAtPoint=function(){return null};
LabelButton.prototype.getInputAtPoint=function(b,c){return b>=this.x&&b<=this.x+this.width&&c>=this.y&&c<=this.y+this.height?this:null};LabelButton.prototype.nearValue=function(){return null};LabelButton.prototype.objNearValue=function(){return null};LabelButton.prototype.draw=function(b){this._draw(b)};
LabelButton.prototype._draw=function(b){if(this.img)this.img.ready&&b.drawImage(this.img,this.x+(this.width-this.imgWidth)/2,this.y+(this.height-this.imgHeight)/2,this.imgWidth,this.imgHeight);else{b.save();if(this.disabled){b.globalAlpha=disabledLabelAlpha;if(disabledStrokeColor)b.fillStyle=b.strokeStyle=disabledStrokeColor}else{b.strokeStyle=buttonStrokeColor;b.fillStyle=buttonFillColor}b.textAlign="center";b.textBaseline="middle";var c=this.fontSize+4,d=this.width-4;b.translate(this.x+2,this.y+
(this.height-c)/2);b.beginPath();b.moveTo(0,labelRadius);b.arcTo(0,0,labelRadius,0,labelRadius);b.lineTo(d-labelRadius,0);b.arcTo(d,0,d,labelRadius,labelRadius);b.lineTo(d,c-labelRadius);b.arcTo(d,c,d-labelRadius,c,labelRadius);b.lineTo(labelRadius,c);b.arcTo(0,c,0,c-labelRadius,labelRadius);b.closePath();b.fill();b.stroke();b.strokeStyle="#555555";b.fillStyle="#555555";b.beginPath();b.moveTo(d,labelRadius);b.lineTo(d,c-labelRadius);b.arcTo(d,c,d-labelRadius,c,labelRadius);b.lineTo(labelRadius,c);
b.stroke();b.strokeStyle="#000000";b.fillStyle="#000000";b.fillText(this.label,d/2,c/2);b.restore()}};LabelButton.prototype.setFocus=function(){if(window.WinCode){dismissChoosers();if(this.callback&&this.parent)this.parent[this.callback](this)}return false};
function LabelInput(b){this.droppable=b.droppable!==void 0?b.droppable:true;this._child=this.parent=null;this.type=b.type;this.label=b.label!==void 0?b.label:"";this.choices=b.choices;this.defaultLabel=b.label;this.fontName=window.RenderCode&&RenderCode.isCode()?defaultCodeLabelInputFont:defaultLabelInputFont;this.fontSize=b.fontSize!==void 0?b.fontSize:defaultLabelInputFontSize;this.fontColor=b.fontColor!==void 0?b.fontColor:window.RenderCode&&RenderCode.isCode()?defaultInputCodeFontColor:defaultInputFontColor;
this.hasFocus=this.hilight=false;this.height=this.width=this.y=this.x=0}LabelInput.prototype.setHeight=function(b){this.height=b;if(this._child!=null){this._child.y=this._child.y+(this.height-this._child.height)/2;this._child._computeBlockBounds()}};LabelInput.prototype.getMaxWidth=function(){return this.width};LabelInput.prototype.setDisabled=function(b){this.disabled=b;this._child!=null&&this._child.setDisabled(b)};
LabelInput.prototype.setSelected=function(b,c){this.showSelected=b;this._child!=null&&this._child.setSelected(b,c)};LabelInput.prototype.setOutline=function(b){this.showOutline=b;this._child!=null&&this._child.setOutline(b)};
LabelInput.prototype.copy=function(){var b=new LabelInput({droppable:this.droppable,label:this.label,type:this.type,choices:this.choices,fontSize:this.fontSize,fontColor:this.fontColor});b.defaultLabel=this.defaultLabel;b.x=this.x;b.y=this.y;b.width=this.width;b.height=this.height;if(this._child!=null){b._child=this._child.copy();b._child.parent=b}return b};LabelInput.prototype.getRoot=function(){for(var b=this;b.parent!=null;)b=b.parent;return b};LabelInput.prototype._computeBounds=function(){this.getRoot()._computeBlockBounds()};
LabelInput.prototype._computeBlockBounds=function(){if(this._child!=null&&!this._child.hidden){this._child.x=this.x;this._child.y=this.y;this._child._computeBlockBounds();this.width=this._child.width;this.height=this._child.height}else{this.width=(this.type=="string"&&this.label?Blocks.measureText((""+this.label).substring(0,80)+((""+this.label).length>80?"...":""),this.fontName):Blocks.measureText(this.label,this.fontName)).width+6+labelRadius*2;if(this.type=="variables"||this.type=="lists")this.width=
this.width+10;this.height=this.fontSize+6}};LabelInput.prototype.detach=function(){if(this.parent!=null){for(var b=this.parent._children,c=0;c<b.length;c++)if(b[c]==this){b.splice(c,1);break}b=this.parent;this.parent=null;b._computeBounds()}};LabelInput.prototype.getChildAtPoint=function(b,c){if(this.locked)return null;if(b>=this.x&&b<=this.x+this.width&&c>=this.y&&c<=this.y+this.height&&this._child!=null&&!this._child.hidden){var d=this._child.getChildAtPoint(b,c);if(d!=null)return d}return null};
LabelInput.prototype.getInputAtPoint=function(b,c){if(b>=this.x&&b<=this.x+this.width&&c>=this.y&&c<=this.y+this.height){if(this._child!=null&&!this._child.hidden){var d=this._child.getChildAtPoint(b,c);if(d!=null)return d}return this}return null};LabelInput.prototype.nearValue=function(b,c){if(b>=this.x&&b<=this.x+this.width&&c>=this.y&&c<=this.y+this.height){if(this._child!=null&&!this._child.hidden){var d=this._child.nearValue(b,c);if(d!=null)return d}return this}return null};
LabelInput.prototype.objNearValue=function(b){var c=this.x,d=this.y,e=this.y+this.height,f=b.y,g=b.x+b.width,h=b.y+b.height;if(b.x<this.x+this.width&&g>c&&f<e&&h>d){if(this._child!=null){if(this._child.locked)return null;if(!this._child.hidden){b=this._child.objNearValue(b);if(b!=null)return b}}return this}return null};LabelInput.prototype.getPopup=function(){return this.hasFocus?this.type=="color"?ColorPicker.colors:$(".choice-chooser"):null};
function dismissChoosers(){$(".choice-chooser").detach();window.AnglePicker&&AnglePicker.hide();window.ColorPicker&&ColorPicker.hide();window.BlockPicker&&BlockPicker.hide();if(window.WinCode)window.WinCode._inputField=null;window.WinMediaAssets&&WinMediaAssets.hide();window.WinPaint&&WinPaint.hide()}
function findScriptVars(b,c){if(b.func=="blockControlScriptVar")for(var d=b.label.getNumSockets(),e=0;e<d;e++){var f=b.label.getSocketAtChild(e);f._child&&c.indexOf(f._child.name)<0&&c.push(f._child.name)}if(b._containers)for(e=0;e<b._containers.length;e++)b._containers[e]!=null&&findScriptVars(b._containers[e],c);b.next&&findScriptVars(b.next,c)}
LabelInput.prototype.addInputField=function(b,c){var d=this,e=$('<li><textarea/> <a href="#" class="more"></a></li>');e.find("a.more").click(function(){$(this).parents("li").toggleClass("expand");return false});e.find("textarea").val(this.label).keydown(function(b){if(b.keyCode==9){$(this).blur();d.label=$(this).val();if(c){d.label=parseFloat(d.label);if(typeof d.label=="number"&&(!isFinite(d.label)||isNaN(d.label)))d.label=0}FocusManager.clearFocus()}else if(b.keyCode==13&&!$(this).parents("li").hasClass("expand")){$(this).blur();
FocusManager.clearFocus();return false}}).keyup(function(b){d.label=$(this).val();if(c){d.label=parseFloat(d.label);if(typeof d.label=="number"&&(!isFinite(d.label)||isNaN(d.label)))d.label=0}d._computeBounds();IDE.draw();if(b.keyCode==13){if(!$(this).parents("li").hasClass("expand")){$(this).blur();FocusManager.clearFocus();return false}}else if(b.keyCode==27){$(this).blur();FocusManager.clearFocus()}});b.append(e);e.find("textarea").focus().select()};
LabelInput.prototype.setFocus=function(b,c,d,e){if(window.WinCode){dismissChoosers();if(this.parent&&this.parent.parent&&(this.parent.parent.func=="blockControlPostMessage"||this.parent.parent.func=="blockControlPostMessageAndWait")){var f=this.parent.parent;f.label.getSocketAtChild(2).type="string";var g=f.label.getSocketAtChild(0);if(g&&g!=this&&g.label=="loadProject")if((g=f.label.getSocketAtChild(1))&&g!=this&&g.label=="TynkerRuntime")this.type="projects"}if(this.type=="boolean"){this._makeBooleanControl(b,
c,d,e);return false}if(this.type=="string")this._makeStringControl(b,c,d,e);else if(this.type=="number")this._makeNumberControl(b,c,d,e);else if(this.type=="color")this._makeColorControl(b,c,d,e);else if(this.type=="angle")this._makeAngleControl(b,c,d,e);else if(this.type=="mathangle")this._makeMathAngleControl(b,c,d,e);else if(window.BlockPicker&&BlockPicker.types[this.type])this._makeBlockControl(this.type,b,c,d,e);else if(this.type=="projects")this._makeProjectsControl(b,c,d,e);else if(this.choices!=
null&&this.choices!==void 0){this._makeChoicesControl(b,c,d,e);if(this.type=="custom")return false}this.hasFocus=b;this.cursorPos=this.label.length;if(e){d="";e=e.x-this.x-labelRadius;c.textAlign="left";c.textBaseline="middle";for(c=0;c<this.label.length;c++){d=d+this.label[c];f=Blocks.measureText(d);if(e<f.width){this.cursorPos=c;break}}}b||WinCode._broadcastChange("valueChange",this)}return true};
LabelInput.prototype._makeBooleanControl=function(){this.label=this.label=="true"?"false":"true";this.hasFocus=false;WinCode._broadcastChange("valueChange",this)};LabelInput.prototype._makeStringControl=function(b,c,d){if(b){b=$('<div class="choice-chooser"><ul></ul></div>');b.css("left",d.left+(c.offsetX+this.x)*Blocks._scale);b.css("top",d.top+(c.offsetY+this.y)*Blocks._scale);$("body").append(b);b=b.find("ul");this.addInputField(b)}};
LabelInput.prototype._makeNumberControl=function(b,c,d){if(b){b=$('<div class="choice-chooser"><ul></ul></div>');b.css("left",d.left+(c.offsetX+this.x)*Blocks._scale);b.css("top",d.top+(c.offsetY+this.y)*Blocks._scale);$("body").append(b);b=b.find("ul");this.addInputField(b,true)}};
LabelInput.prototype._makeColorControl=function(b,c,d){if(b){var e=this;ColorPicker.show((c.offsetX+this.x+labelRadius)*Blocks._scale+d.left,(c.offsetY+this.y+this.height+4)*Blocks._scale+d.top,(c.offsetY+this.y)*Blocks._scale+d.top,function(b){e.label=b;e._computeBounds();WinCode.draw()},function(b){e.label=b;e._computeBounds();FocusManager.clearFocus();WinCode.draw();WinCode._broadcastChange("valueChange",e)})}else ColorPicker.hide()};
LabelInput.prototype._makeAngleControl=function(b,c,d){if(b){var e=this;AnglePicker.show(this.label,(c.offsetX+this.x+labelRadius+this.width/2)*Blocks._scale+d.left,(c.offsetY+this.y+this.height+4)*Blocks._scale+d.top,(c.offsetY+this.y)*Blocks._scale+d.top,function(b){e.label=b;e._computeBounds();WinCode.draw();WinCode._broadcastChange("valueChange",e)},function(){FocusManager.clearFocus()})}};
LabelInput.prototype._makeMathAngleControl=function(b,c,d){if(b){var e=this;AnglePicker.show(this.label,(c.offsetX+this.x+labelRadius+this.width/2)*Blocks._scale+d.left,(c.offsetY+this.y+this.height+4)*Blocks._scale+d.top,(c.offsetY+this.y)*Blocks._scale+d.top,function(b){e.label=b;e._computeBounds();e.hasFocus=false;WinCode.draw();WinCode._broadcastChange("valueChange",e)},function(){FocusManager.clearFocus()},true)}};
LabelInput.prototype._makeBlockControl=function(b,c,d,e){if(c){var f=this;BlockPicker.show(b,this.label,(d.offsetX+this.x+labelRadius+this.width/2)*Blocks._scale+e.left,(d.offsetY+this.y+this.height+4)*Blocks._scale+e.top,(d.offsetY+this.y)*Blocks._scale+e.top,function(b){f.label=b;f._computeBounds();WinCode.draw();WinCode._broadcastChange("valueChange",f);FocusManager.clearFocus()})}};
LabelInput.prototype._makeProjectsControl=function(b,c,d){if(b){var e=$('<div class="choice-chooser"><ul></ul></div>');e.css("left",(c.offsetX+this.x+labelRadius)*Blocks._scale+d.left);e.css("top",(c.offsetY+this.y+this.height+4)*Blocks._scale+d.top);$("body").append(e);var e=e.find("ul"),f=this;$.ajax({url:"/api/projectids",success:function(b){for(var b=JSON.parse(b),c=0;c<b.length;c++){var d=$("<li>"+b[c].name+" - "+b[c].id+"</li>");e.append(d);d.click(function(){FocusManager.clearFocus();f.label=
$(this).text();f._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",f)})}}})}};
LabelInput.prototype._makeChoicesControl=function(b,c,d){if(b){b=$('<div class="choice-chooser"><ul></ul></div>');$("body").append(b);b=b.find("ul");if(this.choices)for(var e=0;e<this.choices.length;e++){var f=$("<li>"+this.choices[e]+"</li>");b.append(f);var g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}if(this.type=="where"){f=false;for(e=0;e<Runtime.sprites.length;e++)if(Runtime.sprites[e]!=
IDE.editingActor){f=$("<li>"+Runtime.sprites[e].label+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=true}f||b.append('<li class="disabled">No other actors</li>')}else if(this.type=="actortiles"){for(e=0;e<Runtime.sprites.length;e++){f=$("<li>"+Runtime.sprites[e].label+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();
g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}for(var h in Runtime.stage.tileLayer._tileSetMapping){f=$("<li>"+h+" tiles</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}}else if(this.type=="tiles")for(h in Runtime.stage.tileLayer._tileSetMapping){f=$("<li>"+h+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();
g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}else if(this.type=="whereall"||this.type=="actor")for(e=0;e<Runtime.sprites.length;e++){f=$("<li>"+Runtime.sprites[e].label+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}else if(this.type=="stageproperty")for(e=0;e<Runtime.sprites.length;e++){h=
[];var j=Runtime.sprites[e].tag;if(j)for(var k=0;k<j.length;k++){var l=j[k];if(l&&h.indexOf(l)<0){f=$("<li>closest "+l+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=$("<li>furthest "+l+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",
g)})}}}else if(this.type=="method"){f="";if(this.parent&&this.parent.func=="valueControlCallMember")f=this.parent.getSocketAtChild(0).label;if(this.parent&&this.parent.parent&&this.parent.parent.func=="blockControlCallMember")f=this.parent.parent.label.getSocketAtChild(0).label;h=Sprites.getSpriteByName(f);if(!h)h=Runtime.background;f=false;h=h.scripts;for(e=0;e<h.length;e++)if(h[e].func=="registerFunction"){f=$("<li>"+h[e].name+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();
g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=true}f||b.append('<li class="disabled">No methods</li>')}else if(this.type=="level"){for(e=0;e<Runtime.levels.length;e++){f=$("<li>"+Runtime.levels[e].name+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}Runtime.levels.length<=0&&b.append('<li class="disabled">No levels</li>')}else if(this.type==
"scenes"){h=Runtime.background;f=$("<li>any</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=true;for(e=0;e<h.costumes.length;e++){f=h.costumes[e].imgPreview?$('<li><img src="'+h.costumes[e].imgPreview+'"/>'+h.costumes[e].name+"</li>"):$('<li><img src="'+h.costumes[e].img+'"/>'+h.costumes[e].name+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();
g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=true}if(Blocks.allowAddInOptions){g=this;f=$('<li style="border-top:1px solid #ccc">Add Background</li>');b.append(f);f.click(function(){dismissChoosers();WinMediaAssets.showPicker("Add Background",function(b){WinProperties._addAssetAsCostume(b);FocusManager.clearFocus();g.label=b[0].name;g._computeBounds();IDE.draw();WinCode._broadcastChange("valueChange",g)},{backgrounds:true,actors:false,
images:false,sounds:false,charStudio:false})})}else f||b.append('<li class="disabled">No backgrounds</li>')}else if(this.type=="costumes"){h=IDE.editingActor;if(IDE.editingActor==null)h=Runtime.background;if(h.skeleton.skeletonData)for(e=0;e<h.skeleton.skeletonData.animations.length;e++)if(h.skeleton.skeletonData.animations[e].name.indexOf("Back 3/4")!==0){f=$("<li>"+h.skeleton.skeletonData.animations[e].name+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();
g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}for(e=0;e<h.costumes.length;e++){f=h.costumes[e].imgPreview?$('<li><img src="'+h.costumes[e].imgPreview+'"/>'+h.costumes[e].name+"</li>"):$('<li><img src="'+h.costumes[e].img+'"/>'+h.costumes[e].name+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}if(Blocks.allowAddInOptions){g=
this;f=$('<li style="border-top:1px solid #ccc">Add Costume</li>');b.append(f);f.click(function(){dismissChoosers();WinMediaAssets.showPicker("Add Costume",function(b){WinProperties._addAssetAsCostume(b);FocusManager.clearFocus();g.label=b[0].name;g._computeBounds();IDE.draw();WinCode._broadcastChange("valueChange",g)},{backgrounds:false,actors:false,images:true,sounds:false,charStudio:false})})}}else if(this.type=="sounds"){h=IDE.editingActor;if(IDE.editingActor==null)h=Runtime.background;j=[];for(e=
0;e<h.sounds.length;e++)if(j.indexOf(h.sounds[e].name)<0){f=$("<li>"+h.sounds[e].name+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});j.push(h.sounds[e].name)}for(e=0;e<Runtime.background.sounds.length;e++)if(j.indexOf(Runtime.background.sounds[e].name)<0){f=$("<li>"+Runtime.background.sounds[e].name+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();
g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});j.push(Runtime.background.sounds[e].name)}if(Blocks.allowAddInOptions){g=this;f=$('<li style="border-top:1px solid #ccc">Add Sound</li>');b.append(f);f.click(function(){dismissChoosers();WinMediaAssets.showPicker("Add Sound",function(b){WinProperties._addAssetAsCostume(b);WinProperties.hide();FocusManager.clearFocus();g.label=b[0].name;g._computeBounds();IDE.draw();WinCode._broadcastChange("valueChange",
g)},{backgrounds:false,actors:false,images:false,sounds:true,charStudio:false})})}else j.length<=0&&b.append('<li class="disabled">No other sounds</li>')}else if(this.type=="properties"){f=this.parent;if(f._children&&f._children.length>=4&&f._children[3]instanceof LabelInput)e=(e=Sprites.getSpriteByName(f._children[3].label))?e.variables:Runtime.background.variables;else e=Runtime.background.variables;f=false;if(e)for(h in e){f=$("<li>"+h+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();
g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=true}if(e!=Runtime.background.variables&&IDE.editingActor)for(h in IDE.editingActor.variables){f=$("<li>"+h+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=true}f||b.append('<li class="disabled">No properties</li>')}else if(this.type=="variables"){f=
false;for(h in Runtime.background.variables){f=$("<li>"+h+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=true}if(IDE.editingActor)for(h in IDE.editingActor.variables){f=$("<li>"+h+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",
g)});f=true}e=this.getRoot();if(e.func=="registerFunction"){h=e.label._children;for(e=0;e<h.length;e++)if(h[e]instanceof LabelInput&&h[e]._child&&h[e]._child.func=="valueParam"){f=$("<li>"+h[e]._child.name+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=true}}e=this.getRoot();h=[];findScriptVars(e,h);for(e=0;e<h.length;e++){f=$("<li>"+h[e]+"</li>");b.append(f);
g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=true}f||b.append('<li class="disabled">No variables</li>')}else if(this.type=="lists"){f=false;for(h in Runtime.background.lists){f=$("<li>"+h+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=
true}if(IDE.editingActor)for(h in IDE.editingActor.lists){f=$("<li>"+h+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=true}f||b.append('<li class="disabled">No lists</li>')}else if(this.type=="events"){f=this.parent;h=f._children&&f._children.length==4&&f._children[3]instanceof LabelInput?Runtime.findEventsOf(f._children[3].label):Runtime.findEventsOf("any");
if(h.length>0)for(e=0;e<h.length;e++){if(h[e].indexOf("runtime")!=0&&h[e].indexOf("tynker")!=0){f=$("<li>"+h[e]+"</li>");b.append(f);g=this;f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}}else b.append('<li class="disabled">No events</li>')}else if(this.type=="charparts")if(IDE.editingActor&&IDE.editingActor.skeleton.skeletonData){e=g_parts[IDE.editingActor.skeleton.type].options;g=this;
for(j in e){f=$("<li>"+j+"</li>");b.append(f);f.click(function(){FocusManager.clearFocus();g.label=$(this).text();var b=g.parent;if(b._children&&b._children.length==4&&b._children[3]instanceof LabelInput){var c=g_parts[IDE.editingActor.skeleton.type].options[g.label];if(c.indexOf(b._children[3].label)<0)b._children[3].label=c[0]}g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}f=$("<li>type</li>");b.append(f);f.click(function(){FocusManager.clearFocus();
g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)});f=$("<li>All</li>");b.append(f);f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}else b.append('<li class="disabled">No character</li>');else if(this.type=="charskins")if(IDE.editingActor&&IDE.editingActor.skeleton.skeletonData){f=this.parent;if(f._children&&f._children.length==
4&&f._children[1]instanceof LabelInput)j=f._children[1].label;else{j=g_parts[IDE.editingActor.skeleton.type].options;for(h in j){j=g_parts[IDE.editingActor.skeleton.type].options[h];break}}h=g_parts[IDE.editingActor.skeleton.type].options[j];g=this;if(h)for(e=0;e<h.length;e++){f=$("<li>"+h[e]+"</li>");b.append(f);f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}f=$("<li>reset</li>");b.append(f);
f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}else b.append('<li class="disabled">No character</li>');else if(this.type=="animations"){f=this.parent;h=f._children&&f._children.length==4&&f._children[3]instanceof LabelInput?Runtime.findAnimationsFor(f._children[3].label):Runtime.findAnimationsFor("any");g=this;if(h.length>0)for(e=0;e<h.length;e++)if(h[e].indexOf("runtime")!=0&&h[e].indexOf("tynker")!=
0){f=$("<li>"+h[e]+"</li>");b.append(f);f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}f=$("<li>all</li>");b.append(f);f.click(function(){FocusManager.clearFocus();g.label=$(this).text();g._computeBounds();IDE.draw();dismissChoosers();WinCode._broadcastChange("valueChange",g)})}b=b.parent();b.css("left",d.left+(c.offsetX+this.x+labelRadius)*Blocks._scale);c=d.top+(c.offsetY+this.y+this.height+
4)*Blocks._scale;if(c+b.outerHeight()>window.innerHeight)if(c-this.height-4-4-b.outerHeight()>0)b.css("top",c-(this.height+4+4)*Blocks._scale-b.outerHeight());else{d=$(".toolbar-top").outerHeight()+windowPadding;if(c-(this.height+4+4)*Blocks._scale-d>window.innerHeight-c){b.css("top",d);b.css("height",c-(this.height+4+4)*Blocks._scale-d-10)}else{b.css("top",c);b.css("height",window.innerHeight-c-14*Blocks._scale)}}else b.css("top",c)}};
LabelInput.prototype.keyPressed=function(b,c){if(this.hasFocus){this.label=""+this.label;if(c==0){if(b==8){if(this.label.length>0){if(this.cursorPos>0){this.label=this.label.substring(0,this.cursorPos-1)+this.label.substring(this.cursorPos);this.cursorPos--}if(this.parent&&this.parent.func=="valueOpExpression"){var d=WinExpressions.buildObject(this.label);if(d!=null&&d instanceof Label){d.hidden=true;this._child=null;this._child=d;d.parent=this;this.fontColor="#007700"}else this.fontColor="#ff0000"}}return true}if(b==
37){this.cursorPos>0&&this.cursorPos--;return true}if(b==39){this.cursorPos<this.label.length&&this.cursorPos++;return true}if(b==32){if(this.type=="number"||this.type=="angle"||this.type=="mathangle"){if(d>="0"&&d<="9"||d=="."||d=="-"){this.label=this.label.substring(0,this.cursorPos)+" "+this.label.substring(this.cursorPos);this.cursorPos++}}else{this.label=this.label.substring(0,this.cursorPos)+" "+this.label.substring(this.cursorPos);this.cursorPos++}if(this.parent&&this.parent.func=="valueOpExpression"){d=
WinExpressions.buildObject(this.label);if(d!=null&&d instanceof Label){d.hidden=true;this._child=null;this._child=d;d.parent=this;this.fontColor="#007700"}else this.fontColor="#ff0000"}return true}}else if(c>=32){d=String.fromCharCode(c);if(this.type=="number"||this.type=="angle"||this.type=="mathangle"){if(d>="0"&&d<="9"||d=="."||d=="-"){this.label=this.label.substring(0,this.cursorPos)+d+this.label.substring(this.cursorPos);this.cursorPos++}}else{this.label=this.label.substring(0,this.cursorPos)+
d+this.label.substring(this.cursorPos);this.cursorPos++}if(this.parent&&this.parent.func=="valueOpExpression"){d=WinExpressions.buildObject(this.label);if(d!=null&&d instanceof Label){d.hidden=true;this._child=null;this._child=d;d.parent=this;this.fontColor="#007700"}else this.fontColor="#ff0000"}return true}}return false};LabelInput.prototype.draw=function(b){this._draw(b)};
LabelInput.prototype._draw=function(b){if(this._child!=null&&!this._child.hidden)this._child._draw(b);else{b.save();if(this.type=="color"){b.strokeStyle=this.label;b.fillStyle=this.label}else if(window.RenderCode&&RenderCode.isCode()){b.strokeStyle=defaultInputCodeLineColor;b.fillStyle=defaultInputCodeBgColor}else{b.strokeStyle=defaultInputLineColor;b.fillStyle=defaultInputBgColor}if(this.hilight&&!this.hasFocus){b.shadowColor="#0f0";b.shadowBlur=20;b.fillStyle="#0f0"}if(this.disabled){b.globalAlpha=
disabledLabelAlpha;if(disabledFillColor)b.fillStyle=disabledFillColor;if(disabledStrokeColor)b.strokeStyle=disabledStrokeColor}b.textAlign="left";b.textBaseline="middle";b.font=window.RenderCode&&RenderCode.isCode()?defaultLabelInputFontWeight+" "+this.fontSize+"px "+defaultCodeLabelInputFont:defaultLabelInputFontWeight+" "+this.fontSize+"px "+defaultLabelInputFont;var c=this.fontSize+6,d=this.width;b.translate(this.x,this.y+(this.height-c)/2);if(this.type=="boolean"){b.beginPath();b.moveTo(0,c/2);
b.lineTo(c/4,c);b.lineTo(d-c/4,c);b.lineTo(d,c/2);b.lineTo(d-c/4,0);b.lineTo(c/4,0);b.closePath();b.fill();b.strokeStyle="rgba(0,0,0,.3)";b.beginPath();b.moveTo(c/4,0);b.lineTo(d-c/4,0);b.lineTo(d,c/2);b.stroke();b.strokeStyle="rgba(0,0,0,.2)";b.beginPath();b.moveTo(c/4,0);b.lineTo(0,c/2)}else if(this.type=="number"){var e=c/2;b.beginPath();b.moveTo(0,e);b.arcTo(0,0,e,0,e);b.lineTo(d-e,0);b.arcTo(d,0,d,e,e);b.lineTo(d,c-e);b.arcTo(d,c,d-e,c,e);b.lineTo(e,c);b.arcTo(0,c,0,c-e,e);b.closePath();b.fill();
b.strokeStyle="rgba(0,0,0,.3)";b.beginPath();b.moveTo(e,0);b.lineTo(d-e,0);b.arcTo(d,0,d,e,e);b.stroke();b.strokeStyle="rgba(0,0,0,.2)";b.beginPath();b.moveTo(e,0);b.arcTo(0,0,0,e,e)}else{b.beginPath();b.moveTo(0,labelAnyRadius);b.arcTo(0,0,labelAnyRadius,0,labelAnyRadius);b.lineTo(d-labelAnyRadius,0);b.arcTo(d,0,d,labelAnyRadius,labelAnyRadius);b.lineTo(d,c-labelAnyRadius);b.arcTo(d,c,d-labelAnyRadius,c,labelAnyRadius);b.lineTo(labelAnyRadius,c);b.arcTo(0,c,0,c-labelAnyRadius,labelAnyRadius);b.closePath();
b.fill();b.strokeStyle="rgba(0,0,0,.3)";b.beginPath();b.moveTo(labelAnyRadius,0);b.lineTo(d-labelAnyRadius,0);b.arcTo(d,0,d,labelAnyRadius,labelAnyRadius);b.lineTo(d,c-labelAnyRadius);b.stroke();b.strokeStyle="rgba(0,0,0,.2)";b.beginPath();b.moveTo(labelAnyRadius,0);b.arcTo(0,0,0,labelAnyRadius,labelAnyRadius);b.lineTo(0,c-labelAnyRadius)}b.stroke();b.strokeStyle=this.fontColor;b.fillStyle=this.fontColor;if(this.parent&&this.parent.parent&&this.parent.parent.func=="blockInlineComment"){b.strokeStyle=
defaultFontCommentColor;b.fillStyle=defaultFontCommentColor}this.type=="string"&&this.label?b.fillText((""+this.label).substring(0,80)+((""+this.label).length>80?"...":""),3+labelRadius,c/2):b.fillText(this.label,3+labelRadius,c/2);if(this.hasFocus){c=b.measureText((""+this.label).substring(0,this.cursorPos)).width+3+labelRadius+0.5;b.lineWidth=1;b.beginPath();b.moveTo(c,2);b.lineTo(c,this.height-3);b.closePath();b.stroke()}else if(this.type=="variables"||this.type=="lists"){b.strokeStyle=dropdownColor;
b.fillStyle=dropdownColor;b.beginPath();b.moveTo(d-labelRadius-1,5);b.lineTo(d-labelRadius-1-4,10);b.lineTo(d-labelRadius-1-8,5);b.closePath();b.stroke();b.fill()}b.restore()}};
Blocks={showMarked:!1,images:{"ide/imgs/play.png":null,"ide/imgs/button-cw.png":null,"ide/imgs/button-ccw.png":null,"ide/imgs/button-add.png":null,"ide/imgs/button-remove.png":null,"ide/imgs/button-edit.png":null,"ide/imgs/button-grass.png":null,"ide/imgs/button-drone.png":null,"ide/imgs/button-ollie.png":null,"ide/imgs/button-hue.png":null,"ide/imgs/button-sphero.png":null,"ide/imgs/button-wedo2.png":null},_scale:1,_pattern:/^[0-9a-fA-F]+\.(png|jpg)$/,reLabel:RegExp(/(?:\{(?:[-a-zA-Z0-9:#_./!? ]+|\{[0-9]+\})+\})/g),
revLabel:RegExp(/\{(choice:)?([a-zA-Z0-9 ]+):?(([-a-zA-Z0-9#_./!? ]+|\{[0-9]+\})+)?}/g),reHexColor:RegExp(/^[0-9A-Fa-f]{6}$/),allowAddInOptions:!0,getImage:function(b){if(Blocks.images[b])c=Blocks.images[b];else{var c=new Image;c.onload=function(){c.ready=true;window.IDE&&IDE.computeAll();window.IDE&&IDE.draw()};c.src=b.indexOf("/")>=0?b:Blocks._pattern.test(b)?"/assets2/assets/"+b:"ide/imgs/puzzler/"+b;Blocks.images[b]=c}return c},findBlockWithId:function(b,c){if(b instanceof Block){if(b.id==c)return b;
var d=Blocks.findBlockWithId(b.label,c);if(d!=null)return d;for(var e=0;e<b._containers.length;e++){d=Blocks.findBlockWithId(b._containers[e],c);if(d!=null)return d}if(b.next!=null){d=Blocks.findBlockWithId(b.next,c);if(d!=null)return d}}else if(b instanceof Label){if(b.id==c)return b;for(e=0;e<b._children.length;e++){d=Blocks.findBlockWithId(b._children[e],c);if(d!=null)return d}}else if(b instanceof LabelInput&&b._child!=null){d=Blocks.findBlockWithId(b._child,c);if(d!=null)return d}return null},
measureText:function(b,c){if(!Blocks.fontCtx)Blocks.fontCtx={};c||(c=defaultLabelFont);if(!Blocks.fontCtx[c]){Blocks.fontCtx[c]=$("<canvas></canvas>")[0].getContext("2d");Blocks.fontCtx[c].font=defaultLabelFontWeight+" "+defaultLabelFontSize+"px "+c}return Blocks.fontCtx[c].measureText(b)}};$(document).ready(function(){for(var b in Blocks.images)Blocks.images[b]=Blocks.getImage(b)});
function Block(b){this.cat=b.cat!==void 0?b.cat:"flow";this.func=b.func!==void 0?b.func:"nop";this.id=b.id!==void 0?b.id:0;if(b.name)this.name=b.name;this.hasFlap=b.hasFlap!==void 0?b.hasFlap:true;this.hasSlot=b.hasSlot!==void 0?b.hasSlot:true;this.color=g_catColor[b.cat]!==void 0?g_catColor[b.cat]:g_defaultStepColor;this.marked=b.marked!==void 0?b.marked:false;this.hilight=false;if(b.note)this.note=b.note;this.totalHeight=this.height=this.width=this.y=this.x=0;this._containers=[];if(b.containers!==
void 0){this._containerLabels=[];for(var c=0;c<b.containers;c++){this._containers.push(null);if(c>0){var d;if(c<b.containers-1){d=window.RenderCode?RenderCode.getElseIfLabel(this):"else if {boolean} then";d=new Label({label:d,cat:this.cat})}else if(c<b.containers){d=window.RenderCode?RenderCode.getElseLabel(this):"else";d=new Label({label:d,cat:this.cat})}d.parent=this;d.draggable=false;this._containerLabels.push(d)}}}this.parent=this.next=null;this.labelText=b.label?b.label:b.name?b.name:"";if(!this.hasFlap&&
!this.hasSlot){this.labelText="Code Notes";this.width=100;this.totalHeight=this.height=24}c=this.labelText;window.RenderCode&&(c=RenderCode.getCodeStartLabel(this));this.locked=b.locked?true:false;this.hidden=b.hidden?true:false;this.func=="registerFunction"&&!this.locked&&(c=c+" {button:editfn}");this.label=new Label({label:c,cat:this.cat,varargs:b.varargs});this.label.parent=this;this.label.draggable=false}
Block.prototype.reRender=function(){var b=ObjectIO.genScriptObj(this),b=ObjectIO.deserializeScriptStep(b);this.cat=b.cat;this.func=b.func;if(b.name)this.name=b.name;this.hasFlap=b.hasFlap;this.hasSlot=b.hasSlot;this.color=b.color;this.marked=b.marked;this.hilight=b.hilight;if(b.note)this.note=b.note;if(this._containers=b._containers)for(var c=0;c<this._containers.length;c++)if(this._containers[c])this._containers[c].parent=this;if(this._containerLabels=b._containerLabels)for(c=0;c<this._containerLabels.length;c++)if(this._containerLabels[c])this._containerLabels[c].parent=
this;if(this.next=b.next)this.next.parent=this;this.labelText=b.labelText;this.label=b.label;this.label.parent=this;this._computeBlockBounds()};Block.prototype.convertToLabel=function(){var b=this.label.copy();b.name=this.name;b.cat=this.cat;b.parent=null;b.draggable=true;b.label=b.labelText;return b};
Block.prototype.setDisabled=function(b){this.disabled=b;this.label.setDisabled(b);for(var c=0;c<this._containers.length;c++)this._containers[c]!=null&&this._containers[c].setDisabled(b);this.next!=null&&this.next.setDisabled(b)};
Block.prototype.selectInBounds=function(b,c,d,e){this.showSelected=!(b>this.x+this.width||b+d<this.x||c>this.y+this.height||c+e<this.y);this.label.selectInBounds(b,c,d,e);if(this.showSelected)for(var f=0;f<this._containers.length;f++)this._containers[f]!=null&&this._containers[f].setSelected(true,true);else for(f=0;f<this._containers.length;f++)this._containers[f]!=null&&this._containers[f].selectInBounds(b,c,d,e);this.next!=null&&this.next.selectInBounds(b,c,d,e)};
Block.prototype.setSelected=function(b,c){this.showSelected=b;this.label.setSelected(b,c);for(var d=false,e=0;e<this._containers.length;e++)this._containers[e]!=null&&(c===false||c===true?this._containers[e].setSelected(b,true):this._containers[e].setSelected(b,-c)&&(d=true));if(this._containerLabels)for(e=0;e<this._containerLabels.length;e++)this._containerLabels[e].setSelected(b,true);if(c)if(!d&&this.id!=c&&this.id!=-c){if(this.next!=null)return this.next.setSelected(b,c)}else{this.next!=null&&
this.next.setSelected(c<0,true);return true}return d};Block.prototype.setCurrent=function(){this.getRoot()._setCurrent(this)};Block.prototype._setCurrent=function(b){this.isCurrent=this==b?true:false;for(var c=0;c<this._containers.length;c++)this._containers[c]!=null&&this._containers[c]._setCurrent(b);this.next!=null&&this.next._setCurrent(b)};
Block.prototype.setOutline=function(b){this.showOutline=b;this.label.setOutline(b);for(var c=0;c<this._containers.length;c++)this._containers[c]!=null&&this._containers[c].setOutline(b);this.next!=null&&this.next.setOutline(b)};
Block.prototype.copy=function(){var b=new Block({cat:this.cat,func:this.func,label:this.labelText,name:this.name,containers:this._containers.length,containerLabels:this._containers.length,hasFlap:this.hasFlap,hasSlot:this.hasSlot,color:this.color,locked:this.locked,hidden:this.hidden});b.label=this.label.copy();b.label.parent=b;b.labelText=this.labelText;if(this.marked)b.marked=true;if(this.locked)b.locked=true;if(this.tags&&this.tags.length>0){b.tags=[];for(var c=0;c<this.tags.length;c++)b.tags.push(this.tags[c])}b.x=
this.x;b.y=this.y;b.width=this.width;b.height=this.height;if(this._containers.length>1)b._containerLabels=[];for(c=0;c<this._containers.length;c++){if(this._containers[c]!=null){b._containers[c]=this._containers[c].copy();b._containers[c].parent=b}if(c>0){var d=this._containerLabels[c-1].copy();d.labelText=this._containerLabels[c-1].labelText;d.parent=b;b._containerLabels[c-1]=d}}if(this.next!=null){b.next=this.next.copy();b.next.parent=b}return b};
Block.prototype.copySelection=function(){var b=null;if(this.showSelected){b=new Block({cat:this.cat,func:this.func,label:this.labelText,name:this.name,containers:this._containers.length,hasFlap:this.hasFlap,hasSlot:this.hasSlot,color:this.color});b.label=this.label.copy();b.label.parent=b;b.labelText=this.labelText;b.x=this.x;b.y=this.y;b.width=this.width;b.height=this.height;for(var c=0;c<this._containers.length;c++){if(this._containers[c]!=null){b._containers[c]=this._containers[c].copy();b._containers[c].parent=
b}if(c>0){var d=this._containerLabels[c-1].copy();d.labelText=this._containerLabels[c-1].labelText;d.parent=b;b._containerLabels[c-1]=d}}if(this.next!=null){b.next=this.next.copySelection();if(b.next!=null)b.next.parent=b}}return b};
Block.prototype.copyUntil=function(b){var c=new Block({cat:this.cat,func:this.func,label:this.labelText,name:this.name,containers:this._containers.length,hasFlap:this.hasFlap,hasSlot:this.hasSlot,color:this.color});c.label=this.label.copy();c.label.parent=c;c.x=this.x;c.y=this.y;c.width=this.width;c.height=this.height;for(var d=0;d<this._containers.length;d++){if(this._containers[d]!=null){c._containers[d]=this._containers[d].copyUntil(b);c._containers[d].parent=c}if(d>0){var e=this._containerLabels[d-
1].copy();e.labelText=this._containerLabels[d-1].labelText;e.parent=c;c._containerLabels[d-1]=e}}if(this.next!=null){c.next=this.next.copyUntil(b);c.next.parent=c}return c};Block.prototype.getMaxWidth=function(){var b=this.width;if(this.next){var c=this.next.getMaxWidth();c>b&&(b=c)}for(var d=0;d<this._containers.length;d++){c=this._containers[d];if(c!=null){c=c.getMaxWidth();c+containerLeft>b&&(b=c+containerLeft)}}return b};
Block.prototype.getImage=function(b,c){c||(c=1);if(this.hasFlap)this.y=this.y+slotHeight;this._computeBounds();var d=this.getMaxWidth(),d=$('<canvas style="display:none;position:absolute;left:0px;top:0px;z-index:100000;" width="'+(d+1)*c+'" height="'+(this.totalHeight+slotHeight+1)*c+'"></canvas>'),e=d[0].getContext("2d");e.translateX=0;e.translateY=0;e.offsetX=0;e.offsetY=0;e.translate(0.5,0.5);e.scale(c,c);this.draw(e);var d=d[0].toDataURL(),f=new Image;if(b)f.onload=function(){b(f)};f.src=d;if(this.hasFlap)this.y=
this.y-slotHeight;return f};Block.prototype.addToContainer=function(b,c){if(b>=0&&b<this._containers.length){var d=this._containers[b];if(d!=null){for(var e=c;e.next!=null;)e=e.next;e.next=d;d.parent=e}this._containers[b]=c;if(c!=null)c.parent=this;this._computeBounds()}};Block.prototype.appendToContainer=function(b,c){if(c&&b>=0&&b<this._containers.length){var d=this._containers[b];if(d!=null){for(;d.next!=null;)d=d.next;d.next=c;c.parent=d}else{c.parent=this;this._containers[b]=c}this._computeBounds()}};
Block.prototype.getNumContainers=function(){return this._containers.length};Block.prototype.getBlockAtContainer=function(b){return b>=0&&b<this._containers.length?this._containers[b]:null};Block.prototype.getLabelAtContainer=function(b){return b==0?this.label:this._containerLabels[b-1]};Block.prototype.indexForBlockInContainer=function(b){for(var c=0;c<this._containers.length;c++)if(this._containers[c]==b)return c;return-1};
Block.prototype.add=function(b){if(b){if(this.next!=null){for(var c=b;c.next!=null;)c=c.next;c.next=this.next;this.next.parent=c}this.next=b;b.parent=this;this._computeBounds()}};Block.prototype.getLastBlock=function(){for(var b=this;b.next!=null;)b=b.next;return b};Block.prototype.append=function(b){if(b){for(var c=this;c.next!=null;)c=c.next;c.next=b;b.parent=c;this._computeBounds()}};
Block.prototype.detach=function(){var b=this.parent;if(b!=null){for(var c=false,d=0;d<b._containers.length;d++)if(b._containers[d]==this){b._containers[d]=null;c=true;break}if(!c)b.next=null;this.parent=null;b._computeBounds()}};
Block.prototype.detachSelected=function(){var b=null;if(this.showSelected){this.showSelected=false;for(b=this.next;b&&b.showSelected;)b=b.next;if(b&&b.parent){b.parent.next=null;b.parent=null}else b=null;var c=this.parent;if(c!=null){for(var d=false,e=0;e<c._containers.length;e++)if(c._containers[e]==this){if(c._containers[e]=b)b.parent=c;d=true;break}if(!d){if(b)b.parent=c;c.next=b}this.parent=null;c._computeBounds();b=null}this.setSelected(false,true)}b&&b._computeBounds();return b};
Block.prototype.getInputAtPoint=function(b,c){var d=this.label.getInputAtPoint(b,c);if(!d&&this._containerLabels&&this._containerLabels.length>0)for(var e=0;e<this._containerLabels.length;e++)if(d=this._containerLabels[e].getInputAtPoint(b,c))break;return d};
Block.prototype.getChildAtPoint=function(b,c){if(this.locked&&(this.hasFlap||this.next&&this.next.locked))return null;if(b>=this.x){var d;if(this.hasFlap){if(b<=this.x+this.label.width+labelHorzPadding&&c>=this.y&&c<=this.y+this.label.height+labelVertPadding*2){d=this.label.getChildAtPoint(b,c);return d!=null&&d!=this.label?d:this}d=this.label.height+labelVertPadding*2}else if(this.hasSlot){if(b<=this.x+this.label.width+labelHorzPadding+this.label.height&&c>=this.y&&c<=this.y+this.label.height+labelVertPadding*
2+containerSeparator/2){d=this.label.getChildAtPoint(b,c);return d!=null&&d!=this.label?d:this}d=this.label.height+labelVertPadding*2+containerSeparator/2}else return b<=this.x+this.width&&c>=this.y&&c<=this.y+this.height?this:null;for(var e=0;e<this._containers.length;e++){if(this._containers[e]!=null){var f=this._containers[e].getChildAtPoint(b,c);if(f!=null)return f;d=d+this._containers[e].totalHeight}else d=d+emptyContainerHeight;var f=this.label.width,g=containerSeparator;if(e<this._containers.length-
1){f=this._containerLabels[e].width;g=this._containerLabels[e].height;if(b<=this.x+f+labelHorzPadding&&c>=this.y+d&&c<=this.y+d+g){d=this._containerLabels[e].getChildAtPoint(b,c);return d!=null&&d!=this._containerLabels[e]?d:this}}d=d+g}if(b>=this.x&&b<=this.x+containerLeft&&c>=this.y&&c<=this.y+d)return this;if(this.next!=null)if(f=this.next.getChildAtPoint(b,c))return f}return null};
Block.prototype.nearValue=function(b,c){for(var d=this;d;){var e=d.label.nearValue(b,c);if(e!=null)return e;if(d._containers!=null)for(var f=0;f<d._containers.length;f++){e=d._containers[f];if(e!=null){e=e.nearValue(b,c);if(e!=null)return e}if(f>0){e=d._containerLabels[f-1].nearValue(b,c);if(e!=null)return e}}d=d.next}return null};
Block.prototype.objNearValue=function(b){for(var c=this;c;){var d=c.label.objNearValue(b);if(d!=null)return d;if(c._containers!=null)for(var e=0;e<c._containers.length;e++){d=c._containers[e];if(d!=null){d=d.objNearValue(b);if(d!=null)return d}if(e>0){d=c._containerLabels[e-1].objNearValue(b);if(d!=null)return d}}c=c.next}return null};Block.prototype.blockNearSlot=function(b){return b instanceof Block&&b.hasFlap?this.nearSlot(b.x+slotBegin+slotWidth/2,b.y-slotHeight/2):false};
Block.prototype.blockNearFlap=function(b){return b instanceof Block&&b.hasSlot?this.nearFlap(b.x+slotBegin+slotWidth/2,b.y+b.totalHeight-slotHeight/2):false};Block.prototype.blockNearContainer=function(b){if(b instanceof Block&&b._containers.length>0)for(var c=0;c<b._containers.length;c++);return false};
Block.prototype.nearSlot=function(b,c){var d=this;if(d.locked&&(d.hasFlap||d.next&&d.next.locked))return null;for(;d;){if(d._containers.length>0)for(var e=d.y+d.label.height+labelVertPadding*2,f=0;f<d._containers.length;f++){var g=d._containers[f];if(b>=d.x+containerLeft+slotBegin-slotSelectionBounds&&b<=d.x+d.width&&c>=e-slotHeight-slotSelectionBounds&&c<=e+slotSelectionBounds)return[f,d,d.x+containerLeft,e];if(g!=null){var h=g.nearSlot(b,c);if(h)return h;e=e+g.totalHeight}else e=e+emptyContainerHeight;
e=f<d._containers.length-1?e+d._containerLabels[f].height:e+containerSeparator}if(d.hasSlot&&b>=d.x+slotBegin-slotSelectionBounds&&b<=d.x+d.width&&c>=d.y+d.height-slotHeight-slotSelectionBounds&&c<=d.y+d.height+slotSelectionBounds)return[-1,d,d.x,d.y+d.height];d=d.next}return null};
Block.prototype.nearFlap=function(b,c){for(var d=this;d;){if(d._containers.length>0)for(var e=0;e<d._containers.length;e++){var f=d._containers[e];if(f!=null)if(f=f.nearFlap(b,c))return f}if(d.hasFlap&&b>=d.x+slotBegin-slotSelectionBounds&&b<=d.x+d.width&&c>=d.y-slotHeight-slotSelectionBounds&&c<=d.y+slotSelectionBounds)return[-1,d,d.x,d.y];d=d.next}return null};
Block.prototype.getContainerPos=function(b){if(this._containers.length>0)for(var c=this.y+this.label.height+labelVertPadding*2,d=0;d<this._containers.length;d++){var e=this._containers[d];if(d==b)return[this.x+containerLeft,c];c=e!=null?c+e.totalHeight:c+emptyContainerHeight;c=d<this._containers.length-1?c+this._containerLabels[d].height:c+containerSeparator}return[obj.x,obj.y+obj.height]};Block.prototype.getRoot=function(){for(var b=this;b.parent!=null;)b=b.parent;return b};
Block.prototype._computeBounds=function(){this.getRoot()._computeBlockBounds()};
Block.prototype._computeBlockBounds=function(){if(this.func=="blockComment"&&!this.hasFlap&&!this.hasSlot)this.totalHeight=this.height;else{this.label.x=this.x;this.label.y=this.y+labelVertPadding;if(!this.hasFlap)this.label.y=this.label.y+containerSeparator/2;this.label._computeBlockBounds();this.width=this.label.width+labelHorzPadding;var b=this.label.height+labelVertPadding*2;this.hasFlap||(b=b+startBlockTopHeight);for(var c=0;c<this._containers.length;c++){var d=this._containers[c];if(d!=null){d.x=
this.x+containerLeft;d.y=this.y+b;b=b+d._computeBlockBounds()}else b=b+emptyContainerHeight;if(c<this._containers.length-1){d=this._containerLabels[c];d.x=this.x;d.y=this.y+b;d._computeBlockBounds();b=b+(d.height+labelVertPadding*2);if(d.width+labelHorzPadding>this.width)this.width=d.width+labelHorzPadding}else b=window.RenderCode&&RenderCode.isCode()&&RenderCode.getCodeEndLabel(this)?b+(defaultLabelFontSize+6+labelVertPadding*2):b+containerSeparator}this.height=b;if(!this.hasFlap)this.width=this.width+
(this.label.height+labelVertPadding*2);if(this.next){this.next.x=window.RenderCode&&RenderCode.startRequiresClosingBracket(this)?this.x+containerLeft:this.x;this.next.y=this.y+b;b=b+this.next._computeBlockBounds()}if(window.RenderCode&&RenderCode.startRequiresClosingBracket(this)){b=RenderCode.getCodeEndLabel(this)?b+(defaultLabelFontSize+6+labelVertPadding*2):b+containerSeparator;this.next||(b=b+emptyContainerHeight)}return this.totalHeight=b}};
Block.prototype.draw=function(b){window.WinCode&&(!window.WinCode._hilightStep&&this.showOutline)&&this._drawOutline(b);this._draw(b);window.WinCode&&(window.WinCode._hilightStep&&this.showOutline)&&this._drawOutline(b,4)};
Block.prototype._draw=function(b){if(b.translateX+b.offsetX+this.x<b.canvas.width/Blocks._scale&&b.translateY+b.offsetY+this.y<b.canvas.height/Blocks._scale&&b.translateY+b.offsetY+this.y+this.totalHeight>0){if(!this.hasFlap&&!this.hasSlot){b.save();b.translate(this.x,this.y);if(this.showSelected){b.fillStyle=selectionBgColor;b.strokeStyle=selectionStrokeColor}else if(window.RenderCode&&RenderCode.isCode()){b.fillStyle=g_blockCodeColor[0];b.strokeStyle=g_blockCodeColor[2]}else{b.fillStyle=this.color[0];
b.strokeStyle=this.color[2]}b.beginPath();b.moveTo(0,0);b.lineTo(this.width,0);b.lineTo(this.width,this.height);b.lineTo(0,this.height);b.lineTo(0,this.height);b.closePath();b.fill();b.stroke();b.save();b.beginPath();b.moveTo(notePadding,notePadding);b.lineTo(this.width-notePadding,notePadding);b.lineTo(this.width-notePadding,this.height-notePadding);b.lineTo(notePadding,this.height-notePadding);b.clip();b.strokeStyle="#000";b.fillStyle="#000";b.font=noteFontHeight+"px "+noteFont;for(var c=breakLines(this.labelText,
b,this.width-notePadding*2).lines,d=0;d<c.length;d++)b.fillText(c[d],notePadding,notePadding+noteFontHeight+noteFontHeight*d);b.restore();if(this.showDragHandle){b.strokeStyle="#555";b.globalAlpha=0.3;b.lineWidth=1;for(d=4;d<=16;d=d+3){b.beginPath();b.moveTo(this.width-2.5-d,this.height-2.5);b.lineTo(this.width-2.5,this.height-2.5-d);b.closePath();b.stroke()}}b.restore();return}b.save();if(this.showSelected){b.fillStyle=selectionBgColor;b.strokeStyle=selectionStrokeColor}else{if(window.RenderCode&&
RenderCode.isCode()){b.fillStyle=g_blockCodeColor[0];b.strokeStyle=g_blockCodeColor[2]}else{b.fillStyle=this.color[0];b.strokeStyle=this.color[2]}b.lineWidth=labelStrokeWidth}if(this.hilight){b.shadowColor=hilightShadowColor;b.shadowBlur=10;b.fillStyle=hilightFillColor}else if(this.disabled){b.globalAlpha=disabledBlockAlpha;if(disabledFillColor)b.fillStyle=disabledFillColor;if(disabledStrokeColor)b.strokeStyle=disabledStrokeColor}else if(this.marked&&Blocks.showMarked)b.globalAlpha=0.5;b.translate(this.x,
this.y);b.beginPath();c=0;if(this.hasFlap){b.moveTo(0,0);b.lineTo(slotBegin,0);b.lineTo(slotBegin,-slotHeight+cornerRadius);b.lineTo(slotBegin+cornerRadius,-slotHeight);b.lineTo(slotBegin+slotWidth-cornerRadius,-slotHeight);b.lineTo(slotBegin+slotWidth,-slotHeight+cornerRadius);b.lineTo(slotBegin+slotWidth,0);b.lineTo(this.label.width+labelHorzPadding-cornerRadius,0);b.lineTo(this.label.width+labelHorzPadding,cornerRadius);c=c+(this.label.height+labelVertPadding*2);b.lineTo(this.label.width+labelHorzPadding,
c-cornerRadius);b.lineTo(this.label.width+labelHorzPadding-cornerRadius,c)}else{b.moveTo(cornerRadius,0);b.lineTo(startBlockTopWidth-cornerRadius,0);b.lineTo(startBlockTopWidth,cornerRadius);b.lineTo(startBlockTopWidth,startBlockTopHeight);b.lineTo(this.label.width,startBlockTopHeight);b.arcTo(this.label.width+startBlockRadius,startBlockTopHeight,this.label.width+startBlockRadius,this.label.height+labelVertPadding*2,startBlockRadius);c=c+(this.label.height+labelVertPadding*2+startBlockTopHeight);
b.lineTo(this.label.width+startBlockRadius,c-cornerRadius);b.lineTo(this.label.width+startBlockRadius-cornerRadius,c)}for(d=0;d<this._containers.length;d++){b.lineTo(containerLeft+slotBegin+slotWidth,c);b.lineTo(containerLeft+slotBegin+slotWidth,c-slotHeight+cornerRadius);b.lineTo(containerLeft+slotBegin+slotWidth-cornerRadius,c-slotHeight);b.lineTo(containerLeft+slotBegin+cornerRadius,c-slotHeight);b.lineTo(containerLeft+slotBegin,c-slotHeight+cornerRadius);b.lineTo(containerLeft+slotBegin,c);b.lineTo(containerLeft,
c);var e=this._containers[d],c=e!=null?c+e.totalHeight:c+emptyContainerHeight;b.lineTo(containerLeft,c);if(this._containers[d]!=null){b.lineTo(containerLeft+slotBegin,c);b.lineTo(containerLeft+slotBegin,c-slotHeight);b.lineTo(containerLeft+slotBegin+slotWidth,c-slotHeight);b.lineTo(containerLeft+slotBegin+slotWidth,c)}if(d<this._containers.length-1){if(cornerRadius>0&&d<this._containers.length-1){b.lineTo(this._containerLabels[d].width+labelHorzPadding-cornerRadius,c);b.lineTo(this._containerLabels[d].width+
labelHorzPadding,c+cornerRadius)}else b.lineTo(this._containerLabels[d].width+labelHorzPadding,c);c=c+(this._containerLabels[d].height+labelVertPadding*2);if(cornerRadius>0){b.lineTo(this._containerLabels[d].width+labelHorzPadding,c-cornerRadius);b.lineTo(this._containerLabels[d].width+labelHorzPadding-4,c)}else b.lineTo(this._containerLabels[d].width+labelHorzPadding,c)}else{e=this.label.width;e=60;if(cornerRadius>0&&d<this._containers.length-1){b.lineTo(e+labelHorzPadding-cornerRadius,c);b.lineTo(e+
labelHorzPadding,c+cornerRadius)}else b.lineTo(e+labelHorzPadding,c);c=window.RenderCode&&RenderCode.isCode()&&RenderCode.getCodeEndLabel(this)?c+(defaultLabelFontSize+6+labelVertPadding*2):c+containerSeparator}}if(this._containers.length>0){e=60;b.lineTo(e+labelHorzPadding,c-cornerRadius);b.lineTo(e+labelHorzPadding-cornerRadius,c)}if(this.hasSlot)if(window.RenderCode&&RenderCode.startRequiresClosingBracket(this)){b.lineTo(containerLeft+slotBegin+slotWidth,c);b.lineTo(containerLeft+slotBegin+slotWidth,
c-slotHeight+cornerRadius);b.lineTo(containerLeft+slotBegin+slotWidth-cornerRadius,c-slotHeight);b.lineTo(containerLeft+slotBegin+cornerRadius,c-slotHeight);b.lineTo(containerLeft+slotBegin,c-slotHeight+cornerRadius);b.lineTo(containerLeft+slotBegin,c)}else{b.lineTo(slotBegin+slotWidth,c);b.lineTo(slotBegin+slotWidth,c-slotHeight+cornerRadius);b.lineTo(slotBegin+slotWidth-cornerRadius,c-slotHeight);b.lineTo(slotBegin+cornerRadius,c-slotHeight);b.lineTo(slotBegin,c-slotHeight+cornerRadius);b.lineTo(slotBegin,
c)}if(window.RenderCode&&RenderCode.startRequiresClosingBracket(this)){e=60;d=containerSeparator;RenderCode.getCodeEndLabel(this)&&(d=defaultLabelFontSize+6+labelVertPadding*2);b.lineTo(containerLeft,c);b.lineTo(containerLeft,this.totalHeight-d);if(this.next){b.lineTo(containerLeft+slotBegin,this.totalHeight-d);b.lineTo(containerLeft+slotBegin,this.totalHeight-d-slotHeight);b.lineTo(containerLeft+slotBegin+slotWidth,this.totalHeight-d-slotHeight);b.lineTo(containerLeft+slotBegin+slotWidth,this.totalHeight-
d)}b.lineTo(e+labelHorzPadding,this.totalHeight-d);b.lineTo(e+labelHorzPadding,this.totalHeight);b.lineTo(0,this.totalHeight)}else b.lineTo(0,c);b.lineTo(0,cornerRadius);b.closePath();b.fill();b.stroke();b.restore();this.label.draw(b);for(d=0;d<this._containers.length;d++){e=this._containers[d];if(d>0){b.save();this._containerLabels[d-1].draw(b);b.restore()}e!=null&&e._draw(b)}if(window.RenderCode&&RenderCode.isCode())if(this._containers.length>0){d=RenderCode.getCodeEndLabel(this);b.save();b.translate(this.x,
this.y);b.beginPath();b.textAlign="left";b.textBaseline="middle";b.strokeStyle=g_defaultStepColor[3];b.fillStyle=g_defaultStepColor[3];b.font=defaultLabelFontWeight+" "+defaultLabelFontSize+"px "+defaultCodeLabelFont;b.fillText(d,labelHorzPadding+labelRadius,c-labelVertPadding-(defaultLabelFontSize+6)/2);b.restore()}else if(RenderCode.startRequiresClosingBracket(this)){d=RenderCode.getCodeEndLabel(this);b.save();b.translate(this.x,this.y);b.beginPath();b.textAlign="left";b.textBaseline="middle";b.strokeStyle=
g_defaultStepColor[3];b.fillStyle=g_defaultStepColor[3];b.font=defaultLabelFontWeight+" "+defaultLabelFontSize+"px "+defaultCodeLabelFont;b.fillText(d,labelHorzPadding+labelRadius,this.totalHeight-labelVertPadding-(defaultLabelFontSize+6)/2);b.restore()}}this.next!=null&&this.next._draw(b)};
Block.prototype._drawOutline=function(b,c){if(b.translateX+b.offsetX+this.x<b.canvas.width/Blocks._scale&&b.translateY+b.offsetY+this.y<b.canvas.height/Blocks._scale&&b.translateY+b.offsetY+this.y+this.totalHeight>0){if(window.WinCode&&(!window.WinCode._hilightStep||this.isCurrent)){b.save();b.fillStyle=outlineColor;b.strokeStyle=outlineColor;b.lineWidth=c?c:outlineWidth;b.lineCap="round";b.translate(this.x,this.y);b.beginPath();var d=0;if(this.hasFlap){b.moveTo(0,0);b.lineTo(slotBegin,0);b.lineTo(slotBegin,
-slotHeight+cornerRadius);b.lineTo(slotBegin+cornerRadius,-slotHeight);b.lineTo(slotBegin+slotWidth-cornerRadius,-slotHeight);b.lineTo(slotBegin+slotWidth,-slotHeight+cornerRadius);b.lineTo(slotBegin+slotWidth,0);b.lineTo(this.label.width+labelHorzPadding-cornerRadius,0);b.lineTo(this.label.width+labelHorzPadding,cornerRadius);d=d+(this.label.height+labelVertPadding*2);b.lineTo(this.label.width+labelHorzPadding,d-cornerRadius);b.lineTo(this.label.width+labelHorzPadding-cornerRadius,d)}else{b.moveTo(cornerRadius,
0);b.lineTo(startBlockTopWidth-cornerRadius,0);b.lineTo(startBlockTopWidth,cornerRadius);b.lineTo(startBlockTopWidth,startBlockTopHeight);b.lineTo(this.label.width,startBlockTopHeight);b.arcTo(this.label.width+startBlockRadius,startBlockTopHeight,this.label.width+startBlockRadius,this.label.height+labelVertPadding*2,startBlockRadius);d=d+(this.label.height+labelVertPadding*2+startBlockTopHeight);b.lineTo(this.label.width+startBlockRadius,d-cornerRadius);b.lineTo(this.label.width+startBlockRadius-
cornerRadius,d)}for(var e=0;e<this._containers.length;e++){b.lineTo(containerLeft+slotBegin+slotWidth,d);b.lineTo(containerLeft+slotBegin+slotWidth,d-slotHeight+cornerRadius);b.lineTo(containerLeft+slotBegin+slotWidth-cornerRadius,d-slotHeight);b.lineTo(containerLeft+slotBegin+cornerRadius,d-slotHeight);b.lineTo(containerLeft+slotBegin,d-slotHeight+cornerRadius);b.lineTo(containerLeft+slotBegin,d);b.lineTo(containerLeft,d);var f=this._containers[e],d=f!=null?d+f.totalHeight:d+emptyContainerHeight;
b.lineTo(containerLeft,d);if(this._containers[e]!=null){b.lineTo(containerLeft+slotBegin,d);b.lineTo(containerLeft+slotBegin,d-slotHeight);b.lineTo(containerLeft+slotBegin+slotWidth,d-slotHeight);b.lineTo(containerLeft+slotBegin+slotWidth,d)}if(e<this._containers.length-1){if(cornerRadius>0&&e<this._containers.length-1){b.lineTo(this._containerLabels[e].width+labelHorzPadding-cornerRadius,d);b.lineTo(this._containerLabels[e].width+labelHorzPadding,d+cornerRadius)}else b.lineTo(this._containerLabels[e].width+
labelHorzPadding,d);d=d+this._containerLabels[e].height;if(cornerRadius>0){b.lineTo(this._containerLabels[e].width+labelHorzPadding,d-cornerRadius);b.lineTo(this._containerLabels[e].width+labelHorzPadding-4,d)}else b.lineTo(this._containerLabels[e].width+labelHorzPadding,d)}else{f=this.label.width;f=60;if(cornerRadius>0&&e<this._containers.length-1){b.lineTo(f+labelHorzPadding-cornerRadius,d);b.lineTo(f+labelHorzPadding,d+cornerRadius)}else b.lineTo(f+labelHorzPadding,d);d=window.RenderCode&&RenderCode.isCode()&&
RenderCode.getCodeEndLabel(this)?d+(defaultLabelFontSize+6+labelVertPadding*2):d+containerSeparator}}if(this._containers.length>0){f=60;b.lineTo(f+labelHorzPadding,d-cornerRadius);b.lineTo(f+labelHorzPadding-cornerRadius,d)}if(this.hasSlot)if(window.RenderCode&&RenderCode.startRequiresClosingBracket(this)){b.lineTo(containerLeft+slotBegin+slotWidth,d);b.lineTo(containerLeft+slotBegin+slotWidth,d-slotHeight+cornerRadius);b.lineTo(containerLeft+slotBegin+slotWidth-cornerRadius,d-slotHeight);b.lineTo(containerLeft+
slotBegin+cornerRadius,d-slotHeight);b.lineTo(containerLeft+slotBegin,d-slotHeight+cornerRadius);b.lineTo(containerLeft+slotBegin,d)}else{b.lineTo(slotBegin+slotWidth,d);b.lineTo(slotBegin+slotWidth,d-slotHeight+cornerRadius);b.lineTo(slotBegin+slotWidth-cornerRadius,d-slotHeight);b.lineTo(slotBegin+cornerRadius,d-slotHeight);b.lineTo(slotBegin,d-slotHeight+cornerRadius);b.lineTo(slotBegin,d)}if(window.RenderCode&&RenderCode.startRequiresClosingBracket(this)){f=60;e=containerSeparator;RenderCode.getCodeEndLabel(this)&&
(e=defaultLabelFontSize+6+labelVertPadding*2);b.lineTo(containerLeft,d);b.lineTo(containerLeft,this.totalHeight-e);b.lineTo(f+labelHorzPadding,this.totalHeight-e);if(this.next){b.lineTo(containerLeft+slotBegin,this.totalHeight-e);b.lineTo(containerLeft+slotBegin,this.totalHeight-e-slotHeight);b.lineTo(containerLeft+slotBegin+slotWidth,this.totalHeight-e-slotHeight);b.lineTo(containerLeft+slotBegin+slotWidth,this.totalHeight-e)}b.lineTo(f+labelHorzPadding,this.totalHeight-e);b.lineTo(f+labelHorzPadding,
this.totalHeight);b.lineTo(0,this.totalHeight)}else b.lineTo(0,d);b.lineTo(0,cornerRadius);b.closePath();b.stroke();b.restore()}for(e=0;e<this._containers.length;e++){f=this._containers[e];f!=null&&f._drawOutline(b,c)}}this.next!=null&&this.next._drawOutline(b,c)};
var SoundGenerator={tempo:60,PI_2:2*Math.PI,sample_rate:44100,soundId:0,sounds:{},notes:[0,0,0,0,0,0,0,0,0,0,0,0,0,16.35,17.32,18.35,19.45,20.6,21.83,23.12,24.5,25.96,27.5,29.14,30.87,32.7,34.65,36.71,38.89,41.2,43.65,46.25,49,51.91,55,58.27,61.74,65.41,69.3,73.42,77.78,82.41,87.31,92.5,98,103.83,110,116.54,123.47,130.81,138.59,146.83,155.56,164.81,174.61,185,196,207.65,220,233.08,246.94,261.63,277.18,293.66,311.13,329.63,349.23,369.99,392,415.3,440,466.16,493.88,523.25,554.37,587.33,622.25,659.26,
698.46,739.99,783.99,830.61,880,932.33,987.77,1046.5,1108.73,1174.66,1244.51,1318.51,1396.91,1479.98,1567.98,1661.22,1760,1864.66,1975.53,2093,2217.46,2349.32,2489.02,2637.02,2793.83,2959.96,3135.96,3322.44,3520,3729.31,3951.07,4186.01,4434.92,4698.64,4978.03],midiInstruments:{},midiSounds:{},midiNotes:"            C0 Db0 D0 Eb0 E0 F0 Gb0 G0 Ab0 A0 Bb0 B0 C1 Db1 D1 Eb1 E1 F1 Gb1 G1 Ab1 A1 Bb1 B1 C2 Db2 D2 Eb2 E2 F2 Gb2 G2 Ab2 A2 Bb2 B2 C3 Db3 D3 Eb3 E3 F3 Gb3 G3 Ab3 A3 Bb3 B3 C4 Db4 D4 Eb4 E4 F4 Gb4 G4 Ab4 A4 Bb4 B4 C5 Db5 D5 Eb5 E5 F5 Gb5 G5 Ab5 A5 Bb5 B5 C6 Db6 D6 Eb6 E6 F6 Gb6 G6 Ab6 A6 Bb6 B6 C7 Db7 D7 Eb7 E7 F7 Gb7 G7 Ab7 A7 Bb7 B7 C8 Db8 D8 Eb8 E8 F8 Gb8 G8 Ab8 A8 Bb8 B8 C9 Db9 D9 Eb9 E9 F9 Gb9 G9 Ab9 A9 Bb9 B9".split(" "),
midiAudioPlayer:null,midiReplayer:null,midiSynth:null};$(document).ready(function(){if(!window.AudioContext&&window.webkitAudioContext)window.AudioContext=window.webkitAudioContext;if(window.AudioContext)SoundGenerator.context=new AudioContext});SoundGenerator.removeSound=function(b,c){var d=SoundGenerator.sounds[b];if(d){for(var e=0;e<d.length;e++)if(d[e].id==c){d.splice(e,1);break}var d=false,f;for(f in SoundGenerator.sounds)if(SoundGenerator.sounds[f].length>0){d=true;break}d||SoundGenerator.pause()}};
SoundGenerator.removeAll=function(){SoundGenerator.sounds={}};SoundGenerator.onaudioprocess=function(b){for(var b=b.outputBuffer.getChannelData(0),c=0;c<b.length;c++){var d=0,e;for(e in SoundGenerator.sounds){var f=SoundGenerator.sounds[e];if(f.length>0){f=f[0];d=d+f.func(f.p++);f.p>=f.d&&SoundGenerator.removeSound(e,f.id)}}b[c]=d}};
SoundGenerator.play=function(){if(SoundGenerator.context&&SoundGenerator.node==null){SoundGenerator.node=SoundGenerator.context.createScriptProcessor?SoundGenerator.context.createScriptProcessor(4096,1,1):SoundGenerator.context.createJavaScriptNode(4096,1,1);SoundGenerator.node.onaudioprocess=SoundGenerator.onaudioprocess;SoundGenerator.node.connect(SoundGenerator.context.destination)}};
SoundGenerator.pause=function(){if(SoundGenerator.context){SoundGenerator.node.disconnect();SoundGenerator.node=null}};SoundGenerator.loadSound=function(b,c){b=""+b;SoundGenerator.midiSounds[b+c]=soundManager.createSound({id:b+c,url:"ide/midi/"+b+"/"+c+".mp3",multiShot:true,autoLoad:true})};SoundGenerator.loadInstrument=function(b){if(!SoundGenerator.midiInstruments[b]){SoundGenerator.midiInstruments[b]=AudioSynthPianoProgram;return false}return true};
SoundGenerator.playNote=function(b,c,d){if(!SoundGenerator.midiReplayer){SoundGenerator.midiSynth=Synth(44100);SoundGenerator.midiReplayer={generate:function(b){return SoundGenerator.midiSynth.generate(b)}};SoundGenerator.midiAudioPlayer=AudioPlayer(SoundGenerator.midiReplayer,{latency:0.1})}var e=PROGRAMS[b].createNote(c+21,127);SoundGenerator.midiSynth.addGenerator(e);setTimeout(function(){e.noteOff()},d*1E3)};
SoundGenerator.loadDrums=function(){if(!SoundGenerator.midiInstruments.drums){for(var b=27;b<88;b++)SoundGenerator.loadSound("drums",b);SoundGenerator.midiInstruments.drums="loading";return false}return SoundGenerator.drumsReady("drums")};SoundGenerator.drumsReady=function(){if(SoundGenerator.midiInstruments.drums=="ready")return true;for(var b=27;b<88;b++){var c=SoundGenerator.midiSounds["drums"+b];if(!c||!c.loaded)return false}SoundGenerator.midiInstruments.drums="ready";return true};
SoundGenerator.playDrum=function(b,c){var d=SoundGenerator.midiSounds["drums"+b];if(d){d.play();window.setTimeout(function(){d.stop()},c*1E3)}};
var MediaCapture={initialized:!1,supportsCapture:!1,audioStream:null,videoStream:null,audioNode:null,init:function(){if(!MediaCapture.initialized){window.URL=window.URL||window.webkitURL;window.AudioContext=window.AudioContext||window.webkitAudioContext;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;if(window.URL&&window.AudioContext&&navigator.getUserMedia)MediaCapture.supportsCapture=true;MediaCapture.initialized=
true}},_update:function(){if(MediaCapture.ctxSrc){try{MediaCapture.ctxSrc.drawImage(MediaCapture.videoEl,0,0,640,480,0,0,1364,768);MediaCapture._processMotion()}catch(b){}window.setTimeout(MediaCapture._update,videoUpdateInterval)}},_processMotion:function(){var b=MediaCapture.ctxSrc.canvas.width,c=MediaCapture.ctxSrc.canvas.height,d=MediaCapture.ctxSrc.getImageData(0,0,b,c);if(!MediaCapture.lastImageData)MediaCapture.lastImageData=MediaCapture.ctxSrc.getImageData(0,0,b,c);MediaCapture._computeDifference(MediaCapture.blendedData.data,
d.data,MediaCapture.lastImageData.data);MediaCapture.ctxBlended.putImageData(MediaCapture.blendedData,0,0);MediaCapture.lastImageData=d},_computeDifference:function(b,c,d){if(c.length!=d.length)return null;for(var e=0,f=c.length;e<f;){var g=d[e]+d[e+1]+d[e+2]-(c[e]+c[e+1]+c[e+2]),g=g>64?255:g<-64?255:0;b[e]=g;b[e+1]=g;b[e+2]=g;b[e+3]=255;e=e+4}},getBuffer:function(b,c,d,e){return MediaCapture.ctxBlended?MediaCapture.ctxBlended.getImageData(b,c,d,e):null},showVideo:function(b,c,d){MediaCapture.supportsCapture?
navigator.getUserMedia({video:true},function(e){MediaCapture.videoEl=b;b.src=window.URL.createObjectURL(e);MediaCapture.videoStream=e;if($("canvas#blended").length==0){var f=$('<canvas id="blended" style="display:none;position:absolute;bottom:0px;right:0px;width:128px;height:'+parseInt(c.height/c.width*128)+'px;" width="'+c.width+'" height="'+c.height+'"></canvas>');$("body").append(f);MediaCapture.ctxBlended=f[0].getContext("2d")}MediaCapture.ctxSrc=c.getContext("2d");MediaCapture.ctxSrc.restore();
MediaCapture.ctxSrc.save();if(!d){MediaCapture.ctxSrc.translate(c.width,0);MediaCapture.ctxSrc.scale(-1,1)}MediaCapture.blendedData=MediaCapture.ctxSrc.createImageData(MediaCapture.ctxSrc.canvas.width,MediaCapture.ctxSrc.canvas.height);MediaCapture._update();console.log("begin");console.log(b);console.log(e)},function(){console.log("failed")}):console.log("failed2")},hideVideo:function(){if(MediaCapture.supportsCapture&&MediaCapture.videoStream){for(var b=MediaCapture.videoStream.getTracks(),c=0;c<
b.length;c++)b[c].stop();MediaCapture.videoStream=null;MediaCapture.videoEl=null;MediaCapture.ctxSrc.clearRect(0,0,MediaCapture.ctxSrc.canvas.width,MediaCapture.ctxSrc.canvas.height);MediaCapture.ctxSrc=null;$("canvas#blended").detach();MediaCapture.ctxBlended=null}},startCaptureAudioLevel:function(){if(MediaCapture.audioStream){var b=MediaCapture.audioStream.getAudioTracks();if(b)for(var c=0;c<b.length;c++)b[c].stop();MediaCapture.audioStream=null}MediaCapture.audioNode=null;if(MediaCapture.supportsCapture){MediaCapture._beginCaptureAudioLevel=
true;var d=new AudioContext;navigator.getUserMedia({audio:true},function(b){var c=d.createMediaStreamSource(b);MediaCapture.audioStream=b;MediaCapture.audioNode=c.context.createScriptProcessor(4096,2,2);MediaCapture.audioNode.onaudioprocess=function(b){var c=b.inputBuffer.getChannelData(0),b=b.inputBuffer.getChannelData(1);MediaCapture._soundCaptureCallback(c,b)};c.connect(MediaCapture.audioNode);MediaCapture.audioNode.connect(c.context.destination)},function(){console.log("failed")})}},stopCaptureAudioLevel:function(){if(MediaCapture.supportsCapture&&
MediaCapture.audioNode&&MediaCapture.audioStream)for(var b=MediaCapture.audioStream.getAudioTracks(),c=0;c<b.length;c++)b[c].stop();MediaCapture.audioStream=null;MediaCapture._beginCaptureAudioLevel=false},isCapturingAudio:function(){return MediaCapture.audioStream!=null||MediaCapture._beginCaptureAudioLevel},_soundCaptureCallback:function(b,c){for(var d=0,e=0;e<b.length;e=e+16){var f=b[e],g=c[e];f<0?-f>d&&(d=-f):f>0&&f>d&&(d=f);g<0?-g>d&&(d=-g):g>0&&g>d&&(d=g)}MediaCapture._soundCaptureLevel=d>1?
1:d},getSoundLevel:function(){return MediaCapture.audioStream?MediaCapture._soundCaptureLevel:0}};$(document).ready(function(){MediaCapture.init()});
var ObjectIO={forceFullScreen:!1,serialize:function(){var b={description:window.IDE?window.IDE.currentProjectDescription:"",puzzleTitle:window.WinPuzzle?window.WinPuzzle.puzzleTitle:"",puzzleInstructions:window.WinPuzzle?window.WinPuzzle.puzzleInstructions:"",background:{},sprites:[],libs:[],variables:{},cloudVariables:{},varDefaults:{},lists:{},cloudLists:{},physics:{}};b.name=Runtime.levels&&Runtime.levels.length>0?Runtime.levels[Runtime.currentLevelIndex].name:window.IDE?window.IDE.currentProjectName:
"";if(window.IDE&&IDE.currentLessonOwnerId)b.lessonownerid=IDE.currentLessonOwnerId;for(var c in Runtime.background.variables)b.variables[c]=Runtime.background.variables[c];if(Runtime.background.cloudVariables)for(c in Runtime.background.cloudVariables)b.cloudVariables[c]=Runtime.background.cloudVariables[c];if(Runtime.background.varDefaults)for(c in Runtime.background.varDefaults)b.varDefaults[c]=Runtime.background.varDefaults[c];else for(c in Runtime.background.variables)b.varDefaults[c]=Runtime.background.variables[c];
for(c in Runtime.background.lists)b.lists[c]=Runtime.background.lists[c];if(Runtime.background.cloudLists)for(c in Runtime.background.cloudLists)b.cloudLists[c]=Runtime.background.cloudLists[c];b.background.scaleType=Runtime.stage.bgtype;b.background.width=Runtime.stage.width;b.background.height=Runtime.stage.height;b.background.canvasWidth=$(Runtime.stage.container).innerWidth();b.background.canvasHeight=$(Runtime.stage.container).innerHeight();b.background.canvasExpand=Runtime.stage.expand?true:
false;b.background.img=Runtime.background.imgSrc;b.background.currentBackground=Runtime.background.currentCostume;b.background.scripts=ObjectIO.serializeScripts(Runtime.background);var d=[];for(c=0;c<Runtime.background.costumes.length;c++)d.push({name:Runtime.background.costumes[c].name,img:Runtime.background.costumes[c].img,cx:Runtime.background.costumes[c].cx,cy:Runtime.background.costumes[c].cy});b.background.backgrounds=d;d=[];for(c=0;c<Runtime.background.sounds.length;c++)d.push({name:Runtime.background.sounds[c].name,
sound:Runtime.background.sounds[c].sound});b.background.sounds=d;if(Runtime.background.documentation)b.background.documentation=Runtime.background.documentation;for(d=0;d<Runtime.libs.length;d++)b.libs.push(Runtime.libs[d].classname);for(d=0;d<Runtime.sprites.length;d++){c=Runtime.sprites[d];if(!c.instantiated){c=ObjectIO.serializeSprite(c);b.sprites.push(c)}}b.physics.enabled=Physics.isSimulationRunning();b.physics.gravity={x:Physics.getWorld().GetGravity().x,y:Physics.getWorld().GetGravity().y};
if(Runtime.stage.tileLayer.enabled&&Runtime.stage.tileLayer.map&&Runtime.stage.tileLayer.map.length>0){b.scrollBgOffset=Runtime.stage.tileLayer.scrollBgOffset;b.tilesEnabled=Runtime.stage.tileLayer.enabled;for(var e=Runtime.stage.tileLayer.map,f=e[0].length,g=[],d=0;d<e.length;d++){var h=e[d],j=[];for(c=0;c<f;c++)h[c]?j.push(h[c]>>3|31):j.push(0);g.push(j)}b.tiles=g}return JSON.stringify(b)},serializeScripts:function(b,c){for(var d=[],e=0;e<b.scripts.length;e++){var f=b.scripts[e],g;if(f instanceof
Block){if(g=ObjectIO.genScriptObj(f,c)){g.x=f.x;g.y=f.y;d.push(g)}}else if(f instanceof Label)if(g=ObjectIO.genValueObj(f,c)){g.x=f.x;g.y=f.y;d.push(g)}}return d},deserializeScripts:function(b,c){for(var d=0;d<c.length;d++){var e=c[d],f=ObjectIO.deserializeScriptStep(e,b);if(f){f.x=e.x;f.y=e.y;if(f.func.substring(0,8)=="register"){if(f.func=="registerFunction")for(e=0;e<b.scripts.length;e++)if(b.scripts[e].func=="registerFunction"&&b.scripts[e].name==f.name){b.scripts.splice(e,1);break}e=new Script({sprite:b,
scriptBlock:f});e.currentBlock=e.scriptBlock;e.invokeStep()}b.scripts.push(f)}}},serializeSprite:function(b,c){var d=Physics.getSpriteProperties(b.spriteObj),d={label:b.label,scripts:[],costumes:[],currentCostume:b.currentCostume,sounds:[],scale:b.spriteObj.scale.x,x:b.spriteObj.x-Runtime.stage.getWidth()/2,y:-(b.spriteObj.y-Runtime.stage.getHeight()/2),rotation:b.spriteObj.rotation,rotateLock:b.spriteObj.rotateLock,draggable:b.spriteObj.draggable,hidden:b.hidden?true:false,isHidden:!b.spriteObj.visible,
volume:b.volume,locked:b.locked?true:false,hiddenInSandbox:b.hiddenInSandbox?true:false,lockedInSandbox:b.lockedInSandbox?true:false,zIndex:b.spriteObj.zIndex,penColor:b.spriteObj.penColor,fillColor:b.spriteObj.fillColor,font:b.spriteObj.font,fontColor:b.spriteObj.fontColor,penWidth:b.spriteObj.penWidth,bubble:b.spriteObj.bubble,physics:{isStatic:d.isStatic,isActive:d.isActive,geometry:d.geometry,density:d.density,friction:d.friction,restitution:d.restitution},variables:{},varDefaults:{},lists:{}};
if(b.classname)d.classname=b.classname;if(b.id)d.id=b.id;if(b.hidden)d.hidden=true;if(b.spriteObj.isStatic)d.isStatic=true;if(b.avatarid)d.avatarid=b.avatarid;if(b.skeleton.type&&b.skeleton.parts){d.skeletonType=b.skeleton.type;d.skeletonParts=b.skeleton.parts}if(b.documentation){d.documentation=b.documentation;if(d.documentation.inboundEvents)for(var e=0;e<d.documentation.inboundEvents.length;e++)d.documentation.inboundEvents[e]&&delete d.documentation.inboundEvents[e].blockImg;if(d.documentation.outboundEvents)for(e=
0;e<d.documentation.outboundEvents.length;e++)d.documentation.outboundEvents[e]&&delete d.documentation.outboundEvents[e].blockImg}for(var f in b.variables)d.variables[f]=b.variables[f];if(b.varDefaults)for(f in b.varDefaults)d.varDefaults[f]=b.varDefaults[f];else for(f in b.variables)d.varDefaults[f]=b.variables[f];for(f in b.lists)d.lists[f]=b.lists[f];d.scripts=ObjectIO.serializeScripts(b,c);for(e=0;e<b.costumes.length;e++){f={name:b.costumes[e].name,img:b.costumes[e].img,cx:b.costumes[e].cx,cy:b.costumes[e].cy};
if(b.locked&&b.costumes[e].hidden)f.hidden=true;d.costumes.push(f)}for(e=0;e<b.sounds.length;e++){f={hidden:b.sounds[e].hidden?true:false,name:b.sounds[e].name,sound:b.sounds[e].sound};if(b.locked&&b.sounds[e].hidden)f.hidden=true;d.sounds.push(f)}return d},genScriptObj:function(b,c){var d={func:b.func};if(b.hidden)d.hidden=true;if(b.locked)d.locked=true;if(b.hiddenInSandbox)d.hiddenInSandbox=true;if(b.lockedInSandbox)d.lockedInSandbox=true;if(!c&&b.id)d.id=b.id;if(b.marked){if(ObjectIO.omitMarked)return null;
d.marked=true}if(b.tags)d.tags=b.tags;if(b.func=="registerFunction"){d.cat="functions";d.name=b.name;d.label=b.labelText;d.hasFlap=false}else if(b.func=="blockControlCall"||b.func=="blockControlCallLibrary"){d.cat="functions";d.name=b.name;d.label=b.labelText}else if(b.func=="blockControlScriptVar"){d.cat="var";d.name=b.name;d.label=b.labelText}else if(b.func=="blockComment"){d.width=b.width;d.height=b.height;d.label=b.labelText}for(var e=[],f=b.label.getNumSockets(),g=0;g<f;g++)e.push(ObjectIO.genValueObj(b.label.getSocketAtChild(g),
c));d.values=e;for(var e=[],h=[],f=b.getNumContainers(),g=0;g<f;g++){var j=b.getBlockAtContainer(g);j?e.push(ObjectIO.genScriptObj(j,c)):e.push(null);if(g>0){j=ObjectIO.genValueObj(b._containerLabels[g-1],c);j.labelText=b._containerLabels[g-1].labelText;h.push(j)}}if(e.length>0)d.containers=e;if(h.length>0)d.containerLabels=h;if(b.next)d.next=ObjectIO.genScriptObj(b.next,c);return d},genValueObj:function(b,c){var d={};if(b instanceof Label){d.type="wrapper";d.func=b.func;if(!c&&b.id)d.id=b.id;if(b.hidden)d.hidden=
true;if(b.locked)d.locked=true;if(b.marked){if(ObjectIO.omitMarked)return null;d.marked=b.marked}if(b.tags)d.tags=b.tags;if(b.func=="valueControlCall"||b.func=="valueControlCallLibrary"){d.name=b.name;d.label=b.label}if(b.func=="valueVar"||b.func=="valueList"||b.func=="valueParam"||b.func=="valueScriptVar")d.name=b.name;else{for(var e=[],f=b.getNumSockets(),g=0;g<f;g++)e.push(ObjectIO.genValueObj(b.getSocketAtChild(g),c));d.values=e}}else{d.type=b.type=="number"?"number":b.type=="boolean"?"boolean":
b.type=="string"?"string":b.type=="any"?"any":b.type=="color"?"color":b.type=="choice"?"choice":"string";d.value=b.label;if(b.marked){if(ObjectIO.omitMarked)return null;d.marked=b.marked}if(b._child!=null){d=ObjectIO.genValueObj(b._child,c);if(b._child.hidden)d.text=b.label}}return d},deserialize:function(b,c){ObjectIO.loaded=1;var d=b;if(typeof b=="string"||b instanceof String)d=JSON.parse(b);if(window.IDE){IDE.reset();IDE._ignoreUpdates=true}Runtime.reset();Runtime.stage.enableDragging(true);if(window.IDE){IDE.setTitle(d.projectName?
d.projectName:"");IDE.currentProjectDescription=d.description?d.description:g_loc.getText("dialog.defaultprojdesc");WinPuzzle.puzzleTitle=d.puzzleTitle;WinPuzzle.puzzleInstructions=d.puzzleInstructions}if(d.background){Runtime.background.label=d.background.label?d.background.label:"Stage";Runtime.background.variables=d.background.variables?d.background.variables:{};Runtime.background.cloudVariables=d.background.cloudVariables?d.background.cloudVariables:{};Runtime.background.varDefaults=d.background.varDefaults?
d.background.varDefaults:{};Runtime.background.lists=d.background.lists?d.background.lists:{};Runtime.background.cloudLists=d.background.cloudLists?d.background.cloudLists:{};Runtime.stage.setBackgroundType(d.background.scaleType);if(!d.background.width)d.background.width=480;if(!d.background.height)d.background.height=360;if(!d.background.canvasWidth)d.background.canvasWidth=d.background.width;if(!d.background.canvasHeight)d.background.canvasHeight=d.background.height;Runtime.stage.expand=d.background.canvasExpand;
if(!window.IDE){var e=$("#stage-canvas");e.length>0&&e.css("width",Math.abs(d.background.width)).css("height",Math.abs(d.background.height))}Runtime.stage.setSize(Math.abs(d.background.width),Math.abs(d.background.height));for(var f=d.background.backgrounds,e=0;e<f.length;e++){var g=f[e];Runtime.background.addCostume({name:g.name,img:g.img},function(){d.background.currentBackground!=void 0&&Runtime.background.setCostumeByName(d.background.currentBackground)})}if(f=d.background.sounds)for(e=0;e<f.length;e++){g=
f[e];Runtime.background.addSound({name:g.name,sound:g.sound})}ObjectIO.deserializeScripts(Runtime.background,d.background.scripts);if(d.variables)for(var h in d.variables)Runtime.background.variables[h]=d.variables[h];if(d.varDefaults)for(h in d.varDefaults)Runtime.background.varDefaults[h]=d.varDefaults[h];if(d.cloudVariables)for(h in d.cloudVariables)Runtime.background.cloudVariables[h]=d.cloudVariables[h];if(d.lists)for(h in d.lists)Runtime.background.lists[h]=d.lists[h];if(d.cloudLists)for(h in d.cloudLists)Runtime.background.cloudLists[h]=
d.cloudLists[h];if(d.background.documentation)Runtime.background.documentation=d.background.documentation}if(d.libs)for(e=0;e<d.libs.length;e++){ObjectIO.loaded++;Runtime.requireLibrary(d.libs[e],function(){ObjectIO.doCallback(c,d);window.WinTools&&window.WinTools.reset()})}h=d.sprites;for(e=0;e<h.length;e++){f=h[e];if(f.zIndex===void 0)f.zIndex=e;ObjectIO.deserializeSprite(f,function(){ObjectIO.doCallback(c,d)})}if(d.physics){Physics.getWorld().SetGravity(new b2Vec2(d.physics.gravity.x,d.physics.gravity.y));
Runtime.isScratch=false}else Runtime.isScratch=true;if(d.watchers)for(e=0;e<d.watchers.length;e++){h=d.watchers[e];if(h.visible){(f=h.target)||(f="Stage");if(h.func){Runtime.addWatcher(f,g_steps[h.func],h.x-Runtime.stage.getWidth()/2,Runtime.stage.getHeight()/2-h.y,0.5);ObjectIO.doCallback(c,d)}else if(h.name){Runtime.addWatcher(f,h.name,h.x-Runtime.stage.getWidth()/2,Runtime.stage.getHeight()/2-h.y,0.5);ObjectIO.doCallback(c,d)}}}if(d.tiles){Runtime.stage.tileLayer.setup();Runtime.stage.tileLayer.scrollBgOffset=
d.scrollBgOffset?true:false;Runtime.stage.tileLayer.enableTiles(d.tilesEnabled);h=d.tiles;f=h[0].length;g=[];for(e=0;e<h.length;e++){for(var j=h[e],k=[],l=0;l<f;l++)j[l]&31?k.push((j[l]<<3|255)&4294967295):k.push(0);g.push(k)}d.tiles=g;Runtime.stage.tileLayer.loadMap(d.tiles)}else Runtime.stage.tileLayer.setup();if(d.levels){Runtime.levels=d.levels;Runtime.currentLevelIndex=parseInt(d.currentLevel)}else{Runtime.levels=[{name:d.name,screenshotid:""}];Runtime.currentLevelIndex=0}Runtime.cleanup();ObjectIO.doCallback(c,
d)},doCallback:function(b,c){ObjectIO.loaded--;if(ObjectIO.loaded<=0){if(window.IDE)IDE._ignoreUpdates=false;b&&b(c)}},loadSprite:function(b,c){$.ajax({url:b,dataType:"json",success:function(b){ObjectIO.deserializeSprite(b,function(b){c&&c(b)},false)}})},serializeLibrary:function(b){var c={label:b.label,scripts:[],variables:{},varDefaults:{},lists:{}},d;for(d in b.variables)c.variables[d]=b.variables[d];if(b.varDefaults)for(d in b.varDefaults)c.varDefaults[d]=b.varDefaults[d];else for(d in b.variables)c.varDefaults[d]=
b.variables[d];for(d in b.lists)c.lists[d]=b.lists[d];c.scripts=ObjectIO.serializeScripts(b);return c},deserializeLibrary:function(b,c){var d=new Sprite({label:b.label,classname:b.label,isHidden:true});if(b.classname)d.classname=b.classname;if(b.description)d.description=b.description;if(b.dbid)d.dbid=b.dbid;if(b.ownerid)d.ownerid=b.ownerid;if(b.variables)for(var e in b.variables)if(e!="_empty_"){d.variables[e]=b.variables[e];b.varDefaults&&b.varDefaults[e]!==void 0&&(d.varDefaults[e]=b.varDefaults[e])}if(b.lists)for(e in b.lists)e!=
"_empty_"&&(d.lists[e]=d.lists[e]);ObjectIO.deserializeScripts(d,b.scripts,true);for(e=0;e<d.scripts.length;e++)d.scripts[e].library=d;c&&c(d);return d},deserializeSprite:function(b,c,d){ObjectIO.loaded++;var e={};if(b.varDefaults)e=b.varDefaults;else if(b.variables)for(var f in b.variables)e[f]=b.variables[f];e=b.costumes[0].img;e.indexOf("http:")===0&&window.location.protocol!="http:"?e=window.location.protocol+e.substring(5):e.indexOf("https:")===0&&window.location.protocol!="https:"&&(e=window.location.protocol+
e.substring(6));d=Sprites.addSprite({label:b.label,scale:b.scale,x:b.x,y:b.y,rotation:b.rotation,rotateLock:b.rotateLock,draggable:b.draggable,hidden:b.hidden?true:false,isHidden:b.isHidden?true:false,costumeName:b.costumes[0].name,cx:b.costumes[0].cx,cy:b.costumes[0].cy,img:e,volume:b.volume,variables:b.variables,varDefaults:b.varDefaults,lists:b.lists,forceNumber:d?true:false,locked:b.locked?true:false,hiddenInSandbox:b.hiddenInSandbox?true:false,lockedInSandbox:b.lockedInSandbox?true:false,id:b.id,
classname:b.classname,zIndex:b.zIndex,penColor:b.penColor,fillColor:b.fillColor,font:b.font,fontColor:b.fontColor,penWidth:b.penWidth,bubble:b.bubble,avatarid:b.avatarid,skeletonType:b.skeletonType,skeletonParts:b.skeletonParts},function(d){if(b.isStatic)d.spriteObj.isStatic=true;d.spriteObj.physicsBody&&b.physics&&Physics.updateBody(d.spriteObj,{isStatic:b.physics.isStatic!==void 0?b.physics.isStatic:false,isActive:b.physics.isActive!==void 0?b.physics.isActive:true,geometry:b.physics.geometry,density:b.physics.density,
friction:b.physics.friction,restitution:b.physics.restitution});if(b.variables)for(var e in b.variables)if(e!="_empty_"){d.variables[e]=b.variables[e];b.varDefaults&&b.varDefaults[e]!==void 0&&(d.varDefaults[e]=b.varDefaults[e])}if(b.lists)for(e in b.lists)e!="_empty_"&&(d.lists[e]=b.lists[e]);e=b.costumes;for(var f=1;f<e.length;f++){var g=e[f],m=g.img;m.indexOf("http:")===0&&window.location.protocol!="http:"?m=window.location.protocol+m.substring(5):m.indexOf("https:")===0&&window.location.protocol!=
"https:"&&(m=window.location.protocol+m.substring(6));d.addCostume({hidden:g.hidden?true:false,name:g.name,img:m,cx:g.cx,cy:g.cy})}b.currentCostume&&d.setCostumeByName(b.currentCostume);b.zIndex&&d.spriteObj.setZIndex(b.zIndex);c&&c(d)});if(b.avatarid)d.avatarid=b.avatarid;if(b.hidden)d.hidden=true;e=b.sounds;for(f=0;f<e.length;f++){var g=e[f];d.addSound({hidden:g.hidden?true:false,name:g.name,sound:g.sound})}if(b.documentation)d.documentation=b.documentation;f=false;if(d.id&&d.classname&&!d.locked)for(e=
0;e<Runtime.sprites.length;e++){g=Runtime.sprites[e];if(g!=d&&g.id==d.id&&g.classname==d.classname){d.scripts=g.scripts;f=true;break}}if(f)for(e=0;e<d.scripts.length;e++){f=d.scripts[e];if(f.func.substring(0,8)=="register"){f=new Script({sprite:d,scriptBlock:f});f.currentBlock=f.scriptBlock;f.invokeStep()}}else ObjectIO.deserializeScripts(d,b.scripts,b.locked);return d},deserializeScriptSocket:function(b){var c=null;if(b.type=="wrapper"){var d;if(d=b.func=="valueControlCall"?new Label({cat:b.cat?
b.cat:"functions",name:b.name,label:b.label,marked:b.marked,value:"string",func:b.func}):b.func=="valueControlCallLibrary"?new Label({cat:"library",name:b.name,label:b.label,marked:b.marked,value:"string",func:b.func}):findStepByFunc(b.func)){if(b.label)d.label=b.label;c=new Label(d);if(b.hidden){c.hidden=true;c.text=b.text}c.marked=b.marked;if(b.tags)c.tags=b.tags;if(b.id)c.id=b.id;if(b.values){c.ensureSockets(b.values.length);for(d=0;d<b.values.length;d++){var e=ObjectIO.deserializeScriptSocket(b.values[d]);
c.setValue(d,e)}}}else if(b.name){c=void 0;b.cat||(b.func=="valueVar"?c="var":b.func=="valueList"?c="list":b.func=="valueParam"?c="functions":b.func=="valueScriptVar"&&(c="localvar"));c=new Label({cat:c,name:b.name,marked:b.marked,value:"number",func:b.func});if(b.id)c.id=b.id}if(b.hidden)c.hidden=true;if(b.locked)c.locked=true;if(b.note)c.note=b.note}else c=b.value;return c},deserializeScriptStep:function(b){var c=null,d=null;if(b.func=="registerFunction"||b.func=="blockControlCall"){d=b;if(!d.cat)d.cat=
"functions"}else if(b.func=="blockControlCallLibrary"){d=b;d.cat="library"}else if(b.func=="blockControlScriptVar"){d=b;d.cat="obj";if(!d.label){var e=findStepByFunc(d.func);if(e)d.label=e.label}}else{if(b.func=="valueControlCall"||b.func=="valueControlCallLibrary"||b.func=="valueVar"||b.func=="valueList"||b.func=="valueParam"||b.func=="valueScriptVar"){c=ObjectIO.deserializeScriptSocket(b);c.hiddenInSandbox=b.hiddenInSandbox;c.lockedInSandbox=b.lockedInSandbox;return c}d=b?findStepByFunc(b.func):
null;if(b.label)d.label=b.label}if(d){if(d.value){c=new Label(d);delete c.hidden;c.marked=b.marked;if(b.tags)c.tags=b.tags;if(b.id)c.id=b.id;if(b.values){c.ensureSockets(b.values.length);for(d=0;d<b.values.length;d++){e=ObjectIO.deserializeScriptSocket(b.values[d]);c.setValue(d,e)}}}else{c=new Block(d);delete c.hidden;c.marked=b.marked;if(b.tags)c.tags=b.tags;if(b.id)c.id=b.id;if(d.func=="blockComment"){c.width=b.width;c.height=b.height;c.labelText=b.label}if(b.values){c.label.ensureSockets(b.values.length);
for(d=0;d<b.values.length;d++){e=ObjectIO.deserializeScriptSocket(b.values[d]);c.label.setValue(d,e)}}if(b.containers)for(d=0;d<b.containers.length;d++){if(d>0&&b.containerLabels){for(var e=[],f=0;f<b.containerLabels[d-1].values.length;f++)e.push(ObjectIO.deserializeScriptSocket(b.containerLabels[d-1].values[f]));d<b.containers.length-1?textLabel=window.RenderCode?RenderCode.getElseIfLabel():"else if {boolean} then {button:remove}":d<b.containers.length&&(textLabel=window.RenderCode?RenderCode.getElseLabel():
"else {button:add}");var g=new Label({label:textLabel});g.parent=c;g.draggable=false;for(f=0;f<e.length;f++)g.setValue(f,e[f]);d-1>=c._containerLabels.length&&c._containerLabels.push(null);c._containerLabels[d-1]=g}d>=c._containers.length&&c._containers.push(null);if(b.containers[d]){e=ObjectIO.deserializeScriptStep(b.containers[d]);if(e!=null){c.addToContainer(d,e);e.parent=c}}}if(b.next){c.next=ObjectIO.deserializeScriptStep(b.next);if(c.next)c.next.parent=c}}c.hiddenInSandbox=b.hiddenInSandbox;
c.lockedInSandbox=b.lockedInSandbox;if(b.hidden)c.hidden=true;if(b.locked)c.locked=true;if(b.note)c.note=b.note}return c},serializeLesson:function(){var b={width:Runtime.stage.width,height:Runtime.stage.height,bgtype:Runtime.stage.bgtype,canvasWidth:$(Runtime.stage.container).innerWidth(),canvasHeight:$(Runtime.stage.container).innerHeight()};if(window.WinLessons){var c=WinLessons.getDetails();b.name=c.name;b.description=c.description;b.showPlayer=c.showPlayer;b.instructions=c.instructions;c=WinLessons.getNotes();
b.resources=c.resources;b.globalVars=c.globalVars;b.blocks=c.blocks;b.initialState=c.initialState;b.notes=c.notes}return b},deserializeLesson:function(b){$("#wincmd-runlesson").addClass("disabled");if(window.WinLessons&&b&&b.notes){window.IDE&&WinLessons.reset();IDE.currentProjectDetails=b.details?b.details:"";IDE.currentProjectConcepts=b.concepts?b.concepts:"";WinLessons.setDetails({ownerid:b.ownerid,name:b.name,description:b.description,showPlayer:b.showPlayer,instructions:b.instructions});WinLessons.setNotes(b);
if(window.IDE){if(!b.canvasWidth)b.canvasWidth=600;if(!b.canvasHeight)b.canvasHeight=400;b.bgtype&&Runtime.stage.setBackgroundType(b.bgtype);b.width&&b.height&&Runtime.stage.setSize(Math.abs(b.width),Math.abs(b.height));IDE.adjustPanels()}}}},g_choice_lists={keys:"up arrow;down arrow;left arrow;right arrow;space;return;mouse;mouse-right;any".split(";").concat("abcdefghijklmnopqrstuvwxyz0123456789".split("")),videosensetype:["motion","direction"],videoviewtype:["on","off","on-flipped"],events:["loudness",
"timer","video motion"],geometry:["circular","rectangular"],rotatestyle:["all around","left-right","don't rotate"],stageproperty:"width;height;left;right;top;bottom;viewport offset x;viewport offset y;world width;world height;design width;design height;closest actor;furthest actor;number of actors;last key pressed".split(";"),stop:["all","this script","other scripts in actor","function call chain"],lastany:["1","last","any"],lastall:["1","last","all"],operator:"+ - * / % mod == < <= > >= != & | && and || or ^ xor << >> >>>".split(" "),
texttransform:["lowercase","uppercase","trim","parse"],bubblestyle:["rectangular","rounded","oval","thought","excited"],bubbledock:["default","top","dialog"],effect:"color fisheye whirl pixelate mosaic brightness ghost blur brightness bump circlesmear contrast crosssmear diffusion dither edge emboss exposure gain gamma grayscale hue invert kaleidoscope lensdistortion linesmear maximum median minimum noise oil opacity pinch pixelate posterize rgbadjust saturation sawtoothripple sepia sharpen sineripple solarize sparkle squaresmear threshold triangleripple twirl vignette waterripple".split(" "),
drums:"35 Acoustic Bass Drum;36 Bass Drum 1;37 Side Stick;38 Acoustic Snare;39 Hand Clap;40 Electric Snare;41 Low Floor Tom;42 Closed Hi Hat;43 High Floor Tom;44 Pedal Hi-Hat;45 Low Tom;46 Open Hi-Hat;47 Low-Mid Tom;48 Hi-Mid Tom;49 Crash Cymbal 1;50 High Tom;51 Ride Cymbal 1;52 Chinese Cymbal;53 Ride Bell;54 Tambourine;55 Splash Cymbal;56 Cowbell;57 Crash Cymbal 2;58 Vibraslap;59 Ride Cymbal 2;60 Hi Bongo;61 Low Bongo;62 Mute Hi Conga;63 Open Hi Conga;64 Low Conga;65 High Timbale;66 Low Timbale;67 High Agogo;68 Low Agogo;69 Cabasa;70 Maracas;71 Short Whistle;72 Long Whistle;73 Short Guiro;74 Long Guiro;75 Claves;76 Hi Wood Block;77 Low Wood Block;78 Mute Cuica;79 Open Cuica;80 Mute Triangle;81 Open Triangle".split(";"),
instruments:"1 Acoustic Grand Piano;2 Bright Acoustic Piano;4 Honky-tonk Piano;5 Electric Piano 1;6 Electric Piano 2;17 Drawbar Organ;18 Percussive Organ;19 Rock Organ;20 Church Organ;21 Reed Organ;25 Acoustic Guitar (nylon);27 Electric Guitar (jazz);43 Cello;74 Flute;90 Pad 1 (new age);91 Pad 3 (polysynth);92 Pad 4 (choir);93 Pad 5 (bowed);94 Pad 6 (metallic);113 Tinkle Bell;115 Steel Drums;116 Woodblock;119 Synth Drum".split(";"),permissions:["local","user","project"],spriteprop:"x position;y position;angle;direction;layer;rotation style;label;say;costume #;costume name;size;volume;width;height;density;friction;restitution;angular velocity;angular damping;linear damping;x linear velocity;y linear velocity".split(";"),
datetime:"year;month;day;hours;minutes;seconds;milliseconds;unix time;text".split(";"),math:"abs floor ceiling round int sqrt sin sinrad cos cosrad tan tanrad asin asinrad acos acosrad atan atanrad ln log e^ 10^ sign".split(" "),math2:["atan2","atan2rad","max","min","pow"],mathunary:["!","~","+","-"],mathbinary:"* / % + - << >> >>> < <= > >= == != & | ^ && ||".split(" "),constants:"pi e ln2 ln10 log2e log10e sqrt1/2 sqrt2".split(" "),fontstyle:["normal","bold","italic","italic bold"],fontsize:"8 9 10 11 12 14 16 18 20 22 24 26 28 36 48 72 96 120".split(" "),
font:"Arial,Helvetica,sans-serif;Arial Black,Gadget,sans-serif;Comic Sans MS,cursive;Courier New,Courier New,monospace;Impact,Charcoal,sans-serif;Lucida Console,Monaco,monospace;Lucida Sans Unice,Lucida Grande,sans-serif;Tahoma,Geneva,sans-serif;Times New Roman,Times,serif;Trebuchet MS,sans-serif;Verdana,Geneva,sans-serif".split(";"),getphysics:"density;friction;restitution;angular velocity;angular damping;inertia;is active;is awake;linear damping;x linear velocity;y linear velocity;x gravity;y gravity;last collided with;last collision x;last collision y;last actor collided with;last actor collision x;last actor collision y".split(";"),
setphysics:"force;impulse;torque;density;friction;restitution;angular damping;angular velocity;linear damping;linear velocity".split(";"),setphysicsxy:["force","impulse","linear velocity","gravity"],easing:"easeLinear easeInQuad easeOutQuad easeInOutQuad easeInCubic easeOutCubic easeInOutCubic easeInQuart easeOutQuart easeInOutQuart easeInQuint easeOutQuint easeInOutQuint easeInSine easeOutSine easeInOutSine easeInExponential easeOutExponential easeInOutExponential easeInCirc easeOutCirc easeInOutCirc easeInElastic easeOutElastic easeInOutElastic easeBackIn easeBackOut easeBackInOut easeBounceIn easeBounceOut easeBounceInOut".split(" "),
particleimg:"none;fire;line;smoke;snow;snowflake;starburst;circle;hexagon;rectangle;star;filled circle;filled hexagon;filled rectangle;filled star".split(";"),droneanimations:["flip forward","flip backward","flip left","flip right"],jumpingsumojumps:["long","high"],jumpingsumoanimations:"stop;spin;tap;slow shake;metronome;wave;spin jump;spin to posture;spiral;slalom".split(";"),jumpingsumopositions:["balancing","ready to jump","ready to kick"],jumpingsumoaudiothemes:["default","robot","insect","monster"],
spheroprop:"accelerometer x;accelerometer y;accelerometer z;pitch;roll;yaw;location x;location y;velocity x;velocity y;quaternion 0;quaternion 1;quaternion 2;quaternion 3;gyro x;gyro y;gyro z".split(";"),spherosetnumericprop:["collision threshold - x","collision threshold - x speed","collision threshold - y","collision threshold - y speed","collision interval"],grabbercmd:["open","close"],flyingmode:["quadcopter","plane forward","plane backward"],planespeed:["low","medium","high"],wedo2tiltsensormode:["angle",
"direction","bump"],wedo2tiltsensorangle:["x","y"],wedo2tiltbumpdirection:["x","y","z"],wedo2resettablesensor:["tilt sensor","motion sensor"],wedo2motionsensormode:["distance","count"],wedo2motordirection:["clockwise","counter clockwise"],wedo2sensorormotor:["tilt sensor","motion sensor","motor"]},g_steps={registerFlagTrigger:{cat:"events",label:"on start",hasFlap:!1,func:"registerFlagTrigger",readName:"On Start",concept:"simple events",tags:"hat block;event;start;begin;program;play".split(";")},
registerKeyTrigger:{cat:"events",label:"when {choice:keys} pressed",hasFlap:!1,func:"registerKeyTrigger",readName:"When Key Pressed",concept:"simple events",tags:"hat block;keyboard;key press;arrow keys;keypress;when key pressed".split(";")},registerTrigger:{cat:"events",label:"when {boolean} occurs",hasFlap:!1,func:"registerTrigger",readName:"When Condition Occurs",concept:"advanced events",tags:"hat block;event;start;begin;program;trigger".split(";")},registerSpriteTrigger:{cat:"events",label:"when actor clicked",
hasFlap:!1,func:"registerSpriteTrigger",readName:"When Actor Clicked",concept:"simple events",tags:["click actor","touch actor","press actor","mouse click"]},registerBackgroundChange:{cat:"events",label:"when background switches to {scenes}",hasFlap:!1,func:"registerBackgroundChange",readName:"When Scene Switches",concept:"simple events",tags:["background","backdrop","scene","change","scene change"]},registerExternalTrigger:{cat:"events",hidden:!0,label:"when {choice:events} >{number}",hasFlap:!1,
func:"registerExternalTrigger",readName:"When Condition",concept:"external events",tags:"change sound audio video event trigger".split(" ")},blockControlBroadcast:{cat:"events",label:"broadcast {events}",func:"blockControlBroadcast",readName:"Broadcast",concept:"simple messaging",tags:["send event","send messages","tell","signal"]},blockControlBroadcastWait:{cat:"events",label:"broadcast {events} and wait",func:"blockControlBroadcastWait",readName:"Broadcast And Wait",concept:"advanced messaging",
tags:["send","messages","event","signal","wait till done"]},blockControlPostMessage:{cat:"events",label:"send message {events} to {actor} with {string}",func:"blockControlPostMessage",readName:"Send Message To Actor",concept:"advanced messaging",tags:"send;messages;event;signal;wait;pass value;value;parameter".split(";")},blockControlPostMessageAndWait:{cat:"events",label:"send message {events} to {actor} with {string} and wait",func:"blockControlPostMessageAndWait",readName:"Send Message To Actor And Wait",
concept:"advanced messaging",tags:"send;messages;event;signal;wait;pass value;value;parameter".split(";")},valueControlMessageValue:{cat:"events",label:"received value",value:"string",func:"valueControlMessageValue",readName:"Received Value",concept:"advanced messaging",tags:["value","messages"]},valueControlMessageSource:{cat:"events",label:"received source",value:"string",func:"valueControlMessageSource",readName:"Received Source",concept:"advanced messaging",tags:["value","messages"]},registerBroadcastTrigger:{cat:"events",
label:"when I receive {events}",hasFlap:!1,func:"registerBroadcastTrigger",readName:"When I Receive",concept:"simple messaging",tags:["hat block","messaging","message","receive"]},registerCloned:{cat:"events",omitbg:!0,label:"clone startup",hasFlap:!1,func:"registerCloned",readName:"Clone Startup",concept:"cloning",tags:["hat block","cloning","copy actor","duplicate"]},valueControlIsClone:{cat:"flow",label:"is clone?",value:"boolean",func:"valueControlIsClone",readName:"Is Clone?",concept:"cloning",
tags:["cloning","value"]},registerFunction:{cat:"functions",label:"",func:"registerFunction",hasFlap:!1,readName:"Function Definition",concept:"functions",tags:["functions","objects"]},blockControlCall:{cat:"functions",label:"",func:"blockControlCall",readName:"Function Call",concept:"functions",tags:["functions","objects"]},valueControlCall:{cat:"functions",label:"",func:"valueControlCall",readName:"Function Value",value:"string",concept:"functions",tags:["functions","objects"]},blockControlCallLibrary:{cat:"library",
label:"",func:"blockControlCallLibrary",readName:"Library Function Call",concept:"functions",tags:["functions","objects","library"]},valueControlCallLibrary:{cat:"library",label:"",value:"string",func:"valueControlCallLibrary",readName:"Library Function Value",concept:"functions",tags:["functions","objects","library"]},blockControlCallMember:{cat:"functions",label:"{actor} . {method}({varargs})",func:"blockControlCallMember",readName:"Member Function Call",concept:"functions",tags:["functions","objects"]},
valueControlCallMember:{cat:"functions",label:"{actor} . {method}({varargs})",value:"string",func:"valueControlCallMember",readName:"Member Function Value",concept:"functions",tags:["functions","objects"]},blockControlWait:{cat:"flow",label:"wait {number:1} secs",func:"blockControlWait",readName:"Wait",concept:"delays",tags:["wait","delay","blocked"]},blockControlForever:{cat:"flow",label:"forever",containers:1,hasSlot:!1,func:"blockControlForever",readName:"Forever",concept:"simple loops",tags:["loop",
"endless","repetition","again"]},blockControlRepeat:{cat:"flow",label:"repeat {number:10}",containers:1,func:"blockControlRepeat",readName:"Repeat",concept:"simple loops",tags:["loop","finite loop","repitition"]},blockControlCloneActor:{cat:"flow",label:"create clone of {actor}",func:"blockControlCloneActor",readName:"Create Clone Of",concept:"cloning",tags:["make copy","cloning","duplicate"]},valueControlLastClonedActor:{cat:"flow",label:"name of last created actor",value:"string",func:"valueControlLastClonedActor",
readName:"Name Of Last Cloned Actor",concept:"cloning",tags:["cloning","value"]},valueControlCloneName:{cat:"flow",label:"clone name of actor {string}",value:"string",func:"valueControlCloneName",readName:"Clone Name Of Actor",concept:"cloning",tags:["cloning","value"]},blockControlDeleteActor:{cat:"flow",omitbg:!0,label:"delete this clone",hasSlot:!1,func:"blockControlDeleteActor",readName:"Delete This Clone",concept:"cloning",tags:["cloning","delete"]},blockControlForeverIf:{cat:"flow",label:"forever if {boolean}",
containers:1,hasSlot:!1,func:"blockControlForeverIf",readName:"Forever If",concept:"conditional loops",tags:["loop","conditional","if"]},blockControlIf:{cat:"flow",label:"if {boolean} then",containers:1,func:"blockControlIf",readName:"If Then",concept:"simple conditionals",tags:["contition","if","logic"]},blockControlIfElse:{cat:"flow",label:"if {boolean} then",containers:2,containerLabels:["else {button:add}"],func:"blockControlIfElse",readName:"If Then Else",concept:"simple conditionals",tags:["if else",
"else","logic","conditional"]},valueControlIfElse:{cat:"flow",label:"if {boolean} then {string} else {string}",value:"string",func:"valueControlIfElse",readName:"If Then Else",concept:"conditionals",tags:["if else","else","logic","conditional"]},blockControlWaitUntil:{cat:"flow",label:"wait until {boolean}",func:"blockControlWaitUntil",readName:"Wait Until",concept:"conditional wait",tags:["loop","repetition","if condition"]},blockControlWhile:{cat:"flow",label:"repeat while {boolean}",containers:1,
func:"blockControlWhile",readName:"Repeat While",concept:"conditional loops",tags:["loop","repetition","while condition"]},blockControlRepeatUntil:{cat:"flow",label:"repeat until {boolean}",containers:1,func:"blockControlRepeatUntil",readName:"Repeat Until",concept:"conditional loops",tags:["loop","repetition","until condition"]},blockControlReturn:{cat:"functions",label:"return {string}",hasSlot:!1,func:"blockControlReturn",readName:"Return",concept:"functions",tags:["stop","end","finish","done",
"return"]},blockControlStop:{cat:"flow",label:"stop {choice:stop}",hasSlot:!1,func:"blockControlStop",readName:"Stop",concept:"program control",tags:["stop","end","finish","done"]},blockControlStopScript:{cat:"flow",hidden:!0,label:"stop script",hasSlot:!1,func:"blockControlStopScript",readName:"Stop Script",concept:"program control",tags:["stop","end","finish","done"]},blockControlStopAll:{cat:"flow",hidden:!0,label:"stop all",hasSlot:!1,func:"blockControlStopAll",readName:"Stop All",concept:"program control",
tags:["stop all","finish","done"]},blockControlScriptVar:{cat:"localvar",label:"script variables {varargs:valueScriptVar}",func:"blockControlScriptVar",readName:"Script Variables",concept:"simple variables",tags:["variable","variables"]},blockControlFor:{cat:"flow",label:"for {variables} from {number:0} to {number:10} step by {number:1}",func:"blockControlFor",containers:1,readName:"For",concept:"advanced loops",tags:["loop"]},blockControlForEach:{cat:"flow",label:"for each {string} as {variables}",
func:"blockControlForEach",readName:"For In",containers:1,concept:"advanced loops",tags:["loop"]},blockControlBreak:{cat:"flow",label:"break",func:"blockControlBreak",hasSlot:!1,readName:"Break",concept:"advanced loops",tags:["loop","break"]},blockControlContinue:{cat:"flow",label:"continue",func:"blockControlContinue",hasSlot:!1,readName:"Continue",concept:"advanced loops",tags:["loop","continue"]},blockControlRequestBlocking:{cat:"flow",hidden:!1,label:"do until done",containers:1,func:"blockControlRequestBlocking",
readName:"Block",concept:"advanced control",tags:["control"]},blockControlPrint:{cat:"flow",label:"print {string} {varargs}",func:"blockControlPrint",readName:"Print",concept:"advanced control",tags:["control"]},blockControlJS:{cat:"flow",hidden:!0,label:"JS: {string}",func:"blockControlJS",readName:"JS",concept:"advanced control",tags:["control"]},valueControlJS:{cat:"flow",hidden:!0,label:"JS: {string}",func:"valueControlJS",value:"string",readName:"JS",concept:"advanced control",tags:["control"]},
valueControlLanguage:{cat:"flow",label:"text ID {string} with {varargs}",func:"valueControlLanguage",value:"string",readName:"Language Format",concept:"advanced control",tags:["control"]},valueControlLanguageWithDefault:{cat:"flow",label:"text ID {string} ({string}) with {varargs}",func:"valueControlLanguageWithDefault",value:"string",readName:"Language Format",concept:"advanced control",tags:["control"]},valueControlSerializeActor:{cat:"control",hidden:!0,label:"get data from actor {actor}",func:"valueControlSerializeActor",
value:"string",readName:"serialize actor",concept:"actor serialization",tags:["advanced","serialization"]},blockControlDeserializeActor:{cat:"control",hidden:!0,label:"create actor with {string} named {string}",func:"blockControlDeserializeActor",readName:"deserialize actor",concept:"actor serialization",tags:["advanced","serialization"]},blockControlRemoveActor:{cat:"control",hidden:!0,label:"remove actor {actor}",func:"blockControlRemoveActor",readName:"remove actor",concept:"actor serialization",
tags:["advanced","serialization"]},valueControlSerializeScripts:{cat:"control",hidden:!0,label:"get scripts from actor {actor} tagged with {string}",func:"valueControlSerializeScripts",value:"string",readName:"serialize scripts",concept:"script serialization",tags:["advanced","serialization"]},blockControlDeserializeScripts:{cat:"control",hidden:!0,label:"add scripts with {string} into actor {actor}",func:"blockControlDeserializeScripts",readName:"serialize scripts",concept:"actor serialization",
tags:["advanced","serialization"]},blockControlRemoveScriptsWithTag:{cat:"control",hidden:!0,label:"remove scripts tagged {string} on actor {actor}",func:"blockControlRemoveScriptsWithTag",readName:"remove scripts",concept:"actor serialization",tags:["advanced","serialization"]},blockComment:{cat:"comment",hidden:!1,hasFlap:!1,hasSlot:!1,label:"{string:message}",func:"blockComment",readName:"Comment",concept:"miscellaneous"},blockInlineComment:{cat:"comment",label:"//{string:comment}",func:"blockInlineComment",
readName:"Inline Comment",concept:"miscellaneous"},blockSystem:{cat:"system",label:"IDE {choice:systemEvents} with {string}",func:"blockSystem",readName:"System",concept:"miscellaneous",tags:[]},blockControlDebugBreak:{cat:"flow",label:"breakpoint",func:"blockControlDebugBreak",readName:"Break",concept:"debugging",tags:["break","debugging"]},blockControlDebugBreakOn:{cat:"flow",label:"breakpoint when {boolean}",func:"blockControlDebugBreakOn",readName:"Break When",concept:"debugging",tags:["break",
"debugging"]},nop:{cat:"flow",hidden:!0,label:"nop",func:"nop",readName:"No Operation",concept:"miscellaneous"},blockMotionMove:{cat:"motion",omitbg:!0,label:"move {number:10} pixels",func:"blockMotionMove",readName:"Move Steps",concept:"simple motion",tags:["movement","push","nudge","walk","run"]},blockMotionTurnCW:{cat:"motion",omitbg:!0,label:"turn {image:ide/imgs/button-cw.png} {angle:15} degrees",func:"blockMotionTurnCW",readName:"Turn Clockwise",concept:"direction and turning",tags:["rotation",
"rotate","turning","clockwise"]},blockMotionTurnCCW:{cat:"motion",omitbg:!0,label:"turn {image:ide/imgs/button-ccw.png} {angle:15} degrees",func:"blockMotionTurnCCW",readName:"Turn Counter-Clockwise",concept:"direction and turning",tags:["rotation","rotate","turning","counter clockwise"]},blockMotionPointDirection:{cat:"motion",omitbg:!0,label:"point in direction {angle:90} degrees",func:"blockMotionPointDirection",readName:"Point In Direction",concept:"direction and turning",tags:["see","angle",
"direction"]},blockMotionPointAngle:{cat:"motion",omitbg:!0,label:"set angle to {mathangle:0} degrees",func:"blockMotionPointAngle",readName:"Point In Direction",concept:"direction and turning",tags:["see","angle","direction"]},blockMotionPointTowards:{cat:"motion",omitbg:!0,label:"point towards {where}",func:"blockMotionPointTowards",readName:"Point Towards",concept:"direction and turning",tags:["see","point","direction"]},blockMotionGoTo:{cat:"motion",omitbg:!0,label:"go to x:{number:0} y:{number:0}",
func:"blockMotionGoTo",readName:"Go To X-Y",concept:"simple motion",tags:["movement","motion","goto","move"]},blockMotionGoTowards:{cat:"motion",omitbg:!0,label:"go to {where}",func:"blockMotionGoTowards",readName:"Go To",concept:"advanced motion",tags:["move","goto","reach"]},blockMotionGlide:{cat:"motion",omitbg:!0,label:"glide {number:1} secs to x:{number:0} y:{number:0}",func:"blockMotionGlide",readName:"Glide To X-Y",concept:"advanced motion",tags:["glide","movement","motion"]},blockMotionChangeXBy:{cat:"motion",
omitbg:!0,label:"change x by {number:10} pixels",func:"blockMotionChangeXBy",readName:"Change X By",concept:"advanced motion",tags:["move","horizontal","motion"]},blockMotionSetX:{cat:"motion",omitbg:!0,label:"set x to {number:0}",func:"blockMotionSetX",readName:"Set X To",concept:"advanced motion",tags:["go to","horizontal"]},blockMotionChangeYBy:{cat:"motion",omitbg:!0,label:"change y by {number:10} pixels",func:"blockMotionChangeYBy",readName:"Change Y By",concept:"advanced motion",tags:["vertical",
"y","move","go to"]},blockMotionSetY:{cat:"motion",omitbg:!0,label:"set y to {number:0}",func:"blockMotionSetY",readName:"Set Y To",concept:"advanced motion",tags:["vertical","y","go to","move"]},blockMotionBounceOnEdge:{cat:"motion",omitbg:!0,label:"if on edge, bounce",func:"blockMotionBounceOnEdge",readName:"If On Edge, Bounce",concept:"screen bounds",tags:["screen bound","bounce","inside"]},blockMotionRotationStyle:{cat:"motion",omitbg:!0,label:"set rotation style {choice:rotatestyle}",func:"blockMotionRotationStyle",
readName:"Set Rotation Style",concept:"direction and turning",tags:["rotation","rotate","turning"]},valueMotionXPosition:{cat:"motion",watchable:!0,omitbg:!0,label:"x position",value:"number",func:"valueMotionXPosition",readName:"X Position",concept:"advanced motion",tags:["value","x","horizontal"]},valueMotionYPosition:{cat:"motion",watchable:!0,omitbg:!0,label:"y position",value:"number",func:"valueMotionYPosition",readName:"Y Position",concept:"advanced motion",tags:["value","y","vertical"]},valueMotionDirection:{cat:"motion",
watchable:!0,omitbg:!0,label:"direction",value:"number",func:"valueMotionDirection",readName:"Direction",concept:"advanced motion",tags:["angle","direction","value"]},valueMotionAngle:{cat:"motion",watchable:!0,omitbg:!0,label:"angle",value:"number",func:"valueMotionAngle",readName:"Direction",concept:"advanced motion",tags:["angle","direction","value"]},blockHardwareMotor:{cat:"hardware",label:"motor power A:{number:0} B:{number:0}",func:"blockHardwareMotor",readName:"Power Motor",concept:"sensor control"},
valueHardwareDistance:{cat:"hardware",label:"distance",func:"valueHardwareDistance",value:"string",readName:"Distance",concept:"sensor control"},valueHardwareTilt:{cat:"hardware",label:"tilt",func:"valueHardwareTilt",value:"string",readName:"Tilt",concept:"sensor control"},blockMotionMotorOnFor:{cat:"motion",omitbg:!0,hidden:!0,label:"motor on for {number:1} secs",func:"blockMotionMotorOnFor",readName:"Motor On For",concept:"sensor control"},blockMotionMotorOn:{cat:"motion",omitbg:!0,hidden:!0,label:"motor on",
func:"blockMotionMotorOn",readName:"Motor On",concept:"sensor control"},blockMotionMotorOff:{cat:"motion",omitbg:!0,hidden:!0,label:"motor off",func:"blockMotionMotorOff",readName:"Motor Off",concept:"sensor control"},blockMotionMotorPower:{cat:"motion",omitbg:!0,hidden:!0,label:"motor power {number:100}",func:"blockMotionMotorPower",readName:"Set Motor Power To",concept:"sensor control"},blockMotionMotorDirection:{cat:"motion",omitbg:!0,hidden:!0,label:"motor direction {string:this way}",func:"blockMotionMotorDirection",
readName:"Direction",concept:"sensor control"},blockAnimationSetSpeed:{cat:"animation",omitbg:!0,label:"set animation speed to {number:100}%",func:"blockAnimationSetSpeed",readName:"Set Animation Speed",concept:"advanced animation",tags:["animation"]},blockLooksSetCharacterPart:{cat:"animation",omitbg:!0,label:"set part {charparts} to {charskins}",func:"blockLooksSetCharacterPart",readName:"Set Character Part",concept:"advanced animation",tags:["animation"]},valueLooksGetCharacterPart:{cat:"animation",
omitbg:!0,label:"get part {charparts}",func:"valueLooksGetCharacterPart",value:"string",readName:"Get Character Part",concept:"advanced animation",tags:["animation"]},blockAnimationWaitFor:{cat:"animation",omitbg:!0,label:"wait for animation named {animations}",func:"blockAnimationWaitFor",readName:"Wait For Animation",concept:"advanced animation",tags:["animation"]},blockAnimationStop:{cat:"animation",omitbg:!0,label:"stop animation named {animations}",func:"blockAnimationStop",readName:"Stop Animation",
concept:"advanced animation",tags:["animation"]},valueAnimationIsRunning:{cat:"animation",omitbg:!0,label:"is animation {animations} running?",value:"boolean",func:"valueAnimationIsRunning",readName:"Is Animation Running",concept:"advanced animation",tags:["animation"]},valueAnimationTime:{cat:"animation",omitbg:!0,label:"time for animation {costumes}",value:"number",func:"valueAnimationTime",readName:"Animation Time",concept:"advanced animation",tags:["animation"]},registerAnimationDone:{cat:"animation",
omitbg:!0,label:"when animation named {animations} is done",hasFlap:!1,func:"registerAnimationDone",readName:"When Animation is Done",concept:"advanced animation",tags:["animation"]},blockAnimationMoveBy:{cat:"animation",hidden:!0,omitbg:!0,label:"move {number:1} secs by x:{number:0},y:{number:0} using {choice:easing} with name {animations}",func:"blockAnimationMoveBy",readName:"Animate Move By",concept:"advanced animation",tags:["animation"]},blockAnimationMoveTo:{cat:"animation",hidden:!0,omitbg:!0,
label:"move {number:1} secs to x:{number:0},y:{number:0} using {choice:easing} with name {animations}",func:"blockAnimationMoveTo",readName:"Animate Move To",concept:"advanced animation",tags:["animation"]},blockAnimationScaleBy:{cat:"animation",hidden:!0,omitbg:!0,label:"scale {number:1} secs by {number:10}% using {choice:easing} with name {animations}",func:"blockAnimationScaleBy",readName:"Animate Scale By",concept:"advanced animation",tags:["animation"]},blockAnimationScaleTo:{cat:"animation",
hidden:!0,omitbg:!0,label:"scale {number:1} secs to {number:100}% using {choice:easing} with name {animations}",func:"blockAnimationScaleTo",readName:"Animate Scale To",concept:"advanced animation",tags:["animation"]},blockAnimationRotateBy:{cat:"animation",hidden:!0,omitbg:!0,label:"rotate {number:1} secs by {number:15} degrees using {choice:easing} with name {animations}",func:"blockAnimationRotateBy",readName:"Animate Rotate By",concept:"advanced animation",tags:["animation"]},blockAnimationRotateTo:{cat:"animation",
hidden:!0,omitbg:!0,label:"rotate {number:1} secs to {number:0} degrees using {choice:easing} with name {animations}",func:"blockAnimationRotateTo",readName:"Animate Rotate To",concept:"advanced animation",tags:["animation"]},blockAnimationBezierBy:{cat:"animation",hidden:!0,omitbg:!0,label:"bezier {number:1} secs by x:{number:0},y:{number:0} with cx1:{number:0},cy1:{number:0} and cx2:{number:0},cy2:{number:0} using {choice:easing} with name {animations}",func:"blockAnimationBezierBy",readName:"Animate Bezier By",
concept:"advanced animation",tags:["animation"]},blockAnimationBezierTo:{cat:"animation",hidden:!0,omitbg:!0,label:"bezier {number:1} secs to x:{number:0},y:{number:0} with cx1:{number:0},cy1:{number:0} and cx2:{number:0},cy2:{number:0} using {choice:easing} with name {animations}",func:"blockAnimationBezierTo",readName:"Animate Bezier To",concept:"advanced animation",tags:["animation"]},blockAnimationEffectBy:{cat:"animation",hidden:!0,omitbg:!0,label:"change {number:1} secs for {choice:effect} by {number:100} using {choice:easing} with name {animations}",
func:"blockAnimationEffectBy",readName:"Animate Effect By",concept:"advanced animation",tags:["animation"]},blockAnimationEffectTo:{cat:"animation",hidden:!0,omitbg:!0,label:"change {number:1} secs for {choice:effect} to {number:100} using {choice:easing} with name {animations}",func:"blockAnimationEffectTo",readName:"Animate EffectTo",concept:"advanced animation",tags:["animation"]},blockAnimationSwitchCostume:{cat:"animation",hidden:!0,omitbg:!0,label:"switch costumes for {number:1} secs with {number:30} fps and prefixed {costumes} using {choice:easing} with name {animations}",
func:"blockAnimationSwitchCostume",readName:"Animate Costumes",concept:"advanced animation",tags:["animation"]},blockAnimationAnimate:{cat:"animation",omitbg:!0,label:"animate {costumes} at {number:30} fps\nfor {number:1} secs\nand name it {animations}",func:"blockAnimationAnimate",readName:"Animate",concept:"advanced animation",tags:["animation"]},blockAnimationSimpleMoveTo:{cat:"animation",omitbg:!0,label:"move to x:{number:0},y:{number:0}\nin {number:1} secs\nand name it {animations}",func:"blockAnimationSimpleMoveTo",
readName:"Animate Move To",concept:"advanced animation",tags:["animation"]},blockAnimationSimpleMoveBy:{cat:"animation",omitbg:!0,label:"move by x:{number:0},y:{number:0}\nin {number:1} secs\nand name it {animations}",func:"blockAnimationSimpleMoveBy",readName:"Animate Move By",concept:"advanced animation",tags:["animation"]},blockAnimationSimpleRotateTo:{cat:"animation",omitbg:!0,label:"rotate to {number:0} degrees\nin {number:1} secs\nand name it {animations}",func:"blockAnimationSimpleRotateTo",
readName:"Animate Rotate To",concept:"advanced animation",tags:["animation"]},blockAnimationSimpleRotateBy:{cat:"animation",omitbg:!0,label:"rotate by {number:0} degrees\nin {number:1} secs\nand name it {animations}",func:"blockAnimationSimpleRotateBy",readName:"Animate Rotate By",concept:"advanced animation",tags:["animation"]},blockAnimationSimpleScaleTo:{cat:"animation",omitbg:!0,label:"scale to {number:0}%\nin {number:1} secs\nand name it {animations}",func:"blockAnimationSimpleScaleTo",readName:"Animate Scale To",
concept:"advanced animation",tags:["animation"]},blockAnimationSimpleScaleBy:{cat:"animation",omitbg:!0,label:"scale by {number:0}%\nin {number:1} secs\nand name it {animations}",func:"blockAnimationSimpleScaleBy",readName:"Animate Scale By",concept:"advanced animation",tags:["animation"]},blockAnimationSimpleBezierTo:{cat:"animation",omitbg:!0,label:"bezier to x:{number:0},y:{number:0}\nwith cx1:{number:0},cy1:{number:0}\nand cx2:{number:0},cy2:{number:0}\nfor {number:1} secs\nand name it {animations}",
func:"blockAnimationSimpleBezierTo",readName:"Animate Bezier To",concept:"advanced animation",tags:["animation"]},blockAnimationSimpleBezierBy:{cat:"animation",omitbg:!0,label:"bezier by x:{number:0},y:{number:0}\nwith cx1:{number:0},cy1:{number:0}\nand cx2:{number:0},cy2:{number:0}\nfor {number:1} secs\nand name it {animations}",func:"blockAnimationSimpleBezierBy",readName:"Animate Bezier By",concept:"advanced animation",tags:["animation"]},blockAnimationSimpleEffectTo:{cat:"animation",label:"change {choice:effect} to {number:0}\nin {number:1} secs\nand name it {animations}",
func:"blockAnimationSimpleEffectTo",readName:"Animate Effect To",concept:"advanced animation",tags:["animation"]},blockAnimationSimpleEffectBy:{cat:"animation",label:"change {choice:effect} by {number:25}\nin {number:1} secs\nand name it {animations}",func:"blockAnimationSimpleEffectBy",readName:"Animate Effect By",concept:"advanced animation",tags:["animation"]},blockAnimationSimpleSwitchCostume:{cat:"animation",omitbg:!0,label:"animate {costumes}",func:"blockAnimationSimpleSwitchCostume",readName:"Animate",
concept:"advanced animation",tags:["animation"]},blockAnimationSimpleSwitchCostumeAndWait:{cat:"animation",omitbg:!0,label:"animate {costumes} and wait",func:"blockAnimationSimpleSwitchCostumeAndWait",readName:"Animate and Wait",concept:"advanced animation",tags:["animation"]},blockLooksSwitchCostume:{cat:"looks",omitbg:!0,label:"switch to costume {costumes}",func:"blockLooksSwitchCostume",readName:"Switch To Costume",concept:"advanced costume handling",tags:["change look","switch costume"]},blockLooksNextCostume:{cat:"looks",
omitbg:!0,label:"next costume",func:"blockLooksNextCostume",readName:"Next Costume",concept:"simple costume handling",tags:["change look","change costume"]},blockLooksFirstCostumeInGroup:{cat:"looks",omitbg:!0,label:"first costume starting with {costumes}",func:"blockLooksFirstCostumeInGroup",readName:"First Costume Starting With",concept:"advanced costume handling",tags:["change look","change costume"]},blockLooksNextCostumeInGroup:{cat:"looks",omitbg:!0,label:"next costume starting with {costumes}",
func:"blockLooksNextCostumeInGroup",readName:"Next Costume Starting With",concept:"advanced costume handling",tags:["change look","change costume"]},valueLooksCostumeNum:{cat:"looks",watchable:!0,omitbg:!0,label:"costume #",value:"number",func:"valueLooksCostumeNum",readName:"Costume #",concept:"advanced costume handling",tags:["value"]},valueLooksCostumeName:{cat:"looks",watchable:!0,omitbg:!0,label:"costume name",value:"string",func:"valueLooksCostumeName",readName:"Costume Name",concept:"advanced costume handling",
tags:["value"]},blockLooksBackgroundColor:{cat:"looks",label:"set background color {color}",func:"blockLooksBackgroundColor",readName:"Background Color",concept:"advanced costume handling",tags:["change background"]},blockLooksSwitchBackground:{cat:"looks",label:"switch to background {scenes}",func:"blockLooksSwitchBackground",readName:"Switch To Scene",concept:"advanced costume handling",tags:["change background"]},blockLooksSwitchBackgroundAndWait:{cat:"looks",label:"switch to background {scenes} and wait",
func:"blockLooksSwitchBackgroundAndWait",readName:"Switch To Scene And Wait",concept:"advanced costume handling",tags:["change background"]},blockLooksNextBackground:{cat:"looks",label:"next background",func:"blockLooksNextBackground",readName:"Next Scene",concept:"simple costume handling"},blockLooksFirstBackgroundInGroup:{cat:"looks",label:"first background starting with {costumes}",func:"blockLooksFirstBackgroundInGroup",readName:"First Scene Starting With",concept:"advanced costume handling",
tags:["change look","change background"]},blockLooksNextBackgroundInGroup:{cat:"looks",label:"next background starting with {costumes}",func:"blockLooksNextBackgroundInGroup",readName:"Next Scene Starting With",concept:"advanced costume handling",tags:["change look","change background"]},valueLooksBackground:{cat:"looks",watchable:!0,omitactor:!0,label:"background #",value:"number",func:"valueLooksBackground",readName:"Scene #",concept:"advanced costume handling"},valueLooksBackgroundName:{cat:"looks",
watchable:!0,label:"background name",value:"number",func:"valueLooksBackgroundName",readName:"Scene Name",concept:"advanced costume handling"},blockLooksSetLabel:{cat:"looks",omitbg:!0,label:"set label to {string:Hello} {varargs}",func:"blockLooksSetLabel",readName:"Set Label To",concept:"input/output",tags:["bubble","talk","say","output"]},blockLooksSetBubble:{cat:"looks",label:"set bubble to {choice:bubblestyle}",func:"blockLooksSetBubble",readName:"Set Bubble To",concept:"input/output",tags:["talk"]},
blockLooksSetBubbleDock:{cat:"looks",label:"set bubble dock to {choice:bubbledock}",func:"blockLooksSetBubbleDock",readName:"Set Bubble Dock To",concept:"input/output",tags:["talk"]},blockLooksSetBubbleWidth:{cat:"looks",label:"set bubble width to {number:50}%",func:"blockLooksSetBubbleWidth",readName:"Set Bubble Width To",concept:"input/output",tags:["talk"]},blockLooksSayFor:{cat:"looks",label:"say {string:Hello} {varargs} for {number:2} secs",func:"blockLooksSayFor",readName:"Say For",concept:"input/output",
tags:["bubble","talk","output","time"]},blockLooksSay:{cat:"looks",label:"say {string:Hello} {varargs}",func:"blockLooksSay",readName:"Say",concept:"input/output",tags:["talk"]},blockLooksThinkFor:{cat:"looks",label:"think {string:Hmm} {varargs} for {number:2} secs",func:"blockLooksThinkFor",readName:"Think For",concept:"input/output",tags:["bubble","output"]},blockLooksThink:{cat:"looks",label:"think {string:Hmm} {varargs}",func:"blockLooksThink",readName:"Think",concept:"input/output"},blockLooksChangeEffect:{cat:"looks",
label:"change {choice:effect} effect by {number:25}",func:"blockLooksChangeEffect",readName:"Change Effect By",concept:"graphic effects",tags:["transparent","visual","special effect","alpha","opacity"]},blockLooksSetEffect:{cat:"looks",label:"set {choice:effect} effect to {number:0}",func:"blockLooksSetEffect",readName:"Set Effect To",concept:"graphic effects",tags:["transparent","visual","special effect","alpha","opacity"]},blockLooksClearEffects:{cat:"looks",label:"clear graphic effects",func:"blockLooksClearEffects",
readName:"Clear Graphic Effects",concept:"graphic effects",tags:["special effect"]},blockLooksChangeSizeBy:{cat:"looks",omitbg:!0,label:"change size by {number:10}%",func:"blockLooksChangeSizeBy",readName:"Change Size By",concept:"resize actor",tags:["size","resize","bigger","smaller"]},blockLooksSetSize:{cat:"looks",omitbg:!0,label:"set size to {number:100}%",func:"blockLooksSetSize",readName:"Set Size To",concept:"resize actor",tags:"resize;bigger;smaller;make bigger;make smaller;shrink;enlarge".split(";")},
valueLooksSize:{cat:"looks",watchable:!0,omitbg:!0,label:"size",value:"number",func:"valueLooksSize",readName:"Size",concept:"resize actor",tags:["resize","bigger","smaller","make bigger","make smaller"]},blockLooksShow:{cat:"looks",omitbg:!0,label:"show",func:"blockLooksShow",readName:"Show",concept:"visibility",tags:["visibility"]},blockLooksHide:{cat:"looks",omitbg:!0,label:"hide",func:"blockLooksHide",readName:"Hide",concept:"visibility",tags:["visibility"]},valueLooksIsHidden:{cat:"looks",watchable:!0,
omitbg:!0,label:"is hidden?",value:"boolean",func:"valueLooksIsHidden",readName:"Is Hidden?",concept:"visibility",tags:["visibility"]},blockLooksLayer:{cat:"looks",omitbg:!0,label:"set layer to {number}",func:"blockLooksLayer",readName:"Set Layer",concept:"layers",tags:["layers"]},valueLooksLayer:{cat:"looks",omitbg:!0,label:"get layer",func:"valueLooksLayer",value:"number",readName:"Get Layer",concept:"layers",tags:["layers"]},blockLooksGoFront:{cat:"looks",omitbg:!0,label:"go to front",func:"blockLooksGoFront",
readName:"Go To Front",concept:"layers",tags:["layers"]},blockLooksGoBack:{cat:"looks",omitbg:!0,label:"go to back",func:"blockLooksGoBack",readName:"Go To Back",concept:"layers",tags:["layers"]},blockLooksMoveBack:{cat:"looks",omitbg:!0,label:"go back {number:1} layers",func:"blockLooksMoveBack",readName:"Go Back Layers",concept:"layers"},blockLooksMoveFront:{cat:"looks",omitbg:!0,label:"go forward {number:1} layers",func:"blockLooksMoveFront",readName:"Go Forward Layers",concept:"layers"},blockLooksDialog:{cat:"looks",
hidden:!0,label:"show dialog with {string}",func:"blockLooksDialog",readName:"System Dialog",concept:"input/output",tags:[]},blockLooksViewportCamera:{cat:"looks",hidden:!0,label:"set viewport camera to {actor}",func:"blockLooksViewportCamera",readName:"Viewport Camera",concept:"level design",tags:["level"]},blockLooksPromptChoices:{cat:"looks",hidden:!0,label:"show dialog with {string} and choices {string:OK} {varargs}",func:"blockLooksPromptChoices",readName:"System Dialog",concept:"input/output",
tags:[]},blockLooksVideo:{cat:"looks",hidden:!0,omitactor:!0,label:"turn video {choice:videoviewtype}",func:"blockLooksVideo",readName:"Turn Video",concept:"video",tags:["video"]},blockLooksVideoTransparency:{cat:"looks",hidden:!0,omitactor:!0,label:"set video transparency to {number:100}%",func:"blockLooksVideoTransparency",readName:"Set Video Transparency To",concept:"video",tags:["video"]},blockLooksSetLevel:{cat:"looks",label:"set level to {level}",hasSlot:!1,func:"blockLooksSetLevel",readName:"Set level to",
concept:"level design",tags:["level"]},blockLooksSetLevelWithActors:{cat:"looks",label:"set level to {level} with actors {varargs:actor}",hasSlot:!1,func:"blockLooksSetLevelWithActors",readName:"Set level to",concept:"level design",tags:["level"]},valueLooksGetLevel:{cat:"looks",label:"get current level",func:"valueLooksGetLevel",value:"string",readName:"Get current level",concept:"level design",tags:["level"]},valueLooksGetLevelNum:{cat:"looks",label:"get current level number",func:"valueLooksGetLevelNum",
value:"number",readName:"Get current level",concept:"level design",tags:["level"]},valueLooksNumLevels:{cat:"looks",label:"get number of levels",func:"valueLooksNumLevels",value:"number",readName:"Get number of levels",concept:"level design",tags:["level"]},blockLooksSetZoom:{cat:"looks",hidden:!0,label:"set stage zoom to {number:100} %",func:"blockLooksSetZoom",readName:"Set canvas zoom",concept:"level design",tags:["level"]},valueLooksGetZoom:{cat:"looks",hidden:!0,label:"get stage zoom",func:"valueLooksGetZoom",
value:"number",readName:"Get canvas zoom",concept:"level design",tags:["level"]},valueLooksGetTileAt:{cat:"looks",hidden:!0,label:"get tile at column:{number} row:{number}",func:"valueLooksGetTileAt",value:"string",readName:"Get tile at",concept:"level design",tags:["level"]},valueLooksGetTileAtPoint:{cat:"looks",hidden:!0,label:"get tile at point x:{number} y:{number}",func:"valueLooksGetTileAtPoint",value:"string",readName:"Get tile at point",concept:"level design",tags:["level"]},blockLooksSetTileAt:{cat:"looks",
hidden:!0,label:"set tile at column:{number} row:{number} to {tiles}",func:"blockLooksSetTileAt",readName:"Set tile at",concept:"level design",tags:["level"]},blockLooksSetTileAtPoint:{cat:"looks",hidden:!0,label:"set tile at point x:{number} y:{number} to {tiles}",func:"blockLooksSetTileAtPoint",readName:"Set tile at point",concept:"level design",tags:["level"]},valueSensingVideo:{cat:"sensing",hidden:!0,label:"video {choice:videosensetype} on{where}?",value:"number",func:"valueSensingVideo",readName:"Video On?",
concept:"detect conditions",tags:["video","detect"]},valueSensingTouchingSprite:{cat:"sensing",omitbg:!0,label:"touching {where}?",value:"boolean",func:"valueSensingTouchingSprite",readName:"Touching?",concept:"detect conditions"},valueSensingTouchingCloneOf:{cat:"sensing",omitbg:!0,label:"touching clone of {where}?",value:"boolean",func:"valueSensingTouchingCloneOf",readName:"Touching Clone Of?",concept:"detect conditions"},valueSensingTouchingColor:{cat:"sensing",omitbg:!0,label:"touching color {color}?",
value:"boolean",func:"valueSensingTouchingColor",readName:"Touching Color?",concept:"color detection"},valueSensingSeeColor:{cat:"sensing",omitbg:!0,label:"color {color} is touching {color}?",value:"boolean",func:"valueSensingSeeColor",readName:"Color Is Touching?",concept:"color detection"},blockSensingAskAndWait:{cat:"sensing",label:"ask {string:What is your name} {varargs} and wait",func:"blockSensingAskAndWait",readName:"Ask And Wait",concept:"input/output"},blockSensingAskChoices:{cat:"sensing",
label:"ask {string:Yes or no} with choices {string:ok} {varargs}",func:"blockSensingAskChoices",readName:"Ask With Choices",concept:"input/output"},valueSensingAnswer:{cat:"sensing",watchable:!0,label:"answer",value:"string",func:"valueSensingAnswer",readName:"Answer",concept:"input/output"},valueSensingTiltAngle:{cat:"sensing",watchable:!0,label:"tilt angle",value:"number",func:"valueSensingTiltAngle",readName:"Tilt Angle",concept:"advanced motion"},valueSensingTiltAmount:{cat:"sensing",watchable:!0,
label:"tilt amount",value:"number",func:"valueSensingTiltAmount",readName:"Tilt Amount",concept:"advanced motion"},valueSensingAccelerometerX:{cat:"sensing",watchable:!0,label:"x tilt",value:"number",func:"valueSensingAccelerometerX",readName:"Accelerometer X",concept:"advanced motion"},valueSensingAccelerometerY:{cat:"sensing",watchable:!0,label:"y tilt",value:"number",func:"valueSensingAccelerometerY",readName:"Accelerometer Y",concept:"advanced motion"},valueSensingMouseX:{cat:"sensing",watchable:!0,
label:"mouse x",value:"number",func:"valueSensingMouseX",readName:"Mouse X",concept:"advanced motion"},valueSensingMouseY:{cat:"sensing",watchable:!0,label:"mouse y",value:"number",func:"valueSensingMouseY",readName:"Mouse Y",concept:"advanced motion"},valueSensingMouseDown:{cat:"sensing",watchable:!0,label:"mouse down?",value:"boolean",func:"valueSensingMouseDown",readName:"Mouse Down?",concept:"detect conditions"},valueSensingKeyPressed:{cat:"sensing",label:"key {choice:keys} pressed?",value:"boolean",
func:"valueSensingKeyPressed",readName:"Key Pressed?",concept:"detect conditions"},valueSensingDistanceToSprite:{cat:"sensing",omitbg:!0,label:"distance to {whereall}?",value:"number",func:"valueSensingDistanceToSprite",readName:"Distance To",concept:"advanced motion",tags:["value"]},blockSensingResetTimer:{cat:"sensing",label:"reset timer",func:"blockSensingResetTimer",readName:"Reset Timer",concept:"timer"},valueSensingTimer:{cat:"sensing",watchable:!0,label:"timer",value:"number",func:"valueSensingTimer",
readName:"Timer",concept:"timer"},blockSensingSpriteProperty:{cat:"sensing",label:"set {choice:spriteprop} of {whereall} to {string:0}",func:"blockSensingSpriteProperty",readName:"Property Of",concept:"resize actor",tags:"value;variable;variables;property;properties;x position;y position;angle;direction;layer;rotation style;label;say;costume #;costume name;size;volume;width;height;density;friction;restitution;angular velocity;angular damping;linear damping;x linear velocity;y linear velocity".split(";")},
valueSensingSpriteProperty:{cat:"sensing",label:"{choice:spriteprop} of {whereall}",value:"number",func:"valueSensingSpriteProperty",readName:"Property Of",concept:"resize actor",tags:"value;variable;variables;property;properties;x position;y position;angle;direction;layer;rotation style;label;say;costume #;costume name;size;volume;width;height;density;friction;restitution;angular velocity;angular damping;linear damping;x linear velocity;y linear velocity".split(";")},valueSensingActorName:{cat:"sensing",
label:"my actor name",value:"string",func:"valueSensingActorName",readName:"Name Of Actor",concept:"resize actor",tags:["value"]},valueSensingActorNameAt:{cat:"sensing",label:"name of actor at {number}",value:"string",func:"valueSensingActorNameAt",readName:"Name Of Actor",concept:"resize actor",tags:["value"]},valueSensingNumActors:{cat:"sensing",label:"# of actors",value:"number",func:"valueSensingNumActors",readName:"# Of Actors",concept:"resize actor",tags:["value"]},valueSensingTouchedActorName:{cat:"sensing",
label:"name of actor touched",value:"string",func:"valueSensingTouchedActorName",readName:"Name Of Actor Touched",concept:"touching actor",tags:["value"]},valueSensingSoundLevel:{cat:"sensing",hidden:!0,watchable:!0,label:"loudness",value:"number",func:"valueSensingSoundLevel",readName:"Loudness",concept:"sensor control",tags:["value"]},valueSensingIsLoud:{cat:"sensing",hidden:!0,label:"loud?",value:"boolean",func:"valueSensingIsLoud",readName:"Loud?",concept:"sensor control",tags:["value"]},valueSensingSensor:{cat:"sensing",
hidden:!0,label:"{string:slider} sensor value",value:"number",func:"valueSensingSensor",readName:"Sensor Value",concept:"sensor control",tags:["value"]},valueSensingSensorPressed:{cat:"sensing",hidden:!0,label:"sensor {string:button pressed}?",value:"boolean",func:"valueSensingSensorPressed",readName:"Sensor?",concept:"sensor control",tags:["value"]},valueSensingDateTime:{cat:"sensing",label:"{choice:datetime} of date/time",value:"number",func:"valueSensingDateTime",readName:"Of Date/Time",concept:"system date",
tags:"value system time date year month day hours minutes seconds milliseconds time".split(" ")},valueSensingScreenLeft:{cat:"sensing",hidden:!1,label:"screen left",value:"number",func:"valueSensingScreenLeft",readName:"Screen Left",concept:"screen bounds",tags:["border","edge","value"]},valueSensingScreenRight:{cat:"sensing",hidden:!1,label:"screen right",value:"number",func:"valueSensingScreenRight",readName:"Screen Right",concept:"screen bounds",tags:["border","edge","value"]},valueSensingScreenTop:{cat:"sensing",
hidden:!1,label:"screen top",value:"number",func:"valueSensingScreenTop",readName:"Screen Top",concept:"screen bounds",tags:["border","edge","value"]},valueSensingScreenBottom:{cat:"sensing",hidden:!1,label:"screen bottom",value:"number",func:"valueSensingScreenBottom",readName:"Screen Bottom",concept:"screen bounds",tags:["border","edge","value"]},valueSensingStageProperty:{cat:"sensing",label:"stage property {stageproperty}",value:"number",func:"valueSensingStageProperty",readName:"Stage Property",
concept:"stage property",tags:["stage","property","properties","value"]},blockSensingSetTag:{cat:"sensing",label:"set tag to {string}",func:"blockSensingSetTag",readName:"Set Tag",concept:"actor properties",tags:["actor","property","properties","value"]},valueSensingGetTag:{cat:"sensing",label:"get tag of {actor}",func:"valueSensingGetTag",value:"string",readName:"Get Tag",concept:"actor properties",tags:["actor","property","properties","value","tag"]},valueSensingUserId:{cat:"sensing",label:"user ID",
value:"string",func:"valueSensingUserId",readName:"User ID",concept:"identification",tags:["value","cloud","user"]},valueSensingUserFirstName:{cat:"sensing",label:"user first name",value:"string",func:"valueSensingUserFirstName",readName:"User First Name",concept:"identification",tags:["value","cloud","user","name"]},blockSoundPlay:{cat:"sound",label:"play sound {sounds}",func:"blockSoundPlay",readName:"Play Sound",concept:"simple sound playing",tags:["music","media"]},blockSoundPlayUntilDone:{cat:"sound",
label:"play sound {sounds} until done",func:"blockSoundPlayUntilDone",readName:"Play Sound Until Done",concept:"simple sound playing",tags:["music","media"]},blockSoundStopAll:{cat:"sound",label:"stop all sounds",func:"blockSoundStopAll",readName:"Stop All Sounds",concept:"music and instruments"},blockSoundStopActor:{cat:"sound",label:"stop actor sounds",func:"blockSoundStopActor",readName:"Stop Current Actor Sounds",concept:"music and instruments"},blockSoundPlayDrum:{cat:"sound",label:"play drum {choice:drums} for {number:0.2} beats",
func:"blockSoundPlayDrum",readName:"Play Drum For Beats",concept:"music and instruments",tags:["music"]},blockSoundRest:{cat:"sound",label:"rest for {number:0.2} beats",func:"blockSoundRest",readName:"Rest For Beats",concept:"music and instruments",tags:["music"]},blockSoundPlayNote:{cat:"sound",label:"play note {number:60} for {number:0.5} beats",func:"blockSoundPlayNote",readName:"Play Note For Beats",concept:"music and instruments",tags:["music"]},blockSoundSetInstrument:{cat:"sound",label:"set instrument to {choice:instruments}",
func:"blockSoundSetInstrument",readName:"Set Instrument To",concept:"music and instruments",tags:["music"]},blockSoundChangeVolume:{cat:"sound",label:"change volume by {number:-10}",func:"blockSoundChangeVolume",readName:"Change Volume By",concept:"music and instruments",tags:["music"]},blockSoundSetVolume:{cat:"sound",label:"set volume to {number:100}%",func:"blockSoundSetVolume",readName:"Set Volume To",concept:"music and instruments",tags:["music"]},valueSoundVolume:{cat:"sound",watchable:!0,label:"volume",
value:"number",value:"number",func:"valueSoundVolume",readName:"Volume",concept:"music and instruments",tags:["value"]},blockSoundChangeTempo:{cat:"sound",label:"change tempo by {number:20}",func:"blockSoundChangeTempo",readName:"Change Tempo By",concept:"music and instruments",tags:["music"]},blockSoundSetTempo:{cat:"sound",label:"set tempo to {number:60} bpm",func:"blockSoundSetTempo",readName:"Set Tempo To",concept:"music and instruments",tags:["music"]},valueSoundTempo:{cat:"sound",watchable:!0,
label:"tempo",value:"number",func:"valueSoundTempo",readName:"Tempo",concept:"music and instruments",tags:["music"]},valueOpAdd:{cat:"operator",label:"{number} + {number}",value:"number",func:"valueOpAdd",readName:"Add (+)",concept:"basic math",tags:["plus","addition"]},valueOpSubtract:{cat:"operator",label:"{number} - {number}",value:"number",func:"valueOpSubtract",readName:"Subtract (-)",concept:"basic math",tags:["minus","subtraction"]},valueOpMultiply:{cat:"operator",label:"{number} * {number}",
value:"number",func:"valueOpMultiply",readName:"Multiple (*)",concept:"basic math",tags:["into","multiply","multiplication","times"]},valueOpDivide:{cat:"operator",label:"{number} / {number}",value:"number",func:"valueOpDivide",readName:"Divide (/)",concept:"basic math",tags:["divide by","division"]},valueOpRandom:{cat:"operator",label:"pick random {number:1} to {number:10}",value:"number",func:"valueOpRandom",readName:"Pick Random",concept:"basic math",tags:["gamble","any","chance","choice"]},valueOpLess:{cat:"operator",
label:"{string} < {string}",value:"boolean",func:"valueOpLess",readName:"Less Than (<)",concept:"basic math",tags:["logical","less than","compare"]},valueOpEqual:{cat:"operator",label:"{string} = {string}",value:"boolean",func:"valueOpEqual",readName:"Equal To (=)",concept:"basic math",tags:["logical","equals","compare"]},valueOpGreater:{cat:"operator",label:"{string} > {string}",value:"boolean",func:"valueOpGreater",readName:"Greater Than (>)",concept:"basic math",tags:["logical","greater than",
"compare"]},valueOpAnd:{cat:"operator",label:"{boolean} and {boolean}",value:"boolean",func:"valueOpAnd",readName:"And",concept:"advanced math",tags:["logical"]},valueOpOr:{cat:"operator",label:"{boolean} or {boolean}",value:"boolean",func:"valueOpOr",readName:"Or",concept:"advanced math",tags:["logical"]},valueOpNot:{cat:"operator",label:"not {boolean}",value:"boolean",func:"valueOpNot",readName:"Not",concept:"advanced math",tags:["logical"]},valueOpJoin:{cat:"operator",label:"join {string:hello} {string:world} {varargs}",
value:"string",func:"valueOpJoin",readName:"Join",concept:"string handling",tags:["strings","add","string","strings","text"]},valueOpLetter:{cat:"operator",label:"letter {number:1} of {any:world}",value:"string",func:"valueOpLetter",readName:"Letter Of",concept:"advanced string handling",tags:["value","string","strings","text"]},valueOpLength:{cat:"operator",label:"length of {string:world}",value:"number",func:"valueOpLength",readName:"Length Of",concept:"advanced string handling",tags:["value","string",
"strings","text"]},valueOpMod:{cat:"operator",label:" {number} mod {number}",value:"number",func:"valueOpMod",readName:"Mod",concept:"advanced math",tags:["mod","modulo","remainder"]},valueOpRound:{cat:"operator",label:"round {number}",value:"number",func:"valueOpRound",readName:"Round",concept:"advanced math",tags:["round","round up","integer"]},valueOpMath:{cat:"operator",label:"{choice:math} of {number:10}",value:"number",func:"valueOpMath",readName:"Math Function Of",concept:"expert math",tags:"abs;floor;ceiling;int;sqrt;sin;cos;tan;asin;acos;atan;ln;log;e^;10^;trigonometry;math operator".split(";")},
valueOpMath2:{cat:"operator",label:"{choice:math2} of {number:10} and {number:10}",value:"number",func:"valueOpMath2",readName:"Math Function Of",concept:"expert math",tags:"atan2;atan2rad;max;min;pow;math operator".split(";")},valueOpConstants:{cat:"operator",label:" {choice:constants}",value:"number",func:"valueOpConstants",readName:"Math Constants",concept:"expert math",tags:"value pi e ln ln2 ln10 log2e log10e".split(" ")},valueOpBinary:{cat:"operator",label:" {string} {choice:operator} {string}",
value:"number",func:"valueOpBinary",readName:"Binary Operators",concept:"advanced math",tags:"logical binary math + - * / = == < <= > >= != & && and || or ^ xor << >> >>>".split(" ")},valueOpBitNot:{cat:"operator",label:"bitwise not {number}",value:"number",func:"valueOpBitNot",readName:"Bitwise Not",concept:"advanced math",tags:["logical","bit"]},valueOpExpression:{cat:"operator",label:"expression {string} {button:edit}",value:"number",func:"valueOpExpression",readName:"Expression",concept:"advanced math",
tags:["math","expression"]},valueOpTextSplit:{cat:"operator",label:"split {string:hello world} by {string: }",value:"list",func:"valueOpTextSplit",readName:"split",concept:"advanced text",tags:["text","string","strings"]},valueOpTextReplace:{cat:"operator",label:"replace {string:hello} in {string:hello world} with {string:hi}",value:"string",func:"valueOpTextReplace",readName:"split",concept:"advanced text",tags:["text","string","strings"]},valueOpTextIndex:{cat:"operator",label:"index of {string:world} in {string:hello world}",
value:"number",func:"valueOpTextIndex",readName:"split",concept:"advanced text",tags:["text","string","strings"]},valueOpTextLastIndex:{cat:"operator",label:"last index of {string:l} in {string:hello}",value:"number",func:"valueOpTextLastIndex",readName:"split",concept:"advanced text",tags:["text","string","strings"]},valueOpTextSubstring:{cat:"operator",label:"substring of {string:hello} from {number:2} to {number:5}",value:"string",func:"valueOpTextSubstring",readName:"split",concept:"advanced text",
tags:["text","string","strings"]},valueOpTextTransform:{cat:"operator",label:"perform {choice:texttransform} on {string:Hello World}",value:"string",func:"valueOpTextTransform",readName:"split",concept:"advanced text",tags:["text","string","strings"]},valueOpTextFormat:{cat:"operator",label:"format {string:hello {0}} with {varargs}",value:"string",func:"valueOpTextFormat",readName:"split",concept:"advanced text",tags:["text","string","strings"]},blockPenClear:{cat:"pen",label:"clear",func:"blockPenClear",
readName:"Clear",concept:"simple drawing",tags:["draw"]},blockPenDown:{cat:"pen",omitbg:!0,label:"pen down",func:"blockPenDown",readName:"Pen Down",concept:"simple drawing",tags:["draw"]},blockPenUp:{cat:"pen",omitbg:!0,label:"pen up",func:"blockPenUp",readName:"Pen Up",concept:"simple drawing",tags:["draw"]},blockPenSetColor:{cat:"pen",label:"set pen color to {color}",func:"blockPenSetColor",readName:"Set Pen Color To",concept:"pen color",tags:["draw"]},blockPenChangeHue:{cat:"pen",label:"change pen color by {number:10}",
func:"blockPenChangeHue",readName:"Change Pen Color By",concept:"pen color",tags:["draw"]},blockPenSetHue:{cat:"pen",label:"set pen color to {number:0}",func:"blockPenSetHue",readName:"Set Pen Color To",concept:"pen color",tags:["color","rgb","hue","draw"]},blockPenChangeShade:{cat:"pen",label:"change pen shade by {number:10}",func:"blockPenChangeShade",readName:"Change Pen Shade By",concept:"pen shade",tags:["draw"]},blockPenSetShade:{cat:"pen",label:"set pen shade to {number:50}",func:"blockPenSetShade",
readName:"Set Pen Shade To",concept:"pen shade"},blockPenChangeSize:{cat:"pen",label:"change pen size by {number:1}",func:"blockPenChangeSize",readName:"Change Pen Size By",concept:"pen size",tags:["draw"]},blockPenSetSize:{cat:"pen",label:"set pen size to {number:1}",func:"blockPenSetSize",readName:"Set Pen Size To",concept:"pen size",tags:["draw"]},blockPenStamp:{cat:"pen",omitbg:!0,label:"stamp",func:"blockPenStamp",readName:"Stamp",concept:"simple drawing",tags:["draw"]},blockPenSetFont:{cat:"pen",
label:"set font to {choice:fontstyle} {choice:fontsize:18} {choice:font}",func:"blockPenSetFont",readName:"Set Font To",concept:"text handling",tags:["text"]},blockPenSetFontColor:{cat:"pen",label:"set font color to {color}",func:"blockPenSetFontColor",readName:"Set Font Color To",concept:"text handling",tags:["text"]},blockPenDrawText:{cat:"pen",omitbg:!0,label:"draw text {string}",func:"blockPenDrawText",readName:"Draw Text",concept:"text handling",tags:["write"]},registerDraw:{cat:"pen",hidden:!0,
omitbg:!0,hasFlap:!1,label:"when drawing actor",func:"registerDraw",readName:"When Drawing Actor",concept:"drawing actors",tags:["hat block","callback","paint"]},blockPenRedraw:{cat:"pen",hidden:!0,omitbg:!0,label:"redraw actor",func:"blockPenRedraw",readName:"Redraw Actor",concept:"drawing actors",tags:["draw"]},blockPenSetFillColor:{cat:"pen",label:"set fill color to {color}",func:"blockPenSetFillColor",readName:"Set Fill Color To",concept:"fill color",tags:["draw"]},blockPenSetNoFill:{cat:"pen",
label:"no fill",func:"blockPenSetNoFill",readName:"No Fill",concept:"fill color",tags:["draw","paint"]},blockPenDrawBezier:{cat:"pen",label:"draw bezier at x1:{number:0} y1:{number:0}\nto x2:{number:0} y2:{number:0}\nwith control points cx1:{number:0} cy1:{number:0}\nand cx2:{number:0} cy2:{number:0}",func:"blockPenDrawBezier",readName:"Draw Bezier At",concept:"shape drawing",tags:["geometry","curve"]},blockPenDrawPoint:{cat:"pen",label:"draw point at x:{number:0} y:{number:0}",func:"blockPenDrawPoint",
readName:"Draw Point",concept:"shape drawing",tags:["geometry","shapes","geometric"]},blockPenDrawLine:{cat:"pen",label:"draw line from x1:{number:0} y1:{number:0}\nto x2:{number:0} y2:{number:0}",func:"blockPenDrawLine",readName:"Draw Line",concept:"shape drawing",tags:["shapes","geometry","geometric"]},blockPenDrawRectangle:{cat:"pen",label:"draw rectangle at x:{number:0} y:{number:0}\nwith width:{number:0} height:{number:0}",func:"blockPenDrawRectangle",readName:"Draw Rectangle",concept:"shape drawing",
tags:["geometry","geometric shape"]},blockPenClearRect:{cat:"pen",hidden:!0,label:"clear rectangle at x:{number:0} y:{number:0}\nwith width:{number:0} height:{number:0}",func:"blockPenClearRect",readName:"Clear",concept:"simple drawing",tags:["draw"]},blockPenDrawTriangle:{cat:"pen",label:"draw triangle with points x1:{number:0} y1:{number:0}\nx2:{number:0} y2:{number:0}\nx3:{number:0} y3:{number:0}",func:"blockPenDrawTriangle",readName:"Draw Triangle",concept:"shape drawing",tags:["geometry","geometric shape"]},
blockPenDrawEllipse:{cat:"pen",label:"draw ellipse at x:{number:0} y:{number:0}\nwith width:{number:0} height:{number:0}",func:"blockPenDrawEllipse",readName:"Draw Ellipse",concept:"shape drawing",tags:["geometry","geometric shape","circle","oval"]},blockPenDrawTextAt:{cat:"pen",label:"draw text {string} at x:{number:0} y:{number:0}",func:"blockPenDrawTextAt",readName:"Draw Text At",concept:"text handling"},blockPenDrawRectangleLocal:{cat:"pen",omitbg:!0,label:"draw rectangle with width:{number:0} height:{number:0}",
func:"blockPenDrawRectangleLocal",readName:"Draw Rectangle",concept:"shape drawing",tags:["geometry","geometric shape"]},blockPenDrawEllipseLocal:{cat:"pen",omitbg:!0,label:"draw ellipse with width:{number:0} height:{number:0}",func:"blockPenDrawEllipseLocal",readName:"Draw Ellipse",concept:"shape drawing",tags:["circle","oval","geometry","geometric shape"]},registerSpriteCollision:{cat:"physics",omitbg:!0,hidden:!1,label:"when actor collides",hasFlap:!1,func:"registerSpriteCollision",readName:"When Actor Collides",
concept:"advanced physics",tags:["hat block","collision"]},valuePhysicsGetProperty:{cat:"physics",omitbg:!1,hidden:!1,label:"get property {choice:getphysics} of {actortiles}",value:"string",func:"valuePhysicsGetProperty",readName:"Physics properties",concept:"advanced physics",tags:"value;property;properties;density;friction;restitution;angular velocity;angular damping;inertia;is active;is awake;linear damping;x linear velocity;y linear velocity;x gravity;y gravity;last collided with;last collision x;last collision y;last actor collided with;last actor collision x;last actor collision y".split(";")},
blockPhysicsApply:{cat:"physics",omitbg:!1,hidden:!1,label:"apply {choice:setphysics} to {actortiles} with {number:0}",func:"blockPhysicsApply",readName:"Physics properties",concept:"expert physics",tags:"value;force;impulse;torque;density;friction;restitution;angular damping;angular velocity;linear damping;linear velocity".split(";")},blockPhysicsApplyXY:{cat:"physics",omitbg:!1,hidden:!1,label:"apply {choice:setphysicsxy} to {actortiles} with x:{number:0} y:{number:0}",func:"blockPhysicsApplyXY",
readName:"Physics properties",concept:"expert physics",tags:["value","force","impulse","linear velocity","gravity"]},blockPhysicsSetActorActive:{cat:"physics",label:"set active on {actortiles} to {boolean}",func:"blockPhysicsSetActorActive",readName:"Set Active",concept:"expert physics"},blockPhysicsSetActorStatic:{cat:"physics",omitbg:!0,label:"set static on {actortiles} to {boolean}",func:"blockPhysicsSetActorStatic",readName:"Set Static",concept:"expert physics"},blockPhysicsSetActorGeometry:{cat:"physics",
omitbg:!0,hidden:!1,label:"set shape on {actor} to {choice:geometry}",func:"blockPhysicsSetActorGeometry",readName:"Set Shape To",concept:"expert physics"},valuePhysicsCollidedWithSprite:{cat:"physics",omitbg:!0,hidden:!1,label:"collided with {where}?",value:"boolean",func:"valuePhysicsCollidedWithSprite",readName:"Collided With?",concept:"advanced physics",tags:["value"]},valuePhysicsCollidedWithName:{cat:"physics",omitbg:!0,hidden:!1,label:"collided with actor name",value:"string",func:"valuePhysicsCollidedWithName",
readName:"Collided With Actor Name",concept:"advanced physics",tags:["value"]},valuePhysicsTouchingActor:{cat:"physics",omitbg:!0,hidden:!1,label:"is touching {where}?",value:"string",func:"valuePhysicsTouchingActor",readName:"Touching With Actor Name",concept:"advanced physics",tags:["value"]},blockPhysicsApplyForce:{cat:"physics",omitbg:!0,hidden:!1,label:"apply force {number:0}",func:"blockPhysicsApplyForce",readName:"Apply Force",concept:"expert physics"},blockPhysicsApplyImpulse:{cat:"physics",
omitbg:!0,hidden:!1,label:"apply impulse {number:0}",func:"blockPhysicsApplyImpulse",readName:"Apply Impulse",concept:"expert physics"},blockPhysicsApplyForceAngle:{cat:"physics",omitbg:!0,hidden:!1,label:"apply force {number:0} at{number:0} degrees",func:"blockPhysicsApplyForceAngle",readName:"Apply Force At Degrees",concept:"expert physics"},blockPhysicsApplyImpulseAngle:{cat:"physics",omitbg:!0,hidden:!1,label:"apply impulse {number:0} at {number:0} degrees",func:"blockPhysicsApplyImpulseAngle",
readName:"Apply Impulse At Degrees",concept:"expert physics"},blockPhysicsApplyForceXY:{cat:"physics",omitbg:!0,hidden:!1,label:"apply force x:{number:0} y:{number:0}",func:"blockPhysicsApplyForceXY",readName:"Apply Horizontal and Vertical Force",concept:"expert physics"},blockPhysicsApplyImpulseXY:{cat:"physics",omitbg:!0,hidden:!1,label:"apply impulse x:{number:0} y:{number:0}",func:"blockPhysicsApplyImpulseXY",readName:"Apply Horizontal And Vertical Impulse",concept:"expert physics"},blockPhysicsApplyTorque:{cat:"physics",
omitbg:!0,hidden:!1,label:"apply torque {number:0}",func:"blockPhysicsApplyTorque",readName:"Apply Torque",concept:"expert physics"},blockPhysicsSetActive:{cat:"physics",hidden:!1,label:"set active {boolean}",func:"blockPhysicsSetActive",readName:"Set Active",concept:"expert physics"},blockPhysicsSetStatic:{cat:"physics",omitbg:!1,hidden:!1,label:"set static {boolean}",func:"blockPhysicsSetStatic",readName:"Set Static",concept:"expert physics"},blockPhysicsSetGeometry:{cat:"physics",omitbg:!1,hidden:!1,
label:"set shape to {choice:geometry}",func:"blockPhysicsSetGeometry",readName:"Set Shape To",concept:"expert physics"},blockPhysicsSetDensity:{cat:"physics",hidden:!1,label:"set density to {number:10}",func:"blockPhysicsSetDensity",readName:"Set Density To",concept:"expert physics"},blockPhysicsSetFriction:{cat:"physics",hidden:!1,label:"set friction to {number:0.5}",func:"blockPhysicsSetFriction",readName:"Set Friction To",concept:"expert physics"},blockPhysicsSetRestitution:{cat:"physics",hidden:!1,
label:"set restitution to {number:0.2}",func:"blockPhysicsSetRestitution",readName:"Set Restitution To",concept:"expert physics"},blockPhysicsSetAngularDamping:{cat:"physics",omitbg:!1,hidden:!1,label:"set angular damping to {number:0}",func:"blockPhysicsSetAngularDamping",readName:"Set Angular Damping To",concept:"expert physics"},blockPhysicsSetAngularVelocity:{cat:"physics",omitbg:!1,hidden:!1,label:"set angular velocity to {number:0}",func:"blockPhysicsSetAngularVelocity",readName:"Set Angular Velocity To",
concept:"expert physics"},blockPhysicsSetLinearDamping:{cat:"physics",omitbg:!1,hidden:!1,label:"set linear damping to {number:0}",func:"blockPhysicsSetLinearDamping",readName:"Set Linear Damping To",concept:"expert physics"},blockPhysicsSetLinearVelocity:{cat:"physics",omitbg:!1,hidden:!1,label:"set linear velocity to {number:0}",func:"blockPhysicsSetLinearVelocity",readName:"Set Linear Velocity To",concept:"expert physics"},blockPhysicsSetLinearVelocityXY:{cat:"physics",omitbg:!1,hidden:!1,label:"set linear velocity to x:{number:0} y:{number:0}",
func:"blockPhysicsSetLinearVelocityXY",readName:"Set Linear Velocity To",concept:"expert physics"},valuePhysicsDensity:{cat:"physics",watchable:!0,omitbg:!1,hidden:!1,label:"density",value:"number",func:"valuePhysicsDensity",readName:"Density",concept:"expert physics",tags:["value"]},valuePhysicsFriction:{cat:"physics",watchable:!0,omitbg:!1,hidden:!1,label:"friction",value:"number",func:"valuePhysicsFriction",readName:"Friction",concept:"expert physics",tags:["value"]},valuePhysicsRestitution:{cat:"physics",
watchable:!0,omitbg:!1,hidden:!1,label:"restitution",value:"number",func:"valuePhysicsRestitution",readName:"Restitution",concept:"expert physics",tags:["value"]},valuePhysicsAngularVelocity:{cat:"physics",watchable:!0,omitbg:!0,hidden:!1,label:"angular velocity",value:"number",func:"valuePhysicsAngularVelocity",readName:"Angular Velocity",concept:"expert physics",tags:["value"]},valuePhysicsInertia:{cat:"physics",watchable:!0,omitbg:!0,hidden:!1,label:"inertia",value:"number",func:"valuePhysicsInertia",
readName:"Inertia",concept:"expert physics",tags:["value"]},valuePhysicsIsAwake:{cat:"physics",watchable:!0,omitbg:!0,hidden:!1,label:"is awake?",value:"boolean",func:"valuePhysicsIsAwake",readName:"Is Awake?",concept:"expert physics",tags:["value"]},valuePhysicsIsActive:{cat:"physics",watchable:!0,omitbg:!1,hidden:!1,label:"is active?",value:"boolean",func:"valuePhysicsIsActive",readName:"Is Active?",concept:"expert physics",tags:["value"]},valuePhysicsXVelocity:{cat:"physics",watchable:!0,omitbg:!0,
hidden:!1,label:"x linear velocity",value:"number",func:"valuePhysicsXVelocity",readName:"X Linear Velocity",concept:"expert physics",tags:["value"]},valuePhysicsYVelocity:{cat:"physics",watchable:!0,omitbg:!0,hidden:!1,label:"y linear velocity",value:"number",func:"valuePhysicsYVelocity",readName:"Y Linear Velocity",concept:"expert physics",tags:["value"]},valuePhysicsAngularDamping:{cat:"physics",watchable:!0,omitbg:!0,hidden:!1,label:"angular damping",value:"number",func:"valuePhysicsAngularDamping",
readName:"Angular Damping",concept:"expert physics",tags:["value"]},valuePhysicsLinearDamping:{cat:"physics",watchable:!0,omitbg:!0,hidden:!1,label:"linear damping",value:"number",func:"valuePhysicsLinearDamping",readName:"Linear Damping",concept:"expert physics",tags:["value"]},blockPhysicsSetGravity:{cat:"physics",label:"set gravity to {number:0} by {number:10}",hidden:!1,func:"blockPhysicsSetGravity",readName:"Set Gravity To",concept:"advanced physics"},valuePhysicsXGravity:{cat:"physics",watchable:!0,
hidden:!1,label:"X Gravity",value:"number",func:"valuePhysicsXGravity",readName:"X Gravity",concept:"expert physics",tags:["value"]},valuePhysicsYGravity:{cat:"physics",watchable:!0,hidden:!1,label:"Y Gravity",value:"number",func:"valuePhysicsYGravity",readName:"Y Gravity",concept:"expert physics",tags:["value"]},blockPhysicsStart:{cat:"physics",label:"start physics",func:"blockPhysicsStart",readName:"Start Physics",concept:"basic physics"},blockPhysicsStop:{cat:"physics",label:"stop physics",func:"blockPhysicsStop",
readName:"Stop Physics",concept:"basic physics"},blockVarPropSet:{cat:"var",label:"set {properties} of {actor} to {string:0}",func:"blockVarPropSet",readName:"Set Property To",concept:"actor properties",tags:["value","property","properties"]},valueVarPropGet:{cat:"var",label:"property {properties} of {actor}",value:"string",func:"valueVarPropGet",readName:"Property Of",concept:"actor properties",tags:["value","property","properties"]},blockVarSet:{cat:"var",label:"set {variables} to {string:0}",func:"blockVarSet",
readName:"Set Variable To",concept:"simple variables",tags:["variable","variables"]},blockVarChangeBy:{cat:"var",label:"change {variables} by {number:1}",func:"blockVarChangeBy",readName:"Change Variable By",concept:"simple variables",tags:["variable","variables"]},blockVarShow:{cat:"var",hidden:!0,label:"show variable {variables}",func:"blockVarShow",readName:"Show Variable",concept:"variable watchers",tags:["variable","variables"]},blockVarHide:{cat:"var",hidden:!0,label:"hide variable {variables}",
func:"blockVarHide",readName:"Hide Variable",concept:"variable watchers",tags:["variable","variables"]},blockListAdd:{cat:"list",label:"add {string:thing} {varargs} to {lists}",func:"blockListAdd",readName:"Add To List",concept:"lists",tags:["value","variable","variables"]},blockListDel:{cat:"list",label:"delete {choice:lastall} of {lists}",func:"blockListDel",readName:"Delete from List",concept:"lists",tags:["value","variable","variables"]},blockListInsert:{cat:"list",label:"insert {string:thing} {varargs} at {choice:lastany} of {lists}",
func:"blockListInsert",readName:"Insert At Of List",concept:"lists",tags:["value","variable","variables"]},blockListReplace:{cat:"list",label:"replace item {choice:lastany} of {lists} with {string:thing}",func:"blockListReplace",readName:"Replace Item Of List With",concept:"lists",tags:["value","variable","variables"]},valueListItem:{cat:"list",label:"item {choice:lastany} of {lists}",value:"string",func:"valueListItem",readName:"Item Of List",concept:"lists",tags:["value","variable","variables"]},
valueListLength:{cat:"list",label:"length of {lists}",value:"number",func:"valueListLength",readName:"Length Of List",concept:"lists",tags:["value","variable","variables"]},valueListContains:{cat:"list",label:"{lists} contains {string:thing}",value:"boolean",func:"valueListContains",readName:"List Contains",concept:"lists",tags:["value","variable","variables"]},blockObjDel:{cat:"obj",label:"delete {string}[{string:0}]",func:"blockObjDel",readName:"Delete Key",concept:"objects",tags:["value","variable",
"variables"]},blockObjSet:{cat:"obj",label:"set {string}[{string:0}] = {string}",func:"blockObjSet",readName:"Set To Item",concept:"objects",tags:["value","variable","variables"]},valueObjGet:{cat:"obj",label:"get {string}[{string:0}]",value:"object",func:"valueObjGet",readName:"Get Item",concept:"objects",tags:["value","variable","variables"]},valueObjLength:{cat:"obj",label:"length of {string}",value:"number",func:"valueObjLength",readName:"Length Of List",concept:"objects",tags:["value","variable",
"variables"]},valueObjKeys:{cat:"obj",label:"keys of {string}",value:"object",func:"valueObjKeys",readName:"Keys Of",concept:"objects",tags:["value","variable","variables"]},valueObjValues:{cat:"obj",label:"values of {string}",value:"object",func:"valueObjValues",readName:"Values Of",concept:"objects",tags:["value","variable","variables"]},valueListNew:{cat:"obj",label:"new list",value:"object",func:"valueListNew",readName:"New List",concept:"lists",tags:["value","variable","variables"]},valueObjNew:{cat:"obj",
label:"new object",value:"object",func:"valueObjNew",readName:"New Object",concept:"lists",tags:["value","variable","variables"]},blockNetworkSaveValue:{cat:"network",hidden:!0,label:"save {string:value} as {string:name} for {choice:permissions}",func:"blockNetworkSaveValue",readName:"Network",concept:"networking",tags:["network","networking"]},blockNetworkLoadValue:{cat:"network",hidden:!0,label:"read {string:name} into {variables}",func:"blockNetworkLoadValue",readName:"Network",concept:"networking",
tags:["network","networking"]},blockNetworkAPI:{cat:"network",hidden:!0,label:"network {string} {varargs}",func:"blockNetworkAPI",readName:"Network",concept:"networking",tags:["network","networking"]},valueNetworkParse:{cat:"network",hidden:!0,label:"parse data {string}",value:"object",func:"valueNetworkParse",readName:"Parse Network Object",concept:"networking",tags:["network","networking"]},valueNetworkResult:{cat:"network",hidden:!0,label:"network result",value:"object",func:"valueNetworkResult",
readName:"Network Result",concept:"networking",tags:["network","networking"]},blockParticleEmitStart:{cat:"particles",hidden:!0,label:"start emit particles",func:"blockParticleEmitStart",readName:"emit particles",concept:"particles",tags:["particle"]},blockParticleEmitStop:{cat:"particles",hidden:!0,label:"stop emit particles",func:"blockParticleEmitStop",readName:"stop particles",concept:"particles",tags:["particle"]},blockParticleSetRate:{cat:"particles",hidden:!0,label:"set emit rate to {number} particles per seconds",
func:"blockParticleSetRate",readName:"set emit rate",concept:"particles",tags:["particle"]},blockParticleSetVectorVelocity:{cat:"particles",hidden:!0,label:"set emit vector velocity X from {number} to {number}, Y from {number} to {number} ",func:"blockParticleSetVectorVelocity",readName:"set particle velocity",concept:"particles",tags:["particle"]},blockParticleSetRadialVelocity:{cat:"particles",hidden:!0,label:"set emit radial velocity from {number} to {number}, from {number} degrees to {number} degrees ",
func:"blockParticleSetRadialVelocity",readName:"set particle velocity",concept:"particles",tags:["particle"]},blockParticleSetLifetime:{cat:"particles",hidden:!0,label:"set particle lifetime to {number}",func:"blockParticleSetLifetime",readName:"set particle lifetime",concept:"particles",tags:["particle"]},blockParticleSetMass:{cat:"particles",hidden:!0,label:"set particle mass to {number}",func:"blockParticleSetMass",readName:"set particle mass",concept:"particles",tags:["particle"]},blockParticleSetGravity:{cat:"particles",
hidden:!0,label:"set particle gravity to {number}",func:"blockParticleSetGravity",readName:"set particle gravity",concept:"particles",tags:["particle"]},blockParticleSetAttraction:{cat:"particles",hidden:!0,label:"set particle attraction to force {number} with radius {number}",func:"blockParticleSetAttraction",readName:"set particle attraction",concept:"particles",tags:["particle"]},blockParticleSetRadius:{cat:"particles",hidden:!0,label:"set particle radius to {number}",func:"blockParticleSetRadius",
readName:"set particle radius",concept:"particles",tags:["particle"]},blockParticleSetColor:{cat:"particles",hidden:!0,label:"set particle color from {color:#ff0000} to {color:#ffff00}",func:"blockParticleSetColor",readName:"set particle color",concept:"particles",tags:["particle"]},blockParticleSetScale:{cat:"particles",hidden:!0,label:"set particle scaling from {number:1} to {number:.1}",func:"blockParticleSetScale",readName:"set particle scaling",concept:"particles",tags:["particle"]},blockParticleSetAlpha:{cat:"particles",
hidden:!0,label:"set particle alpha from {number:1} to {number:.1}",func:"blockParticleSetAlpha",readName:"set particle alpha",concept:"particles",tags:["particle"]},blockParticleSetImage:{cat:"particles",hidden:!0,label:"set particle image to {choice:particleimg}",func:"blockParticleSetImage",readName:"set particle image",concept:"particles",tags:["particle"]},registerMCPECommand:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} /wsserver command {string}",func:"registerMCPECommand",
readName:"command",concept:"Minecraft PE"},registerMCPEEventChat:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when receive chat {param:message}",func:"registerMCPEEventChat",readName:"command",concept:"Minecraft PE"},registerMCPEEventTell:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when receive tell {param:message}",func:"registerMCPEEventTell",readName:"command",concept:"Minecraft PE"},registerMCPEEventDied:{cat:"mcpe",hidden:!0,hasFlap:!1,
label:"{image:ide/imgs/button-grass.png} when player dies",func:"registerMCPEEventDied",readName:"command",concept:"Minecraft PE"},registerMCPEEventPlayer:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when player travels {param:traveltype}",func:"registerMCPEEventPlayer",readName:"command",concept:"Minecraft PE"},registerMCPEEventTeleported:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when player teleported",func:"registerMCPEEventTeleported",
readName:"command",concept:"Minecraft PE"},registerMCPEEventBounced:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when player bounced",func:"registerMCPEEventBounced",readName:"command",concept:"Minecraft PE"},registerMCPEEventBlockPlaced:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when block {block:stone} placed",func:"registerMCPEEventBlockPlaced",readName:"command",concept:"Minecraft PE"},registerMCPEEventBlockBrokenAny:{cat:"mcpe",hidden:!0,
hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when {param:block} broken",func:"registerMCPEEventBlockBrokenAny",readName:"command",concept:"Minecraft PE"},registerMCPEEventMobKilled:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when mob {entityType:chicken} killed",func:"registerMCPEEventMobKilled",readName:"command",concept:"Minecraft PE"},registerMCPEEventMobKilledAny:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when {param:mob} killed",
func:"registerMCPEEventMobKilled",readName:"command",concept:"Minecraft PE"},registerMCPEEventEntitySpawned:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when mob {entityType:chicken} spawned",func:"registerMCPEEventEntitySpawned",readName:"command",concept:"Minecraft PE"},registerMCPEEventEntitySpawnedAny:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when {param:mob} spawned",func:"registerMCPEEventEntitySpawned",readName:"command",concept:"Minecraft PE"},
registerMCPEEventItemAcquired:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when item {inventory:apple} is acquired",func:"registerMCPEEventItemAcquired",readName:"command",concept:"Minecraft PE"},registerMCPEEventItemAcquiredAny:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when {param:item} is acquired",func:"registerMCPEEventItemAcquiredAny",readName:"command",concept:"Minecraft PE"},registerMCPEEventItemDropped:{cat:"mcpe",hidden:!0,hasFlap:!1,
label:"{image:ide/imgs/button-grass.png} when item {inventory:apple} is dropped",func:"registerMCPEEventItemDropped",readName:"command",concept:"Minecraft PE"},registerMCPEEventItemDroppedAny:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when {param:item} is dropped",func:"registerMCPEEventItemDroppedAny",readName:"command",concept:"Minecraft PE"},registerMCPEEventItemUsed:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when item {inventory:bow} is used",
func:"registerMCPEEventItemUsed",readName:"command",concept:"Minecraft PE"},registerMCPEEventItemUsedAny:{cat:"mcpe",hidden:!0,hasFlap:!1,label:"{image:ide/imgs/button-grass.png} when item {param:item} is used",func:"registerMCPEEventItemUsedAny",readName:"command",concept:"Minecraft PE"},blockMCPEBotStart:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} start TynkerBot buffer",func:"blockMCPEBotStart"},blockMCPEBotFlush:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} run TynkerBot buffer",
func:"blockMCPEBotFlush"},blockMCPEBotClear:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} clear TynkerBot buffer",func:"blockMCPEBotClear"},blockMCPEBotMoveBy:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} move TynkerBot by x:{number:0} y:{number:0} z:{number:0}",func:"blockMCPEBotMoveBy"},blockMCPEBotMoveTo:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} move TynkerBot to x:{number:0} y:{number:0} z:{number:0}",func:"blockMCPEBotMoveTo"},blockMCPEBotMoveToPlayer:{cat:"mcpe",
hidden:!0,label:"{image:ide/imgs/button-grass.png} move TynkerBot to player",func:"blockMCPEBotMoveToPlayer"},blockMCPEBotTestForBlock:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} test for block {block:stone} at TynkerBot",func:"blockMCPEBotTestForBlock"},valueMCPEResult:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} query result",value:"object",func:"valueMCPEResult",readName:"Result",concept:"Minecraft PE"},blockMCPEBotMove:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} move TynkerBot {choice:mcpebotdir} by {number:1} blocks",
func:"blockMCPEBotMove"},blockMCPEBotTurnLeft:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} turn TynkerBot left",func:"blockMCPEBotTurnLeft"},blockMCPEBotTurnRight:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} turn TynkerBot right",func:"blockMCPEBotTurnRight"},blockMCPEBotPointDirection:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} point TynkerBot towards {cardinaldirection:south}",func:"blockMCPEBotPointDirection"},blockMCPEBotSaveCheckpoint:{cat:"mcpe",
hidden:!0,label:"{image:ide/imgs/button-grass.png} save TynkerBot checkpoint as {string}",func:"blockMCPEBotSaveCheckpoint"},blockMCPEBotRestoreCheckpoint:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} go to TynkerBot checkpoint named {string}",func:"blockMCPEBotRestoreCheckpoint"},blockMCPEBotPlaceBlock:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} place block {block:stone} at TynkerBot",func:"blockMCPEBotPlaceBlock"},blockMCPEBotBox:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} build {choice:mcpefill} box at TynkerBot using {block:stone} with\nwidth:{number:1} height:{number:1} depth:{number:1}",
func:"blockMCPEBotBox"},blockMCPEBotSummon:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} summon {entityType:chicken} at TynkerBot",func:"blockMCPEBotSummon"},blockMCPEBotTeleport:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} teleport {choice:mcpeplayer:nearest player} to TynkerBot",func:"blockMCPEBotTeleport"},blockMCPEEnchant:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} enchant {choice:mcpeplayer:nearest player} with {string:mcpeenchantment}",
func:"blockMCPEEnchant",readName:"enchant",concept:"Minecraft PE"},blockMCPEGive:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} give {inventory:apple} to {choice:mcpeplayer:nearest player}",func:"blockMCPEGive",readName:"give item",concept:"Minecraft PE"},blockMCPETeleport:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} teleport {choice:mcpeplayer:nearest player} to {number:x},{number:y},{number:z}",func:"blockMCPETeleport",readName:"teleport",concept:"Minecraft PE"},
blockMCPESetTime:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} set time to {number:0}",func:"blockMCPESetTime",readName:"set time",concept:"Minecraft PE"},blockMCPEKill:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} kill {choice:mcpeplayer:nearest player}",func:"blockMCPEKill",readName:"kill player",concept:"Minecraft PE"},blockMCPEGameMode:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} set game mode to {choice:mcpegamemode:creative}",func:"blockMCPEGameMode",
readName:"set game mode",concept:"Minecraft PE"},blockMCPESay:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} say {string:message} {varargs}",func:"blockMCPESay",readName:"say",concept:"Minecraft PE"},blockMCPETell:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} tell {string:message}  {varargs} to {choice:mcpeplayer:nearest player}",func:"blockMCPETell",readName:"tell player",concept:"Minecraft PE"},blockMCPESetWeather:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} set weather to {choice:mcpeweather:clear}",
func:"blockMCPESetWeather",readName:"set weather",concept:"Minecraft PE"},blockMCPESummon:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} summon {entityType:chicken} at {number:x},{number:y},{number:z}",func:"blockMCPESummon",readName:"summon",concept:"Minecraft PE"},blockMCPEExecute:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} execute {string}",func:"blockMCPEExecute",readName:"execute",concept:"Minecraft PE"},blockMCPEFillBlock:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} fill {number:x},{number:y},{number:z} to {number:x},{number:y},{number:z} with {block:stone}",
func:"blockMCPEFillBlock",readName:"fill blocks",concept:"Minecraft PE"},blockMCPESetBlock:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} set block {block:stone} at {number:x},{number:y},{number:z}",func:"blockMCPESetBlock",readName:"set block",concept:"Minecraft PE"},blockMCPEAgentMove:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} agent move {choice:mcpebotdir}",func:"blockMCPEAgentMove",readName:"move",concept:"Minecraft PE"},blockMCPEAgentTurn:{cat:"mcpe",hidden:!0,
label:"{image:ide/imgs/button-grass.png} agent turn {choice:mcpedir}",func:"blockMCPEAgentTurn",readName:"turn",concept:"Minecraft PE"},blockMCPEAgentPlace:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} agent place {choice:mcpebotdir} from slot {number:1}",func:"blockMCPEAgentPlace",readName:"turn",concept:"Minecraft PE"},blockMCPEAgentDetect:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} agent detect {choice:mcpebotdir}",func:"blockMCPEAgentDetect",readName:"detect",
concept:"Minecraft PE"},blockMCPEAgentAttack:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} agent attack {choice:mcpebotdir}",func:"blockMCPEAgentAttack",readName:"attack",concept:"Minecraft PE"},blockMCPEAgentDestroy:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} agent destroy {choice:mcpebotdir}",func:"blockMCPEAgentDestroy",readName:"destroy",concept:"Minecraft PE"},blockMCPEAgentCollect:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} agent collect {inventory:apple}",
func:"blockMCPEAgentCollect",readName:"attack",concept:"Minecraft PE"},blockMCPEAgentTill:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} agent till {choice:mcpebotdir}",func:"blockMCPEAgentTill",readName:"attack",concept:"Minecraft PE"},blockMCPEAgentDropall:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} agent drop {choice:mcpebotdir}",func:"blockMCPEAgentDropall",readName:"attack",concept:"Minecraft PE"},blockMCPEAgentTeleport:{cat:"mcpe",hidden:!0,label:"{image:ide/imgs/button-grass.png} agent teleport to player",
func:"blockMCPEAgentTeleport",readName:"teleport",concept:"Minecraft PE"},blockMCPESetBlocks:{cat:"nop",hidden:!0,label:"deprecated: set blocks {object:list of blocks}",func:"blockMCPESetBlocks",readName:"Set Block List",concept:"Minecraft PE"},valueMCPEBlockExists:{value:"string",cat:"nop",hidden:!0,label:"deprecated: does block {block:stone} exist at {number:x},{number:y},{number:z}",func:"valueMCPEBlockExists",readName:"test block exists",concept:"Minecraft PE"},valueMCPEBlockExistsWithin:{value:"string",
cat:"nop",hidden:!0,label:"deprecated: does block {block:stone} exist within {number:x},{number:y},{number:z} to {number:x},{number:y},{number:z}",func:"valueMCPEBlockExistsWithin"},valueMCPEItemType:{cat:"mcpe",value:"string",hidden:!0,label:"{image:ide/imgs/button-grass.png} item {inventory:apple}",func:"valueMCPEItemType",readName:"item",concept:"Minecraft PE"},valueMCPEBlockType:{cat:"mcpe",value:"string",hidden:!0,label:"{image:ide/imgs/button-grass.png} block {block:stone}",func:"valueMCPEBlockType",
readName:"block",concept:"Minecraft PE"},valueMCPEMobType:{cat:"mcpe",value:"string",hidden:!0,label:"{image:ide/imgs/button-grass.png} mob {entityType:chicken}",func:"valueMCPEMobType",readName:"mob",concept:"Minecraft PE"},blockSpheroSetSpeed:{cat:"hardware",label:"{image:ide/imgs/button-sphero.png} set speed to {number:50}%",func:"blockSpheroSetSpeed",readName:"Set Speed To",concept:"ground control"},blockSpheroRoll:{cat:"hardware",label:"{image:ide/imgs/button-sphero.png} roll for {number:1} seconds",
func:"blockSpheroRoll",readName:"Roll For",concept:"ground control"},blockSpheroStop:{cat:"hardware",label:"{image:ide/imgs/button-sphero.png} stop moving",func:"blockSpheroStop",readName:"Stop Moving",concept:"ground control"},blockSpheroTurnCW:{cat:"hardware",label:"{image:ide/imgs/button-sphero.png} turn right by {angle:90} degrees",func:"blockSpheroTurnCW",readName:"Turn Clockwise",concept:"ground control"},blockSpheroTurnCCW:{cat:"hardware",label:"{image:ide/imgs/button-sphero.png} turn left by {angle:90} degrees",
func:"blockSpheroTurnCCW",readName:"Turn Counter-Clockwise",concept:"ground control"},blockSpheroHeading:{cat:"hardware",label:"{image:ide/imgs/button-sphero.png} set heading to {angle:0} degrees",func:"blockSpheroHeading",readName:"Set Heading To",concept:"ground control"},blockSpheroColor:{cat:"hardware",label:"{image:ide/imgs/button-sphero.png} set color to {color}",func:"blockSpheroColor",readName:"Set Color To",concept:"ground control"},valueSpheroConnected:{cat:"hardware",value:"boolean",
label:"{image:ide/imgs/button-sphero.png} is connected?",func:"valueSpheroConnected",readName:"Connected?",concept:"ground control"},valueSpheroHeading:{cat:"hardware",value:"number",label:"{image:ide/imgs/button-sphero.png} heading",func:"valueSpheroHeading",readName:"Heading",concept:"ground control"},valueSpheroSpeed:{cat:"hardware",value:"number",label:"{image:ide/imgs/button-sphero.png} speed",func:"valueSpheroSpeed",readName:"Speed",concept:"ground control"},valueSpheroProperty:{cat:"hardware",
value:"number",label:"{image:ide/imgs/button-sphero.png} get property {spheroprop}",func:"valueSpheroProperty",readName:"Get Property",concept:"ground control"},valueSpheroOdometer:{cat:"hardware",value:"number",label:"{image:ide/imgs/button-sphero.png} odometer",func:"valueSpheroOdometer",readName:"Odometer",concept:"ground control"},valueSpheroCollidedSinceLastCheck:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-sphero.png} collided since last check?",func:"valueSpheroCollidedSinceLastCheck",
readName:"Collided Since Last Check",concept:"ground control"},registerHardwareTrigger:{cat:"hardware",label:"{image:ide/imgs/button-sphero.png} when I collide",hasFlap:!1,func:"registerHardwareTrigger",readName:"When I Collide",concept:"ground control",tags:["hat block","collision"]},blockSpheroSetStabilization:{cat:"hardware",label:"{image:ide/imgs/button-sphero.png} set stabilization {boolean}",func:"blockSpheroSetStabilization",readName:"Set Stabilization",concept:"ground control"},blockSpheroSet:{cat:"hardware",
label:"{image:ide/imgs/button-sphero.png} set {spherosetnumericprop} to {number}",func:"blockSpheroSet",readName:"Set",concept:"ground control"},blockDroneTakeOff:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} take off",func:"blockDroneTakeOff",readName:"Take Off",concept:"flight control"},blockDroneLand:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} land",func:"blockDroneLand",readName:"Land",concept:"flight control"},blockDroneStop:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} stop",
func:"blockDroneStop",readName:"Stop",concept:"flight control"},blockDroneEmergency:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} emergency",func:"blockDroneEmergency",readName:"Emergency",concept:"flight control"},blockDroneSetSpeed:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} set speed to {number:50}%",func:"blockDroneSetSpeed",readName:"Set Speed To",concept:"flight control"},blockDroneForward:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} forward for {number:1} seconds",
func:"blockDroneForward",readName:"Go Forward For",concept:"flight control"},blockDroneBackward:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} backward for {number:1} seconds",func:"blockDroneBackward",readName:"Go Backward For",concept:"flight control"},blockDroneLeft:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} left for {number:1} seconds",func:"blockDroneLeft",readName:"Go Left For",concept:"flight control"},blockDroneRight:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} right for {number:1} seconds",
func:"blockDroneRight",readName:"Go Right For",concept:"flight control"},blockDroneTurnCW:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} turn right by {angle:90} degrees",func:"blockDroneTurnCW",readName:"Turn Right",concept:"flight control"},blockDroneTurnCCW:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} turn left by {angle:90} degrees",func:"blockDroneTurnCCW",readName:"Turn Left",concept:"flight control"},blockDroneAnimation:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} flip {droneanimations:flip forward}",
func:"blockDroneAnimation",readName:"Flip",concept:"flight control"},blockDroneUp:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} up for {number:1} seconds",func:"blockDroneUp",readName:"Go Up For",concept:"flight control"},blockDroneDown:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} down for {number:1} seconds",func:"blockDroneDown",readName:"Go Down For",concept:"flight control"},valueDroneConnected:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-drone.png} is connected?",
func:"valueDroneConnected",readName:"Connected?",concept:"flight control"},blockDroneStartUp:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} start moving up",func:"blockDroneStartUp",readName:"Start Moving Up",concept:"flight control"},blockDroneStartDown:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} start moving down",func:"blockDroneStartDown",readName:"Start Moving Down",concept:"flight control"},blockDroneStartRotateLeft:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} start rotating left",
func:"blockDroneStartRotateLeft",readName:"Start Rotating Left",concept:"flight control"},blockDroneStartRotateRight:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} start rotating right",func:"blockDroneStartRotateRight",readName:"Start Rotating Right",concept:"flight control"},blockDroneTakePicture:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} take picture",func:"blockDroneTakePicture",readName:"Take Picture",concept:"flight control"},blockDroneFetchPicture:{cat:"hardware",
label:"{image:ide/imgs/button-drone.png} fetch picture from drone",func:"blockDroneFetchPicture",readName:"Fetch Picture From Drone",concept:"flight control"},blockDroneDeletePicture:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} delete picture on drone",func:"blockDroneDeletePicture",readName:"Delete Picture On Drone",concept:"flight control"},blockDroneDeleteAllPictures:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} delete all pictures",func:"blockDroneDeleteAllPictures",
readName:"Delete All Pictures",concept:"flight control"},blockDroneVarSetNumPictures:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} set {variables} to number of pictures on drone",func:"blockDroneVarSetNumPictures",readName:"Set Variable to Number of Pictures on Drone",concept:"flight control"},blockDroneSetProductName:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} set drone name to {string:My Drone}",func:"blockDroneSetProductName",readName:"Set Drone Name",concept:"flight control"},
valueDroneHasGrabber:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-drone.png} has grabber?",func:"valueDroneHasGrabber",readName:"Has Grabber?",concept:"flight control"},blockDroneControlGrabber:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} {grabbercmd:close} grabber",func:"blockDroneControlGrabber",readName:"Control Grabber",concept:"flight control"},valueDroneHasCannon:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-drone.png} has cannon?",func:"valueDroneHasCannon",
readName:"Has Cannon?",concept:"flight control"},blockDroneControlCannon:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} fire cannon",func:"blockDroneControlCannon",readName:"Control Cannon",concept:"flight control"},blockDroneSetFlyingMode:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} set flying mode {flyingmode:quadcopter}",func:"blockDroneSetFlyingMode",readName:"Set Flying Mode",concept:"flight control"},blockDroneSetPlaneSpeed:{cat:"hardware",label:"{image:ide/imgs/button-drone.png} set plane speed {planespeed:low}",
func:"blockDroneSetPlaneSpeed",readName:"Set Plane Speed",concept:"flight control"},blockJumpingSumoStop:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} stop",func:"blockJumpingSumoStop",readName:"Stop",concept:"ground control"},blockJumpingSumoEmergency:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} emergency",func:"blockJumpingSumoEmergency",readName:"Emergency",concept:"ground control"},blockJumpingSumoJump:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} jump {jumpingsumojumps:long}",
func:"blockJumpingSumoJump",readName:"Jump",concept:"ground control"},blockJumpingSumoAnimation:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} perform {jumpingsumoanimations:spin}",func:"blockJumpingSumoAnimation",readName:"Perform",concept:"ground control"},blockJumpingSumoForward:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} forward for {number:1} seconds",func:"blockJumpingSumoForward",readName:"Go Forward For",concept:"ground control"},blockJumpingSumoBackward:{cat:"hardware",
label:"{image:ide/imgs/button-jumpingsumo.png} backward for {number:1} seconds",func:"blockJumpingSumoBackward",readName:"Go Backward For",concept:"ground control"},blockJumpingSumoTurnCW:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} turn right by {number:90} degrees",func:"blockJumpingSumoTurnCW",readName:"Turn Right",concept:"ground control"},blockJumpingSumoTurnCCW:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} turn left by {number:90} degrees",func:"blockJumpingSumoTurnCCW",
readName:"Turn Left",concept:"ground control"},blockJumpingSumoSetSpeed:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} set drive speed to {number:50}",func:"blockJumpingSumoSetSpeed",readName:"Set Speed To",concept:"ground control"},blockJumpingSumoSetTurn:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} set turn rate to {number:50}",func:"blockJumpingSumoSetTurn",readName:"Set Turn To",concept:"ground control"},blockJumpingSumoMove:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} drive and turn for {number:1} seconds",
func:"blockJumpingSumoMove",readName:"Move",concept:"ground control"},blockJumpingSumoStart:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} start",func:"blockJumpingSumoStart",readName:"Start",concept:"ground control"},blockJumpingSumoPose:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} pose {jumpingsumopositions:balancing}",func:"blockJumpingSumoPose",readName:"Pose",concept:"ground control"},blockJumpingSumoSetVolume:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} set volume to {number:50}",
func:"blockJumpingSumoSetVolume",readName:"Set Volume To",concept:"ground control"},blockJumpingSumoSetAudioTheme:{cat:"hardware",label:"{image:ide/imgs/button-jumpingsumo.png} set audio theme to {jumpingsumoaudiotheme:default}",func:"blockJumpingSumoSetAudioTheme",readName:"Set Audio Theme To",concept:"ground control"},blockWedo2RunMotorFor:{cat:"hardware",label:"{image:ide/imgs/button-wedo2.png}run motor for {number:1} seconds",func:"blockWedo2RunMotorFor",readName:"Run Motor For",concept:"lego control"},
blockWedo2SetMotorPower:{cat:"hardware",label:"{image:ide/imgs/button-wedo2.png}set motor power {number:50}",func:"blockWedo2SetMotorPower",readName:"Set Motor Power",concept:"lego control"},blockWedo2SetMotorDirection:{cat:"hardware",label:"{image:ide/imgs/button-wedo2.png}set motor direction {wedo2motordirection:clockwise}",func:"blockWedo2SetMotorDirection",readName:"Set Motor Direction",concept:"lego control"},blockWedo2MotorOn:{cat:"hardware",label:"{image:ide/imgs/button-wedo2.png}start motor",
func:"blockWedo2MotorOn",readName:"Start Motor",concept:"lego control"},blockWedo2MotorOff:{cat:"hardware",label:"{image:ide/imgs/button-wedo2.png}stop motor",func:"blockWedo2MotorOff",readName:"Stop Motor",concept:"lego control"},blockWedo2MotorDrift:{cat:"hardware",label:"{image:ide/imgs/button-wedo2.png}drift motor",func:"blockWedo2MotorDrift",readName:"Drift Motor",concept:"lego control"},valueWedo2MotorPower:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-wedo2.png}motor power",
func:"valueWedo2MotorPower",readName:"Motor Power",concept:"lego control"},valueWedo2MotorDirection:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-wedo2.png}motor direction",func:"valueWedo2MotorDirection",readName:"Motor Direction",concept:"lego control"},valueWedo2ConnectedTo:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-wedo2.png}connected to {wedo2sensorormotor:motor}?",func:"valueWedo2ConnectedTo",readName:"Connected To",concept:"lego control"},blockWedo2SetLightColor:{cat:"hardware",
label:"{image:ide/imgs/button-wedo2.png}set light color {number:1}",func:"blockWedo2SetLightColor",readName:"Set Light Color",concept:"lego control"},valueWedo2TiltSensorDirection:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-wedo2.png}tilt direction",func:"valueWedo2TiltSensorDirection",readName:"Tilt Direction",concept:"lego control"},blockWedo2SetTiltSensorMode:{cat:"hardware",label:"{image:ide/imgs/button-wedo2.png}set tilt sensor mode {wedo2tiltsensormode:direction}",func:"blockWedo2SetTiltSensorMode",
readName:"Set Tilt Sensor Mode",concept:"lego control"},valueWedo2TiltSensorMode:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-wedo2.png}tilt sensor mode",func:"valueWedo2TiltSensorMode",readName:"Tile Sensor Mode",concept:"lego control"},valueWedo2TiltSensorAngle:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-wedo2.png}tilt angle {wedo2tiltsensorangle:x}",func:"valueWedo2TiltSensorAngle",readName:"Tilt Angle",concept:"lego control"},valueWedo2TiltSensorBumpCount:{cat:"hardware",
value:"boolean",label:"{image:ide/imgs/button-wedo2.png}tilt bump count {wedo2tiltbumpdirection:x}",func:"valueWedo2TiltSensorBumpCount",readName:"Tilt Bump Count",concept:"lego control"},blockWedo2SensorReset:{cat:"hardware",label:"{image:ide/imgs/button-wedo2.png}reset {wedo2resettablesensor:tilt sensor}",func:"blockWedo2SensorReset",readName:"Reset Sensor",concept:"lego control"},valueWedo2MotionSensorDistance:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-wedo2.png}distance",
func:"valueWedo2MotionSensorDistance",readName:"Distance",concept:"lego control"},blockWedo2SetMotionSensorMode:{cat:"hardware",label:"{image:ide/imgs/button-wedo2.png}set motion sensor mode {wedo2motionsensormode:distance}",func:"blockWedo2SetMotionSensorMode",readName:"Set Motion Sensor Mode",concept:"lego control"},valueWedo2MotionSensorMode:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-wedo2.png}motion sensor mode",func:"valueWedo2MotionSensorMode",readName:"Motion Sensor Mode",
concept:"lego control"},valueWedo2MotionSensorCount:{cat:"hardware",value:"boolean",label:"{image:ide/imgs/button-wedo2.png}motion sensor count",func:"valueWedo2MotionSensorCount",readName:"Motion Sensor Count",concept:"lego control"},blockWedo2PlayToneFor:{cat:"hardware",label:"{image:ide/imgs/button-wedo2.png}play tone with frequency {number:500} Hz for {number:1} secs",func:"blockWedo2PlayToneFor",readName:"Play Tone For",concept:"lego control"},blockWedo2StopTone:{cat:"hardware",label:"{image:ide/imgs/button-wedo2.png}stop playing tone",
func:"blockWedo2StopTone",readName:"Stop Playing Tone",concept:"lego control"},blockHueState:{cat:"hardware",label:"{image:ide/imgs/button-hue.png} turn on light {boolean}",func:"blockHueState",readName:"Turn On Light",concept:"home control"},valueHueState:{cat:"hardware",value:"number",label:"{image:ide/imgs/button-hue.png} is on?",func:"valueHueState",readName:"On?",concept:"home control"},blockHueColor:{cat:"hardware",label:"{image:ide/imgs/button-hue.png} set color to {color}",func:"blockHueColor",
readName:"Set Color To",concept:"home control"},blockHueSetHue:{cat:"hardware",label:"{image:ide/imgs/button-hue.png} set hue to {number:50}",func:"blockHueSetHue",readName:"Set Hue To",concept:"home control"},blockHueChangeHue:{cat:"hardware",label:"{image:ide/imgs/button-hue.png} change hue by {number:10}",func:"blockHueChangeHue",readName:"Change Hue By",concept:"home control"},blockHueBrightness:{cat:"hardware",label:"{image:ide/imgs/button-hue.png} set brightness to {number:100}",func:"blockHueBrightness",
readName:"Set Brightness To",concept:"home control"},valueHueBrightness:{cat:"hardware",value:"number",label:"{image:ide/imgs/button-hue.png} brightness",func:"valueHueBrightness",readName:"Brightness",concept:"home control"}},g_varBlocks=[g_steps.blockVarPropSet,g_steps.valueVarPropGet,g_steps.blockVarSet,g_steps.blockVarChangeBy],g_listBlocks=[g_steps.blockListAdd,g_steps.blockListDel,g_steps.blockListInsert,g_steps.blockListReplace,g_steps.valueListItem,g_steps.valueListLength,g_steps.valueListContains],
g_objBlocks=[g_steps.blockObjSet,g_steps.blockObjDel,g_steps.valueObjGet,g_steps.valueObjLength,g_steps.valueObjKeys,g_steps.valueObjValues,g_steps.valueListNew,g_steps.valueObjNew],g_palette=[{label:"Common",cat:"common",items:[g_steps.registerFlagTrigger,g_steps.registerKeyTrigger,g_steps.registerSpriteTrigger,g_steps.blockMotionMove,g_steps.blockMotionPointTowards,g_steps.blockMotionPointAngle,g_steps.blockMotionBounceOnEdge,g_steps.blockMotionGoTowards,g_steps.blockMotionTurnCW,g_steps.blockMotionTurnCCW,
g_steps.registerTrigger,g_steps.valueSensingTouchingSprite,g_steps.blockControlWait,g_steps.blockControlRepeat,g_steps.blockControlForever,g_steps.blockLooksNextCostume,g_steps.blockLooksSwitchCostume,g_steps.blockLooksShow,g_steps.blockLooksHide,g_steps.blockSoundPlayUntilDone,g_steps.blockLooksSayFor,g_steps.blockMotionRotationStyle,g_steps.valueSensingKeyPressed,g_steps.blockControlIf,g_steps.valueControlIfElse,g_steps.valueSensingMouseDown,g_steps.valueOpNot,g_steps.blockLooksChangeSizeBy,g_steps.blockLooksSetSize,
g_steps.blockMotionGlide,g_steps.blockMotionGoTo,g_steps.blockMotionChangeXBy,g_steps.blockMotionChangeYBy,g_steps.valueOpRandom,g_steps.blockAnimationSimpleSwitchCostume,g_steps.blockAnimationSimpleSwitchCostumeAndWait,g_steps.blockLooksChangeEffect,g_steps.blockLooksClearEffects,g_steps.blockPenDown,g_steps.blockPenUp,g_steps.blockPenSetColor,g_steps.blockPenSetSize,g_steps.blockPenClear,g_steps.blockPenStamp,g_steps.valueSensingTouchingColor,g_steps.blockInlineComment]},{label:"Events",cat:"events",
items:[{label:"Event Handlers",items:[g_steps.registerFlagTrigger,g_steps.registerSpriteTrigger,g_steps.registerKeyTrigger,g_steps.registerBroadcastTrigger,g_steps.registerTrigger,g_steps.registerCloned,g_steps.registerBackgroundChange]},{label:"Events",items:[g_steps.blockControlBroadcast,g_steps.blockControlBroadcastWait,g_steps.blockControlPostMessage,g_steps.blockControlPostMessageAndWait,g_steps.valueControlMessageValue,g_steps.valueControlMessageSource]},{label:"Documentation",items:[g_steps.blockComment,
g_steps.blockInlineComment]}]},{label:"Control",cat:"flow",items:[{label:"Conditionals",items:[g_steps.blockControlIf,g_steps.valueControlIfElse,g_steps.blockControlIfElse]},{label:"Loops",items:[g_steps.blockControlForever,g_steps.blockControlRepeat,g_steps.blockControlForeverIf,g_steps.blockControlWaitUntil,g_steps.blockControlWhile,g_steps.blockControlRepeatUntil,g_steps.blockControlFor,g_steps.blockControlForEach,g_steps.blockControlBreak,g_steps.blockControlContinue]},{label:"Cloning",items:[g_steps.blockControlCloneActor,
g_steps.valueControlLastClonedActor,g_steps.valueControlCloneName,g_steps.valueControlIsClone,g_steps.blockControlDeleteActor]},{label:"Delay",items:[g_steps.blockControlWait]},{label:"Debugging",items:[g_steps.blockControlDebugBreak,g_steps.blockControlDebugBreakOn]},{label:"Advanced",items:[g_steps.blockControlStop]}]},{label:"Motion",cat:"motion",items:[{label:"Movement",items:[g_steps.blockMotionMove,g_steps.blockMotionGoTo,g_steps.blockMotionGoTowards,g_steps.blockMotionGlide,g_steps.blockMotionBounceOnEdge]},
{label:"Position",items:[g_steps.blockMotionChangeXBy,g_steps.blockMotionSetX,g_steps.blockMotionChangeYBy,g_steps.blockMotionSetY,g_steps.valueMotionXPosition,g_steps.valueMotionYPosition]},{label:"Rotation",items:[g_steps.blockMotionRotationStyle,g_steps.blockMotionTurnCW,g_steps.blockMotionTurnCCW,g_steps.blockMotionPointDirection,g_steps.blockMotionPointAngle,g_steps.blockMotionPointTowards,g_steps.valueMotionDirection,g_steps.valueMotionAngle]},g_steps.blockMotionMotorOnFor,g_steps.blockMotionMotorOn,
g_steps.blockMotionMotorOff,g_steps.blockMotionMotorPower,g_steps.blockMotionMotorDirection]},{label:"Animation",cat:"animation",items:[{label:"Basic Animation",items:[g_steps.blockAnimationSimpleSwitchCostume,g_steps.blockAnimationSimpleSwitchCostumeAndWait,g_steps.blockAnimationSetSpeed,g_steps.blockAnimationAnimate]},{label:"Character Parts",items:[g_steps.blockLooksSetCharacterPart,g_steps.valueLooksGetCharacterPart]},{label:"Animation Control",items:[g_steps.blockAnimationWaitFor,g_steps.blockAnimationStop,
g_steps.valueAnimationTime,g_steps.valueAnimationIsRunning,g_steps.registerAnimationDone]},{label:"Advanced Animation",items:[g_steps.blockAnimationSimpleMoveBy,g_steps.blockAnimationSimpleMoveTo,g_steps.blockAnimationSimpleScaleBy,g_steps.blockAnimationSimpleScaleTo,g_steps.blockAnimationSimpleRotateBy,g_steps.blockAnimationSimpleRotateTo,g_steps.blockAnimationSimpleBezierBy,g_steps.blockAnimationSimpleBezierTo,g_steps.blockAnimationSimpleEffectBy,g_steps.blockAnimationSimpleEffectTo]}]},{label:"Looks",
cat:"looks",items:[{label:"Costumes",items:[g_steps.blockLooksSwitchCostume,g_steps.blockLooksNextCostume,g_steps.blockLooksFirstCostumeInGroup,g_steps.blockLooksNextCostumeInGroup,g_steps.valueLooksCostumeNum,g_steps.valueLooksCostumeName,g_steps.blockLooksBackgroundColor,g_steps.blockLooksSwitchBackground,g_steps.blockLooksSwitchBackgroundAndWait,g_steps.blockLooksNextBackground,g_steps.blockLooksFirstBackgroundInGroup,g_steps.blockLooksNextBackgroundInGroup,g_steps.valueLooksBackground,g_steps.valueLooksBackgroundName]},
{label:"Speech Bubbles",items:[g_steps.blockLooksSetBubble,g_steps.blockLooksSayFor,g_steps.blockLooksSay,g_steps.blockLooksThinkFor,g_steps.blockLooksThink,g_steps.blockLooksSetLabel]},{label:"Levels",items:[g_steps.blockLooksViewportCamera,g_steps.blockLooksSetLevel,g_steps.blockLooksSetLevelWithActors,g_steps.valueLooksGetLevel,g_steps.valueLooksGetLevelNum,g_steps.valueLooksNumLevels]},{label:"Layers",items:[g_steps.blockLooksLayer,g_steps.valueLooksLayer,g_steps.blockLooksGoFront,g_steps.blockLooksGoBack,
g_steps.blockLooksMoveBack,g_steps.blockLooksMoveFront]},{label:"Visibility",items:[g_steps.blockLooksShow,g_steps.blockLooksHide,g_steps.valueLooksIsHidden,g_steps.blockLooksSetSize,g_steps.blockLooksChangeSizeBy,g_steps.valueLooksSize]},{label:"Special Effects",items:[g_steps.blockLooksChangeEffect,g_steps.blockLooksSetEffect,g_steps.blockLooksClearEffects]}]},{label:"Sensing",cat:"sensing",items:[{label:"Detection",items:[g_steps.valueSensingTouchingSprite,g_steps.valueSensingTouchingCloneOf,g_steps.valueSensingTouchedActorName,
g_steps.valueSensingTouchingColor,g_steps.valueSensingSeeColor,g_steps.valueSensingDistanceToSprite]},{label:"User Input",items:[g_steps.blockSensingAskAndWait,g_steps.blockSensingAskChoices,g_steps.valueSensingAnswer,g_steps.valueSensingMouseX,g_steps.valueSensingMouseY,g_steps.valueSensingMouseDown,g_steps.valueSensingKeyPressed]},{label:"Accelerometer",items:[g_steps.valueSensingTiltAngle,g_steps.valueSensingTiltAmount,g_steps.valueSensingAccelerometerX,g_steps.valueSensingAccelerometerY]},{label:"Time",
items:[g_steps.blockSensingResetTimer,g_steps.valueSensingTimer,g_steps.valueSensingDateTime]},{label:"Actor Properties",items:[g_steps.blockSensingSpriteProperty,g_steps.valueSensingSpriteProperty,g_steps.valueSensingActorName,g_steps.valueSensingActorNameAt,g_steps.valueSensingNumActors]},{label:"User Properties",items:[g_steps.valueSensingUserId,g_steps.valueSensingUserFirstName]},{label:"Screen Size",items:[g_steps.valueSensingScreenLeft,g_steps.valueSensingScreenRight,g_steps.valueSensingScreenTop,
g_steps.valueSensingScreenBottom,g_steps.valueSensingStageProperty]}]},{label:"Sound",cat:"sound",items:[{label:"Musical Notes",items:[g_steps.blockSoundPlayDrum,g_steps.blockSoundRest,g_steps.blockSoundPlayNote,g_steps.blockSoundSetInstrument,g_steps.blockSoundChangeTempo,g_steps.blockSoundSetTempo,g_steps.valueSoundTempo]},{label:"Sounds",items:[g_steps.blockSoundPlayUntilDone,g_steps.blockSoundPlay,g_steps.blockSoundStopActor,g_steps.blockSoundStopAll,g_steps.blockSoundChangeVolume,g_steps.blockSoundSetVolume,
g_steps.valueSoundVolume]}]},{label:"Operators",cat:"operator",items:[{label:"Basic Operators",items:[g_steps.valueOpAdd,g_steps.valueOpSubtract,g_steps.valueOpMultiply,g_steps.valueOpDivide,g_steps.valueOpMod,g_steps.valueOpBinary,g_steps.valueOpExpression]},{label:"Math Functions",items:[g_steps.valueOpRound,g_steps.valueOpRandom,g_steps.valueOpMath,g_steps.valueOpMath2,g_steps.valueOpConstants]},{label:"Boolean",items:[g_steps.valueOpLess,g_steps.valueOpEqual,g_steps.valueOpGreater,g_steps.valueOpAnd,
g_steps.valueOpOr,g_steps.valueOpNot,g_steps.valueOpBitNot]},{label:"Strings",items:[g_steps.valueOpJoin,g_steps.valueOpLetter,g_steps.valueOpLength,g_steps.valueOpTextSplit,g_steps.valueOpTextReplace,g_steps.valueOpTextIndex,g_steps.valueOpTextLastIndex,g_steps.valueOpTextSubstring,g_steps.valueOpTextTransform,g_steps.valueOpTextFormat]}]},{label:"Pen",cat:"pen",items:[{label:"Pen Drawing",items:[g_steps.blockPenClear,g_steps.blockPenDown,g_steps.blockPenUp,g_steps.blockPenChangeSize,g_steps.blockPenSetSize,
g_steps.blockPenStamp]},{label:"Color",items:[g_steps.blockPenSetColor,g_steps.blockPenChangeHue,g_steps.blockPenSetHue,g_steps.blockPenChangeShade,g_steps.blockPenSetShade,g_steps.blockPenSetFillColor,g_steps.blockPenSetNoFill]},{label:"Text",items:[g_steps.blockPenSetFont,g_steps.blockPenSetFontColor,g_steps.blockPenDrawText,g_steps.blockPenDrawTextAt]},{label:"Shapes",items:[g_steps.blockPenDrawPoint,g_steps.blockPenDrawLine,g_steps.blockPenDrawRectangle,g_steps.blockPenDrawRectangleLocal,g_steps.blockPenDrawTriangle,
g_steps.blockPenDrawEllipse,g_steps.blockPenDrawEllipseLocal,g_steps.blockPenDrawBezier]}]},{label:"Physics",cat:"physics",items:[{label:"Basic Physics",items:[g_steps.blockPhysicsStart,g_steps.blockPhysicsStop,g_steps.blockPhysicsSetGravity,g_steps.blockPhysicsSetActorActive,g_steps.blockPhysicsSetActorStatic,g_steps.blockPhysicsSetActorGeometry]},{label:"Collisions",items:[g_steps.registerSpriteCollision,g_steps.valuePhysicsCollidedWithSprite,g_steps.valuePhysicsCollidedWithName,g_steps.valuePhysicsTouchingActor]},
{label:"Physical Properties",items:[g_steps.blockPhysicsSetDensity,g_steps.blockPhysicsSetFriction,g_steps.blockPhysicsSetRestitution,g_steps.valuePhysicsDensity,g_steps.valuePhysicsFriction,g_steps.valuePhysicsRestitution]},{label:"Force",items:[g_steps.blockPhysicsApplyForce,g_steps.blockPhysicsApplyImpulse,g_steps.blockPhysicsApplyTorque,g_steps.blockPhysicsApplyForceAngle,g_steps.blockPhysicsApplyImpulseAngle,g_steps.blockPhysicsApplyForceXY,g_steps.blockPhysicsApplyImpulseXY,g_steps.blockPhysicsSetAngularDamping,
g_steps.blockPhysicsSetLinearDamping,g_steps.valuePhysicsXGravity,g_steps.valuePhysicsYGravity,g_steps.valuePhysicsAngularDamping,g_steps.valuePhysicsLinearDamping,g_steps.valuePhysicsInertia]},{label:"Velocity",items:[g_steps.blockPhysicsSetLinearVelocity,g_steps.blockPhysicsSetLinearVelocityXY,g_steps.blockPhysicsSetAngularVelocity,g_steps.valuePhysicsAngularVelocity,g_steps.valuePhysicsXVelocity,g_steps.valuePhysicsYVelocity,g_steps.valuePhysicsIsAwake]},{label:"Advanced",items:[g_steps.valuePhysicsGetProperty,
g_steps.blockPhysicsApply,g_steps.blockPhysicsApplyXY]}]},{label:"Hardware",cat:"hardware",items:[{label:"Sphero",items:[g_steps.blockSpheroSetSpeed,g_steps.blockSpheroRoll,g_steps.blockSpheroStop,g_steps.blockSpheroTurnCW,g_steps.blockSpheroTurnCCW,g_steps.blockSpheroHeading,g_steps.blockSpheroColor,g_steps.valueSpheroSpeed,g_steps.valueSpheroHeading,g_steps.valueSpheroConnected,g_steps.valueSpheroProperty,g_steps.valueSpheroOdometer,g_steps.valueSpheroCollidedSinceLastCheck,g_steps.registerHardwareTrigger,
g_steps.blockSpheroSetStabilization,g_steps.blockSpheroSet]},{label:"Drone",items:[g_steps.blockDroneTakeOff,g_steps.blockDroneLand,g_steps.blockDroneStop,g_steps.blockDroneEmergency,g_steps.blockDroneSetSpeed,g_steps.blockDroneForward,g_steps.blockDroneBackward,g_steps.blockDroneLeft,g_steps.blockDroneRight,g_steps.blockDroneTurnCW,g_steps.blockDroneTurnCCW,g_steps.blockDroneAnimation,g_steps.blockDroneUp,g_steps.blockDroneDown,g_steps.valueDroneConnected,g_steps.blockDroneStartUp,g_steps.blockDroneStartDown,
g_steps.blockDroneStartRotateLeft,g_steps.blockDroneStartRotateRight,g_steps.blockDroneTakePicture,g_steps.blockDroneFetchPicture,g_steps.blockDroneDeletePicture,g_steps.blockDroneVarSetNumPictures,g_steps.blockDroneSetProductName,g_steps.valueDroneHasGrabber,g_steps.blockDroneControlGrabber,g_steps.valueDroneHasCannon,g_steps.blockDroneControlCannon,g_steps.blockDroneSetFlyingMode]},{label:"WeDo 2.0",items:[g_steps.blockWedo2RunMotorFor,g_steps.blockWedo2SetMotorPower,g_steps.blockWedo2SetMotorDirection,
g_steps.blockWedo2MotorOn,g_steps.blockWedo2MotorOff,g_steps.blockWedo2MotorDrift,g_steps.valueWedo2MotorPower,g_steps.valueWedo2MotorDirection,g_steps.valueWedo2ConnectedTo,g_steps.blockWedo2SetLightColor,g_steps.valueWedo2TiltSensorDirection,g_steps.blockWedo2SetTiltSensorMode,g_steps.valueWedo2TiltSensorMode,g_steps.valueWedo2TiltSensorAngle,g_steps.valueWedo2TiltSensorBumpCount,g_steps.blockWedo2SensorReset,g_steps.valueWedo2MotionSensorDistance,g_steps.blockWedo2SetMotionSensorMode,g_steps.valueWedo2MotionSensorMode,
g_steps.valueWedo2MotionSensorCount,g_steps.blockWedo2PlayToneFor,g_steps.blockWedo2StopTone]},{label:"Hue",items:[g_steps.blockHueState,g_steps.valueHueState,g_steps.blockHueColor,g_steps.blockHueSetHue,g_steps.blockHueChangeHue,g_steps.blockHueBrightness,g_steps.valueHueBrightness]},{label:"Jumping Sumo",items:[g_steps.blockJumpingSumoStop,g_steps.blockJumpingSumoEmergency,g_steps.blockJumpingSumoJump,g_steps.blockJumpingSumoAnimation,g_steps.blockJumpingSumoForward,g_steps.blockJumpingSumoBackward,
g_steps.blockJumpingSumoTurnCW,g_steps.blockJumpingSumoTurnCCW,g_steps.blockJumpingSumoSetSpeed,g_steps.blockJumpingSumoSetTurn,g_steps.blockJumpingSumoMove,g_steps.blockJumpingSumoStart,g_steps.blockJumpingSumoPose,g_steps.blockJumpingSumoSetVolume,g_steps.blockJumpingSumoSetAudioTheme]}]},{label:"Variables",cat:"variables",items:[]},{label:"Functions",cat:"functions",items:[]}],Canvas={particles:null,tileSize:0,boxPadding:10,handleRadius:3,minSize:10,hideSelections:!1,enableAccelerometer:!0,Stage:function(b){this.container=
b;this.width=600;this.height=400;this.canvasScale=1;this.drawGrid=this.expand=false;this.id=1;this.bgimg=new Image;this.bgimg.src=Sprites._blankImg;this.cursor="auto";this.backgroundOffsetY=this.backgroundOffsetX=0;this.designMode="select";this.draggingEnabled=true;this.selectedActor=null;this.selected=false;this.mousePos={x:0,y:0};this.accel={};this.listeners=[];this.lastMouseUp=Date.now();this.backgroundLayer=new Canvas.Layer(this);this.videoLayer=new Canvas.Layer(this);this.tileLayer=new Canvas.TileLayer(this);
this.penLayer=new Canvas.Layer(this);this.actorsLayer=new Canvas.Layer(this);this.particleLayer=new Canvas.Layer(this);this.particleLayer.context.globalCompositeOperation="lighter";if(!Canvas.particles){Canvas.particles=new Proton;Canvas.renderer=new Proton.Renderer("canvas",Canvas.particles,this.particleLayer.canvas);this.particleLayer.context.globalCompositeOperation="lighter";Canvas.renderer.start()}this.setBackgroundType("stretch");this.actors=[];for(b=0;b<this.container.children.length;b++){var c=
this.container.children[b];if(c.tagName=="CANVAS"){c.style.width=this.width;c.style.height=this.height;c.setAttribute("width",this.width);c.setAttribute("height",this.height)}}var d=this;$(this.container).mousedown(function(b){d.setMousePosition(b.clientX,b.clientY);d.onMouseDown(b)});this.container.addEventListener("touchstart",function(b){if(b.touches&&b.touches.length>0){d.setMousePosition(b.touches[0].pageX,b.touches[0].pageY);d.onMouseDown(b)}return false},false);$(this.container).mousemove(function(b){d.setMousePosition(b.clientX,
b.clientY);d.onMouseMove(b)});this.container.addEventListener("touchmove",function(b){if(b.touches&&b.touches.length>0){d.setMousePosition(b.touches[0].pageX,b.touches[0].pageY);d.onMouseMove(b)}return false},false);$(this.container).mouseup(function(b){d.setMousePosition(b.clientX,b.clientY);d.onMouseUp(b)});this.container.addEventListener("touchend",function(b){if(b.touches&&b.touches.length>0){d.setMousePosition(b.touches[0].pageX,b.touches[0].pageY);d.onMouseUp(b)}return false},false);$(this.container).bind("mousewheel",
function(b){d.onScroll(b)}).bind("DOMMouseScroll",function(b){d.onScroll(b)});$(this.container).bind("mouseleave",function(){d.mouseDown=false;Runtime.keys.mouse=false});var e=0;if(!window.IDE&&Canvas.enableAccelerometer)window.ondevicemotion=function(b){var c=Date.now();if(Runtime.stage&&Runtime.stage.accel){switch(window.orientation){case 90:Runtime.stage.accel={orientation:window.orientation,x:-b.accelerationIncludingGravity.y,y:b.accelerationIncludingGravity.x,z:b.accelerationIncludingGravity.z};
break;case -90:Runtime.stage.accel={orientation:window.orientation,x:b.accelerationIncludingGravity.y,y:-b.accelerationIncludingGravity.x,z:b.accelerationIncludingGravity.z};break;case 180:Runtime.stage.accel={orientation:window.orientation,x:-b.accelerationIncludingGravity.x,y:-b.accelerationIncludingGravity.y,z:b.accelerationIncludingGravity.z};default:Runtime.stage.accel={orientation:window.orientation,x:b.accelerationIncludingGravity.x,y:b.accelerationIncludingGravity.y,z:b.accelerationIncludingGravity.z}}if(c-
e>100){Runtime.keys["left arrow"]=false;Runtime.keys["right arrow"]=false;Runtime.keys["up arrow"]=false;Runtime.keys["down arrow"]=false;e=c;Runtime.stage.accel.x<0?Runtime.triggerKeyDown("left arrow"):Runtime.stage.accel.x>0&&Runtime.triggerKeyDown("right arrow");Runtime.stage.accel.y<0?Runtime.triggerKeyDown("down arrow"):Runtime.stage.accel.y>0&&Runtime.triggerKeyDown("up arrow")}}}}};
Canvas.Stage.prototype.setDesignMode=function(b){this.designMode=b;this.designMode=="place"&&this.tileLayer.enableTiles(true);this.draw()};Canvas.Stage.prototype.onTouchStart=function(b){if(b.touches.length==1){this.detectingGesture=true;this.gestureStartX=b.touches[0].pageX;this.gestureStartY=b.touches[0].pageY;this.gestureDirY=this.gestureDirX=null;self.setMousePosition(b.touches[0].pageX,b.touches[0].pageY);self.onMouseDown(b)}};
Canvas.Stage.prototype.onTouchMove=function(b){if(this.detectingGesture)if(b.touches.length>1)this.detectingGesture=false;else{self.setMousePosition(b.touches[0].pageX,b.touches[0].pageY);self.onMouseMove(b);var c=b.touches[0].pageX-this.gestureStartX,d=b.touches[0].pageY-this.gestureStartY;if(this.gestureDirX==null){this.gestureDirX=c;b.preventDefault()}if(this.gestureDirY==null){this.gestureDirY=d;b.preventDefault()}}};
Canvas.Stage.prototype.onTouchEnd=function(b){self.onMouseUp(b);if(this.gestureDirX==null||this.gestureDirY==null)Runtime.triggerKeyEvent({target:{tagname:""},which:32});else if(Math.abs(this.gestureDirX)>Math.abs(this.gestureDirY))if(this.gestureDirX<0){Runtime.triggerKeyEvent({target:{tagname:""},which:37});window.setTimeout(function(){Runtime.triggerKeyUpEvent({target:{tagname:""},which:37})},500)}else{Runtime.triggerKeyEvent({target:{tagname:""},which:39});window.setTimeout(function(){Runtime.triggerKeyUpEvent({target:{tagname:""},
which:39})},500)}else if(this.gestureDirY<0){Runtime.triggerKeyEvent({target:{tagname:""},which:38});window.setTimeout(function(){Runtime.triggerKeyUpEvent({target:{tagname:""},which:38})},500)}else{Runtime.triggerKeyEvent({target:{tagname:""},which:40});window.setTimeout(function(){Runtime.triggerKeyUpEvent({target:{tagname:""},which:40})},500)}this.detectingGesture=false};Canvas.Stage.prototype.getWidth=function(){return this.width};Canvas.Stage.prototype.getHeight=function(){return this.height};
Canvas.Stage.prototype.setBackground=function(b){var c=this;if(!(this.bgimg instanceof Image))this.bgimg=new Image;this.bgimg.onload=function(){c.setBackgroundType(c.bgtype)};this.bgimg.src=b==null?Sprites._blankImg:b};Canvas.Stage.prototype.setBackgroundImg=function(b){b?this.bgimg=b:this.bgimg.src=Sprites._blankImg;this.setBackgroundType(this.bgtype)};
Canvas.Stage.prototype.setBackgroundType=function(b){var c=this.backgroundLayer.context,d=this.bgimg,e=this.width,f=this.height;if(b)this.bgtype=b;c.clearRect(0,0,e,f);c.globalAlpha=this.backgroundLayer.alpha;if(d&&d.width>0&&d.height>0)if(this.tileLayer.scrollBgOffset||this.bgtype=="tile"){e=e/Runtime.stage.canvasScale;f=f/Runtime.stage.canvasScale;c.save();c.scale(Runtime.stage.canvasScale,Runtime.stage.canvasScale);for(var g=this.backgroundOffsetX%d.width/Runtime.stage.canvasScale;g>0;)g=g-d.width;
for(b=this.backgroundOffsetY%d.height/Runtime.stage.canvasScale;b>0;)b=b-d.height;for(;g<e;g=g+d.width)for(var h=b;h<f;h=h+d.height)c.drawImage(d,g,h);c.restore()}else this.expand?c.drawImage(d,(e-d.width)/2,(f-d.height)/2):this.bgtype=="stretch"?c.drawImage(d,0,0,e,f):c.drawImage(d,(e-d.width)/2,(f-d.height)/2)};Canvas.Stage.prototype.setStageExpand=function(b){this.expand=b};
Canvas.Stage.prototype.setSize=function(b,c){if(b!=this.width||c!=this.height){this.width=b;this.height=c;for(var d=0;d<this.container.children.length;d++){var e=this.container.children[d];if(e.tagName=="CANVAS"){e.style.width=this.width;e.style.height=this.height;e.setAttribute("width",this.width);e.setAttribute("height",this.height)}}this.setBackgroundType(this.bgtype);if(Canvas.renderer){Canvas.renderer.resize(this.width,this.height);this.particleLayer.context.globalCompositeOperation="lighter"}}};
Canvas.Stage.prototype.updateStageSize=function(){for(var b=0;b<this.container.children.length;b++){var c=this.container.children[b];if(c.tagName=="CANVAS"&&(c.getAttribute("width")!=this.width||c.getAttribute("height")!=this.height)){c.style.width=this.width;c.style.height=this.height;c.setAttribute("width",this.width);c.setAttribute("height",this.height)}}if(Canvas.renderer){Canvas.renderer.resize(this.width,this.height);this.particleLayer.context.globalCompositeOperation="lighter"}this.setBackgroundType(this.bgtype)};
Canvas.Stage.prototype.selectActor=function(b){for(var c=false,d=0;d<this.actors.length;d++)if(b!=null&&this.actors[d].id==b.id){if(this.draggingEnabled)this.actors[d].selected=true;c=true}else if(this.draggingEnabled)this.actors[d].selected=false;if(!c)this.selectedActor=null;this.draw()};Canvas.Stage.prototype.enableDragging=function(b){if(b)this.draggingEnabled=true;else{this.draggingEnabled=false;for(b=this.actors.length-1;b>=0;b--)this.actors[b].selected=false;this.backgroundSelected=true;this.draw()}};
Canvas.Stage.prototype.showGrid=function(b){this.drawGrid=b;this.draw()};Canvas.Stage.prototype.isGridVisible=function(){return this.drawGrid};Canvas.Stage.prototype.broadcastListeners=function(b,c){for(var d=0;d<this.listeners.length;d++)this.listeners[d].type==b&&this.listeners[d].fn(c)};Canvas.Stage.prototype.addListener=function(b,c){this.listeners.push({type:b,fn:c})};
Canvas.Stage.prototype.removeListener=function(b){for(var c=0;c<this.listeners.length;c++)this.listeners[c].type==b&&this.listeners.splice(c,1)};Canvas.Stage.prototype.removeAllListeners=function(){this.listeners=[]};Canvas.Stage.prototype.getMousePos=function(){return{x:-this.tileLayer.scrollOffset.x+this.mousePos.x,y:-this.tileLayer.scrollOffset.y+this.mousePos.y}};
Canvas.Stage.prototype.actorAt=function(b,c){for(var d=this.actors.length-1;d>=0;d--){var e=this.actors[d];if(e.visible&&e.selectable&&e.containsPoint(b,c))return e}return null};
Canvas.Stage.prototype.onMouseDown=function(b){if(Runtime.isRunning())this.selectDown(b);else if(b.ctrlKey||b.metaKey||b.shiftKey)this.scrollDown(b);else if(this.designMode=="remove")this.removeDown(b);else if(this.designMode=="scroll")this.scrollDown(b);else if(this.designMode=="place")this.placeDown(b);else{this.selectDown(b);(!this.dragMode||!this.selectedActor)&&this.scrollDown(b)}};
Canvas.Stage.prototype.selectDown=function(b){if(window.IDE){var c=$(".color-chooser");if(c.length>0&&c.css("display")!="none")return}for(c=this.actors.length-1;c>=0;c--){var d=this.actors[c];if(d.visible&&d.selectable){var e=d.drawBubble(this.actorsLayer);if(e&&(d.bubble.buttonText||this.mousePos.x>=e.left&&this.mousePos.y>=e.top&&this.mousePos.x<e.left+e.width&&this.mousePos.y<e.top+e.height)){this.broadcastListeners("bubbleclicked",d);return}}}var f=this.mousePos.x/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetX(),
g=this.mousePos.y/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetY();if((e=this.drawBubble(this.text,this.actorsLayer,this.bubble))&&(this.bubble.buttonText||f>=e.left&&g>=e.top&&f<e.left+e.width&&g<e.top+e.height))this.broadcastListeners("bubbleclicked",null);else if(!($("#stage-canvas .ask:visible").length>0)){e=false;this.mouseDown=true;if(b.which==3){Runtime.lastKeyPressed="mouse-right";Runtime.triggerKeyDown("mouse-right")}else{Runtime.lastKeyPressed="mouse";Runtime.triggerKeyDown("mouse")}this.startX=
this.mousePos.x/Runtime.stage.canvasScale;this.startY=this.mousePos.y/Runtime.stage.canvasScale;for(c=this.actors.length-1;c>=0;c--){d=this.actors[c];if(d.visible&&d.withinBounds(f,g)){this.selectedActor=d;this.broadcastListeners("clicked",this.selectedActor);if(d.selectable){e=true;if(this.draggingEnabled||d.draggable){this.draggingX=d.x-f;this.draggingY=d.y-g;this.dragMode="drag";this._save={sprite:d.sprite,x:d.x,y:d.y,scale:d.scale.x,rotation:d.rotation};d.moveToTop();if(this.draggingEnabled){if(!this.selectedActor.selected){this.selectedActor.selected=
true;for(b=c-1;b>=0;b--)this.actors[b].selected=false;this.broadcastListeners("selected",this.selectedActor)}this.backgroundSelected=false}}else d.selected=false}break}else if(d.visible&&d.selected&&(this.draggingEnabled||d.draggable)){b=d.getBounds();this._save={sprite:d.sprite,x:d.x,y:d.y,scale:d.scale.x,rotation:d.rotation};if(d.isStatic){f=f+Runtime.stage.tileLayer.getScrollOffsetX();g=g+Runtime.stage.tileLayer.getScrollOffsetY()}if(f>=b.left-2*Canvas.boxPadding&&f<=b.left&&g>=b.top-2*Canvas.boxPadding&&
g<=b.top){if(d.isStatic){f=f-Runtime.stage.tileLayer.getScrollOffsetX();g=g-Runtime.stage.tileLayer.getScrollOffsetY()}this.origVal={x:d.width*d.scale.x,y:d.height*d.scale.y};this.draggingX=f;this.draggingY=g;this.dragMode="resizeTopLeft";this.backgroundSelected=false;this.selectedActor=d;e=this.selectedActor.selected=true;this.broadcastListeners("selected",this.selectedActor);break}else if(f>=b.right&&f<=b.right+2*Canvas.boxPadding&&g>=b.top-2*Canvas.boxPadding&&g<=b.top){if(d.isStatic){f=f-Runtime.stage.tileLayer.getScrollOffsetX();
g=g-Runtime.stage.tileLayer.getScrollOffsetY()}this.origVal={x:d.width*d.scale.x,y:d.height*d.scale.y};this.draggingX=f;this.draggingY=g;this.dragMode="resizeTopRight";this.backgroundSelected=false;this.selectedActor=d;e=this.selectedActor.selected=true;this.broadcastListeners("selected",this.selectedActor);break}else if(f>=b.left-2*Canvas.boxPadding&&f<=b.left&&g>=b.bottom&&g<=b.bottom+2*Canvas.boxPadding){if(d.isStatic){f=f-Runtime.stage.tileLayer.getScrollOffsetX();g=g-Runtime.stage.tileLayer.getScrollOffsetY()}this.origVal=
{x:d.width*d.scale.x,y:d.height*d.scale.y};this.draggingX=f;this.draggingY=g;this.dragMode="resizeBottomLeft";this.backgroundSelected=false;this.selectedActor=d;e=this.selectedActor.selected=true;this.broadcastListeners("selected",this.selectedActor);break}else if(f>=b.right&&f<=b.right+2*Canvas.boxPadding&&g>=b.bottom&&g<=b.bottom+2*Canvas.boxPadding){if(d.isStatic){f=f-Runtime.stage.tileLayer.getScrollOffsetX();g=g-Runtime.stage.tileLayer.getScrollOffsetY()}this.origVal={x:d.width*d.scale.x,y:d.height*
d.scale.y};this.draggingX=f;this.draggingY=g;this.dragMode="resizeBottomRight";this.backgroundSelected=false;this.selectedActor=d;e=this.selectedActor.selected=true;this.broadcastListeners("selected",this.selectedActor);break}else if(f>=(b.right+b.left)/2-Canvas.handleRadius-Canvas.boxPadding&&f<=(b.right+b.left)/2+Canvas.handleRadius+Canvas.boxPadding&&g>=b.top-Canvas.boxPadding*3-Canvas.handleRadius-Canvas.boxPadding&&g<=b.top-Canvas.boxPadding*3+Canvas.handleRadius+Canvas.boxPadding){if(d.isStatic){f=
f-Runtime.stage.tileLayer.getScrollOffsetX();g=g-Runtime.stage.tileLayer.getScrollOffsetY()}this.origVal=d.rotation;this.draggingX=180/Math.PI*Math.atan2(g-d.y,f-d.x);this.dragMode="rotate";this.backgroundSelected=false;this.selectedActor=d;e=this.selectedActor.selected=true;this.broadcastListeners("selected",this.selectedActor);break}else if(g>=b.top-2*Canvas.boxPadding&&g<=b.bottom+2*Canvas.boxPadding&&f>=b.left-2*Canvas.boxPadding&&f<=b.left+2*Canvas.boxPadding){if(d.isStatic){f=f-Runtime.stage.tileLayer.getScrollOffsetX();
g=g-Runtime.stage.tileLayer.getScrollOffsetY()}this.origVal=d.width*d.scale.x;this.draggingX=f;this.draggingY=g;this.dragMode="resizeLeft";this.backgroundSelected=false;this.selectedActor=d;e=this.selectedActor.selected=true;this.broadcastListeners("selected",this.selectedActor);break}else if(g>=b.top-2*Canvas.boxPadding&&g<=b.bottom+2*Canvas.boxPadding&&f>=b.right-2*Canvas.boxPadding&&f<=b.right+2*Canvas.boxPadding){if(d.isStatic){f=f-Runtime.stage.tileLayer.getScrollOffsetX();g=g-Runtime.stage.tileLayer.getScrollOffsetY()}this.origVal=
d.width*d.scale.x;this.draggingX=f;this.draggingY=g;this.dragMode="resizeRight";this.backgroundSelected=false;this.selectedActor=d;e=this.selectedActor.selected=true;this.broadcastListeners("selected",this.selectedActor);break}else if(f>=b.left-2*Canvas.boxPadding&&f<=b.right+2*Canvas.boxPadding&&g>=b.top-2*Canvas.boxPadding&&g<=b.top+2*Canvas.boxPadding){if(d.isStatic){f=f-Runtime.stage.tileLayer.getScrollOffsetX();g=g-Runtime.stage.tileLayer.getScrollOffsetY()}this.origVal=d.height*d.scale.y;this.draggingX=
f;this.draggingY=g;this.dragMode="resizeTop";this.backgroundSelected=false;this.selectedActor=d;e=this.selectedActor.selected=true;this.broadcastListeners("selected",this.selectedActor);break}else if(f>=b.left-2*Canvas.boxPadding&&f<=b.right+2*Canvas.boxPadding&&g>=b.bottom-2*Canvas.boxPadding&&g<=b.bottom+2*Canvas.boxPadding){if(d.isStatic){f=f-Runtime.stage.tileLayer.getScrollOffsetX();g=g-Runtime.stage.tileLayer.getScrollOffsetY()}this.origVal=d.height*d.scale.y;this.draggingX=f;this.draggingY=
g;this.dragMode="resizeBottom";this.backgroundSelected=false;this.selectedActor=d;e=this.selectedActor.selected=true;this.broadcastListeners("selected",this.selectedActor);break}else d.selected=false}else d.selected=false}if(e)this.backgroundSelected=false;else{if(!this.backgroundSelected&&this.draggingEnabled){this.backgroundSelected=true;this.broadcastListeners("selected",null);this.selectedActor=null}this.broadcastListeners("clicked",null)}this.draw()}};
Canvas.Stage.prototype.scrollDown=function(){if(this.tileLayer.isTilesEnabled()){this.mouseDown=true;this.startX=this.mousePos.x/Runtime.stage.canvasScale;this.startY=this.mousePos.y/Runtime.stage.canvasScale;this.startOffset=this.tileLayer.getScrollOffset()}};
Canvas.Stage.prototype.removeDown=function(){this.mouseDown=true;var b=Math.floor((this.mousePos.x/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetX())/this.tileLayer.tileSize),c=Math.floor((this.mousePos.y/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetY())/this.tileLayer.tileSize);this.tileLayer.removeTile(b,c);this.draw()};
Canvas.Stage.prototype.placeDown=function(){this.mouseDown=true;var b=Math.floor((this.mousePos.x/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetX())/this.tileLayer.tileSize),c=Math.floor((this.mousePos.y/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetY())/this.tileLayer.tileSize);this.tileLayer.placeTile(b,c,this.tileLayer.currentTileType);for(var d=-Canvas.tileSize;d<=Canvas.tileSize;d++)for(var e=-Canvas.tileSize;e<=Canvas.tileSize;e++)this.tileLayer.placeTile(b+d,c+e,this.tileLayer.currentTileType);
this.draw()};Canvas.Stage.prototype.onMouseMove=function(b){if(Runtime.isRunning())this.selectMove(b);else if(b.ctrlKey||b.metaKey||b.shiftKey)this.scrollMove(b);else if(this.designMode=="remove")this.removeMove(b);else if(this.designMode=="scroll")this.scrollMove(b);else if(this.designMode=="place")this.placeMove(b);else{this.selectMove(b);(!this.dragMode||!this.selectedActor)&&this.scrollMove(b)}};
Canvas.Stage.prototype.selectMove=function(){var b=this.mousePos.x/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetX(),c=this.mousePos.y/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetY();if(this.selectedActor&&(this.draggingEnabled||this.selectedActor.draggable)){if(this.dragMode=="drag")this.selectedActor.setPosition(b+this.draggingX,c+this.draggingY);else if(this.dragMode=="rotate"){var d=this.draggingX;this.selectedActor.setRotation(this.origVal+(180/Math.PI*Math.atan2(c-this.selectedActor.y,
b-this.selectedActor.x)-d))}else if(this.dragMode=="resizeTopLeft"){d=true;b=-b+this.draggingX;if(-c+this.draggingY>b){c=this.origVal.y+(-c+this.draggingY)*2;d=false}else c=this.origVal.x+b*2;if(c<Canvas.minSize)c=Canvas.minSize;d?this.selectedActor.setScale(c/this.selectedActor.width):this.selectedActor.setScale(c/this.selectedActor.height)}else if(this.dragMode=="resizeBottomRight"){d=true;b=b-this.draggingX;if(c-this.draggingY>b){c=this.origVal.y+(c-this.draggingY)*2;d=false}else c=this.origVal.x+
b*2;if(c<Canvas.minSize)c=Canvas.minSize;d?this.selectedActor.setScale(c/this.selectedActor.width):this.selectedActor.setScale(c/this.selectedActor.height)}else if(this.dragMode=="resizeTopRight"){d=true;b=b-this.draggingX;if(-c+this.draggingY>b){c=this.origVal.y+(-c+this.draggingY)*2;d=false}else c=this.origVal.x+b*2;if(c<Canvas.minSize)c=Canvas.minSize;d?this.selectedActor.setScale(c/this.selectedActor.width):this.selectedActor.setScale(c/this.selectedActor.height)}else if(this.dragMode=="resizeBottomLeft"){d=
true;b=-b+this.draggingX;if(c-this.draggingY>b){c=this.origVal.y+(c-this.draggingY)*2;d=false}else c=this.origVal.x+b*2;if(c<Canvas.minSize)c=Canvas.minSize;d?this.selectedActor.setScale(c/this.selectedActor.width):this.selectedActor.setScale(c/this.selectedActor.height)}else if(this.dragMode=="resizeLeft"){c=this.origVal+(-b+this.draggingX)*2;if(c<Canvas.minSize)c=Canvas.minSize;this.selectedActor.setScale(c/this.selectedActor.width)}else if(this.dragMode=="resizeRight"){c=this.origVal+(b-this.draggingX)*
2;if(c<Canvas.minSize)c=Canvas.minSize;this.selectedActor.setScale(c/this.selectedActor.width)}else if(this.dragMode=="resizeTop"){c=this.origVal+(-c+this.draggingY)*2;if(c<Canvas.minSize)c=Canvas.minSize;this.selectedActor.setScale(c/this.selectedActor.height)}else if(this.dragMode=="resizeBottom"){c=this.origVal+(c-this.draggingY)*2;if(c<Canvas.minSize)c=Canvas.minSize;this.selectedActor.setScale(c/this.selectedActor.height)}else{this.cursor="auto";this.container.style.cursor=this.cursor}this.draw()}else{for(var d=
null,e=0;e<this.actors.length;e++)if(this.actors[e].selected){d=this.actors[e];break}e=false;if(d!=null){var f=d.getBounds();if(d.isStatic){b=b+Runtime.stage.tileLayer.getScrollOffsetX();c=c+Runtime.stage.tileLayer.getScrollOffsetY()}d=$(".color-chooser");if(window.IDE&&d.length>0&&d.css("display")!="none"){this.cursor="crosshair";this.container.style.cursor=this.cursor;e=true}else if(b>=f.left&&b<=f.right&&c>=f.top&&c<=f.bottom){if(this.cursor!="url(ide/imgs/canvas/move.png) 8 8,move"){this.cursor=
"url(ide/imgs/canvas/move.png) 8 8,move";this.container.style.cursor=this.cursor}e=true}else if(b>=(f.right+f.left)/2-Canvas.handleRadius-Canvas.boxPadding&&b<=(f.right+f.left)/2+Canvas.handleRadius+Canvas.boxPadding&&c>=f.top-Canvas.boxPadding*3-Canvas.handleRadius-Canvas.boxPadding&&c<=f.top-Canvas.boxPadding*3+Canvas.handleRadius+Canvas.boxPadding){if(this.cursor!="url(ide/imgs/canvas/rotate.png) 8 8,pointer"){this.cursor="url(ide/imgs/canvas/rotate.png) 8 8,pointer";this.container.style.cursor=
this.cursor}e=true}else if(b>=f.left-2*Canvas.boxPadding&&b<=f.left&&c>=f.top-2*Canvas.boxPadding&&c<=f.top||b>=f.right&&b<=f.right+2*Canvas.boxPadding&&c>=f.bottom&&c<=f.bottom+2*Canvas.boxPadding){if(this.cursor!="url(ide/imgs/canvas/resize-nw.png) 8 8,pointer"){this.cursor="url(ide/imgs/canvas/resize-nw.png) 8 8,pointer";this.container.style.cursor=this.cursor}e=true}else if(b>=f.right&&b<=f.right+2*Canvas.boxPadding&&c>=f.top-2*Canvas.boxPadding&&c<=f.top||b>=f.left-2*Canvas.boxPadding&&b<=
f.left&&c>=f.bottom&&c<=f.bottom+2*Canvas.boxPadding){if(this.cursor!="url(ide/imgs/canvas/resize-ne.png) 8 8,pointer"){this.cursor="url(ide/imgs/canvas/resize-ne.png) 8 8,pointer";this.container.style.cursor=this.cursor}e=true}else if(c>=f.top-2*Canvas.boxPadding&&c<=f.bottom+2*Canvas.boxPadding&&b>=f.left-2*Canvas.boxPadding&&b<=f.left||c>=f.top-2*Canvas.boxPadding&&c<=f.bottom+2*Canvas.boxPadding&&b>=f.right&&b<=f.right+2*Canvas.boxPadding){if(this.cursor!="url(ide/imgs/canvas/resize-we.png) 8 8,col-resize"){this.cursor=
"url(ide/imgs/canvas/resize-we.png) 8 8,col-resize";this.container.style.cursor=this.cursor}e=true}else if(b>=f.left-2*Canvas.boxPadding&&b<=f.right+2*Canvas.boxPadding&&c>=f.top-2*Canvas.boxPadding&&c<=f.top||b>=f.left-2*Canvas.boxPadding&&b<=f.right+2*Canvas.boxPadding&&c>=f.bottom&&c<=f.bottom+2*Canvas.boxPadding){if(this.cursor!="url(ide/imgs/canvas/resize-ns.png) 8 8,row-resize"){this.cursor="url(ide/imgs/canvas/resize-ns.png) 8 8,row-resize";this.container.style.cursor=this.cursor}e=true}}if(!e){if(window.IDE){d=
$(".color-chooser");this.cursor=d.length>0&&d.css("display")!="none"?"crosshair":"auto"}else this.cursor="auto";this.container.style.cursor=this.cursor}}};Canvas.Stage.prototype.scrollMove=function(){if(this.mouseDown&&this.tileLayer.isTilesEnabled()){this.tileLayer.setScrollOffset(this.startOffset.x-(this.startX-this.mousePos.x/Runtime.stage.canvasScale),this.startOffset.y-(this.startY-this.mousePos.y/Runtime.stage.canvasScale));this.draw()}};
Canvas.Stage.prototype.removeMove=function(){if(this.mouseDown){var b=Math.floor((this.mousePos.x/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetX())/this.tileLayer.tileSize),c=Math.floor((this.mousePos.y/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetY())/this.tileLayer.tileSize);this.tileLayer.removeTile(b,c);this.draw()}};
Canvas.Stage.prototype.placeMove=function(){if(this.mouseDown){var b=Math.floor((this.mousePos.x/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetX())/this.tileLayer.tileSize),c=Math.floor((this.mousePos.y/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetY())/this.tileLayer.tileSize);this.tileLayer.placeTile(b,c,this.tileLayer.currentTileType);for(var d=-Canvas.tileSize;d<=Canvas.tileSize;d++)for(var e=-Canvas.tileSize;e<=Canvas.tileSize;e++)this.tileLayer.placeTile(b+d,c+e,this.tileLayer.currentTileType);
this.draw()}};Canvas.Stage.prototype.onScroll=function(b){if(this.tileLayer.isTilesEnabled()&&Runtime._blockEvents){b=getScrollVectors(b);this.tileLayer.setScrollOffset(this.tileLayer.getScrollOffsetX()+b.x,this.tileLayer.getScrollOffsetY()+b.y);this.draw()}};
Canvas.Stage.prototype.onMouseUp=function(b){self.mouseDown=false;Runtime.keys.mouse=false;Runtime.keys["mouse-right"]=false;if(Runtime.isRunning())this.selectUp(b);else if(b.ctrlKey||b.metaKey||b.shiftKey)this.scrollUp(b);else if(this.designMode=="remove")this.removeUp(b);else if(this.designMode=="scroll")this.scrollUp(b);else if(this.designMode=="place")this.placeUp(b);else{this.selectUp(b);this.scrollUp(b)}};
Canvas.Stage.prototype.selectUp=function(){if(this._save){this._save.dragMode=this.dragMode;if(window.IDE){window.IDE.Clipboard.undoStage(this._save);window.IDE.dirty()}}this.mouseDown=false;this.dragMode="";var b=Date.now(),c=this.mousePos.x/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetX(),d=this.mousePos.y/Runtime.stage.canvasScale-this.tileLayer.getScrollOffsetY();if(this.selectedActor){var e=this.selectedActor;this.selectedActor=null;this.draw();c>=this.startX-4&&c<=this.startX+4&&
d>=this.startY-4&&d<=this.startY+4&&b-this.lastMouseUp<500&&this.broadcastListeners("doubleclicked",e)}else c>=this.startX-4&&c<=this.startX+4&&d>=this.startY-4&&d<=this.startY+4&&b-this.lastMouseUp<500&&this.broadcastListeners("doubleclicked",null);this.lastMouseUp=b};Canvas.Stage.prototype.removeUp=function(){this.mouseDown=false};Canvas.Stage.prototype.scrollUp=function(){this.mouseDown=false};Canvas.Stage.prototype.placeUp=function(){this.mouseDown=false};
Canvas.Stage.prototype.setMousePosition=function(b,c){var d=this.getContainerPos(),e=b-d.left+window.pageXOffset,d=c-d.top+window.pageYOffset;this.mousePos=this.width>0&&this.height>0?{x:e*this.width/this.container.offsetWidth,y:d*this.height/this.container.offsetHeight}:this.width==0&&this.height==0?{x:e,y:d}:{x:e*-this.width/this.container.offsetWidth,y:d*-this.height/this.container.offsetHeight};this.broadcastListeners("mousemoved",this.mousePos)};
Canvas.Stage.prototype.getContainerPos=function(){var b=$(this.actorsLayer.canvas);return{left:b.offset().left,top:b.offset().top}};Canvas.Stage.prototype.add=function(b){b.stage=this;b.id=this.id++;if(b.zIndex==void 0)b.zIndex=b.id;this.actors.push(b);b.draw(this.actorsLayer,this.tileLayer);this.actors.sort(function(b,d){return b.sortorder-d.sortorder});this.actors.sort(function(b,d){return b.zIndex-d.zIndex})};
Canvas.Stage.prototype.remove=function(b){b.physicsBody&&Physics.removeBody(b.physicsBody);for(var c=0;c<this.actors.length;c++)if(this.actors[c].id==b.id){this.actors.splice(c,1);break}};Canvas.Stage.prototype.removeAll=function(){this.actors=[]};
Canvas.Stage.prototype.draw=function(){this.backgroundLayer.context.mozImageSmoothingEnabled=false;this.tileLayer.context.mozImageSmoothingEnabled=false;this.penLayer.context.mozImageSmoothingEnabled=false;this.actorsLayer.context.mozImageSmoothingEnabled=false;this.actorsLayer.clear();var b=this.actorsLayer.context;b.save();b.scale(Runtime.stage.canvasScale,Runtime.stage.canvasScale);this.tileLayer.draw();for(var c=0;c<this.actors.length;c++)this.actors[c].draw(this.actorsLayer,this.tileLayer);this.text&&
this.drawBubble(this.text,this.actorsLayer,this.bubble);for(c=0;c<this.actors.length;c++)this.actors[c].drawBubble(this.actorsLayer,this.tileLayer);if(this.drawGrid){c=this.actorsLayer.context;c.save();c.strokeStyle="#555555";c.fillStyle="#555555";var d=parseInt(20*c.canvas.width/600);c.lineWidth=parseInt(2*c.canvas.width/600);c.font="normal "+d+"px Arial";d=10*parseInt(c.canvas.width/600);c.beginPath();c.moveTo(0,c.canvas.height/2);c.lineTo(c.canvas.width,c.canvas.height/2);c.stroke();c.beginPath();
c.moveTo(c.canvas.width/4,c.canvas.height/2-d/2);c.lineTo(c.canvas.width/4,c.canvas.height/2+d/2);c.stroke();c.beginPath();c.moveTo(c.canvas.width*3/4,c.canvas.height/2-d/2);c.lineTo(c.canvas.width*3/4,c.canvas.height/2+d/2);c.stroke();c.beginPath();c.moveTo(c.canvas.width/2,0);c.lineTo(c.canvas.width/2,c.canvas.height);c.stroke();c.beginPath();c.moveTo(c.canvas.width/2-d/2,c.canvas.height/4);c.lineTo(c.canvas.width/2+d/2,c.canvas.height/4);c.stroke();c.beginPath();c.moveTo(c.canvas.width/2-d/2,c.canvas.height*
3/4);c.lineTo(c.canvas.width/2+d/2,c.canvas.height*3/4);c.stroke();c.textAlign="left";c.textBaseline="bottom";c.fillText("("+Math.floor(-this.tileLayer.getScrollOffsetX())+", "+Math.floor(this.tileLayer.getScrollOffsetY())+")",c.canvas.width/2+2,c.canvas.height/2-2);c.textAlign="left";c.textBaseline="bottom";c.fillText("("+Math.floor(-c.canvas.width/2-this.tileLayer.getScrollOffsetX())+", "+Math.floor(this.tileLayer.getScrollOffsetY())+")",2,c.canvas.height/2-2);c.textAlign="right";c.textBaseline=
"bottom";c.fillText("("+Math.floor(c.canvas.width/2-this.tileLayer.getScrollOffsetX())+", "+Math.floor(this.tileLayer.getScrollOffsetY())+")",c.canvas.width-2,c.canvas.height/2-2);c.textAlign="left";c.textBaseline="top";c.fillText("("+Math.floor(-this.tileLayer.getScrollOffsetX())+", "+Math.floor(c.canvas.height/2+this.tileLayer.getScrollOffsetY())+")",c.canvas.width/2+2,2);c.textAlign="left";c.textBaseline="bottom";c.fillText("("+Math.floor(-this.tileLayer.getScrollOffsetX())+", "+Math.floor(-c.canvas.height/
2+this.tileLayer.getScrollOffsetY())+")",c.canvas.width/2+2,c.canvas.height-2);c.restore()}b.restore()};
Canvas.Stage.prototype.drawBubble=function(b,c,d,e,f){var g,h;if(b){var c=c.context,j=parseFloat(d.font.split(" ")[1]);if(isNaN(j)){j=parseFloat(d.font.split(" ")[2]);isNaN(j)&&(j=18)}var k=j/2,l=this.getWidth()-k*2;c.font=d.font;c.lineWidth=d.penWidth;var b=breakLines(b,c,l).lines,l=-d.penWidth/2,m=-d.penWidth/2,n=this.getWidth()+d.penWidth,q=k*2+b.length*(j+bubbleFontLinePadding);c.strokeStyle=d.penColor;c.fillStyle=d.fillColor?d.fillColor:"#ffffff";switch(d.style){case "oval":c.save();c.beginPath();
c.translate(l+n/2,m+q/2);var p=Math.sqrt(n*n/4+q*q/4),s=n/Math.SQRT2/p,r=q/Math.SQRT2/p;c.scale(s,r);h=p*Math.cos(50*Math.PI/180);g=p*Math.sin(50*Math.PI/180);Math.cos(40*Math.PI/180);Math.sin(40*Math.PI/180);c.moveTo(h,g);c.arc(0,0,p,50*Math.PI/180,40*Math.PI/180,false);e!==void 0&&f!==void 0&&c.lineTo((e-l-n/2)/s,(f-m-q/2)/r);c.closePath();c.restore();c.fill();c.stroke();break;case "thought":case "thought-block":c.save();c.beginPath();c.translate(l+n/2,m+q/2);p=Math.sqrt(n*n/4+q*q/4);c.save();s=
n/Math.SQRT2/p;r=q/Math.SQRT2/p;c.scale(s,r);c.moveTo(p,0);c.arc(0,0,p,0,2*Math.PI,false);c.closePath();c.restore();c.fill();c.stroke();h=(p+10)*Math.cos(50*Math.PI/180);g=(p+10)*Math.sin(50*Math.PI/180);c.save();c.translate(h*s,g*r);c.beginPath();c.arc(0,0,10,0,2*Math.PI,false);c.closePath();c.restore();c.fill();c.stroke();c.save();c.translate(h*s+16,g*r+16);c.beginPath();c.arc(0,0,5,0,2*Math.PI,false);c.closePath();c.restore();c.fill();c.stroke();c.restore();break;case "excited":p=Math.sqrt(n*n/
4+q*q/4);s=n/Math.SQRT2/p;r=q/Math.SQRT2/p;c.save();c.translate(l+n/2,m+q/2);c.beginPath();h=p*s*Math.cos(405*Math.PI/180);g=p*r*Math.sin(405*Math.PI/180);c.moveTo(h,g);e!==void 0&&f!==void 0&&c.lineTo(e-l-n/2,f-m-q/2);e=0;for(f=55;f<405;f=f+10){h=p*s*Math.cos(f*Math.PI/180);g=p*r*Math.sin(f*Math.PI/180);c.lineTo(h,g);h=(p+60*(e%2+1))*s*Math.cos((f+5)*Math.PI/180);g=(p+60*(e%2+1))*r*Math.sin((f+5)*Math.PI/180);c.lineTo(h,g);e++}c.closePath();c.restore();c.fill();c.stroke();break;case "rectangular":c.beginPath();
c.moveTo(l,m);c.lineTo(l+n,m);c.lineTo(l+n,m+q);c.lineTo(l+n-k*2,m+q);e!==void 0&&f!==void 0&&c.lineTo(e,f);c.lineTo(l+n-k-j*2,m+q);c.lineTo(l,m+q);c.lineTo(l,m);c.fill();c.stroke();break;default:c.beginPath();c.arc(l+k*2,m+k*2,k*2,180*Math.PI/180,270*Math.PI/180,false);c.lineTo(l+n-k*2,m);c.arc(l+n-k*2,m+k*2,k*2,270*Math.PI/180,0,false);c.lineTo(l+n,m+q-k*2);c.arc(l+n-k*2,m+q-k*2,k*2,0,90*Math.PI/180,false);c.lineTo(l+n-k*2,m+q);e!==void 0&&f!==void 0&&c.lineTo(e,f);c.lineTo(l+n-k-j*2,m+q);c.arc(l+
k*2,m+q-k*2,k*2,90*Math.PI/180,180*Math.PI/180,false);c.lineTo(l,m+k*2);c.fill();c.stroke()}c.strokeStyle=d.fontColor;c.fillStyle=d.fontColor;for(d=0;d<b.length;d++)c.fillText(b[d],l+k,m+k+j+(j+bubbleFontLinePadding)*d);return{left:l,top:m,width:n,height:q}}};
Canvas.Stage.prototype.getBuffer=function(b){if(b)var c=b.getBounds(),d=Math.floor(c.left),e=Math.floor(c.top),f=Math.floor(c.right-c.left+1),c=Math.floor(c.bottom-c.top+1);else{e=d=0;f=this.backgroundLayer.canvas.width;c=this.backgroundLayer.canvas.height}if(f>0&&c>0){if(this.buffer)this.buffer.context.clearRect(d,e,f,c);else{this.buffer={};this.buffer.canvas=document.createElement("canvas");this.buffer.context=this.buffer.canvas.getContext("2d");this.buffer.canvas.width=this.backgroundLayer.canvas.width;
this.buffer.canvas.height=this.backgroundLayer.canvas.height;this.buffer.context.mozImageSmoothingEnabled=false}for(var g=this.backgroundLayer.context.getImageData(d,e,f,c),h=g.data,j=this.penLayer.context.getImageData(d,e,f,c).data,k=0;k<j.length;k=k+4)if(j[k+3]!=0){h[k]=j[k];h[k+1]=j[k+1];h[k+2]=j[k+2];h[k+3]=j[k+3]}this.buffer.context.putImageData(g,d,e);for(k=0;k<this.actors.length;k++)this.actors[k]!=b&&this.actors[k].draw(this.buffer);return this.buffer.context.getImageData(d,e,f,c).data}return[]};
Canvas.Stage.prototype.captureScreenshot=function(b){$("body > canvas.screenshot").detach();var c=$('<canvas class="screenshot" style="display:none" width="'+Runtime.stage.getWidth()+'" height="'+Runtime.stage.getHeight()+'"></canvas>')[0].getContext("2d"),d=Runtime.stage.drawGrid,e=Runtime.stage.tileLayer.drawGrid;Runtime.stage.showGrid(false);Runtime.stage.tileLayer.showGrid(false);Canvas.hideSelections=true;Runtime.stage.draw();c.drawImage(Runtime.stage.backgroundLayer.canvas,0,0);c.drawImage(Runtime.stage.penLayer.canvas,
0,0);c.drawImage(Runtime.stage.tileLayer.canvas,0,0);c.drawImage(Runtime.stage.actorsLayer.canvas,0,0);Canvas.hideSelections=false;Runtime.stage.showGrid(d);Runtime.stage.tileLayer.showGrid(e);return b?c.canvas:c.canvas.toDataURL()};
Canvas.Layer=function(b,c){this.canvas=document.createElement("canvas");c||(c="2d");this.context=this.canvas.getContext(c);this.canvas.width=b.container.offsetWidth;this.canvas.height=b.container.offsetHeight;this.canvas.style.position="absolute";this.canvas.style.left="0px";this.canvas.style.top="0px";if(c=="2d")this.context.mozImageSmoothingEnabled=false;this.actors=[];this.stage=b;b.container.appendChild(this.canvas)};
Canvas.Layer.prototype.clear=function(){this.context.save();this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.context.restore()};
Canvas.Actor=function(b){this.x=b.x?b.x:0;this.y=b.y?b.y:0;this.width=b.image.width;this.height=b.image.height;this.cx=b.cx!==void 0&&b.cx!==null?b.cx:this.width/2;this.cy=b.cy!==void 0&&b.cy!==null?b.cy:this.height/2;this.rotation=b.rotation?b.rotation:0;this.scale={x:b.scale?b.scale:1,y:b.scale?b.scale:1};this.image=b.image;this.visible=b.visible===void 0?true:b.visible;this.rotateLock=b.rotateLock?b.rotateLock:0;this.selectable=b.selectable===void 0?true:b.selectable;this.draggable=b.draggable?
true:false;this.alpha=1;this.zIndex=b.zIndex};Canvas.Actor.prototype.show=function(){this.visible=true};Canvas.Actor.prototype.hide=function(){this.visible=false};Canvas.Actor.prototype.setDraggable=function(b){this.draggable=b};
Canvas.Actor.prototype.setScale=function(b){if(typeof b=="number"&&isFinite(b)){b<1.0E-4?b=1.0E-4:this.width*b>Runtime.stage.width*4?b=Runtime.stage.width*4/this.width:this.height*b>Runtime.stage.height*4&&(b=Runtime.stage.height*4/this.height);this.scale.x=b;this.scale.y=b;this.physicsBody&&Physics.updateBody(this,{})}};
Canvas.Actor.prototype.changeScale=function(b){if(typeof b=="number"&&isFinite(b)){this.scale.x=this.scale.x*b;this.scale.y=this.scale.y*b;this.physicsBody&&Physics.updateBody(this,{})}};
Canvas.Actor.prototype.setPosition=function(b,c){if(typeof b=="number"&&isFinite(b)&&typeof c=="number"&&isFinite(c)){this.x=b;this.y=c;if(this.emitter){this.emitter.p.x=this.x;this.emitter.p.y=this.y}if(this.physicsBody){this.physicsBody.SetAwake(true);var d=this.physicsBody.GetAngle();this.physicsBody.SetTransform({position:new b2Vec2(this.x/Physics.scale,this.y/Physics.scale),GetAngle:function(){return d}})}}};
Canvas.Actor.prototype.setPosition2=function(b,c){if(typeof b=="number"&&isFinite(b)&&typeof c=="number"&&isFinite(c)){this.x=b;this.y=c;if(this.emitter){this.emitter.p.x=this.x;this.emitter.p.y=this.y}}};
Canvas.Actor.prototype.move=function(b,c){if(typeof b=="number"&&isFinite(b)&&typeof c=="number"&&isFinite(c)){this.x=this.x+b;this.y=this.y+c;if(this.emitter){this.emitter.p.x=this.x;this.emitter.p.y=this.y}if(this.physicsBody){this.physicsBody.SetAwake(true);var d=this.physicsBody.GetAngle();this.physicsBody.SetTransform({position:new b2Vec2(this.x/Physics.scale,this.y/Physics.scale),GetAngle:function(){return d}})}}};
Canvas.Actor.prototype.setRotation=function(b){if(typeof b=="number"&&isFinite(b)){var c=b%360;c<0&&(c=360+c);this.rotation=c;if(this.physicsBody){this.physicsBody.SetAngularVelocity(0);this.physicsBody.SetTransform({position:this.physicsBody.GetPosition(),GetAngle:function(){return c*Math.PI/180}})}}};Canvas.Actor.prototype.setRotation2=function(b){if(typeof b=="number"&&isFinite(b)){b=b%360;b<0&&(b=360+b);this.rotation=b}};
Canvas.Actor.prototype.rotate=function(b){if(typeof b=="number"&&isFinite(b)){var c=(this.rotation+b)%360;c<0&&(c=360+c);this.rotation=c;if(this.physicsBody){this.physicsBody.SetAngularVelocity(0);this.physicsBody.SetTransform({position:this.physicsBody.GetPosition(),GetAngle:function(){return c*Math.PI/180}})}}};Canvas.Actor.prototype.setRotateLock=function(b){this.rotateLock=b;b!=0?Physics.updateBody(this,{fixedRotation:true}):Physics.updateBody(this,{})};
Canvas.Actor.prototype.setSpriteImg=function(b,c,d){this.drawFunction=null;this.image=b;this.cx=c;this.cy=d;if(this.cx===void 0||this.cx===null)this.cx=b.width/2;if(this.cy===void 0||this.cy===null)this.cy=b.height/2;if(this.width!=b.width||this.height!=b.height){this.width=b.width;this.height=b.height;Physics.updateBody(this,{})}};
Canvas.Actor.prototype.setSpriteDraw=function(b,c,d){if(!this.drawFunction&&b){this.drawFunction=b;this.cx=c/2;this.cy=d/2;if(this.width!=c||this.height!=d){this.width=c;this.height=d;Physics.updateBody(this,{})}}};Canvas.Actor.prototype.isImage=function(){return this.drawFunction==null};
Canvas.Actor.prototype.getImageData=function(){var b=this.getBounds(),c=Math.floor(b.right-b.left+1),d=Math.floor(b.bottom-b.top+1);if(c>0&&d>0){if(!this.canvas||this.canvas.width<c||this.canvas.height<d){this.canvas&&$(this.canvas).detach();this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.canvas.width=c;this.canvas.height=d;this.context.mozImageSmoothingEnabled=false}this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.context.save();this.context.translate((b.right-
b.left)/2,(b.bottom-b.top)/2);this.rotation!==0&&this.rotateLock==0&&this.context.rotate(this.rotation*Math.PI/180);this.scale.x!=1||this.scale.y!=1?this.rotateLock==1&&this.rotation>90&&this.rotation<270?this.context.scale(-this.scale.x,this.scale.y):this.context.scale(this.scale.x,this.scale.y):this.rotateLock==1&&(this.rotation>90&&this.rotation<270)&&this.context.scale(-1,1);this.image&&(this.image.width>0&&this.image.height>0)&&this.context.drawImage(this.image,-this.width/2,-this.height/2,this.width,
this.height);this.context.restore();return this.context.getImageData(0,0,c,d)}return null};Canvas.Actor.prototype.getBuffer=function(){var b=this.getImageData();return b?b.data:[]};Canvas.Actor.prototype.withinBounds=function(b,c){var d=this.getBounds();if(this.isStatic){b=b+Runtime.stage.tileLayer.getScrollOffsetX();c=c+Runtime.stage.tileLayer.getScrollOffsetY()}return b>=d.left&&b<=d.right&&c>=d.top&&c<=d.bottom?true:false};
Canvas.Actor.prototype.containsPoint=function(b,c){var d=this.getBounds();if(b>=d.left&&b<=d.right&&c>=d.top&&c<=d.bottom){if(this.drawFunction)return true;var e=this.getBuffer(),d=Math.floor(b-d.left)*4+Math.floor(c-d.top)*this.canvas.width*4;if((e[d]||e[d+1]||e[d+2])&&e[d+3])return true}return false};Canvas.Actor.prototype.setZIndex=function(b){this.zIndex=b;this.stage&&this.stage.actors.sort(function(b,d){return b.zIndex-d.zIndex})};
Canvas.Actor.prototype.moveToTop=function(){if(this.stage){for(var b=-1,c=0;c<this.stage.actors.length;c++){var d=this.stage.actors[c];if(d.zIndex>b)b=d.zIndex;if(d!=this&&d.zIndex>this.zIndex)d.zIndex=d.zIndex-1}this.zIndex=b;this.stage.actors.sort(function(b,c){return b.zIndex-c.zIndex})}};
Canvas.Actor.prototype.moveToBottom=function(){if(this.stage){for(var b=1E7,c=0;c<this.stage.actors.length;c++){var d=this.stage.actors[c];if(d.zIndex<b)b=d.zIndex;if(d!=this)d.zIndex=d.zIndex+1}this.zIndex=b;this.stage.actors.sort(function(b,c){return b.zIndex-c.zIndex})}};
Canvas.Actor.prototype.moveBack=function(b){if(this.stage){for(var b=this.zIndex-b,c=0;c<this.stage.actors.length;c++){var d=this.stage.actors[c];if(d!=this&&d.zIndex>=b)d.zIndex=d.zIndex+1}this.zIndex=b;this.stage.actors.sort(function(b,c){return b.zIndex-c.zIndex})}};
Canvas.Actor.prototype.moveFront=function(b){if(this.stage){b=this.zIndex+b;if(b>this.stage.actors.length)b=this.stage.actors.length;for(var c=0;c<this.stage.actors.length;c++){var d=this.stage.actors[c];if(d!=this&&d.zIndex>=b)d.zIndex=d.zIndex-1}this.zIndex=b;this.stage.actors.sort(function(b,c){return b.zIndex-c.zIndex})}};
Canvas.Actor.prototype.getBounds=function(){var b=1;if(this.scale.x!=1)b=this.scale.x;var c=-this.cx*b,d=(-this.cx+this.width)*b,e=-this.cy*b,b=(-this.cy+this.height)*b;if(this.rotateLock==1&&this.rotation>90&&this.rotation<270)var f=c,c=d,d=f;if(this.rotateLock==0)var g=Math.PI*this.rotation/180,f=[c*Math.cos(g)-e*Math.sin(g),c*Math.sin(g)+e*Math.cos(g)],h=[d*Math.cos(g)-e*Math.sin(g),d*Math.sin(g)+e*Math.cos(g)],j=[c*Math.cos(g)-b*Math.sin(g),c*Math.sin(g)+b*Math.cos(g)],b=[d*Math.cos(g)-b*Math.sin(g),
d*Math.sin(g)+b*Math.cos(g)];else{f=[c,e];h=[d,e];j=[c,b];b=[d,b]}c=this.x+Math.min(f[0],Math.min(h[0],Math.min(j[0],b[0])));d=this.x+Math.max(f[0],Math.max(h[0],Math.max(j[0],b[0])));e=this.y+Math.min(f[1],Math.min(h[1],Math.min(j[1],b[1])));b=this.y+Math.max(f[1],Math.max(h[1],Math.max(j[1],b[1])));return{left:c,top:e,right:d,bottom:b}};
Canvas.Actor.prototype.draw=function(b,c){var d=b.context;if(this.visible){d.save();if(this.x!==0||this.y!==0)c&&!this.isStatic?d.translate(this.x+c.getScrollOffsetX(),this.y+c.getScrollOffsetY()):d.translate(this.x,this.y);this.rotation!==0&&this.rotateLock==0&&d.rotate(this.rotation*Math.PI/180);this.scale.x!=1||this.scale.y!=1?this.rotateLock==1&&this.rotation>90&&this.rotation<270?d.scale(-this.scale.x,this.scale.y):d.scale(this.scale.x,this.scale.y):this.rotateLock==1&&(this.rotation>90&&this.rotation<
270)&&d.scale(-1,1);d.globalAlpha=this.alpha;this.drawFunction?this.drawFunction(d):this.image&&(this.image.width>0&&this.image.height>0)&&d.drawImage(this.image,-this.cx+(this.width-this.image.width)/2,-this.cy+(this.height-this.image.height)/2,this.image.width,this.image.height);if(this.label){d.save();this.rotateLock==1&&(this.rotation>90&&this.rotation<270)&&d.scale(-1,1);d.strokeStyle=this.fontColor;d.fillStyle=this.fontColor;d.lineWidth=this.penWidth;d.font=this.font;d.textAlign="center";d.textBaseline=
"middle";d.fillText(this.label,0,0);d.restore()}d.restore()}Runtime.redrawSprite(this.sprite,b);if(!Canvas.hideSelections&&this.selected){d.save();if(this.x!==0||this.y!==0)c&&!this.isStatic?d.translate(this.x+c.getScrollOffsetX(),this.y+c.getScrollOffsetY()):d.translate(this.x,this.y);if(Runtime.stage.dragMode=="rotate"){if(this.rotation!==0&&this.rotateLock==0){var e;e=c?90+180/Math.PI*Math.atan2(Runtime.stage.mousePos.y/Runtime.stage.canvasScale-c.getScrollOffsetY()-Runtime.stage.selectedActor.y,
Runtime.stage.mousePos.x/Runtime.stage.canvasScale-c.getScrollOffsetX()-Runtime.stage.selectedActor.x):90+180/Math.PI*Math.atan2(Runtime.stage.mousePos.y/Runtime.stage.canvasScale-Runtime.stage.selectedActor.y,Runtime.stage.mousePos.x/Runtime.stage.canvasScale-Runtime.stage.selectedActor.x);d.rotate(e*Math.PI/180)}e=this.rotation;this.rotation=Runtime.stage.origVal;var f=this.getBounds();this.rotation=e}else f=this.getBounds();f.left=f.left-this.x;f.right=f.right-this.x;f.top=f.top-this.y;f.bottom=
f.bottom-this.y;d.strokeStyle="#000";d.fillStyle="#fff";d.lineWidth=2;d.dashedLine(f.left-Canvas.boxPadding,f.top-Canvas.boxPadding,f.right+Canvas.boxPadding,f.top-Canvas.boxPadding,5);d.dashedLine(f.right+Canvas.boxPadding,f.top-Canvas.boxPadding,f.right+Canvas.boxPadding,f.bottom+Canvas.boxPadding,5);d.dashedLine(f.right+Canvas.boxPadding,f.bottom+Canvas.boxPadding,f.left-Canvas.boxPadding,f.bottom+Canvas.boxPadding,5);d.dashedLine(f.left-Canvas.boxPadding,f.bottom+Canvas.boxPadding,f.left-Canvas.boxPadding,
f.top-Canvas.boxPadding,5);d.beginPath();d.arc(f.left-Canvas.boxPadding,f.top-Canvas.boxPadding,Canvas.handleRadius,0,Math.PI*2,true);d.stroke();d.fill();d.beginPath();d.arc(f.right+Canvas.boxPadding,f.top-Canvas.boxPadding,Canvas.handleRadius,0,Math.PI*2,true);d.stroke();d.fill();d.beginPath();d.arc(f.left-Canvas.boxPadding,f.bottom+Canvas.boxPadding,Canvas.handleRadius,0,Math.PI*2,true);d.stroke();d.fill();d.beginPath();d.arc(f.right+Canvas.boxPadding,f.bottom+Canvas.boxPadding,Canvas.handleRadius,
0,Math.PI*2,true);d.stroke();d.fill();d.beginPath();d.arc((f.right+f.left)/2,f.top-Canvas.boxPadding*3,Canvas.handleRadius,0,Math.PI*2,true);d.moveTo((f.right+f.left)/2,f.top-Canvas.boxPadding*3);d.lineTo((f.right+f.left)/2,f.top-Canvas.boxPadding);d.stroke();d.fill();d.beginPath();d.arc(f.left-Canvas.boxPadding,(f.top+f.bottom)/2,Canvas.handleRadius,0,Math.PI*2,true);d.stroke();d.fill();d.beginPath();d.arc(f.right+Canvas.boxPadding,(f.top+f.bottom)/2,Canvas.handleRadius,0,Math.PI*2,true);d.stroke();
d.fill();d.beginPath();d.arc((f.left+f.right)/2,f.top-Canvas.boxPadding,Canvas.handleRadius,0,Math.PI*2,true);d.stroke();d.fill();d.beginPath();d.arc((f.left+f.right)/2,f.bottom+Canvas.boxPadding,Canvas.handleRadius,0,Math.PI*2,true);d.stroke();d.fill();d.closePath();d.restore()}};
Canvas.Actor.prototype.drawBubble=function(b,c){if(this.visible&&this.text){if(this.bubble.dock=="top")return b.stage.drawBubble(this.text,b,this.bubble,this.x,this.y);var d=b.context;d.save();if(this.x!==0||this.y!==0)c?d.translate(this.x+c.getScrollOffsetX(),this.y+c.getScrollOffsetY()):d.translate(this.x,this.y);var e=parseFloat(this.bubble.font.split(" ")[1]),f=e/2;d.font=this.bubble.font;d.lineWidth=this.bubble.penWidth;var g=b.canvas.width,h=true,g=b.canvas.width-(this.x+(-this.cx+this.width)*
this.scale.x+f*4),j=this.x-this.cx*this.scale.x-f*4;if(j>g)if(this.bubble.width>0){g=b.canvas.width*this.bubble.width/100;h=false}else if(this.bubble.width<0)g=b.canvas.width*this.bubble.width/-100;else{g=j;h=false}else if(this.bubble.width>0)g=b.canvas.width*this.bubble.width/100;else if(this.bubble.width<0){g=b.canvas.width*this.bubble.width/-100;h=false}var j=breakLines(this.text,d,g),g=j.lines,j=j.textWidth,k=e*2;j<k&&(j=k);var l=j+f*2;l<e*4&&(l=e*4);var m=f*2+g.length*(e+bubbleFontLinePadding),
j=h?(-this.cx+this.width)*this.scale.x+f:-this.cx*this.scale.x-f-l,k=-this.cy*this.scale.x-e-f*2-g.length*(e+bubbleFontLinePadding);this.y+k<0&&(k=-this.y);d.strokeStyle=this.bubble.penColor;d.fillStyle=this.bubble.fillColor?this.bubble.fillColor:"#ffffff";switch(this.bubble.style){case "oval":d.save();d.beginPath();d.translate(j+l/2,k+m/2);var n=Math.sqrt(l*l/4+m*m/4);d.scale(l/Math.SQRT2/n,m/Math.SQRT2/n);if(h){var h=n*Math.cos(130*Math.PI/180),q=n*Math.sin(130*Math.PI/180),p=n*Math.cos(140*Math.PI/
180),s=n*Math.sin(140*Math.PI/180);d.moveTo(p,s);d.arc(0,0,n,140*Math.PI/180,130*Math.PI/180,false);d.lineTo(h-e,q+e*4)}else{h=n*Math.cos(50*Math.PI/180);q=n*Math.sin(50*Math.PI/180);Math.cos(40*Math.PI/180);Math.sin(40*Math.PI/180);d.moveTo(h,q);d.arc(0,0,n,50*Math.PI/180,40*Math.PI/180,false);d.lineTo(h+e,q+e*4)}d.closePath();d.restore();d.fill();d.stroke();break;case "thought":case "thought-block":d.save();d.beginPath();d.translate(j+l/2,k+m/2);n=Math.sqrt(l*l/4+m*m/4);d.save();p=l/Math.SQRT2/
n;s=m/Math.SQRT2/n;d.scale(p,s);d.moveTo(n,0);d.arc(0,0,n,0,2*Math.PI,false);d.closePath();d.restore();d.fill();d.stroke();if(h){h=(n+10)*Math.cos(135*Math.PI/180);q=(n+10)*Math.sin(135*Math.PI/180);d.save();d.translate(h*p,q*s+10);d.beginPath();d.arc(0,0,10,0,2*Math.PI,false);d.closePath();d.restore();d.fill();d.stroke();d.save();d.translate(h*p-16,q*s+30)}else{h=(n+10)*Math.cos(50*Math.PI/180);q=(n+10)*Math.sin(50*Math.PI/180);d.save();d.translate(h*p,q*s+10);d.beginPath();d.arc(0,0,10,0,2*Math.PI,
false);d.closePath();d.restore();d.fill();d.stroke();d.save();d.translate(h*p+16,q*s+30)}d.beginPath();d.arc(0,0,5,0,2*Math.PI,false);d.closePath();d.restore();d.fill();d.stroke();d.restore();break;case "excited":n=Math.sqrt(l*l/4+m*m/4);p=l/Math.SQRT2/n;s=m/Math.SQRT2/n;d.save();d.translate(j+l/2,k+m/2);d.beginPath();if(h){var h=135,q=n*p*Math.cos((h+360-15)*Math.PI/180),r=n*s*Math.sin((h+360-15)*Math.PI/180);d.moveTo(q,r);d.lineTo(q-60,r+30)}else{h=60;q=n*p*Math.cos((h+360-15)*Math.PI/180);r=n*
s*Math.sin((h+360-15)*Math.PI/180);d.moveTo(q,r);d.lineTo(q+40,r+30)}for(var o=0,t=h;t<h+360-15;t=t+15){q=n*p*Math.cos(t*Math.PI/180);r=n*s*Math.sin(t*Math.PI/180);d.lineTo(q,r);q=(n+20*(o%2+1))*p*Math.cos((t+7.5)*Math.PI/180);r=(n+20*(o%2+1))*s*Math.sin((t+7.5)*Math.PI/180);d.lineTo(q,r);o++}d.closePath();d.restore();d.fill();d.stroke();break;case "rectangular":d.beginPath();d.moveTo(j,k);d.lineTo(j+l,k);d.lineTo(j+l,k+m);if(h){d.lineTo(j+f+e*2,k+m);d.lineTo(j,k+m+e*2);d.lineTo(j+f*2,k+m)}else{d.lineTo(j+
l-f*2,k+m);d.lineTo(j+l,k+m+e*2);d.lineTo(j+l-f-e*2,k+m)}d.lineTo(j,k+m);d.lineTo(j,k);d.fill();d.stroke();break;default:d.beginPath();d.arc(j+f*2,k+f*2,f*2,180*Math.PI/180,270*Math.PI/180,false);d.lineTo(j+l-f*2,k);d.arc(j+l-f*2,k+f*2,f*2,270*Math.PI/180,0,false);d.lineTo(j+l,k+m-f*2);d.arc(j+l-f*2,k+m-f*2,f*2,0,90*Math.PI/180,false);if(h){d.lineTo(j+f+e*2,k+m);d.lineTo(j,k+m+e*2);d.lineTo(j+f*2,k+m)}else{d.lineTo(j+l-f*2,k+m);d.lineTo(j+l,k+m+e*2);d.lineTo(j+l-f-e*2,k+m)}d.arc(j+f*2,k+m-f*2,f*2,
90*Math.PI/180,180*Math.PI/180,false);d.lineTo(j,k+f*2);d.fill();d.stroke()}d.strokeStyle=this.bubble.fontColor;d.fillStyle=this.bubble.fontColor;for(n=0;n<g.length;n++)d.fillText(g[n],j+f,k+f+e+(e+bubbleFontLinePadding)*n);d.restore();return{left:this.x+j,top:this.y+k,width:l,height:m}}};
Canvas.TileLayer=function(b){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.canvas.width=b.container.offsetWidth;this.canvas.height=b.container.offsetHeight;this.canvas.style.position="absolute";this.context.mozImageSmoothingEnabled=false;this.stage=b;this.scrollBgOffset=this.drawGrid=false;this.mapHeight=this.mapWidth=50;this.tileSize=80;this.camera=null;this.scrollOffset={x:0,y:0};this.enabled=false;this.tiles=[];this.map=[];this.blockBounds={};this.fixtures=
{};this._tileMapping=[15,15,15,15,20,27,20,27,21,21,28,28,18,16,17,30,19,19,19,19,4,23,4,23,5,5,24,24,1,8,9,29,22,22,22,22,13,13,13,13,14,14,14,14,25,25,25,25,26,26,26,26,11,11,11,11,12,12,12,12,10,10,10,10];this._tdTileMapping=[8,4,5,1,6,11,12,16,7,9,10,15,2,14,13,3,8,4,5,1,6,19,12,32,7,9,10,15,2,35,13,44,8,4,5,1,6,11,21,36,7,9,10,15,2,14,33,41,8,4,5,1,6,19,21,20,7,9,10,15,2,35,33,49,8,4,5,1,6,11,12,16,7,25,10,38,2,31,13,43,8,4,5,1,6,19,5,32,7,25,10,38,2,22,13,52,8,4,5,1,6,11,21,36,7,25,10,38,2,
31,33,39,8,4,5,1,6,19,21,20,7,25,10,38,2,22,33,45,8,4,5,1,6,11,12,16,7,9,27,34,2,14,37,42,8,4,5,1,6,19,12,32,7,9,27,34,2,35,37,40,8,4,5,1,6,11,21,36,7,9,27,34,2,14,24,50,8,4,5,1,6,19,21,20,7,9,27,34,2,35,24,46,8,4,5,1,6,11,12,16,7,25,27,26,2,31,37,51,8,4,5,1,6,19,12,32,7,25,27,26,2,22,37,48,8,4,5,1,6,11,21,36,7,25,27,26,2,31,24,47,8,4,5,1,6,19,21,20,7,25,27,26,2,22,24,23];this.animatedIntervalId=-1;this.animatedIntervalIndex=0;this.animationInterval=200;this.currentTileType=1;this._tileSetMapping=
{transparent:0,castle:1,ruins:2,jungle:3,stone:4,stonevines:5,scifi:6,scifiwreck:7,space:8,steampunk:9,steampunkwreck:10,trees:11,clouds:12,ice:13,"fire-":14,"waterfall-":15,coral:16,dirt:17,purplegeode:18,fortress:128,"green trees":129,house:130,dungeon:131,"blue trees":132,"pink trees":133,"yellow trees":134,desert:135,"water-":256,"slime-":257,"acid-":258,grass:259,sand:260,plaingrass:261,plainsand:262,darkgravel:263,gravel:264,mud:265,rock:266,shallowwater:267,deepwater:268,sidewalk1:269,sidewalk2:270,
orangetrack:271,asphalt:272,topsoil:273,hole:274};this._tileSetRevMap={"0":"transparent",1:"castle",2:"ruins",3:"jungle",4:"stone",5:"stonevines",6:"scifi",7:"scifiwreck",8:"space",9:"steampunk",10:"steampunkwreck",11:"trees",12:"clouds",13:"ice",14:"fire-",15:"waterfall-",16:"coral",17:"dirt",18:"purplegeode",128:"fortress",129:"green trees",130:"house",131:"dungeon",132:"blue trees",133:"pink trees",134:"yellow trees",135:"desert",256:"water-",257:"slime-",258:"acid-",259:"grass",260:"sand",261:"plaingrass",
262:"plainsand",263:"darkgravel",264:"gravel",265:"mud",266:"rock",267:"shallowwater",268:"deepwater",269:"sidewalk1",270:"sidewalk2",271:"orangetrack",272:"asphalt",273:"topsoil",274:"hole"};this._tiles={};var c=new Image;c.src=Sprites._blankImg;this._tiles[0]=c;this.blockBounds[0]=[];c=new b2FixtureDef;c.density=1;c.friction=0.5;c.restitution=0.2;this.fixtures[0]=c;for(var d in this._tileSetMapping){var e=this._tileSetMapping[d];if(e>0){this._tiles[e]=null;this.blockBounds[e]=[];this.fixtures[e]=
c}}b.container.appendChild(this.canvas);this.setup();window.IDE&&$(b.container).bind("mousemove",function(){Runtime.stage.draw()})};Canvas.TileLayer.prototype.setup=function(){for(var b in this.blockBounds)this.blockBounds[b]=[];this.map=[];for(b=0;b<this.mapHeight;b++){for(var c=[],d=0;d<this.mapWidth;d++)c.push(0);this.map.push(c)}};
Canvas.TileLayer.prototype.enableTiles=function(b){if(this.enabled!=b){this.enabled=b;this.resetPhysics(Physics.world);Physics.updateWorld();if(!b){this.scrollOffset.x=0;this.scrollOffset.y=0;this.draw()}}};Canvas.TileLayer.prototype.isTilesEnabled=function(){return this.enabled};
Canvas.TileLayer.prototype.setSize=function(b,c){b<=Math.ceil(Runtime.stage.getWidth()/this.tileSize)?b=Math.ceil(Runtime.stage.getWidth()/this.tileSize):b>200&&(b=200);c<=Math.ceil(Runtime.stage.getHeight()/this.tileSize)?c=Math.ceil(Runtime.stage.getHeight()/this.tileSize):c>200&&(c=200);for(var d=[],e=0;e<c&&e<this.map.length;e++){var f=this.map[e];if(b<f.length)f.splice(b,f.length-b);else for(var g=f.length;g<b;g++)f.push(0);d.push(f)}for(e=this.map.length;e<c;e++){f=[];for(g=0;g<b;g++)f.push(0);
d.push(f)}this.map=d;this.mapWidth=b;this.mapHeight=c};Canvas.TileLayer.prototype.getWidth=function(){return this.mapWidth};Canvas.TileLayer.prototype.getHeight=function(){return this.mapHeight};Canvas.TileLayer.prototype.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)};Canvas.TileLayer.prototype.resolveTileName=function(b){b=this._tileSetMapping[b];return b>=0?b:-1};
Canvas.TileLayer.prototype.removeTile=function(b,c){if(b>=0&&b<this.mapWidth&&c>=0&&c<this.mapHeight){this.map[c][b]=0;this.render()}};Canvas.TileLayer.prototype.placeTile=function(b,c,d){if(b>=0&&b<this.mapWidth&&c>=0&&c<this.mapHeight){this.map[c][b]=d<<8|1;this.render()}};Canvas.TileLayer.prototype.getTile=function(b,c){if(b>=0&&b<this.mapWidth&&c>=0&&c<this.mapHeight){var d=this.map[c][b]>>8;if(this.map[c][b]!=0&&d>=0&&this._tileSetRevMap[d])return this._tileSetRevMap[d]}return""};
Canvas.TileLayer.prototype.render=function(){for(var b=0;b<this.map.length;b++)for(var c=this.map[b],d=0;d<c.length;d++)if(c[d]){var e=c[d]&4294967040,f=d>0,g=d<c.length-1,h=b>0,j=b<this.map.length-1,k=b<this.map.length-2;if(c[d]>=32512){var l=f&&(c[d-1]&4294967040)==e,m=g&&(c[d+1]&4294967040)==e,n=h&&(this.map[b-1][d]&4294967040)==e,q=j&&(this.map[b+1][d]&4294967040)==e,p=h&&f&&(this.map[b-1][d-1]&4294967040)==e,h=h&&g&&(this.map[b-1][d+1]&4294967040)==e,f=j&&f&&(this.map[b+1][d-1]&4294967040)==
e,g=j&&g&&(this.map[b+1][d+1]&4294967040)==e,s=false,r=l,o=m,t=q,u=f,w=g;if(c[d]<65280){if(j&&!k||q&&(this.map[b+2][d]&4294967040)!=e){s=true;l&&(p&&!f)&&(r=false);m&&(h&&!g)&&(o=false);t=false}l&&(p&&!f)&&(r=false);k&&(f&&(this.map[b+2][d-1]&4294967040)!=e)&&(u=false);m&&(h&&!g)&&(o=false);k&&(g&&(this.map[b+2][d+1]&4294967040)!=e)&&(w=false)}j=0;j=j<<1;p&&(j=j|1);j=j<<1;h&&(j=j|1);j=j<<1;u&&(j=j|1);j=j<<1;w&&(j=j|1);j=j<<1;n&&(j=j|1);j=j<<1;t&&(j=j|1);j=j<<1;r&&(j=j|1);j=j<<1;o&&(j=j|1);j=this._tdTileMapping[j];
c[d]<65280&&!s&&(!q&&n)&&(j=l&&m?(f||!p)&&(g||!h)?30:f||!p?28:g||!h?29:17:l?f||!p?30:29:m?g||!h?30:28:30)}else{l=f&&(c[d-1]&4294967040)==e;m=g&&(c[d+1]&4294967040)==e;n=h&&(this.map[b-1][d]&4294967040)==e;q=j&&(this.map[b+1][d]&4294967040)==e;p=f&&h&&(this.map[b-1][d-1]&4294967040)==e;h=g&&h&&(this.map[b-1][d+1]&4294967040)==e;j=0;n&&(j=j|1);j=j<<1;q&&(j=j|1);j=j<<1;l&&(j=j|1);j=j<<1;m&&(j=j|1);j=j<<1;p&&(j=j|1);j=j<<1;h&&(j=j|1);j=this._tileMapping[j]}c[d]=e|j}this.resetPhysics(Physics.world)};
Canvas.TileLayer.prototype.setCamera=function(b){this.camera=b;if(!b){this.scrollOffset.x=0;this.scrollOffset.y=0}this.draw()};
Canvas.TileLayer.prototype.resetPhysics=function(b){for(var c in this.blockBounds){for(var d=this.blockBounds[c],e=0;e<d.length;e++)Physics.removeBody(d[e]);this.blockBounds[c]=[]}if(this.enabled){e=[];for(c=0;c<this.map.length;c++)e.push(this.map[c].slice());d={};for(c in this.blockBounds)d[c]=[];for(var f=0;f<e.length;f++)for(var g=e[f],h=0;h<g.length;h++)if(e[f][h]){var j=e[f][h]>>8;d[j].push(this._getBlock(e,h,f,j))}for(c in d){f=new b2BodyDef;f.type=b2Body.b2_staticBody;g=this.fixtures[c];g.shape=
new b2PolygonShape;h=d[c];for(e=0;e<h.length;e++){j=h[e];g.shape.SetAsBox(j.width*this.tileSize/2/Physics.scale,j.height*this.tileSize/2/Physics.scale);f.position.Set((j.x+j.width/2)*this.tileSize/Physics.scale,(j.y+j.height/2)*this.tileSize/Physics.scale);f.userData=c;j=b.CreateBody(f);j.CreateFixture(g);this.blockBounds[c].push(j)}}}};
Canvas.TileLayer.prototype.setDensity=function(b){b.toString().indexOf(" tiles")==b.length-6&&(b=b.substring(0,b.length-6));b=this._tileSetMapping[b];if(b>=0)for(var b=this.blockBounds[b],c=0;c<b.length;c++){var d=b[c].GetFixtureList();d&&d.SetDensity(density)}};
Canvas.TileLayer.prototype.setFriction=function(b){b.toString().indexOf(" tiles")==b.length-6&&(b=b.substring(0,b.length-6));b=this._tileSetMapping[b];if(b>=0)for(var b=this.blockBounds[b],c=0;c<b.length;c++){var d=b[c].GetFixtureList();d&&d.SetFriction(density)}};
Canvas.TileLayer.prototype.setRestitution=function(b){b.toString().indexOf(" tiles")==b.length-6&&(b=b.substring(0,b.length-6));b=this._tileSetMapping[b];if(b>=0)for(var b=this.blockBounds[b],c=0;c<b.length;c++){var d=b[c].GetFixtureList();d&&d.SetRestitution(density)}};Canvas.TileLayer.prototype.getDensity=function(b){b.toString().indexOf(" tiles")==b.length-6&&(b=b.substring(0,b.length-6));b=this._tileSetMapping[b];return b>=0?this.fixtures[b].GetDensity():1};
Canvas.TileLayer.prototype.getFriction=function(b){b.toString().indexOf(" tiles")==b.length-6&&(b=b.substring(0,b.length-6));b=this._tileSetMapping[b];return b>=0?this.fixtures[b].GetFriction():0.5};Canvas.TileLayer.prototype.getRestitution=function(b){b.toString().indexOf(" tiles")==b.length-6&&(b=b.substring(0,b.length-6));b=this._tileSetMapping[b];return b>=0?this.fixtures[b].GetRestitution():0.2};
Canvas.TileLayer.prototype.isActive=function(b){b.toString().indexOf(" tiles")==b.length-6&&(b=b.substring(0,b.length-6));b=this._tileSetMapping[b];return b>=0?this.blockBounds[b][0].IsActive():false};Canvas.TileLayer.prototype.setActive=function(b,c){b.toString().indexOf(" tiles")==b.length-6&&(b=b.substring(0,b.length-6));var d=this._tileSetMapping[b];if(d>=0)for(var d=this.blockBounds[d],e=0;e<d.length;e++)d[e].SetActive(c)};
Canvas.TileLayer.prototype._getBlock=function(b,c,d,e){for(var f={x:c,y:d,width:1,height:1},g=c+1;g<b[d].length&&b[d][g]&&b[d][g]>>8==e;g++){f.width++;b[d][g]=0}for(d=d+1;d<b.length;d++){for(var h=0,g=c;g<c+f.width&&b[d][g]&&b[d][g]>>8==e;g++)h++;if(f.width==h){f.height++;for(g=c;g<c+f.width;g++)b[d][g]=0}else break}return f};Canvas.TileLayer.prototype.loadMap=function(b){this.map=b;this.mapHeight=b.length;this.mapWidth=b[0].length;if(b){this.render();Physics.updateWorld()}this.draw()};
Canvas.TileLayer.prototype.getScrollOffset=function(){return{x:this.scrollOffset.x,y:this.scrollOffset.y}};Canvas.TileLayer.prototype.getScrollOffsetX=function(){return this.scrollOffset.x};Canvas.TileLayer.prototype.getScrollOffsetY=function(){return this.scrollOffset.y};
Canvas.TileLayer.prototype.setScrollOffset=function(b,c){var d=this.canvas.width/Runtime.stage.canvasScale-this.mapWidth*this.tileSize;d>0?b=d/2:b>0?b=0:b<d&&(b=d);d=this.canvas.height/Runtime.stage.canvasScale-this.mapHeight*this.tileSize;d>0?c=d/2:c>0?c=0:c<d&&(c=d);this.scrollOffset.x=Math.floor(b);this.scrollOffset.y=Math.floor(c)};Canvas.TileLayer.prototype.showGrid=function(b){this.drawGrid=b;this.draw()};Canvas.TileLayer.prototype.isGridVisible=function(){return this.drawGrid};
Canvas.TileLayer.prototype.draw=function(){this.context.save();this.context.scale(Runtime.stage.canvasScale,Runtime.stage.canvasScale);this.context.clearRect(0,0,this.canvas.width/Runtime.stage.canvasScale,this.canvas.height/Runtime.stage.canvasScale);this.camera&&Runtime.isRunning()&&this.setScrollOffset(-Math.floor(this.camera.x)+this.canvas.width/2/Runtime.stage.canvasScale,-Math.floor(this.camera.y)+this.canvas.height/2/Runtime.stage.canvasScale);var b=this.scrollOffset.x%this.tileSize,c=this.scrollOffset.y%
this.tileSize;if(Runtime.stage.penLayer&&Runtime.stage.penLayer.isStatic){var d=document.getElementById("stage-canvas");Runtime.stage.penLayer.canvas.style.left=this.scrollOffset.x*parseInt(d.style.width)/Runtime.stage.penLayer.canvas.width+"px";Runtime.stage.penLayer.canvas.style.top=this.scrollOffset.y*parseInt(d.style.height)/Runtime.stage.penLayer.canvas.height+"px"}if(this.drawGrid||Runtime.stage.designMode=="place"||Runtime.stage.designMode=="remove"){this.context.save();this.context.strokeStyle=
"#cccccc";this.context.fillStyle="#cccccc";for(var e=c;e<c+this.canvas.height/Runtime.stage.canvasScale;e=e+this.tileSize){this.context.beginPath();this.context.moveTo(0,e);this.context.lineTo(this.canvas.width/Runtime.stage.canvasScale,e);this.context.stroke()}for(var f=b;f<b+this.canvas.width/Runtime.stage.canvasScale;f=f+this.tileSize){this.context.beginPath();this.context.moveTo(f,0);this.context.lineTo(f,this.canvas.height/Runtime.stage.canvasScale);this.context.stroke()}this.context.restore()}if(this.enabled&&
this.map&&this.map.length>0){if(this.camera&&Runtime.isRunning()){Runtime.stage.penLayer.context.setTransform(1,0,0,1,0,0);Runtime.stage.penLayer.context.translate(this.scrollOffset.x,this.scrollOffset.y)}d=Runtime.background.getCurrentCostume();if(this.scrollBgOffset&&d&&d.imgObj){if(Runtime.stage.bgtype=="tile"){Runtime.stage.backgroundOffsetX=Runtime.stage.tileLayer.scrollOffset.x*Runtime.stage.canvasScale;Runtime.stage.backgroundOffsetY=Runtime.stage.tileLayer.scrollOffset.y*Runtime.stage.canvasScale}else{Runtime.stage.backgroundOffsetX=
Runtime.stage.tileLayer.scrollOffset.x*(d.imgObj.width-Runtime.stage.getWidth())/(this.mapWidth*this.tileSize-Runtime.stage.getWidth());Runtime.stage.backgroundOffsetY=Runtime.stage.tileLayer.scrollOffset.y*(d.imgObj.height-Runtime.stage.getHeight())/(this.mapHeight*this.tileSize-Runtime.stage.getHeight())}Runtime.stage.setBackgroundType()}var g=this.scrollOffset.x<0?1:-1,d=g*Math.floor(Math.abs(this.scrollOffset.x)/this.tileSize),g=this.scrollOffset.y<0?1:-1,g=g*Math.floor(Math.abs(this.scrollOffset.y)/
this.tileSize),h=Math.ceil(this.canvas.width/Runtime.stage.canvasScale/this.tileSize),j=Math.ceil(this.canvas.height/Runtime.stage.canvasScale/this.tileSize);d+h>=this.map[0].length&&(h=this.map[0].length-d-1);g+j>=this.map.length&&(j=this.map.length-g-1);var k=0;d<0&&(k=-d);e=0;for(g<0&&(e=-g);e<=j;e++)for(var l=this.map[e+g],f=k;f<=h;f++)if(l[f+d]){var m=l[f+d],n=m>>8;if(m=m&255){m--;var q=this._tiles[n];if(q){q instanceof Array&&(q=q[this.animatedIntervalIndex%4]);q.isReady&&this.context.drawImage(q,
this.tileSize*(m%8),this.tileSize*Math.floor(m/8),this.tileSize,this.tileSize,f*this.tileSize+b,e*this.tileSize+c,this.tileSize+1,this.tileSize+1)}else{m=this._tileSetRevMap[n];if(m[m.length-1]=="-"){for(var p=this,s=[],r=1;r<=4;r++){q=new Image;q.isReady=false;q.onload=function(){this.isReady=true;p.draw()};q.src="ide/level/"+m+r+".png";s.push(q)}p._tiles[n]=s;if(this.animatedIntervalId<0)this.animatedIntervalId=window.setInterval(function(){p.animatedIntervalIndex++;p.draw()},this.animationInterval)}else{p=
this;q=new Image;q.isReady=false;q.onload=function(){this.isReady=true;p.draw()};q.src="ide/level/"+m+".png";p._tiles[n]=q}}}}if(Runtime.stage.designMode=="place")if(q=this._tiles[this.currentTileType]){q instanceof Array&&(q=q[this.animatedIntervalIndex%4]);if(q.isReady){f=Math.floor((Runtime.stage.mousePos.x/Runtime.stage.canvasScale-this.scrollOffset.x)/this.tileSize)-d;e=Math.floor((Runtime.stage.mousePos.y/Runtime.stage.canvasScale-this.scrollOffset.y)/this.tileSize)-g;this.context.drawImage(q,
0,0,this.tileSize,this.tileSize,f*this.tileSize+b,e*this.tileSize+c,this.tileSize,this.tileSize)}}else{m=this._tileSetRevMap[this.currentTileType];if(m[m.length-1]=="-"){p=this;s=[];for(r=1;r<=4;r++){q=new Image;q.isReady=false;q.onload=function(){this.isReady=true;p.draw()};q.src="ide/level/"+m+r+".png";s.push(q)}p._tiles[this.currentTileType]=s;if(this.animatedIntervalId<0)this.animatedIntervalId=window.setInterval(function(){p.animatedIntervalIndex++;p.draw()},this.animationInterval)}else{p=this;
q=new Image;q.isReady=false;q.onload=function(){this.isReady=true;p.draw()};q.src="ide/level/"+m+".png";p._tiles[this.currentTileType]=q}}}this.context.restore()};
$(document).ready(function(){$(window).bind("keydown",function(b){if(!Runtime._blockEvents&&((!window.WinCode||window.WinCode._inputField==null)&&b.target.tagName!="INPUT"&&b.target.tagName!="TEXTAREA"&&$("#win-annotation .jqte").length<=0)&&!b.metaKey)if(b.which==32||b.which==37||b.which==39||b.which==38||b.which==40){Runtime.triggerKeyEvent(b);b.preventDefault()}else Runtime.triggerKeyEvent(b)});$(window).bind("keyup",function(b){if(!Runtime._blockEvents&&((!window.WinCode||window.WinCode._inputField==
null)&&b.target.tagName!="INPUT"&&b.target.tagName!="TEXTAREA"&&$("#win-annotation .jqte").length<=0)&&!b.metaKey)if(b.which==32||b.which==37||b.which==39||b.which==38||b.which==40){Runtime.triggerKeyUpEvent(b);b.preventDefault()}else Runtime.triggerKeyUpEvent(b)});soundManager.url="/ext/swf/";soundManager.useHTML5Audio=true;soundManager.preferFlash=false;soundManager.debugMode=false;soundManager.onready(function(){});soundManager.ontimeout(function(){console.log("sound manager could not start")})});
var Runtime={_blockEvents:!1,_savedActorStates:null,turboMode:!1,aabbCollision:!1,hideRunOutline:!1,runPauseTimeout:250,retainStates:!1,flagTriggers:[],keyTriggers:[],broadcastTriggers:[],collisionTriggers:[],externalTriggers:[],engageExternalTriggers:!1,drawTriggers:[],animationTriggers:[],systemTriggers:[],keys:{},lastKeyPressed:"",isScratch:!1,nextScript:0,runningScripts:[],scriptId:0,scriptsPausedTime:0,startTimer:0,spriteId:1,spriteTriggers:[],sceneChanges:[],stage:null,background:null,sprites:[],
libs:[],askSource:null,askTriggerText:"",currentLevelIndex:0,levels:[],_runtimeListeners:[],blockEvents:function(b){Runtime._blockEvents=b},getScriptId:function(){return Runtime.scriptId++},init:function(){Runtime.background=new Sprite({label:"Background"});Runtime.background.stretch=true;Runtime.background.bgtype="stretch";$("#stage-canvas").empty();var b=$("#stage-canvas")[0],c=$('<video id="webcam" autoplay style="display:none;position:absolute;left:0;right:0;top:0;bottom:0;"></video>');$(b).append(c);
Runtime.stage=new Canvas.Stage(b);Script._saveBubbleStyle(Runtime.stage,Runtime.background);Runtime.stage.bubble.style="rectangular";Runtime.stage.addListener("clicked",function(b){b==null?Runtime.backgroundClicked():Runtime.spriteClicked(b.sprite)});MediaCapture.init();$("#stage-canvas").append('<div class="ask hidden"><span class="image"><img src="ide/imgs/blank.png"/></span><span class="textprompt"></span><span class="prompt input"><input type="text"/><a class="askbutton" href="#">OK</a></span><span class="prompt buttons hidden"></span></div>');
$("#stage-canvas").find("div").click(function(b){var c=$(b.target);if(c[0].tagName=="A"){Runtime.askTriggerText=c.text();b.preventDefault();return true}}).find("input").keydown(function(b){b.keyCode==13&&$("#stage-canvas a.askbutton").focus().click()});Runtime.reset()},reset:function(){this.flagTriggers=[];this.keyTriggers=[];this.broadcastTriggers=[];this.collisionTriggers=[];this.externalTriggers=[];this.engageExternalTriggers=false;this.drawTriggers=[];this.animationTriggers=[];this.systemTriggers=
[];this.keys={};this.lastKeyPressed="";this.isScratch=false;this.runningScripts=[];this.scriptsPausedTime=this.scriptId=0;this.startTimer=Date.now();this.spriteId=1;this.spriteTriggers=[];this.sceneChanges=[];this.sprites=[];this.background=new Sprite({label:"Background"});this.background.stretch=true;this.background.bgtype="stretch";this._broadcastRuntimeListeners("stop");this.stage.setBackground(Sprites._blankImg);this.stage.removeAll();this.stage.draw();Physics.initPhysics();$("#stage-canvas .ask").addClass("hidden");
$("#stage-canvas .prompt-overlay").detach();MediaCapture.hideVideo()},registerScripts:function(b){for(var c=0;c<b.scripts.length;c++){var d=b.scripts[c];if(d.func.substring(0,8)=="register"){d=new Script({sprite:b,scriptBlock:d});d.currentBlock=d.scriptBlock;d.invokeStep()}}},unregisterScripts:function(b){for(var c=0;c<b.scripts.length;c++){var d=b.scripts[c];d.func.substring(0,8)=="register"&&Runtime.unregisterBlock(d,b)}},unregisterBlock:function(b,c){for(var d=0;d<this.flagTriggers.length;d++)if(this.flagTriggers[d].scriptBlock==
b&&(!c||c==this.flagTriggers[d].sprite)){this.flagTriggers.splice(d,1);d--}for(d=0;d<this.keyTriggers.length;d++)if(this.keyTriggers[d].scriptBlock==b&&(!c||c==this.keyTriggers[d].sprite)){this.keyTriggers.splice(d,1);d--}for(d=0;d<this.spriteTriggers.length;d++)if(this.spriteTriggers[d].scriptBlock==b&&(!c||c==this.spriteTriggers[d].sprite)){this.spriteTriggers.splice(d,1);d--}for(d=0;d<this.externalTriggers.length;d++)if(this.externalTriggers[d].scriptBlock==b&&(!c||c==this.externalTriggers[d].sprite)){this.externalTriggers.splice(d,
1);d--}for(d=0;d<this.sceneChanges.length;d++)if(this.sceneChanges[d].scriptBlock==b&&(!c||c==this.sceneChanges[d].sprite)){this.sceneChanges.splice(d,1);d--}for(d=0;d<this.broadcastTriggers.length;d++)if(this.broadcastTriggers[d].scriptBlock==b&&(!c||c==this.broadcastTriggers[d].sprite)){this.broadcastTriggers.splice(d,1);d--}for(d=0;d<this.collisionTriggers.length;d++)if(this.collisionTriggers[d].scriptBlock==b&&(!c||c==this.collisionTriggers[d].sprite)){this.collisionTriggers.splice(d,1);d--}for(d=
0;d<this.drawTriggers.length;d++)if(this.drawTriggers[d].scriptBlock==b&&(!c||c==this.drawTriggers[d].sprite)){this.drawTriggers.splice(d,1);d--}for(d=0;d<this.animationTriggers.length;d++)if(this.animationTriggers[d].scriptBlock==b&&(!c||c==this.animationTriggers[d].sprite)){this.animationTriggers.splice(d,1);d--}for(d=0;d<this.systemTriggers.length;d++)if(this.systemTriggers[d].scriptBlock==b&&(!c||c==this.systemTriggers[d].sprite)){this.systemTriggers.splice(d,1);d--}for(var e=this.runningScripts.length>
0,d=0;d<this.runningScripts.length;d++){var f=this.runningScripts[d];if(f.scriptBlock==b&&(!c||c==f.sprite)){this.runningScripts.splice(d,1);f.running=false;f.scriptBlock.setOutline(false);this.nextScript--}}window.WinCode&&e&&!Runtime.hideRunOutline&&WinCode.draw()},getLibraryByName:function(b){for(var c=null,d=0;d<Runtime.libs.length;d++)if(Runtime.libs[d].classname==b){c=Runtime.libs[d];break}return c},clearLibraries:function(){Runtime.libs=[]},requireLibrary:function(b,c){for(var d=false,e=0;e<
Runtime.libs.length;e++)if(Runtime.libs[e].classname==b){d=Runtime.libs[e];break}d?c&&c(d):$.ajax({url:"api/libraryload.aspx",type:"POST",data:{n:b},success:function(b){b=JSON.parse(b);b=ObjectIO.deserializeLibrary(b);Runtime.libs.push(b);c&&c(b)}})},requireLibraryId:function(b,c){for(var d=false,e=0;e<Runtime.libs.length;e++)if(Runtime.libs[e].classname==b){d=true;break}d||$.ajax({url:"api/libraryload.aspx",type:"POST",data:{id:b},success:function(b){b=JSON.parse(b);b=ObjectIO.deserializeLibrary(b);
Runtime.libs.push(b);c&&c(b)}})},addRuntimeListener:function(b){this._runtimeListeners.indexOf(b)<0&&this._runtimeListeners.push(b)},removeRuntimeListener:function(b){b=this._runtimeListeners.indexOf(b);b>=0&&this._runtimeListeners.splice(b,1)},removeAllRuntimeListeners:function(){this._runtimeListeners=[]},_broadcastRuntimeListeners:function(b,c,d){for(var e=0;e<Runtime._runtimeListeners.length;e++)Runtime._runtimeListeners[e](b,c,d)},_findInboundEvents:function(b){var c=[];if(b.func=="registerBroadcastTrigger"){var d=
b.label.getSocketAtChild(0);d&&(d.label&&d.label.length>0)&&(c=mergeLists(c,d.label))}else if(b.func=="registerFlagTrigger")c=mergeLists(c,"["+b.func+"]");else if(b.func=="registerKeyTrigger"){d=b.label.getSocketAtChild(0);c=mergeLists(c,"["+b.func+"|"+d.label+"]")}else b.func=="registerSpriteTrigger"&&(c=mergeLists(c,"["+b.func+"]"));return c},_findOutboundEvents:function(b){var c=[];if(b instanceof Block){if(b.func=="blockControlBroadcast"||b.func=="blockControlBroadcastWait"||b.func=="blockControlPostMessage"||
b.func=="blockControlPostMessageAndWait"){var d=b.label.getSocketAtChild(0);d&&(d.label&&d.label.length>0)&&c.push(d.label)}for(d=0;d<b._containers.length;d++)c=mergeLists(c,Runtime._findOutboundEvents(b._containers[d]));b.next&&(c=mergeLists(c,Runtime._findOutboundEvents(b.next)))}return c},_findEvents:function(b){var c=[];if(b instanceof Block){if(b.func=="registerBroadcastTrigger"||b.func=="blockControlBroadcast"||b.func=="blockControlBroadcastWait"||b.func=="blockControlPostMessage"||b.func==
"blockControlPostMessageAndWait"){var d=b.label.getSocketAtChild(0);d&&(d.label&&d.label.length>0)&&c.push(d.label)}for(d=0;d<b._containers.length;d++)c=mergeLists(c,Runtime._findEvents(b._containers[d]));b.next&&(c=mergeLists(c,Runtime._findEvents(b.next)))}return c},findAnimationsFor:function(b){var c=[];if(b=="stage"||b=="any")for(var d=0;d<Runtime.background.scripts.length;d++)var e=Runtime.background.scripts[d],c=mergeLists(c,Runtime._findAnimations(e));if(b!="stage")for(d=0;d<Runtime.sprites.length;d++){var f=
Runtime.sprites[d];if(f.label==b||b=="any"){for(var g=0;g<f.scripts.length;g++){e=f.scripts[g];c=mergeLists(c,Runtime._findAnimations(e))}if(b!="any")break}}c.sort();return c},_findAnimations:function(b){var c=[];if(b instanceof Block){if(b.func=="registerAnimationDone"||b.func=="blockAnimationMoveBy"||b.func=="blockAnimationMoveTo"||b.func=="blockAnimationScaleBy"||b.func=="blockAnimationScaleTo"||b.func=="blockAnimationRotateBy"||b.func=="blockAnimationRotateTo"||b.func=="blockAnimationBezierBy"||
b.func=="blockAnimationBezierTo"||b.func=="blockAnimationEffectTo"||b.func=="blockAnimationEffectBy"||b.func=="blockAnimationSimpleMoveBy"||b.func=="blockAnimationSimpleMoveTo"||b.func=="blockAnimationSimpleScaleBy"||b.func=="blockAnimationSimpleScaleTo"||b.func=="blockAnimationSimpleRotateBy"||b.func=="blockAnimationSimpleRotateTo"||b.func=="blockAnimationSimpleBezierBy"||b.func=="blockAnimationSimpleBezierTo"||b.func=="blockAnimationSimpleEffectTo"||b.func=="blockAnimationSimpleEffectBy"||b.func==
"blockAnimationAnimate"||b.func=="blockAnimationSwitchCostume"||b.func=="blockAnimationSimpleSwitchCostume"||b.func=="blockAnimationWaitFor"||b.func=="blockAnimationStop"){var d=b.label.getSocketAtChild(b.label.getNumSockets()-1);d&&(d.label&&d.label.length>0)&&c.push(d.label)}for(d=0;d<b._containers.length;d++)c=mergeLists(c,Runtime._findAnimations(b._containers[d]));b.next&&(c=mergeLists(c,Runtime._findAnimations(b.next)))}return c},findInboundEventsOf:function(b){var c=[];if(b=="stage"||b=="any")for(var d=
0;d<Runtime.background.scripts.length;d++)var e=Runtime.background.scripts[d],c=mergeLists(c,Runtime._findInboundEvents(e));if(b!="stage")for(d=0;d<Runtime.sprites.length;d++){var f=Runtime.sprites[d];if(f.label==b||b=="any"){for(var g=0;g<f.scripts.length;g++){e=f.scripts[g];c=mergeLists(c,Runtime._findInboundEvents(e))}if(b!="any")break}}c.sort();return c},findOutboundEventsOf:function(b){var c=[];if(b=="stage"||b=="any")for(var d=0;d<Runtime.background.scripts.length;d++)var e=Runtime.background.scripts[d],
c=mergeLists(c,Runtime._findOutboundEvents(e));if(b!="stage")for(d=0;d<Runtime.sprites.length;d++){var f=Runtime.sprites[d];if(f.label==b||b=="any"){for(var g=0;g<f.scripts.length;g++){e=f.scripts[g];c=mergeLists(c,Runtime._findOutboundEvents(e))}if(b!="any")break}}c.sort();return c},findEventsOf:function(b){var c=[];if(b=="stage"||b=="any")for(var d=0;d<Runtime.background.scripts.length;d++)var e=Runtime.background.scripts[d],c=mergeLists(c,Runtime._findEvents(e));if(b!="stage")for(d=0;d<Runtime.sprites.length;d++){var f=
Runtime.sprites[d];if(f.label==b||b=="any"){for(var g=0;g<f.scripts.length;g++){e=f.scripts[g];c=mergeLists(c,Runtime._findEvents(e))}if(b!="any")break}}c.sort();return c},findVariablesOf:function(b,c){var d=[];if(b=="stage"||b=="any"||c)for(var e in Runtime.background.variables)d=mergeLists(d,e);if(b!="stage")for(var f=0;f<Runtime.sprites.length;f++){var g=Runtime.sprites[f];if(g.label==b||b=="any"){for(e in g.variables)d=mergeLists(d,e);if(b!="any")break}}d.sort();return d},findBlockWithTag:function(b){for(var c=
Runtime.background.scripts.length-1;c>=0;c--){var d=Runtime._findBlockWithTag(Runtime.background.scripts[c],b);if(d!=null)return{actor:null,block:d}}for(c=0;c<Runtime.sprites.length;c++)for(var e=Runtime.sprites[c],f=e.scripts.length-1;f>=0;f--){d=Runtime._findBlockWithTag(e.scripts[f],b);if(d!=null)return{actor:e,block:d}}return null},_findBlockWithTag:function(b,c){if(b instanceof Block){if(b.tags&&b.tags.indexOf(c)>=0)return b;var d=Runtime._findBlockWithTag(b.label,c);if(d!=null)return d;for(var e=
0;e<b._containers.length;e++){d=Runtime._findBlockWithTag(b._containers[e],c);if(d!=null)return d}if(b.next!=null){d=Runtime._findBlockWithTag(b.next,c);if(d!=null)return d}}else if(b instanceof Label){if(b.tags&&b.tags.indexOf(c)>=0)return b;for(e=0;e<b._children.length;e++){d=Runtime._findBlockWithTag(b._children[e],c);if(d!=null)return d}}else if(b instanceof LabelInput&&b._child!=null){d=Runtime._findBlockWithTag(b._child,c);if(d!=null)return d}return null},triggerFlag:function(b){for(var c=0;c<
Runtime.flagTriggers.length;c++)(!b||Runtime.flagTriggers[c].sprite==b)&&Runtime.scheduleToRun(Runtime.flagTriggers[c]);Runtime.engageExternalTriggers=true;Runtime.runningScripts.length==0&&Runtime.externalTriggers.length>0&&window.requestAnimFrame(function(){Runtime.runner()});return false},triggerKeyEvent:function(b){var c=null;if(!Runtime._blockEvents&&b.target.tagName!="INPUT"&&b.target.tagName!="SELECT"&&b.target.tagName!="TEXTAREA"){b.which>=65&&b.which<=90?c=String.fromCharCode(b.which+32):
b.which>=48&&b.which<=57?c=String.fromCharCode(b.which):b.which==38?c="up arrow":b.which==40?c="down arrow":b.which==37?c="left arrow":b.which==39?c="right arrow":b.which==32?c="space":b.which==13&&(c="return");Runtime.lastKeyPressed=c;Runtime.triggerKeyDown(c)}return c},triggerKeyDown:function(b){if(b){Runtime.keys[b]=true;for(var c=0;c<Runtime.keyTriggers.length;c++){var d=Runtime.keyTriggers[c].scriptBlock;d.func=="registerKeyTrigger"&&(d.label.getSocketAtChild(0).label==b||d.label.getSocketAtChild(0).label==
"any")&&Runtime.scheduleToRun(Runtime.keyTriggers[c],true)}}},triggerKeyUpEvent:function(b){var c=null;if(!Runtime._blockEvents&&b.target.tagName!="INPUT"&&b.target.tagName!="SELECT"&&b.target.tagName!="TEXTAREA"){b.which>=65&&b.which<=90?c=String.fromCharCode(b.which+32):b.which>=48&&b.which<=57?c=String.fromCharCode(b.which):b.which==38?c="up arrow":b.which==40?c="down arrow":b.which==37?c="left arrow":b.which==39?c="right arrow":b.which==32?c="space":b.which==13&&(c="return");c&&(Runtime.keys[c]=
false)}return c},backgroundClicked:function(){if(Runtime._blockEvents||!Runtime.stage)return false;for(var b=0;b<Runtime.spriteTriggers.length;b++)Runtime.spriteTriggers[b].sprite==Runtime.background&&Runtime.scheduleToRun(Runtime.spriteTriggers[b]);return false},spriteClicked:function(b){if(Runtime._blockEvents||!Runtime.stage)return false;for(var c=0;c<Runtime.spriteTriggers.length;c++)Runtime.spriteTriggers[c].sprite==b&&Runtime.scheduleToRun(Runtime.spriteTriggers[c]);return false},processExternalTriggers:function(){for(var b=
0;b<Runtime.externalTriggers.length;b++){var c=Runtime.externalTriggers[b];if(!c.running){var d=c.scriptBlock.label.getSocketAtChild(0);if(d._child)if(d=c.evaluateExpression(d._child)){if(!c.triggered){c.triggered=true;Runtime.scheduleToRun(c)}}else{if(c.triggered)c.triggered=false}else{var d=d.label,e=c.scriptBlock.label.getSocketAtChild(1);if(e){e=parseFloat(e.label);if(d=="loudness"){MediaCapture.isCapturingAudio()||MediaCapture.startCaptureAudioLevel();d=MediaCapture.getSoundLevel()*100;d>e&&
Runtime.scheduleToRun(c)}else if(d=="timer"){d=(Date.now()-Runtime.startTimer)/1E3;d>e&&Runtime.scheduleToRun(c)}else if(d=="video motion"&&c.sprite){var d=c.sprite.spriteObj.getBounds(),f=MediaCapture.getBuffer(d.left,d.top,d.right-d.left,d.bottom-d.top);if(f){d=0;f=f.data;for(b=0;b<f.length;b=b+4)f[b]&&d++;d=parseInt(d*100/(f.length/4));d>e&&Runtime.scheduleToRun(c)}}}}}}},hasAnimations:function(){for(var b=0;b<Runtime.sprites.length;b++)if(Runtime.sprites[b].getNumAnimations()>0)return true;return false},
removeAnimations:function(){for(var b=0;b<Runtime.sprites.length;b++)Runtime.sprites[b].removeAnimations()},processAnimations:function(){for(var b=false,c=0;c<Runtime.sprites.length;c++){var d=Runtime.sprites[c];d.animate();d.getNumAnimations()>0&&(b=true)}return b},adjustAnimationTimes:function(b){for(var c=0;c<Runtime.sprites.length;c++)Runtime.sprites[c].adjustAnimationTime(b)},redrawSprite:function(b,c){if(!Runtime.stage)return false;Runtime.stage.drawLayer=c?c:Runtime.stage.actorsLayer;for(var d=
0;d<Runtime.drawTriggers.length;d++){var e=Runtime.drawTriggers[d];if((!b||e.sprite==b)&&!e.running){var f=e.sprite.spriteObj;if(f){var g=f.drawWidth,h=f.drawHeight;f.drawWidth=10;f.drawHeight=10;Runtime.runScript(e);(!g||!h||f.drawWidth!=g||f.drawHeight!=h)&&Physics.updateBody(e.sprite.spriteObj);f.width=f.drawWidth;f.height=f.drawHeight;f.cx=f.drawWidth/2;f.cy=f.drawHeight/2}}}return false},triggerAnimationDone:function(b,c){for(var d=0;d<Runtime.animationTriggers.length;d++){var e=Runtime.animationTriggers[d],
f=e.scriptBlock;(!c||c==e.sprite)&&(f.func=="registerAnimationDone"&&(f.label.getSocketAtChild(0).label==b||f.label.getSocketAtChild(0).label=="any"))&&Runtime.scheduleToRun(e)}},stopBlock:function(b){for(var c=Runtime.runningScripts,d=0;d<c.length;d++)if(c[d].scriptBlock==b){c[d].running=false;c[d].receivedValue=void 0;c[d].scriptBlock.setOutline(false);Runtime.runningScripts.splice(d,1);break}},startScripts:function(){Runtime.scriptsPausedTime=0;Runtime.startTimer=Date.now();if(Runtime.runningScripts.length===
0){Runtime.savedBackground={costume:Runtime.background?Runtime.background.currentCostume:null,tileOffsetX:Runtime.stage?Runtime.stage.tileLayer.getScrollOffsetX():null,tileOffsetY:Runtime.stage?Runtime.stage.tileLayer.getScrollOffsetY():null};Runtime.savedSprites=[];for(var b=0;b<Runtime.sprites.length;b++){var c=Runtime.sprites[b],d=Physics.getSpriteProperties(c.spriteObj);if(!c.instantiated){d=Physics.getSpriteProperties(c.spriteObj);Runtime.savedSprites.push({costume:c.currentCostume,x:c.spriteObj.x,
y:c.spriteObj.y,scale:c.spriteObj.scale.x,rotation:c.spriteObj.rotation,isStatic:d.isStatic,geometry:d.geometry,density:d.density,friction:d.friction,restitution:d.restitution})}}}Runtime.triggerFlag()},stopScripts:function(b,c){if(!b)Runtime.engageExternalTriggers=false;Runtime.scriptsPausedTime=0;for(var d=Runtime.runningScripts,e=[],f=0;f<d.length;f++)if((!b||b==d[f].sprite)&&(!c||c!=d[f])){d[f].running=false;d[f].receivedValue=void 0;d[f].scriptBlock.setOutline(false);d[f].reset()}else e.push(d[f]);
Runtime.runningScripts=e;if(Runtime.runningScripts.length==0){soundManager.stopAll();Runtime.keys={};Runtime.stage.mouseDown=false;Runtime.stage&&Physics.stopSimulation()}if(b==Runtime.askSource){$("#stage-canvas .ask").addClass("hidden");$("#stage-canvas .prompt-overlay").detach()}if(!b&&!c){$("#stage-canvas .ask").addClass("hidden");$("#stage-canvas .prompt-overlay").detach();Runtime.removeAnimations();Runtime.cleanup();Runtime.turboMode=false;Runtime.hideRunOutline=false;if(Runtime.savedBackground&&
Runtime.savedSprites){if(!Runtime.retainStates){Runtime.background.setCostumeByName(Runtime.savedBackground.costume);Runtime.stage.tileLayer.setScrollOffset(Runtime.savedBackground.tileOffsetX,Runtime.savedBackground.tileOffsetY);for(f=0;f<Runtime.sprites.length&&f<Runtime.savedSprites.length;f++){b=Runtime.sprites[f];d=Runtime.savedSprites[f];b.setCostumeByName(d.costume);b.spriteObj.setPosition(d.x,d.y);b.spriteObj.setScale(d.scaled);b.spriteObj.setRotation(d.rotation);Physics.resetBody(b.spriteObj);
Physics.updateFixture(b.spriteObj,d.density,d.friction,d.restitution)}}delete Runtime.savedBackground;delete Runtime.savedSprites;Runtime.stage.draw()}}window.WinCode&&!Runtime.hideRunOutline&&WinCode.draw();return false},pauseScripts:function(){if(!this.scriptsPausedTime){this.scriptsPausedTime=Date.now();window.WinStage&&window.WinStage.showPaused()}},resumeScripts:function(){if(this.scriptsPausedTime){var b=this.scriptsPausedTime-this.startTimer;this.scriptsPausedTime=0;this.startTimer=Date.now()-
b;Runtime.adjustAnimationTimes();(Runtime.runningScripts.length>0||Runtime.engageExternalTriggers&&Runtime.externalTriggers.length>0||hasAnimations)&&window.requestAnimFrame(function(){Runtime.runner()});window.WinStage&&window.WinStage.showStarted()}},sendEvent:function(b,c,d){Runtime._broadcastRuntimeListeners("post",b,d);for(var e=0;e<Runtime.broadcastTriggers.length;e++){var f=Runtime.broadcastTriggers[e],g=f.scriptBlock.label.getSocketAtChild(0);if(g!=null&&g.label==b&&(c=="any"||f.sprite.label==
c||(c=="stage"||c=="self")&&f.sprite==Runtime.background)){f.receivedValue=d;f.messageSource=Runtime.stage.label;Runtime.scheduleToRun(f)}}},isRunning:function(){return Runtime.runningScripts.length>0||Runtime.engageExternalTriggers}},reqAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){window.setTimeout(b,1E3/60)};
window.requestAnimFrame=function(b){if(!Runtime._requestedUpdate&&b){Runtime._requestedUpdate=true;reqAnimFrame(function(){Runtime._requestedUpdate=false;b()})}};
Runtime.cleanup=function(){Physics.stopSimulation();Runtime.background.varTransient={};if(Runtime.background.varDefaults)for(var b in Runtime.background.varDefaults)Runtime.background.cloudVariables&&(!Runtime.background.cloudVariables[b]&&Runtime.background.varDefaults[b]!==null)&&(Runtime.background.variables[b]=Runtime.background.varDefaults[b]);for(var c=0;c<Runtime.sprites.length;c++){var d=Runtime.sprites[c];d.varTransient={};if(d.varDefaults)for(b in d.varDefaults)d.varDefaults[b]!==null&&
(d.variables[b]=d.varDefaults[b])}b=[];for(c=0;c<Runtime.sprites.length;c++){Runtime.sprites[c].instantiated&&b.push(Runtime.sprites[c]);Runtime.sprites[c].spriteObj.text=null}for(c=0;c<b.length;c++)b[c].deleteActor();Runtime.stage.text=null;for(c=0;c<Runtime.background.scripts.length;c++)Runtime.background.scripts[c].setOutline(false);for(c=0;c<Runtime.sprites.length;c++){b=Runtime.sprites[c];for(d=0;d<b.scripts.length;d++)b.scripts[d].setOutline(false)}for(c=0;c<Runtime.libs.length;c++){b=Runtime.libs[c];
for(d=0;d<b.scripts.length;d++)b.scripts[d].setOutline(false)}$("#stage-canvas .ask").addClass("hidden");$("#stage-canvas .prompt-overlay").detach();Runtime.stage.draw();MediaCapture.hideVideo();MediaCapture.stopCaptureAudioLevel();Runtime.keys={};Runtime.stage.mouseDown=false};
Runtime.scheduleToRun=function(b,c){Runtime.stage.enableDragging(false);for(var d=false,e=0;e<Runtime.runningScripts.length;e++)if(Runtime.runningScripts[e]==b&&b.running){if(c)return;b.reset();b.running=true;if(window.WinCode&&!Runtime.hideRunOutline){b.scriptBlock.setOutline(true);window.WinCode.draw()}d=true;break}if(!d){b.reset();b.running=true;window.WinStage&&window.WinStage.showStarted();if(b.currentBlock){if(window.WinCode&&!Runtime.hideRunOutline){b.scriptBlock.setOutline(true);window.WinCode.draw()}Runtime.runningScripts.push(b);
if(Runtime.runningScripts.length==1&&(!Runtime.engageExternalTriggers||Runtime.externalTriggers.length==0)){Runtime.nextScript=0;Runtime._broadcastRuntimeListeners("start");window.requestAnimFrame(function(){Runtime.redrawSprite(null);Runtime.runner()});window.g_mcpeConnection&&window.g_mcpeConnection.startMCEvents()}}else b.running=false}};
Runtime.runScript=function(b){var c=Date.now()+1E3;b.running=true;b.currentBlock=b.scriptBlock.next;b.doYield=false;for(window.WinCode&&window.WinCode._hilightStep&&b.scriptBlock.setCurrent();b.running&&Date.now()<c;)for(var d=100;b.running&&--d>=0;)if(b.currentBlock){b.isDirty=false;b.invokeStep();if(b.isDirty)b.isDirty=false}else{b.running=false;b.receivedValue=void 0;break}b.running=false;return d>=0};
Runtime.runner=function(){var b=false;if(!Runtime.scriptsPausedTime){Canvas.particles.update();Physics.isSimulationRunning()&&Physics.updateSimulation();if(Runtime.runningScripts.length<=0&&!Runtime.engageExternalTriggers&&!Runtime.hasAnimations()&&!Physics.isSimulationRunning()){Runtime.keyTriggers.length==0&&(Runtime.spriteTriggers.length==0&&!Runtime.engageExternalTriggers)&&Runtime._broadcastRuntimeListeners("stop");for(var c=0;c<Runtime.background.scripts.length;c++)Runtime.background.scripts[c].setOutline(false);
for(c=0;c<Runtime.sprites.length;c++)for(var b=Runtime.sprites[c],d=0;d<b.scripts.length;d++)b.scripts[d].setOutline(false);$("#stage-canvas .ask").addClass("hidden");$("#stage-canvas .prompt-overlay").detach();console.log("scripts stopped")}else{if(this.nextScript<0&&Runtime.runningScripts.length>0)this.nextScript=0;for(var d=Date.now()+1E3/60,e=20;Runtime.runningScripts.length>0&&(Runtime.turboMode&&Date.now()<d||!Runtime.turboMode&&--e>0);){var f=Runtime.runningScripts[this.nextScript];if(!f)break;
for(f.doYield=false;(!f.doYield||f.doBlock)&&f.running;){if(f.currentBlock){f.isDirty=false;if(f.pauseState())break;else{f.invokeStep();if(f.isDirty){f.isDirty=false;b=true}}}if(f.currentBlock==null||!f.running)for(c=0;c<Runtime.runningScripts.length;c++)if(Runtime.runningScripts[c]==f){Runtime.runningScripts.splice(c,1);f.running=false;f.receivedValue=void 0;window.WinCode&&!Runtime.hideRunOutline&&f.scriptBlock.setOutline(false);if(c==this.nextScript&&--this.nextScript<0)this.nextScript=0;break}if(Runtime.scriptsPausedTime)return}if(Runtime.runningScripts.length>
0)this.nextScript=(this.nextScript+1)%Runtime.runningScripts.length;else break}window.WinCode&&!Runtime.hideRunOutline&&WinCode.draw();for(c=0;c<Runtime.sprites.length;c++)Runtime.sprites[c].updateCostume();Runtime.background.updateCostume();Runtime.processExternalTriggers();(c=Runtime.processAnimations())&&(b=true);b&&Runtime.stage&&Runtime.stage.draw();if(Runtime.runningScripts.length>0||Runtime.engageExternalTriggers&&Runtime.externalTriggers.length>0||c||Physics.isSimulationRunning())window.requestAnimFrame(function(){Runtime.runner()});
else{Runtime.keyTriggers.length==0&&(Runtime.spriteTriggers.length==0&&!Runtime.engageExternalTriggers)&&Runtime._broadcastRuntimeListeners("stop");for(c=0;c<Runtime.background.scripts.length;c++)Runtime.background.scripts[c].setOutline(false);for(c=0;c<Runtime.sprites.length;c++){b=Runtime.sprites[c];for(d=0;d<b.scripts.length;d++)b.scripts[d].setOutline(false)}for(c=0;c<Runtime.libs.length;c++){b=Runtime.libs[c];for(d=0;d<b.scripts.length;d++)b.scripts[d].setOutline(false)}$("#stage-canvas .ask").addClass("hidden");
$("#stage-canvas .prompt-overlay").detach();console.log("scripts stopped")}}}};
Runtime.loadVariables=function(b){var c=null;if(window.IDE&&window.IDE.currentProjectId)c=window.IDE.currentProjectId;else if(window.projectId)c=window.projectId;c?$.ajax({url:"/api/datagetvars",type:"POST",data:{id:c},success:function(c){if(c){c=JSON.parse(c);if(Runtime.background.cloudVariables&&c.v)for(var e in c.v)Runtime.background.cloudVariables[e]&&(Runtime.background.variables[e]=c.v[e]);if(c.l)for(e in c.l)Runtime.background.cloudLists[e]&&(Runtime.background.lists[e]=c.l[e])}b&&b()},error:function(){b&&
b()}}):b&&b()};Runtime.loadCloudVar=function(b){var c=null;if(window.IDE&&window.IDE.currentProjectId)c=window.IDE.currentProjectId;else if(window.projectId)c=window.projectId;c&&(Runtime.background.cloudVariables&&Runtime.background.cloudVariables[b]!==void 0)&&$.ajax({url:"/api/datagetvar",type:"POST",data:{id:c,n:b},success:function(c){Runtime.background.variables[b]=JSON.parse(c)}})};
Runtime.updateCloudVar=function(b){var c=null;if(window.IDE&&window.IDE.currentProjectId)c=window.IDE.currentProjectId;else if(window.projectId)c=window.projectId;c&&(Runtime.background.cloudVariables&&Runtime.background.cloudVariables[b]!==void 0)&&$.ajax({url:"/api/datasetvar",type:"POST",data:{id:c,n:b,v:JSON.stringify(Runtime.background.variables[b])}})};
Runtime.loadCloudVar=function(b){var c=null;if(window.IDE&&window.IDE.currentProjectId)c=window.IDE.currentProjectId;else if(window.projectId)c=window.projectId;c&&(Runtime.background.cloudLists&&Runtime.background.cloudLists[b]!==void 0)&&$.ajax({url:"/api/datagetlist",type:"POST",data:{id:c,n:b},success:function(c){Runtime.background.lists[b]=JSON.parse(c)}})};
Runtime.updateCloudList=function(b){var c=null;if(window.IDE&&window.IDE.currentProjectId)c=window.IDE.currentProjectId;else if(window.projectId)c=window.projectId;c&&(Runtime.background.cloudLists&&Runtime.background.cloudLists[b]!==void 0)&&$.ajax({url:"/api/datasetlist",type:"POST",data:{id:c,n:b,v:JSON.stringify(Runtime.background.lists[b])}})};Runtime.muteAllSounds=function(){Runtime.muted=true;soundManager.mute()};Runtime.unmuteAllSounds=function(){Runtime.muted=false;soundManager.unmute()};
Runtime.addWatcher=function(b,c,d,e,f){var g="",h=null,b=!b||b==Runtime.background?"Stage":typeof b=="string"?b:b.label;if(typeof c=="string"){g=c;h=new Label(g_steps.valueVarPropGet);h.setValue(0,c);h.setValue(1,b)}else if(c instanceof Label){g=c.labelText;h=new Label(g_steps.valueVarPropGet);h.setValue(0,c.labelText);h.setValue(1,b)}if(h){h=ObjectIO.genValueObj(h);c={label:g+" watcher",scripts:[{func:"registerFlagTrigger",values:[],next:{func:"blockPenSetFont",values:[{type:"choice",value:"bold"},
{type:"choice",value:"24"},{type:"choice",value:"Arial,Helvetica,sans-serif"}],next:{func:"blockPhysicsSetActorActive",values:[{type:"string",value:"self"},{type:"boolean",value:"false"}],next:{func:"blockControlForever",values:[],containers:[{func:"blockLooksSetLabel",values:[{type:"wrapper",func:"valueOpTextSubstring",values:[{type:"string",value:g},{type:"number",value:1},{type:"number",value:6}]},{type:"string",value:": "},{type:"wrapper",func:"valueOpTextSubstring",values:[h,{type:"number",value:1},
{type:"number",value:8}]}]}]}}},x:40,y:40}],costumes:[{name:"gray",img:"/medialib/543489c584aafafe5000084d.png",cx:95,cy:24.5},{name:"blue",img:"/medialib/543489c584aafafe500007d1.png",cx:95,cy:24.5},{name:"green",img:"/medialib/543489c584aafafe50000925.png",cx:95,cy:24.5},{name:"orange",img:"/medialib/543489c584aafafe50000901.png",cx:95,cy:24.5},{name:"yellow",img:"/medialib/543489c584aafafe5000092d.png",cx:95,cy:24.5}],currentCostume:3,sounds:[],scale:1,x:0,y:0,rotation:0,rotateLock:0,hidden:false,
isHidden:false,volume:100,zIndex:0,font:"bold 24px Arial,Helvetica,sans-serif",physics:{isStatic:false,isActive:false,geometry:"rectangular",density:1,friction:0.5,restitution:0.2},variables:{},varDefaults:{},lists:{},classname:"watcher"};if(f)c.scale=f;if(d&&e){c.x=d;c.y=e}return ObjectIO.deserializeSprite(c)}return null};
var Physics={world:null,scale:30},b2Vec2=Box2D.Common.Math.b2Vec2,b2AABB=Box2D.Collision.b2AABB,b2BodyDef=Box2D.Dynamics.b2BodyDef,b2Body=Box2D.Dynamics.b2Body,b2FixtureDef=Box2D.Dynamics.b2FixtureDef,b2Fixture=Box2D.Dynamics.b2Fixture,b2World=Box2D.Dynamics.b2World,b2WorldManifold=Box2D.Collision.b2WorldManifold,b2MassData=Box2D.Collision.Shapes.b2MassData,b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape,b2CircleShape=Box2D.Collision.Shapes.b2CircleShape,b2DebugDraw=Box2D.Dynamics.b2DebugDraw,
b2MouseJointDef=Box2D.Dynamics.Joints.b2MouseJointDef;Physics.initPhysics=function(b){var c={gravityX:0,gravityY:10};$.extend(c,b);this.world=new b2World(new b2Vec2(c.gravityX,c.gravityY),true);Runtime.stage.tileLayer.setup();this.rightBody=this.leftBody=this.topBody=this.bottomBody=null;Physics.updateWorld();this.world.SetContactListener(this);this.world.SetContactFilter(this)};
Physics.setDebug=function(b){if(b){this.debugDraw=new b2DebugDraw;this.debugDraw.SetSprite(Runtime.stage.penLayer.context);this.debugDraw.SetDrawScale(Physics.scale);this.debugDraw.SetFillAlpha(0.3);this.debugDraw.SetLineThickness(1);this.debugDraw.SetFlags(b2DebugDraw.e_shapeBit|b2DebugDraw.e_jointBit);this.world.SetDebugDraw(this.debugDraw)}else{this.debugDraw=null;this.world.SetDebugDraw(null);Runtime.stage.penLayer.clear()}};
Physics.updateWorld=function(){var b=Runtime.stage.getWidth(),c=Runtime.stage.getHeight();if(Runtime.stage.tileLayer.enabled&&Runtime.stage.tileLayer.map&&Runtime.stage.tileLayer.map.length>0){b=Runtime.stage.tileLayer.mapWidth*Runtime.stage.tileLayer.tileSize;c=Runtime.stage.tileLayer.mapHeight*Runtime.stage.tileLayer.tileSize}var d=new b2FixtureDef;d.density=1;d.friction=0.5;d.restitution=0.2;var e=true;if(this.bottomBody){e=this.bottomBody.GetFixtureList();d.density=e.GetDensity();d.friction=e.GetFriction();
d.restitution=e.GetRestitution();e=this.bottomBody.IsActive();this.removeBody(this.bottomBody)}this.topBody&&this.removeBody(this.topBody);this.leftBody&&this.removeBody(this.leftBody);this.rightBody&&this.removeBody(this.rightBody);var f=new b2BodyDef;f.type=b2Body.b2_staticBody;d.shape=new b2PolygonShape;d.shape.SetAsBox(b/this.scale,1);f.position.Set(b/this.scale/2,c/this.scale+0.9);this.bottomBody=this.world.CreateBody(f);this.bottomBody.CreateFixture(d);this.bottomBody.SetActive(e);f.position.Set(b/
this.scale/2,-0.9);this.topBody=this.world.CreateBody(f);this.topBody.CreateFixture(d);this.topBody.SetActive(e);d.shape.SetAsBox(1,c/this.scale);f.position.Set(-0.9,c/this.scale/2);this.leftBody=this.world.CreateBody(f);this.leftBody.CreateFixture(d);this.leftBody.SetActive(e);f.position.Set(b/this.scale+0.9,c/this.scale/2);this.rightBody=this.world.CreateBody(f);this.rightBody.CreateFixture(d);this.rightBody.SetActive(e);return this.world};
Physics.isBodyTouching=function(b,c){for(var d=this.world.GetContactList();d;){var e=d.GetFixtureA().GetBody(),f=d.GetFixtureB().GetBody();if(e==b&&f==c||f==b&&e==c)return true;d=d.GetNext()}return false};
Physics.BeginContact=function(b){var c=b.GetFixtureA().GetBody(),d=b.GetFixtureB().GetBody(),e=new b2WorldManifold;b.GetWorldManifold(e);var f=b="";if(c==Physics.leftBody)b="left edge";else if(c==Physics.rightBody)b="right edge";else if(c==Physics.topBody)b="top edge";else if(c==Physics.bottomBody)b="bottom edge";else{var g=c.GetUserData();if(typeof g=="number"||typeof g=="string")b=Runtime.stage.tileLayer._tileSetRevMap[g]+" tiles";else if(g)f=b=g.sprite.label}var h="",j="";if(d==Physics.leftBody)h=
"left edge";else if(d==Physics.rightBody)h="right edge";else if(d==Physics.topBody)h="top edge";else if(d==Physics.bottomBody)h="bottom edge";else{g=d.GetUserData();if(typeof g=="number"||typeof g=="string")h=Runtime.stage.tileLayer._tileSetRevMap[g]+" tiles";else if(g)j=h=g.sprite.label}if(c.GetUserData()&&typeof c.GetUserData()=="object"){g=c.GetUserData().sprite;g.lastCollisionName=h;g.lastCollisionNormal={x:e.m_normal.x,y:e.m_normal.y};if(j){g.lastActorCollisionName=j;g.lastActorCollisionNormal=
{x:e.m_normal.x,y:e.m_normal.y}}}if(d.GetUserData()&&typeof d.GetUserData()=="object"){g=d.GetUserData().sprite;g.lastCollisionName=b;g.lastCollisionNormal={x:e.m_normal.x,y:e.m_normal.y};if(f){g.lastActorCollisionName=f;g.lastActorCollisionNormal={x:e.m_normal.x,y:e.m_normal.y}}}for(e=0;e<Runtime.collisionTriggers.length;e++){b=Runtime.collisionTriggers[e];f=b.sprite.spriteObj.physicsBody;(f==c||f==d)&&Runtime.scheduleToRun(b)}return false};Physics.EndContact=function(){};Physics.PostSolve=function(){};
Physics.PreSolve=function(){};
Physics.ShouldCollide=function(b,c){for(var d=b.GetBody(),e=c.GetBody(),f=0;f<Runtime.sprites.length;f++){var g=Runtime.sprites[f],h=new Script({sprite:g,origSprite:g,scriptBlock:new Block(g_steps.nop)}),j=h.running=true,j="";if(g.spriteObj.physicsBody==d){var j=e.GetUserData(),j=typeof j=="number"||typeof j=="string"?Runtime.stage.tileLayer._tileSetRevMap[j]+" tiles":j?j.sprite.label:"edge",k=h._findFunction(g,"ShouldCollide");if(k){j=h._valueControlCall(g,k,[j]);if(!h.error)return j}}else if(g.spriteObj.physicsBody==e){j=
d.GetUserData();j=typeof j=="number"||typeof j=="string"?Runtime.stage.tileLayer._tileSetRevMap[j]+" tiles":j?j.sprite.label:"edge";if(k=h._findFunction(g,"ShouldCollide")){j=h._valueControlCall(g,k,[j]);if(!h.error)return j}}}return true};Physics.findBody=function(b){for(var c=this.world.GetBodyList();c;){if(c.GetUserData()==b)return c;c=c.GetNext()}return null};
Physics.removeBody=function(b){this.world.DestroyBody(b);for(var c=this.world.GetBodyList();c;){if(c==b){this.world.DestroyBody(b);break}c=c.GetNext()}};
Physics.addBody=function(b,c){var d={staticBody:false,fixedRotation:false,x:0,y:0,width:1,height:1,rotation:c.rotation*Math.PI/180,density:1,friction:0.5,restitution:0.2,isActive:true,geometry:"rectangular"};if(c){d.fixedRotation=c.rotateLock!=0;d.x=c.x/this.scale;d.y=c.y/this.scale;if(c.drawWidth&&c.drawHeight){d.width=c.drawWidth*c.scale.x/this.scale;d.height=c.drawHeight*c.scale.x/this.scale}else{d.width=c.width*c.scale.x/this.scale;d.height=c.height*c.scale.x/this.scale}}$.extend(d,b);var e=new b2BodyDef;
e.type=d.staticBody?b2Body.b2_staticBody:b2Body.b2_dynamicBody;e.fixedRotation=d.fixedRotation?true:false;e.position.x=d.x;e.position.y=d.y;e.angle=d.rotation;var f=new b2FixtureDef;f.density=d.density;f.friction=d.friction;f.restitution=d.restitution;if(d.geometry=="circular")f.shape=d.width>d.height?new b2CircleShape(d.width/2):new b2CircleShape(d.height/2);else{f.shape=new b2PolygonShape;f.shape.SetAsBox(d.width/2,d.height/2)}if(c){c.geometry=d.geometry;e.userData=c}e=this.world.CreateBody(e);
e.CreateFixture(f);e.SetActive(d.isActive);return c.physicsBody=e};
Physics.resetBody=function(b){var c=b.physicsBody;if(c){var d=c.GetFixtureList(),e=c.IsActive(),f,g;if(b.drawWidth&&b.drawHeight){f=b.drawWidth*b.scale.x/this.scale;g=b.drawHeight*b.scale.x/this.scale}else{f=b.width*b.scale.x/this.scale;g=b.height*b.scale.x/this.scale}this.world.DestroyBody(c);var h=new b2BodyDef;h.type=c.GetType();h.fixedRotation=b.rotateLock!=0;h.position.x=b.x/this.scale;h.position.y=b.y/this.scale;h.angle=b.rotation*Math.PI/180;h.userData=b;var j=new b2FixtureDef;j.density=d.GetDensity();
j.friction=d.GetFriction();j.restitution=d.GetRestitution();if(b.geometry=="circular")j.shape=f>g?new b2CircleShape(f/2):new b2CircleShape(g/2);else{j.shape=new b2PolygonShape;j.shape.SetAsBox(f/2,g/2)}c=this.world.CreateBody(h);c.CreateFixture(j);c.SetActive(e);b.physicsBody=c}};Physics.updateFixture=function(b,c,d,e){var f=b.physicsBody.GetFixtureList();if(f){f.SetDensity(c);f.SetFriction(d);f.SetRestitution(e);b.physicsBody.ResetMassData()}};Physics.updateType=function(b,c){b.physicsBody.SetType(c)};
Physics.updateBody=function(b,c){var d=b.physicsBody;if(d){var e={isStatic:d.GetType()==b2Body.b2_staticBody,isActive:d.IsActive(),rotation:d.GetAngle(),geometry:b.geometry},f=d.GetFixtureList();if(f){e.density=f.GetDensity();e.friction=f.GetFriction();e.restitution=f.GetRestitution()}$.extend(e,c);var f=d.GetAngle(),g=d.GetAngularDamping(),h=d.GetAngularVelocity(),j=d.GetLinearDamping(),k=d.GetLinearVelocity();this.world.DestroyBody(d);d=this.addBody(e,b);d.SetType(e.isStatic?b2Body.b2_staticBody:
b2Body.b2_dynamicBody);d.SetActive(e.isActive);d.SetAngle(f);d.SetAngularDamping(g);d.SetAngularVelocity(h);d.SetLinearDamping(j);d.SetLinearVelocity(k)}};
Physics.getSpriteProperties=function(b){var c=b.physicsBody;if(!c)return{isStatic:false,isActive:true,x:b.x,y:b.y,angle:b.angle,geometry:0,density:0,friction:0,restitution:0};var d=c.GetFixtureList();return{isStatic:c.GetType()==b2Body.b2_staticBody,isActive:c.IsActive(),x:c.GetPosition().x,y:c.GetPosition().y,angle:c.GetAngle(),geometry:b.geometry,density:d.GetDensity(),friction:d.GetFriction(),restitution:d.GetRestitution()}};Physics.getWorld=function(){return this.world};
Physics.updateGravity=function(b,c){this.world.SetGravity(new b2Vec2(b,c))};Physics.getGravity=function(){var b=this.world.GetGravity();return{x:b.x,y:b.y}};Physics.setStageActive=function(b){this.bottomBody.SetActive(b);this.topBody.SetActive(b);this.leftBody.SetActive(b);this.rightBody.SetActive(b)};
Physics.setStageDensity=function(b){var c=this.bottomBody.GetFixtureList();if(c){c.SetDensity(b);this.bottomBody.ResetMassData()}if(c=this.topBody.GetFixtureList()){c.SetDensity(b);this.topBody.ResetMassData()}if(c=this.leftBody.GetFixtureList()){c.SetDensity(b);this.leftBody.ResetMassData()}if(c=this.rightBody.GetFixtureList()){c.SetDensity(b);this.rightBody.ResetMassData()}};
Physics.setStageFriction=function(b){var c=this.bottomBody.GetFixtureList();c&&c.SetFriction(b);(c=this.topBody.GetFixtureList())&&c.SetFriction(b);(c=this.leftBody.GetFixtureList())&&c.SetFriction(b);(c=this.rightBody.GetFixtureList())&&c.SetFriction(b)};
Physics.setStageRestitution=function(b){var c=this.bottomBody.GetFixtureList();c&&c.SetRestitution(b);(c=this.topBody.GetFixtureList())&&c.SetRestitution(b);(c=this.leftBody.GetFixtureList())&&c.SetRestitution(b);(c=this.rightBody.GetFixtureList())&&c.SetRestitution(b)};Physics.getStageDensity=function(){var b=this.bottomBody.GetFixtureList();return b?b.GetDensity():1};Physics.getStageFriction=function(){var b=this.bottomBody.GetFixtureList();return b?b.GetFriction():0.5};
Physics.getStageRestitution=function(){var b=this.bottomBody.GetFixtureList();return b?b.GetRestitution():0.2};Physics.isStageActive=function(){return this.bottomBody.IsActive()};
Physics.updateSimulation=function(){var b=Date.now();this.world.Step((b-this.timestamp)/1E3,10,10);this.timestamp=b;this.world.ClearForces();for(b=0;b<Runtime.sprites.length;b++){var c=Runtime.sprites[b],d=c.spriteObj,e=d.physicsBody;if(e){var f=d.x,g=d.y,h=e.GetPosition(),j=h.x*this.scale,h=h.y*this.scale;if(c.penDown){var k=Runtime.stage.penLayer.context;k.save();k.beginPath();k.strokeStyle=c.penColor;k.lineWidth=c.penWidth;k.lineCap="round";k.moveTo(f,g);k.lineTo(j,h);k.stroke();k.closePath();
k.restore()}d.setPosition2(j,h);c=e.GetAngle();d.rotateLock!=0?c>Math.PI/2&&c<Math.PI*3/2?(c<Math.PI-0.001||c>Math.PI+0.001)&&e.SetTransform({position:e.GetPosition(),GetAngle:function(){return Math.PI}}):c!=0&&e.SetTransform({position:e.GetPosition(),GetAngle:function(){return 0}}):d.setRotation2(e.GetAngle()/Math.PI*180)}}if(this.debugDraw){k=Runtime.stage.penLayer.context;k.save();k.setTransform(1,0,0,1,0,0);k.clearRect(0,0,k.canvas.width,k.canvas.height);k.restore();this.world.DrawDebugData()}Runtime.stage.draw()};
Physics.runSimulation=function(){if(!this.simulationId){this.simulationId=1;this.updateWorld();this.timestamp=Date.now()}};Physics.stopSimulation=function(){if(this.simulationId){this.simulationId=void 0;if(this.debugDraw){var b=Runtime.stage.penLayer.context;b.save();b.setTransform(1,0,0,1,0,0);b.clearRect(0,0,b.canvas.width,b.canvas.height);b.restore()}}};Physics.isSimulationRunning=function(){return this.simulationId>=0};
var Sprites={_blankImg:"ide/imgs/blank.png",_listeners:[],_bufferCanvas:null,_skelCache:{},_skelLoad:[]};
function Sprite(b){this.label=this.classname=this.id="";this.scripts=[];this.costumes=[];this.sounds=[];this.varDefaults={};this.variables={};this.varTransient={};this.lists={};this.animations=[];this.lastCollisionName="";this.lastCollisionNormal={x:0,y:0};this.lastActorCollisionName="";this.lastActorCollisionNormal={x:0,y:0};this.hidden=false;this.spriteObj=null;this.currentCostume=0;this.penDown=false;this.penColor="#000000";this.fillColor="";this.penWidth=1;this.font="normal 18px Comic Sans MS,cursive";
this.fontColor="#000000";this.volume=100;$.extend(this,b);b=getColorComponents(this.penColor);this.penColor=b[0];this.penHue=b[1];this.penShade=255;this.filtersChanged=false;this.filters=[];this.animationSpeed=30;this.skeleton={type:"",parts:{},skeletonData:null,textures:{},skeleton:null,animationName:null,totalTime:null,lastTime:null,stateData:null,state:null}}
Sprite.prototype.update=function(b,c){if(b["class"]!==void 0)this.classname=b["class"];if(b.name!=this.label){var d=b.name,e=d,f=1,g=false;do for(var g=false,h=0;h<Runtime.sprites.length;h++)if(Runtime.sprites[h]!=this&&Runtime.sprites[h].label==e){g=true;e=d+f;f++;break}while(g);this.label=e;Sprites._broadcastSpriteListeners("updateName",this,e)}if(b.costumes!==null){this.costumes=[];this.currentCostume=0;for(var j=b.costumes.length,h=0;h<b.costumes.length;h++){var k=this;this.addCostume(b.costumes[h],
function(){if(--j==0){b.currentCostume!==null&&k.setCostumeByName(b.currentCostume);c&&c(k)}})}}b.skelType&&b.skelParts&&k.loadSkeleton(b.skelType,b.skelParts);if(b.sounds!==null){this.sounds=[];for(h=0;h<b.sounds.length;h++){d=b.sounds[h];d.url=d;this.addSound(d)}}b.width!==void 0&&(b.height!==void 0&&this==Runtime.background)&&Runtime.stage.setSize(Math.abs(b.width),Math.abs(b.height));if(b.expand&&this==Runtime.background)Runtime.stage.expand=true;b.scale!==void 0&&this.spriteObj.setScale(b.scale);
b.x!==void 0&&this.spriteObj.setPosition(Runtime.stage.getWidth()/2+b.x,this.spriteObj.y);b.y!==void 0&&this.spriteObj.setPosition(this.spriteObj.x,Runtime.stage.getHeight()/2-b.y);b.angle!==void 0&&this.spriteObj.setRotation(b.angle);b.layer!==void 0&&this.spriteObj.setZIndex(b.layer);b.rotateLock!==void 0&&this.spriteObj.setRotateLock(b.rotateLock);b.draggable!==void 0&&this.spriteObj.setDraggable(b.draggable);b.hidden!==void 0&&(b.hidden?this.spriteObj.hide():this.spriteObj.show());if(b.penColor!==
void 0){h=getColorComponents(b.penColor);this.penColor=h[0];this.penHue=h[1];this.penShade=255}if(b.fillColor!==void 0)this.fillColor=b.fillColor;if(b.penWidth!==void 0)this.penWidth=b.penWidth;if(b.font!==void 0)this.font=b.font;if(b.fontColor!==void 0)this.fontColor=b.fontColor;if(b.volume!==void 0)this.volume=b.volume;if(b.variables!==void 0)this.variables=b.variables;if(b.lists!==void 0)this.lists=b.lists;Runtime.stage.draw()};
Sprite.prototype.setFilter=function(b,c){for(var d=false,e=0;e<this.filters.length;e++)if(this.filters[e].filter==b){this.filters[e]={filter:b,options:c};d=true;break}d||this.filters.push({filter:b,options:c});this.filtersChanged=true};Sprite.prototype.getFilter=function(b){for(var c=0;c<this.filters.length;c++)if(this.filters[c].filter==b)return this.filters[c];return null};Sprite.prototype.clearFilters=function(){this.filters=[];this.filtersChanged=true};
Sprite.prototype.applyFilters=function(b,c,d){if(!b&&this.costumes.length>0)b=this.costumes[(this.currentCostume-1)%this.costumes.length].img;if((this.filtersChanged||c)&&b&&b.width&&b.height){var c=document.createElement("canvas"),e=c.getContext("2d");if(this.spriteObj){c.width=b.naturalWidth;c.height=b.naturalHeight;if(!c.width)c.width=b.width;if(!c.height)c.height=b.height}else{c.width=Runtime.stage.getWidth();c.height=Runtime.stage.getHeight()}e.clearRect(0,0,c.width,c.height);if(this.spriteObj)e.drawImage(b,
0,0);else if(Runtime.stage.tileLayer.scrollBgOffset){c.width=b.naturalWidth;c.height=b.naturalHeight;e.drawImage(b,0,0)}else if(Runtime.stage.expand){var f=c.height,g=b.width*c.height/b.height;e.drawImage(b,(c.width-g)/2,(c.height-f)/2,g,f)}else if(Runtime.stage.bgtype=="tile"){if(b&&b.width>0&&b.height>0){c.width=b.naturalWidth;c.height=b.naturalHeight;e.drawImage(b,0,0)}}else Runtime.stage.bgtype=="stretch"?e.drawImage(b,0,0,c.width,c.height):e.drawImage(b,(c.width-b.width)/2,(c.height-b.height)/
2);if(this.filters.length>0){f=this.filters[0];if(this.filters.length==1&&(f.filter=="ghost"||f.filter=="opacity"))if(this==Runtime.background){Runtime.stage.backgroundLayer.alpha=1-f.options.value/100;if(Runtime.stage.backgroundLayer.alpha<0)Runtime.stage.backgroundLayer.alpha=0;else if(Runtime.stage.backgroundLayer.alpha>1)Runtime.stage.backgroundLayer.alpha=1;Runtime.stage.setBackgroundType(Runtime.stage.bgtype)}else{this.spriteObj.alpha=1-f.options.value/100;if(this.spriteObj.alpha<0)this.spriteObj.alpha=
0;else if(this.spriteObj.alpha>1)this.spriteObj.alpha=1}else{for(var g=e.getImageData(0,0,c.width,c.height),h=0;h<this.filters.length;h++){f=this.filters[h];if(f=="ghost"||f=="opacity")if(this==Runtime.background){Runtime.stage.backgroundLayer.alpha=1-f.options.value/100;if(Runtime.stage.backgroundLayer.alpha<0)Runtime.stage.backgroundLayer.alpha=0;else if(Runtime.stage.backgroundLayer.alpha>1)Runtime.stage.backgroundLayer.alpha=1;Runtime.stage.setBackgroundType(Runtime.stage.bgtype)}else{this.spriteObj.alpha=
1-f.options.value/100;if(this.spriteObj.alpha<0)this.spriteObj.alpha=0;else if(this.spriteObj.alpha>1)this.spriteObj.alpha=1}else{var j=JSManipulate[f.filter];j&&j.filter(g,f.options)}}e.putImageData(g,0,0)}}d&&d.call(this,c);this.filtersChanged=false}else d&&d.call(this,b);return b};
Sprite.prototype.bringIntoView=function(){if(!isFinite(this.spriteObj.scale.x)||!isFinite(this.spriteObj.scale.y))this.spriteObj.setScale(1);else{this.spriteObj.width*this.spriteObj.scale.x<8&&this.spriteObj.setScale(8/this.spriteObj.width);this.spriteObj.height*this.spriteObj.scale.y<8&&this.spriteObj.setScale(8/this.spriteObj.height)}isFinite(this.spriteObj.rotation)||this.spriteObj.setRotation(0);isFinite(this.spriteObj.x)?this.spriteObj.x<0?this.spriteObj.setPosition(0+(this.spriteObj.width-this.spriteObj.cx)*
this.spriteObj.scale.x,this.spriteObj.y):this.spriteObj.x>Runtime.stage.getWidth()&&this.spriteObj.setPosition(Runtime.stage.getWidth()-this.spriteObj.cx*this.spriteObj.scale.x,this.spriteObj.y):this.spriteObj.setPosition(Runtime.stage.getWidth()/2,this.spriteObj.y);isFinite(this.spriteObj.y)?this.spriteObj.y<0?this.spriteObj.setPosition(this.spriteObj.x,0+(this.spriteObj.height-this.spriteObj.cy)*this.spriteObj.scale.y):this.spriteObj.y>Runtime.stage.getHeight()&&this.spriteObj.setPosition(this.spriteObj.x,
Runtime.stage.getHeight()-this.spriteObj.cy*this.spriteObj.scale.y):this.spriteObj.setPosition(this.spriteObj.x,Runtime.stage.getHeight()/2);if(!this.spriteObj.visible)this.spriteObj.visible=true;if(isNaN(this.spriteObj.alpha)||this.spriteObj.alpha<0.1)this.spriteObj.alpha=1};Sprite.prototype.changeSpriteName=function(b){for(var c=false,d=0;d<Runtime.sprites.length;d++)if(Runtime.sprites[d].label==b){c=true;break}if(!c&&b){this.label=b;Sprites._broadcastSpriteListeners("updateName",this,b)}return this.label};
Sprite.prototype.getSoundByName=function(b){var c=this.sounds.concat(Runtime.background.sounds);if(typeof b=="number"){b=(Math.floor(b)-1)%c.length;b<0&&(b=b+c.length);return[b,c[b]]}for(var d=0;d<c.length;d++)if(c[d].name==b)return[d,c[d]];return null};
Sprite.prototype.deleteSoundByName=function(b){if(typeof b=="number"){b=Math.floor(b);b>=0&&b<this.sounds.length&&this.sounds.splice(b,1)}else for(var c=0;c<this.sounds.length;c++){var d=this.sounds[c];if(d.name==b){this.sounds.splice(c,1);Sprites._broadcastSpriteListeners("updateDeleteSound",this,d);break}}};
Sprite.prototype.addSound=function(b){var c=1,d=b.name;if(d)newName=d;else{d="";newName="1";c=2}b.name=void 0;var e=false;do for(var e=false,f=0;f<this.sounds.length;f++)if(this.sounds[f].name==newName){e=true;newName=d+c;c++;break}while(e);b.name=newName;if(b.sound[0]!="/"&&b.sound[0]!="h")b.sound="/medialib/"+b.sound;b.soundObj=soundManager.createSound({id:"s"+Math.random(),url:b.sound,volume:this.volume});this.sounds.push(b);Sprites._broadcastSpriteListeners("updateAddSound",this,b);return b};
Sprite.prototype.getCostumes=function(){return this.costumes};Sprite.prototype.getCurrentCostume=function(){var b=null;this.costumes.length>0&&(b=this.costumes[(this.currentCostume-1)%this.costumes.length]);return b};Sprite.prototype.getCostumeByName=function(b){var c=this.getCostumes();if(c.length>0){if(typeof b!="number"){for(var d=0;d<c.length;d++)if(c[d].name==b)return[d,c[d]];b=coerceToNumber(b)}b=(Math.floor(b)-1)%c.length;b<0&&(b=b+c.length);return[b,c[b]]}return null};
Sprite.prototype.deleteCostumeByName=function(b){if(b=this.getCostumeByName(b)){this.costumes.splice(b[0],1);this.currentCostume=b[0]-1;this.setCostumeByName(b[0]);Sprites._broadcastSpriteListeners("updateDeleteCostume",this,b[1])}};
Sprite.prototype.setCostumeByName=function(b){if(this.spriteObj==null&&this.costumes.length==0)Runtime.stage.setBackground(null);else{var c=false;if(this.skeleton.skeletonData){for(var b=""+b,d=this.skeleton.skeletonData.animations,e=0;e<d.length;e++)if(d[e].name==b){if(b!=this.skeleton.animationName){this.skeleton.state.setAnimationByName(0,b,true);this.skeleton.animationName=b}c=true;break}if(c){this.updateSkeleton();var f=this;this.spriteObj.setSpriteDraw(function(b){f._drawSkeleton(b)},f.skeleton.skeletonBounds.maxX-
f.skeleton.skeletonBounds.minX,f.skeleton.skeletonBounds.maxY-f.skeleton.skeletonBounds.minY);return}}this.skeleton.animationName="";var g=this.getCostumeByName(b);if(this.spriteObj&&!this.spriteObj.isImage())this.currentCostume=-1;if(g&&(this.currentCostume!=g[0]+1||this.filtersChanged)){this.currentCostume=g[0]+1;f=this;this.spriteObj==null?g[1].imgObj?f.applyFilters(g[1].imgObj,true,function(b){Runtime.stage.setBackgroundImg(b)}):generateImageFromUrl(g[1].img,function(b){g[1].imgObj=b;f.applyFilters(g[1].imgObj,
true,function(b){Runtime.stage.setBackgroundImg(b)})}):g[1].img!="avatar://spine"&&(g[1].imgObj?f.applyFilters(g[1].imgObj,true,function(b){f.spriteObj.setSpriteImg(b,g[1].cx,g[1].cy)}):generateImageFromUrl(g[1].img,function(b){g[1].imgObj=b;f.applyFilters(g[1].imgObj,true,function(b){f.spriteObj.setSpriteImg(b,g[1].cx,g[1].cy)})}))}}};
Sprite.prototype.updateCostume=function(){if(this.costumes.length>0&&this.filtersChanged){var b=this.costumes[(this.currentCostume-1)%this.costumes.length],c=this;if(this.spriteObj==null){if(b.imgObj){b.imgObj.onload=function(){c.applyFilters(b.imgObj,false,function(b){Runtime.stage.setBackgroundImg(b)})};c.applyFilters(b.imgObj,false,function(b){Runtime.stage.setBackgroundImg(b)})}}else if(b.imgObj){b.imgObj.onload=function(){c.applyFilters(b.imgObj,false,function(d){c.spriteObj.setSpriteImg(d,b.cx,
b.cy)})};c.applyFilters(b.imgObj,false,function(d){c.spriteObj.setSpriteImg(d,b.cx,b.cy)})}}};
Sprite.prototype.addCostume=function(b,c){var d={hidden:b.hidden,name:b.name,img:b.img,cx:b.cx,cy:b.cy},e=1,f=d.name;if(f)newName=f;else{f="";newName="1";e=2}d.name=void 0;var g=false;do for(var g=false,h=0;h<this.costumes.length;h++)if(this.costumes[h].name==newName){g=true;newName=f+e;e++;break}while(g);d.name=newName;this.costumes.push(d);generateImageFromUrl(b.img,function(b){d.imgObj=b;if(d.cx===void 0)d.cx=b.width/2;if(d.cy===void 0)d.cy=b.height/2;c&&c(d.imgObj)});Sprites._broadcastSpriteListeners("updateAddCostume",
this,d);return d};Sprite.prototype.cloneActor=function(b){var c=ObjectIO.serializeSprite(this),d=this.label,e=1,f=d+e,g=false;do for(var g=false,h=0;h<Runtime.sprites.length;h++)if(Runtime.sprites[h].label==f){g=true;e++;f=d+e;break}while(g);c.label=f;c=JSON.parse(JSON.stringify(c));return ObjectIO.deserializeSprite(c,b)};
Sprite.prototype.copyActor=function(b){var c=this,d=this.currentCostume,e=Sprites.addSprite({label:c.label,scale:c.spriteObj.scale.x,x:c.spriteObj.x-Runtime.stage.getWidth()/2,y:-(c.spriteObj.y-Runtime.stage.getHeight()/2),rotation:c.spriteObj.rotation,rotateLock:c.spriteObj.rotateLock,draggable:c.spriteObj.draggable,isHidden:!c.spriteObj.visible,costumeName:c.costumes[0].name,cx:c.costumes[0].cx,cy:c.costumes[0].cy,img:Sprites._blankImg,volume:c.volume,forceNumber:true,locked:c.locked?true:false,
zIndex:c.spriteObj.zIndex,classname:c.classname,penColor:c.penColor,fillColor:c.fillColor,font:c.font,fontColor:c.fontColor,penWidth:c.penWidth,bubble:c.bubble,skeletonType:c.skeleton?c.skeleton.type:null,skeletonParts:c.skeleton?c.skeleton.parts:null},function(e){if(e.spriteObj.physicsBody&&c.physicsBody){var g=Physics.getSpriteProperties(c.spriteObj);Physics.updateBody(e.spriteObj,{isStatic:g.isStatic!==void 0?g.isStatic:false,isActive:g.isActive!==void 0?g.isActive:true,geometry:g.geometry,density:g.density,
friction:g.friction,restitution:g.restitution})}e.costumes=c.costumes;e.currentCostume=-1;e.setCostumeByName(d);c.spriteObj.zIndex&&e.spriteObj.setZIndex(c.spriteObj.zIndex);b&&b(e)});if(c.avatarid)e.avatarid=c.avatarid;e.sounds=this.sounds;e.variables=cloneObj(this.variables);e.varDefaults=this.varDefaults;e.lists=cloneObj(this.lists);e.varTransient=cloneObj(this.varTransient);e.scripts=this.scripts;Runtime.registerScripts(e);return e};
Sprites.removeSprite=function(b){if(b=Sprites.getSpriteByName(b)){Runtime.stopScripts(b);b.deleteActor()}};Sprite.prototype.deleteActor=function(){for(var b=0;b<Runtime.sprites.length;b++)if(Runtime.sprites[b]==this){Runtime.sprites.splice(b,1);break}Runtime.unregisterScripts(this);Runtime.stage.remove(this.spriteObj);Runtime.stage.draw();Sprites._broadcastSpriteListeners("delete",this)};
Sprite.prototype.captureScreenshot=function(){var b=this.spriteObj.getImageData();$("body > canvas.screenshot").detach();var c=$('<canvas class="screenshot" style="display:none" width="'+b.width+'" height="'+b.height+'"></canvas>');$("body").append(c);var d=c[0].getContext("2d");d.putImageData(b,0,0);b=d.canvas.toDataURL();c.detach();return b};Sprite.prototype.whenReady=function(b){this._ready?b():this._spriteReadyCallback=b};
Sprite.prototype.getNumAnimations=function(b){var c=0;if(b)for(var d=0;d<this.animations.length;d++)this.animations[d].name==b&&c++;else c=this.animations.length;return c};Sprite.prototype.addAnimation=function(b){if(b.animation=="costume")for(var c=0;c<this.animations.length;c++)if(this.animations[c].animation=="costume"){if(this.animations[c].costumePrefix==b.costumePrefix){this.animations[c].startTime=Date.now();this.animations[c].timeout=b.timeout;return}this.animations.splice(c,1);c--}this.animations.push(b)};
Sprite.prototype.removeAnimations=function(){for(var b={},c=0;c<this.animations.length;c++)b[this.animations[c].name]=true;this.animations.length=0;for(var d in b)Runtime.triggerAnimationDone(d,this)};Sprite.prototype.removeAnimation=function(b){for(var c=0,d=-1,e=0;e<this.animations.length;e++)this.animations[e]==b?d=e:this.animations[e].name==b.name&&c++;d>=0&&this.animations.splice(d,1);c<=0&&Runtime.triggerAnimationDone(b.name,this)};
Sprite.prototype.animate=function(){for(var b=this.animations.length-1;b>=0;b--){var c=this.animations[b],d=false;switch(c.animation){case "moveBy":d=this.animateMoveBy(c);break;case "moveTo":d=this.animateMoveTo(c);break;case "scaleTo":d=this.animateScaleTo(c);break;case "rotateBy":d=this.animateRotateBy(c);break;case "bezierTo":d=this.animateBezierTo(c);break;case "costume":d=this.animateSwitchCostume(c);break;case "effectTo":d=this.animateEffectTo(c)}d&&this.removeAnimation(c)}};
Sprite.prototype.adjustAnimationTime=function(b){for(var c=this.animations.length-1;c>=0;c--)this.animations[c].startTime=this.animations[c].startTime+b};
Sprite.prototype.nextCostumeInGroup=function(b,c){var d=false;if(this.skeleton.skeletonData){for(var e=this.skeleton.skeletonData.animations,f=0;f<e.length;f++)if(e[f].name==b){if(b!=this.skeleton.animationName){this.skeleton.state.setAnimationByName(0,b,true);this.skeleton.animationName=b}d=true;break}if(d){this.updateSkeleton();var g=this;this.spriteObj.setSpriteDraw(function(b){g._drawSkeleton(b)},g.skeleton.skeletonBounds.maxX-g.skeleton.skeletonBounds.minX,g.skeleton.skeletonBounds.maxY-g.skeleton.skeletonBounds.minY);
return}}d=this.getCostumes();f=this.getCostumeByName(this.currentCostume);e=0;if(f&&f[1].name.substring(0,b.length)==b){e=(f[0]+1)%d.length;c||(c=1);for(f=0;f<c;f++)for(var h=e,j=0;j<d.length;h++,j++)if(d[h%d.length].name.substring(0,b.length)==b){e=h%d.length;break}}else for(f=0;f<d.length;f++)if(d[f].name.substring(0,b.length)==b){e=f;break}this.setCostumeByName(e+1)};Sprite.prototype.loadSkeleton=function(b,c){this.skeleton.type=b;this.skeleton.parts=c;this._loadSkeleton()};
Sprite.prototype._generatePreview=function(){var b=document.createElement("canvas");ctx=b.getContext("2d");b.width=128;b.height=128;ctx.save();if(this.skeleton.type=="Tiny"||this.skeleton.type=="Small"){ctx.translate(64,64);ctx.scale(0.5,0.5)}else if(this.skeleton.type=="Troll"){ctx.translate(64,64);ctx.scale(0.25,0.25)}else if(this.skeleton.type=="MonsterHighRig"){ctx.translate(64,64);ctx.scale(0.3,0.3)}else{ctx.translate(64,64);ctx.scale(0.125,0.125)}this._drawSkeleton(ctx);ctx.restore();return b};
Sprite.prototype._loadSkeleton=function(){var b=this,c=b.skeleton.type;if(g_parts[c].alias)c=g_parts[c].alias;var d=0,e;for(e in g_parts[c].parts)for(var f=g_parts[c].parts[e],g=0;g<f.length;g++)d++;for(e in g_parts[c].parts){f=g_parts[c].parts[e];if(!b.skeleton.parts[e]||b.skeleton.parts[e]=="blank")for(g=0;g<f.length;g++){var h=new Image;h.onload=function(){b.updateSkeleton();if(--d<=0)for(var c=0;c<b.costumes.length;c++)if(b.costumes[c].img=="avatar://spine"){b.costumes[c].imgPreview=b._generatePreview().toDataURL("image/png");
window.WinAssets&&WinAssets.update(true);break}};if(!b.skeleton.parts[e]&&g_parts[c].defaultparts&&g_parts[c].defaultparts[e]){var j=g_parts[c].defaultparts[e];h.src="ide/avatar/skins/"+c+"/"+b.skeleton.parts[j]+"/"+f[g]+".png"}else h.src=Sprites._blankImg;b.skeleton.textures[f[g]]=h}else for(g=0;g<f.length;g++){h=new Image;h.onload=function(){b.updateSkeleton();Runtime.stage.draw();if(--d<=0)for(var c=0;c<b.costumes.length;c++)if(b.costumes[c].img=="avatar://spine"){b.costumes[c].imgPreview=b._generatePreview().toDataURL("image/png");
window.WinAssets&&WinAssets.update(true);break}};if(b.skeleton.parts[e]=="blank")h.src=Sprites._blankImg;else if(b.skeleton.parts[e])h.src="ide/avatar/skins/"+c+"/"+b.skeleton.parts[e]+"/"+f[g]+".png";else if(g_parts[c].defaultparts&&g_parts[c].defaultparts[e]){j=g_parts[c].defaultparts[e];h.src="ide/avatar/skins/"+c+"/"+b.skeleton.parts[j]+"/"+f[g]+".png"}else h.src=Sprites._blankImg;b.skeleton.textures[f[g]]=h}}Sprites._fetchSkeleton(c,function(c){b.skeleton.skeletonData=c;b.skeleton.skeleton=
new spine.Skeleton(b.skeleton.skeletonData);b.skeleton.stateData=new spine.AnimationStateData(b.skeleton.skeletonData);b.skeleton.state=new spine.AnimationState(b.skeleton.stateData);b.skeleton.animationName=b.skeleton.skeletonData.animations[0].name;for(c=0;c<b.skeleton.skeletonData.animations.length;c++){var d=b.skeleton.skeletonData.animations[c].name;if(d.toLowerCase()=="idle"){b.skeleton.animationName=d;break}}b.skeleton.state.setAnimationByName(0,b.skeleton.animationName,true);b.skeleton.skeleton.setSkinByName("default");
b.skeleton.skeleton.setSlotsToSetupPose();b.skeleton.skeletonBounds=new spine.SkeletonImageBounds;b.skeleton.state.update(0);b.skeleton.state.apply(b.skeleton.skeleton);b.skeleton.skeleton.updateWorldTransform();b.skeleton.skeletonBounds.update(b.skeleton.skeleton,true);b.spriteObj.drawFunction=null;b.spriteObj.setSpriteDraw(function(c){b._drawSkeleton(c)},b.skeleton.skeletonBounds.maxX-b.skeleton.skeletonBounds.minX,b.skeleton.skeletonBounds.maxY-b.skeleton.skeletonBounds.minY);for(c=0;c<b.costumes.length;c++)if(b.costumes[c].img==
"avatar://spine"){b.costumes[c].imgPreview=b._generatePreview().toDataURL("image/png");window.WinAssets&&WinAssets.update(true);break}b.skeleton.totalTime=0;b.skeleton.lastTime=Date.now();Runtime.stage.draw()})};
Sprites._fetchSkeleton=function(b,c){b&&c&&Sprites._skelLoad.push({skelType:b,callback:c});if(Sprites._skelLoad.length>0&&!Sprites._skelIsFetching){for(;Sprites._skelLoad.length>0;){var d=Sprites._skelLoad[0];if(Sprites._skelCache[d.skelType]){Sprites._skelLoad.shift();d.callback(Sprites._skelCache[d.skelType])}else break}if(Sprites._skelLoad.length>0){d=Sprites._skelLoad.shift();Sprites._skelIsFetching=true;$.ajax({url:"ide/avatar/rigs/"+d.skelType+".json",dataType:"json",success:function(b){b=
(new spine.SkeletonJson({newRegionAttachment:function(b,c){var d=new spine.RegionAttachment(c);d.rendererObject=null;d.setUVs(0,0,1,1,false);d.regionOffsetX=0;d.regionOffsetY=0;d.regionOriginalWidth=d.regionWidth=1;d.regionOriginalHeight=d.regionHeight=1;return d},newBoundingBoxAttachment:function(b,c){return new spine.BoundingBoxAttachment(c)},newMeshAttachment:function(b,c){return new spine.MeshAttachment(c)},newSkinnedMeshAttachment:function(b,c){return new spine.SkinnedMeshAttachment(c)}})).readSkeletonData(b);
Sprites._skelCache[d.skelType]=b;d.callback(b);Sprites._skelIsFetching=false;Sprites._fetchSkeleton()},error:function(){Sprites._skelIsFetching=false;Sprites._fetchSkeleton()}})}}};Sprite._applySkelBoneTransform=function(b,c){c.parent&&Sprite._applySkelBoneTransform(b,c.parent);b.translate(c.x,c.y);b.rotate(c.rotation*Math.PI/180);b.scale(c.scaleX,c.scaleY)};
Sprite.prototype.updateSkeleton=function(){if(this.skeleton.state){var b=Date.now();this.skeleton.state.update((b-this.skeleton.lastTime)/1E3*this.animationSpeed/30);this.skeleton.lastTime=b;this.skeleton.state.apply(this.skeleton.skeleton);this.skeleton.skeleton.updateWorldTransform()}};
Sprite.prototype._drawSkeleton=function(b){if(this.skeleton.state){b.save();b.translate(0,this.spriteObj.height/2);b.scale(1,-1);for(var c=this.skeleton.skeleton.drawOrder,d=0;d<c.length;d++){var e=c[d],f=e.attachment;if(f){b.save();Sprite._applySkelBoneTransform(b,e.bone);b.translate(f.x,f.y);b.rotate(f.rotation*Math.PI/180);b.scale(f.scaleX,f.scaleY);b.scale(1,-1);(e=this.skeleton.textures[f.name])&&b.drawImage(e,-f.width/2,-f.height/2,f.width,f.height);b.restore()}}b.restore()}};
Sprites.addSpriteListener=function(b){Sprites._listeners.indexOf(b)<0&&Sprites._listeners.push(b)};Sprites.removeSpriteListener=function(b){b=Sprites._listeners.indexOf(b);b>=0&&Sprites._listeners.splice(b,1)};Sprites._broadcastSpriteListeners=function(b,c,d){for(var e=0;e<Sprites._listeners.length;e++)Sprites._listeners[e].spriteEvent(b,c,d)};Sprites.getSpriteByName=function(b){for(var c=0;c<Runtime.sprites.length;c++){var d=Runtime.sprites[c];if(d.label==b)return d}return null};
Sprites.addSprite=function(b,c){var d={label:b.costumeName?b.costumeName:"Actor",scale:1,x:0,y:0,rotation:0,rotateLock:0,costumeName:"1",hidden:false,isHidden:false,img:Sprites._blankImg,varDefaults:{},variables:{},lists:{},locked:false,penColor:"#000000",fillColor:"",fontColor:"#000000",font:"normal 18px Comic Sans MS,cursive",penWidth:1,bubble:{penColor:"#000000",fillColor:"",fontColor:"#000000",font:"normal 18px Comic Sans MS,cursive",penWidth:1}};$.extend(d,b);var e=d.label;if(!e)e=d.costumeName;
d.label=void 0;if(d.forceNumber)var f=e+"1",g=2;else{f=e;g=1}var h=false;do for(var h=false,j=0;j<Runtime.sprites.length;j++)if(Runtime.sprites[j].label==f){h=true;f=e+g;g++;break}while(h);d.label=f;var k=new Sprite({id:d.id,classname:d.classname,label:d.label,scripts:[],costumes:[],sounds:[],varDefaults:d.varDefaults,variables:d.variables,lists:d.lists,hidden:d.hidden,spriteObj:null,currentCostume:1,penDown:false,penColor:d.penColor,fillColor:d.fillColor,font:d.font,fontColor:d.fontColor,penWidth:d.penWidth,
volume:100});Runtime.sprites.push(k);k._ready=false;k._spriteReadyCallback=c;if(d.avatarid)k.avatarid=d.avatarid;if(d.skeletonType&&d.skeletonParts){k.skeleton.type=d.skeletonType;k.skeleton.parts=d.skeletonParts}k.spriteObj=new Canvas.Actor({image:new Image,zIndex:d.zIndex,visible:!d.isHidden,font:d.font,fontColor:d.fontColor,penColor:d.penColor,fillColor:d.fillColor,penWidth:d.penWidth,bubble:d.bubble});k.spriteObj.sortorder=Runtime.sprites.length;k.addCostume({name:d.costumeName,img:d.img,cx:d.cx,
cy:d.cy},function(b){var c=k.spriteObj;c.image=b;c.x=Runtime.stage.getWidth()/2+d.x;c.y=Runtime.stage.getHeight()/2-d.y;c.width=b.width;c.height=b.height;c.cx=d.cx!==void 0&&d.cx!==null?d.cx:c.width/2;c.cy=d.cy!==void 0&&d.cy!==null?d.cy:c.height/2;c.setDraggable(true);c.setScale(d.scale,d.scale);c.setRotation(d.rotation);c.setRotateLock(d.rotateLock);c.setDraggable(d.draggable);Runtime.stage.add(c);k.spriteObj=c;c.sprite=k;Physics.addBody({},k.spriteObj);k.skeleton.type&&k.skeleton.parts&&k._loadSkeleton();
k._ready=true;k._spriteReadyCallback&&k._spriteReadyCallback(k)});k.locked=d.locked;k.hiddenInSandbox=d.hiddenInSandbox;k.lockedInSandbox=d.lockedInSandbox;k.classname=d.classname?d.classname:d.label;k.id=d.id;Runtime.spriteId++;Sprites._broadcastSpriteListeners("add",k);return k};
Scripts={clearIds:function(b){if(b){b.id=void 0;delete b.id;if(b instanceof Block){Scripts.clearIds(b.label);for(var c=0;c<b._containers.length;c++)Scripts.clearIds(b._containers[c]);Scripts.clearIds(b.next)}else if(b instanceof Label)for(c=0;c<b._children.length;c++)Scripts.clearIds(b._children[c]);else b instanceof LabelInput&&b._child!=null&&Scripts.clearIds(b._child)}return null}};function Script(b){this.origSprite=this.sprite=b.sprite;this.scriptBlock=b.scriptBlock;this.reset()}
Script.TYPE_CONTAINER=0;Script.TYPE_FUNC=1;Script.TYPE_LOOP=2;Script.prototype.reset=function(){this.sprite=this.origSprite;this.stack=[];this.previousBlock=this.currentBlock=null;this.skipArgCompute=false;this.fnArgs={};this.scriptVars={};this.data=null;this.dlgAnswer=this.dlgAskOpen="no";this.doBlock=this.doYield=this.isDirty=false;this.currentBlock=this.scriptBlock.hasFlap?this.scriptBlock:this.scriptBlock.next};Script.prototype.dirty=function(){this.isDirty=true};
Script.prototype.yield=function(){this.doYield=true};Script.prototype.requestBlock=function(b){this.doBlock=b};Script.prototype._spaces=function(){for(var b="",c=0;c<this.stack.length;c++)b=b+"    ";return b};Script.prototype.pushState=function(b,c,d,e){this.stack.push({sprite:this.sprite,containerType:d,nextBlock:b,skipArgCompute:e,fnArgs:this.fnArgs,scriptVars:this.scriptVars,lib:this.lib,data:c})};
Script.prototype.peekState=function(){return this.stack.length>0?this.stack[this.stack.length-1]:null};Script.prototype.popState=function(){if(this.stack.length>0){var b=this.stack.pop();this.sprite=b.sprite;this.currentBlock=b.nextBlock;this.skipArgCompute=b.skipArgCompute;this.fnArgs=b.fnArgs;this.scriptVars=b.scriptVars;this.lib=b.lib;this.data=b.data;return b}return null};
Script.prototype.evaluateExpression=function(b){if(b instanceof Label){var c=b.func;if(c&&this[c]){var d=[];b._children&&(d=b.getSockets());this.blockName=b.name;var e=this.currentBlock;this.currentBlock=b;d=this[c](d);this.currentBlock=e;this.blockName=void 0;if(typeof d=="number"&&(!isFinite(d)||isNaN(d))){this.currentBlock=null;this.stack=[];console.log("Error with expression at "+c+(b.name?":"+b.name:""));return}return d}}else{if(b instanceof LabelInput){if(b._child!=null)return this.evaluateExpression(b._child);
if(b.type=="number"){d=parseFloat(b.label);if(typeof d=="number"&&(!isFinite(d)||isNaN(d))){console.log("Error with numeric expression at "+this.currentBlock.func);this.currentBlock=null;this.stack=[];return}return d}if(b.type=="boolean")return b.label=="true"||b.label==true;d=valueToNative(b.label);if(typeof d=="number"&&(!isFinite(d)||isNaN(d))){console.log("Error with string expression at "+this.currentBlock.func);this.currentBlock=null;this.stack=[];return}return d}return b}return 0};
Script.prototype.pauseState=function(){if(window.WinCode&&(window.WinCode._hilightStep&&this.sprite.scripts==window.WinCode._scripts&&this.currentBlock&&this.currentBlock.func.indexOf("blockControlCall")!=0)&&!this.currentBlock.getRoot().hidden)if(this._pauseEndTime)if(Date.now()>this._pauseEndTime)this._pauseEndTime=0;else return true;else{if(this.currentBlock){this.currentBlock.setCurrent();WinCode.draw()}this._pauseEndTime=Date.now()+Runtime.runPauseTimeout;return true}return false};
Script.prototype.invokeStep=function(){var b=this.currentBlock;window.WinCode&&window.WinCode._hilightStep&&b.setCurrent();if(b){var c;c=b instanceof Block?b.label:b;var d=[];this.skipArgCompute||(d=c.getSockets());if((b=b.func)&&this[b]){if(!this[b](d)){this.skipArgCompute=false;this.data=null;if(this.currentBlock)this.currentBlock=this.currentBlock.next}if(!this.currentBlock){do{(d=this.popState())&&d.containerType==Script.TYPE_LOOP&&this.yield();if(d&&d.containerType==Script.TYPE_FUNC&&d.data){window.WinCode&&
!Runtime.hideRunOutline&&d.data.setOutline(false);this.data=null}}while(d!=null&&this.currentBlock==null)}if(this.currentBlock)return true;this.running=false;if(window.WinCode&&!Runtime.hideRunOutline){this.scriptBlock.getRoot().setOutline(false);WinCode.draw()}}else{if(b.indexOf("Drone")>0||b.indexOf("Sphero")>0||b.indexOf("Hardware")>0||b.indexOf("Jumping")>0||b.indexOf("Hue")>0){Runtime.background.font="normal 50px Arial,Helvetica,sans-serif";Runtime.background.fillColor="#f00";Runtime.background.fontColor=
"#fff";_doBlockLooksSay(Runtime.background,"This project uses hardware blocks. You'll need to run this project on the Tynker app to have it control hardware.")}console.log("unknown block: "+b);this.yield();this.currentBlock=this.currentBlock.next}}return false};
var Avatar={animNames:"walk;run;jump;attack;defend;grab;throw;frustrated;gangnam;idle;talk;jump front;twist dance".split(";"),animations:{},partGroups:{arm:"armL armL1 handL handL1 forearmL forearmL1 armR handR forearmR handFistR handFistL".split(" "),fullWeapon:["weapon","cover"],fullHead:"neck head hat beard nose mouth1 mouth2 mouthClosed mouthSmall mouthteeth hair1 hair2 head_hair ear eyes eyesClosed".split(" "),hair:["hair1","hair2","head_hair","beard"],accesoryHat:["hat"],accesoryWeapon:["weapon",
"cover"],accesoryEye:["propEyes"],fullEyes:["eyes","eyesClosed"],mouth:["mouth1","mouth2","mouthClosed","mouthSmall","mouthteeth"],ears:["ear"],expressionParts:["eyes","eyesClosed","mouth1"],animationExpressions:["mouth1_crying","mouth1_angry","eyes_crying","eyes_angry"],fullNose:["nose"],torso:["chest","cape"],legs:"hip thighR legR footR thighL legL footL footR2".split(" "),presets:"propEyes chest cape neck head hat beard nose mouth1 mouth2 mouthClosed mouthSmall mouthteeth hair1 hair2 head_hair ear cover eyes eyesClosed mouth1_crying mouth1_angry eyes_crying eyes_angry armL armL1 handL handL1 forearmL forearmL1 armR handR forearmR hip thighR legR footR thighL legL footL footR2 handFistR handFistL weapon".split(" ")},
colorGroups:{arm:["armL","armL1","armR"],forearm:["forearmL","forearmL1","forearmR"],hand:["handL","handL1","handR","handFistR","handFistL"],weapon:["weapon","cover"],hip:["hip"],thigh:["thighR","thighL"],leg:["legR","legL"],foot:["footR","footL","footR2"],torso:["chest","cape"],head:["head"],hair:["hair1","hair2","head_hair","beard"],hat:["hat"],mouth:["mouth1","mouth2","mouthClosed","mouthSmall","mouthteeth"],nose:["nose"],ear:["ear"],eyes:["eyes","eyesClosed","eyes_crying","eyes_angry"],accesoryEye:["propEyes"],
skin:"chest neck head mouth1 nose ear armL armL1 handL handL1 forearmL forearmL1 armR handR forearmR hip thighR legR footR thighL legL footL footR2 handFistR handFistL".split(" ")},expressions:"angry bored crying disgusted envy goofy happy inlove laughing mischevious scheming shocked surprised".split(" "),availableCharacters:{boy:"hero cowboy pirate prince superhero shaman knight zombie wizard robot mummy alien athlete doctor fbiagent heavymetal martialartist soldier halorobot scientist chef businessman new_alien new_cop new_cowboy new_haloblue new_halored new_hero new_indi new_knight new_ninja new_pirate new_regular new_robot new_zombie new_wizard".split(" "),
girl:"supergirl elf explorer huntress fairy princess witch shopper cowgirl businessgirl fbiagent chef doctor scientist athlete martialartist pirate teacher foodservice new_femfbiagent new_femhero new_femindi new_femmummy new_femninja new_fempirate new_femregular new_femvalkyrie".split(" "),littleBoy:"fireman police superhero pijama snow swimming athlete ninja scout chubby".split(" "),littleGirl:"normal swimming athlete ninja scout supergirl firegirl police pijama snow".split(" "),custom:[]},exceptions:{expressions:{boy:"new_haloblue new_knight new_robot new_zombie new_ninja new_halored new_cowboy new_alien".split(" "),
girl:["new_femninja","new_femmummy"],littleBoy:[],littleGirl:[]},hair:{boy:["alien","mummy","knight","zombie","robot"],girl:["athlete","chef","doctor","martialartist","teacher"],littleBoy:[],littleGirl:["firegirl","police","pijama","snow"]},accesoryHat:{boy:"hero superhero shaman knight zombie robot mummy alien athlete doctor fbiagent heavymetal martialartist halorobot businessman".split(" "),girl:"athlete businessgirl doctor elf fairy fbiagent martialartist pirate scientist shopper supergirl teacher".split(" "),
littleBoy:"pijama superhero athlete ninja scout chubby".split(" "),littleGirl:"normal athlete ninja scout supergirl pijama".split(" ")},fullEyes:{boy:"athlete businessman chef doctor fbiagent halorobot heavymetal knight martialartist robot scientist soldier".split(" "),girl:"businessgirl chef fbiagent foodservice martialartist pirate scientist teacher".split(" "),littleBoy:[],littleGirl:[]},fullNose:{boy:"alien athlete businessman chef doctor fbiagent halorobot heavymetal knight martialartist mummy prince robot scientist soldier".split(" "),
girl:[],littleBoy:[],littleGirl:[]},mouth:{boy:"athlete businessman chef doctor fbiagent heavymetal halorobot knight martialartist prince robot scientist soldier".split(" "),girl:[],littleBoy:[],littleGirl:[]},accesoryWeapon:{boy:"prince superhero zombie robot mummy alien athlete doctor fbiagent heavymetal martialartist soldier halorobot scientist chef businessman".split(" "),girl:"supergirl explorer huntress fairy princess cowgirl businessgirl fbiagent chef doctor scientist".split(" "),littleBoy:"fireman police superhero pijama snow swimming athlete ninja scout chubby".split(" "),
littleGirl:"normal swimming athlete ninja scout supergirl firegirl police pijama snow".split(" ")},accesoryEye:{boy:"hero cowboy pirate prince superhero shaman knight zombie wizard robot mummy alien athlete doctor fbiagent heavymetal martialartist soldier halorobot scientist chef businessman".split(" "),girl:"supergirl elf explorer huntress fairy princess witch shopper cowgirl businessgirl fbiagent chef doctor scientist".split(" "),littleBoy:["snow","fireman","pijama","police","superhero"],littleGirl:["normal",
"swimming","athlete","ninja","scout"]}},customParts:{accesoryHat:{boy:[],girl:[],littleBoy:[],littleGirl:[]},accesoryWeapon:{boy:[],girl:[],littleBoy:[],littleGirl:[]},accesoryEye:{boy:[],girl:[],littleBoy:[],littleGirl:[]}},selectedGroup:"presets",selectedPreset:"supergirl",selectedColorGroup:"",selectedGender:"boy",selectedCarousel:"boy",selectedExpression:"",selectedColor:null,defaultBoyPreset:"hero",defaultGirlPreset:"supergirl",defaultLittleBoyPreset:"snow",defaultLittleGirlPreset:"normal",defaultCustomPreset:null,
defaultExpression:"happy",currentEdition:"body",builtCharacter:{name:"",gender:"boy",parts:{chest:{baseImg:"hero",part:"hero",color:"none"},cape:{baseImg:"hero",part:"hero",color:"none"},neck:{baseImg:"hero",part:"hero",color:"none"},head:{baseImg:"hero",part:"hero",color:"none"},nose:{baseImg:"hero",part:"hero",color:"none"},beard:{baseImg:"hero",part:"hero",color:"none"},hat:{baseImg:"hero",part:"hero",color:"none"},mouth1:{baseImg:"hero",part:"hero",color:"none"},mouth2:{baseImg:"hero",part:"hero",
color:"none"},mouthClosed:{baseImg:"hero",part:"hero",color:"none"},mouthSmall:{baseImg:"hero",part:"hero",color:"none"},mouthteeth:{baseImg:"hero",part:"hero",color:"none"},hair1:{baseImg:"hero",part:"hero",color:"none"},hair2:{baseImg:"hero",part:"hero",color:"none"},head_hair:{baseImg:"hero",part:"hero",color:"none"},ear:{baseImg:"hero",part:"hero",color:"none"},cover:{baseImg:"hero",part:"hero",color:"none"},eyes:{baseImg:"hero",part:"hero",color:"none"},eyesClosed:{baseImg:"hero",part:"hero",
color:"none"},propEyes:{baseImg:"ide/avatar/parts/boy/hero/1_propEyes.png",part:"hero",color:"none"},mouth1_crying:{baseImg:"ide/avatar/parts/boy/expressions/1_mouth1_crying.png",part:"hero",color:"none"},mouth1_angry:{baseImg:"ide/avatar/parts/boy/expressions/1_mouth1_angry.png",part:"hero",color:"none"},eyes_crying:{baseImg:"ide/avatar/parts/boy/expressions/1_eyes_crying.png",part:"hero",color:"none"},eyes_angry:{baseImg:"ide/avatar/parts/boy/expressions/1_eyes_angry.png",part:"hero",color:"none"},
armL:{baseImg:"hero",part:"hero",color:"none"},armL1:{baseImg:"hero",part:"hero",color:"none"},handL:{baseImg:"hero",part:"hero",color:"none"},handL1:{baseImg:"hero",part:"hero",color:"none"},forearmL:{baseImg:"hero",part:"hero",color:"none"},forearmL1:{baseImg:"hero",part:"hero",color:"none"},armR:{baseImg:"hero",part:"hero",color:"none"},handR:{baseImg:"hero",part:"hero",color:"none"},forearmR:{baseImg:"hero",part:"hero",color:"none"},hip:{baseImg:"hero",part:"hero",color:"none"},thighR:{baseImg:"hero",
part:"hero",color:"none"},legR:{baseImg:"hero",part:"hero",color:"none"},footR:{baseImg:"hero",part:"hero",color:"none"},thighL:{baseImg:"hero",part:"hero",color:"none"},legL:{baseImg:"hero",part:"hero",color:"none"},footL:{baseImg:"hero",part:"hero",color:"none"},footR2:{baseImg:"hero",part:"hero",color:"none"},handFistR:{baseImg:"hero",part:"hero",color:"none"},handFistL:{baseImg:"hero",part:"hero",color:"none"},weapon:{baseImg:"hero",part:"hero",color:"none"}}},toGenerate:[],generatedCounter:0,
imgArray:[],cacheImgs:{},grayscaledImgs:{},imageData:{},renderOrder:[],downloaded:0,alphaDownloaded:0,cacheDownloaded:0,cacheAlphaDownloaded:0,grayscalesLoaded:0,totalFrames:9,xOffset:15,yOffset:50,generatedImages:[],canvas:function(){var b=document.createElement("canvas");b.width=400;b.height=400;return b}(),currentId:null,_frames:[],currentCharacterId:null,alphaDownloadedUnchangedCount:0,previousCacheAlphaDownloaded:0,numUserCharacters:0,propertyChangedCallbacks:$.Callbacks(),customCharacterList:[],
init:function(b){Avatar.currentCharacterId=null;Avatar.loadCustomCharacters(b)},initWhenReady:function(){Avatar.generatePartList();$("#win-avatar iframe").load(function(){Avatar._cacheImgs()})},_cacheImgs:function(){var b=$("#win-avatar iframe").contents().find("svg image");$.each(b,function(b,d){var e={};e.id=$(d).attr("id");e.width=$(d).attr("width");e.height=$(d).attr("height");e.href=$(d).attr("xlink:href");e.alphaHref=$(d).attr("xlink:href").replace(/1_(.*)/,"alpha_prop_"+e.id+".png");Avatar.addToCache(e)})},
setCanvasSize:function(b,c){Avatar.canvas.width=b;Avatar.canvas.height=c},resetNonCache:function(){Avatar.imageData={};Avatar.renderOrder=[];Avatar.downloaded=0;Avatar.alphaDownloaded=0;Avatar.clearCanvas()},clearCache:function(){Avatar.cacheImgs={};Avatar.cacheDownloaded=0},clearCanvas:function(){Avatar.canvas.width=Avatar.canvas.width},getContext:function(){return Avatar.canvas.getContext("2d")},getCurrentImg:function(){return Avatar.canvas.toDataURL("image/png")},addPropertyChangedCallback:function(b){Avatar.propertyChangedCallbacks.add(b)},
removePropertyChangedCallback:function(b){Avatar.propertyChangedCallbacks.remove(b)},getNumUserCharacters:function(){return Avatar.numUserCharacters},setNumUserCharacters:function(b){Avatar.numUserCharacters=b;Avatar.propertyChangedCallbacks.fire("numUserCharacters")},getSelectedGender:function(){return Avatar.selectedGender},setSelectedGender:function(b){if(b!=Avatar.selectedGender){Avatar.selectedGender=b;Avatar.propertyChangedCallbacks.fire("selectedGender")}},getSelectedCarousel:function(){return Avatar.selectedCarousel},
setSelectedCarousel:function(b){if(b!=Avatar.selectedCarousel){Avatar.selectedCarousel=b;Avatar.propertyChangedCallbacks.fire("selectedCarousel")}},getSelectedColorGroup:function(){return Avatar.selectedColorGroup},setSelectedColorGroup:function(b){if(b!=Avatar.selectedColorGroup){Avatar.selectedColorGroup=b;Avatar.propertyChangedCallbacks.fire("selectedColorGroup")}},addImage:function(b,c,d){b.loaded=false;b.img=new Image;b.img.addEventListener("load",function(){Avatar.loadedImg();d&&Avatar.downloaded==
c&&d()});b.img.src=b.href;b.img.id=b.id;b.useCache=false;b.alphaLoaded=false;b.alpha=new Image;b.alpha.addEventListener("load",Avatar.loadedAlphaImg);if(b.alphaHref)b.alpha.src=b.alphaHref;Avatar.imageData[b.id]=b;Avatar.renderOrder.push(b.id)},addToCache:function(b,c,d){b.loaded=false;b.img=new Image;b.img.addEventListener("load",function(){Avatar.loadedCacheImg.call(b);d&&Avatar.cacheDownloaded==c&&d()});b.img.src=b.href;b.img.id=b.id;b.alphaLoaded=false;b.alpha=new Image;b.alpha.addEventListener("load",
Avatar.loadedCacheAlphaImg.bind(b));if(b.alphaHref)b.alpha.src=b.alphaHref;Avatar.cacheImgs[b.id]=b;Avatar.renderOrder.push(b.id)},editCacheImg:function(b){if(Avatar.cacheImgs[b.id]&&Avatar.cacheImgs[b.id].href!=b.href){Avatar.cacheImgs[b.id].href=b.href;Avatar.cacheImgs[b.id].loaded=false;Avatar.cacheImgs[b.id].alphaLoaded=false;if(Avatar.grayscaledImgs[b.id])Avatar.grayscaledImgs[b.id].loaded=false;if(Avatar.cacheDownloaded>0)Avatar.cacheDownloaded=Avatar.cacheDownloaded-1;if(Avatar.cacheAlphaDownloaded>
0)Avatar.cacheAlphaDownloaded=Avatar.cacheAlphaDownloaded-1;if(Avatar.grayscalesLoaded>0)Avatar.grayscalesLoaded=Avatar.grayscalesLoaded-1;var c=Avatar.cacheImgs[b.id].img.src,d=Avatar.cacheImgs[b.id].alpha.src;Avatar.cacheImgs[b.id].img.src=b.href;var e=Avatar.getAlphaURL(b.id,b.href);Avatar.cacheImgs[b.id].alpha.src=e;c.indexOf(b.href)>-1&&Avatar.loadedCacheImg.call(b);d.indexOf(e)>-1&&Avatar.loadedCacheAlphaImg.call(b)}},loadedImg:function(){Avatar.downloaded=Avatar.downloaded+1},loadedAlphaImg:function(){Avatar.alphaDownloaded=
Avatar.alphaDownloaded+1},loadedCacheImg:function(){Avatar.cacheDownloaded=Avatar.cacheDownloaded+1;Avatar.cacheImgs[this.id].loaded=true},loadedCacheAlphaImg:function(){Avatar.cacheImgs[this.id].alphaLoaded=true;Avatar.cacheAlphaDownloaded=Avatar.cacheAlphaDownloaded+1},loadedGrayscaleImg:function(){Avatar.grayscaledImgs[this.id].loaded=true;Avatar.grayscalesLoaded=Avatar.grayscalesLoaded+1},isDownloadDone:function(){return Avatar.renderOrder.length==Avatar.downloaded},isCacheDownloaded:function(){var b=
true,c;for(c in Avatar.cacheImgs){b=Avatar.cacheImgs[c].loaded&&b;if(!b)break}return b},isAlphaDownloaded:function(b){if(b){var b=true,c;for(c in Avatar.cacheImgs){b=Avatar.cacheImgs[c].alphaLoaded&&b;if(!b)break}return b}return Avatar.renderOrder.length==Avatar.alphaDownloaded},isGrayscaleLoaded:function(){var b=true,c;for(c in Avatar.grayscaledImgs){b=Avatar.grayscaledImgs[c].loaded&&b;if(!b)break}return b},applyGrayscaleFilter:function(b,c,d,e){if((c?Avatar.isCacheDownloaded():Avatar.isDownloadDone())||
d){var f=c?Avatar.cacheImgs[b]:Avatar.imageData[b],g=document.createElement("canvas");g.width=f.img.width;g.height=f.img.height;var h=g.getContext("2d");h.drawImage(f.img,0,0);for(var f=h.getImageData(0,0,g.width,g.height),j=0;j<f.data.length;j=j+4)f.data[j+3]>0&&(f.data[j]=f.data[j+1]=f.data[j+2]=0.2126*f.data[j]+0.7152*f.data[j+1]+0.0722*f.data[j+2]);h.putImageData(f,0,0);if(d)return g;h=document.createElement("img");h.width=g.width;h.height=g.height;f={id:b,img:h,loaded:false};Avatar.grayscaledImgs[b]=
f;h.addEventListener("load",Avatar.loadedGrayscaleImg.bind(f));h.src=g.toDataURL("image/png");e&&e()}else setTimeout(function(){Avatar.applyGrayscaleFilter(b,c,d,e)},30)},applyTint:function(b,c,d,e){if(this.isAlphaDownloaded(d)&&this.isGrayscaleLoaded()||e){if(Avatar.grayscaledImgs[b].img!=void 0){var f=d?Avatar.grayscaledImgs[b].img:Avatar.applyGrayscaleFilter(b,d,true),g=document.createElement("canvas");g.width=f.width;g.height=f.height;var h=g.getContext("2d");h.globalAlpha=0.6;h.fillStyle=c;h.fillRect(0,
0,g.width,g.height);h.globalCompositeOperation="destination-atop";h.globalAlpha=1;h.drawImage(f,0,0);h.globalCompositeOperation="destination-atop";f=d?Avatar.cacheImgs[b].alpha:Avatar.imageData[b].alpha;if(f.width==0){h.globalAlpha=0;h.fillRect(0,0,g.width,g.height);h.globalAlpha=1}else h.drawImage(f,0,0);h.globalCompositeOperation="destination-atop";f=d?Avatar.cacheImgs[b].img:Avatar.imageData[b].img;h.drawImage(f,0,0);if(e)return g;g=g.toDataURL("image/png");$("#win-avatar iframe").contents().find("#"+
b).attr("xlink:href",g)}}else{var j=this;setTimeout(function(){j.applyTint(b,c,d,e)},30)}},imgFromJson:function(b,c){Avatar.resetNonCache();for(var d=false,e=$("#win-avatar iframe").contents().find("svg image"),f=0;f<e.length;f++){var g={};g.id=$(e[f]).attr("id");g.width=$(e[f]).attr("width");g.height=$(e[f]).attr("height");if(b.parts[g.id].baseImg.indexOf("ide/avatar/parts/")>-1){g.href=b.parts[g.id].baseImg;if(g.href.indexOf("none.png")>-1)g.alphaHref=b.parts[g.id].baseImg;else{var h=Avatar.getAlphaURL(g.id,
b.parts[g.id].baseImg);g.alphaHref=h}}else{g.href="ide/avatar/parts/"+b.gender+"/"+b.parts[g.id].baseImg+"/1_"+g.id+".png";g.alphaHref="ide/avatar/parts/"+b.gender+"/"+b.parts[g.id].baseImg+"/alpha_prop_"+g.id+".png"}g.color=b.parts[g.id].color;Avatar.addImage(g);!d&&b.parts[g.id].color!="none"&&(d=true)}Avatar.setCanvasSize(400,400);Avatar.renderImg(false,d,c)},renderImg:function(b,c,d){var e=b?Avatar.isCacheDownloaded():Avatar.isDownloadDone();c&&(e=e&&Avatar.isAlphaDownloaded(b));if(e){Avatar.clearCanvas();
for(var e=Avatar.getContext(),f=0;f<Avatar.renderOrder.length;f++){var g=$("#win-avatar iframe").contents().find("svg #"+Avatar.renderOrder[f]),h=g.attr("transform"),j=b?Avatar.cacheImgs[Avatar.renderOrder[f]]:Avatar.imageData[Avatar.renderOrder[f]],k=g.attr("x"),g=g.attr("y"),h=h.substring(7,h.length-1);e.save();e.scale(Avatar.canvas.width/400,Avatar.canvas.height/400);Avatar.applySVGRotation(h.split(" "));e.translate(k,g);Avatar.keepAspectRatio(j.width,j.img.width,j.height,j.img.height);if(c&&j.color&&
j.color!="none"){j=Avatar.applyTint(Avatar.renderOrder[f],j.color,b,true);e.drawImage(j,0,0)}else e.drawImage(j.img,0,0);e.restore()}d&&d(Avatar.canvas.toDataURL())}else setTimeout(function(){Avatar.renderImg(b,c,d)},30)},renderSingleFrame:function(b,c,d){Avatar.clearCanvas();for(var b=c[b===void 0?0:b],c=Avatar.getContext(),e=0;e<Avatar.renderOrder.length;e++){var f=d?Avatar.cacheImgs[Avatar.renderOrder[e]]:Avatar.imageData[Avatar.renderOrder[e]],g=$.grep(b,function(b){return b.par==f.id})[0];c.save();
c.scale(Avatar.canvas.width/400,Avatar.canvas.height/400);c.scale(0.85,0.85);c.translate(Avatar.xOffset,Avatar.yOffset);Avatar.applySVGRotation(g.rot.split(" "));c.translate(g.x,g.y);Avatar.keepAspectRatio(f.width,f.img.width,f.height,f.img.height);if(f.color&&f.color!="none"){g=Avatar.applyTint(Avatar.renderOrder[e],f.color,d,true);c.drawImage(g,0,0)}else c.drawImage(f.img,0,0);c.restore()}},applySVGRotation:function(b){var c=Avatar.getContext(),d=Avatar.degToRad(b[0]),e=b[1],b=b[2];c.translate(e,
b);c.rotate(d);c.translate(-e,-b)},keepAspectRatio:function(b,c,d,e){var f=Avatar.getContext(),g=b/c,h=d/e,j=Math.min(g,h);Math.max(g,h);e=e*j;j==h&&f.translate(b/2-c*j/2,0);j==g&&f.translate(0,d/2-e/2);f.scale(j,j);f.translate(0,0)},degToRad:function(b){return b*(Math.PI/180)},SVGToCanvas:function(b){var c=$("#win-avatar iframe").contents().find("svg image");Avatar.resetNonCache();$.each(c,function(d,e){var f=$(e),g={};g.id=f.attr("id");g.width=f.attr("width");g.height=f.attr("height");g.href=f.attr("xlink:href");
f=g.href.indexOf("data:image")>-1?Avatar.builtCharacter.parts[g.id].baseImg:g.href;g.alphaHref=Avatar.getAlphaURL(g.id,f);try{g.color=Avatar.builtCharacter.parts[g.id].color}catch(h){console.log(h," - setting data.color for data.id: ",g.id)}Avatar.addImage(g,c.length,b)})},queueFrame:function(b,c,d,e,f){var g=Avatar._frames.length==0;Avatar._frames.push({id:b,animationName:c,frame:d,totalFrames:e,callback:f});if(g){if(window.IDE)IDE._ignoreUpdates=true;Avatar.dequeueFrame()}},dequeueFrame:function(){if(Avatar._frames.length>
0){var b=Avatar._frames[0];Avatar.generateFrame(b.id,b.animationName,b.frame,b.totalFrames,function(c){b.callback&&b.callback(c);Avatar._frames.shift();Avatar.dequeueFrame()})}else if(window.IDE){IDE._ignoreUpdates=false;Sprites._broadcastSpriteListeners("updateAll",IDE.editingActor?IDE.editingActor:Runtime.background)}},generateFrame:function(b,c,d,e,f){Avatar.loadCharacter(b,function(){Avatar.downloadAnimation(c,function(b){var c=parseInt(d*b.length/e);Avatar.setCanvasSize(400,400);Avatar.renderSingleFrame(c,
b);if(f){var j=new Image;j.onload=function(){f(j)};j.src=Avatar.canvas.toDataURL("image/png")}})})},changePartByGroup:function(b){var c=Avatar.partGroups[Avatar.selectedGroup],d;Avatar.builtCharacter.name=firstLetterToUpper(Avatar.selectedPreset);Avatar.builtCharacter.gender=Avatar.selectedGender;for(var e=0;e<c.length;e++){if(b.indexOf("custom")>-1)d="ide/avatar/parts/"+Avatar.selectedGender+"/extras/"+Avatar.selectedGroup+"/1_"+c[e]+"_"+b+".png";else if(b.indexOf("none")>-1)d="ide/avatar/parts/standard/none.png";
else if($.inArray(c[e],Avatar.partGroups.animationExpressions)>-1)if($.inArray(b,Avatar.exceptions.expressions[Avatar.selectedGender])>-1){d=c[e].lastIndexOf("_");d=c[e].substring(0,d);d="ide/avatar/parts/"+Avatar.selectedGender+"/"+b+"/1_"+d+".png"}else d="ide/avatar/parts/"+Avatar.selectedGender+"/expressions/1_"+c[e]+".png";else d="ide/avatar/parts/"+Avatar.selectedGender+"/"+b+"/1_"+c[e]+".png";$("#win-avatar iframe").contents().find("#"+c[e]).attr("xlink:href",d);Avatar.builtCharacter.parts[c[e]].baseImg=
d;Avatar.builtCharacter.parts[c[e]].part=b;Avatar.builtCharacter.parts[c[e]].color="none";Avatar.editCacheImg({href:d,id:c[e]})}},changeExpression:function(b){var c;firstLetterToUpper(Avatar.selectedGender);for(var d=["eyes","eyesClosed","mouth1"],e=0;e<d.length;e++){c="ide/avatar/parts/"+Avatar.selectedGender+"/expressions/1_"+d[e]+"_"+b+".png";$("#win-avatar iframe").contents().find("#"+d[e]).attr("xlink:href",c);Avatar.builtCharacter.parts[d[e]].baseImg=c;Avatar.builtCharacter.parts[d[e]].color=
"none";Avatar.editCacheImg({href:c,id:d[e]})}},changePartColorByGroup:function(b){for(var c=Avatar.colorGroups[Avatar.selectedColorGroup],d=0;d<c.length;d++){Avatar.applyTint(c[d],b,true,false);Avatar.builtCharacter.parts[c[d]].color=b}},makefromJson:function(){for(var b=$("#win-avatar iframe").contents().find("image"),c,d,e=0;e<b.length;e++){d=$(b[e]).attr("id");c=Avatar.builtCharacter.parts[d].baseImg.indexOf("ide/avatar/parts/")>-1?Avatar.builtCharacter.parts[d].baseImg:"ide/avatar/parts/"+Avatar.builtCharacter.gender+
"/"+Avatar.builtCharacter.parts[d].baseImg+"/1_"+d+".png";Avatar.editCacheImg({href:c,id:d});$(b[e]).attr("xlink:href",c);Avatar.builtCharacter.parts[d].color&&Avatar.builtCharacter.parts[d].color!="none"&&Avatar.applyTint(d,Avatar.builtCharacter.parts[d].color,true,false)}},generatePartList:function(){var b="Select "+firstLetterToUpper(Avatar.selectedGroup.replace(/(full|accesory)/,""));$("#win-avatar .sidebar .title").html(b);b=$("#win-avatar .sidebar .menu");b.empty();var c;c=Avatar.selectedGroup==
"presets"?"fullHead":Avatar.selectedGroup;for(var d=Avatar.exceptions[Avatar.selectedGroup]?true:false,e=false,f=Avatar.availableCharacters[Avatar.selectedGender],g=0;g<f.length;g++){e=d?$.inArray(f[g],Avatar.exceptions[Avatar.selectedGroup][Avatar.selectedGender])>-1:false;if(!e){var e="url(ide/avatar/parts/"+Avatar.selectedGender+"/"+f[g]+"/1_"+c+".png)",h=$("<div>");h.attr("id",f[g]).addClass("item pointer");h.append($("<div>").addClass("external-border"));h.find(".external-border").append($("<div>").addClass("part-img").css("background-image",
e));b.append(h)}}if(Avatar.customParts[Avatar.selectedGroup]){c=Avatar.customParts[Avatar.selectedGroup][Avatar.selectedGender];for(g=0;g<c.length;g++){e="url(ide/avatar/parts/"+Avatar.selectedGender+"/extras/"+Avatar.selectedGroup+"/1_"+c[g]+"Preview.png)";h=$("<div>");h.attr("id",c[g]).addClass("item pointer");h.append($("<div>").addClass("external-border"));h.find(".external-border").append($("<div>").addClass("part-img").css("background-image",e));b.append(h)}}g=$("<div>");g.attr("id","nonePart").addClass("item pointer");
g.append($("<div>").addClass("external-border"));g.find(".external-border").append($("<div>").addClass("part-img").css("background-image","url(ide/avatar/parts/standard/nonePreview.png)"));b.append(g);b.scrollTop(0)},generateExpressionList:function(){$("#win-avatar .sidebar .title").html("Expressions");var b=$("#win-avatar .sidebar .menu");b.empty();firstLetterToUpper(Avatar.selectedGender);for(var c=Avatar.expressions,d=0;d<c.length;d++){var e="url(ide/avatar/parts/"+Avatar.selectedGender+"/expressions/1_eyes_"+
c[d]+".png)",f=$("<div>");f.attr("id",c[d]).addClass("item pointer");f.append($("<div>").addClass("external-border"));f.find(".external-border").append($("<div>").addClass("part-img").css("background-image",e));b.append(f)}b.scrollTop(0)},generatePresetOptions:function(b,c){var d,e,f="right",g=Avatar.availableCharacters[Avatar.selectedCarousel],h=$("#win-avatar .carousel-content");h.empty();for(var j=0;j<g.length;j++){if(Avatar.selectedCarousel=="custom"){var k=Avatar.customCharacterList[j];j==0&&
Avatar.setSelectedGender(k.data.gender);if(!b||Avatar.customCharacterList[j].id==b){var l='style="background-image:url(/api/characterpreview?i='+k.id+"&r="+Math.random()+')"';d=!b&&j==0||k.id==b?" selected":"";e=" "+k.data.gender;d=$('<div id="'+k.id+'" class="preset-option pointer left server-loaded'+d+e+'" '+l+'><a href="#">X</a></div>');d.find("a").click(WinAvatar.removeCharacterEl)}}else{d=j==0?" selected":"";e=" "+Avatar.selectedGender+" "+g[j];k=g[j]+"Preset";d="preset-option pointer left"+
d+e;d=$("<div>").attr("id",k).addClass(d)}if(j==0||f=="right"){h.append(d);j!=0&&(f="left")}else{h.prepend(d);f="right"}}f=$("#win-avatar .preset-option").outerWidth(true);h.width(f*g.length+150);g=$("#win-avatar .preset-option.selected");g=-g.position().left+h.parent().width()/2-g.width()/2-43;h.css("left",g+"px");c&&c()},resetToPreset:function(){var b=Avatar.selectedGroup;Avatar.selectedGroup=Avatar.currentEdition=="body"?"presets":"fullHead";if(Avatar.selectedCarousel=="custom")Avatar.loadCharacter(Avatar.selectedPreset,
function(){Avatar.selectedGroup=b});else{Avatar.changePartByGroup(Avatar.selectedPreset);Avatar.selectedGroup=b}},changeCarousel:function(b){Avatar.setSelectedCarousel(b);b!="custom"&&Avatar.setSelectedGender(b);Avatar.builtCharacter.gender=b;if(b=="boy")Avatar.selectedPreset=Avatar.defaultBoyPreset;else if(b=="girl")Avatar.selectedPreset=Avatar.defaultGirlPreset;else if(b=="littleBoy")Avatar.selectedPreset=Avatar.defaultLittleBoyPreset;else if(b=="littleGirl")Avatar.selectedPreset=Avatar.defaultLittleGirlPreset;
else if(b=="custom"){if(Avatar.customCharacterList&&Avatar.customCharacterList.length>0){Avatar.selectedPreset=Avatar.defaultCustomPreset;Avatar.loadCharacter(Avatar.selectedPreset,function(){Avatar.selectedGroup="presets";Avatar.generatePresetOptions()},true)}return}Avatar.selectedGroup="presets";Avatar.changePartByGroup(Avatar.selectedPreset);Avatar.generatePresetOptions()},changePreset:function(b){Avatar.currentCharacterId=b;Avatar.selectedPreset=b;Avatar.selectedGroup="presets";Avatar.changePartByGroup(Avatar.selectedPreset)},
downloadAnimation:function(b,c){Avatar.animations[b]?c&&c(Avatar.animations[b]):$.ajax({url:"ide/avatar/animations/"+b+".json",type:"GET",dataType:"json",success:function(d){Avatar.animations[b]=d;c!=void 0&&c(Avatar.animations[b])},error:function(b,c,f){console.log("failure");console.log(b);console.log(c);console.log(f)}})},saveCharacter:function(b,c,d){Avatar.imgFromJson(Avatar.builtCharacter,function(e){Avatar.builtCharacter.name=c;$.ajax({url:"/api/charactersave",type:"POST",data:{i:b,d:JSON.stringify(Avatar.builtCharacter),
p:e},success:function(b){d&&d(b)}})})},loadCharacter:function(b,c,d){if(Avatar.currentCharacterId!=b||d!=null&&d){Avatar.currentCharacterId=b;var d=false,e=Avatar.availableCharacters.boy.indexOf(b);if(e>=0){Avatar.changeCarousel("boy");Avatar.changePreset(b);c&&Avatar.SVGToCanvas(c);d=true}if(!d){e=Avatar.availableCharacters.girl.indexOf(b);if(e>=0){Avatar.changeCarousel("girl");Avatar.changePreset(b);c&&Avatar.SVGToCanvas(c);d=true}}if(!d){e=Avatar.availableCharacters.littleBoy.indexOf(b);if(e>=
0){Avatar.changeCarousel("littleBoy");Avatar.changePreset(b);c&&Avatar.SVGToCanvas(c);d=true}}if(!d){e=Avatar.availableCharacters.littleGirl.indexOf(b);if(e>=0){Avatar.changeCarousel("littleGirl");Avatar.changePreset(b);c&&Avatar.SVGToCanvas(c);d=true}}d||$.ajax({url:"/api/character",type:"POST",data:{i:b},success:function(d){if(d){Avatar.builtCharacter=JSON.parse(d);Avatar.currentCharacterId=b;Avatar.selectedPreset=Avatar.builtCharacter.name;Avatar.selectedGroup="presets";Avatar.setSelectedGender(Avatar.builtCharacter.gender);
if(Avatar.builtCharacter.parts){if(!Avatar.builtCharacter.parts.propEyes){d=Avatar.builtCharacter;Avatar.builtCharacter={name:d.name,gender:d.gender,parts:{chest:{baseImg:d.parts.chest.baseImg,color:"none"},cape:{baseImg:d.parts.cape.baseImg,color:"none"},neck:{baseImg:d.parts.neck.baseImg,color:"none"},head:{baseImg:d.parts.head.baseImg,color:"none"},nose:{baseImg:d.parts.nose.baseImg,color:"none"},beard:{baseImg:d.parts.head.baseImg,color:"none"},hat:{baseImg:d.parts.head.baseImg,color:"none"},
mouth1:{baseImg:d.parts.mouth1.baseImg,color:"none"},mouth2:{baseImg:d.parts.mouth2.baseImg,color:"none"},mouthClosed:{baseImg:d.parts.mouthClosed.baseImg,color:"none"},mouthSmall:{baseImg:d.parts.mouthSmall.baseImg,color:"none"},mouthteeth:{baseImg:d.parts.mouthteeth.baseImg,color:"none"},hair1:{baseImg:d.parts.hair1.baseImg,color:"none"},hair2:{baseImg:d.parts.hair2.baseImg,color:"none"},head_hair:{baseImg:d.parts.head_hair.baseImg,color:"none"},ear:{baseImg:d.parts.ear.baseImg,color:"none"},cover:{baseImg:d.parts.cover.baseImg,
color:"none"},eyes:{baseImg:d.parts.eyebrowL.baseImg,color:"none"},eyesClosed:{baseImg:d.parts.eyebrowL.baseImg,color:"none"},propEyes:{baseImg:"ide/avatar/parts/standard/none.png",color:"none"},mouth1_crying:{baseImg:"ide/avatar/parts/"+d.gender+"/expressions/1_mouth1_crying.png",color:"none"},mouth1_angry:{baseImg:"ide/avatar/parts/"+d.gender+"/expressions/1_mouth1_angry.png",color:"none"},eyes_crying:{baseImg:"ide/avatar/parts/"+d.gender+"/expressions/1_eyes_crying.png",color:"none"},eyes_angry:{baseImg:"ide/avatar/parts/"+
d.gender+"/expressions/1_eyes_angry.png",color:"none"},armL:{baseImg:d.parts.armL.baseImg,color:"none"},armL1:{baseImg:d.parts.armL1.baseImg,color:"none"},handL:{baseImg:d.parts.handL.baseImg,color:"none"},handL1:{baseImg:d.parts.handL1.baseImg,color:"none"},forearmL:{baseImg:d.parts.forearmL.baseImg,color:"none"},forearmL1:{baseImg:d.parts.forearmL1.baseImg,color:"none"},armR:{baseImg:d.parts.armR.baseImg,color:"none"},handR:{baseImg:d.parts.handR.baseImg,color:"none"},forearmR:{baseImg:d.parts.forearmR.baseImg,
color:"none"},hip:{baseImg:d.parts.hip.baseImg,color:"none"},thighR:{baseImg:d.parts.thighR.baseImg,color:"none"},legR:{baseImg:d.parts.legR.baseImg,color:"none"},footR:{baseImg:d.parts.footR.baseImg,color:"none"},thighL:{baseImg:d.parts.thighL.baseImg,color:"none"},legL:{baseImg:d.parts.legL.baseImg,color:"none"},footL:{baseImg:d.parts.footL.baseImg,color:"none"},footR2:{baseImg:d.parts.footR2.baseImg,color:"none"},handFistR:{baseImg:d.parts.handFistR.baseImg,color:"none"},handFistL:{baseImg:d.parts.handFistL.baseImg,
color:"none"},weapon:{baseImg:d.parts.weapon.baseImg,color:"none"}}}}}else{d=Avatar.builtCharacter;Avatar.builtCharacter={name:d.name,gender:d.gender,parts:{chest:{baseImg:d.chest,color:"none"},cape:{baseImg:d.cape,color:"none"},neck:{baseImg:d.neck,color:"none"},head:{baseImg:d.head,color:"none"},nose:{baseImg:d.nose,color:"none"},beard:{baseImg:d.head,color:"none"},hat:{baseImg:d.head,color:"none"},mouth1:{baseImg:d.mouth1,color:"none"},mouth2:{baseImg:d.mouth2,color:"none"},mouthClosed:{baseImg:d.mouthClosed,
color:"none"},mouthSmall:{baseImg:d.mouthSmall,color:"none"},mouthteeth:{baseImg:d.mouthteeth,color:"none"},hair1:{baseImg:d.hair1,color:"none"},hair2:{baseImg:d.hair2,color:"none"},head_hair:{baseImg:d.head_hair,color:"none"},ear:{baseImg:d.ear,color:"none"},cover:{baseImg:d.cover,color:"none"},eyes:{baseImg:d.eyebrowL,color:"none"},eyesClosed:{baseImg:d.eyebrowL,color:"none"},propEyes:{baseImg:"ide/avatar/parts/standard/none.png",color:"none"},mouth1_crying:{baseImg:"ide/avatar/parts/"+d.gender+
"/expressions/1_mouth1_crying.png",color:"none"},mouth1_angry:{baseImg:"ide/avatar/parts/"+d.gender+"/expressions/1_mouth1_angry.png",color:"none"},eyes_crying:{baseImg:"ide/avatar/parts/"+d.gender+"/expressions/1_eyes_crying.png",color:"none"},eyes_angry:{baseImg:"ide/avatar/parts/"+d.gender+"/expressions/1_eyes_angry.png",color:"none"},armL:{baseImg:d.armL,color:"none"},armL1:{baseImg:d.armL1,color:"none"},handL:{baseImg:d.handL,color:"none"},handL1:{baseImg:d.handL1,color:"none"},forearmL:{baseImg:d.forearmL,
color:"none"},forearmL1:{baseImg:d.forearmL1,color:"none"},armR:{baseImg:d.armR,color:"none"},handR:{baseImg:d.handR,color:"none"},forearmR:{baseImg:d.forearmR,color:"none"},hip:{baseImg:d.hip,color:"none"},thighR:{baseImg:d.thighR,color:"none"},legR:{baseImg:d.legR,color:"none"},footR:{baseImg:d.footR,color:"none"},thighL:{baseImg:d.thighL,color:"none"},legL:{baseImg:d.legL,color:"none"},footL:{baseImg:d.footL,color:"none"},footR2:{baseImg:d.footR2,color:"none"},handFistR:{baseImg:d.handFistR,color:"none"},
handFistL:{baseImg:d.handFistL,color:"none"},weapon:{baseImg:d.weapon,color:"none"}}}}Avatar.makefromJson();c&&Avatar.SVGToCanvas(c)}}})}else c&&c()},removeCharacter:function(b,c){$.ajax({url:"/api/characterremove",data:{i:b},success:function(){var d=Avatar.availableCharacters.custom.indexOf(b);d>-1&&Avatar.availableCharacters.custom.splice(d,1);for(var d=-1,e=0;e<Avatar.customCharacterList.length;e++)if(Avatar.customCharacterList[e].id==b){d=e;break}d>-1&&Avatar.customCharacterList.splice(d,1);Avatar.setNumUserCharacters(Avatar.customCharacterList.length);
c(null)},error:function(b,e,f){c(f)}})},loadCustomCharacters:function(b){$.ajax({url:"/api/characterlist",success:function(c){Avatar.customCharacterList=JSON.parse(c);Avatar.setNumUserCharacters(Avatar.customCharacterList.length);Avatar.availableCharacters.custom=[];for(c=0;c<Avatar.customCharacterList.length;c++)Avatar.availableCharacters.custom.push(Avatar.customCharacterList[c].id);Avatar.defaultCustomPreset=Avatar.customCharacterList.length>0?Avatar.customCharacterList[0].id:null;b&&b()},error:function(){b&&
b()}})},getAlphaURL:function(b,c){return b=="propEyes"?c.replace("1_","alpha_prop_"):Avatar.colorGroups.skin.indexOf(b)>-1?c.replace(/1_(.*)/,"alpha_skin_"+b+".png"):c.replace(/1_(.*)/,"alpha_prop_"+b+".png")},getCharacterGender:function(b){if(Avatar.selectedCarousel!="custom")return Avatar.selectedGender;for(var c=0;c<Avatar.customCharacterList.length;c++){var d=Avatar.customCharacterList[c];if(d.id==b)return d.data.gender}}};
Script.prototype.registerTrigger=function(){if(this.scriptId){for(var b=false,c=0;c<Runtime.externalTriggers.length;c++)if(Runtime.externalTriggers[c]==this){b=true;break}b||Runtime.externalTriggers.push(this)}else{this.scriptId=Runtime.getScriptId();this.scriptBlock.scriptid=this.scriptId;Runtime.externalTriggers.push(this)}return false};
Script.prototype.registerFlagTrigger=function(){if(this.scriptId){for(var b=false,c=0;c<Runtime.flagTriggers.length;c++)if(Runtime.flagTriggers[c]==this){b=true;break}b||Runtime.flagTriggers.push(this)}else{this.scriptId=Runtime.getScriptId();this.scriptBlock.scriptid=this.scriptId;Runtime.flagTriggers.push(this)}return false};
Script.prototype.registerKeyTrigger=function(){if(this.scriptId){for(var b=false,c=0;c<Runtime.keyTriggers.length;c++)if(Runtime.keyTriggers[c]==this){b=true;break}b||Runtime.keyTriggers.push(this)}else{this.scriptId=Runtime.getScriptId();this.scriptBlock.scriptid=this.scriptId;Runtime.keyTriggers.push(this)}return false};
Script.prototype.registerSpriteTrigger=function(){if(this.scriptId){for(var b=false,c=0;c<Runtime.spriteTriggers.length;c++)if(Runtime.spriteTriggers[c]==this){b=true;break}b||Runtime.spriteTriggers.push(this)}else{this.scriptId=Runtime.getScriptId();this.scriptBlock.scriptid=this.scriptId;Runtime.spriteTriggers.push(this)}return false};
Script.prototype.registerBackgroundChange=function(){if(this.scriptId){for(var b=false,c=0;c<Runtime.sceneChanges.length;c++)if(Runtime.sceneChanges[c]==this){b=true;break}b||Runtime.sceneChanges.push(this)}else{this.scriptId=Runtime.getScriptId();this.scriptBlock.scriptid=this.scriptId;Runtime.sceneChanges.push(this)}return false};
Script.prototype.registerExternalTrigger=function(){if(this.scriptId){for(var b=false,c=0;c<Runtime.externalTriggers.length;c++)if(Runtime.externalTriggers[c]==this){b=true;break}b||Runtime.externalTriggers.push(this)}else{this.scriptId=Runtime.getScriptId();this.scriptBlock.scriptid=this.scriptId;Runtime.externalTriggers.push(this)}return false};Script.prototype.registerFunction=function(){return false};Script.prototype.registerCloned=function(){return false};
Script.prototype.registerBroadcastTrigger=function(){if(this.scriptId){for(var b=false,c=0;c<Runtime.broadcastTriggers.length;c++)if(Runtime.broadcastTriggers[c]==this){b=true;break}b||Runtime.broadcastTriggers.push(this)}else{this.scriptId=Runtime.getScriptId();this.scriptBlock.scriptid=this.scriptId;Runtime.broadcastTriggers.push(this)}return false};
Script.prototype.blockControlCall=function(b){var c=this.sprite,d=this.currentBlock.name,e=this._findFunction(c.scripts,d);if(e){for(var d=[],f=0;f<b.length;f++)b[f]instanceof LabelInput&&d.push(this.evaluateExpression(b[f]));return this._blockControlCall(c,e,d)}e=this.currentBlock.getRoot();if(e.library)if(e=this._findFunction(e.library.scripts,d)){d=[];for(f=0;f<b.length;f++)b[f]instanceof LabelInput&&d.push(this.evaluateExpression(b[f]));return this._blockControlCall(c,e,d)}return false};
Script.prototype.blockControlCallLibrary=function(b){var c=this.currentBlock.name.split("::"),d=c[1],c=c[0],e=Runtime.getLibraryByName(c);if(e){for(var c=[],f=0;f<b.length;f++)b[f]instanceof LabelInput&&c.push(this.evaluateExpression(b[f]));if(b=this._findFunction(e.scripts,d))return this._blockControlCall(this.sprite,b,c)}return false};
Script.prototype.blockControlCallMember=function(b){var c=this.evaluateExpression(b.shift()),d=this.evaluateExpression(b.shift());if(c=="self")c=this.sprite;else{c=Sprites.getSpriteByName(c);if(!c)c=Runtime.background}if(c){for(var e=[],f=0;f<b.length;f++)b[f]instanceof LabelInput&&e.push(this.evaluateExpression(b[f]));if(b=this._findFunction(c.scripts,d))return this._blockControlCall(c,b,e)}return false};
Script.prototype._findFunction=function(b,c){for(var d=0;d<b.length;d++)if(b[d].func=="registerFunction"&&b[d].name==c)return b[d];return null};
Script.prototype._blockControlCall=function(b,c,d){this.yield();if(window.WinCode&&!Runtime.hideRunOutline){c.setOutline(true);WinCode.draw()}this.pushState(this.currentBlock.next,c,Script.TYPE_FUNC,false);if(b)this.sprite=b;this.scriptVars={};this.fnArgs={};for(var b=0,e=c.label._children,f=0;f<e.length;f++)if(e[f]instanceof LabelInput){this.fnArgs[e[f].defaultLabel]=d[b];b++}this.currentBlock=c};
Script.prototype.valueControlCall=function(b){var c=this.sprite,d=this.currentBlock,e="",f=this._findFunction(c.scripts,this.currentBlock.name);if(f){for(var e=[],g=0;g<b.length;g++)e.push(this.evaluateExpression(b[g]));e=this._valueControlCall(c,f,e)}this.currentBlock=d;return e};
Script.prototype.valueControlCallLibrary=function(b){var c=this.currentBlock.name.split("::"),d=c[1],c=c[0],e=this.currentBlock,f="",g=Runtime.getLibraryByName(c);if(g){for(var c=[],h=0;h<b.length;h++)b[h]instanceof LabelInput&&c.push(this.evaluateExpression(b[h]));(b=this._findFunction(g.scripts,d))&&(f=this._valueControlCall(this.sprite,b,c))}this.currentBlock=e;return f};
Script.prototype.valueControlCallMember=function(b){var c=this.evaluateExpression(b.shift()),d=this.evaluateExpression(b.shift());if(c=="self")c=this.sprite;else{c=Sprites.getSpriteByName(c);if(!c)c=Runtime.background}var e="";if(d=this._findFunction(c.scripts,d)){for(var f=this.currentBlock,e=[],g=0;g<b.length;g++)e.push(this.evaluateExpression(b[g]));e=this._valueControlCall(c,d,e);this.currentBlock=f}else this.error=true;return e};Script.prototype._valueControlReturn=function(){return false};
Script.prototype._valueControlCall=function(b,c,d){var e=Date.now()+1E3;this.returnValue="";var f=this.doYield,g=this.isDirty;if(window.WinCode&&!Runtime.hideRunOutline){c.setOutline(true);WinCode.draw()}this.pushState(new Block({func:"_valueControlReturn"}),c,Script.TYPE_FUNC,false);this.sprite=b;this.scriptVars={};this.fnArgs={};for(var b=0,h=c.label._children,j=0;j<h.length;j++)if(h[j]instanceof LabelInput){this.fnArgs[h[j].defaultLabel]=d[b];b++}this.currentBlock=c;for(this.doYield=false;this.running&&
Date.now()<e;)for(c=100;this.running&&--c>=0;)if(this.currentBlock&&this.currentBlock.func!="_valueControlReturn")this.invokeStep();else{this.currentBlock=null;this.running=false;this.receivedValue=void 0;break}delete this.error;this.running=true;this.doYield=f;this.isDirty=g;e=this.returnValue;this.returnValue="";return e};
Script.prototype.blockControlReturn=function(b){window.WinCode&&!Runtime.hideRunOutline&&this.currentBlock.getRoot().setOutline(false);this.currentBlock=null;for(var b=this.evaluateExpression(b[0]),c=this.peekState();c&&c.containerType!=Script.TYPE_FUNC;)c=this.popState();if(c&&c.containerType==Script.TYPE_FUNC&&c.data){window.WinCode&&!Runtime.hideRunOutline&&c.data.setOutline(false);this.data=null}this.returnValue=b;this.yield();return true};
Script.prototype.valueParam=function(){return this.fnArgs?this.fnArgs[this.blockName]:""};Script.prototype.blockControlScriptVar=function(){var b=this.currentBlock.label.getNumSockets();if(!this.scriptVars)this.scriptVars={};for(var c=0;c<b;c++){var d=this.currentBlock.label.getSocketAtChild(c);this.scriptVars[d._child?d._child.name:d.label]=""}};Script.prototype.valueScriptVar=function(){return this.scriptVars?this.scriptVars[this.blockName]:""};
Script.prototype.blockControlWait=function(b){this.yield();if(this.data==null){b=parseFloat(this.evaluateExpression(b[0]));if(b<=0)return false;this.data=Date.now()+b*1E3}else if(Date.now()>this.data)return false;return this.skipArgCompute=true};Script.prototype.blockControlForever=function(){var b=this.currentBlock.getBlockAtContainer(0);if(b==null)this.yield();else{this.pushState(this.currentBlock,null,Script.TYPE_LOOP,false);this.currentBlock=b}this.skipArgCompute=false;return true};
Script.prototype.blockControlRepeat=function(b){if(this.data==null)this.data=this.evaluateExpression(b[0]);if(this.data>0){this.data--;this.pushState(this.currentBlock,this.data,Script.TYPE_LOOP,true);this.currentBlock=this.currentBlock.getBlockAtContainer(0);this.currentBlock==null&&this.yield();this.data=null;this.skipArgCompute=false;return true}this.yield();return false};
Script.prototype.blockControlBroadcast=function(b){b=this.evaluateExpression(b[0]);Runtime._broadcastRuntimeListeners("broadcast",b);for(var c=0;c<Runtime.broadcastTriggers.length;c++){var d=Runtime.broadcastTriggers[c].scriptBlock.label.getSocketAtChild(0);if(d!=null&&d.label==b){d=Runtime.broadcastTriggers[c];d.receivedValue="";d.messageSource=this.sprite.label;Runtime.scheduleToRun(d)}}return false};
Script.prototype.blockControlBroadcastWait=function(b){this.yield();if(this.data==null){var c=this.evaluateExpression(b[0]);this.data=c;Runtime._broadcastRuntimeListeners("broadcastWait",c);for(b=0;b<Runtime.broadcastTriggers.length;b++){var d=Runtime.broadcastTriggers[b].scriptBlock.label.getSocketAtChild(0);if(d!=null&&d.label==c&&!Runtime.broadcastTriggers[b].running){var e=Runtime.broadcastTriggers[b];e.receivedValue="";e.messageSource=this.sprite.label;Runtime.scheduleToRun(e)}}return this.skipArgCompute=
true}c=false;for(b=0;b<Runtime.runningScripts.length;b++){e=Runtime.runningScripts[b];if(e.scriptBlock.func=="registerBroadcastTrigger"){d=e.scriptBlock.label.getSocketAtChild(0);if(d!=null&&d.label==this.data&&e.running){c=true;break}}}if(c)return this.skipArgCompute=true;return false};
Script.prototype.blockControlPostMessage=function(b){var c=this.evaluateExpression(b[0]),d=this.evaluateExpression(b[1]),e=this.evaluateExpression(b[2]);if(d=="TynkerRuntime"){if(!window.WinCode){if(c=="loadProject"){if(c=/[0-9a-fA-F]+$/.exec(e)){window.location="ide/embedded?p="+c[0];Runtime.stopScripts()}return false}if(c=="visitUrl"){window.parent?window.parent.location=e:window.location=e;return false}}if(c=="turboMode"){Runtime.turboMode=e===true||e=="true"||e=="on"?true:false;return false}if(c==
"aabbCollision"){Runtime.aabbCollision=e===true||e=="true"||e=="on"?true:false;return false}if(c=="physicsDebug")e===true||e=="true"||e=="on"?Physics.setDebug(true):Physics.setDebug(false);else if(c=="hideRunIndicator")Runtime.hideRunOutline=e===true||e=="true"||e=="on"?true:false;else if(c=="runIndicatorTimeout")Runtime.runPauseTimeout=parseInt(e);else if(c=="staticPlacement")this.sprite.spriteObj.isStatic=e===true||e=="true"||e=="on"?true:false;else if(c=="penLayerStaticPlacement")Runtime.stage.penLayer.isStatic=
e===true||e=="true"||e=="on"?true:false;else if(c=="replaceCostume")if(this.sprite.costumes.length>0){var f=this.sprite,b=new Image;b.onload=function(){var b=f.currentCostume,c=f.costumes[b-1];c.img=e;c.imgObj=this;c.cx=this.width/2;c.cy=this.height/2;f.currentCostume=-1;f.setCostumeByName(b)};b.src=e}else{this.sprite.addCostume({name:"loadimage",img:e});this.sprite.setCostumeByName(this.sprite.costumes.length)}else if(c=="playSound"){soundManager.globalSound&&soundManager.globalSound.stop();soundManager.globalSound=
soundManager.createSound({url:e,autoPlay:false});soundManager.globalSound.play({onfinish:function(){soundManager.globalSound.unload()},onstop:function(){soundManager.globalSound.unload()}})}}Runtime._broadcastRuntimeListeners("post",c,e);for(b=0;b<Runtime.broadcastTriggers.length;b++){var g=Runtime.broadcastTriggers[b],h=g.scriptBlock.label.getSocketAtChild(0);if(h!=null&&h.label==c&&(d=="any"||g.sprite.label==d||d=="self"&&g.sprite==this.sprite||d=="stage"&&g.sprite==Runtime.background)){g.receivedValue=
e;g.messageSource=this.sprite.label;Runtime.scheduleToRun(g)}}return false};
Script.prototype.blockControlPostMessageAndWait=function(b){this.yield();if(this.data==null){var c=this.evaluateExpression(b[0]),d=this.evaluateExpression(b[1]),e=this.evaluateExpression(b[2]);this.data={eventName:c,spriteName:d,msgValue:e};if(d=="TynkerRuntime"){if(!window.WinCode){if(c=="loadProject"){if(c=/[0-9a-fA-F]+$/.exec(e)){window.location="ide/embedded?p="+c[0];Runtime.stopScripts()}return false}if(c=="visitUrl"){window.parent?window.parent.location=e:window.location=e;return false}}if(c==
"turboMode"){Runtime.turboMode=e===true||e=="true"||e=="on"?true:false;return false}if(c=="aabbCollision"){Runtime.aabbCollision=e===true||e=="true"||e=="on"?true:false;return false}if(c=="physicsDebug")e===true||e=="true"||e=="on"?Physics.setDebug(true):Physics.setDebug(false);else if(c=="hideRunIndicator")Runtime.hideRunOutline=e===true||e=="true"||e=="on"?true:false;else if(c=="runIndicatorTimeout")Runtime.runPauseTimeout=parseInt(e);else if(c=="staticPlacement")this.sprite.spriteObj.isStatic=
e===true||e=="true"||e=="on"?true:false;else if(c=="replaceCostume"){if(this.sprite.costumes.length>0){var f=this.sprite,g=this.data;g.checkFlag=true;g.flag=false;c=new Image;c.onload=function(){var b=f.currentCostume,c=f.costumes[b-1];c.img=e;c.imgObj=this;c.cx=this.width/2;c.cy=this.height/2;f.currentCostume=-1;f.setCostumeByName(b);g.flag=true};c.src=e}else{g=this.data;g.checkFlag=true;g.flag=false;this.sprite.addCostume({name:"loadimage",img:e},function(){g.flag=true});this.sprite.setCostumeByName(this.sprite.costumes.length)}return this.skipArgCompute=
true}}Runtime._broadcastRuntimeListeners("postWait",c,e);for(b=0;b<Runtime.broadcastTriggers.length;b++){var h=Runtime.broadcastTriggers[b],j=h.scriptBlock.label.getSocketAtChild(0);if(j!=null&&j.label==c&&(d=="any"||h.sprite.label==d||d=="self"&&h.sprite==this.sprite||d=="stage"&&h.sprite==Runtime.background)&&!Runtime.broadcastTriggers[b].running){h.receivedValue=e;h.messageSource=this.sprite.label;Runtime.scheduleToRun(h)}}return this.skipArgCompute=true}c=false;if(this.data.checkFlag)this.data.flag||
(c=true);else for(b=0;b<Runtime.runningScripts.length;b++){h=Runtime.runningScripts[b];if(h.scriptBlock.func=="registerBroadcastTrigger"){j=h.scriptBlock.label.getSocketAtChild(0);if(j!=null&&(j.label==this.data.eventName&&(this.data.spriteName=="any"||h.sprite.label==this.data.spriteName||this.data.spriteName=="self"&&h.sprite==this.sprite||this.data.spriteName=="stage"&&h.sprite==Runtime.background))&&h.running){c=true;break}}}if(c)return this.skipArgCompute=true;return false};
Script.prototype.valueControlMessageValue=function(){return this.receivedValue?this.receivedValue:""};Script.prototype.valueControlMessageSource=function(){return this.messageSource?this.messageSource:""};
Script.prototype.blockControlCloneActor=function(b){var b=this.evaluateExpression(b[0]),c;if(b=="any"||b=="stage")c=null;else if(b=="self"){c=this.sprite.copyActor(function(b){for(var c=0;c<b.scripts.length;c++){var f=b.scripts[c];if(f.func=="registerCloned"){f=new Script({sprite:b,scriptBlock:f});f.currentBlock=f.scriptBlock;f.invokeStep();Runtime.scheduleToRun(f)}}});c.instantiated=true;c.instantiatedFrom=this.sprite.instantiated?this.sprite.instantiatedFrom:this.sprite.label}else if(b=Sprites.getSpriteByName(b)){c=
b.copyActor(function(b){for(var c=0;c<b.scripts.length;c++){var f=b.scripts[c];if(f.func=="registerCloned"){f=new Script({sprite:b,scriptBlock:f});f.currentBlock=f.scriptBlock;f.invokeStep();Runtime.scheduleToRun(f)}}});c.instantiated=true;c.instantiatedFrom=b.instantiated?b.instantiatedFrom:b.label}this.lastClonedActor=c;return false};
Script.prototype.valueControlCloneName=function(b){for(var b=this.evaluateExpression(b[0]),c=0;c<Runtime.sprites.length;c++){var d=Runtime.sprites[c];if(d.label==b)return d.instantiated?d.instantiatedFrom:d.label}return""};
Script.prototype.blockControlDeleteActor=function(){if(this.sprite.instantiated){this.sprite.deleteActor();for(var b=0;b<Runtime.runningScripts.length;b++){var c=Runtime.runningScripts[b];if(c.sprite==this.sprite){c.running=false;c.currentBlock=null;c.stack=[]}}}this.currentBlock=null;this.stack=[];return true};Script.prototype.valueControlLastClonedActor=function(){return this.lastClonedActor?this.lastClonedActor.label:""};
Script.prototype.valueControlIsClone=function(){return this.sprite.instantiated?true:false};Script.prototype.blockControlForeverIf=function(b){var c=this.currentBlock.getBlockAtContainer(0);if(this.evaluateExpression(b[0])&&c!=null){this.pushState(this.currentBlock,null,Script.TYPE_CONTAINER,false);this.currentBlock=c}this.yield();return true};
Script.prototype.blockControlIf=function(b){if(this.evaluateExpression(b[0])){b=this.currentBlock.getBlockAtContainer(0);if(b!=null){this.pushState(this.currentBlock.next,null,Script.TYPE_CONTAINER,false);this.skipArgCompute=false;this.currentBlock=b;return true}}return false};Script.prototype.valueControlIfElse=function(b){return this.evaluateExpression(b[0])?this.evaluateExpression(b[1]):this.evaluateExpression(b[2])};
Script.prototype.blockControlIfElse=function(b){if(this.evaluateExpression(b[0]))b=this.currentBlock.getBlockAtContainer(0);else{for(var b=this.currentBlock._containerLabels,c=0;c<b.length;c++)if(b[c].getNumSockets()>0&&this.evaluateExpression(b[c].getSocketAtChild(0))){b=this.currentBlock.getBlockAtContainer(c+1);if(b!=null){this.pushState(this.currentBlock.next,null,Script.TYPE_CONTAINER,false);this.skipArgCompute=false;this.currentBlock=b;return true}return false}b=this.currentBlock.getBlockAtContainer(this.currentBlock.getNumContainers()-
1)}if(b!=null){this.pushState(this.currentBlock.next,null,Script.TYPE_CONTAINER,false);this.skipArgCompute=false;this.currentBlock=b;return true}return false};Script.prototype.blockControlWaitUntil=function(b){this.yield();if(!this.evaluateExpression(b[0])){this.skipArgCompute=false;return true}return false};
Script.prototype.blockControlWhile=function(b){if(this.evaluateExpression(b[0])){b=this.currentBlock.getBlockAtContainer(0);if(b!=null){this.pushState(this.currentBlock,null,Script.TYPE_LOOP,false);this.currentBlock=b}else this.yield();this.skipArgCompute=false;return true}this.yield();return false};
Script.prototype.blockControlRepeatUntil=function(b){if(!this.evaluateExpression(b[0])){b=this.currentBlock.getBlockAtContainer(0);if(b!=null){this.pushState(this.currentBlock,null,Script.TYPE_LOOP,false);this.currentBlock=b}else this.yield();this.skipArgCompute=false;return true}this.yield();return false};
Script.prototype.blockControlStop=function(b){b=this.evaluateExpression(b[0]);if(b=="all")Runtime.stopScripts();else if(b=="this script"){this.currentBlock=null;for(b=this.peekState();b&&b.containerType!=Script.TYPE_FUNC;)b=this.popState();if(b&&b.containerType==Script.TYPE_FUNC&&b.data){window.WinCode&&!Runtime.hideRunOutline&&b.data.setOutline(false);this.data=null;this.yield();return true}}else if(b=="other scripts in actor")Runtime.stopScripts(this.sprite,this);else if(b=="function call chain"){this.currentBlock=
null;do if((b=this.popState())&&b.containerType==Script.TYPE_FUNC&&b.data){window.WinCode&&!Runtime.hideRunOutline&&b.data.setOutline(false);this.data=null}while(b)}return false};Script.prototype.blockControlStopScript=function(){this.currentBlock=null;return true};Script.prototype.blockControlStopAll=function(){this.currentBlock=null;Runtime.stopScripts();return true};
Script.prototype.blockControlFor=function(b){if(this.data==null){var c="",d=b[0];if(d&&d._child){d=d._child;if(d.func=="valueVar"||d.func=="valueParam"||d.func=="valueScriptVar"||d.func=="valueList")c=d.name}c||(c=this.evaluateExpression(b[0]));this.data={name:c,start:this.evaluateExpression(b[1]),end:this.evaluateExpression(b[2]),incr:this.evaluateExpression(b[3])};if(this.data.incr>0&&this.data.start>this.data.end||this.data.incr<0&&this.data.start<this.data.end||this.data.incr===0){this.yield();
return false}this._setVariable(this.data.name,this.data.start-this.data.incr)}b=this._getVariable(this.data.name)+this.data.incr;this._setVariable(this.data.name,b);if(this.data.incr<0&&b>=this.data.end||this.data.incr>0&&b<=this.data.end){this.pushState(this.currentBlock,this.data,Script.TYPE_LOOP,true);this.currentBlock=this.currentBlock.getBlockAtContainer(0);this.currentBlock==null&&this.yield();this.data=null;this.skipArgCompute=false;return true}this.yield();return false};
Script.prototype.blockControlForEach=function(b){if(this.data==null){var c="",d=b[1];if(d&&d._child){d=d._child;if(d.func=="valueVar"||d.func=="valueParam"||d.func=="valueScriptVar"||d.func=="valueList")c=d.name}c||(c=this.evaluateExpression(b[1]));this.data={values:this.evaluateExpression(b[0]),index:0,name:c};this._setVariable(this.data.name,null)}if(this.data.index<this.data.values.length){this._setVariable(this.data.name,this.data.values[this.data.index]);this.data.index++;this.pushState(this.currentBlock,
this.data,Script.TYPE_LOOP,true);this.currentBlock=this.currentBlock.getBlockAtContainer(0);this.currentBlock==null&&this.yield();this.data=null;this.skipArgCompute=false;return true}this.yield();return false};
Script.prototype.blockControlBreak=function(){this.currentBlock=null;for(var b=this.peekState();b&&b.containerType!=Script.TYPE_LOOP;){this.popState();if((b=this.peekState())&&b.containerType==Script.TYPE_FUNC&&b.data){window.WinCode&&!Runtime.hideRunOutline&&b.data.setOutline(false);this.data=null}}if(b&&b.containerType==Script.TYPE_LOOP){b=this.popState();this.currentBlock=b.nextBlock.next;this.data=null;this.skipArgCompute=false}this.yield();return true};
Script.prototype.blockControlContinue=function(){for(var b=this.peekState();b&&b.containerType!=Script.TYPE_LOOP;){this.popState();if((b=this.peekState())&&b.containerType==Script.TYPE_FUNC&&b.data){window.WinCode&&!Runtime.hideRunOutline&&b.data.setOutline(false);this.data=null}}this.currentBlock=null;this.yield();return true};
Script.prototype.blockControlRequestBlocking=function(){if(this.data==null){this.requestBlock(true);this.data=true;var b=this.currentBlock.getBlockAtContainer(0);if(b!=null){this.pushState(this.currentBlock,this.data,Script.TYPE_CONTAINER,false);this.data=null;this.skipArgCompute=false;this.currentBlock=b;return true}}this.requestBlock(false);return false};
Script.prototype.blockControlPrint=function(b){for(var c="",d=0;d<b.length;d++){var e=this.evaluateExpression(b[d]);if(typeof e=="object"){if(c){console.log(c);c=""}console.log(e)}else c=c+(""+e)}c&&console.log(c);return false};Script.prototype.valueControlLanguage=function(b){for(var c=0;c<b.length;c++)b[c]=this.evaluateExpression(b[c]);return g_loc.formatText.apply(this,b)};
Script.prototype.valueControlLanguageWithDefault=function(b){for(var c=0;c<b.length;c++)b[c]=this.evaluateExpression(b[c]);return g_loc.formatTextDefault.apply(this,b)};Script.prototype.blockComment=function(){return false};Script.prototype.blockInlineComment=function(){return false};Script.prototype.nop=function(){this.yield();return true};Script.prototype.blockControlDebugBreak=function(){if(window.IDE){Runtime.pauseScripts();IDE.selectAsset(this.sprite);WinTools.showDebugger()}};
Script.prototype.blockControlDebugBreakOn=function(b){if(this.evaluateExpression(b[0])&&window.IDE){Runtime.pauseScripts();IDE.selectAsset(this.sprite);WinTools.showDebugger()}};Script.prototype.valueControlSerializeActor=function(b){b=this.evaluateExpression(b[0]);if(b=b=="self"||b=="any"?this.sprite:Sprites.getSpriteByName(b)){b=ObjectIO.serializeSprite(b,true);return b=JSON.stringify(b)}return""};
Script.prototype.blockControlDeserializeActor=function(b){this.yield();var c=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);if(this.data===null){var d=this;d.data=false;typeof c=="string"&&(c=JSON.parse(c));if(b)c.label=b;ObjectIO.deserializeSprite(c,function(b){d.data=true;d.lastClonedActor=b})}else if(this.data===true)return false;return this.skipArgCompute=true};
Script.prototype.blockControlRemoveActor=function(b){(b=this.evaluateExpression(b[0]))&&(b!="any"&&b!="self"&&b!=this.sprite.label)&&Sprites.removeSprite(b)};
Script.prototype.valueControlSerializeScripts=function(b){var c=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);if(c=c=="self"||c=="any"?this.sprite:Sprites.getSpriteByName(c)){if(b){for(var d={scripts:[]},e=0;e<c.scripts.length;e++){var f=c.scripts[e];if(f.tags)for(var g=0;g<f.tags.length;g++)if(f.tags[g]==b){d.scripts.push(f);break}}b=ObjectIO.serializeScripts(d,true)}else b=ObjectIO.serializeScripts(c,true);return b=JSON.stringify(b)}return""};
Script.prototype.blockControlDeserializeScripts=function(b){var c=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);if(b=b=="self"||b=="any"?this.sprite:Sprites.getSpriteByName(b)){typeof c=="string"&&(c=JSON.parse(c));ObjectIO.deserializeScripts(b,c)}};
Script.prototype.blockControlRemoveScriptsWithTag=function(b){var c=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);if(b=b=="self"||b=="any"?this.sprite:Sprites.getSpriteByName(b)){for(var d=[],e=0;e<b.scripts.length;e++){var f=false,g=b.scripts[e];if(g.tags)for(var h=0;h<g.tags.length;h++)if(g.tags[h]==c){Runtime.unregisterBlock(g,b);f=true;break}f||d.push(g)}b.scripts=d}};
Script.prototype.blockControlJS=function(b){b=this.evaluateExpression(b[0]);if(this.currentBlock.scriptText!=b){this.currentBlock.scriptText=b;this.currentBlock.scriptEvaled=eval("(function() {"+b+"})")}b=this.currentBlock;this.currentBlock.scriptEvaled.apply(this);this.currentBlock=b};
Script.prototype.valueControlJS=function(b){b=this.evaluateExpression(b[0]);if(this.currentBlock.scriptText!=b){this.currentBlock.scriptText=b;this.currentBlock.scriptEvaled=eval("(function() {"+b+"})")}var b=this.currentBlock,c=this.currentBlock.scriptEvaled.apply(this);this.currentBlock=b;return c};
Script.prototype.callFunction=function(b,c,d){if(b=="self")b=this.sprite;else{b=Sprites.getSpriteByName(b);if(!b)b=Runtime.background}var e="";if(c=this._findFunction(b.scripts,c)){for(var f=this.currentBlock,e=[],g=0;g<d.length;g++)e.push(this.evaluateExpression(d[g]));e=this._valueControlCall(b,c,e);this.currentBlock=f}else this.error=true;return e};
Script.prototype.callLibrary=function(b,c,d){var e=this.currentBlock,f="";if(b=Runtime.getLibraryByName(b)){for(var g=0;g<d.length;g++)d[g]=this.evaluateExpression(d[g]);(c=this._findFunction(b.scripts,c))&&(f=this._valueControlCall(this.sprite,c,d))}this.currentBlock=e;return f};Script.prototype.setProperty=function(b,c,d){if(b=="self")b=this.sprite;else{b=Sprites.getSpriteByName(b);if(!b)b=Runtime.background}blockVarPropSet(c,b,d);this.dirty()};
Script.prototype.getProperty=function(b,c){if(b=="self")b=this.sprite.label;return propertyGet(c,b)};Script.prototype.blockLooksSwitchCostume=function(b){this.dirty();_doBlockLooksSwitchCostume(this.sprite,this.evaluateExpression(b[0]));return false};function _doBlockLooksSwitchCostume(b,c){b.setCostumeByName(c);return false}
Script.prototype.blockLooksNextCostume=function(){this.dirty();if(this.sprite.skeleton&&this.sprite.spriteObj.drawFunction){this.sprite.updateSkeleton();return false}var b=this.sprite.getCostumes(),c=this.sprite.getCostumeByName(this.sprite.currentCostume),d=0;c&&(d=(c[0]+1)%b.length);this.sprite.setCostumeByName(d+1);return false};
Script.prototype.blockLooksFirstCostumeInGroup=function(b){b=this.evaluateExpression(b[0]);this.dirty();for(var c=this.sprite.getCostumes(),d=0,e=0;e<c.length;e++)if(c[e].name.substring(0,b.length)==b){d=e;break}this.sprite.setCostumeByName(d+1);return false};Script.prototype.blockLooksNextCostumeInGroup=function(b){this.dirty();this.sprite.nextCostumeInGroup(this.evaluateExpression(b[0]),parseInt(this.evaluateExpression(b[1])));return false};
Script.prototype.valueLooksCostumeNum=function(){return this.sprite.getCostumeByName(this.sprite.currentCostume)[0]+1};Script.prototype.valueLooksCostumeName=function(){return this.sprite.skeleton&&this.sprite.spriteObj.drawFunction?this.sprite.skeleton.animationName:this.sprite.getCostumeByName(this.sprite.currentCostume)[1].name};Script.prototype.valueLooksBackgroundName=function(){return this.sprite.getCostumeByName(this.sprite.currentCostume)[1].name};
Script.prototype.blockLooksSetLevel=function(b){b=this.evaluateExpression(b[0]);if(typeof b=="number"){b=Math.floor(b)%Runtime.levels.length;b<0&&(b=b+Runtime.levels.length);Runtime.loadLevel(b,null,function(){Runtime.triggerFlag()})}else{for(var c=0;c<Runtime.levels.length;c++)if(Runtime.levels[c].name==b){Runtime.loadLevel(c,null,function(){Runtime.triggerFlag()});return false}b=coerceToNumber(b);b=Math.floor(b)%Runtime.levels.length;if(b<0){b=b+Runtime.levels.length;Runtime.loadLevel(c,null,function(){Runtime.triggerFlag()})}}return false};
Script.prototype.blockLooksSetLevelWithActors=function(b){for(var c=this.evaluateExpression(b[0]),d=[],e=1;e<b.length;e++){var f=this.evaluateExpression(b[e]);if(f=="self"){f=this.sprite.label;d.indexOf(f)<0&&d.push(f)}else if(f=="all"){d=[];for(b=0;b<Runtime.sprites.length;b++)d.push(Runtime.sprites[b].label);break}else d.indexOf(f)<0&&d.push(f)}if(typeof c=="number"){c=Math.floor(c)%Runtime.levels.length;c<0&&(c=c+Runtime.levels.length);Runtime.loadLevel(c,d,function(){Runtime.triggerFlag()})}else{for(e=
0;e<Runtime.levels.length;e++)if(Runtime.levels[e].name==c){Runtime.loadLevel(e,d,function(){Runtime.triggerFlag()});return false}c=coerceToNumber(c);c=Math.floor(c)%Runtime.levels.length;if(c<0){c=c+Runtime.levels.length;Runtime.loadLevel(e,d,function(){Runtime.triggerFlag()})}}return false};Script.prototype.valueLooksGetLevel=function(){return Runtime.levels[Runtime.currentLevelIndex].name};Script.prototype.valueLooksGetLevelNum=function(){return Runtime.currentLevelIndex};
Script.prototype.valueLooksNumLevels=function(){return Runtime.levels.length};
Script.prototype.blockLooksSetZoom=function(b){Runtime.stage.canvasScale=this.evaluateExpression(b[0])/100;b=Math.min(Runtime.stage.actorsLayer.canvas.width/(Runtime.stage.tileLayer.mapWidth*Runtime.stage.tileLayer.tileSize),Runtime.stage.actorsLayer.canvas.height/(Runtime.stage.tileLayer.mapHeight*Runtime.stage.tileLayer.tileSize));if(Runtime.stage.canvasScale<b)Runtime.stage.canvasScale=b;Runtime.stage.tileLayer.setScrollOffset(Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.tileLayer.getScrollOffsetY());
Runtime.stage.draw()};Script.prototype.valueLooksGetZoom=function(){return Runtime.stage.canvasScale*100};Script.prototype.valueLooksGetTileAt=function(b){var c=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);return Runtime.stage.tileLayer.getTile(c,b)};
Script.prototype.valueLooksGetTileAtPoint=function(b){var c=Runtime.stage.tileLayer.tileSize,d=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]),d=Math.floor((d+Runtime.stage.getWidth()/2)/c),b=Math.floor((Runtime.stage.getHeight()/2-b)/c);return Runtime.stage.tileLayer.getTile(d,b)};
Script.prototype.blockLooksSetTileAt=function(b){var c=this.evaluateExpression(b[0]),d=this.evaluateExpression(b[1]),b=this.evaluateExpression(b[2]),b=Runtime.stage.tileLayer.resolveTileName(b);b<0?Runtime.stage.tileLayer.removeTile(c,d):Runtime.stage.tileLayer.placeTile(c,d,b);Runtime.stage.tileLayer.resetPhysics(Physics.world);Runtime.stage.draw()};
Script.prototype.blockLooksSetTileAtPoint=function(b){var c=Runtime.stage.tileLayer.tileSize,d=this.evaluateExpression(b[0]),e=this.evaluateExpression(b[1]),d=Math.floor((d+Runtime.stage.getWidth()/2)/c),e=Math.floor((Runtime.stage.getHeight()/2-e)/c),b=this.evaluateExpression(b[2]),b=Runtime.stage.tileLayer.resolveTileName(b);b<0?Runtime.stage.tileLayer.removeTile(d,e):Runtime.stage.tileLayer.placeTile(d,e,b);Runtime.stage.tileLayer.resetPhysics(Physics.world);Runtime.stage.draw()};
Script.prototype.blockLooksSetLabel=function(b){if(this.sprite.spriteObj){this.dirty();for(var c="",d=0;d<b.length;d++)c=c+ifArrayMakeString(this.evaluateExpression(b[d]));this.sprite.spriteObj.label=c}return false};Script.prototype.blockLooksSetBubble=function(b){if(this.sprite.spriteObj){Script._saveBubbleStyle(this.sprite.spriteObj,this.sprite);this.sprite.spriteObj.bubble.style=this.evaluateExpression(b[0])}else{Script._saveBubbleStyle(Runtime.stage,this.sprite);Runtime.stage.bubble.style=this.evaluateExpression(b[0])}return false};
Script.prototype.blockLooksSetBubbleWidth=function(b){if(this.sprite.spriteObj){Script._saveBubbleStyle(this.sprite.spriteObj,this.sprite);this.sprite.spriteObj.bubble.width=this.evaluateExpression(b[0])}return false};
Script.prototype.blockLooksSetBubbleDock=function(b){if(this.sprite.spriteObj){Script._saveBubbleStyle(this.sprite.spriteObj,this.sprite);this.sprite.spriteObj.bubble.dock=this.evaluateExpression(b[0])}else{Script._saveBubbleStyle(Runtime.stage,this.sprite);Runtime.stage.bubble.dock=this.evaluateExpression(b[0])}return false};
Script._saveBubbleStyle=function(b,c){if(!b.bubble)b.bubble={style:"rounded",width:"auto",dock:"none"};b.bubble.penColor=c.penColor;b.bubble.fillColor=c.fillColor;b.bubble.penWidth=c.penWidth;b.bubble.font=c.font;b.bubble.fontColor=c.fontColor?c.fontColor:c.penColor;b.bubble.buttonText=c.buttonText};
Script.prototype.blockLooksSayFor=function(b){this.yield();if(this.data==null){for(var c="",d=0;d<b.length-1;d++)c=c+ifArrayMakeString(this.evaluateExpression(b[d]));this.data=Date.now()+parseFloat(this.evaluateExpression(b[b.length-1]))*1E3;this.sprite.buttonText="";_doBlockLooksSay(this.sprite,c);this.dirty()}else if(Date.now()>this.data){_doBlockLooksSay(this.sprite,"");this.dirty();return false}return this.skipArgCompute=true};
Script.prototype.blockLooksSay=function(b){for(var c="",d=0;d<b.length;d++)c=c+ifArrayMakeString(this.evaluateExpression(b[d]));this.dirty();this.sprite.buttonText="";_doBlockLooksSay(this.sprite,c);return false};
function _doBlockLooksSay(b,c){if(b.spriteObj){Script._saveBubbleStyle(b.spriteObj,b);if(b.spriteObj.bubble.style=="thought-block")b.spriteObj.bubble.style="rounded";b.spriteObj.bubble.offset=b.avatarid?true:false;b.spriteObj.text=c}else{Script._saveBubbleStyle(Runtime.stage,Runtime.background);Runtime.stage.text=c}}
Script.prototype.blockLooksThinkFor=function(b){this.yield();if(this.data==null){if(this.sprite.spriteObj){Script._saveBubbleStyle(this.sprite.spriteObj,this.sprite);this.sprite.spriteObj.bubble.style="thought-block";this.sprite.spriteObj.bubble.offset=this.sprite.avatarid?true:false}else{Script._saveBubbleStyle(Runtime.stage,this.sprite);Runtime.stage.bubble.style="thought-block"}for(var c="",d=0;d<b.length-1;d++)c=c+ifArrayMakeString(this.evaluateExpression(b[d]));this.data=Date.now()+parseFloat(this.evaluateExpression(b[b.length-
1]))*1E3;this.sprite.spriteObj?this.sprite.spriteObj.text=c:Runtime.stage.text=c;this.dirty()}else if(Date.now()>this.data){this.sprite.spriteObj?this.sprite.spriteObj.text="":Runtime.stage.text="";this.dirty();return false}return this.skipArgCompute=true};
Script.prototype.blockLooksThink=function(b){if(this.sprite.spriteObj){Script._saveBubbleStyle(this.sprite.spriteObj,this.sprite);this.sprite.spriteObj.bubble.style="thought";this.sprite.spriteObj.bubble.offset=this.sprite.avatarid?true:false}else{Script._saveBubbleStyle(Runtime.stage,this.sprite);Runtime.stage.bubble.style="thought"}for(var c="",d=0;d<b.length;d++)c=c+ifArrayMakeString(this.evaluateExpression(b[d]));if(this.sprite.spriteObj){this.dirty();this.sprite.spriteObj.text=c}else Runtime.stage.text=
c;return false};Script.prototype.blockLooksChangeEffect=function(b){this.dirty();var c=this.evaluateExpression(b[0]),b=parseFloat(this.evaluateExpression(b[1]));switch(c){case "color":c="hue";break;case "fisheye":c="lensdistortion";break;case "whirl":c="twirl";break;case "ghost":case "opacity":c="opacity"}var d=this.sprite.getFilter(c);d?this.blockLooksSetEffect([c,(d.options.value+b)%100]):this.blockLooksSetEffect([c,b]);return false};
Script.prototype.blockLooksSetEffect=function(b){this.dirty();_doBlockLooksSetEffect(this.sprite,this.evaluateExpression(b[0]),this.evaluateExpression(b[1]));return false};
function _doBlockLooksSetEffect(b,c,d){d=parseFloat(d)%100;d<0&&(d=d+100);switch(c){case "color":case "hue":b.setFilter("hue",{value:d,amount:(d-50)/50});return true;case "fisheye":case "lensdistortion":b.setFilter("lensdistortion",{value:d,refraction:Math.max(1,Math.min(10,d*10/100)),radius:Math.max(1,b.spriteObj?Math.max(b.spriteObj.width,b.spriteObj.height)/2:Math.max(Runtime.stage.getWidth(),Runtime.stage.getHeight())/2)});return true;case "whirl":case "twirl":b.setFilter("twirl",{value:d,radius:Math.max(1,
b.spriteObj?Math.max(b.spriteObj.width,b.spriteObj.height)/2:Math.max(Runtime.stage.getWidth(),Runtime.stage.getHeight())/2),angle:d*359/100});return true;case "pixelate":b.setFilter("pixelate",{value:d,size:Math.max(1,d*50/100)});return true;case "mosaic":return true;case "brightness":b.setFilter("brightness",{value:d,amount:(d-50)/50});return true;case "blur":b.setFilter("blur",{value:d,amount:d*10/100});return true;case "bump":b.setFilter("bump",{value:d});return true;case "circlesmear":b.setFilter("circlesmear",
{value:d,size:d*9/100+1,density:0.5,mix:0.5});return true;case "contrast":b.setFilter("contrast",{value:d,amount:d*2/100});return true;case "crosssmear":new CrossSmearFilter;b.setFilter("crosssmear",{value:d,distance:d*30/100,density:0.5,mix:0.5});return true;case "diffusion":b.setFilter("diffusion",{value:d,scale:d*99/100+1});return true;case "dither":b.setFilter("dither",{value:d,levels:d*28/100+2});return true;case "edge":b.setFilter("edge",{value:d});return true;case "emboss":b.setFilter("emboss",
{value:d,height:1,angle:135,elevation:30});return true;case "exposure":b.setFilter("exposure",{value:d,exposure:d*5/100});return true;case "gain":b.setFilter("gain",{value:d,gain:d/100,bias:d/100});return true;case "gamma":b.setFilter("gamma",{value:d,amount:d*2/100});return true;case "grayscale":b.setFilter("grayscale",{value:d});return true;case "invert":b.setFilter("invert",{value:d});return true;case "kaleidoscope":b.setFilter("kaleidoscope",{value:d,angle:0,rotation:d*359/100,sides:6});return true;
case "linesmear":b.setFilter("linesmear",{value:d,distance:d*29/100+1,density:0.5,angle:0,mix:0.5});return true;case "maximum":b.setFilter("maximum",{value:d});return true;case "median":b.setFilter("median",{value:d});return true;case "minimum":b.setFilter("minimum",{value:d});return true;case "noise":b.setFilter("noise",{value:d,amount:d,density:1,monochrome:true});return true;case "oil":b.setFilter("oil",{value:d,range:d*5/100});return true;case "ghost":case "opacity":b.setFilter("opacity",{value:d,
amount:d/100});return true;case "pinch":b.setFilter("pinch",{value:d,amount:(d-50)/100,radius:Math.max(1,b.spriteObj?Math.max(b.spriteObj.width,b.spriteObj.height)/2:Math.max(Runtime.stage.getWidth(),Runtime.stage.getHeight())/2),angle:0});return true;case "posterize":b.setFilter("posterize",{value:d,levels:d*28/100+2});return true;case "rgbadjust":b.setFilter("rgbadjust",{value:d,red:d*2/100,green:d*2/100,blue:d*2/100});return true;case "saturation":b.setFilter("saturation",{value:d,amount:d*2/100});
return true;case "sawtoothripple":b.setFilter("sawtoothripple",{value:d,xAmplitude:d*30/100,yAmplitude:d*30/100,xWavelength:16,yWavelength:16});return true;case "sepia":b.setFilter("sepia",{value:d,amount:d*30/100});return true;case "sharpen":b.setFilter("sharpen",{});return true;case "sineripple":b.setFilter("sineripple",{value:d,xAmplitude:d*30/100,yAmplitude:d*30/100,xWavelength:16,yWavelength:16});return true;case "solarize":b.setFilter("solarize",{value:d});return true;case "sparkle":b.setFilter("sparkle",
{value:d,rays:50,size:25,amount:d,randomness:25});return true;case "squaresmear":b.setFilter("squaresmear",{value:d,size:d*10/100+1,density:0.5,mix:0.5});return true;case "threshold":b.setFilter("threshold",{value:d,threshold:d*255/100});return true;case "triangleripple":b.setFilter("triangleripple",{value:d,xAmplitude:d*30/100,yAmplitude:d*30/100,xWavelength:16,yWavelength:16});return true;case "vignette":b.setFilter("vignette",{value:d,amount:d/100});return true;case "waterripple":b.setFilter("waterripple",
{value:d,phase:d,radius:Math.max(1,b.spriteObj?Math.max(b.spriteObj.width,b.spriteObj.height)/2:Math.max(Runtime.stage.getWidth(),Runtime.stage.getHeight())/2),wavelength:16,amplitude:10});return true}return false}Script.prototype.blockLooksClearEffects=function(){this.dirty();this.sprite.spriteObj?this.sprite.spriteObj.alpha=1:Runtime.stage.backgroundLayer.alpha=1;this.sprite.clearFilters();return false};
Script.prototype.blockLooksChangeSizeBy=function(b){var c=this.sprite.spriteObj;if(c){this.dirty();b=c.scale.x*100+parseInt(this.evaluateExpression(b[0]));_doBlockLooksSetSize(this.sprite,b)}return false};Script.prototype.blockLooksSetSize=function(b){if(this.sprite.spriteObj){this.dirty();_doBlockLooksSetSize(this.sprite,this.evaluateExpression(b[0]))}return false};function _doBlockLooksSetSize(b,c){if(b.spriteObj){var d=parseFloat(c)/100;d<1.0E-4&&(d=1.0E-4);b.spriteObj.setScale(d)}}
Script.prototype.valueLooksSize=function(){var b=this.sprite.spriteObj;return b?Math.floor(b.scale.x*100):0};Script.prototype.blockLooksShow=function(){if(this.sprite.spriteObj){this.dirty();this.sprite.spriteObj.show()}return false};Script.prototype.blockLooksHide=function(){if(this.sprite.spriteObj){this.dirty();this.sprite.spriteObj.hide()}return false};Script.prototype.valueLooksIsHidden=function(){return this.sprite.spriteObj?!this.sprite.spriteObj.visible:false};
Script.prototype.blockLooksLayer=function(b){if(this.sprite.spriteObj){this.dirty();this.sprite.spriteObj.setZIndex(parseInt(this.evaluateExpression(b[0])))}return false};Script.prototype.valueLooksLayer=function(){return this.sprite.spriteObj?this.sprite.spriteObj.zIndex:0};Script.prototype.blockLooksGoFront=function(){if(this.sprite.spriteObj){this.dirty();this.sprite.spriteObj.moveToTop()}return false};Script.prototype.blockLooksGoBack=function(){if(this.sprite.spriteObj){this.dirty();this.sprite.spriteObj.moveToBottom()}return false};
Script.prototype.blockLooksMoveBack=function(b){if(this.sprite.spriteObj){this.dirty();this.sprite.spriteObj.moveBack(parseInt(this.evaluateExpression(b[0])))}return false};Script.prototype.blockLooksMoveFront=function(b){if(this.sprite.spriteObj){this.dirty();this.sprite.spriteObj.moveFront(parseInt(this.evaluateExpression(b[0])))}return false};
Script.prototype.blockLooksBackgroundColor=function(b){(b=this.evaluateExpression(b[0]))?$("#stage-canvas").css("background-color",b):$("#stage-canvas").css("background-color","#fff")};
Script.prototype.blockLooksSwitchBackground=function(b){Runtime.background.setCostumeByName(""+this.evaluateExpression(b[0]));for(var b=Runtime.background.getCostumeByName(Runtime.background.currentCostume)[1].name,c=0;c<Runtime.sceneChanges.length;c++){var d=Runtime.sceneChanges[c].scriptBlock.label.getSocketAtChild(0);d!=null&&(""+d.label==b||""+d.label=="any")&&Runtime.scheduleToRun(Runtime.sceneChanges[c])}return false};
Script.prototype.blockLooksSwitchBackgroundAndWait=function(b){this.yield();if(this.data==null){Runtime.background.setCostumeByName(""+this.evaluateExpression(b[0]));var c=Runtime.background.getCostumeByName(Runtime.background.currentCostume)[1].name;this.data=c;for(b=0;b<Runtime.sceneChanges.length;b++){var d=Runtime.sceneChanges[b].scriptBlock.label.getSocketAtChild(0);d!=null&&((""+d.label==c||""+d.label=="any")&&!Runtime.sceneChanges[b].running)&&Runtime.scheduleToRun(Runtime.sceneChanges[b])}return this.skipArgCompute=
true}c=false;for(b=0;b<Runtime.runningScripts.length;b++){var e=Runtime.runningScripts[b];if(e.scriptBlock.func=="registerBackgroundChange"){d=e.scriptBlock.label.getSocketAtChild(0);if(d!=null&&(""+d.label==this.data||this.data=="any")&&e.running){c=true;break}}}if(c)return this.skipArgCompute=true;return false};
Script.prototype.blockLooksNextBackground=function(){this.dirty();var b=Runtime.background.getCostumes(),c=Runtime.background.getCostumeByName(Runtime.background.currentCostume),d=0;c&&(d=(c[0]+1)%b.length);Runtime.background.setCostumeByName(d+1);if(b=Runtime.background.getCostumeByName(Runtime.background.currentCostume)){b=b[1].name;for(c=0;c<Runtime.sceneChanges.length;c++){d=Runtime.sceneChanges[c].scriptBlock.label.getSocketAtChild(0);d!=null&&(""+d.label==b||d.label=="any")&&Runtime.scheduleToRun(Runtime.sceneChanges[c])}}return false};
Script.prototype.blockLooksFirstBackgroundInGroup=function(b){var c=this.evaluateExpression(b[0]);this.dirty();var d=Runtime.background.getCostumes();Runtime.background.getCostumeByName(Runtime.background.currentCostume);for(var e=0,b=0;b<d.length;b++)if(d[b].name.substring(0,c.length)==c){e=b;break}Runtime.background.setCostumeByName(e+1);c=Runtime.background.getCostumeByName(Runtime.background.currentCostume)[1].name;for(b=0;b<Runtime.sceneChanges.length;b++){d=Runtime.sceneChanges[b].scriptBlock.label.getSocketAtChild(0);
d!=null&&(""+d.label==c||d.label=="any")&&Runtime.scheduleToRun(Runtime.sceneChanges[b])}return false};
Script.prototype.blockLooksNextBackgroundInGroup=function(b){var c=this.evaluateExpression(b[0]);this.dirty();var d=Runtime.background.getCostumes(),b=Runtime.background.getCostumeByName(Runtime.background.currentCostume),e=0;if(b&&b[1].name.substring(0,c.length)==c)for(var b=e=(b[0]+1)%d.length,f=0;f<d.length;b++,f++){if(d[b%d.length].name.substring(0,c.length)==c){e=b%d.length;break}}else for(b=0;b<d.length;b++)if(d[b].name.substring(0,c.length)==c){e=b;break}Runtime.background.setCostumeByName(e+
1);c=Runtime.background.getCostumeByName(Runtime.background.currentCostume)[1].name;for(b=0;b<Runtime.sceneChanges.length;b++){d=Runtime.sceneChanges[b].scriptBlock.label.getSocketAtChild(0);d!=null&&(""+d.label==c||d.label=="any")&&Runtime.scheduleToRun(Runtime.sceneChanges[b])}return false};Script.prototype.valueLooksBackground=function(){return Runtime.background.getCostumeByName(Runtime.background.currentCostume)[0]+1};Script.prototype.valueLooksBackgroundName=function(){return Runtime.background.getCostumeByName(Runtime.background.currentCostume)[1].name};
Script.prototype.blockLooksVideo=function(b){b=this.evaluateExpression(b[0]);$(Runtime.stage.videoLayer.canvas).css("opacity",1);b=="on"?MediaCapture.showVideo($("#webcam")[0],Runtime.stage.videoLayer.canvas,false):b=="on-flipped"?MediaCapture.showVideo($("#webcam")[0],Runtime.stage.videoLayer.canvas,true):b=="off"&&MediaCapture.hideVideo();return false};
Script.prototype.blockLooksVideoTransparency=function(b){this.dirty();b=parseFloat(this.evaluateExpression(b[0]))/100;b<0?$(Runtime.stage.videoLayer.canvas).css("opacity",0):b>1?$(Runtime.stage.videoLayer.canvas).css("opacity",1):$(Runtime.stage.videoLayer.canvas).css("opacity",b);return false};
Script.prototype.blockLooksDialog=function(b){this.dirty();this.yield();if(this.data==null){this.data=true;Runtime.askTriggerText="";var c=$('<a href="#" class="btnDefaultOrange">OK</a>');c.click(function(){showInfoPopup();Runtime.askTriggerText="continue";return false});b=this.evaluateExpression(b[0]);b.indexOf("<p>")<0&&(b="<p>"+b+"</p>");showInfoPopup(b,null,c,false,true);return this.skipArgCompute=true}if(!Runtime.askTriggerText)return this.skipArgCompute=true;Runtime.askTriggerText="";return false};
Script.prototype.blockLooksViewportCamera=function(b){this.dirty();var c=null,b=this.evaluateExpression(b[0]);if(b=="stage")c=null;else if(b=="self")c=this.sprite.spriteObj;else if(c=Sprites.getSpriteByName(b))c=c.spriteObj;c&&Runtime.stage.tileLayer.setCamera(c);return false};
Script.prototype.blockLooksPromptChoices=function(b){this.dirty();this.yield();if(this.data==null){this.data=true;for(var c=Runtime.askTriggerText="",d=1;d<b.length;d++)c=c?c+(' <a href="#" class="btnDefaultWhite medium">'+this.evaluateExpression(b[d])+"</a>"):'<a href="#" class="btnDefaultOrange medium">'+this.evaluateExpression(b[d])+"</a>";c=$(c);c.length>1?c.siblings("a").click(function(){showInfoPopup();Runtime.askTriggerText=$(this).text();return false}):c.click(function(){showInfoPopup();Runtime.askTriggerText=
$(this).text();return false});b=this.evaluateExpression(b[0]);b.indexOf("<p>")<0&&(b="<p>"+b+"</p>");showInfoPopup(b,null,c,false,true);return this.skipArgCompute=true}if(!Runtime.askTriggerText)return this.skipArgCompute=true;this.dlgAnswer=Runtime.askTriggerText;Runtime.askTriggerText="";return false};
Script.prototype.blockMotionMove=function(b){if(this.sprite.spriteObj){this.dirty();var c=this.sprite.spriteObj,d=c.x,e=c.y,f=c.rotation*Math.PI/180,g=parseFloat(this.evaluateExpression(b[0])),b=Math.cos(f)*g,f=Math.sin(f)*g;c.move(b,f);if(this.sprite.penDown){c=Runtime.stage.penLayer.context;c.save();c.beginPath();c.strokeStyle=this.sprite.penColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.moveTo(d,e);c.lineTo(d+b,e+f);c.stroke();c.closePath();c.restore()}}return false};
Script.prototype.blockMotionTurnCW=function(b){if(this.sprite.spriteObj){this.dirty();this.sprite.spriteObj.rotate(parseFloat(this.evaluateExpression(b[0])))}return false};Script.prototype.blockMotionTurnCCW=function(b){if(this.sprite.spriteObj){this.dirty();this.sprite.spriteObj.rotate(-parseFloat(this.evaluateExpression(b[0])))}return false};Script.prototype.blockMotionPointDirection=function(b){if(this.sprite.spriteObj){this.dirty();_doBlockMotionPointDirection(this.sprite,this.evaluateExpression(b[0]))}return false};
Script.prototype.blockMotionPointAngle=function(b){if(this.sprite.spriteObj){this.dirty();b=360-parseFloat(this.evaluateExpression(b[0]));_doBlockMotionPointDirection(this.sprite,b+90)}return false};function _doBlockMotionPointDirection(b,c){b.spriteObj.setRotation(-(90-parseFloat(c)))}
Script.prototype.blockMotionPointTowards=function(b){if(this.sprite.spriteObj){this.dirty();b=this.evaluateExpression(b[0]);if(b=="mouse-pointer")(b=Runtime.stage.getMousePos())&&(this.sprite.spriteObj.x!=b.x&&this.sprite.spriteObj.y!=b.y)&&this.sprite.spriteObj.setRotation(-Math.atan2(this.sprite.spriteObj.y-b.y,b.x-this.sprite.spriteObj.x)*180/Math.PI);else{if(b=="left edge")return this.sprite.spriteObj.setRotation(-(90-(this.sprite.spriteObj.x>0?-90:90)));if(b=="right edge")return this.sprite.spriteObj.setRotation(-(90-
(this.sprite.spriteObj.x<Runtime.stage.getWidth()?90:-90)));if(b=="top edge")return this.sprite.spriteObj.setRotation(-(90-(this.sprite.spriteObj.y>0?0:180)));if(b=="bottom edge")return this.sprite.spriteObj.setRotation(-(90-(this.sprite.spriteObj.y<Runtime.stage.getHeight()?180:0)));for(var c=0;c<Runtime.sprites.length;c++){var d=Runtime.sprites[c];if(b==d.label){this.sprite.spriteObj.x!=d.spriteObj.x&&this.sprite.spriteObj.y!=d.spriteObj.y&&this.sprite.spriteObj.setRotation(-Math.atan2(this.sprite.spriteObj.y-
d.spriteObj.y,d.spriteObj.x-this.sprite.spriteObj.x)*180/Math.PI);break}}}}return false};
Script.prototype.blockMotionGoTo=function(b){if(this.sprite.spriteObj){this.dirty();var c=this.sprite.spriteObj,d=c.x,e=c.y,f=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[0])),b=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[1]));c.setPosition(f,b);if(this.sprite.penDown){c=Runtime.stage.penLayer.context;c.save();c.beginPath();c.strokeStyle=this.sprite.penColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.moveTo(d,e);c.lineTo(f,b);c.stroke();c.closePath();
c.restore()}}return false};
Script.prototype.blockMotionGoTowards=function(b){if(this.sprite.spriteObj){this.dirty();var c=this.sprite.spriteObj,d=c.x,e=c.y,f=d,g=e,b=this.evaluateExpression(b[0]);if(b=="mouse-pointer"){if(b=Runtime.stage.getMousePos()){f=b.x;g=b.y}}else if(b=="left edge")f=0;else if(b=="right edge")f=Runtime.stage.getWidth();else if(b=="top edge")g=0;else if(b=="bottom edge")g=Runtime.stage.getHeight();else for(var h=0;h<Runtime.sprites.length;h++){var j=Runtime.sprites[h];if(b==j.label){f=j.spriteObj.x;g=
j.spriteObj.y;break}}c.setPosition(f,g);if(this.sprite.penDown){c=Runtime.stage.penLayer.context;c.save();c.beginPath();c.strokeStyle=this.sprite.penColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.moveTo(d,e);c.lineTo(f,g);c.stroke();c.closePath();c.restore()}}return false};
Script.prototype.blockMotionGlide=function(b){if(this.sprite.spriteObj){this.dirty();this.yield();if(this.data==null){var c=parseFloat(this.evaluateExpression(b[0]))*1E3;if(c>0){this.data={startTime:Date.now(),timeout:c,origPosX:this.sprite.spriteObj.x,origPosY:this.sprite.spriteObj.y,finalPosX:Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[1])),finalPosY:Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[2]))};return this.skipArgCompute=true}}else{b=Date.now();if(b-
this.data.startTime<this.data.timeout){var c=this.sprite.spriteObj.x,d=this.sprite.spriteObj.y,e=this.data.origPosX+(this.data.finalPosX-this.data.origPosX)*(b-this.data.startTime)/this.data.timeout,f=this.data.origPosY+(this.data.finalPosY-this.data.origPosY)*(b-this.data.startTime)/this.data.timeout;this.sprite.spriteObj.setPosition(e,f);if(this.sprite.penDown){b=Runtime.stage.penLayer.context;b.save();b.beginPath();b.strokeStyle=this.sprite.penColor;b.lineWidth=this.sprite.penWidth;b.lineCap="round";
b.moveTo(c,d);b.lineTo(e,f);b.stroke();b.closePath();b.restore()}return this.skipArgCompute=true}this.sprite.spriteObj.setPosition(this.data.finalPosX,this.data.finalPosY);if(this.sprite.penDown){b=Runtime.stage.penLayer.context;b.save();b.beginPath();b.strokeStyle=this.sprite.penColor;b.lineWidth=this.sprite.penWidth;b.lineCap="round";b.moveTo(c,d);b.lineTo(e,f);b.stroke();b.closePath();b.restore()}}}return false};
Script.prototype.blockMotionChangeXBy=function(b){if(this.sprite.spriteObj){this.dirty();var c=this.sprite.spriteObj,d=c.x,e=c.y,b=parseFloat(this.evaluateExpression(b[0]));c.move(b,0);if(this.sprite.penDown){c=Runtime.stage.penLayer.context;c.save();c.beginPath();c.strokeStyle=this.sprite.penColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.moveTo(d,e);c.lineTo(d+b,e);c.stroke();c.closePath();c.restore()}}return false};
Script.prototype.blockMotionSetX=function(b){if(this.sprite.spriteObj){this.dirty();_doBlockMotionSetX(this.sprite,this.evaluateExpression(b[0]))}return false};
function _doBlockMotionSetX(b,c){if(b.spriteObj){var d=b.spriteObj,e=d.x,f=d.y,g=Runtime.stage.getWidth()/2+parseFloat(c);d.setPosition(g,f);if(b.penDown){d=Runtime.stage.penLayer.context;d.save();d.beginPath();d.strokeStyle=b.penColor;d.lineWidth=b.penWidth;d.lineCap="round";d.moveTo(e,f);d.lineTo(g,f);d.stroke();d.closePath();d.restore()}}}
Script.prototype.blockMotionChangeYBy=function(b){if(this.sprite.spriteObj){this.dirty();var c=this.sprite.spriteObj,d=c.x,e=c.y,b=-parseFloat(this.evaluateExpression(b[0]));c.move(0,b);if(this.sprite.penDown){c=Runtime.stage.penLayer.context;c.save();c.beginPath();c.strokeStyle=this.sprite.penColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.moveTo(d,e);c.lineTo(d,e+b);c.stroke();c.closePath();c.restore()}}return false};
Script.prototype.blockMotionSetY=function(b){if(this.sprite.spriteObj){this.dirty();_doBlockMotionSetY(this.sprite,this.evaluateExpression(b[0]))}return false};
function _doBlockMotionSetY(b,c){if(b.spriteObj){var d=b.spriteObj,e=d.x,f=d.y,g=Runtime.stage.getHeight()/2-parseFloat(c);d.setPosition(e,g);if(b.penDown){d=Runtime.stage.penLayer.context;d.save();d.beginPath();d.strokeStyle=b.penColor;d.lineWidth=b.penWidth;d.lineCap="round";d.moveTo(e,f);d.lineTo(e,g);d.stroke();d.closePath();d.restore()}}}
Script.prototype.blockMotionBounceOnEdge=function(){if(this.sprite.spriteObj){this.dirty();var b=this.sprite.spriteObj;if(b.x-b.cx*b.scale.x<0){b.rotation>90&&b.rotation<270&&b.setRotation(180-b.rotation);b.setPosition(b.cx*b.scale.x,b.y)}else if(b.y-b.cy*b.scale.y<0){b.rotation>180&&b.setRotation(-b.rotation);b.setPosition(b.x,b.cy*b.scale.y)}else if(b.x+(-b.cx+b.width)*b.scale.x>Runtime.stage.getWidth()){(b.rotation<90||b.rotation>270)&&b.setRotation(180-b.rotation);b.setPosition(Runtime.stage.getWidth()+
(b.cx-b.width)*b.scale.x,b.y)}else if(b.y+(-b.cy+b.height)*b.scale.y>Runtime.stage.getHeight()){b.rotation<180&&b.setRotation(-b.rotation);b.setPosition(b.x,Runtime.stage.getHeight()+(b.cy-b.height)*b.scale.y)}}return false};
Script.prototype.blockMotionRotationStyle=function(b){if(this.sprite.spriteObj){b=this.evaluateExpression(b[0]);b=="left-right"?this.sprite.spriteObj.rotateLock!=1&&this.sprite.spriteObj.setRotateLock(1):b=="don't rotate"?this.sprite.spriteObj.rotateLock!=2&&this.sprite.spriteObj.setRotateLock(2):this.sprite.spriteObj.rotateLock!==0&&this.sprite.spriteObj.setRotateLock(0)}return false};
Script.prototype.valueMotionXPosition=function(){return this.sprite.spriteObj?this.sprite.spriteObj.x-Runtime.stage.getWidth()/2:0};Script.prototype.valueMotionYPosition=function(){return this.sprite.spriteObj?Runtime.stage.getHeight()/2-this.sprite.spriteObj.y:0};Script.prototype.valueMotionDirection=function(){if(this.sprite.spriteObj){var b=(this.sprite.spriteObj.rotation+90)%360;b>180&&(b=b-360);return b}return 0};
Script.prototype.valueMotionAngle=function(){if(this.sprite.spriteObj){var b=this.sprite.spriteObj.rotation;return(360-b%360)%360}return 0};Script.prototype.blockMotionMotorOnFor=function(b){console.log("unimplemented blockMotorOnFor:"+this.evaluateExpression(b[0]));this.yield();return false};Script.prototype.blockMotionMotorOn=function(){console.log("unimplemented blockMotorOn");this.yield();return false};
Script.prototype.blockMotionMotorOn=function(){console.log("unimplemented blockMotorOff");this.yield();return false};Script.prototype.blockMotionMotorPower=function(b){console.log("unimplemented blockMotorPower:"+this.evaluateExpression(b[0]));this.yield();return false};Script.prototype.blockMotionMotorDirection=function(b){console.log("unimplemented blockMotorDirection:"+this.evaluateExpression(b[0]));this.yield();return false};
Script.prototype.registerAnimationDone=function(){if(this.scriptId){for(var b=false,c=0;c<Runtime.animationTriggers.length;c++)if(Runtime.animationTriggers[c]==this){b=true;break}b||Runtime.animationTriggers.push(this)}else{this.scriptId=Runtime.getScriptId();this.scriptBlock.scriptid=this.scriptId;Runtime.animationTriggers.push(this)}return false};Script.prototype.blockAnimationSimpleMoveBy=function(b){return this.blockAnimationMoveBy([b[2],b[0],b[1],null,b[3]])};
Script.prototype.blockAnimationMoveBy=function(b){if(this.sprite.spriteObj){this.dirty();var c=parseFloat(this.evaluateExpression(b[0]))*1E3;if(c>0){c={animation:"moveBy",name:this.evaluateExpression(b[4]),startTime:0,timeout:c,lastX:0,lastY:0,deltaX:parseFloat(this.evaluateExpression(b[1])),deltaY:parseFloat(this.evaluateExpression(b[2])),easing:Easing.easeLinear};b=this.evaluateExpression(b[3]);if(Easing[b])c.easing=Easing[b];this.sprite.addAnimation(c)}}};
Script.prototype.blockAnimationSimpleMoveTo=function(b){return this.blockAnimationMoveTo([b[2],b[0],b[1],null,b[3]])};
Script.prototype.blockAnimationMoveTo=function(b){if(this.sprite.spriteObj){this.dirty();var c=parseFloat(this.evaluateExpression(b[0]))*1E3;if(c>0){c={animation:"moveTo",name:this.evaluateExpression(b[4]),startTime:0,timeout:c,origPosX:this.sprite.spriteObj.x,origPosY:this.sprite.spriteObj.y,finalPosX:Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[1])),finalPosY:Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[2])),easing:Easing.easeLinear};b=this.evaluateExpression(b[3]);
if(Easing[b])c.easing=Easing[b];this.sprite.addAnimation(c)}}};Script.prototype.blockAnimationSimpleScaleBy=function(b){return this.blockAnimationScaleBy([b[1],b[0],null,b[2]])};
Script.prototype.blockAnimationScaleBy=function(b){if(this.sprite.spriteObj){this.dirty();var c=parseFloat(this.evaluateExpression(b[0]))*1E3;if(c>0){c={animation:"scaleTo",name:this.evaluateExpression(b[3]),startTime:0,timeout:c,origScale:this.sprite.spriteObj.scale.x,finalScale:this.sprite.spriteObj.scale.x+parseFloat(this.evaluateExpression(b[1]))/100,easing:Easing.easeLinear};b=this.evaluateExpression(b[2]);if(Easing[b])c.easing=Easing[b];this.sprite.addAnimation(c)}}};
Script.prototype.blockAnimationSimpleScaleTo=function(b){return this.blockAnimationScaleTo([b[1],b[0],null,b[2]])};
Script.prototype.blockAnimationScaleTo=function(b){if(this.sprite.spriteObj){this.dirty();var c=parseFloat(this.evaluateExpression(b[0]))*1E3;if(c>0){c={animation:"scaleTo",name:this.evaluateExpression(b[3]),startTime:0,timeout:c,origScale:this.sprite.spriteObj.scale.x,finalScale:parseFloat(this.evaluateExpression(b[1]))/100,easing:Easing.easeLinear};if(c.finalScale<1.0E-4)c.finalScale=1.0E-4;b=this.evaluateExpression(b[2]);if(Easing[b])c.easing=Easing[b];this.sprite.addAnimation(c)}}};
Script.prototype.blockAnimationSimpleRotateBy=function(b){return this.blockAnimationRotateBy([b[1],b[0],null,b[2]])};Script.prototype.blockAnimationRotateBy=function(b){var c=parseFloat(this.evaluateExpression(b[0]))*1E3;if(c>0){c={animation:"rotateBy",name:this.evaluateExpression(b[3]),startTime:0,timeout:c,origAngle:this.sprite.spriteObj.rotation,deltaAngle:parseFloat(this.evaluateExpression(b[1])),easing:Easing.easeLinear};b=this.evaluateExpression(b[2]);if(Easing[b])c.easing=Easing[b];this.sprite.addAnimation(c)}};
Script.prototype.blockAnimationSimpleRotateTo=function(b){return this.blockAnimationRotateTo([b[1],b[0],null,b[2]])};
Script.prototype.blockAnimationRotateTo=function(b){if(this.sprite.spriteObj){this.dirty();var c=parseFloat(this.evaluateExpression(b[0]))*1E3;if(c>0){c={animation:"rotateBy",name:this.evaluateExpression(b[3]),startTime:0,timeout:c,origAngle:this.sprite.spriteObj.rotation,deltaAngle:parseFloat(this.evaluateExpression(b[1])),easing:Easing.easeLinear};b=this.evaluateExpression(b[2]);if(Easing[b])c.easing=Easing[b];c.origAngle=c.origAngle>0?c.origAngle%360:c.origAngle%-360;c.deltaAngle=(c.deltaAngle-
c.origAngle)%360;this.sprite.addAnimation(c)}}};Script.prototype.blockAnimationSimpleBezierBy=function(b){return this.blockAnimationBezierBy([b[6],b[0],b[1],b[2],b[3],b[4],b[5],null,b[7]])};
Script.prototype.blockAnimationBezierBy=function(b){var c=parseFloat(this.evaluateExpression(b[0]))*1E3;if(c>0){c={animation:"bezierTo",name:this.evaluateExpression(b[8]),startTime:0,timeout:c,sX:this.sprite.spriteObj.x,sY:this.sprite.spriteObj.y,eX:this.sprite.spriteObj.x+parseFloat(this.evaluateExpression(b[1])),eY:this.sprite.spriteObj.y-parseFloat(this.evaluateExpression(b[2])),c1X:this.sprite.spriteObj.x+parseFloat(this.evaluateExpression(b[3])),c1Y:this.sprite.spriteObj.y-parseFloat(this.evaluateExpression(b[4])),
c2X:this.sprite.spriteObj.x+parseFloat(this.evaluateExpression(b[5])),c2Y:this.sprite.spriteObj.y-parseFloat(this.evaluateExpression(b[6])),easing:Easing.easeLinear};b=this.evaluateExpression(b[7]);if(Easing[b])c.easing=Easing[b];this.sprite.addAnimation(c)}};Script.prototype.blockAnimationSimpleBezierTo=function(b){return this.blockAnimationBezierTo([b[6],b[0],b[1],b[2],b[3],b[4],b[5],null,b[7]])};
Script.prototype.blockAnimationBezierTo=function(b){if(this.sprite.spriteObj){this.dirty();var c=parseFloat(this.evaluateExpression(b[0]))*1E3;if(c>0){c={animation:"bezierTo",name:this.evaluateExpression(b[8]),startTime:0,timeout:c,sX:this.sprite.spriteObj.x,sY:this.sprite.spriteObj.y,eX:Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[1])),eY:Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[2])),c1X:Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[3])),
c1Y:Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[4])),c2X:Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[5])),c2Y:Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[6])),easing:Easing.easeLinear};b=this.evaluateExpression(b[7]);if(Easing[b])c.easing=Easing[b];this.sprite.addAnimation(c)}}};Script.prototype.blockAnimationSimpleEffectBy=function(b){return this.blockAnimationEffectBy([b[2],b[0],b[1],null,b[3]])};
Script.prototype.blockAnimationEffectBy=function(b){var c=parseFloat(this.evaluateExpression(b[0]))*1E3;if(c>0){var d=0,e=this.evaluateExpression(b[1]);e=="ghost"&&(e="opacity");var f=this.sprite.getFilter(e);if(f)d=f.options.value;c={animation:"effectTo",name:this.evaluateExpression(b[4]),startTime:0,timeout:c,filter:e,origValue:d,finalValue:d+parseFloat(this.evaluateExpression(b[2])),easing:Easing.easeLinear};b=this.evaluateExpression(b[3]);if(Easing[b])c.easing=Easing[b];this.sprite.addAnimation(c)}};
Script.prototype.blockAnimationSimpleEffectTo=function(b){return this.blockAnimationEffectTo([b[2],b[0],b[1],null,b[3]])};
Script.prototype.blockAnimationEffectTo=function(b){var c=parseFloat(this.evaluateExpression(b[0]))*1E3;if(c>0){var d=0,e=this.evaluateExpression(b[1]);e=="ghost"&&(e="opacity");var f=this.sprite.getFilter(e);if(f)d=f.options.value;c={animation:"effectTo",name:this.evaluateExpression(b[4]),startTime:0,timeout:c,filter:e,origValue:d,finalValue:parseFloat(this.evaluateExpression(b[2])),easing:Easing.easeLinear};b=this.evaluateExpression(b[3]);if(Easing[b])c.easing=Easing[b];this.sprite.addAnimation(c)}};
Script.prototype.blockAnimationAnimate=function(b){return this.blockAnimationSwitchCostume([b[2],b[1],b[0],null,b[3]])};
Script.prototype.blockAnimationSwitchCostume=function(b){if(this.sprite.spriteObj){this.dirty();var c=parseFloat(this.evaluateExpression(b[0]))*1E3,c={animation:"costume",name:this.evaluateExpression(b[4]),startTime:0,timeout:c,fps:parseFloat(this.evaluateExpression(b[1])),costumePrefix:this.evaluateExpression(b[2]),numCostumes:0,lastFrame:0,easing:Easing.easeLinear},b=this.evaluateExpression(b[3]);if(Easing[b])c.easing=Easing[b];var d=false;if(this.sprite.skeleton.skeletonData)for(var e=this.sprite.skeleton.skeletonData.animations,
b=0;b<e.length;b++)if(e[b].name==c.costumePrefix){c.numCostumes=-1;d=true;break}if(!d){d=this.sprite.getCostumes();for(b=0;b<d.length;b++)d[b].name.indexOf(c.costumePrefix)===0&&c.numCostumes++}this.sprite.addAnimation(c)}};Script.prototype.blockAnimationSetSpeed=function(b){this.sprite.animationSpeed=parseInt(this.evaluateExpression(b[0]))*30/100};
Script.prototype.blockAnimationSimpleSwitchCostume=function(b){if(this.sprite.spriteObj){this.dirty();var b={animation:"costume",name:null,startTime:0,timeout:-1E3,fps:this.sprite.animationSpeed,costumePrefix:this.evaluateExpression(b[0]),numCostumes:0,lastFrame:0,easing:Easing.easeLinear},c=false;if(this.sprite.skeleton.skeletonData)for(var d=this.sprite.skeleton.skeletonData.animations,e=0;e<d.length;e++)if(d[e].name==b.costumePrefix){b.numCostumes=-1;b.timeout=d[e].duration*3E4/b.fps;c=true;break}if(!c){c=
this.sprite.getCostumes();for(e=0;e<c.length;e++)c[e].name.indexOf(b.costumePrefix)===0&&b.numCostumes++;b.timeout=b.numCostumes*1E3/b.fps}this.sprite.addAnimation(b)}};
Script.prototype.blockAnimationSimpleSwitchCostumeAndWait=function(b){if(this.sprite.spriteObj){this.dirty();this.yield();if(this.data==null){var b=this.evaluateExpression(b[0]),c=false;if(this.sprite.skeleton.skeletonData)for(var d=this.sprite.skeleton.skeletonData.animations,e=0;e<d.length;e++)if(d[e].name==b){for(var c=true,f=0;f<this.sprite.animations.length;f++){var g=this.sprite.animations[f];g.animation=="costume"&&this.sprite.removeAnimation(g)}this.data={startTime:Date.now(),timeout:d[e].duration*
3E4/this.sprite.animationSpeed,numCostumes:-1,costumePrefix:b};this.sprite.skeleton.lastTime=this.data.startTime;this.sprite.setCostumeByName(b);break}if(!c){c=0;d=this.sprite.getCostumes();for(e=0;e<d.length;e++)d[e].name.indexOf(b)===0&&c++;this.data={startTime:Date.now(),timeout:c*1E3/this.sprite.animationSpeed,numCostumes:c,costumePrefix:b}}return this.skipArgCompute=true}b=this.data;e=Date.now()-b.startTime;if(e<b.timeout&&this.sprite.skeleton.animationName==b.costumePrefix){if(this.sprite.skeleton.skeletonData&&
!this.sprite.spriteObj.isImage()){this.sprite.updateSkeleton();this.sprite.setCostumeByName(b.costumePrefix)}else{e=Math.floor(this.sprite.animationSpeed/1E3*e);if(e!=b.lastFrame){this.sprite.nextCostumeInGroup(b.costumePrefix,(e-b.lastFrame-1)%b.numCostumes);b.lastFrame=e}}return this.skipArgCompute=true}}return false};
Script.prototype.valueLooksGetCharacterPart=function(b){if(this.sprite.skeleton.state){b=this.evaluateExpression(b[0]);if(b=="All"){if(this.sprite.skeleton.type&&this.sprite.skeleton.parts)return{type:this.sprite.skeleton.type,parts:this.sprite.skeleton.parts}}else if(b=="type"){if(this.sprite.skeleton.type&&this.sprite.skeleton.parts)return this.sprite.skeleton.type}else{var c=g_parts[this.sprite.skeleton.type];c.macros[b]&&(b=c.macros[b][0]);var d;this.sprite.skeleton.showParts&&(d=this.sprite.skeleton.showParts[b]);
d||(d=this.sprite.skeleton.parts[b]);if(d)return d}}return"blank"};
Script.prototype.blockLooksSetCharacterPart=function(b){if(this.sprite.skeleton.state){var c=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);if(c=="All"&&b&&b.type&&b.parts)this.sprite.loadSkeleton(b.type,b.parts);else{var d=g_parts[this.sprite.skeleton.type].macros[c];d||(d=[c]);for(var e=0;e<d.length;e++){var c=d[e],f=g_parts[this.sprite.skeleton.type].options[c];if(f&&f.indexOf(b)>=0){var g=this.sprite;if(f=g_parts[g.skeleton.type].parts[c]){if(!g.skeleton.showParts)g.skeleton.showParts={};
g.skeleton.showParts[c]=b;if(b=="blank")for(c=0;c<f.length;c++){var h=new Image;h.onload=function(){g.updateSkeleton();Runtime.stage.draw()};h.src=Sprites._blankImg;g.skeleton.textures[f[c]]=h}else for(c=0;c<f.length;c++){h=new Image;h.onload=function(){g.updateSkeleton();Runtime.stage.draw()};h.src="ide/avatar/skins/"+this.sprite.skeleton.type+"/"+b+"/"+f[c]+".png";g.skeleton.textures[f[c]]=h}}}else if(b=="reset"){g=this.sprite;delete g.skeleton.showParts;if(f=g_parts[g.skeleton.type].parts[c]){var j=
g.skeleton.parts[c];if(j=="blank")for(c=0;c<f.length;c++){h=new Image;h.onload=function(){g.updateSkeleton();Runtime.stage.draw()};h.src=Sprites._blankImg;g.skeleton.textures[f[c]]=h}else for(c=0;c<f.length;c++){h=new Image;h.onload=function(){g.updateSkeleton();Runtime.stage.draw()};h.src="ide/avatar/skins/"+this.sprite.skeleton.type+"/"+j+"/"+f[c]+".png";g.skeleton.textures[f[c]]=h}}}else{g=this.sprite;if(f=g_parts[g.skeleton.type].parts[c])for(c=0;c<f.length;c++){h=new Image;h.onload=function(){g.updateSkeleton();
Runtime.stage.draw()};h.src=Sprites._blankImg;g.skeleton.textures[f[c]]=h}}}}}};Script.prototype.blockAnimationWaitFor=function(b){this.yield();b=this.evaluateExpression(b[0]);return b=="all"&&this.sprite.getNumAnimations()>0||this.sprite.getNumAnimations(b)>0?true:false};
Script.prototype.valueAnimationTime=function(b){b=this.evaluateExpression(b[0]);if(this.sprite.skeleton.skeletonData)for(var c=this.sprite.skeleton.skeletonData.animations,d=0;d<c.length;d++)if(c[d].name==b)return c[d].duration*30/this.sprite.animationSpeed;for(var c=0,e=this.sprite.getCostumes(),d=0;d<e.length;d++)e[d].name.indexOf(b)===0&&c++;return c/this.sprite.animationSpeed};
Script.prototype.valueAnimationIsRunning=function(b){b=this.evaluateExpression(b[0]);return(b=="all"||b=="any")&&this.sprite.getNumAnimations()>0||this.sprite.getNumAnimations(b)>0?true:false};
Script.prototype.blockAnimationStop=function(b){var c=this.evaluateExpression(b[0]);if(c=="all"){c={};for(b=this.sprite.animations.length-1;b>=0;b--){var d=this.sprite.animations[b];c[d.name]=true}this.sprite.animations.length=0;for(var e in c)Runtime.triggerAnimationDone(e,this.sprite)}else{e=0;for(b=this.sprite.animations.length-1;b>=0;b--){d=this.sprite.animations[b];if(d.name==c){this.sprite.removeAnimation(d);e++}}e>0&&Runtime.triggerAnimationDone(c,this.sprite)}return false};
Sprite.prototype.animateMoveBy=function(b){var c=this.spriteObj.x,d=this.spriteObj.y;if(!b.startTime)b.startTime=Date.now();var e=Date.now()-b.startTime;if(e<b.timeout){var f=b.easing(e,0,b.deltaX,b.timeout),e=b.easing(e,0,b.deltaY,b.timeout);this.spriteObj.setPosition(c+(f-b.lastX),d-(e-b.lastY));b.lastX=f;b.lastY=e;if(this.penDown){b=Runtime.stage.penLayer.context;b.save();b.beginPath();b.strokeStyle=this.penColor;b.lineWidth=this.penWidth;b.lineCap="round";b.moveTo(c,d);b.lineTo(this.spriteObj.x,
this.spriteObj.y);b.stroke();b.closePath();b.restore()}return false}f=b.deltaX-b.lastX;e=b.deltaY-b.lastY;this.spriteObj.setPosition(c+f,d-e);this.removeAnimation(b.name);if(this.penDown){b=Runtime.stage.penLayer.context;b.save();b.beginPath();b.strokeStyle=this.penColor;b.lineWidth=this.penWidth;b.lineCap="round";b.moveTo(c,d);b.lineTo(this.spriteObj.x,this.spriteObj.y);b.stroke();b.closePath();b.restore()}return true};
Sprite.prototype.animateMoveTo=function(b){var c=this.spriteObj.x,d=this.spriteObj.y;if(!b.startTime)b.startTime=Date.now();var e=Date.now()-b.startTime;if(e<b.timeout){var f=b.origPosX;b.finalPosX!=f&&(f=b.easing(e,f,b.finalPosX-f,b.timeout));var g=b.origPosY;b.finalPosY!=g&&(g=b.easing(e,g,b.finalPosY-g,b.timeout));this.spriteObj.setPosition(f,g);if(this.penDown){b=Runtime.stage.penLayer.context;b.save();b.beginPath();b.strokeStyle=this.penColor;b.lineWidth=this.penWidth;b.lineCap="round";b.moveTo(c,
d);b.lineTo(f,g);b.stroke();b.closePath();b.restore()}return false}f=b.finalPosX;g=b.finalPosY;this.spriteObj.setPosition(b.finalPosX,b.finalPosY);this.removeAnimation(b.name);if(this.penDown){b=Runtime.stage.penLayer.context;b.save();b.beginPath();b.strokeStyle=this.penColor;b.lineWidth=this.penWidth;b.lineCap="round";b.moveTo(c,d);b.lineTo(f,g);b.stroke();b.closePath();b.restore()}return true};
Sprite.prototype.animateScaleTo=function(b){if(!b.startTime)b.startTime=Date.now();var c=Date.now()-b.startTime;if(c<b.timeout){var d=b.origScale;if(b.finalScale!=d){d=b.easing(c,d,b.finalScale-d,b.timeout);this.spriteObj.setScale(d)}return false}this.spriteObj.setScale(b.finalScale);return true};
Sprite.prototype.animateRotateBy=function(b){if(!b.startTime)b.startTime=Date.now();var c=Date.now()-b.startTime;if(c<b.timeout){var d=b.origAngle;if(b.deltaAngle!=0){d=b.easing(c,d,b.deltaAngle,b.timeout);this.spriteObj.setRotation(d)}return false}this.spriteObj.setRotation(b.origAngle+b.deltaAngle);return true};function bezierAt(b,c,d,e,f){return Math.pow(1-f,3)*b+3*f*Math.pow(1-f,2)*c+3*Math.pow(f,2)*(1-f)*d+Math.pow(f,3)*e}
Sprite.prototype.animateBezierTo=function(b){if(!b.startTime)b.startTime=Date.now();var c=Date.now()-b.startTime;if(c<b.timeout){var d=this.spriteObj.x,e=this.spriteObj.y,f=b.easing(c,0,1,b.timeout),g=bezierAt(b.sX,b.c1X,b.c2X,b.eX,f),f=bezierAt(b.sY,b.c1Y,b.c2Y,b.eY,f);this.spriteObj.setPosition(g,f);if(this.penDown){b=Runtime.stage.penLayer.context;b.save();b.beginPath();b.strokeStyle=this.penColor;b.lineWidth=this.penWidth;b.lineCap="round";b.moveTo(d,e);b.lineTo(g,f);b.stroke();b.closePath();
b.restore()}return false}this.spriteObj.setPosition(b.eX,b.eY);if(this.penDown){b=Runtime.stage.penLayer.context;b.save();b.beginPath();b.strokeStyle=this.penColor;b.lineWidth=this.penWidth;b.lineCap="round";b.moveTo(d,e);b.lineTo(g,f);b.stroke();b.closePath();b.restore()}return true};
Sprite.prototype.animateEffectTo=function(b){if(!b.startTime)b.startTime=Date.now();var c=Date.now()-b.startTime;if(c<b.timeout){var d=0,e=this.getFilter(b.filter);if(e)d=e.options.value;e=b.origValue;if(b.finalValue!=d){e=b.easing(c,e,b.finalValue-e,b.timeout);_doBlockLooksSetEffect(this,b.filter,e)}return false}_doBlockLooksSetEffect(this,b.filter,b.finalValue);return true};
Sprite.prototype.animateSwitchCostume=function(b){if(!b.startTime){b.startTime=Date.now();this.skeleton.lastTime=b.startTime}var c=Date.now()-b.startTime;if(b.timeout<0||c<b.timeout){this.animationSpeed=b.fps;if(this.skeleton.skeletonData&&!this.spriteObj.isImage()){this.updateSkeleton();this.setCostumeByName(b.costumePrefix)}else{c=Math.floor(this.animationSpeed/1E3*c);if(c!=b.lastFrame){this.nextCostumeInGroup(b.costumePrefix,(c-b.lastFrame-1)%b.numCostumes);b.lastFrame=c}}return false}return true};
var Easing={easeLinear:function(b,c,d,e){return d*(b/e)+c},easeInQuad:function(b,c,d,e){return d*(b=b/e)*b+c},easeOutQuad:function(b,c,d,e){return-d*(b=b/e)*(b-2)+c},easeInOutQuad:function(b,c,d,e){return(b=b/(e/2))<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(b,c,d,e){return d*(b=b/e)*b*b+c},easeOutCubic:function(b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(b,c,d,e){return(b=b/(e/2))<1?d/2*b*b*b+c:d/2*((b=b-2)*b*b+2)+c},easeInQuart:function(b,c,d,e){return d*(b=b/e)*b*
b*b+c},easeOutQuart:function(b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(b,c,d,e){return(b=b/(e/2))<1?d/2*b*b*b*b+c:-d/2*((b=b-2)*b*b*b-2)+c},easeInQuint:function(b,c,d,e){return d*(b=b/e)*b*b*b*b+c},easeOutQuint:function(b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(b,c,d,e){return(b=b/(e/2))<1?d/2*b*b*b*b*b+c:d/2*((b=b-2)*b*b*b*b+2)+c},easeInSine:function(b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(b,c,d,e){return d*Math.sin(b/
e*(Math.PI/2))+c},easeInOutSine:function(b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExponential:function(b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExponential:function(b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExponential:function(b,c,d,e){return b==0?c:b==e?c+d:(b=b/(e/2))<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(b,c,d,e){return-d*(Math.sqrt(1-(b=b/e)*b)-1)+c},easeOutCirc:function(b,c,d,e){return d*Math.sqrt(1-
(b=b/e-1)*b)+c},easeInOutCirc:function(b,c,d,e){return(b=b/(e/2))<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b=b-2)*b)+1)+c},easeInElastic:function(b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b=b/e)==1)return c+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;f=g/4}else f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b=b-1))*Math.sin((b*e-f)*2*Math.PI/g))+c},easeOutElastic:function(b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b=b/e)==1)return c+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;
f=g/4}else f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*2*Math.PI/g)+d+c},easeInOutElastic:function(b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b=b/(e/2))==2)return c+d;g||(g=e*0.3*1.5);if(h<Math.abs(d)){h=d;f=g/4}else f=g/(2*Math.PI)*Math.asin(d/h);return b<1?-0.5*h*Math.pow(2,10*(b=b-1))*Math.sin((b*e-f)*2*Math.PI/g)+c:h*Math.pow(2,-10*(b=b-1))*Math.sin((b*e-f)*2*Math.PI/g)*0.5+d+c},easeInBack:function(b,c,d,e,f){f==void 0&&(f=1.70158);return d*(b=b/e)*b*((f+
1)*b-f)+c},easeOutBack:function(b,c,d,e,f){f==void 0&&(f=1.70158);return d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(b,c,d,e,f){f==void 0&&(f=1.70158);return(b=b/(e/2))<1?d/2*b*b*(((f=f*1.525)+1)*b-f)+c:d/2*((b=b-2)*b*(((f=f*1.525)+1)*b+f)+2)+c},easeInBounce:function(b,c,d,e){return d-Easing.easeOutBounce(e-b,0,d,e)+c},easeOutBounce:function(b,c,d,e){return(b=b/e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b=b-1.5/2.75)*b+0.75)+c:b<2.5/2.75?d*(7.5625*(b=b-2.25/2.75)*b+0.9375)+c:d*(7.5625*
(b=b-2.625/2.75)*b+0.984375)+c},easeInOutBounce:function(b,c,d,e){return b<e/2?Easing.easeInBounce(b*2,0,d,e)*0.5+c:Easing.easeOutBounce(b*2-e,0,d,e)*0.5+d*0.5+c}};Script.prototype.valueOpAdd=function(b){return valueToNative(this.evaluateExpression(b[0]))+valueToNative(this.evaluateExpression(b[1]))};Script.prototype.valueOpSubtract=function(b){return coerceToNumber(this.evaluateExpression(b[0]))-coerceToNumber(this.evaluateExpression(b[1]))};
Script.prototype.valueOpMultiply=function(b){return coerceToNumber(this.evaluateExpression(b[0]))*coerceToNumber(this.evaluateExpression(b[1]))};Script.prototype.valueOpDivide=function(b){return coerceToNumber(this.evaluateExpression(b[0]))/coerceToNumber(this.evaluateExpression(b[1]))};
Script.prototype.valueOpRandom=function(b){var c=coerceToNumber(this.evaluateExpression(b[0])),b=coerceToNumber(this.evaluateExpression(b[1]));if(c>b)var d=c,c=b,b=d;return Math.floor(c)==c&&Math.floor(b)==b?Math.floor(Math.random()*(b-c+1)+c):Math.random()*(b-c)+c};Script.prototype.valueOpLess=function(b){return this.evaluateExpression(b[0])<this.evaluateExpression(b[1])};Script.prototype.valueOpEqual=function(b){return this.evaluateExpression(b[0])==this.evaluateExpression(b[1])};
Script.prototype.valueOpGreater=function(b){return this.evaluateExpression(b[0])>this.evaluateExpression(b[1])};Script.prototype.valueOpAnd=function(b){return this.evaluateExpression(b[0])&&this.evaluateExpression(b[1])};Script.prototype.valueOpOr=function(b){return this.evaluateExpression(b[0])||this.evaluateExpression(b[1])};Script.prototype.valueOpNot=function(b){return!this.evaluateExpression(b[0])};Script.prototype.valueOpBitNot=function(b){return~parseInt(this.evaluateExpression(b[0]))};
Script.prototype.valueOpJoin=function(b){for(var c="",d=0;d<b.length;d++)c=c+ifArrayMakeString(this.evaluateExpression(b[d]));return c};Script.prototype.valueOpLetter=function(b){var c=Math.floor(coerceToNumber(this.evaluateExpression(b[0]))),b=""+ifArrayMakeString(this.evaluateExpression(b[1]));return c-1<0||c>b.length?"":b.charAt(c-1)};Script.prototype.valueOpLength=function(b){var b=this.evaluateExpression(b[0]),c=(""+ifArrayMakeString(b)).length;if(c===0)c=(""+b).length;return c};
Script.prototype.valueOpMod=function(b){return Math.floor(coerceToNumber(this.evaluateExpression(b[0])))%Math.floor(coerceToNumber(this.evaluateExpression(b[1])))};Script.prototype.valueOpRound=function(b){return Math.round(coerceToNumber(this.evaluateExpression(b[0])))};
Script.prototype.valueOpMath=function(b){var c=coerceToNumber(this.evaluateExpression(b[1]));switch(this.evaluateExpression(b[0])){case "abs":return Math.abs(c);case "floor":return Math.floor(c);case "ceiling":return Math.ceil(c);case "round":return Math.round(c);case "int":return parseInt(c);case "sqrt":return Math.sqrt(c);case "sin":return Math.sin(c*Math.PI/180);case "cos":return Math.cos(c*Math.PI/180);case "tan":return Math.tan(c*Math.PI/180);case "asin":return Math.asin(c)*180/Math.PI;case "acos":return Math.acos(c)*
180/Math.PI;case "atan":return Math.atan(c)*180/Math.PI;case "sinrad":return Math.sin(c);case "cosrad":return Math.cos(c);case "tanrad":return Math.tan(c);case "asinrad":return Math.asin(c);case "acosrad":return Math.acos(c);case "atanrad":return Math.atan(c);case "ln":return Math.log(c);case "log":return Math.log(c)/Math.LN10;case "e^":return Math.pow(Math.E,c);case "10^":return Math.pow(10,c);case "sign":return c<0?-1:c>0?1:0}return 0};
Script.prototype.valueOpMath2=function(b){var c=coerceToNumber(this.evaluateExpression(b[1])),d=coerceToNumber(this.evaluateExpression(b[2]));switch(this.evaluateExpression(b[0])){case "atan2":return Math.atan2(c,d)*180/Math.PI;case "atan2rad":return Math.atan2(c,d);case "max":return Math.max(c,d);case "min":return Math.min(c,d);case "pow":return Math.pow(c,d)}return 0};
Script.prototype.valueOpConstants=function(b){switch(this.evaluateExpression(b[0])){case "pi":return Math.PI;case "e":return Math.E;case "ln2":return Math.LN2;case "ln10":return Math.LN10;case "log2e":return Math.LOG2E;case "log10e":return Math.LOG10E;case "sqrt1/2":return Math.SQRT1_2;case "sqrt2":return Math.SQRT2}return 0};
Script.prototype.valueOpBinary=function(b){var c=this.evaluateExpression(b[0]),d=this.evaluateExpression(b[1]),b=this.evaluateExpression(b[2]);switch(d){case "+":return valueToNative(c)+valueToNative(b);case "-":return coerceToNumber(c)-coerceToNumber(b);case "*":return coerceToNumber(c)*coerceToNumber(b);case "/":return coerceToNumber(c)/coerceToNumber(b);case "%":case "mod":return Math.floor(coerceToNumber(c))%Math.floor(coerceToNumber(b));case "=":case "==":return c==b;case "<":return c<b;case "<=":return c<=
b;case ">":return c>b;case ">=":return c>=b;case "!=":return c!=b;case "&":return parseInt(c)&parseInt(b);case "&&":case "and":return c&&b;case "|":return parseInt(c)|parseInt(b);case "||":case "or":return c||b;case "^":case "xor":return parseInt(c)^parseInt(b);case "<<":return parseInt(c)<<parseInt(b);case ">>":return parseInt(c)>>parseInt(b);case ">>>":return parseInt(c)>>parseInt(b)}};Script.prototype.valueOpExpression=function(b){return this.evaluateExpression(b[0])};
Script.prototype.valueOpTextSplit=function(b){var c=""+this.evaluateExpression(b[0]),b=""+this.evaluateExpression(b[1]);return c.split(b)};Script.prototype.valueOpTextReplace=function(b){var c=""+this.evaluateExpression(b[0]),d=""+this.evaluateExpression(b[1]),b=""+this.evaluateExpression(b[2]);return c&&d&&b?d.replace(c,b):c};Script.prototype.valueOpTextIndex=function(b){var c=""+this.evaluateExpression(b[1]),b=""+this.evaluateExpression(b[0]),c=c.indexOf(b);return c>=0?c+1:-1};
Script.prototype.valueOpTextLastIndex=function(b){var c=""+this.evaluateExpression(b[1]),b=""+this.evaluateExpression(b[0]),c=c.lastIndexOf(b);return c>=0?c+1:-1};Script.prototype.valueOpTextSubstring=function(b){var c=""+this.evaluateExpression(b[0]),d=parseInt(this.evaluateExpression(b[1]))-1,b=parseInt(this.evaluateExpression(b[2]))-1;return b<d?c.substring(d):c.substring(d,b)};
Script.prototype.valueOpTextTransform=function(b){var c=this.evaluateExpression(b[0]),b=""+this.evaluateExpression(b[1]);switch(c){case "uppercase":b=b.toUpperCase();break;case "lowercase":b=b.toLowerCase();break;case "trim":b=b.trim();case "parse":try{b=JSON.parse(b)}catch(d){try{var b={},e=$($.parseXML(data));_parseXml(obj,e)}catch(f){}}}return b};Script.prototype.valueOpTextFormat=function(b){for(var c=0;c<b.length;c++)b[c]=this.evaluateExpression(b[c]);return formatText.apply(null,b)};
Script.prototype.registerDraw=function(){if(this.scriptId){for(var b=false,c=0;c<Runtime.drawTriggers.length;c++)if(Runtime.drawTriggers[c]==this){b=true;break}if(!b){this.isDrawEvent=true;Runtime.drawTriggers.push(this)}}else{this.scriptId=Runtime.getScriptId();this.scriptBlock.scriptid=this.scriptId;this.isDrawEvent=this.sprite!=Runtime.background;Runtime.drawTriggers.push(this)}return false};Script.prototype.blockPenRedraw=function(){Runtime.redrawSprite(null);return false};
Script.prototype.blockPenClear=function(){Runtime.stage.penLayer.clear();return false};Script.prototype.blockPenDown=function(){if(this.sprite.spriteObj){this.sprite.penDown=true;var b=Runtime.stage.penLayer.context;b.save();b.beginPath();b.strokeStyle=this.sprite.penColor;b.lineWidth=this.sprite.penWidth;b.lineCap="round";b.moveTo(this.sprite.spriteObj.x,this.sprite.spriteObj.y);b.lineTo(this.sprite.spriteObj.x+0.1,this.sprite.spriteObj.y);b.stroke();b.closePath();b.restore()}return false};
Script.prototype.blockPenUp=function(){if(this.sprite.spriteObj)this.sprite.penDown=false;return false};Script.prototype.blockPenSetColor=function(b){b=getColorComponents(this.evaluateExpression(b[0]));this.sprite.penColor=b[0];if(this.sprite.spriteObj)this.sprite.spriteObj.penColor=b[0];this.sprite.penHue=b[1];this.sprite.penShade=b[2];return false};
Script.prototype.blockPenChangeHue=function(b){this.sprite.penHue=(this.sprite.penHue+parseFloat(this.evaluateExpression(b[0])))%200;if(this.sprite.penHue<0)this.sprite.penHue=200+this.sprite.penHue;if(!this.sprite.penShade)this.sprite.penShade=0;this.blockPenSetShade([this.sprite.penShade]);return false};
Script.prototype.blockPenSetHue=function(b){this.sprite.penHue=parseFloat(this.evaluateExpression(b[0]))%200;if(this.sprite.penHue<0)this.sprite.penHue=200+this.sprite.penHue;if(!this.sprite.penShade)this.sprite.penShade=0;this.blockPenSetShade([this.sprite.penShade]);return false};Script.prototype.blockPenChangeShade=function(b){if(!this.sprite.penShade)this.sprite.penShade=0;this.blockPenSetShade([this.sprite.penShade+parseFloat(this.evaluateExpression(b[0]))]);return false};
Script.prototype.blockPenSetShade=function(b){if(this.sprite.penHue==0){this.sprite.penShade=parseFloat(this.evaluateExpression(b[0]))%200;b=parseInt(this.sprite.penShade/200*256);b=b.toString(16);b.length<2&&(b="0"+b);this.sprite.penColor="#"+b+b+b}else{this.sprite.penShade=parseFloat(this.evaluateExpression(b[0]))%200;if(this.sprite.penShade<0)this.sprite.penShade=200+this.sprite.penShade;b=this.sprite.penShade>100?200-this.sprite.penShade:this.sprite.penShade;b=b<=50?hsvToRgb(this.sprite.penHue/
200,1,(b+10)/60):hsvToRgb(this.sprite.penHue/200,(100-b+10)/60,1);b[0]=Math.floor(b[0]).toString(16);b[0].length<2&&(b[0]="0"+b[0]);b[1]=Math.floor(b[1]).toString(16);b[1].length<2&&(b[1]="0"+b[1]);b[2]=Math.floor(b[2]).toString(16);b[2].length<2&&(b[2]="0"+b[2]);this.sprite.penColor="#"+b[0]+b[1]+b[2]}if(this.sprite.spriteObj)this.sprite.spriteObj.penColor=this.sprite.penColor;return false};
Script.prototype.blockPenChangeSize=function(b){this.sprite.penWidth=this.sprite.penWidth+parseFloat(this.evaluateExpression(b[0]));if(this.sprite.penWidth<1)this.sprite.penWidth=1;if(this.sprite.spriteObj)this.sprite.spriteObj.penWidth=this.sprite.penWidth;return false};
Script.prototype.blockPenSetSize=function(b){this.sprite.penWidth=parseFloat(this.evaluateExpression(b[0]));if(this.sprite.penWidth<1)this.sprite.penWidth=1;if(this.sprite.spriteObj)this.sprite.spriteObj.penWidth=this.sprite.penWidth;return false};
Script.prototype.blockPenStamp=function(){if(this.sprite.spriteObj){for(var b=false,c=0;c<this.sprite.scripts.length;c++)if(this.sprite.scripts[c].func=="registerDraw"){b=true;break}if(!b){var d=this.sprite.spriteObj.visible;this.sprite.spriteObj.visible=true}c=this.sprite.spriteObj.selected;this.sprite.spriteObj.selected=false;this.sprite.spriteObj.draw(Runtime.stage.penLayer);this.sprite.spriteObj.selected=c;if(!b)this.sprite.spriteObj.visible=d}return false};
Script.prototype.blockPenSetFont=function(b){var c=parseFloat(this.evaluateExpression(b[1]));c||(c=18);var d=this.evaluateExpression(b[0]);d||(d="normal");(b=this.evaluateExpression(b[2]))||(b="Comic Sans MS,cursive");this.sprite.font=d+" "+c+"px "+b;if(this.sprite.spriteObj)this.sprite.spriteObj.font=d+" "+c+"px "+b;return false};
Script.prototype.blockPenSetFontColor=function(b){this.sprite.fontColor=this.evaluateExpression(b[0]);if(this.sprite.spriteObj)this.sprite.spriteObj.fontColor=this.sprite.fontColor;return false};
Script.prototype.blockPenDrawText=function(b){if(this.sprite.spriteObj){if(!this.sprite.font)this.sprite.font="normal 18px Comic Sans MS,cursive";var c=this.isDrawEvent?Runtime.stage.drawLayer.context:Runtime.stage.penLayer.context;c.save();var d=this.sprite.spriteObj;c.translate(d.x,d.y);d.rotation!==0&&d.rotateLock==0&&c.rotate(d.rotation*Math.PI/180);d.scale.x!=1||d.scale.y!=1?d.rotateLock==1&&d.rotation>90&&d.rotation<270?c.scale(-d.scale.x,d.scale.y):c.scale(d.scale.x,d.scale.y):d.rotateLock==
1&&(d.rotation>90&&d.rotation<270)&&c.scale(-1,1);var b=ifArrayMakeString(this.evaluateExpression(b[0])),d=c.measureText(b).width*2,e=parseFloat(this.sprite.font.split(" ")[1])*2;if(d>this.sprite.spriteObj.drawWidth)this.sprite.spriteObj.drawWidth=d;if(e>this.sprite.spriteObj.drawHeight)this.sprite.spriteObj.drawHeight=e;c.beginPath();c.strokeStyle=this.sprite.penColor;c.fillStyle=this.sprite.fontColor?this.sprite.fontColor:this.sprite.penColor;c.lineWidth=this.sprite.penWidth;c.textAlign="left";
c.font=this.sprite.font;c.fillText(b,0,0);c.closePath();c.restore()}return false};Script.prototype.blockPenSetFillColor=function(b){this.sprite.fillColor=getColorComponents(this.evaluateExpression(b[0]))[0];return false};Script.prototype.blockPenSetNoFill=function(){this.sprite.fillColor="";return false};
Script.prototype.blockPenDrawBezier=function(b){this.dirty();if(this.isDrawEvent&&this.sprite!=Runtime.background){var c=Runtime.stage.drawLayer.context;c.save();var d=this.sprite.spriteObj;c.translate(d.x,d.y);d.rotation!==0&&d.rotateLock==0&&c.rotate(d.rotation*Math.PI/180);d.scale.x!=1||d.scale.y!=1?d.rotateLock==1&&d.rotation>90&&d.rotation<270?c.scale(-d.scale.x,d.scale.y):c.scale(d.scale.x,d.scale.y):d.rotateLock==1&&(d.rotation>90&&d.rotation<270)&&c.scale(-1,1);var e=parseFloat(this.evaluateExpression(b[0])),
f=-parseFloat(this.evaluateExpression(b[1])),g=parseFloat(this.evaluateExpression(b[2])),h=-parseFloat(this.evaluateExpression(b[3])),j=parseFloat(this.evaluateExpression(b[4])),k=-parseFloat(this.evaluateExpression(b[5])),l=parseFloat(this.evaluateExpression(b[6])),b=-parseFloat(this.evaluateExpression(b[7])),m=Math.max(Math.abs(e),Math.abs(g)),n=Math.max(Math.abs(f),Math.abs(h));if(m*2>d.drawWidth)d.drawWidth=m*2;if(n*2>d.drawHeight)d.drawHeight=n*2}else{c=Runtime.stage.penLayer.context;c.save();
e=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[0]));f=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[1]));g=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[2]));h=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[3]));j=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[4]));k=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[5]));l=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[6]));b=
Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[7]))}c.strokeStyle=this.sprite.penColor;if(this.sprite.fillColor)c.fillStyle=this.sprite.fillColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.beginPath();c.moveTo(e,f);c.bezierCurveTo(j,k,l,b,g,h);this.sprite.fillColor&&c.fill();c.stroke();c.closePath();c.restore();return false};
Script.prototype.blockPenDrawPoint=function(b){this.dirty();if(this.isDrawEvent&&this.sprite!=Runtime.background){var c=Runtime.stage.drawLayer.context;c.save();var d=this.sprite.spriteObj;c.translate(d.x,d.y);d.rotation!==0&&d.rotateLock==0&&c.rotate(d.rotation*Math.PI/180);d.scale.x!=1||d.scale.y!=1?d.rotateLock==1&&d.rotation>90&&d.rotation<270?c.scale(-d.scale.x,d.scale.y):c.scale(d.scale.x,d.scale.y):d.rotateLock==1&&(d.rotation>90&&d.rotation<270)&&c.scale(-1,1);var e=parseFloat(this.evaluateExpression(b[0])),
b=-parseFloat(this.evaluateExpression(b[1])),f=Math.abs(e),g=Math.abs(b);if(f*2>d.drawWidth)d.drawWidth=f*2;if(g*2>d.drawHeight)d.drawHeight=g*2}else{c=Runtime.stage.penLayer.context;c.save();e=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[0]));b=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[1]))}c.strokeStyle=this.sprite.penColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.beginPath();c.moveTo(e,b);c.lineTo(e+1,b);c.stroke();c.closePath();c.restore();
return false};
Script.prototype.blockPenDrawLine=function(b){this.dirty();if(this.isDrawEvent&&this.sprite!=Runtime.background){var c=Runtime.stage.drawLayer.context;c.save();var d=this.sprite.spriteObj;c.translate(d.x,d.y);d.rotation!==0&&d.rotateLock==0&&c.rotate(d.rotation*Math.PI/180);d.scale.x!=1||d.scale.y!=1?d.rotateLock==1&&d.rotation>90&&d.rotation<270?c.scale(-d.scale.x,d.scale.y):c.scale(d.scale.x,d.scale.y):d.rotateLock==1&&(d.rotation>90&&d.rotation<270)&&c.scale(-1,1);var e=parseFloat(this.evaluateExpression(b[0])),f=
-parseFloat(this.evaluateExpression(b[1])),g=parseFloat(this.evaluateExpression(b[2])),b=-parseFloat(this.evaluateExpression(b[3])),h=Math.max(Math.abs(e),Math.abs(g)),j=Math.max(Math.abs(f),Math.abs(b));if(h*2>d.drawWidth)d.drawWidth=h*2;if(j*2>d.drawHeight)d.drawHeight=j*2}else{c=Runtime.stage.penLayer.context;c.save();e=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[0]));f=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[1]));g=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[2]));
b=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[3]))}c.strokeStyle=this.sprite.penColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.beginPath();c.moveTo(e,f);c.lineTo(g,b);c.stroke();c.closePath();c.restore();return false};
Script.prototype.blockPenDrawRectangle=function(b){this.dirty();if(this.isDrawEvent&&this.sprite!=Runtime.background){var c=Runtime.stage.drawLayer.context;c.save();var d=this.sprite.spriteObj;c.translate(d.x,d.y);d.rotation!==0&&d.rotateLock==0&&c.rotate(d.rotation*Math.PI/180);d.scale.x!=1||d.scale.y!=1?d.rotateLock==1&&d.rotation>90&&d.rotation<270?c.scale(-d.scale.x,d.scale.y):c.scale(d.scale.x,d.scale.y):d.rotateLock==1&&(d.rotation>90&&d.rotation<270)&&c.scale(-1,1);var e=parseFloat(this.evaluateExpression(b[0])),
f=-parseFloat(this.evaluateExpression(b[1])),g=parseFloat(this.evaluateExpression(b[2])),b=parseFloat(this.evaluateExpression(b[3])),h=Math.max(Math.abs(e),Math.abs(e+g)),j=Math.max(Math.abs(f),Math.abs(f+b));if(h*2>d.drawWidth)d.drawWidth=h*2;if(j*2>d.drawHeight)d.drawHeight=j*2}else{c=Runtime.stage.penLayer.context;c.save();e=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[0]));f=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[1]));g=parseFloat(this.evaluateExpression(b[2]));
b=parseFloat(this.evaluateExpression(b[3]))}c.strokeStyle=this.sprite.penColor;if(this.sprite.fillColor)c.fillStyle=this.sprite.fillColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.beginPath();c.rect(e,f,g,b);this.sprite.fillColor&&c.fill();c.stroke();c.closePath();c.restore();return false};
Script.prototype.blockPenClearRect=function(b){this.dirty();if(this.isDrawEvent&&this.sprite!=Runtime.background){var c=Runtime.stage.drawLayer.context;c.save();var d=this.sprite.spriteObj;c.translate(d.x,d.y);d.rotation!==0&&d.rotateLock==0&&c.rotate(d.rotation*Math.PI/180);d.scale.x!=1||d.scale.y!=1?d.rotateLock==1&&d.rotation>90&&d.rotation<270?c.scale(-d.scale.x,d.scale.y):c.scale(d.scale.x,d.scale.y):d.rotateLock==1&&(d.rotation>90&&d.rotation<270)&&c.scale(-1,1);var e=parseFloat(this.evaluateExpression(b[0])),
f=-parseFloat(this.evaluateExpression(b[1])),g=parseFloat(this.evaluateExpression(b[2])),b=parseFloat(this.evaluateExpression(b[3])),h=Math.max(Math.abs(e),Math.abs(e+g)),j=Math.max(Math.abs(f),Math.abs(f+b));if(h*2>d.drawWidth)d.drawWidth=h*2;if(j*2>d.drawHeight)d.drawHeight=j*2}else{c=Runtime.stage.penLayer.context;c.save();e=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[0]));f=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[1]));g=parseFloat(this.evaluateExpression(b[2]));
b=parseFloat(this.evaluateExpression(b[3]))}c.strokeStyle=this.sprite.penColor;if(this.sprite.fillColor)c.fillStyle=this.sprite.fillColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.beginPath();c.clearRect(e,f,g,b);c.stroke();c.closePath();c.restore();return false};
Script.prototype.blockPenDrawRectangleLocal=function(b){if(this.isDrawEvent&&this.sprite!=Runtime.background)return this.blockPenDrawRectangle([0,0,this.evaluateExpression(b[0]),this.evaluateExpression(b[1])]);this.dirty();var c=Runtime.stage.penLayer.context;c.save();var d=this.sprite.spriteObj;c.translate(d.x,d.y);c.rotate(d.rotation*Math.PI/180+Math.PI/2);d=parseFloat(this.evaluateExpression(b[0]));b=-parseFloat(this.evaluateExpression(b[1]));c.strokeStyle=this.sprite.penColor;if(this.sprite.fillColor)c.fillStyle=
this.sprite.fillColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.beginPath();c.rect(0,0,d,b);this.sprite.fillColor&&c.fill();c.stroke();c.closePath();c.restore();return false};
Script.prototype.blockPenDrawTriangle=function(b){this.dirty();if(this.isDrawEvent&&this.sprite!=Runtime.background){var c=Runtime.stage.drawLayer.context;c.save();var d=this.sprite.spriteObj;c.translate(d.x,d.y);d.rotation!==0&&d.rotateLock==0&&c.rotate(d.rotation*Math.PI/180);d.scale.x!=1||d.scale.y!=1?d.rotateLock==1&&d.rotation>90&&d.rotation<270?c.scale(-d.scale.x,d.scale.y):c.scale(d.scale.x,d.scale.y):d.rotateLock==1&&(d.rotation>90&&d.rotation<270)&&c.scale(-1,1);var e=parseFloat(this.evaluateExpression(b[0])),
f=-parseFloat(this.evaluateExpression(b[1])),g=parseFloat(this.evaluateExpression(b[2])),h=-parseFloat(this.evaluateExpression(b[3])),j=parseFloat(this.evaluateExpression(b[4])),b=-parseFloat(this.evaluateExpression(b[5])),k=Math.max(Math.abs(e),Math.max(Math.abs(g),Math.abs(j))),l=Math.max(Math.abs(f),Math.max(Math.abs(h),Math.abs(b)));if(k*2>d.drawWidth)d.drawWidth=k*2;if(l*2>d.drawHeight)d.drawHeight=l*2}else{c=Runtime.stage.penLayer.context;c.save();e=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[0]));
f=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[1]));g=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[2]));h=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[3]));j=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[4]));b=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[5]))}c.strokeStyle=this.sprite.penColor;if(this.sprite.fillColor)c.fillStyle=this.sprite.fillColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";
c.beginPath();c.moveTo(e,f);c.lineTo(g,h);c.lineTo(j,b);c.lineTo(e,f);this.sprite.fillColor&&c.fill();c.stroke();c.closePath();c.restore();return false};
Script.prototype.blockPenDrawEllipse=function(b){this.dirty();if(this.isDrawEvent&&this.sprite!=Runtime.background){var c=Runtime.stage.drawLayer.context;c.save();var d=this.sprite.spriteObj;c.translate(d.x,d.y);d.rotation!==0&&d.rotateLock==0&&c.rotate(d.rotation*Math.PI/180);d.scale.x!=1||d.scale.y!=1?d.rotateLock==1&&d.rotation>90&&d.rotation<270?c.scale(-d.scale.x,d.scale.y):c.scale(d.scale.x,d.scale.y):d.rotateLock==1&&(d.rotation>90&&d.rotation<270)&&c.scale(-1,1);var e=parseFloat(this.evaluateExpression(b[0])),
f=-parseFloat(this.evaluateExpression(b[1])),g=parseFloat(this.evaluateExpression(b[2])),b=parseFloat(this.evaluateExpression(b[3])),h=Math.max(g,b),j=Math.max(Math.abs(e-g/2),Math.abs(e+g/2)),k=Math.max(Math.abs(f-b/2),Math.abs(f+b/2));if(j*2>d.drawWidth)d.drawWidth=j*2;if(k*2>d.drawHeight)d.drawHeight=k*2}else{c=Runtime.stage.penLayer.context;c.save();e=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[0]));f=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[1]));g=
parseFloat(this.evaluateExpression(b[2]));b=parseFloat(this.evaluateExpression(b[3]));h=Math.max(g,b)}c.strokeStyle=this.sprite.penColor;if(this.sprite.fillColor)c.fillStyle=this.sprite.fillColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.translate(e,f);c.scale(g/h,b/h);c.beginPath();c.arc(0,0,h/2,0,2*Math.PI,false);c.stroke();this.sprite.fillColor&&c.fill();c.closePath();c.restore();return false};
Script.prototype.blockPenDrawEllipseLocal=function(b){if(this.isDrawEvent&&this.sprite!=Runtime.background)return this.blockPenDrawEllipse([0,0,this.evaluateExpression(b[0]),this.evaluateExpression(b[1])]);this.dirty();var c=Runtime.stage.penLayer.context;c.save();var d=this.sprite.spriteObj;c.translate(d.x,d.y);c.rotate(d.rotation*Math.PI/180+Math.PI/2);var d=parseFloat(this.evaluateExpression(b[0])),b=parseFloat(this.evaluateExpression(b[1])),e=Math.max(d,b);c.strokeStyle=this.sprite.penColor;if(this.sprite.fillColor)c.fillStyle=
this.sprite.fillColor;c.lineWidth=this.sprite.penWidth;c.lineCap="round";c.translate(0,-b/2);c.scale(d/e,b/e);c.beginPath();c.arc(0,0,e/2,0,2*Math.PI,false);c.stroke();this.sprite.fillColor&&c.fill();c.closePath();c.restore();return false};
Script.prototype.blockPenDrawTextAt=function(b){this.dirty();if(!this.sprite.font)this.sprite.font="normal 16px Arial,Helvetica,sans-serif";if(this.isDrawEvent&&this.sprite!=Runtime.background){var c=Runtime.stage.drawLayer.context;c.save();var d=this.sprite.spriteObj;c.translate(d.x,d.y);d.rotation!==0&&d.rotateLock==0&&c.rotate(d.rotation*Math.PI/180);d.scale.x!=1||d.scale.y!=1?d.rotateLock==1&&d.rotation>90&&d.rotation<270?c.scale(-d.scale.x,d.scale.y):c.scale(d.scale.x,d.scale.y):d.rotateLock==
1&&(d.rotation>90&&d.rotation<270)&&c.scale(-1,1);var d=parseFloat(this.evaluateExpression(b[1])),e=-parseFloat(this.evaluateExpression(b[2])),f=ifArrayMakeString(this.evaluateExpression(b[0])),b=c.measureText(f),b=Math.max(Math.abs(d),Math.abs(d+b.width))*2,g=parseFloat(this.sprite.font.split(" ")[1]),g=Math.max(Math.abs(e),Math.abs(-e+g))*2;if(b>this.sprite.spriteObj.drawWidth)this.sprite.spriteObj.drawWidth=b;if(g>this.sprite.spriteObj.drawHeight)this.sprite.spriteObj.drawHeight=g}else{c=Runtime.stage.penLayer.context;
c.save();f=ifArrayMakeString(this.evaluateExpression(b[0]));d=Runtime.stage.getWidth()/2+parseFloat(this.evaluateExpression(b[1]));e=Runtime.stage.getHeight()/2-parseFloat(this.evaluateExpression(b[2]))}c.beginPath();c.strokeStyle=this.sprite.penColor;c.fillStyle=this.sprite.fillColor?this.sprite.fontColor:this.sprite.penColor;c.lineWidth=this.sprite.penWidth;c.textAlign="left";c.font=this.sprite.font;c.fillText(f,d,e);c.closePath();c.restore();return false};
Script.prototype.registerSpriteCollision=function(){if(this.scriptId){for(var b=false,c=0;c<Runtime.collisionTriggers.length;c++)if(Runtime.collisionTriggers[c]==this){b=true;break}if(b)return true}else this.scriptId=Runtime.getScriptId();Runtime.collisionTriggers.push(this);return false};
Script.prototype.valuePhysicsGetProperty=function(b){var c=this.evaluateExpression(b[0]),d=this.evaluateExpression(b[1]);if((b=d=="self"?this.sprite:Sprites.getSpriteByName(d))&&b.spriteObj){d=b.spriteObj;if(d.physicsBody)switch(c){case "density":return(c=d.physicsBody.GetFixtureList())?c.GetDensity():1;case "friction":return(c=d.physicsBody.GetFixtureList())?c.GetFriction():0.5;case "restitution":return(c=d.physicsBody.GetFixtureList())?c.GetRestitution():0.2;case "angular velocity":return d.physicsBody.GetAngularVelocity();
case "angular damping":return d.physicsBody.GetAngularDamping();case "inertia":return d.physicsBody.GetInertia();case "is active":return d.physicsBody.IsActive();case "is awake":return d.physicsBody.IsAwake();case "linear damping":return d.physicsBody.GetLinearDamping();case "x linear velocity":return d.physicsBody.GetLinearVelocity().x;case "y linear velocity":return d.physicsBody.GetLinearVelocity().y;case "x gravity":return Physics.getGravity().x;case "y gravity":return Physics.getGravity().y;
case "last collided with":return b.lastCollisionName?b.lastCollisionName:"";case "last collision x":return b.lastCollisionNormal.x;case "last collision y":return b.lastCollisionNormal.y;case "last actor collided with":return b.lastActorCollisionName?b.lastActorCollisionName:"";case "last actor collision x":if(b.lastActorCollisionName)return b.lastActorCollisionNormal.x;break;case "last actor collision y":if(b.lastActorCollisionName)return b.lastActorCollisionNormal.y}}else switch(c){case "density":return d==
"stage"?Physics.getStageDensity():Runtime.stage.tileLayer.getDensity(d);case "friction":return d=="stage"?Physics.getStageFriction():Runtime.stage.tileLayer.getFriction(d);case "restitution":return d=="stage"?Physics.getStageRestitution():Runtime.stage.tileLayer.getRestitution(d);case "x gravity":return Physics.getGravity().x;case "y gravity":return Physics.getGravity().y;case "is active":return d=="stage"?Physics.isStageActive():Runtime.stage.tileLayer.isActive(d);case "last collided with":case "last actor collided with":return""}return 0};
Script.prototype.blockPhysicsApply=function(b){var c=this.evaluateExpression(b[0]),d=this.evaluateExpression(b[1]),b=parseFloat(this.evaluateExpression(b[2]));if(isFinite(b)){var e;if((e=d=="self"?this.sprite:Sprites.getSpriteByName(d))&&e.spriteObj){d=e.spriteObj;switch(c){case "force":c=d.rotation*Math.PI/180;e=Math.cos(c)*b;b=Math.sin(c)*b;d.physicsBody.ApplyForce(new b2Vec2(e,b),d.physicsBody.GetPosition());break;case "impulse":c=d.rotation*Math.PI/180;e=Math.cos(c)*b;b=Math.sin(c)*b;d.physicsBody.ApplyImpulse(new b2Vec2(e,
b),d.physicsBody.GetPosition());break;case "torque":d.physicsBody.ApplyTorque(b);break;case "density":if(c=d.physicsBody.GetFixtureList()){c.SetDensity(b);d.physicsBody.ResetMassData()}break;case "friction":(c=d.physicsBody.GetFixtureList())&&c.SetFriction(b);break;case "restitution":(c=d.physicsBody.GetFixtureList())&&c.SetRestitution(b);break;case "angular damping":d.physicsBody.SetAngularDamping(b);break;case "angular velocity":d.physicsBody.SetAngularVelocity(b);break;case "linear damping":d.physicsBody.SetLinearDamping(b);
break;case "linear velocity":c=d.rotation*Math.PI/180;e=Math.cos(c)*b;b=Math.sin(c)*b;d.physicsBody.SetAwake(true);d.physicsBody.SetLinearVelocity(new b2Vec2(e,b))}}else switch(c){case "density":if(d=="stage")Physics.setStageDensity(b);else return Runtime.stage.tileLayer.setDensity(d,b);break;case "friction":if(d=="stage")Physics.setStageFriction(b);else return Runtime.stage.tileLayer.setFriction(d,b);break;case "restitution":if(d=="stage")Physics.setStageRestitution(b);else return Runtime.stage.tileLayer.setRestitution(d,
b)}}return false};
Script.prototype.blockPhysicsApplyXY=function(b){var c=this.evaluateExpression(b[0]),d=this.evaluateExpression(b[1]),e=parseFloat(this.evaluateExpression(b[2])),b=parseFloat(this.evaluateExpression(b[3]));if(isFinite(e)&&isFinite(b))if((d=d=="self"?this.sprite:Sprites.getSpriteByName(d))&&d.spriteObj){d=d.spriteObj;switch(c){case "force":d.physicsBody.ApplyForce(new b2Vec2(e,b),d.physicsBody.GetPosition());break;case "impulse":d.physicsBody.ApplyImpulse(new b2Vec2(e,b),d.physicsBody.GetPosition());break;
case "linear velocity":d.physicsBody.SetAwake(true);d.physicsBody.SetLinearVelocity(new b2Vec2(e,b));break;case "gravity":Physics.updateGravity(e,b)}}else switch(c){case "gravity":Physics.updateGravity(e,b)}};
Script.prototype.blockPhysicsSetActive=function(b){b=this.evaluateExpression(b[0]);this.sprite.spriteObj?this.sprite.spriteObj.physicsBody?this.sprite.spriteObj.physicsBody.SetActive(b&&b!="false"):console.log(this.sprite.label+"'s physics body was undefined"):Physics.setStageActive(b&&b!="false");return false};
Script.prototype.blockPhysicsSetActorActive=function(b){var c=this.evaluateExpression(b[0]),b=(b=this.evaluateExpression(b[1]))&&b!="false",d;(d=c=="self"?this.sprite:Sprites.getSpriteByName(c))&&d.spriteObj?d.spriteObj.physicsBody.SetActive(b):c=="stage"?Physics.setStageActive(b):Runtime.stage.tileLayer.setActive(c,b);return false};
Script.prototype.blockPhysicsSetStatic=function(b){if(this.sprite.spriteObj){b=this.evaluateExpression(b[0]);this.sprite.spriteObj.physicsBody.SetType(b&&b!="false"?b2Body.b2_staticBody:b2Body.b2_dynamicBody)}return false};
Script.prototype.blockPhysicsSetActorStatic=function(b){var c=this.evaluateExpression(b[0]),b=(b=this.evaluateExpression(b[1]))&&b!="false";(c=c=="self"?this.sprite:Sprites.getSpriteByName(c))&&c.spriteObj&&c.spriteObj.physicsBody.SetType(b?b2Body.b2_staticBody:b2Body.b2_dynamicBody);return false};Script.prototype.blockPhysicsSetGeometry=function(b){this.sprite.spriteObj&&Physics.updateBody(this.sprite.spriteObj,{geometry:this.evaluateExpression(b[0])});return false};
Script.prototype.blockPhysicsSetActorGeometry=function(b){var c=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);(c=c=="self"?this.sprite:Sprites.getSpriteByName(c))&&c.spriteObj&&Physics.updateBody(c.spriteObj,{geometry:b});return false};Script.prototype.blockPhysicsStart=function(){Physics.runSimulation();return false};Script.prototype.blockPhysicsStop=function(){Physics.stopSimulation();return false};
Script.prototype.valuePhysicsCollidedWithSprite=function(b){b=this.evaluateExpression(b[0]);return this.sprite.lastCollisionName==b||b=="edge"&&this.sprite.lastCollisionName&&name.indexOf("edge")==name.length-4||b=="any"&&lastCollsionName?true:false};Script.prototype.valuePhysicsCollidedWithName=function(){return this.sprite.lastActorCollisionName?this.sprite.lastActorCollisionName:""};
Script.prototype.valuePhysicsTouchingActor=function(b){if(this.sprite.spriteObj){var c=null,b=this.evaluateExpression(b[0]);if(b!="edge"&&b!="platform")if(b=="any")for(b=0;b<Runtime.sprites.length;b++){if(Physics.isBodyTouching(this.sprite.spriteObj.physicsBody,Runtime.sprites[b].spriteObj.physicsBody))return true}else c=(c=Sprites.getSpriteByName(b))?c.spriteObj.physicsBody:null;return Physics.isBodyTouching(this.sprite.spriteObj.physicsBody,c)}return false};
Script.prototype.valuePhysicsCollisionVectorX=function(){return this.sprite.lastCollisionNormal.x};Script.prototype.valuePhysicsCollisionVectorY=function(){return this.sprite.lastCollisionNormal.y};Script.prototype.valuePhysicsActorCollisionVectorX=function(){return this.sprite.lastActorCollisionName?this.sprite.lastActorCollisionNormal.x:0};Script.prototype.valuePhysicsActorCollisionVectorY=function(){return this.sprite.lastActorCollisionName?this.sprite.lastActorCollisionNormal.y:0};
Script.prototype.blockPhysicsApplyForce=function(b){var c=this.sprite.spriteObj;if(this.sprite.spriteObj){var d=parseFloat(this.evaluateExpression(b[0]));if(isFinite(d)){var e=c.rotation*Math.PI/180,b=Math.cos(e)*d,d=Math.sin(e)*d;c.physicsBody.ApplyForce(new b2Vec2(b,d),c.physicsBody.GetPosition())}}return false};
Script.prototype.blockPhysicsApplyImpulse=function(b){var c=this.sprite.spriteObj;if(c){var d=parseFloat(this.evaluateExpression(b[0]));if(isFinite(d)){var e=c.rotation*Math.PI/180,b=Math.cos(e)*d,d=Math.sin(e)*d;c.physicsBody.ApplyImpulse(new b2Vec2(b,d),c.physicsBody.GetPosition())}}return false};
Script.prototype.blockPhysicsApplyForceAngle=function(b){var c=this.sprite.spriteObj;if(c){var d=parseFloat(this.evaluateExpression(b[0])),b=parseFloat(this.evaluateExpression(b[1]));if(isFinite(d)&&isFinite(b)){var e=-(90-b)*Math.PI/180,b=Math.cos(e)*d,d=Math.sin(e)*d;c.physicsBody.ApplyForce(new b2Vec2(b,d),c.physicsBody.GetPosition())}}return false};
Script.prototype.blockPhysicsApplyImpulseAngle=function(b){var c=this.sprite.spriteObj;if(c){var d=parseFloat(this.evaluateExpression(b[0])),b=parseFloat(this.evaluateExpression(b[1]));if(isFinite(d)&&isFinite(b)){var e=-(90-b)*Math.PI/180,b=Math.cos(e)*d,d=Math.sin(e)*d;c.physicsBody.ApplyImpulse(new b2Vec2(b,d),c.physicsBody.GetPosition())}}return false};
Script.prototype.blockPhysicsApplyForceXY=function(b){var c=this.sprite.spriteObj;if(c){var d=parseFloat(this.evaluateExpression(b[0])),b=parseFloat(this.evaluateExpression(b[1]));isFinite(d)&&isFinite(b)&&c.physicsBody.ApplyForce(new b2Vec2(d,b),c.physicsBody.GetPosition())}return false};
Script.prototype.blockPhysicsApplyImpulseXY=function(b){var c=this.sprite.spriteObj;if(c){var d=parseFloat(this.evaluateExpression(b[0])),b=parseFloat(this.evaluateExpression(b[1]));isFinite(d)&&isFinite(b)&&c.physicsBody.ApplyImpulse(new b2Vec2(d,b),c.physicsBody.GetPosition())}return false};Script.prototype.blockPhysicsApplyTorque=function(b){if(this.sprite.spriteObj){b=parseFloat(this.evaluateExpression(b[0]));isFinite(b)&&this.sprite.spriteObj.physicsBody.ApplyTorque(b)}return false};
Script.prototype.blockPhysicsSetDensity=function(b){_doBlockPhysicsSetDensity(this.sprite,parseFloat(this.evaluateExpression(b[0])));return false};function _doBlockPhysicsSetDensity(b,c){if(b.spriteObj){if(isFinite(c)){var d=b.spriteObj.physicsBody.GetFixtureList();d&&d.SetDensity(c)}}else isFinite(c)&&Physics.setStageDensity(c)}Script.prototype.blockPhysicsSetFriction=function(b){_doBlockPhysicsSetFriction(this.sprite,parseFloat(this.evaluateExpression(b[0])));return false};
function _doBlockPhysicsSetFriction(b,c){if(b.spriteObj){if(isFinite(c)){var d=b.spriteObj.physicsBody.GetFixtureList();d&&d.SetFriction(c)}}else isFinite(c)&&Physics.setStageFriction(c)}Script.prototype.blockPhysicsSetRestitution=function(b){_doBlockPhysicsSetRestitution(this.sprite,parseFloat(this.evaluateExpression(b[0])));return false};
function _doBlockPhysicsSetRestitution(b,c){if(b.spriteObj){if(isFinite(c)){var d=b.spriteObj.physicsBody.GetFixtureList();d&&d.SetRestitution(c)}}else isFinite(c)&&Physics.setStageRestitution(c)}Script.prototype.blockPhysicsSetAngularDamping=function(b){_doBlockPhysicsSetAngularDamping(this.sprite,parseFloat(this.evaluateExpression(b[0])));return false};function _doBlockPhysicsSetAngularDamping(b,c){b.spriteObj&&isFinite(c)&&b.spriteObj.physicsBody.SetAngularDamping(c)}
Script.prototype.blockPhysicsSetAngularVelocity=function(b){_doBlockPhysicsSetAngularVelocity(this.sprite,parseFloat(this.evaluateExpression(b[0])));return false};function _doBlockPhysicsSetAngularVelocity(b,c){b.spriteObj&&isFinite(c)&&b.spriteObj.physicsBody.SetAngularVelocity(c)}Script.prototype.blockPhysicsSetLinearDamping=function(b){_doBlockPhysicsSetLinearDamping(this.sprite,parseFloat(this.evaluateExpression(b[0])));return false};
function _doBlockPhysicsSetLinearDamping(b,c){b.spriteObj&&isFinite(c)&&b.spriteObj.physicsBody.SetLinearDamping(c)}Script.prototype.blockPhysicsSetLinearVelocity=function(b){var c=this.sprite.spriteObj;if(this.sprite.spriteObj){var b=parseFloat(this.evaluateExpression(b[0])),d=c.rotation*Math.PI/180,c=Math.cos(d)*b,b=Math.sin(d)*b;_doBlockPhysicsSetLinearVelocity(this.sprite,c,b)}return false};
Script.prototype.blockPhysicsSetLinearVelocityXY=function(b){_doBlockPhysicsSetLinearVelocity(this.sprite,parseFloat(this.evaluateExpression(b[0])),parseFloat(this.evaluateExpression(b[1])));return false};function _doBlockPhysicsSetLinearVelocity(b,c,d){if(b.spriteObj&&isFinite(c)&&isFinite(d)){b.spriteObj.physicsBody.SetAwake(true);b.spriteObj.physicsBody.SetLinearVelocity(new b2Vec2(c,d))}}
Script.prototype.valuePhysicsDensity=function(){if(this.sprite.spriteObj){var b=this.sprite.spriteObj.physicsBody.GetFixtureList();if(b)return b.GetDensity()}else return Physics.getStageDensity();return 1};Script.prototype.valuePhysicsFriction=function(){if(this.sprite.spriteObj){var b=this.sprite.spriteObj.physicsBody.GetFixtureList();if(b)return b.GetFriction()}else return Physics.getStageFriction();return 0.5};
Script.prototype.valuePhysicsRestitution=function(){if(this.sprite.spriteObj){var b=this.sprite.spriteObj.physicsBody.GetFixtureList();if(b)return b.GetRestitution()}else return Physics.getStageRestitution();return 0.2};Script.prototype.valuePhysicsAngularVelocity=function(){return this.sprite.spriteObj?this.sprite.spriteObj.physicsBody.GetAngularVelocity():0};Script.prototype.valuePhysicsInertia=function(){return this.sprite.spriteObj?this.sprite.spriteObj.physicsBody.GetInertia():0};
Script.prototype.valuePhysicsXVelocity=function(){return this.sprite.spriteObj?this.sprite.spriteObj.physicsBody.GetLinearVelocity().x:0};Script.prototype.valuePhysicsYVelocity=function(){return this.sprite.spriteObj?this.sprite.spriteObj.physicsBody.GetLinearVelocity().y:0};Script.prototype.valuePhysicsIsAwake=function(){return this.sprite.spriteObj?this.sprite.spriteObj.physicsBody.IsAwake():0};
Script.prototype.valuePhysicsIsActive=function(){return this.sprite.spriteObj?this.sprite.spriteObj.physicsBody.IsActive():Physics.isStageActive()};Script.prototype.valuePhysicsAngularDamping=function(){return this.sprite.spriteObj?this.sprite.spriteObj.physicsBody.GetAngularDamping():0};Script.prototype.valuePhysicsLinearDamping=function(){return this.sprite.spriteObj?this.sprite.spriteObj.physicsBody.GetLinearDamping():0};
Script.prototype.blockPhysicsSetGravity=function(b){_doBlockPhysicsSetGravity(parseFloat(this.evaluateExpression(b[0])),parseFloat(this.evaluateExpression(b[1])));return false};function _doBlockPhysicsSetGravity(b,c){isFinite(b)&&isFinite(c)&&Physics.updateGravity(b,c)}Script.prototype.valuePhysicsXGravity=function(){return Physics.getGravity().x};Script.prototype.valuePhysicsYGravity=function(){return Physics.getGravity().y};
function getIntersection(b,c){var d=b.getBounds(),e=d.left,f=d.top,g=d.right,h=d.bottom,j=c.getBounds(),k=j.left,l=j.top,m=j.right,n=j.bottom;if(b.visible&&c.visible&&k<g&&m>e&&l<h&&n>f){e=Math.floor(Math.max(e,k));g=Math.floor(Math.min(g,m));f=Math.floor(Math.max(f,l));h=Math.floor(Math.min(h,n));return{bounds1:d,bounds2:j,x:e,y:f,width:g-e,height:h-f}}return null}
function spriteTouching(b,c){var d=getIntersection(b,c);if(d){if(Runtime.aabbCollision||b.drawFunction||c.drawFunction)return true;for(var e=b.getBuffer(),f=c.getBuffer(),g=d.bounds1,h=d.bounds2,j=Math.floor(g.right-g.left+1),k=Math.floor(h.right-h.left+1),l=Math.floor(d.x-g.left),g=Math.floor(d.y-g.top),m=Math.floor(d.x-h.left),n=g,h=Math.floor(d.y-h.top);n<g+d.height;n++,h++)for(var q=l,p=m;q<l+d.width;q++,p++){var s=(p+k*h)*4;if(e[(q+j*n)*4+3]&&f[s+3])return true}}return false}
Script.prototype.valueSensingTouchingSprite=function(b){if(this.sprite.spriteObj){var c=this.evaluateExpression(b[0]);if(c=="edge"){b=this.sprite.spriteObj;c=b.getBounds();return b.visible&&(c.left<0||c.right>Runtime.stage.getWidth()||c.top<0||c.bottom>Runtime.stage.getHeight())}if(c=="left edge"){b=this.sprite.spriteObj;c=b.getBounds();return b.visible&&c.left<0}if(c=="right edge"){b=this.sprite.spriteObj;c=b.getBounds();return b.visible&&c.right>Runtime.stage.getWidth()}if(c=="top edge"){b=this.sprite.spriteObj;
c=b.getBounds();return b.visible&&c.top<0}if(c=="bottom edge"){b=this.sprite.spriteObj;c=b.getBounds();return b.visible&&c.bottom>Runtime.stage.getHeight()}for(var d=0;d<Runtime.sprites.length;d++){b=Runtime.sprites[d];if(c==b.label)return spriteTouching(b.spriteObj,this.sprite.spriteObj);if(c=="mouse-pointer"){b=this.sprite.spriteObj;c=Runtime.stage.getMousePos();return b.containsPoint(c.x,c.y)}if(c=="any"&&this.sprite!=b&&spriteTouching(b.spriteObj,this.sprite.spriteObj))return true}}return false};
Script.prototype.valueSensingTouchingCloneOf=function(b){if(this.sprite.spriteObj){var c=this.evaluateExpression(b[0]);if(c=="edge"){b=this.sprite.spriteObj;c=b.getBounds();return b.visible&&(c.left<0||c.right>Runtime.stage.getWidth()||c.top<0||c.bottom>Runtime.stage.getHeight())}if(c=="left edge"){b=this.sprite.spriteObj;c=b.getBounds();return b.visible&&c.left<0}if(c=="right edge"){b=this.sprite.spriteObj;c=b.getBounds();return b.visible&&c.right>Runtime.stage.getWidth()}if(c=="top edge"){b=this.sprite.spriteObj;
c=b.getBounds();return b.visible&&c.top<0}if(c=="bottom edge"){b=this.sprite.spriteObj;c=b.getBounds();return b.visible&&c.bottom>Runtime.stage.getHeight()}for(var d=0;d<Runtime.sprites.length;d++){b=Runtime.sprites[d];if(c==b.label||c==b.instantiatedFrom){if(spriteTouching(b.spriteObj,this.sprite.spriteObj))return true}else{if(c=="mouse-pointer"){b=this.sprite.spriteObj;c=Runtime.stage.getMousePos();return b.containsPoint(c.x,c.y)}if(c=="any"&&this.sprite!=b&&spriteTouching(b.spriteObj,this.sprite.spriteObj))return true}}}return false};
Script.prototype.valueSensingTouchedActorName=function(){if(this.sprite.spriteObj)for(var b=0;b<Runtime.sprites.length;b++){var c=Runtime.sprites[b];if(c!=this.sprite&&spriteTouching(c.spriteObj,this.sprite.spriteObj))return c.label}return""};
Script.prototype.valueSensingTouchingColor=function(b){if(this.sprite.spriteObj){var c=parseInt(this.evaluateExpression(b[0]).substring(1),16),b=c>>16&248,d=c>>8&248,c=c&248,e=Runtime.stage.getBuffer(this.sprite.spriteObj);if(this.sprite.spriteObj.drawFunction)for(var f=this.sprite.spriteObj.getBounds(),f=Math.floor(f.right-f.left+1)*Math.floor(f.bottom-f.top+1),g=0;g<f;g=g+4){if(e[g+3]&248&&(e[g]&248)==b&&(e[g+1]&248)==d&&(e[g+2]&248)==c)return true}else for(var h=this.sprite.spriteObj.getBuffer(),
f=h.length,g=0;g<f;g=g+4)if(h[g+3]&&e[g+3]&248&&(e[g]&248)==b&&(e[g+1]&248)==d&&(e[g+2]&248)==c)return true}return false};
Script.prototype.valueSensingSeeColor=function(b){if(this.sprite.spriteObj)for(var c=parseInt(this.evaluateExpression(b[0]).substring(1),16),d=c>>16&248,e=c>>8&248,c=c&248,f=parseInt(this.evaluateExpression(b[1]).substring(1),16),b=f>>16&248,g=f>>8&248,f=f&248,h=Runtime.stage.getBuffer(this.sprite.spriteObj),j=this.sprite.spriteObj.getBuffer(),k=0;k<j.length;k=k+4)if(j[k+3]&248&&(j[k]&248)==d&&(j[k+1]&248)==e&&(j[k+2]&248)==c&&h[k+3]&248&&(h[k]&248)==b&&(h[k+1]&248)==g&&(h[k+2]&248)==f)return true;
return false};
Script.prototype.blockSensingAskAndWait=function(b){this.dirty();this.yield();if(this.data==null){this.data=true;Runtime.askSource=this.sprite;Runtime.askTriggerText=null;for(var c=this.sprite.buttonText="",d=0;d<b.length;d++)c=c+ifArrayMakeString(this.evaluateExpression(b[d]));b=$("#stage-canvas .ask");d=false;this.sprite.spriteObj?this.sprite.spriteObj.bubble&&this.sprite.spriteObj.bubble.dock=="dialog"&&(d=true):Runtime.stage.bubble&&Runtime.stage.bubble.dock=="dialog"&&(d=true);if(d){b.addClass("dialog");
if(this.sprite==Runtime.background)b.addClass("full");else{b.removeClass("full");if(this.sprite.costumes[0].img=="avatar://spine"){d=this.sprite._generatePreview().toDataURL("image/png");b.find("span.image img").attr("src",d)}else b.find("span.image img").attr("src",this.sprite.costumes[0].img)}}else{b.removeClass("dialog");_doBlockLooksSay(this.sprite,c)}b.find("span.textprompt").text(c);b.find("span.prompt.input").removeClass("hidden");b.find("span.prompt.buttons").addClass("hidden");b.removeClass("hidden").find("input").val("").focus();
c=this.sprite.font;d=c.indexOf(" ");d>0&&(d=c.indexOf(" ",d+1));d>0?b.css("font-family",c.substring(d+1)):b.css("font-family","");this.sprite.fontColor?b.css("color",this.sprite.fontColor):b.css("color","");this.sprite.fillColor?b.css("background-color",this.sprite.fillColor):b.css("background-color","")}else if(Runtime.askTriggerText!=null){Runtime.askSource=null;this.sprite.buttonText="";_doBlockLooksSay(this.sprite,"");this.waitTimeout=0;this.dlgAnswer=$("#stage-canvas .ask").addClass("hidden").find("input").val();
return false}return this.skipArgCompute=true};Script._blockSensingAskChoicesDismiss=function(b){if(b==null)Runtime.askTriggerText=Runtime.stage.bubble.buttonText;else for(var c=Runtime.sprites.length-1;c>=0;c--)if(Runtime.sprites[c].spriteObj==b){Runtime.askTriggerText=b.bubble.buttonText;break}};
Script.prototype.blockSensingAskChoices=function(b){this.dirty();this.yield();if(this.data==null){this.data={timeout:Date.now()+5E3,autoselect:false,displayed:false};Runtime.stage.addListener("bubbleclicked",Script._blockSensingAskChoicesDismiss);Runtime.askSource=this.sprite;Runtime.askTriggerText=null;if(b.length==2){this.data.showContinue=true;var c=this.evaluateExpression(b[1]),d=c.indexOf(":");if(d>0){this.sprite.buttonText=c.substring(0,d);this.data.timeout=Date.now()+parseInt(c.substring(d+
1))*1E3;this.data.autoselect=true}else{this.sprite.buttonText=c;this.data.autoselect=false}$("#stage-canvas .prompt-overlay").detach();$("#stage-canvas").append('<div class="prompt-overlay" style="position:absolute;bottom:'+bubblePadding+"px;right:"+bubblePadding+'px;color:#fff;font-size:6pt;line-height:1em;padding:5px;border-radius:5px;background-color:rgba(0,0,0,0.6);">'+(window.g_loc?window.g_loc.getText("winstage.continuemsg","Click anywhere to continue"):"Click anywhere to continue")+"</div>");
_doBlockLooksSay(this.sprite,""+this.evaluateExpression(b[0]))}else{var c=""+this.evaluateExpression(b[0]),e=$("#stage-canvas .ask"),d=false;this.sprite.spriteObj?this.sprite.spriteObj.bubble&&this.sprite.spriteObj.bubble.dock=="dialog"&&(d=true):Runtime.stage.bubble&&Runtime.stage.bubble.dock=="dialog"&&(d=true);if(d)e.addClass("dialog");else{e.removeClass("dialog");_doBlockLooksSay(this.sprite,c)}this.sprite.buttonText=null;e.find(".prompt.input").addClass("hidden");for(var d=e.find(".prompt.buttons").removeClass("hidden").empty(),
f=1;f<b.length;f++)d.append('<a class="askbutton" href="#">'+this.evaluateExpression(b[f])+"</a>");if(this.sprite==Runtime.background)e.addClass("full");else{e.removeClass("full");if(this.sprite.costumes[0].img=="avatar://spine"){b=this.sprite._generatePreview().toDataURL("image/png");e.find("span.image img").attr("src",b)}else e.find("span.image img").attr("src",this.sprite.costumes[0].img)}e.find("span.textprompt").text(c);e.find("span.prompt.input").addClass("hidden");e.find("span.prompt.buttons").removeClass("hidden");
e.removeClass("hidden").find("input").val("").focus();c=this.sprite.font;d=c.indexOf(" ");d>0&&(d=c.indexOf(" ",d+1));d>0?e.css("font-family",c.substring(d+1)):e.css("font-family","");this.sprite.fontColor?e.css("color",this.sprite.fontColor):e.css("color","");this.sprite.fillColor?e.css("background-color",this.sprite.fillColor):e.css("background-color","")}}else{if(Runtime.askTriggerText!=null){Runtime.stage.removeListener("bubbleclicked");Runtime.askSource=null;this.sprite.buttonText=null;_doBlockLooksSay(this.sprite,
"");$("#stage-canvas .ask").addClass("hidden");$("#stage-canvas .prompt-overlay").detach();this.dlgAnswer=Runtime.askTriggerText;return false}if(this.data.showContinue&&Date.now()>this.data.timeout)if(this.data.displayed){if(this.data.autoselect){Runtime.askTriggerText=this.sprite.buttonText;$("#stage-canvas .ask").addClass("hidden");$("#stage-canvas .prompt-overlay").detach()}}else{this.data.displayed=true;$("#stage-canvas .prompt-overlay").detach();e=$('<div class="prompt-overlay" style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;background-color:rgba(0,0,0,0.2);"></div>');
e.append('<div style="position:absolute;bottom:'+bubblePadding+"px;right:"+bubblePadding+'px;color:#fff;font-size:16pt;line-height:1em;padding:10px;border-radius:10px;background-color:rgba(0,0,0,0.6);">'+(window.g_loc?window.g_loc.getText("winstage.continuemsg","Click anywhere to continue"):"Click anywhere to continue")+"</div>");$("#stage-canvas").append(e);var g=this;e.click(function(){Runtime.askTriggerText=g.sprite.buttonText;$("#stage-canvas .prompt-overlay").detach();return false})}}return this.skipArgCompute=
true};Script.prototype.valueSensingAnswer=function(){return this.dlgAnswer?valueToNative(this.dlgAnswer):""};Script.prototype.valueSensingTiltAngle=function(){if(Runtime.stage.accel){var b=Runtime.stage.accel;return Math.atan2(b.y,b.x)*180/Math.PI}return 0};Script.prototype.valueSensingTiltAmount=function(){if(Runtime.stage.accel){var b=Runtime.stage.accel;return Math.sqrt(b.x*b.x+b.y*b.y)}return 0};
Script.prototype.valueSensingAccelerometerX=function(){return Runtime.stage.accel?Runtime.stage.accel.x:0};Script.prototype.valueSensingAccelerometerY=function(){return Runtime.stage.accel?Runtime.stage.accel.y:0};Script.prototype.valueSensingMouseX=function(){var b=Runtime.stage.getMousePos();return b?b.x-Runtime.stage.getWidth()/2:0};Script.prototype.valueSensingMouseY=function(){var b=Runtime.stage.getMousePos();return b?Runtime.stage.getHeight()/2-b.y:0};
Script.prototype.valueSensingMouseDown=function(){return Runtime.stage.mouseDown==true};Script.prototype.valueSensingKeyPressed=function(b){b=this.evaluateExpression(b[0]);if(b=="any")for(var c in Runtime.keys){if(Runtime.keys[c])return true}else if(Runtime.keys[b])return Runtime.keys[b];return false};
Script.prototype.valueSensingDistanceToSprite=function(b){if(this.sprite.spriteObj){b=this.evaluateExpression(b[0]);if(b=="mouse-pointer"){if(b=Runtime.stage.getMousePos())return Math.sqrt((b.x-this.sprite.spriteObj.x)*(b.x-this.sprite.spriteObj.x)+(b.y-this.sprite.spriteObj.y)*(b.y-this.sprite.spriteObj.y))}else{if(b=="left edge")return Math.abs(this.sprite.spriteObj.x);if(b=="right edge")return Math.abs(Runtime.stage.getWidth()-this.sprite.spriteObj.x);if(b=="top edge")return Math.abs(this.sprite.spriteObj.y);
if(b=="bottom edge")return Math.abs(Runtime.stage.getHeight()-this.sprite.spriteObj.y);if(b=Sprites.getSpriteByName(b))return Math.sqrt((this.sprite.spriteObj.x-b.spriteObj.x)*(this.sprite.spriteObj.x-b.spriteObj.x)+(this.sprite.spriteObj.y-b.spriteObj.y)*(this.sprite.spriteObj.y-b.spriteObj.y))}}return 0};Script.prototype.blockSensingResetTimer=function(){Runtime.startTimer=Date.now();return false};Script.prototype.valueSensingTimer=function(){return(Date.now()-Runtime.startTimer)/1E3};
Script.prototype.blockSensingSpriteProperty=function(b){this.blockVarPropSet(b)};
Script.prototype.valueSensingSpriteProperty=function(b){var c=null,d=this.evaluateExpression(b[1]);if(d=="self")c=this.sprite;else for(var e=0;e<Runtime.sprites.length;e++){var f=Runtime.sprites[e];if(d==f.label){c=f;break}}b=this.evaluateExpression(b[0]);if(c)switch(b){case "x position":return c.spriteObj.x-Runtime.stage.getWidth()/2;case "y position":return Runtime.stage.getHeight()/2-c.spriteObj.y;case "angle":c=c.spriteObj.rotation;return(360-c%360)%360;case "direction":c=Math.floor(c.spriteObj.rotation);
c=(c+90)%360;c>180&&(c=c-360);return c;case "costume #":return(c=c.getCostumeByName(c.currentCostume))?c[0]+1:1;case "costume name":if(c.skeleton&&c.spriteObj.drawFunction)return c.skeleton.animationName;return(c=c.getCostumeByName(c.currentCostume))?c[1].name:"";case "size":return Math.floor(c.spriteObj.scale.x*100);case "volume":return 0;case "width":return Math.floor(c.spriteObj.scale.x*c.spriteObj.width);case "height":return Math.floor(c.spriteObj.scale.y*c.spriteObj.height);default:return c.variables[b]!==
void 0?c.variables[b]:Runtime.background.variables[b]!==void 0?Runtime.background.variables[b]:""}else{if(d=="mouse-pointer"){switch(b){case "x position":return(c=Runtime.stage.getMousePos())?c.x-Runtime.stage.getWidth()/2:0;case "y position":return(c=Runtime.stage.getMousePos())?Runtime.stage.getHeight()/2-c.y:0}return""}switch(b){case "background #":return Runtime.background.getCostumeByName(Runtime.background.currentCostume)[0]+1;default:return Runtime.background.variables[b]!==void 0?Runtime.background.variables[b]:
""}}};Script.prototype.valueSensingActorName=function(){return this.sprite.label};Script.prototype.valueSensingActorNameAt=function(b){var b=this.evaluateExpression(b[0]),c=parseInt(b)-1,c=!b||c<0?0:c%Runtime.sprites.length;return Runtime.sprites[c].label};Script.prototype.valueSensingNumActors=function(){return Runtime.sprites.length};Script.prototype.valueSensingSoundLevel=function(){MediaCapture.isCapturingAudio()||MediaCapture.startCaptureAudioLevel();return MediaCapture.getSoundLevel()*100};
Script.prototype.valueSensingIsLoud=function(){console.log("unimplemented valueIsLoud");return false};Script.prototype.valueSensingSensor=function(b){console.log("unimplemented valueSensor:"+this.evaluateExpression(b[0]));return 0};Script.prototype.valueSensingSensorPressed=function(b){console.log("unimplemented valueSensorPressed:"+this.evaluateExpression(b[0]));return false};
Script.prototype.valueSensingDateTime=function(b){switch(this.evaluateExpression(b[0])){case "year":return(new Date).getFullYear();case "month":return(new Date).getMonth();case "day":return(new Date).getDate();case "hours":return(new Date).getHours();case "minutes":return(new Date).getMinutes();case "seconds":return(new Date).getSeconds();case "milliseconds":return(new Date).getMilliseconds();case "unix time":return(new Date).getTime();default:return(new Date).toTimeString()}};
Script.prototype.valueSensingScreenLeft=function(){return-Runtime.stage.getWidth()/2};Script.prototype.valueSensingScreenRight=function(){return Runtime.stage.getWidth()/2};Script.prototype.valueSensingScreenTop=function(){return Runtime.stage.getHeight()/2};Script.prototype.valueSensingScreenBottom=function(){return-Runtime.stage.getHeight()/2};
Script.prototype.valueSensingStageProperty=function(b){b=this.evaluateExpression(b[0]);switch(b){case "width":case "design width":return Runtime.stage.getWidth();case "height":case "design height":return Runtime.stage.getHeight();case "left":return-Runtime.stage.getWidth()/2;case "right":return Runtime.stage.getWidth()/2;case "top":return Runtime.stage.getHeight()/2;case "bottom":return-Runtime.stage.getHeight()/2;case "viewport offset x":return Runtime.stage.tileLayer.scrollOffset.x;case "viewport offset y":return-Runtime.stage.tileLayer.scrollOffset.y;
case "background offset x":return Runtime.stage.backgroundOffsetX;case "background offset y":return Runtime.stage.backgroundOffsetY;case "world width":return Runtime.stage.tileLayer.getWidth();case "world height":return Runtime.stage.tileLayer.getHeight();case "closest actor":for(var c=1E6,d=null,b=0;b<Runtime.sprites.length;b++){var e=Runtime.sprites[b];if(e!=this.sprite){var f=Math.sqrt((e.spriteObj.x-this.sprite.spriteObj.x)*(e.spriteObj.x-this.sprite.spriteObj.x)+(e.spriteObj.y-this.sprite.spriteObj.y)*
(e.spriteObj.y-this.sprite.spriteObj.y));if(f<c){c=f;d=e}}}if(d)return d.label;break;case "furthest actor":c=0;d=null;for(b=0;b<Runtime.sprites.length;b++){e=Runtime.sprites[b];if(e!=this.sprite){f=Math.sqrt((e.spriteObj.x-this.sprite.spriteObj.x)*(e.spriteObj.x-this.sprite.spriteObj.x)+(e.spriteObj.y-this.sprite.spriteObj.y)*(e.spriteObj.y-this.sprite.spriteObj.y));if(f>c){c=f;d=e}}}if(d)return d.label;break;case "number of actors":return Runtime.sprites.length;case "last key pressed":return Runtime.lastKeyPressed;
default:if(b.substr(0,8)=="closest "){for(var g=b.substr(8),c=1E6,d=null,b=0;b<Runtime.sprites.length;b++){e=Runtime.sprites[b];if(e!=this.sprite&&e.tag&&e.tag.indexOf(g)>=0){f=Math.sqrt((e.spriteObj.x-this.sprite.spriteObj.x)*(e.spriteObj.x-this.sprite.spriteObj.x)+(e.spriteObj.y-this.sprite.spriteObj.y)*(e.spriteObj.y-this.sprite.spriteObj.y));if(f<c){c=f;d=e}}}if(d)return d.label}else if(b.substr(0,9)=="furthest "){g=b.substr(9);c=0;d=null;for(b=0;b<Runtime.sprites.length;b++){e=Runtime.sprites[b];
if(e!=this.sprite&&e.tag&&e.tag.indexOf(g)>=0){f=Math.sqrt((e.spriteObj.x-this.sprite.spriteObj.x)*(e.spriteObj.x-this.sprite.spriteObj.x)+(e.spriteObj.y-this.sprite.spriteObj.y)*(e.spriteObj.y-this.sprite.spriteObj.y));if(f>c){c=f;d=e}}}if(d)return d.label}}return 0};Script.prototype.blockSensingSetTag=function(b){this.sprite.tag=this.evaluateExpression(b[0]).split(",")};
Script.prototype.valueSensingGetTag=function(b){b=this.evaluateExpression(b[0]);if(b=="self"){if(this.sprite.tag)return this.sprite.tag.join(",")}else if((b=Sprites.getSpriteByName(b))&&b.tag)return b.tag.join(",");return""};Script.prototype.valueSensingUserId=function(){return prefs&&prefs.login?prefs.login:""};Script.prototype.valueSensingUserFirstName=function(){if(prefs){if(prefs.firstName)return prefs.firstName;if(prefs.login)return prefs.login}return""};
Script.prototype.valueSensingVideo=function(b){if(this.evaluateExpression(b[0])=="motion")for(var c=0;c<Runtime.sprites.length;c++){var d=Runtime.sprites[c],e=this.evaluateExpression(b[1]);if(e=="self"&&d==this.sprite||e==d.label){d=d.spriteObj.getBounds();if(d=MediaCapture.getBuffer(d.left,d.top,d.right-d.left,d.bottom-d.top)){b=0;d=d.data;for(c=0;c<d.length;c=c+4)d[c]&&b++;return parseInt(b*100/(d.length/4))}}}return 0};
Script.prototype.blockSoundPlay=function(b){var c=this.sprite.getSoundByName(this.evaluateExpression(b[0]));if(c&&!Runtime.muted){if(!c[1].soundObj)c[1].soundObj=soundManager.createSound({id:"s"+Math.random(),url:c[1].sound});if(c[1].soundObj&&c[1].soundObj.playState==0){c[1].soundObj.setVolume(this.sprite.volume);c[1].soundObj.play({onfinish:function(){c[1].soundObj.unload()},onstop:function(){c[1].soundObj.unload()}})}}return false};
Script.prototype.blockSoundPlayUntilDone=function(b){this.yield();if(this.data==null){this.data=1;var c=this.sprite.getSoundByName(this.evaluateExpression(b[0]));if(c&&!Runtime.muted){var d=this;if(!c[1].soundObj)c[1].soundObj=soundManager.createSound({id:"s"+Math.random(),url:c[1].sound});if(c[1].soundObj)c[1].soundObj.play({onfinish:function(){c[1].soundObj.unload();d.data=-1},onstop:function(){c[1].soundObj.unload();d.data=-1}});else return false}else return false}else if(this.data==-1)return false;
return this.skipArgCompute=true};Script.prototype.blockSoundStopAll=function(){soundManager.stopAll();return false};Script.prototype.blockSoundStopActor=function(){for(var b=this.sprite.sounds,c=0;c<b.length;c++)b[c].soundObj&&b[c].soundObj.stop();return false};
Script.prototype.blockSoundChangeVolume=function(b){b=this.sprite.volume+parseInt(this.evaluateExpression(b[0]));b<0?b=0:b>100&&(b=100);this.sprite.volume=b;soundManager.setVolume("id",b);for(var c=0;c<this.sprite.sounds.length;c++)this.sprite.sounds[c].soundObj&&this.sprite.sounds[c].soundObj.setVolume(b);return false};Script.prototype.blockSoundSetVolume=function(b){_doBlockSetVolume(this.sprite,this.evaluateExpression(b[0]));return false};
function _doBlockSetVolume(b,c){var d=parseInt(c);d<0?d=0:d>100&&(d=100);var e=null,e=b?b:Runtime.background;e.volume=d;for(var f=0;f<e.sounds.length;f++)e.sounds[f].soundObj&&e.sounds[f].soundObj.setVolume(d);soundManager.setVolume("id",d)}Script.prototype.valueSoundVolume=function(){return this.sprite.volume};Script.prototype.blockSoundChangeTempo=function(b){b=SoundGenerator.tempo+parseInt(this.evaluateExpression(b[0]));b<1&&(b=1);SoundGenerator.tempo=b;return false};
Script.prototype.blockSoundSetTempo=function(b){b=parseInt(this.evaluateExpression(b[0]));b<1&&(b=1);SoundGenerator.tempo=b;return false};Script.prototype.valueSoundTempo=function(){return SoundGenerator.tempo};
Script.prototype.blockSoundPlayDrum=function(b){this.yield();if(this.data==null){if(!SoundGenerator.loadDrums())return true;var c=parseFloat(this.evaluateExpression(b[1]))*60/SoundGenerator.tempo,b=(parseInt(this.evaluateExpression(b[0]))-27)%60;b<0&&(b=b+60);if(c>0){SoundGenerator.playDrum(27+b,c);this.data=Date.now()+c*1E3}else return false}else if(Date.now()>this.data)return false;return this.skipArgCompute=true};
Script.prototype.blockSoundRest=function(b){this.yield();if(this.data==null){b=parseFloat(this.evaluateExpression(b[1]))*60/SoundGenerator.tempo;if(b>0)this.data=Date.now()+b*1E3;else return false}else if(Date.now()>this.data)return false;return this.skipArgCompute=true};
Script.prototype.blockSoundPlayNote=function(b){this.yield();if(this.data==null){if(!this.instrument)this.instrument=1;if(!SoundGenerator.loadInstrument(this.instrument))return true;var c=(parseInt(this.evaluateExpression(b[0]))-21)%88;c<0&&(c=c+88);b=parseFloat(this.evaluateExpression(b[1]))*60/SoundGenerator.tempo;if(b>0){this.data=Date.now()+b*1E3;SoundGenerator.playNote(this.instrument,c,b)}else return false}else if(Date.now()>this.data)return false;return this.skipArgCompute=true};
Script.prototype.blockSoundSetInstrument=function(b){this.yield();b=(parseInt(this.evaluateExpression(b[0]))-1)%128;b<0&&(b=b+128);this.instrument=b=b+1;return!SoundGenerator.loadInstrument(b)?true:false};
Script.prototype.blockVarPropSet=function(b){var c=this.sprite,d=this.evaluateExpression(b[0]),e=this.evaluateExpression(b[1]);if(e=="Stage"||e=="stage"||e=="any")c=Runtime.background;else if(e!="self"){c=Sprites.getSpriteByName(e);if(!c)c=this.sprite}b=this.evaluateExpression(b[2]);this.dirty();blockVarPropSet(d,c,b);return false};function blockVarPropSet(b,c,d){blockFuncSet(b,c,d)||blockVarSet(b,c,d);return false}
function blockFuncSet(b,c,d){if(!c||c==Runtime.background)switch(b){case "background #":case "scene #":return Runtime.background.setCostumeByName(d);case "x gravity":Physics.updateGravity(d,Physics.getGravity().y);return true;case "y gravity":Physics.updateGravity(Physics.getGravity().x,d);return true;case "background offset x":Runtime.stage.backgroundOffsetX=d;Runtime.stage.setBackgroundType();return true;case "background offset y":Runtime.stage.backgroundOffsetY=d;Runtime.stage.setBackgroundType();
return true;case "viewport offset x":Runtime.stage.tileLayer.scrollOffset.x=d;Runtime.stage.tileLayer.draw();return true;case "viewport offset y":Runtime.stage.tileLayer.scrollOffset.y=-d;Runtime.stage.tileLayer.draw();return true;default:if(Runtime.background.variables[b]!==void 0&&Runtime.background.variables[b]!==d){Runtime.background.variables[b]=d;Runtime.updateCloudVar(b);return true}}else if(c)switch(b){case "x position":_doBlockMotionSetX(c,d);return true;case "y position":_doBlockMotionSetY(c,
d);return true;case "direction":_doBlockMotionPointDirection(c,d);return true;case "angle":_doBlockMotionPointDirection(this.sprite,360-parseFloat(d)+90);return true;case "layer":c.spriteObj&&c.spriteObj.setZIndex(parseInt(d));return true;case "rotation style":if(c.spriteObj)c.spriteObj.rotateLock=d=="left-right"?1:d=="don't rotate"?2:0;return true;case "label":if(c.spriteObj)c.spriteObj.label=""+d;return true;case "costume #":_doBlockLooksSwitchCostume(c,d);return true;case "say":_doBlockLooksSay(c,
d);return true;case "visible":""+d=="true"?c.spriteObj.show():c.spriteObj.hide();return c.spriteObj.visible;case "size":_doBlockLooksSetSize(c,d);return true;case "volume":_doBlockSoundSetVolume(c,d);return true;case "tag":c.tag=d.split(",");return true;case "density":_doBlockPhysicsSetDensity(c,d);return true;case "friction":_doBlockPhysicsSetFriction(c,d);return true;case "restitution":_doBlockPhysicsSetRestitution(c,d);return true;case "angular velocity":_doBlockPhysicsSetAngularVelocity(c,d);
return true;case "angular damping":_doBlockPhysicsSetAngularDamping(c,d);return true;case "linear damping":_doBlockPhysicsSetLinearDamping(c,d);return true;case "x linear velocity":_doBlockPhysicsSetLinearVelocity(c,d,c.spriteObj.physicsBody.GetLinearVelocity().y);return true;case "y linear velocity":_doBlockPhysicsSetLinearVelocity(c,c.spriteObj.physicsBody.GetLinearVelocity().x,d);return true;default:if(b.indexOf("effect/")==0)return _doBlockLooksSetEffect(c,b.substring(7),d)}return false}
function blockVarSet(b,c,d){if(!c||c==Runtime.background)if(Runtime.background.variables[b]!==void 0){if(Runtime.background.variables[b]!==d){Runtime.background.variables[b]=d;Runtime.updateCloudVar(b)}}else Runtime.background.varTransient[b]=d;else c&&(c.variables[b]!==void 0?c.variables[b]=d:Runtime.background.variables[b]==void 0&&(c.varTransient[b]=d));return true}
Script.prototype.valueVarPropGet=function(b){var c=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);if(b=="self")b=this.sprite.label;return propertyGet(c,b)};
function propertyGet(b,c){switch(b){case "tilt angle":if(Runtime.stage.accel){var d=Runtime.stage.accel;return Math.atan2(d.y,d.x)*180/Math.PI}return 0;case "tilt amount":if(Runtime.stage.accel){d=Runtime.stage.accel;return Math.sqrt(d.x*d.x+d.y*d.y)}return 0;case "x tilt":return Runtime.stage.accel?Runtime.stage.accel.x:0;case "y tilt":return Runtime.stage.accel?Runtime.stage.accel.y:0;case "mouse x":return(d=Runtime.stage.getMousePos())?d.x-Runtime.stage.getWidth()/2:0;case "mouse y":return(d=Runtime.stage.getMousePos())?
Runtime.stage.getHeight()/2-d.y:0;case "mouse down?":return Runtime.stage.mouseDown==true;case "background #":case "scene #":return Runtime.background.getCostumes().length>0?Runtime.background.getCostumeByName(Runtime.background.currentCostume)[0]+1:0;case "background name":case "scene name":return Runtime.background.getCostumes().length>0?Runtime.background.getCostumeByName(Runtime.background.currentCostume)[1].name:0;case "timer":return(Date.now()-Runtime.startTimer)/1E3;case "x gravity":return Physics.getGravity().x;
case "y gravity":return Physics.getGravity().y;case "background offset x":return Runtime.stage.backgroundOffsetX;case "background offset y":return Runtime.stage.backgroundOffsetY;case "viewport offset x":return Runtime.stage.tileLayer.scrollOffset.x;case "viewport offset y":return-Runtime.stage.tileLayer.scrollOffset.y;case "# of actors":return Runtime.sprites.length;case "sound level":MediaCapture.isCapturingAudio()||MediaCapture.startCaptureAudioLevel();return MediaCapture.getSoundLevel()*100}if(c==
"Stage"||c=="stage"||c=="any"){if(Runtime.background.variables[b]!==void 0)return valueToNative(Runtime.background.variables[b]);if(Runtime.background.lists[b]!==void 0)return Runtime.background.lists[b];if(Runtime.background.varTransient[b]!==void 0)return Runtime.background.varTransient[b]}else if(d=Sprites.getSpriteByName(c))switch(b){case "x position":return Math.floor(d.spriteObj.x-Runtime.stage.getWidth()/2);case "y position":return Math.floor(Runtime.stage.getHeight()/2-d.spriteObj.y);case "direction":d=
Math.floor(d.spriteObj.rotation);d=(d+90)%360;d>180&&(d=d-360);return d;case "angle":d=d.spriteObj.rotation;return(360-d%360)%360;case "layer":return d.spriteObj.zIndex;case "rotation style":if(d.spriteObj){if(d.spriteObj.rotateLock==1)return"left-right";if(d.spriteObj.rotateLock==2)return"don't rotate"}return"all around";case "label":if(d.spriteObj)return d.spriteObj.label;break;case "costume #":return(d=d.getCostumeByName(d.currentCostume))?d[0]+1:1;case "costume name":if(d.skeleton&&d.spriteObj.drawFunction)return d.skeleton.animationName;
if(d=d.getCostumeByName(d.currentCostume))return d[1].name;break;case "say":return d.spriteObj.text;case "is hidden?":return!d.spriteObj.visible;case "visible":return d.spriteObj.visible;case "size":return Math.floor(d.spriteObj.scale.x*100);case "width":return Math.floor(d.spriteObj.scale.x*d.spriteObj.width);case "height":return Math.floor(d.spriteObj.scale.y*d.spriteObj.height);case "answer":if(d.dlgAnswer)return valueToNative(d.dlgAnswer);break;case "volume":return d.volume;case "tempo":return SoundGenerator.tempo;
case "width":return Math.floor(d.spriteObj.scale.x*d.spriteObj.width);case "height":return Math.floor(d.spriteObj.scale.y*d.spriteObj.height);case "tag":if(d.tag)return d.tag.join(",");break;case "density":return(d=d.spriteObj.physicsBody.GetFixtureList())?d.GetDensity():0;case "friction":return(d=d.spriteObj.physicsBody.GetFixtureList())?d.GetFriction():0;case "restitution":return(d=d.spriteObj.physicsBody.GetFixtureList())?d.GetRestitution():0;case "angular velocity":return d.spriteObj.physicsBody.GetAngularVelocity();
case "angular damping":return d.spriteObj.physicsBody.GetAngularDamping();case "inertia":return d.spriteObj.physicsBody.GetInertia();case "is active?":return d.spriteObj.physicsBody.IsActive();case "linear damping":return d.spriteObj.physicsBody.GetLinearDamping();case "x linear velocity":return d.spriteObj.physicsBody.GetLinearVelocity().x;case "y linear velocity":return d.spriteObj.physicsBody.GetLinearVelocity().y;case "is awake?":return d.spriteObj.physicsBody.IsAwake();default:if(d.variables[b]!==
void 0)return valueToNative(d.variables[b]);if(d.lists[b]!==void 0)return d.lists[b];if(d.varTransient[b]!==void 0)return d.varTransient[b]}return""}Script.prototype.blockVarSet=function(b){var c="",d=b[0];if(d&&d._child){d=d._child;if(d.func=="valueVar"||d.func=="valueParam"||d.func=="valueScriptVar"||d.func=="valueList")c=d.name}c||(c=this.evaluateExpression(b[0]));b=this.evaluateExpression(b[1]);this._setVariable(c,b);return false};
Script.prototype._setVariable=function(b,c){if(this.scriptVars&&this.scriptVars[b]!==void 0)this.scriptVars[b]=c;else if(this.fnArgs&&this.fnArgs[b]!==void 0)this.fnArgs[b]=c;else if(this.sprite&&this.sprite.variables[b]!==void 0){if(this.sprite.variables[b]!==c){this.sprite.variables[b]=c;this.sprite==Runtime.background&&Runtime.updateCloudVar(b)}}else if(this.sprite&&this.sprite.lists[b]!==void 0){this.sprite.lists[b]=c;this.sprite==Runtime.background&&Runtime.updateCloudList(b)}else if(Runtime.background.lists[b]!==
void 0){if(Runtime.background.lists[b]!==c){Runtime.background.lists[b]=c;Runtime.updateCloudList(b)}}else if(Runtime.background.variables[b]!==void 0){if(Runtime.background.variables[b]!==c){Runtime.background.variables[b]=c;Runtime.updateCloudVar(b)}}else this.sprite.varTransient[b]=c};
Script.prototype.blockVarChangeBy=function(b){var c="",d=b[0];if(d&&d._child){d=d._child;if(d.func=="valueVar"||d.func=="valueParam"||d.func=="valueScriptVar"||d.func=="valueList")c=d.name}c||(c=this.evaluateExpression(b[0]));d=this.evaluateExpression(b[1]);if(this.scriptVars&&this.scriptVars[c]!==void 0){b=parseFloat(this.scriptVars[c]);isNaN(b)&&(b=0);d=parseFloat(d);isNaN(d)&&(d=1);this.scriptVars[c]=b+d}else if(this.fnArgs&&this.fnArgs[c]!==void 0){b=parseFloat(this.fnArgs[c]);isNaN(b)&&(b=0);
d=parseFloat(d);isNaN(d)&&(d=1);this.fnArgs[c]=b+d}else if(this.sprite&&this.sprite.variables[c]!==void 0){b=parseFloat(this.sprite.variables[c]);isNaN(b)&&(b=0);d=parseFloat(d);isNaN(d)&&(d=1);this.sprite.variables[c]=b+d;this.sprite==Runtime.background&&Runtime.updateCloudVar(c)}else if(Runtime.background.variables[c]!==void 0){b=parseFloat(Runtime.background.variables[c]);isNaN(b)&&(b=0);d=parseFloat(d);isNaN(d)&&(d=1);Runtime.background.variables[c]=b+d;Runtime.updateCloudVar(c)}else if(this.sprite&&
this.sprite.varTransient[c]!==void 0){b=parseFloat(this.sprite.varTransient[c]);isNaN(b)&&(b=0);d=parseFloat(d);isNaN(d)&&(d=1);this.sprite.varTransient[c]=b+d}return false};Script.prototype.blockVarShow=function(){return false};Script.prototype.blockVarHide=function(){return false};Script.prototype.valueVar=function(){return this._getVariable(this.blockName)};
Script.prototype._getVariable=function(b){var c="";this.scriptVars&&this.scriptVars[b]!==void 0?c=this.scriptVars[b]:this.fnArgs&&this.fnArgs[b]!==void 0?c=this.fnArgs[b]:this.sprite&&this.sprite.variables[b]!==void 0?c=this.sprite.variables[b]:this.sprite&&this.sprite.lists[b]!==void 0?c=this.sprite.lists[b]:Runtime.background.variables[b]!==void 0?c=Runtime.background.variables[b]:Runtime.background.lists[b]!==void 0?c=Runtime.background.lists[b]:this.sprite&&this.sprite.varTransient[b]!==void 0&&
(c=this.sprite.varTransient[b]);return valueToNative(c)};Script.prototype.valueListNew=function(){return[]};Script.prototype.valueObjNew=function(){return{}};
Script.prototype.blockListAdd=function(b){var c="",d=b[b.length-1];if(d&&d._child){d=d._child;if(d.func=="valueVar"||d.func=="valueParam"||d.func=="valueScriptVar"||d.func=="valueList")c=d.name}c||(c=this.evaluateExpression(b[b.length-1]));if(this.scriptVars&&this.scriptVars[c]!==void 0)for(d=0;d<b.length-1;d++)this.scriptVars[c].push(this.evaluateExpression(b[d]));else if(this.fnArgs[c]!==void 0)for(d=0;d<b.length-1;d++)this.fnArgs[c].push(this.evaluateExpression(b[d]));else if(this.sprite&&this.sprite.lists[c]!==
void 0)for(d=0;d<b.length-1;d++)this.sprite.lists[c].push(this.evaluateExpression(b[d]));else if(this.sprite&&this.sprite.variables[c]!==void 0&&this.sprite.variables[c]instanceof Array)for(d=0;d<b.length-1;d++)this.sprite.variables[c].push(this.evaluateExpression(b[d]));else if(Runtime.background.lists[c]!==void 0){for(d=0;d<b.length-1;d++)Runtime.background.lists[c].push(this.evaluateExpression(b[d]));Runtime.updateCloudList(c)}else if(Runtime.background.variables[c]!==void 0&&Runtime.background.variables[c]instanceof
Array)for(d=0;d<b.length-1;d++)Runtime.background.variables[c].push(this.evaluateExpression(b[d]));else if(this.sprite&&this.sprite.varTransient[c]!==void 0&&this.sprite.varTransient[c]instanceof Array)for(d=0;d<b.length-1;d++)this.sprite.varTransient[c].push(this.evaluateExpression(b[d]));return false};
Script.prototype.blockListDel=function(b){var c=null,d="",e=b[1];if(e&&e._child){e=e._child;if(e.func=="valueVar"||e.func=="valueParam"||e.func=="valueScriptVar"||e.func=="valueList")d=e.name}d||(d=this.evaluateExpression(b[1]));this.scriptVars&&this.scriptVars[d]!==void 0?c=this.scriptVars[d]:this.fnArgs[d]!==void 0?c=this.fnArgs[d]:this.sprite&&this.sprite.lists[d]!==void 0?c=this.sprite.lists[d]:this.sprite&&this.sprite.variables[d]!==void 0?c=this.sprite.variables[d]:Runtime.background.lists[d]!==
void 0?c=Runtime.background.lists[d]:Runtime.background.variables[d]!==void 0?c=Runtime.background.variables[d]:this.sprite&&this.sprite.varTransient[d]!==void 0&&(c=this.sprite.varTransient[d]);if(c!=null){b=this.evaluateExpression(b[0]);if(b=="last")c instanceof Array&&c.pop();else if(b=="all")if(c instanceof Array)c.splice(0,c.length);else{if(c instanceof Object)for(var f in c)delete c[f]}else if(c instanceof Array){f=Math.round(parseFloat(b));f>0&&f<=c.length&&c.splice(f-1,1)}else c instanceof
Object&&delete c[b];Runtime.background.lists[d]!==void 0&&Runtime.updateCloudList(d)}return false};
Script.prototype.blockListInsert=function(b){var c=this.evaluateExpression(b[b.length-2]),d=null,e="",f=b[b.length-1];if(f&&f._child){f=f._child;if(f.func=="valueVar"||f.func=="valueParam"||f.func=="valueScriptVar"||f.func=="valueList")e=f.name}e||(e=this.evaluateExpression(b[b.length-1]));this.scriptVars&&this.scriptVars[e]!==void 0?d=this.scriptVars[e]:this.fnArgs[e]!==void 0?d=this.fnArgs[e]:this.sprite&&this.sprite.lists[e]!==void 0?d=this.sprite.lists[e]:this.sprite&&this.sprite.variables[e]!==
void 0&&this.sprite.variables[e]instanceof Array?d=this.sprite.variables[e]:Runtime.background.lists[e]!==void 0?d=Runtime.background.lists[e]:Runtime.background.variables[e]!==void 0&&Runtime.background.variables[e]instanceof Array?d=Runtime.background.variables[e]:this.sprite&&(this.sprite.varTransient[e]!==void 0&&this.sprite.varTransient[e]instanceof Array)&&(d=this.sprite.varTransient[e]);if(d!=null){if(c=="last")for(e=0;e<b.length-2;e++)d.push(this.evaluateExpression(b[e]));else if(c=="any"){c=
Math.round(Math.random()*d.length);for(e=0;e<b.length-2;e++)d.splice(c+e,0,this.evaluateExpression(b[e]))}else{c=Math.round(parseFloat(c))-1;if(c>=0&&c<d.length)for(e=0;e<b.length-2;e++)d.splice(c+e,0,this.evaluateExpression(b[e]));else for(e=0;e<b.length-2;e++)d.push(this.evaluateExpression(b[e]))}Runtime.background.lists[c]!==void 0&&Runtime.updateCloudList(c)}return false};
Script.prototype.valueListItem=function(b){var c=null,d="",e=b[b.length-1];if(e&&e._child){e=e._child;if(e.func=="valueVar"||e.func=="valueParam"||e.func=="valueScriptVar"||e.func=="valueList")d=e.name}d||(d=this.evaluateExpression(b[b.length-1]));this.scriptVars&&this.scriptVars[d]!==void 0?c=this.scriptVars[d]:this.fnArgs[d]!==void 0?c=this.fnArgs[d]:this.sprite&&this.sprite.lists[d]!==void 0?c=this.sprite.lists[d]:this.sprite&&this.sprite.variables[d]!==void 0&&this.sprite.variables[d]instanceof
Array?c=this.sprite.variables[d]:Runtime.background.lists[d]!==void 0?c=Runtime.background.lists[d]:Runtime.background.variables[d]!==void 0&&Runtime.background.variables[d]instanceof Array?c=Runtime.background.variables[d]:this.sprite&&(this.sprite.varTransient[d]!==void 0&&this.sprite.varTransient[d]instanceof Array)&&(c=this.sprite.varTransient[d]);d="";if(c!=null&&c.length>0){b=this.evaluateExpression(b[0]);if(b=="last")d=c[c.length-1];else if(b=="any")d=c[Math.round(Math.random()*c.length)];
else{b=Math.round(parseFloat(b));b>0&&b<=c.length&&(d=c[b-1])}}return valueToNative(d)};
Script.prototype.valueListLength=function(b){var c="",d=b[0];if(d&&d._child){d=d._child;if(d.func=="valueVar"||d.func=="valueParam"||d.func=="valueScriptVar"||d.func=="valueList")c=d.name}c||(c=this.evaluateExpression(b[0]));return this.scriptVars&&this.scriptVars[c]!==void 0?this.scriptVars[c].length:this.fnArgs[c]!==void 0?this.fnArgs[c].length:this.sprite&&this.sprite.lists[c]!==void 0?this.sprite.lists[c].length:this.sprite&&this.sprite.variables[c]!==void 0&&this.sprite.variables[c]instanceof
Array?this.sprite.variables[c].length:Runtime.background.lists[c]!==void 0?Runtime.background.lists[c].length:Runtime.background.variables[c]!==void 0&&Runtime.background.variables[c]instanceof Array?Runtime.background.variables[c].length:this.sprite&&this.sprite.varTransient[c]!==void 0&&this.sprite.varTransient[c]instanceof Array?this.sprite.varTransient[c].length:0};
Script.prototype.valueListContains=function(b){var c=null,d="",e=b[0];if(e&&e._child){e=e._child;if(e.func=="valueVar"||e.func=="valueParam"||e.func=="valueScriptVar"||e.func=="valueList")d=e.name}d||(d=this.evaluateExpression(b[0]));this.scriptVars&&this.scriptVars[d]!==void 0?c=this.scriptVars[d]:this.fnArgs[d]!==void 0?c=this.fnArgs[d]:this.sprite&&this.sprite.lists[d]!==void 0?c=this.sprite.lists[d]:this.sprite&&this.sprite.variables[d]!==void 0&&this.sprite.variables[d]instanceof Array?c=this.sprite.variables[d]:
Runtime.background.lists[d]!==void 0?c=Runtime.background.lists[d]:Runtime.background.variables[d]!==void 0&&Runtime.background.variables[d]instanceof Array?c=Runtime.background.variables[d]:this.sprite&&(this.sprite.varTransient[d]!==void 0&&this.sprite.varTransient[d]instanceof Array)&&(c=this.sprite.varTransient[d]);if(c!=null){b=valueToNative(this.evaluateExpression(b[1]));for(d=0;d<c.length;d++)if(valueToNative(c[d])==b)return true}return false};
Script.prototype.valueList=function(){var b="";if(this.scriptVars&&this.scriptVars[this.blockName]!==void 0)b=this.scriptVars[this.blockName];else if(this.fnArgs[this.blockName]!==void 0)b=this.fnArgs[this.blockName];else if(this.sprite&&this.sprite.lists[this.blockName]!==void 0)b=this.sprite.lists[this.blockName];else if(this.sprite&&this.sprite.variables[this.blockName]!==void 0&&(this.sprite.variables[this.blockName]instanceof Array||this.sprite.variables[this.blockName]instanceof Object))b=this.sprite.variables[this.blockName];
else if(Runtime.background.lists[this.blockName]!==void 0)b=Runtime.background.lists[this.blockName];else if(Runtime.background.variables[this.blockName]!==void 0&&(Runtime.background.variables[this.blockName]instanceof Array||Runtime.background.variables[this.blockName]instanceof Object))b=Runtime.background.variables[this.blockName];else if(this.sprite&&this.sprite.varTransient[this.blockName]!==void 0&&(this.sprite.varTransient[this.blockName]instanceof Array||this.sprite.varTransient[this.blockName]instanceof
Object))b=this.sprite.varTransient[this.blockName];return b};
Script.prototype.blockListReplace=function(b){var c=null,d="",e=b[1];if(e&&e._child){e=e._child;if(e.func=="valueVar"||e.func=="valueParam"||e.func=="valueScriptVar"||e.func=="valueList")d=e.name}d||(d=this.evaluateExpression(b[1]));this.scriptVars&&this.scriptVars[d]!==void 0?c=this.scriptVars[d]:this.fnArgs[d]!==void 0?c=this.fnArgs[d]:this.sprite&&this.sprite.lists[d]!==void 0?c=this.sprite.lists[d]:this.sprite&&this.sprite.variables[d]!==void 0&&this.sprite.variables[d]instanceof Array?c=this.sprite.variables[d]:
Runtime.background.lists[d]!==void 0?c=Runtime.background.lists[d]:Runtime.background.variables[d]!==void 0&&Runtime.background.variables[d]instanceof Array?c=Runtime.background.variables[d]:this.sprite&&(this.sprite.varTransient[d]!==void 0&&this.sprite.varTransient[d]instanceof Array)&&(c=this.sprite.varTransient[d]);if(c!=null){e=this.evaluateExpression(b[0]);if(e=="last")c[c.length-1]=this.evaluateExpression(b[2]);else if(e=="any")c[Math.round(Math.random()*c.length)]=this.evaluateExpression(b[2]);
else{e=Math.round(parseFloat(e));e>0&&e<=c.length&&(c[e-1]=this.evaluateExpression(b[2]))}Runtime.background.lists[d]!==void 0&&Runtime.updateCloudList(d)}return false};
Script.prototype.blockObjSet=function(b){var c=this.evaluateExpression(b[0]);if(c!=null){var d=valueToNative(this.evaluateExpression(b[1]));if(c instanceof Array&&(typeof d!="number"||!isFinite(d))){for(var e={},f=0;f<c.length;f++)e[f]=c[f];(c=b[0])&&c._child&&(c._child.func=="valueVar"?this.sprite.variables[c._child.name]!==void 0?this.sprite.variables[c._child.name]=e:Runtime.background.variables[c._child.name]!==void 0?Runtime.background.variables[c._child.name]=e:this.sprite.lists[c._child.name]!==
void 0?this.sprite.lists[c._child.name]=e:Runtime.background.lists[c._child.name]!==void 0?Runtime.background.lists[c._child.name]=e:this.sprite.varTransient[c._child.name]!==void 0&&(this.sprite.varTransient[c._child.name]=e):c._child.func=="valueScriptVar"?this.scriptVars[c._child.name]!==void 0&&(this.scriptVars[c._child.name]=e):c._child.func=="valueParam"?this.fnArgs[c._child.name]!==void 0&&(this.fnArgs[c._child.name]=e):c._child.func=="valueList"&&(this.sprite.lists[c._child.name]!==void 0?
this.sprite.lists[c._child.name]=e:Runtime.background.lists[c._child.name]!==void 0?Runtime.background.lists[c._child.name]=e:this.sprite&&this.sprite.varTransient[c._child.name]!==void 0&&(this.sprite.varTransient[c._child.name]=e)));c=e}c[d]=this.evaluateExpression(b[2])}return false};
Script.prototype.blockObjDel=function(b){var c=this.evaluateExpression(b[0]);if(c!=null){b=valueToNative(this.evaluateExpression(b[1]));c instanceof Array&&(typeof b!="number"||!isFinite(b))&&b>=0&&b<c.length?c.splice(b,1):delete c[b]}return false};Script.prototype.valueObjGet=function(b){var c=this.evaluateExpression(b[0]),d="";if(c!=null){b=valueToNative(this.evaluateExpression(b[1]));if(c instanceof Array&&(typeof b!="number"||!isFinite(b))||c.hasOwnProperty(b))d=c[b]}return valueToNative(d)};
Script.prototype.valueObjLength=function(b){var c=0,b=this.evaluateExpression(b[0]);if(b!=null)if(b instanceof Array)c=b.length;else if(b instanceof Object)for(var d in b)b.hasOwnProperty(d)&&c++;return c};Script.prototype.valueObjKeys=function(b){var b=this.evaluateExpression(b[0]),c=[];if(b!=null)for(var d in b)b.hasOwnProperty(d)&&c.push(d);return c};
Script.prototype.valueObjValues=function(b){var b=this.evaluateExpression(b[0]),c=[];if(b!=null)for(var d in b)b.hasOwnProperty(d)&&c.push(b[d]);return c};
Script.prototype.blockNetworkAPI=function(b){this.yield();if(this.data==null){this.data={ready:false,networkData:null};for(var c={url:this.evaluateExpression(b[0])},d=1;d<b.length;d++){var e=this.currentBlock.label.getSocketAtChild(d);if(e._child&&e._child.name){c[e._child.name]=""+ifArrayMakeString(this.evaluateExpression(b[d]));c.url=c.url.indexOf("?")>0?c.url+"&":c.url+"?";c.url=c.url+(escape(e._child.name)+"="+escape(c[e._child.name]))}}var f=this;$.ajax({url:"/api/fetchjson",data:c,success:function(b){try{f.data.networkData=
JSON.parse(b)}catch(c){f.data.networkData=b}f.sprite.networkData=f.data.networkData;f.data.ready=true},error:function(){f.data.networkData="error";f.data.ready=true;f.sprite.networkData="";console.log("error")}});return this.skipArgCompute=true}if(!this.data.ready)return this.skipArgCompute=true;return false};
function _parseXml(b,c){b.tagName=c[0].tagName;b.attributes={};$.each(c[0].attributes,function(){b.attributes[this.name]=this.value});b.children=[];$.each(c[0].children,function(){var c={};_parseXml(c,$(this));b.children.push(c)});b.textNode=c.text()}Script.prototype.valueNetworkParse=function(b){b=this.evaluateExpression(b[0]);try{return JSON.parse(b)}catch(c){try{var d={},e=$($.parseXML(b));_parseXml(d,e);return d}catch(f){return b}}};
Script.prototype.valueNetworkResult=function(){return this.sprite.networkData?this.sprite.networkData:""};
Script.prototype.blockNetworkSaveValue=function(b){var c=this.evaluateExpression(b[0]),d=this.evaluateExpression(b[1]),b=this.evaluateExpression(b[2]);if(typeof c=="number"||typeof c=="string")c=""+c;else try{c=JSON.stringify(c)}catch(e){c=""+c}this.yield();if(this.data==null){this.data={ready:false,networkData:null};var f=this;$.ajax({url:"/api/savevalue",type:"POST",data:{n:d,v:c,p:b,pid:window.IDE?window.IDE.currentProjectId:""},success:function(b){f.data.networkData=f.valueNetworkParse([b]);f.data.ready=
true},error:function(){f.data.networkData="error";f.data.ready=true;console.log("save data error")}});return this.skipArgCompute=true}if(!this.data.ready)return this.skipArgCompute=true;return false};
Script.prototype.blockNetworkLoadValue=function(b){this.yield();if(this.data==null){var c=this.evaluateExpression(b[0]),d="",e=b[0];if(e&&e._child){e=e._child;if(e.func=="valueVar"||e.func=="valueParam"||e.func=="valueScriptVar"||e.func=="valueList")d=e.name}d||(d=this.evaluateExpression(b[1]));this.data={ready:false,varName:d,networkData:null};var f=this;$.ajax({url:"/api/loadvalue",data:{n:c,pid:window.IDE?window.IDE.currentProjectId:""},success:function(b){var c="";try{c=JSON.parse(b)}catch(d){try{var c=
{},e=$($.parseXML(b));_parseXml(g,e)}catch(m){c=b}}f.data.networkData=c;f.data.ready=true},error:function(){f.data.networkData="error";f.data.ready=true;console.log("load data error")}});return this.skipArgCompute=true}if(!this.data.ready)return this.skipArgCompute=true;if(this.data.networkData!="error"){var g=null;if(this.scriptVars&&this.scriptVars[this.data.varName]!==void 0)g=this.scriptVars;else if(typeof this.data.networkData=="object")if(this.sprite&&this.sprite.lists[this.data.varName]!==
void 0)g=this.sprite.lists;else if(Runtime.background.lists[this.data.varName]!==void 0)g=Runtime.background.lists;if(!g)if(this.fnArgs&&this.fnArgs[this.data.varName]!==void 0)g=this.fnArgs;else if(this.sprite&&this.sprite.variables[this.data.varName]!==void 0)g=this.sprite.variables;else if(Runtime.background.variables[this.data.varName]!==void 0)g=Runtime.background.variables;if(!g){if(!this.scriptVars)this.scriptVars={};g=this.scriptVars}g[this.data.varName]=this.data.networkData}return false};
function jsonCallback(){}Script.prototype.valueHardwareDistance=function(){if(!Runtime.querying){Runtime.querying=true;$.ajax({dataType:"json",url:"http://localhost:8888/plugin/wedo?callback=?",jsonpCallback:"jsonCallback",success:function(b){if(b.status=="OK"){Runtime.hwTilt=b.tiltDirection;Runtime.hwDistance=b.distance}Runtime.querying=false}})}return Runtime.hwDistance};
Script.prototype.valueHardwareTilt=function(){if(!Runtime.querying){Runtime.querying=true;$.ajax({dataType:"json",url:"http://localhost:8888/plugin/wedo?callback=?",jsonpCallback:"jsonCallback",success:function(b){if(b.status=="OK"){Runtime.hwTilt=b.tiltDirection;Runtime.hwDistance=b.distance}Runtime.querying=false}})}return Runtime.hwTilt};
Script.prototype.blockHardwareMotor=function(b){this.yield();if(this.data==null){this.data={ready:false,networkData:null};var c=this;Runtime.querying=true;$.ajax({dataType:"json",url:"http://localhost:8888/plugin/wedo?callback=?&a="+this.evaluateExpression(b[0])+"&b="+this.evaluateExpression(b[1]),jsonpCallback:"jsonCallback",success:function(b){if(b.status=="OK"){Runtime.hwTilt=b.tiltDirection;Runtime.hwDistance=b.distance;c.data.networkData=b}c.data.ready=true;Runtime.querying=false},error:function(){c.data.networkData=
"error";c.data.ready=true;Runtime.querying=false;console.log("error")}});return this.skipArgCompute=true}if(!this.data.ready)return this.skipArgCompute=true;return false};
function hardwareNop(){this.dirty();this.sprite.buttonText="";Runtime.background.font="normal 60px Arial,Helvetica,sans-serif";Runtime.background.fontColor="#000000";Runtime.background.fillColor="#ffffff";_doBlockLooksSay(Runtime.background,"This project contains hardware blocks.  Please run this project on a tablet to control the hardware.");return false}function hardwareFalse(){return false}Script.prototype.blockSpheroSetSpeed=hardwareNop;Script.prototype.blockSpheroRoll=hardwareNop;
Script.prototype.blockSpheroStop=hardwareNop;Script.prototype.blockSpheroTurnCW=hardwareNop;Script.prototype.blockSpheroTurnCCW=hardwareNop;Script.prototype.blockSpheroHeading=hardwareNop;Script.prototype.blockSpheroColor=hardwareNop;Script.prototype.blockSpheroBrightness=hardwareNop;Script.prototype.valueSpheroConnected=hardwareFalse;Script.prototype.valueSpheroHeading=hardwareNop;Script.prototype.valueSpheroSpeed=hardwareNop;Script.prototype.valueSpheroProperty=hardwareNop;
Script.prototype.valueSpheroOdometer=hardwareNop;Script.prototype.valueSpheroCollidedSinceLastCheck=hardwareNop;Script.prototype.registerHardwareTrigger=hardwareNop;Script.prototype.blockSpheroSetStabilization=hardwareNop;Script.prototype.blockSpheroSet=hardwareNop;Script.prototype.blockDroneTakeOff=hardwareNop;Script.prototype.blockDroneLand=hardwareNop;Script.prototype.blockDroneStop=hardwareNop;Script.prototype.blockDroneEmergency=hardwareNop;Script.prototype.blockDroneSetSpeed=hardwareNop;
Script.prototype.blockDroneForward=hardwareNop;Script.prototype.blockDroneBackward=hardwareNop;Script.prototype.blockDroneLeft=hardwareNop;Script.prototype.blockDroneRight=hardwareNop;Script.prototype.blockDroneTurnCW=hardwareNop;Script.prototype.blockDroneTurnCCW=hardwareNop;Script.prototype.blockDroneAnimation=hardwareNop;Script.prototype.blockDroneUp=hardwareNop;Script.prototype.blockDroneDown=hardwareNop;Script.prototype.valueDroneConnected=hardwareFalse;Script.prototype.blockDroneStartUp=hardwareNop;
Script.prototype.blockDroneStartDown=hardwareNop;Script.prototype.blockDroneStartRotateLeft=hardwareNop;Script.prototype.blockDroneStartRotateRight=hardwareNop;Script.prototype.blockDroneTakePicture=hardwareNop;Script.prototype.blockDroneFetchPicture=hardwareNop;Script.prototype.blockDroneDeletePicture=hardwareNop;Script.prototype.blockDroneDeleteAllPictures=hardwareNop;Script.prototype.blockDroneVarSetNumPictures=hardwareNop;Script.prototype.blockDroneSetProductName=hardwareNop;
Script.prototype.valueDroneHasGrabber=hardwareNop;Script.prototype.blockDroneControlGrabber=hardwareNop;Script.prototype.valueDroneHasCannon=hardwareNop;Script.prototype.blockDroneControlCannon=hardwareNop;Script.prototype.blockDroneSetFlyingMode=hardwareNop;Script.prototype.blockDroneSetPlaneSpeed=hardwareNop;Script.prototype.blockJumpingSumoStop=hardwareNop;Script.prototype.blockJumpingSumoEmergency=hardwareNop;Script.prototype.blockJumpingSumoJump=hardwareNop;
Script.prototype.blockJumpingSumoAnimation=hardwareNop;Script.prototype.blockJumpingSumoForward=hardwareNop;Script.prototype.blockJumpingSumoBackward=hardwareNop;Script.prototype.blockJumpingSumoTurnCW=hardwareNop;Script.prototype.blockJumpingSumoTurnCCW=hardwareNop;Script.prototype.blockJumpingSumoSetSpeed=hardwareNop;Script.prototype.blockJumpingSumoSetTurn=hardwareNop;Script.prototype.blockJumpingSumoMove=hardwareNop;Script.prototype.blockJumpingSumoStart=hardwareNop;
Script.prototype.blockJumpingSumoPose=hardwareNop;Script.prototype.blockJumpingSumoSetVolume=hardwareNop;Script.prototype.blockJumpingSumoSetAudioTheme=hardwareNop;Script.prototype.blockWedo2RunMotorFor=hardwareNop;Script.prototype.blockWedo2SetMotorPower=hardwareNop;Script.prototype.blockWedo2SetMotorDirection=hardwareNop;Script.prototype.blockWedo2MotorOn=hardwareNop;Script.prototype.blockWedo2MotorOff=hardwareNop;Script.prototype.blockWedo2MotorDrift=hardwareNop;
Script.prototype.valueWedo2MotorPower=hardwareNop;Script.prototype.valueWedo2MotorDirection=hardwareNop;Script.prototype.valueWedo2ConnectedTo=hardwareFalse;Script.prototype.blockWedo2SetLightColor=hardwareNop;Script.prototype.valueWedo2TiltSensorDirection=hardwareNop;Script.prototype.blockWedo2SetTiltSensorMode=hardwareNop;Script.prototype.valueWedo2TiltSensorMode=hardwareNop;Script.prototype.valueWedo2TiltSensorAngle=hardwareNop;Script.prototype.valueWedo2TiltSensorBumpCount=hardwareNop;
Script.prototype.blockWedo2SensorReset=hardwareNop;Script.prototype.valueWedo2MotionSensorDistance=hardwareNop;Script.prototype.blockWedo2SetMotionSensorMode=hardwareNop;Script.prototype.valueWedo2MotionSensorMode=hardwareNop;Script.prototype.valueWedo2MotionSensorCount=hardwareNop;Script.prototype.blockWedo2PlayToneFor=hardwareNop;Script.prototype.blockWedo2StopTone=hardwareNop;Script.prototype.blockHueState=hardwareNop;Script.prototype.valueHueState=hardwareNop;Script.prototype.blockHueColor=hardwareNop;
Script.prototype.blockHueSetHue=hardwareNop;Script.prototype.blockHueChangeHue=hardwareNop;Script.prototype.blockHueBrightness=hardwareNop;Script.prototype.valueHueBrightness=hardwareNop;Script.prototype.blockParticleEmitStart=function(){if(this.sprite&&this.sprite.spriteObj){var b=this.sprite.spriteObj;if(!b.emitter){b.emitter=new Proton.Emitter;b.emitter.p.x=b.x;b.emitter.p.y=b.y;Canvas.particles.addEmitter(b.emitter)}b.emitter.emit()}};
Script.prototype.blockParticleEmitStop=function(){if(this.sprite&&this.sprite.spriteObj){var b=this.sprite.spriteObj;if(!b.emitter){b.emitter=new Proton.Emitter;b.emitter.p.x=b.x;b.emitter.p.y=b.y;Canvas.particles.addEmitter(b.emitter)}b.emitter.stopEmit()}};
Script.prototype.blockParticleSetRate=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}b=this.evaluateExpression(b[0]);c.emitter.rate=new Proton.Rate(new Proton.Span(b,b),new Proton.Span(0.1,0.1))}};
Script.prototype.blockParticleSetVectorVelocity=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}c.emitVelocity&&c.emitter.removeInitialize(c.emitVelocity);var d=this.evaluateExpression(b[0]),e=this.evaluateExpression(b[1]),f=this.evaluateExpression(b[2]),b=this.evaluateExpression(b[3]);c.emitVelocity=new Proton.Velocity(new Proton.Span(d,e),new Proton.Span(f,
b),"vector");c.emitter.addInitialize(c.emitVelocity)}};
Script.prototype.blockParticleSetRadialVelocity=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}c.emitVelocity&&c.emitter.removeInitialize(c.emitVelocity);var d=this.evaluateExpression(b[0]),e=this.evaluateExpression(b[1]),f=this.evaluateExpression(b[2]),b=this.evaluateExpression(b[3]);c.emitVelocity=new Proton.Velocity(new Proton.Span(d,e),new Proton.Span(f,
b),"polar");c.emitter.addInitialize(c.emitVelocity)}};Script.prototype.blockParticleSetLifetime=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}c.emitLifetime&&c.emitter.removeInitialize(c.emitLifetime);b=this.evaluateExpression(b[0]);c.emitLifetime=new Proton.Life(b);c.emitter.addInitialize(c.emitLifetime)}};
Script.prototype.blockParticleSetMass=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}c.emitMass&&c.emitter.removeInitialize(c.emitMass);b=this.evaluateExpression(b[0]);c.emitMass=new Proton.Mass(b);c.emitter.addInitialize(c.emitMass)}};
Script.prototype.blockParticleSetGravity=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}c.emitGravity&&c.emitter.removeBehaviour(c.emitGravity);b=this.evaluateExpression(b[0]);if(b>0){c.emitGravity=new Proton.Gravity(b);c.emitter.addBehaviour(c.emitGravity)}}};
Script.prototype.blockParticleSetAttraction=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}c.emitAttraction&&c.emitter.removeBehaviour(c.emitAttraction);var d=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);c.emitAttraction=new Proton.Attraction({x:c.x,y:c.y},d,b);c.emitter.addBehaviour(c.emitAttraction)}};
Script.prototype.blockParticleSetRadius=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}c.emitRadius&&c.emitter.removeInitialize(c.emitRadius);b=this.evaluateExpression(b[0]);c.emitRadius=new Proton.Radius(b);c.emitter.addInitialize(c.emitRadius)}};
Script.prototype.blockParticleSetScale=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}c.emitScale&&c.emitter.removeBehaviour(c.emitScale);var d=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);c.emitScale=new Proton.Scale(d,b);c.emitter.addBehaviour(c.emitScale)}};
Script.prototype.blockParticleSetAlpha=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}c.emitAlpha&&c.emitter.removeBehaviour(c.emitAlpha);var d=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);c.emitAlpha=new Proton.Alpha(d,b);c.emitter.addBehaviour(c.emitAlpha)}};
Script.prototype.blockParticleSetColor=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}c.emitColor&&c.emitter.removeBehaviour(c.emitColor);var d=this.evaluateExpression(b[0]),b=this.evaluateExpression(b[1]);c.emitColor=new Proton.Color(d,b);c.emitter.addBehaviour(c.emitColor)}};
Script.prototype.blockParticleSetImage=function(b){if(this.sprite&&this.sprite.spriteObj){var c=this.sprite.spriteObj;if(!c.emitter){c.emitter=new Proton.Emitter;c.emitter.p.x=c.x;c.emitter.p.y=c.y;Canvas.particles.addEmitter(c.emitter)}c.emitImage&&c.emitter.removeInitialize(c.emitImage);b=this.evaluateExpression(b[0]);if(b!="none"){var d=new Image;d.onload=function(){c.emitImage=new Proton.ImageTarget(d);c.emitter.addInitialize(c.emitImage)};d.src="imgs/particles/"+b+".png"}}};
var IDE={defaultProjectName:"Untitled",_layoutFlush:!1,_layoutTop:!1,_progressStack:1,_ignoreUpdates:!1,_importCheckId:null,isDirty:0,_lastSaved:Date.now(),_enableKeyboardShortcuts:!0,clickms:500,lastTouchDown:-1,currentProjectId:null,currentProjectName:null,currentProjectDescription:null,editingActor:null};
$(document).ready(function(){$(window).resize(IDE.adjustPanels);$(".tabs-container .tab").click(function(){$(this).addClass("selected").siblings().removeClass("selected");var b=$(this).attr("href");$(".tab-content"+b).addClass("active").siblings().removeClass("active");console.log(".tab-content"+b)});document.addEventListener("keyup",IDE._handleKeyUp);document.addEventListener("keydown",IDE._handleKeyDown);document.addEventListener("keypress",IDE._handleKeyPress);document.addEventListener("touchstart",
IDE._touchHandler,true);document.addEventListener("touchmove",IDE._touchHandler,true);document.addEventListener("touchend",IDE._touchHandler,true);document.addEventListener("touchcancel",IDE._touchHandler,true);document.onscroll=function(b){window.scrollTo(0,0);b.preventDefault();b.stopPropagation();return false};document.oncontextmenu=function(b){b.preventDefault();b.stopPropagation();return false};document.onselectstart=function(b){if((!window.WinCode||window.WinCode._inputField==null)&&b.target.tagName!=
"INPUT"&&b.target.tagName!="TEXTAREA"&&$("#win-annotation .jqte").length<=0){b.preventDefault();b.stopPropagation();return false}};$(document).dblclick(function(b){b.preventDefault();b.stopPropagation();return false});window.onbeforeunload=IDE._onwindowleave;IDE.editingActor=null;Runtime.init();Runtime.blockEvents(true);window.WinToolbar&&WinToolbar.init();Runtime.stage.addListener("selected",function(b){b!=null?IDE.selectAsset(b.sprite):IDE.editingActor!=null&&IDE.selectAsset(null)});Runtime.stage.selectActor(null);
window.WinMediaLib&&WinMediaLib.init();window.WinMediaAssets&&WinMediaAssets.init();WinStage.init();window.WinMediaCapture&&WinMediaCapture.init();window.WinProperties&&WinProperties.init();$("#win-code .properties li a").click(function(){$("#win-code .properties li").removeClass("selected");$(this).parent().addClass("selected");$("#win-code .tab-container .tab").addClass("hidden");$($(this).attr("href")).removeClass("hidden");window.WinProperties&&WinProperties.adjustWindow();WinCode.adjustWindow();
return false});window.WinTools&&WinTools.init();window.WinTools&&WinTools.updateVariables();WinCode.init();WinCode.editBlocksForSprite(null);window.WinProperties&&WinProperties.showBackground();if(window.WinAssets){WinAssets.init();WinAssets.addListener(function(b){IDE.selectAsset(b);IDE.adjustPanels()})}window.WinBackpack&&WinBackpack.init();window.WinPreview&&WinPreview.init();window.WinLessons&&WinLessons.init();window.WinLessons&&WinLessons.Note.init();window.WinAnnotation&&WinAnnotation.init();
window.WinQuiz&&WinQuiz.init();window.WinPuzzle&&WinPuzzle.init();window.WinSidebar&&WinSidebar.init();window.WinPaint&&WinPaint.init();window.Help&&Help.init();window.WinSpine&&WinSpine.init();window.WinMediaSidebar&&WinMediaSidebar.init();window.Avatar&&Avatar.initWhenReady();Blocks.measureText("",defaultCodeLabelFont);Blocks.measureText("",defaultLabelInputFont);$("#stage-resize-handle").draggable({axis:"x",stop:function(){var b=window.innerWidth-$("#stage-resize-handle").offset().left-6-windowPadding-
(window.WinSidebar&&WinSidebar.isVisible&&WinSidebar.isRight?$("#win-sidebar").outerWidth():0);b<120&&(b=120);var c=b,d=window.innerHeight-windowPadding*2-$(".toolbar-top").outerHeight(),b=$("#win-stage"),e=b.find("h1").outerHeight(),f=b.find("#stage-buttons").outerHeight(),g=Runtime.stage.getWidth(),h=Runtime.stage.getHeight(),c=IDE._proportionalSize(g,h,c,d-e-f),g=c.width,h=c.height+e+f;b.css("width",g).css("height",h);$("#win-assets").css("width",g);IDE.adjustPanels()},drag:function(){var b=window.innerWidth-
$("#stage-resize-handle").offset().left-6-windowPadding-(window.WinSidebar&&WinSidebar.isVisible&&WinSidebar.isRight?$("#win-sidebar").outerWidth():0);b<120&&(b=120);var c=b,d=window.innerHeight-windowPadding*2-$(".toolbar-top").outerHeight(),b=$("#win-stage"),e=b.find("h1").outerHeight(),f=b.find("#stage-buttons").outerHeight(),g=Runtime.stage.getWidth(),h=Runtime.stage.getHeight(),c=IDE._proportionalSize(g,h,c,d-e-f),g=c.width,h=c.height+e+f;b.css("width",g).css("height",h);$("#win-assets").css("width",
g);IDE.adjustPanels()}}).css("margin-top",$("#win-stage").offset().top+$("#win-stage").outerHeight()/2);$(".tools-resize-handle").draggable({axis:"y",stop:function(){IDE.adjustPanels()},drag:function(){$("#win-annotation").hasClass("editmode")?$(".deletemask").css("top",$("#win-annotation").position().top+$("#win-annotation").outerHeight()):$(".deletemask").css("top","");IDE.adjustPanels()}});$(window).resize(function(){$("#stage-resize-handle").css("margin-top",$("#win-stage").offset().top+$("#win-stage").outerHeight()/
2);if(WinAnnotation.isVisible&&$("#win-annotation").hasClass("playmode")){var b=$("#win-annotation .entry.selected").attr("data-size");b=="full"?$(".tools-resize-handle").css("top",window.innerHeight-$(".toolbar-top").outerHeight()):b=="half"&&$(".tools-resize-handle").css("top",(window.innerHeight-$(".toolbar-top").outerHeight())/2)}IDE.adjustPanels();$("#win-annotation").hasClass("editmode")?$(".deletemask").css("top",$("#win-annotation").position().top+$("#win-annotation").outerHeight()):$(".deletemask").css("top",
"")});IDE.Clipboard.init();DragLayer.init();window.WinToolbar&&DragLayer.addDragListener(WinToolbar);window.Help&&DragLayer.addDragListener(Help);window.WinBackpack&&DragLayer.addDragListener(WinBackpack);window.WinQuiz&&DragLayer.addDragListener(WinQuiz);window.WinAnnotation&&DragLayer.addDragListener(WinAnnotation);window.WinTools&&DragLayer.addDragListener(WinTools);DragLayer.addDragListener(WinCode);DragLayer.addDragListener(WinStage);window.WinAssets&&DragLayer.addDragListener(WinAssets);window.WinMediaSidebar&&
DragLayer.addDragListener(WinMediaSidebar);IDE._setupSharing();window.innerWidth>=1200?$("#win-stage canvas").css("width",600).css("height",400):$("#win-stage canvas").css("width",450).css("height",300);IDE.adjustPanels();Sprites.addSpriteListener(IDE);window.ideReady&&window.setTimeout(window.ideReady,1);IDE.showProgress()});
IDE.spriteEvent=function(b,c){if(b=="delete"){var d=IDE.editingActor;window.WinAssets&&WinAssets.unregisterActor(c);window.WinTools&&WinTools.unregisterActor(c);Runtime.stage.draw();if(d==c){for(var d=false,e=0;e<Runtime.sprites.length;e++)if(!Runtime.sprites[e].hidden){IDE.selectAsset(Runtime.sprites[e]);d=true;break}d||IDE.selectAsset(null)}}else if(b=="add"){window.WinAssets&&WinAssets.trackActor(c);window.WinTools&&WinTools.trackActor(c);Runtime.stage.draw()}else if(b.substring(0,6)=="update"&&
!IDE._ignoreUpdates){window.WinProperties&&WinProperties.update();window.WinAssets&&WinAssets.update();window.WinTools&&WinTools.trackActor(c);WinCode.editBlocksForSprite(IDE.editingActor);Runtime.stage.draw()}};
IDE.setTitle=function(b){IDE.currentProjectName=b;if(b==null){window.document.title="[tynker]";$("#ide-header .project-title span").text("New Project");$("#ide-header .project-title input").val("New Project")}else{window.document.title=b;$("#ide-header .project-title span").text(b);$("#ide-header .project-title input").val(b);$("#ide-header .title.puzzle").text(b)}};
IDE.setSimplified=function(b){if(b){$("#ideHead2").addClass("simplified");$("#win-editor a.interfaces").removeClass("interfaces").addClass("disabled-interfaces").addClass("disable-hidden");$("#win-editor a.notes").removeClass("notes").addClass("disabled-notes").addClass("disable-hidden");$("#win-editor a.advanced").removeClass("advanced").addClass("disabled-advanced").addClass("disable-hidden");WinTools._skipCodeSearch=true}else{$("#ideHead2").removeClass("simplified");$("#win-editor a.disabled-interfaces").removeClass("disabled-interfaces").addClass("interfaces").removeClass("disable-hidden");
$("#win-editor a.disabled-notes").removeClass("disabled-notes").addClass("notes").removeClass("disable-hidden");$("#win-editor a.disabled-advanced").removeClass("disabled-advanced").addClass("advanced").removeClass("disable-hidden");WinTools._skipCodeSearch=false}};
IDE.selectAsset=function(b){if(!IDE._ignoreUpdates)if(b==null||b==Runtime.background){IDE.editingActor=null;Runtime.stage.selectActor(null);WinCode.editBlocksForSprite(null);window.WinTools&&WinTools.showCategory();window.WinTools&&WinTools.updateVariables();window.WinTools&&WinTools.updateFunctions();window.WinProperties&&WinProperties.showBackground();window.WinProperties&&WinProperties.update();window.WinAssets&&WinAssets.selectAsset(Runtime.background);window.WinProperties&&WinProperties.showInterfacesFor(null)}else{IDE.editingActor=
b;Runtime.stage.selectActor(b.spriteObj);WinCode.editBlocksForSprite(b);window.WinTools&&WinTools.showCategory();window.WinTools&&WinTools.updateVariables();window.WinTools&&WinTools.updateFunctions();b.spriteObj?window.WinProperties&&WinProperties.showSprite(b):window.WinProperties&&WinProperties.showLibrary(b);window.WinProperties&&WinProperties.update();window.WinAssets&&WinAssets.selectAsset(b);window.WinProperties&&WinProperties.showInterfacesFor(b)}};IDE.computeAll=function(){WinCode.computeAll()};
IDE.reset=function(){IDE.Clipboard.clear();Runtime.reset();window.WinAssets&&WinAssets.reset();WinCode.reset();window.WinTools&&WinTools.reset();WinStage.showStopped();IDE.draw()};IDE.draw=function(){WinCode.draw();WinTools.render()};
IDE.addResourceTo=function(b,c,d,e){IDE.dirty();if(b){var f=getFileExt(b),c=getFilename(c),g=RegExp(/avatar:\/\/([0-9a-zA-Z]+)\/([0-9a-zA-Z ]+)\/([0-9]+)/).exec(b);if(g&&g.length){f=".png";c=g[2]+" "+g[3]}else b.indexOf("block://")==0&&(f=".png");if(d)if(d==Runtime.background)if(f==".mp3"||f==".wav"){b=Runtime.background.addSound({name:c,sound:b});IDE.selectAsset(null);window.WinProperties&&WinProperties.show("sounds");IDE.Clipboard.undoAddSound(d,b)}else{if(f==".png"||f==".gif"||f==".jpg"||f==".svg")var h=
Runtime.background.addCostume({name:c,img:b},function(){Runtime.background.setCostumeByName(h.name);IDE.Clipboard.undoAddCostume(d,h)})}else if(f==".mp3"||f==".wav"){b=d.addSound({name:c,sound:b});IDE.selectAsset(d);window.WinProperties&&WinProperties.show("sounds");IDE.Clipboard.undoAddSound(d,b)}else{if(f==".png"||f==".gif"||f==".jpg"||f==".svg")h=d.addCostume({name:c,img:b},function(){d.setCostumeByName(h.name);IDE.Clipboard.undoAddCostume(d,h)})}else{if(f==".png"||f==".gif"||f==".jpg"||f==".svg")return d=
Sprites.addSprite({costumeName:c,img:b,forceNumber:false},function(b){b.spriteObj.setPosition(Runtime.stage.getWidth()/2,Runtime.stage.getHeight()/2);IDE.selectAsset(b);window.WinProperties&&WinProperties.show("looks");IDE.Clipboard.undoAddActor(b);e&&e(b)});f==".actor"&&ObjectIO.loadSprite(b,function(b){b.spriteObj.setPosition(Runtime.stage.getWidth()/2,Runtime.stage.getHeight()/2);Runtime.stage.draw();IDE.computeAll();IDE.draw();IDE.selectAsset(b);window.WinProperties&&WinProperties.show("interfaces");
IDE.Clipboard.undoAddActor(b);e&&e(b)})}}else if(!d){d=Sprites.addSprite({costumeName:"blank",img:"ide/imgs/blank.png",forceNumber:false});d.spriteObj.setPosition(Runtime.stage.getWidth()/2,Runtime.stage.getHeight()/2);IDE.selectAsset(d);IDE.Clipboard.undoAddActor(d);e&&e(d)}return null};IDE.cloneActor=function(b){IDE.dirty();b=b.cloneActor();b.spriteObj.setPosition(b.spriteObj.x+20,b.spriteObj.y+20);IDE.Clipboard.undoCloneActor(b);return b};
IDE._handleKeyPress=function(b){if((b.target.tagName!="INPUT"||b.target.getAttribute("id")=="ioskeyboard")&&b.target.tagName!="TEXTAREA"&&$("#win-annotation .jqte").length<=0){var c=b.which;if(c===void 0)c=b.keyCode;var d=b.charCode;d===void 0&&(d=c);if(d)if(window.WinPaint&&!$("#win-paint").hasClass("hidden")){if(WinPaint._onKeyPress(c,d)){b.preventDefault();b.stopPropagation();return true}}else if(WinCode._onKeyPress(c,d)){b.preventDefault();b.stopPropagation();return true}}return false};
IDE._handleKeyUp=function(){return false};
IDE._handleKeyDown=function(b){if((b.target.tagName!="INPUT"||b.target.getAttribute("id")=="ioskeyboard")&&b.target.tagName!="TEXTAREA"&&$("#win-annotation .jqte").length<=0){var c=b.which;if(c===void 0)c=b.keyCode;var d=b.charCode;d===void 0&&(d=c);if(window.WinPaint&&!$("#win-paint").hasClass("hidden")){if(WinPaint._onKeyPress(c,d)){b.preventDefault();b.stopPropagation();return true}}else{if(WinCode._onKeyPress(c,d)){b.preventDefault();b.stopPropagation();return true}if(c==8&&WinAssets._enableDelete&&
WinAssets.getSelection()){if(!window.WinCode||window.WinCode._inputField==null){WinAssets.deleteActor();b.preventDefault();b.stopPropagation();return true}return false}}if(IDE._enableKeyboardShortcuts&&(b.metaKey||b.ctrlKey)){if(b.which==83){$("#wincmd-save").hasClass("disabled")||(window.WinPaint&&!$("#win-paint").hasClass("hidden")?WinPaint.save():IDE.cmdProjectSave());b.preventDefault();b.stopPropagation();return false}if(b.which==79){$("#wincmd-open").hasClass("disabled")||IDE.cmdProjectOpen();
b.preventDefault();b.stopPropagation();return false}if(b.which==78){$("#wincmd-new").hasClass("disabled")||IDE.cmdProjectNew();b.preventDefault();b.stopPropagation();return false}if(b.which==90){$("#wincmd-undo").hasClass("disabled")||(window.WinPaint&&!$("#win-paint").hasClass("hidden")?WinPaint.cmdUndo():IDE.cmdUndo());b.preventDefault();b.stopPropagation();return false}if(b.which==89){$("#wincmd-redo").hasClass("disabled")||(window.WinPaint&&!$("#win-paint").hasClass("hidden")?WinPaint.cmdRedo():
IDE.cmdRedo());b.preventDefault();b.stopPropagation();return false}if(b.which==88){if(window.WinCode&&window.WinCode._inputField)return false;$("#wincmd-cut").hasClass("disabled")||(window.WinPaint&&!$("#win-paint").hasClass("hidden")?WinPaint.cmdCut():WinCode.getSelection().length>0?WinCode.cutSelection():window.WinAssets&&WinAssets.getSelection()&&WinAssets.cutActor());b.preventDefault();b.stopPropagation();return false}if(b.which==67){if(window.WinCode&&window.WinCode._inputField)return false;
$("#wincmd-copy").hasClass("disabled")||(window.WinPaint&&!$("#win-paint").hasClass("hidden")?WinPaint.cmdCopy():WinCode.getSelection().length>0?WinCode.copySelection():window.WinAssets&&WinAssets.getSelection()&&WinAssets.copyActor());b.preventDefault();b.stopPropagation();return false}if(b.which==86){if(window.WinCode&&window.WinCode._inputField)return false;$(this).hasClass("disabled")||(window.WinPaint&&!$("#win-paint").hasClass("hidden")?WinPaint.cmdPaste():IDE.Clipboard.get("blocks")?WinCode.pasteSelection():
window.WinAssets&&IDE.Clipboard.get("sprite")&&WinAssets.pasteActor());b.preventDefault();b.stopPropagation();return false}if(b.which==66){IDE.cmdBackpack();b.preventDefault();b.stopPropagation();return false}if(b.which==70){WinTools.showSearch();b.preventDefault();b.stopPropagation();return false}}if(c==8){b.preventDefault();b.stopPropagation();return true}}return false};
IDE._touchHandler=function(b){var c=b.changedTouches[0],d="";switch(b.type){case "touchstart":d="mousedown";IDE.lastTouchDown=Date.now();break;case "touchmove":d="mousemove";IDE.lastTouchDown=-1;break;case "touchend":if(IDE.lastTouchDown>-1&&Date.now()-IDE.lastTouchDown<IDE.clickms){IDE.lastTouchDown=-1;d="click";break}d="mouseup";break;default:return}var e=document.createEvent("MouseEvent");e.initMouseEvent(d,true,true,window,1,c.screenX,c.screenY,c.clientX,c.clientY,false,false,false,false,0,null);
c.target.dispatchEvent(e);b.preventDefault()};IDE.dirty=function(){IDE.isDirty++;window.onbeforeunload=IDE._onwindowleave;var b=$("#wincmd-tbsave").addClass("need-save").find("span");b.text(b.attr("data-changed"))};IDE._clearDirty=function(){IDE.isDirty=0;window.onbeforeunload=null;var b=$("#wincmd-tbsave").removeClass("need-save").find("span");b.text(b.attr("data-unchanged"))};
IDE._onwindowleave=function(b){if(!IDE._ignoreDirty&&IDE.isDirty&&window.location.href.indexOf("l=")<0){if(b=b||window.event)b.returnValue="You have unsaved changes. Are you sure you wish to leave the IDE?";return"You have unsaved changes. Are you sure you wish to leave the IDE?"}};IDE.showProgress=function(b){if(b){$("#progress").removeClass("hidden").find(">div").removeClass("hidden");IDE._progressStack++}else{IDE._progressStack--;IDE._progressStack<=0&&$("#progress").addClass("hidden").find(">div").addClass("hidden")}};
IDE.showPopup=function(b,c){$("#popupdialog div.content").empty().html(b);$("#popupdialog > .buttons a").unbind().click(function(){UIUtil.hideDialog($("#popupdialog"));$("#popupdialog div.content").empty();c&&c();return false});UIUtil.showDialog($("#popupdialog"),function(){$("#popupdialog div.content").empty();c&&c()},true)};function showInfoPopup(b,c,d,e,f){IDE.showInfoPopup(b,c,d,e,f)}
IDE.showInfoPopup=function(b,c,d,e,f){var g=$("#infopopup").empty().css("z-index","100001");if(b){try{var h=$(b)}catch(j){h=$("<div>"+b+"</div>")}h.find("code").each(function(){var b=$(this).text();try{if(window.RenderCode){var c=RenderCode.getCodeType();RenderCode.setCodeType("tynker")}var d=JSON.parse(b),e=ObjectIO.deserializeScriptStep(d);$(this).css("display","inline-block").empty().append(e.getImage()).append('<q style="display:none">'+b+"</q>");window.RenderCode&&RenderCode.setCodeType(c)}catch(f){}});
g.append('<div class="messageBody"></div>');if(c){g.addClass("wCharacter").find(".messageBody").addClass("cb").append('<div class="characterWrap"></div>').find(".characterWrap").append(c);g.find(".messageBody").append('<div class="content"></div>').find(".content").append(h)}else{g.removeClass("wCharacter");g.find(".messageBody").append(h)}d&&g.append('<div class="messageFooter"></div>').find(".messageFooter").append(d);e&&g.append('<a class="closeBox" href="#"></a>').find("a.closeBox").click(function(){$(this).parents(".messageBox").addClass("hidden");
$(".dialog-modal-bg").detach();return false});g.removeClass("hidden");if(f){b=$('<div class="dialog-modal-bg"></div>');b.css("z-index","100000");g.after(b)}else $(".dialog-modal-bg").detach();g.css("top",(window.innerHeight-g.height())/2).css("left",(window.innerWidth-g.width())/2)}else{g.addClass("hidden");$(".dialog-modal-bg").detach()}};
IDE.showInfoDialog=function(b,c,d){$("#infodialog").empty().append(c).modal({escapeClose:false,clickClose:false,showClose:true});$("#infodialog").on("modal:close",function(){d&&d()})};IDE.promptDialog=function(b,c){$("#prompt div.prompt").text(b);$("#prompt").modal({escapeClose:false,clickClose:false,showClose:true});$("#prompt a.okBtn").unbind().click(function(){$.modal.close();c&&c($("#prompt input").val());return false})};
IDE.confirmDialog=function(b,c,d,e,f,g){$("#confirm span").text(b);$("#confirm").modal({escapeClose:g?true:false,clickClose:g?true:false,showClose:g?true:false});$("#confirm .buttonbar").empty();b=$('<a href="#" class="btn-right btn-round medium action">'+(d?d:"Yes")+"</a>");b.click(function(){$.modal.close();c&&c();return false});$("#confirm .buttonbar").append(b);b=$('<a href="#" class="btn-right btn-round medium secondary">'+(e?e:"No")+"</a>");b.click(function(){$.modal.close();f&&f();return false});
$("#confirm .buttonbar").append(b)};IDE.alertDialog=function(b,c){$("#alert span").text(b);$("#alert").modal({escapeClose:false,clickClose:false,showClose:false});$("#alert a.okBtn").unbind().click(function(){$.modal.close();c&&c();return false})};IDE._proportionalSize=function(b,c,d,e){return d*c/b<e?{width:d,height:parseInt(d*c/b)}:{width:parseInt(e*b/c),height:e}};
IDE.adjustPanels=function(){var b,c=0;b=$(".toolbar-top");b.hasClass("hidden")||(c=c+b.outerHeight());b=$(".notification-top");b.hasClass("hidden")||(c=c+b.outerHeight());b=$("#puzzle-toolbar");if(!b.hasClass("hidden")){b.css("top",c);c=c+b.outerHeight()}b=$("#director-info");if(!b.hasClass("hidden")){b.css("top",c);c=c+b.outerHeight()}var d=0;$("#puzzle-navbar").hasClass("hidden")||(d=d+($("#puzzle-navbar").outerHeight()+windowPadding));var e=windowPadding,f=windowPadding,g=window.innerHeight-c-
d,h=window.innerWidth-e-f,j=$("#win-stage");j.css("box-shadow","").draggable({disabled:true}).resizable({disabled:true});var k=!j.hasClass("hidden"),l=$("#win-editor"),m=!l.hasClass("hidden"),n=$("#win-assets"),q=n.find(".actors").scrollTop(),p=n.find(".actors").scrollLeft();n.css("bottom","").css("top","").css("left","").css("right","").css("width","").css("height","").removeClass("noactions");var s=!n.hasClass("hidden");b=$("#win-sidebar");var r=$("#win-media-sidebar"),o=!b.hasClass("hidden"),t=
!r.hasClass("hidden"),u=$("#stage-resize-handle"),c=c+windowPadding,g=g-windowPadding;if(window.WinSidebar&&o){b.css("top",c).css("left",e).css("height",g);e=e+(b.outerWidth()+windowPadding);h=h-(b.outerWidth()+windowPadding)}if(window.WinMediaSidebar&&t){if(WinAnnotation.isVisible){e=250;h=h-e;$("#win-annotation").css("height","")}r.css("top",c).css("left",e).css("height",g);e=e+(r.outerWidth()+windowPadding);h=h-(r.outerWidth()+windowPadding)}b=$("#win-levels");if(!b.hasClass("hidden")){b.css("bottom",
0).css("left",e);g=g-(b.outerHeight()+b.find(".leveltoggle").outerHeight())}if(m&&l.hasClass("docked")&&!n.hasClass("strip")){if(s){n.css("top",c).css("bottom","").css("left",e).css("right",0).css("width","auto").css("height",n.find("li:first").outerHeight()).addClass("noactions").find(".actors").scrollTop(q).scrollLeft(p);c=c+n.outerHeight();g=g-n.outerHeight()}s=j.find("h1:visible").outerHeight()+0;b=j.find("#stage-buttons:visible").outerHeight()+0;m=Runtime.stage.getWidth();r=Runtime.stage.getHeight();
r=IDE._proportionalSize(m,r,h,g-s-b);m=r.width;r=r.height+s+b;if(j.hasClass("centeredframe")){f=0;l.css("top",c+f+(Runtime.stage.text?80:0)).css("left",e).css("height",g-f*2);if(l.hasClass("minimized")){l.find("#win-tools").css("top","");n.css("margin-left","")}else{l.find("#win-tools").css("top",-n.outerHeight()-4);n.css("margin-left",l.find("#win-tools").outerWidth())}j.css("top",(g-r)/2+c).css("left",(h-m)/2+e).css("height",r).css("width",m);l.css("width",window.innerWidth-100)}else{f=10;l.css("top",
c+f+(Runtime.stage.text?80:0)).css("left",(h-m)/2+e).css("height",r-f*2-(Runtime.stage.text?80:0));j.css("top",c).css("left",(h-m)/2+e).css("height",r).css("width",m);l.css("width",j.outerWidth()-100)}WinStage.adjustWindow();u.addClass("hidden");l.hasClass("minimized")?l.css("width",30):l.hasClass("maximized")&&l.css("width",window.innerWidth-f);window.WinCode&&WinCode.adjustWindow();window.WinTools&&WinTools.adjustWindow()}else if(m&&l.hasClass("docked")&&n.hasClass("strip")){f=10;n.css("width",
"").find(".actors").scrollTop(q).scrollLeft(p);s=j.find("h1:visible").outerHeight()+0;b=j.find("#stage-buttons:visible").outerHeight()+0;m=Runtime.stage.getWidth();r=Runtime.stage.getHeight();k=$("#win-assets").outerWidth();if(j.hasClass("centeredframe")){h=h-20;g=g-20}r=IDE._proportionalSize(m,r,h,g-s-b);m=r.width;r=r.height+s+b;if(j.hasClass("centeredframe")){h=h+20;g=g+20;n.css("top",c+f+(Runtime.stage.text?80:0)).css("left",e).css("height",g-f*2).find(".actors").scrollTop(q).scrollLeft(p);l.css("top",
c+f+(Runtime.stage.text?80:0)).css("left",e+k).css("height",g-f*2);j.css("top",(g-r)/2+c).css("left",(h-m)/2+e).css("height",r).css("width",m)}else{n.css("top",c+f+(Runtime.stage.text?80:0)).css("left",(h-m)/2+e).css("height",r-f*2-(Runtime.stage.text?80:0)).find(".actors").scrollTop(q).scrollLeft(p);l.css("top",c+f+(Runtime.stage.text?80:0)).css("left",(h-m)/2+e+k).css("height",r-f*2-(Runtime.stage.text?80:0));j.css("top",c).css("left",(h-m)/2+e).css("height",r).css("width",m)}WinStage.adjustWindow();
u.addClass("hidden");l.hasClass("minimized")?l.css("width",30):l.hasClass("maximized")?l.css("width",m-f):$("#win-code").hasClass("hastools")?l.css("width",m*3/4):l.css("width",m/2);window.WinAssets&&WinAssets.adjustWindow();window.WinCode&&WinCode.adjustWindow();window.WinTools&&WinTools.adjustWindow()}else if(k&&!m&&!s){s=j.find("h1:visible").outerHeight()+0;b=j.find("#stage-buttons:visible").outerHeight()+0;m=Runtime.stage.getWidth();r=Runtime.stage.getHeight();if(j.hasClass("centeredframe")){h=
h-20;g=g-20}r=IDE._proportionalSize(m,r,h,g-s-b);m=r.width;r=r.height+s+b;if(j.hasClass("centeredframe")){h=h+20;j.css("top",(g+20-r)/2+c).css("left",(h-m)/2+e).css("height",r).css("width",m)}else j.css("top",c).css("left",(h-m)/2+e).css("height",r).css("width",m);WinStage.adjustWindow();u.addClass("hidden")}else if(!k&&m&&!s){l.css("top",c).css("left",e).css("width",h).css("height",g);window.WinCode&&WinCode.adjustWindow();window.WinTools&&WinTools.adjustWindow();u.addClass("hidden")}else if(!k&&
!m&&s){n.css("top",c).css("left",e).css("width",h).css("height",g).find(".actors").scrollTop(q).scrollLeft(p);window.WinAssets&&WinAssets.adjustWindow();u.addClass("hidden")}else if(m&&k&&!s){s=j.find("h1:visible").outerHeight()+0;b=j.find("#stage-buttons:visible").outerHeight()+0;m=j.outerWidth();m>h-windowPadding-300&&(m=h-windowPadding-300);r=m*Runtime.stage.getHeight()/Runtime.stage.getWidth();r=IDE._proportionalSize(m,r,m,g-s-b);m=r.width;r=r.height+s+b;IDE._layoutFlush&&(g=r);IDE._layoutTop?
j.css("top",c):j.css("top",(g-r)/2+c);j.css("left",window.innerWidth-f-m).css("height",r).css("width",m-100);WinStage.adjustWindow();l.css("top",c).css("left",e).css("width",h-m-windowPadding).css("height",g);window.WinCode&&WinCode.adjustWindow();window.WinTools&&WinTools.adjustWindow();u.removeClass("hidden").css("top",0).css("left",window.innerWidth-f-m-(windowPadding-u.outerWidth()/2))}else if(k&&s&&!m){s=j.find("h1:visible").outerHeight()+0;b=j.find("#stage-buttons:visible").outerHeight()+0;
m=j.outerWidth();m>h-windowPadding-300&&(m=h-windowPadding-300);r=m*Runtime.stage.getHeight()/Runtime.stage.getWidth();r=IDE._proportionalSize(m,r,m,g-s-b);m=r.width;r=r.height+s+b;j.css("top",(g-r)/2+c).css("left",window.innerWidth-f-m).css("height",r).css("width",m);WinStage.adjustWindow();n.css("top",c).css("left",e).css("width",h-m-windowPadding).css("height",g).find(".actors").scrollTop(q).scrollLeft(p);window.WinAssets&&WinAssets.adjustWindow();u.removeClass("hidden").css("top",0).css("left",
window.innerWidth-f-m-(windowPadding-u.outerWidth()/2))}else if(m&&s&&!k)if($("#win-editor").hasClass("fullscreen")){n.css("top",c).css("bottom","").css("left",e).css("right",0).css("width","auto").css("height",n.find("li:first").outerHeight()).addClass("noactions");g=g-n.outerHeight();l.css("top",c+n.outerHeight()).css("left",e).css("width",h).css("height",g);window.WinCode&&WinCode.adjustWindow();window.WinTools&&WinTools.adjustWindow();n.css("left",e+$("#win-tools").outerWidth()).find(".actors").scrollTop(q).scrollLeft(p);
u.addClass("hidden")}else{d=$("#win-assets div.background li").outerWidth()*3;k=n.outerWidth();k<d&&(k=d);n.css("top",c).css("left",window.innerWidth-e-k).css("width",k).css("height",g).find(".actors").scrollTop(q).scrollLeft(p);window.WinAssets&&WinAssets.adjustWindow();h=h-windowPadding-n.outerWidth();l.css("top",c).css("left",e).css("width",h).css("height",g);window.WinCode&&WinCode.adjustWindow();window.WinTools&&WinTools.adjustWindow();u.removeClass("hidden").css("top",0).css("left",window.innerWidth-
f-k-(windowPadding-u.outerWidth()/2))}else if(m&&k&&s)if($("#win-editor").hasClass("fullscreen")){n.css("top",c).css("bottom","").css("left",e).css("right",0).css("width","auto").css("height",n.find("li:first").outerHeight()).addClass("noactions").find(".actors").scrollTop(q).scrollLeft(p);g=g-n.outerHeight();j.css("box-shadow","8px 8px 8px rgba(0,0,0,0.5)").draggable({disabled:false}).resizable({disabled:false,resize:function(){WinStage.adjustWindow()}});l.css("top",c+n.outerHeight()).css("left",
e).css("width",h).css("height",g);window.WinCode&&WinCode.adjustWindow();window.WinTools&&WinTools.adjustWindow();u.addClass("hidden")}else{k=n.find("h1:visible").outerHeight()+0;k=$("#win-assets div.background li").outerHeight()+4+8+k;s=j.find("h1:visible").outerHeight()+0;b=j.find("#stage-buttons:visible").outerHeight()+0;m=j.outerWidth();r=m*Runtime.stage.getHeight()/Runtime.stage.getWidth();r=IDE._proportionalSize(m,r,m,g-s-b-k-windowPadding);m=r.width;r=r.height+s+b;j.css("top",c).css("left",
window.innerWidth-f-m).css("width",m).css("height",r);WinStage.adjustWindow();k=m;j=g-r-windowPadding;n.css("top",window.innerHeight-d-j).css("left",window.innerWidth-f-k).css("width",k).css("height",j).find(".actors").scrollTop(q).scrollLeft(p);window.WinAssets&&WinAssets.adjustWindow();l.css("left",e).css("top",c).css("width",h-m-windowPadding).css("height",g);window.WinCode&&WinCode.adjustWindow();window.WinTools&&WinTools.adjustWindow();u.removeClass("hidden").css("top",0).css("left",window.innerWidth-
f-m-(windowPadding-u.outerWidth()/2))}!$("#mask-left").hasClass("hidden")&&IDE._maskElement&&IDE.showMaskElement(IDE._maskElement,IDE._maskDragging);$("#stage-resize-handle").css("margin-top",$("#win-stage").offset().top+$("#win-stage").outerHeight()/2);$(".tools-resize-handle").css("margin-left",121)};
IDE.showMaskElement=function(b,c,d,e){if(b&&b.length>0){b[0].tagName!="CANVAS"&&b.addClass("winhilight");var f=b.filter(":visible");if(f&&f.length>0)b=f;else(f=b.find(":visible"))&&f.length>0&&(b=f);var f=b.offset().left,g=b.offset().top,h=b.outerWidth(),j=b.outerHeight();IDE._maskElement=b;if(IDE._maskDragging=c){c.x=parseInt(c.x);c.y=parseInt(c.y);c.width=parseInt(c.width);c.height=parseInt(c.height)}$("#mask-left").removeClass("hidden").unbind();$("#mask-right").removeClass("hidden").unbind();
$("#mask-top").removeClass("hidden").unbind();$("#mask-bottom").removeClass("hidden").unbind();if(!e){$("#mask-left").click(IDE.revealPointer);$("#mask-right").click(IDE.revealPointer);$("#mask-top").click(IDE.revealPointer);$("#mask-bottom").click(IDE.revealPointer)}var k=0,b=$(".toolbar-top");!b.hasClass("hidden")&&!$.modal.isActive()&&(k=b.outerHeight());if(d){$("#mask-overlay").removeClass("hidden").css("top",g).css("bottom",window.innerHeight-(g+j)).css("left",f).css("right",window.innerWidth-
(f+h));$("#mask-left").css("background-color","rgba(0, 0, 0, 0.6)");$("#mask-right").css("background-color","rgba(0, 0, 0, 0.6)");$("#mask-top").css("background-color","rgba(0, 0, 0, 0.6)");$("#mask-bottom").css("background-color","rgba(0, 0, 0, 0.6)")}else{$("#mask-left").css("background-color","rgba(0, 0, 0, 0)");$("#mask-right").css("background-color","rgba(0, 0, 0, 0)");$("#mask-top").css("background-color","rgba(0, 0, 0, 0)");$("#mask-bottom").css("background-color","rgba(0, 0, 0, 0)")}c?$("#mask-left").css("left",
$("#win-code .code canvas").offset().left).css("top",k).css("right",window.innerWidth-f):$("#mask-left").css("left",c?$("#win-tools").outerWidth():0).css("top",k).css("right",window.innerWidth-f);$("#mask-right").css("top",k).css("left",f+h);$("#mask-top").css("left",f).css("right",window.innerWidth-(f+h)).css("top",k).css("bottom",window.innerHeight-g);$("#mask-bottom").css("left",f).css("right",window.innerWidth-(f+h)).css("top",g+j);if(c){$("#toolmask-left").removeClass("hidden").css("background-color",
"rgba(0, 0, 0, 0)");$("#toolmask-right").removeClass("hidden").css("background-color","rgba(0, 0, 0, 0)");$("#toolmask-top").removeClass("hidden").css("background-color","rgba(0, 0, 0, 0)");$("#toolmask-bottom").removeClass("hidden").css("background-color","rgba(0, 0, 0, 0)");$("#toolmask-left").css("top",k).css("right",window.innerWidth-c.x+4);$("#toolmask-right").css("top",k).css("right",window.innerWidth-$("#win-code").offset().left-200).css("left",c.x+c.width+4);if(c.x+c.width+4>$("#win-tools .palette .blocks").offset().left+
$("#win-tools .palette .blocks").outerWidth()){$("#toolmask-top").css("left",c.x-4).css("right",window.innerWidth-$("#win-tools .palette .blocks").offset().left-$("#win-tools .palette .blocks").outerWidth()).css("top",k).css("bottom",window.innerHeight-c.y+4);$("#toolmask-bottom").css("left",c.x-4).css("right",window.innerWidth-$("#win-tools .palette .blocks").offset().left-$("#win-tools .palette .blocks").outerWidth()).css("top",c.y+c.height+4)}else{$("#toolmask-top").css("left",c.x-4).css("right",
window.innerWidth-(c.x+c.width)-4).css("top",k).css("bottom",window.innerHeight-c.y+4);$("#toolmask-bottom").css("left",c.x-4).css("right",window.innerWidth-(c.x+c.width)-4).css("top",c.y+c.height+4)}e||$("#mask-pointer").css("left",c.x+c.width-30).css("top",c.y+c.height)}else{$("#toolmask-left").addClass("hidden");$("#toolmask-right").addClass("hidden");$("#toolmask-top").addClass("hidden");$("#toolmask-bottom").addClass("hidden");e||$("#mask-pointer").css("left",f+h-30).css("top",g+j)}}else{$("#mask-left").removeClass("hidden").css("left",
0).css("top",k).css("right",0).css("bottom",0);$("#mask-right").addClass("hidden");$("#mask-top").addClass("hidden");$("#mask-bottom").addClass("hidden");$("#mask-pointer").addClass("hidden");$("#toolmask-left").addClass("hidden");$("#toolmask-right").addClass("hidden");$("#toolmask-top").addClass("hidden");$("#toolmask-bottom").addClass("hidden")}IDE.showAnnotation({hasContent:true})&&IDE.showAnnotation({show:true})};
IDE.bouncePointer=function(){IDE._bounceX=$("#mask-box").offset().left;IDE._bounceCount=10;window.setTimeout(IDE._bouncePointer,50)};IDE._bouncePointer=function(){IDE._bounceCount--;$("#mask-box").css("left",IDE._bounceX+(5-IDE._bounceCount%2*10));IDE._bounceCount>0?window.setTimeout(IDE._bouncePointer,50):$("#mask-box").css("left",IDE._bounceX)};IDE.revealPointer=function(){IDE.showAnnotation({hasContent:true})&&IDE.showAnnotation({unhide:true})};
IDE.showAnnotation=function(b){var c={el:IDE._maskElement,pos:null,bgcolor:null,text:null,show:true,showClose:true,preferVertical:false,preferInset:false,preferOffset:true,buttons:[]};$.extend(c,b);var d=$("#mask-box");if(c.isVisible)return!d.hasClass("hidden");if(c.hasContent)return d.find("div.content").text()!="";if(c.unhide)$("#mask-box").removeClass("hidden");else{d.removeClass("pointleft").removeClass("pointright").removeClass("pointup").removeClass("pointdown").removeClass("left").removeClass("center").removeClass("right").removeClass("top").removeClass("middle").removeClass("bottom");
if(c.text!==null){d.find("div.content").empty().append(c.text);c.showClose?d.find("a.close").removeClass("hidden").click(function(){d.addClass("hidden");c.closeCallback&&c.closeCallback();return false}):d.find("a.close").addClass("hidden");c.bgcolor?d.css("background-color",c.bgcolor):d.css("background-color","")}if(c.show){d.removeClass("hidden");var b="pointleft",e="middle",f=0,g=0;if(c.el||c.pos){if(c.pos)var f=c.pos.x,g=c.pos.y,h=c.pos.width,j=c.pos.height;else{f=c.el.offset().left;g=c.el.offset().top;
h=c.el.outerWidth();j=c.el.outerHeight()}var k=c.preferOffset===true?15:c.preferOffset,l=c.preferInset===true?30:c.preferInset;if(c.preferVertical)if(g>window.innerHeight/2){b="pointdown";if(f+(h-d.outerWidth())/2<0){e="left";f=f+h/2-d.outerWidth()*0.125}else if(f+(h+d.outerWidth())/2>window.innerWidth){e="right";f=f+h/2-d.outerWidth()*0.875}else{e="middle";f=f+(h-d.outerWidth())/2}g=g-d.outerHeight()-k;c.preferInset&&(g=g+l)}else{b="pointup";if(f+(h-d.outerWidth())/2<0){e="left";f=f+h/2-d.outerWidth()*
0.125}else if(f+(h+d.outerWidth())/2>window.innerWidth){e="right";f=f+h/2-d.outerWidth()*0.875}else{e="middle";f=f+(h-d.outerWidth())/2}g=g+j+k;c.preferInset&&(g=g-l)}else if(f>window.innerWidth/2){b="pointright";e="middle";f=f-d.outerWidth()-k;g=g+(j-d.outerHeight())/2;c.preferInset&&(f=f+l)}else{b="pointleft";e="middle";f=f+h+k;g=g+(j-d.outerHeight())/2;c.preferInset&&(f=f-l)}d.css("left",f).css("top",g).addClass(b).addClass(e)}else{b="";f=(window.innerWidth-d.outerWidth())/2;g=(window.innerHeight-
d.outerHeight())/2;d.css("left",f).css("top",g)}}else d.addClass("hidden");if($(c.el).parents("#win-code").length>0){d=$("#mask-box");h=d.outerWidth();j=d.outerHeight();d.css("left",$("#win-code").offset().left+$("#win-code").outerWidth()-d.outerWidth()/8)}}};IDE.hideMask=function(){$(".winhilight").removeClass("winhilight");$("div.mask").addClass("hidden");$("#maskoverlay").addClass("hidden");$("#mask-pointer").addClass("hidden");IDE._maskElement=null;IDE._maskDragging=null};
IDE.updateLastSaved=function(){var b=Date.now()-IDE._lastSaved,c="";if(b<6E4){b=Math.round(b/1E3);c=b==1?b+" "+g_loc.getText("time.second"):b+" "+g_loc.getText("time.seconds")}else if(b<36E5){b=Math.round(b/6E4);c=b==1?b+" "+g_loc.getText("time.minute"):b+" "+g_loc.getText("time.minutes")}else if(b<864E5){b=Math.round(b/36E5);c=b==1?b+" "+g_loc.getText("time.hour"):b+" "+g_loc.getText("time.hours")}else if(b<2592E6){b=Math.round(b/864E5);c=b==1?b+" "+g_loc.getText("time.day"):b+" "+g_loc.getText("time.days")}else if(b<
31536E6){b=Math.round(b/2592E6);c=b==1?b+" "+g_loc.getText("time.month"):b+" "+g_loc.getText("time.months")}else{b=Math.round(b/31536E6);c=b==1?b+" "+g_loc.getText("time.year"):b+" "+g_loc.getText("time.years")}$(".toolbar-top .saved-indicator").text(g_loc.formatText("menu.savedindicator",c))};
IDE.showFlashAnimation=function(b,c,d){$("#baselayer").detach();$("#toplayer").detach();$("body").append('<div id="baselayer" class="'+b+'"></div>').append('<div id="toplayer" class="'+c+'"></div>');$("#baselayer").css("top",window.innerHeight/2).css("left",window.innerWidth/2).animate({width:500,height:500,top:(window.innerHeight-500)/2,left:(window.innerWidth-500)/2},{duration:1500,easing:"easeOutElastic",complete:function(){$("#baselayer").animate({width:0,height:0,top:window.innerHeight/2,left:window.innerWidth/
2},500)}});window.setTimeout(function(){$("#toplayer").css("top",window.innerHeight/2).css("left",window.innerWidth/2).animate({width:500,height:500,top:(window.innerHeight-500)/2,left:(window.innerWidth-500)/2},{duration:1E3,easing:"easeOutElastic",complete:function(){$("#toplayer").animate({width:0,height:0,top:window.innerHeight/2,left:window.innerWidth/2},500,d)}})},250)};
IDE.captureScreenshot=function(){var b=Runtime.stage.captureScreenshot(true),c=600/b.width,d=600,e=c*b.height;if(e<400){c=400/b.height;e=400;d=c*b.width}$("body > canvas.screenshot").detach();c=$('<canvas class="screenshot" width="600" height="400"></canvas>')[0].getContext("2d");c.drawImage(b,0,0,d,e);WinCode.relayoutBlocks();c.drawImage(WinCode.canvas,0,0);return c.canvas.toDataURL()};IDE._setupSharing=function(){};
IDE.showCategories=function(){$.ajax({url:"api/templates.aspx",success:function(b){$(".projecttemplates-modal").modal();$(".projecttemplates-modal .projecttemplates-title a.back").addClass("hidden").unbind().click(IDE.showCategories);var c=$(".projecttemplates-container");c.empty();c.scrollTop(0);for(var d=0;d<b.length;d++)if(b[d].img){var e=$('<div class="projecttemplates-category" data-cat="'+b[d].id+'"></div>');e.append('<img src="ide/imgs/templates/'+b[d].img+'" />');var f=$("<span></span>");
f.text(b[d].name);e.append(f);c.append(e);b[d].id=="blank"?e.click(function(){IDE.cmdExit("ide/");return false}):e.click(function(){IDE.showCategory($(this).attr("data-cat"));return false})}}});return false};
IDE.showCategory=function(b){$.ajax({url:"api/templates.aspx",data:{id:b?b:"default"},success:function(b){$(".projecttemplates-modal").modal();$(".projecttemplates-modal .projecttemplates-title a.back").addClass("hidden");var d=$(".projecttemplates-container");d.empty();d.scrollTop(0);for(var e=0;e<b.length;e++)if(b[e].img){var f=$('<div class="projecttemplates-project" data-id="'+b[e].id+'"></div>');f.append('<div class="projecttemplates-screenshot" style="background-image:url('+b[e].img+')"></div>');
f.append('<div class="projecttemplates-frame"></div>');b[e].difficulty&&f.append('<div class="projecttemplates-difficulty '+b[e].difficulty+'"></div>');var g=$("<span></span>");g.text(b[e].name);f.append(g);d.append(f);f.click(function(){var b=$(this).attr("data-id");b=="blank"?IDE.cmdExit("ide/"):IDE.cmdExit("ide/?p="+b);return false})}}});return false};IDE.cmdProjectNew=function(){IDE.showCategory();return false};
IDE.cmdProjectOpen=function(){Runtime.stage.selectActor(null);var b=Runtime.stage.captureScreenshot();IDE._doProjectSave(IDE.currentProjectName,IDE.currentProjectDescription,b,false,true,Runtime.currentLevelIndex,null,function(b){if(b)window.location="?p="+IDE.currentProjectId});b=$("#open-project");b.find("iframe").attr("src","/api/openproject.php");b.modal();return false};IDE.cmdBackpack=function(){WinBackpack.show();return false};
IDE.cmdProjectExport=function(){var b=$("#importexportdlg");b.find("textarea").val(ObjectIO.serialize());b.find(".importBtn").addClass("hidden");b.find(".cancelBtn").unbind().click(function(){$.modal.close();return false});b.modal();return false};
IDE.cmdProjectImport=function(){var b=$("#importexportdlg");b.find("textarea").val("");b.find(".importBtn").removeClass("hidden").unbind().click(function(){IDE.Clipboard.clear();var c=b.find("textarea").val();IDE.setTitle(null);IDE.currentProjectId=null;ObjectIO.deserialize(c);$.modal.close();return false});b.find(".cancelBtn").unbind().click(function(){$.modal.close();return false});b.modal();return false};
IDE.createLessonBundle=function(){$("#importexportdlg textarea").val("");for(var b=ObjectIO.serializeLesson(),c={"default":{name:b.name,description:b.description,instructions:b.instructions}},d=0;d<b.notes.length;d++){var e=b.notes[d];e.milestoneType==1?c["default"]["-1-"+e.id]=e.text:e.milestoneType==2?c["default"]["-2-"+e.id]=e.text:e.milestoneType==3?c["default"]["-3-"+e.id]=e.text:e.milestoneType==4?c["default"]["-4-"+e.id]=e.text:!e.block&&!e.attached&&!e.resource&&!e.properties?c["default"]["-0-"+
e.id]=e.text:c["default"][e.id]=e.text}b=$("#importexportdlg");b.find("textarea").val(JSON.stringify(c,null,"\t"));b.find(".importBtn").addClass("hidden");b.find(".cancelBtn").unbind().click(function(){$.modal.close();return false});b.modal();return false};
IDE._extractText=function(b,c){if(c.func=="valueControlLanguageWithDefault"){var d=c._children[1].label,e=c._children[3].label;if(d){b[d]&&console.log("existing key: "+d+'="'+b[d]+'" being replaced with '+e);b[d]=e}else console.log('empty key with value "'+e+'"')}else if(c instanceof Block){IDE._extractText(b,c.label);for(d=0;d<c._containers.length;d++)c._containers[d]!=null&&IDE._extractText(b,c._containers[d]);c.next!=null&&IDE._extractText(b,c.next)}else if(c instanceof Label)for(d=0;d<c._children.length;d++)IDE._extractText(b,
c._children[d]);else c instanceof LabelInput&&c._child!=null&&IDE._extractText(b,c._child)};
IDE.createProjectBundle=function(){for(var b={},c=0;c<Runtime.background.scripts.length;c++)IDE._extractText(b,Runtime.background.scripts[c]);for(c=0;c<Runtime.sprites.length;c++)for(var d=Runtime.sprites[c],e=0;e<d.scripts.length;e++)IDE._extractText(b,d.scripts[e]);for(c=0;c<Runtime.libs.length;c++){d=Runtime.libs[c];for(e=0;e<d.scripts.length;e++)IDE._extractText(b,d.scripts[e])}c=$("#importexportdlg");c.find("textarea").val(JSON.stringify({"default":b},null,"\t"));c.find(".importBtn").addClass("hidden");
c.find(".cancelBtn").unbind().click(function(){$.modal.close();return false});c.modal()};
IDE.cmdLessonExport=function(){var b=$("#importexportdlg");b.find("textarea").val("");b.find(".importBtn").addClass("hidden");b.find(".cancelBtn").unbind().click(function(){$.modal.close();return false});b.modal();for(var c=ObjectIO.serializeLesson(),d=0;d<c.notes.length;d++)delete c.notes[d].state;b.find("textarea").val(JSON.stringify(c,null,"\t"));b.find("li").length==0&&WinLessons._loadLesson(function(){for(var c=ObjectIO.serializeLesson(),d=0;d<c.notes.length;d++)delete c.notes[d].state;b.find("textarea").val(JSON.stringify(c,
null,"\t"))});return false};IDE.cmdLessonImport=function(){var b=$("#importexportdlg");b.find("textarea").val("");b.find(".importBtn").removeClass("hidden").unbind().click(function(){IDE.Clipboard.clear();var c=b.find("textarea").val();ObjectIO.deserializeLesson(JSON.parse(c));$.modal.close();return false});b.find(".cancelBtn").unbind().click(function(){$.modal.close();return false});b.modal();return false};IDE.cmdCreateLesson=function(){window.WinLessons&&WinLessons.show();return true};
IDE.cmdCreatePuzzle=function(){window.WinPuzzle&&WinPuzzle.editBegin();return true};IDE.cmdCreateQuiz=function(){window.WinQuiz&&WinQuiz.show();return true};IDE.cmdCreateAnnotation=function(){window.WinAnnotation&&WinAnnotation.show(true);return true};IDE.cmdShowAnnotation=function(){window.WinAnnotation&&(WinAnnotation.isVisible?WinAnnotation.hide():WinAnnotation.show(false));return true};
IDE.cmdUndo=function(){window.WinStage&&WinStage.cmdStop();window.WinPaint&&!$("#win-paint").hasClass("hidden")?WinPaint.cmdUndo():IDE.Clipboard.doUndo();return false};IDE.cmdRedo=function(){window.WinStage&&WinStage.cmdStop();window.WinPaint&&!$("#win-paint").hasClass("hidden")?WinPaint.cmdRedo():IDE.Clipboard.doRedo();return false};IDE.cmdResetActors=function(){for(var b=0;b<Runtime.sprites.length;b++)Runtime.sprites[b].bringIntoView();Runtime.stage.draw()};
IDE.cmdSubmitProject=function(b){if(!$(this).hasClass("disabled")){var c=Runtime.stage.captureScreenshot(),d=$($(this).find("input")[0]).val(),e=$(this).find("textarea").val();IDE._doProjectSave(d,e,c,false,true,Runtime.currentLevelIndex,null,function(){IDE._clearDirty();$.ajax({url:"/api/assignmentsubmit",type:"POST",data:{id:IDE.currentProjectId},success:function(){b?b():IDE.cmdExit()}})})}return false};
IDE.cmdExit=function(b){if(!IDE._ignoreDirty&&IDE.isDirty){var c=IDE.isDirty==1?g_loc.getText("confirm.exit_unsaved1"):g_loc.formatText("confirm.exit_unsaved",IDE.isDirty);IDE.confirmDialog(c,function(){IDE.cmdProjectSave(function(){window.location=b?b:$(".wincmd-home").attr("href")})},"Save","Exit",function(){IDE._clearDirty();window.location=b?b:$(".wincmd-home").attr("href")},true)}else window.location=b?b:$(".wincmd-home").attr("href");return false};IDE.cmdJoinStudent=function(){$("#join-view").scope().$parent.state.go("joinStudent")};
IDE.cmdLogout=function(){IDE.confirmDialog(g_loc.getText("dialog.confirmlogout"),function(){Runtime.stage.selectActor(null);var b=Runtime.stage.captureScreenshot();IDE._doProjectSave(IDE.currentProjectName,IDE.currentProjectDescription,b,false,true,Runtime.currentLevelIndex,null,function(){logout()});return false},g_loc.getText("dialog.btnok"),g_loc.getText("dialog.btncancel"),function(){})};
IDE.cmdMakeWidget=function(){Runtime.stage.selectActor(null);var b=Runtime.stage.captureScreenshot();IDE._doProjectSave(IDE.currentProjectName,IDE.currentProjectDescription,b,false,true,Runtime.currentLevelIndex,null,function(){window.location="/api/getwidget?p="+IDE.currentProjectId});return false};
IDE.cmdMakeCRX=function(){Runtime.stage.selectActor(null);var b=Runtime.stage.captureScreenshot();IDE._doProjectSave(IDE.currentProjectName,IDE.currentProjectDescription,b,false,true,Runtime.currentLevelIndex,null,function(){window.location="/api/getcrx?p="+IDE.currentProjectId});return false};IDE.cmdLeaveFeedback=function(){window.Feedback&&window.Feedback.showForm("ide","Feedback for Studio")};
IDE.cmdProjectLoad=function(){IDE.chooseFile(g_loc.getText("dialog.loadprojtitle"),"/","*",function(b){window.location="ide/?p="+b},"/api/projectlist");return false};
Runtime.loadLevel=function(b,c,d){b||(b=0);if(b!=Runtime.currentLevelIndex){Runtime.stopScripts(null,null);IDE.showProgress(g_loc.getText("dialog.projectloading"));var e=cloneObj(Runtime.background.variables),f=cloneObj(Runtime.background.varDefaults),g=cloneObj(Runtime.background.lists),h={};if(c)for(var j=0;j<Runtime.sprites.length;j++){var k=Runtime.sprites[j];c.indexOf(k.label)>=0&&(h[k.label]=ObjectIO.serializeSprite(k))}window.setTimeout(function(){$.ajax({url:"api/projectload.aspx",type:"POST",
data:{p:IDE.currentProjectId,s:b},success:function(c){try{c=JSON.parse(c);ObjectIO.deserialize(c,function(){Runtime.currentLevelIndex=b;Runtime.loadVariables(function(){d&&d()});for(var c in e)Runtime.background.variables[c]=e[c];for(c in f)Runtime.background.varDefaults[c]=f[c];for(c in g)Runtime.background.lists[c]=g[c];for(var j in h)(c=Sprites.getSpriteByName(j))&&c.deleteActor();ObjectIO.loaded=1;for(j in h)ObjectIO.deserializeSprite(h[j],function(){$.modal.close();IDE.showProgress(null)});j=
null;for(c=0;c<Runtime.sprites.length;c++)if(Runtime.sprites[c]&&!Runtime.sprites[c].hidden&&!Runtime.sprites[c].hiddenInSandbox){j=Runtime.sprites[c];break}IDE.selectAsset(j);ObjectIO.doCallback(function(){$.modal.close();IDE.showProgress(null)});WinMediaSidebar.showLevels();IDE.adjustPanels()})}catch(j){console.log(j.message);console.log(j);console.log(j.stack);IDE.currentProjectId=null;IDE.showProgress(null)}},error:function(){$.modal.close();IDE.showProgress(null)}})},1E3)}};
IDE._projectLoad=function(b,c,d){IDE.showProgress(g_loc.getText("dialog.projectloading"));d||(d=0);window.setTimeout(function(){$.ajax({url:"api/projectload.aspx",type:"POST",data:{n:true,p:b,s:d},success:function(e){try{e=JSON.parse(e);IDE.currentOwnerId=e.project.ownerid;if(IDE.currentOwnerId)prefs.owner=e.project.owner;IDE.currentLessonOwnerId=e.project.lessonownerid;if(e.project.lessonowner)prefs.lessonowner=e.project.lessonowner;if(e.tags){var f=$("#project-save .tags input[type=checkbox]");
f.each(function(){var b=$(this).attr("name"),b=e.tags.indexOf(b);if(b>=0){this.checked=true;e.tags.splice(b,1)}else this.checked=false});for(var g=[],h=[],j=0;j<e.tags.length;j++)e.tags[j].indexOf("system-")===0?g.push(e.tags[j]):h.push(e.tags[j]);$("#project-save .tags input[type=text]").val(h.join(","));$("#project-save .tags input[type=hidden]").val(g.join(","))}else if(e.metadata&&e.metadata.tags){f=$("#project-save .tags input[type=checkbox]");f.each(function(){var b=$(this).attr("name"),b=e.metadata.tags.indexOf(b);
if(b>=0){this.checked=true;e.metadata.tags.splice(b,1)}else this.checked=false});g=[];h=[];for(j=0;j<e.metadata.tags.length;j++)e.metadata.tags[j].indexOf("system-")===0?g.push(e.metadata.tags[j]):h.push(e.metadata.tags[j]);$("#project-save .tags input[type=text]").val(h.join(","));$("#project-save .tags input[type=hidden]").val(g.join(","))}ObjectIO.deserialize(e.project,function(){Runtime.currentLevelIndex=d;for(var b=null,f=0;f<Runtime.sprites.length;f++)if(Runtime.sprites[f]&&!Runtime.sprites[f].hidden&&
!Runtime.sprites[f].hiddenInSandbox){b=Runtime.sprites[f];break}IDE.selectAsset(b);Runtime.loadVariables(function(){c&&c()});$.modal.close();IDE.showProgress(null);WinAnnotation.hideNotes=e.hideNotes?true:false;if(e.notes&&e.notes.length>0){WinAnnotation.deserialize(e.notes);if(!g_hideNotes&&!WinAnnotation.hideNotes){WinAnnotation.show(false,IDE.currentLessonOwnerId==prefs.userid);$("#wincmd-showannotate").text(g_loc.getText("menu.hideannotate"))}else WinTools.minimize(false);$("#wincmd-annotate").text(g_loc.getText("menu.editannotate"))}else{$("#wincmd-annotate").text(g_loc.getText("menu.annotate"));
$("#wincmd-showannotate").text(g_loc.getText("menu.showannotate")).addClass("hidden")}window.innerWidth>=1600?$("#win-stage").css("width",840):$("#win-stage").css("width",420);IDE.adjustPanels()});IDE.currentProjectId=b;IDE.currentProjectName==IDE.defaultProjectName&&window.setTimeout(function(){var b=Runtime.stage.captureScreenshot(),c=$($(this).find("input[name=name]")[0]).val(),d=$(this).find("textarea").val();IDE._doProjectSave(c,d,b,false,true,Runtime.currentLevelIndex,null,function(b){IDE.dirty();
if(b)window.location="?p="+IDE.currentProjectId})},1E3)}catch(k){console.log(k.message);console.log(k);console.log(k.stack);IDE.currentProjectId=null;IDE.showProgress(null)}},error:function(){$.modal.close();IDE.showProgress(null)}})},1E3)};IDE.cmdLessonLoad=function(){IDE.chooseFile(g_loc.getText("dialog.loadlessontitle"),"/","*",IDE._lessonLoad,"/api/lessonlist");return false};
IDE._lessonLoad=function(b,c,d){IDE.showProgress(g_loc.getText("dialog.lessonloading"));window.setTimeout(function(){$.ajax({url:"/api/lessonload",type:"POST",data:"p="+encodeURIComponent(b),success:function(d){IDE.Clipboard.clear();IDE.reset();window.WinLessons&&WinLessons.reset();WinStage.show();d=JSON.parse(d);ObjectIO.deserializeLesson(d);if(window.WinLessons)WinLessons.lessonId=b;IDE.setTitle(d.name);WinProperties.showBackground();WinProperties.update();Runtime.stage.selectActor();$.modal.close();
IDE.showProgress(null);c&&c()},error:function(){$.modal.close();IDE.showProgress(null);d&&d()}})},1E3)};
IDE.cmdProjectSave=function(b){IDE.currentProjectName||IDE.setTitle(IDE.defaultProjectName);if(!IDE.currentProjectName||IDE.currentProjectName==IDE.defaultProjectName||WinAnnotation.hasNotes()&&(!IDE.currentProjectDescription||IDE.currentProjectDescription=="Please add a description for your lesson")){if(WinAnnotation.hasNotes()&&(!IDE.currentProjectDescription||IDE.currentProjectDescription=="Please add a description for your lesson"))IDE.currentProjectDescription="Please add a description for your lesson";
IDE.cmdProjectSaveAs(true,b)}else{var c=Runtime.stage.captureScreenshot();$("#wincmd-tbsave").addClass("saving");IDE._doProjectSave(null,null,c,false,true,Runtime.currentLevelIndex,null,function(c){$("#wincmd-tbsave").removeClass("saving");IDE._clearDirty();b&&b();if(c)window.location="?p="+IDE.currentProjectId})}};
IDE.cmdProjectSaveAs=function(b,c,d){Runtime.stage.selectActor(null);var e=IDE.currentProjectName;e==IDE.defaultProjectName&&(e="");$("#project-save input[name=name]").val(e);window.setTimeout(function(){$("#project-save input[name=name]").focus()},1E3);e=IDE.currentProjectDescription;if(!e||e=="Enter your project description here"||e==g_loc.getText("properties.helpdescription")||e==g_loc.getText("savedlg.descdetails"))e="";$("#project-save textarea").val(e);var f=Runtime.stage.captureScreenshot(),
g=$("#project-save");g.find(".title").text(d?d:g_loc.getText("dialog.savetitle"));g.find("img").attr("src",f);g.find(".error").addClass("hidden").text("");g.find("input[name=tutorial]")[0].checked=!WinAnnotation.hideNotes&&WinAnnotation.hasNotes();g.modal();g.find("input[name=screendata]").unbind().change(function(b){b=b.originalEvent.target.files;if(b.length>0){b=b[0];getFilename(b.name);if(b.type=="image/png"||b.type=="image/jpeg"){var c=new FileReader;c.onload=function(b){f=b.target.result;g.find(".screenshot img").attr("src",
f)};c.readAsDataURL(b)}}});g.find(".screenshot a.upload").unbind().click(function(){g.find("input[name=screendata]").click()});g.find("a.saveBtn").unbind().click(function(){var d=$.trim(g.find("input[name=name]").val());if(d==""||d==IDE.defaultProjectName)g.find(".error").removeClass("hidden").text("Oops! Please enter a name for your project.");else{var e=g.find("textarea").val();if(e=="Enter your project description here"||e==g_loc.getText("properties.helpdescription")||e==g_loc.getText("savedlg.descdetails"))e=
"";WinAnnotation.hideNotes=g.find("input[name=tutorial]")[0].checked?false:true;IDE.currentProjectDescription=e;var k=g.find("input.share")[0].checked,l=[];g.find(".tags input[type=checkbox]").each(function(){this.checked&&l.push($(this).attr("name"))});var l=l.join(","),m=g.find(".tags input[type=text]").val();if(m){l&&(l=l+",");l=l+m}if(m=g.find(".tags input[type=hidden]").val()){l&&(l=l+",");l=l+m}$("#wincmd-tbsave").addClass("saving");IDE._doProjectSave(d,e,f,k,b?true:false,Runtime.currentLevelIndex,
l,function(b){$("#wincmd-tbsave").removeClass("saving");if(WinLessons.getNotes().notes.length>0)WinLessons._saveLesson(function(){c&&c();if(b)window.location="?p="+IDE.currentProjectId});else{c&&c();if(b)window.location="?p="+IDE.currentProjectId}});$.modal.close()}return false});g.find("a.cancelBtn").unbind().click(function(){$.modal.close();return false});return false};
IDE._doProjectSave=function(b,c,d,e,f,g,h,j){if(g===null||g===void 0)g=Runtime.currentLevelIndex;b&&IDE.setTitle(b);if(c)IDE.currentProjectDescription=c;b="";if(f&&IDE.currentProjectId)b=IDE.currentProjectId;d={n:IDE.currentProjectName,h:WinAnnotation.hideNotes,d:IDE.currentProjectDescription,an:WinAnnotation.hideNotes?"":WinAnnotation.serialize(),p:ObjectIO.serialize(),i:d,pb:e?true:false,id:b,cid:IDE.currentProjectId,s:g};h!==null&&(d.t=h);$.ajax({url:"api/projectsave.aspx",type:"POST",data:d,success:function(b){IDE._clearDirty();
b=JSON.parse(b);console.log("saved project "+IDE.currentProjectName);var c=IDE.currentProjectId!=b.id;IDE.currentProjectId=b.id;if(b.sid&&Runtime.levels&&g<Runtime.levels.length){Runtime.levels[g].screenshotid=b.sid;$("#stagecmd-edit").hasClass("selected")&&WinMediaSidebar.showLevels()}j&&(typeof j=="function"&&IDE.currentProjectId)&&j(c)},error:function(){}})};
IDE.cmdProjectSubmitEntry=function(b){IDE.currentProjectId?$.ajax({url:"/api/publishproject",data:{c:"isShared",id:IDE.currentProjectId},success:function(c){c.shared&&c.tags&&c.tags.indexOf("system-summer-code-a-thon-2017")>=0?IDE._unsubmitEntry(b):IDE._submitEntry(b)}}):IDE._submitEntry(b)};
IDE._unsubmitEntry=function(){Runtime.stage.selectActor(null);var b=Runtime.stage.captureScreenshot(),c=$("#project-unsubmitentry");c.find(".screenshot img").attr("src",b);c.modal();c.find("a.viewAllBtn").unbind().click(function(){window.open("/play/summer/","_blank");$.modal.close();return false});c.find("a.removeEntryBtn").unbind().click(function(){$.ajax({url:"/api/publishproject",data:{c:"unpublish",id:IDE.currentProjectId},success:function(){}});$.modal.close();return false})};
IDE._submitEntry=function(b){Runtime.stage.selectActor(null);var c=IDE.currentProjectName;c==IDE.defaultProjectName&&(c="");$("#project-submitentry input[name=name]").val(c);window.setTimeout(function(){$("#project-submitentry input[name=name]").focus()},1E3);c=IDE.currentProjectDescription;if(!c||c=="Enter your project description here"||c==g_loc.getText("properties.helpdescription")||c==g_loc.getText("savedlg.descdetails"))c="";var d=Runtime.stage.captureScreenshot(),e=$("#project-submitentry");
e.find(".title").text("Submit Entry");e.find(".screenshot img").attr("src",d);e.find(".error").addClass("hidden").text("");e.find("input[name=tutorial]")[0].checked=!WinAnnotation.hideNotes&&WinAnnotation.hasNotes();e.modal();e.find("input[name=screendata]").unbind().change(function(b){b=b.originalEvent.target.files;if(b.length>0){b=b[0];getFilename(b.name);if(b.type=="image/png"||b.type=="image/jpeg"){var c=new FileReader;c.onload=function(b){d=b.target.result;e.find(".screenshot img").attr("src",
d)};c.readAsDataURL(b)}}});e.find(".screenshot a.upload").unbind().click(function(){e.find("input[name=screendata]").click()});e.find("a.saveBtn").unbind().click(function(){var c=$.trim(e.find("input[name=name]").val());if(c==""||c==IDE.defaultProjectName)e.find(".error").removeClass("hidden").text("Oops! Please enter a name for your project.");else{var g=e.find("textarea").val();if(g=="Enter your project description here"||g==g_loc.getText("properties.helpdescription")||g==g_loc.getText("savedlg.descdetails"))g=
"";WinAnnotation.hideNotes=e.find("input[name=tutorial]")[0].checked?false:true;IDE.currentProjectDescription=g;var h=e.find("input.share")[0].checked,j=[];e.find(".tags input[type=checkbox]").each(function(){this.checked&&j.push($(this).attr("name"))});var j=j.join(","),k=e.find(".tags input[type=text]").val();if(k){j&&(j=j+",");j=j+k}if(k=e.find(".tags input[type=hidden]").val()){j&&(j=j+",");j=j+k}j&&(j=j+",");j=j+"system-summer-code-a-thon-2017,system-summer-code-a-thon-2017-week-";$.ajax({url:"/play/summer/data/summer-code-a-thon-2017.json",
success:function(e){j=j+e.currentStage;$("#wincmd-tbsave").addClass("saving");IDE._doProjectSave(c,g,d,h,true,Runtime.currentLevelIndex,j,function(c){$("#wincmd-tbsave").removeClass("saving");$.ajax({url:"/api/publishproject",data:{c:"publish",id:IDE.currentProjectId},success:function(){b&&b();if(c)window.location="?p="+IDE.currentProjectId}})});$.modal.close()}})}return false});e.find("a.cancelBtn").unbind().click(function(){$.modal.close();return false});return false};
IDE.cmdActorSave=function(b){var c=$("#actor-save");$("#actor-name").val(b.label);$("#actor-description").val(b.documentation.description).unbind().blur(function(){b.documentation.description=$(this).val()}).keypress(function(b){b.which==13&&$(this).blur()});b.costumes.length>0&&c.find("img").attr("src",b.captureScreenshot());if(b==null)b=Runtime.background;WinProperties.makeInterfacesFor(b);var d=b.documentation.inboundEvents,e=b.documentation.outboundEvents,f=b.documentation.properties,g=c.find(".inbound ul");
g.empty();for(var h=0;h<d.length;h++){var j=$('<li idx="'+h+'"><span></span><input class="description" type="text"/><em><input type="checkbox"/> Make Visible</em></li>');g.append(j);var k;if(d[h].name.charAt(0)=="["){var l=d[h].name.substring(1,d[h].name.length-1),m=l.indexOf("|"),n;if(m>0){n=l.substring(m+1);l=l.substring(0,m)}if(l=findStepByFunc(l)){k=new Block(l);n&&k.label.setValue(0,n)}}else{k=new Block({cat:"flow",label:"when I receive {events}",hasFlap:false,func:"registerBroadcastTrigger"});
k.label.setValue(0,d[h].name)}if(k){j.find("span").append(k.getImage());j.find("input[type=text]").val(d[h].description).blur(function(){d[parseInt($(this).parent().attr("idx"))].description=$(this).val()}).keypress(function(b){b.which==13&&$(this).blur()});j.find("input[type=checkbox]")[0].checked=d[h].visible;j.find("input[type=checkbox]").click(function(){d[parseInt($(this).parent().parent().attr("idx"))].visible=this.checked})}}d.length>0?c.find(".inbound").removeClass("hidden"):c.find(".inbound").addClass("hidden");
g=c.find(".outbound ul");g.empty();for(h=0;h<e.length;h++){j=$('<li idx="'+h+'"><span></span><input class="description" type="text"/><em><input type="checkbox"/> Make Visible</em></li>');g.append(j);k=new Block({cat:"flow",label:"broadcast {events}",func:"blockControlBroadcast"});k.label.setValue(0,e[h].name);j.find("span").append(k.getImage());j.find("input[type=text]").val(e[h].description).blur(function(){e[parseInt($(this).parent().attr("idx"))].description=$(this).val()}).keypress(function(b){b.which==
13&&$(this).blur()});j.find("input[type=checkbox]")[0].checked=e[h].visible;j.find("input[type=checkbox]").click(function(){e[parseInt($(this).parent().parent().attr("idx"))].visible=this.checked})}e.length>0?c.find(".outbound").removeClass("hidden"):c.find(".outbound").addClass("hidden");g=c.find(".objprops ul");g.empty();for(h=0;h<f.length;h++){j=$('<li idx="'+h+'"><span></span><input class="smalldescription" type="text"/> = <input class="default" type="text"/><em><input type="checkbox"/> Make Visible</em></li>');
g.append(j);k=new Label({cat:"var",label:f[h].name});j.find("span").append(k.getImage());j.find("input.smalldescription").val(f[h].description).blur(function(){f[parseInt($(this).parent().attr("idx"))].description=$(this).val()}).keypress(function(b){b.which==13&&$(this).blur()});j.find("input.default").val(b.variables[f[h].name]).blur(function(){IDE.dirty();var c=valueToNative($(this).val());b.variables[f[parseInt($(this).parent().attr("idx"))].name]=c}).keypress(function(b){b.which==13&&$(this).blur()});
j.find("input[type=checkbox]")[0].checked=f[h].visible;j.find("input[type=checkbox]").click(function(){f[parseInt($(this).parent().parent().attr("idx"))].visible=this.checked})}f.length>0?c.find(".objprops").removeClass("hidden"):c.find(".objprops").addClass("hidden");c.modal();c.find(".saveBtn").unbind().click(function(){var d=false;b.documentation.description||(d=true);if(!d)for(var e=b.documentation.inboundEvents,f=0;f<e.length;f++)if(e[f].visible&&!e[f].description){d=true;break}if(!d){e=b.documentation.outboundEvents;
for(f=0;f<e.length;f++)if(e[f].visible&&!e[f].description){d=true;break}}if(!d){e=b.documentation.properties;for(f=0;f<e.length;f++)if(e[f].visible&&!e[f].description){d=true;break}}if(d){c.find(".error").removeClass("hidden").text(g_loc.getText("dialog.actormissingerrtext"));return false}IDE._doActorSaveDlg(b,this,false);$.modal.close();return false});c.find(".cancelBtn").unbind().click(function(){$.modal.close();return false});return false};
IDE._doActorSaveDlg=function(b,c,d,e){var f=$(c).find("input"),c=$(f[0]).val(),f=$(f[1]).val();IDE._doActorSave(b,c,f,b.documentation.description,false,d,e)};
IDE._doActorSave=function(b,c,d,e,f,g,h){var j=b.captureScreenshot();b.classname=c;var k=b.label;b.locked=true;b.label=c;for(var l=0;l<b.scripts.length;l++)b.scripts[l].hidden=true;for(l=0;l<b.costumes.length;l++)b.costumes[l].hidden=true;for(l=0;l<b.sounds.length;l++)b.sounds[l].hidden=true;l=ObjectIO.serializeSprite(b);b.label=k;c="n="+encodeURIComponent(c)+"&d="+encodeURIComponent(e)+"&c="+encodeURIComponent(JSON.stringify(l))+"&i="+encodeURIComponent(j)+"&t="+encodeURIComponent(d)+"&pb="+f;g&&
b.id&&(c=c+("&id="+b.id));$.ajax({url:"/api/actorsave",type:"POST",data:c,success:function(c){console.log("saved actor");c=JSON.parse(c);if(c.id){b.id=c.id;IDE.selectAsset(b);h&&h(b.id)}},error:function(){}})};IDE.cmdProjectShare=function(){var b=$("#sharing").scope();if(b){b.show();b.$apply()}};
var Director={_fromUrl:"",_controlId:"",_controlParams:"",_instructions:[],_stepId:"",init:function(){$("#director-info a.button-close").click(function(){$("#director-info").addClass("hidden");IDE.adjustPanels();return false})},loadAndExecute:function(b,c){IDE.showProgress(g_loc.getText("dialog.projectloading"));Director._fromUrl=b;Director._instructions=[];Director._controlParams=c;$.ajax({url:"/api/"+b,success:function(b){Director._instructions=JSON.parse(b);Director._stepId=null;for(b=0;b<Director._instructions.length;b++){var c=
Director._instructions[b];if(c.id=="init")Director.execute(c);else if(!Director._stepId)Director._stepId=c.id}Director.execute();IDE.showProgress()},error:function(){IDE.showProgress()}})},findStepIndex:function(b){if(Director._instructions)for(var c=0;c<Director._instructions.length;c++)if(Director._instructions[c].id==b)return c;return-1},execute:function(b){if(!b){var c=Director.findStepIndex(Director._stepId);if(c>=0&&c<Director._instructions.length){b=Director._instructions[c];c++;Director._stepId=
c>=0&&c<Director._instructions.length?Director._instructions[c].id:""}else{Director._stepId="";b=null}}if(b)(c=Director["instruction_"+b.func])&&c(b.args)},isRunning:function(){return Director._instructions&&Director._stepId},instruction_setProperty:function(b){switch(b[0]){case "url_back":$(".wincmd-home").attr("href",b[1])}},instruction_setAssignmentList:function(){},instruction_visitUrl:function(b){window.location=b[0]},instruction_loadLesson:function(b){window.WinLessons&&IDE._lessonLoad(b[0],
function(){if(b.length>1){WinLessons._startAnnotations();WinLessons.jumpToSnapshot(b[1])}else WinLessons.playAnnotations();window.Assignments&&Assignments.initMessaging()})},instruction_loadLessonProject:function(b){IDE._projectLoad(b[0],function(){window.Assignments&&Assignments.initMessaging();$.ajax({url:"/api/projectstarted",type:"POST",data:"p="+IDE.currentProjectId})})},instruction_loadProject:function(b){b[1]&&IDE.showProgress(g_loc.getText("dialog.projectloading"));IDE._projectLoad(b[0],function(){IDE.adjustPanels();
window.Assignments&&Assignments.initMessaging();b[1]&&loadJs("director/"+b[1]+".js")})},instruction_loadAssignment:function(b){IDE._projectLoad(b[0],function(){window.Assignments&&Assignments.initMessaging()});var c="<p>"+b[1]+"</p>";$("#wincmd-submit").removeClass("hidden").removeClass("disabled");Director.infobarShow(true);Director.infobarSetContent(c);Director.infobarShowPrev(false);Director.infobarShowNext(false);var d=$("#director-info");switch(b[2]){case "submitted":d.find("div.notechoices").append('<div class="choice"><img width="32" src="/imgs/checkmark120.png"/> Submitted for review</div>');
$("#wincmd-submit").detach();break;case "accepted":d.find("div.notechoices").append('<div class="choice"><img width="32" src="/imgs/checkmark120.png"/> Completed</div>');$("#wincmd-submit").detach();break;default:d.find("div.notechoices").append('<div class="choice"><a class="button1 bigbutton" href="#">Submit Project</a></div>').find("a").click(function(){b[3]?IDE.cmdSubmitProject(function(){Director.instruction_displayPromptChoices(b[3]);d.find("div.notechoices").empty().append('<div class="choice"><img width="32" src="/imgs/checkmark120.png"/> Submitted for review</div>')}):
IDE.cmdSubmitProject();return false});prefs&&prefs.role=="teacher"&&d.find("div.notechoices a").addClass("buttondisabled").addClass("disabled").attr("title","Disabled for teachers (students will have this button enabled)").unbind().click(function(){return false})}d.find(".notecontent").css("right",32+d.find(".notechoices").outerWidth());d.find(".buttons").css("right",32+d.find(".notechoices").outerWidth())},instruction_displayMessage:function(b){Director.infobarReset();Director.infobarSetContent(b[0]);
Director.infobarShow(true);Director.execute()},instruction_displayProjectChoices:function(){IDE.cmdExit()},instruction_displayProjectChoicesContinue:function(){IDE.cmdExit()},instruction_displayProjectChoicesDone:function(){IDE.cmdExit()},instruction_displayPromptChoices:function(){IDE.cmdExit()},instruction_displayNext:function(){},instruction_displayStopAndCreate:function(){},showDialog:function(){},infobarReset:function(){var b=$("#director-info");b.find("a.button-close").addClass("hidden");b.find(".btnleft").addClass("hidden").addClass("btndisabled");
b.find(".btnright").addClass("hidden").addClass("btndisabled");b.removeClass("hasbuttons");b.find(".notecontent").empty()},infobarShow:function(b){var c=$("#director-info");if(b){c.removeClass("hidden");c.find(".notecontent").css("right",32+c.find(".notechoices").outerWidth());c.find(".buttons").css("right",32+c.find(".notechoices").outerWidth())}else c.addClass("hidden");IDE.adjustPanels()},infobarSetContent:function(b){$("#director-info .notecontent").empty().append(b)},infobarClearChoices:function(){var b=
$("#director-info"),c=b.find(".notechoices");c.empty();b.find(".notecontent").css("right",32+c.outerWidth());b.find(".buttons").css("right",32+c.outerWidth())},infobarAddChoice:function(b){var c=$("#director-info"),d=c.find(".notechoices");d.css("height",c.outerHeight()).css("line-height",c.outerHeight()+"px");var e=b.id,f=b.img,g=b.href?b.href:"";if(b.lid)var h=$('<div href="'+g+'" lid="'+e+'" class="choice" style="background-image:url('+f+')" title="'+b.alt+'"></div>');else b.pid?h=$('<div href="'+
g+'" pid="'+e+'" class="choice" style="background-image:url('+f+')" title="'+b.alt+'"></div>'):b.button&&(h=$('<a href="#" class="button btnDefaultBlue medium">'+b.button+"</a>"));d.append(h);b.button?h.click(b.buttonCallback):h.click(function(){if($(this).attr("href"))window.location=g;return false});c.find(".notecontent").css("right",32+d.outerWidth());c.find(".buttons").css("right",32+d.outerWidth())},infobarShowClose:function(b){b?$("#director-info a.button-close").removeClass("hidden"):$("#director-info a.button-close").addClass("hidden")},
infobarShowPrev:function(b,c){b?$("#director-info .btnleft").removeClass("hidden").unbind().click(function(){c&&!$(this).hasClass("btndisabled")&&c()}):$("#director-info .btnleft").addClass("hidden");!$("#director-info .btnleft").hasClass("hidden")||!$("#director-info .btnright").hasClass("hidden")?$("#director-info").addClass("hasbuttons"):$("#director-info").removeClass("hasbuttons")},infobarEnablePrev:function(b){b?$("#director-info .btnleft").removeClass("btndisabled"):$("#director-info .btnleft").addClass("btndisabled")},
infobarShowNext:function(b,c){b?$("#director-info .btnright").removeClass("hidden").unbind().click(function(){c&&!$(this).hasClass("btndisabled")&&c()}):$("#director-info .btnright").addClass("hidden");!$("#director-info .btnleft").hasClass("hidden")||!$("#director-info .btnright").hasClass("hidden")?$("#director-info").addClass("hasbuttons"):$("#director-info").removeClass("hasbuttons")},infobarEnableNext:function(b){b?$("#director-info .btnright").removeClass("btndisabled"):$("#director-info .btnright").addClass("btndisabled");
!$("#director-info .btnleft").hasClass("hidden")||!$("#director-info .btnright").hasClass("hidden")?$("#director-info").addClass("hasbuttons"):$("#director-info").removeClass("hasbuttons")},infobarResetButtons:function(){$("#director-info .buttons").empty()},infobarAddButton:function(b){var c=$("#director-info");$directory.find(".buttons").append(b).css("right",32+c.find(".notechoices").outerWidth())},infobarSetButtons:function(b){var c=$("#director-info"),d=c.find(".buttons");d.empty();if(b){for(var e=
0;e<b.length;e++)d.append(b[e]);d.css("right",32+c.find(".notechoices").outerWidth())}}},WinToolbar={enable:function(b){b?$(".toolbar-top").removeClass("hidden"):$(".toolbar-top").addClass("hidden");IDE.adjustPanels()},init:function(){$(".toolbar-top").removeClass("hidden");$(".ide-menus .menu-link").click(function(){return false});$("#wincmd-edit").mouseenter(function(){if(!$(this).hasClass("disabled"))if(IDE.editingActor&&window.WinLessons&&WinLessons.currentPbIdx<0){$("#wincmd-cloneactor").removeClass("disabled");
if(IDE.editingActor.locked){$("#wincmd-savetblock").addClass("disabled");$("#wincmd-unlocktblock").removeClass("disabled")}else{$("#wincmd-savetblock").removeClass("disabled");$("#wincmd-unlocktblock").addClass("disabled")}}else{$("#wincmd-cloneactor").addClass("disabled");$("#wincmd-savetblock").addClass("disabled");$("#wincmd-unlocktblock").addClass("disabled")}return false});$("#wincmd-top").click(function(){$(this).hasClass("disabled")||IDE.cmdExit($(this).attr("href"));return false});$("#wincmd-exit").click(function(){$(this).hasClass("disabled")||
IDE.cmdExit();return false});$("#wincmd-new").click(function(){$(this).hasClass("disabled")||IDE.cmdProjectNew();return false});$("#wincmd-open").click(function(){$(this).hasClass("disabled")||IDE.cmdProjectOpen();return false});$("#wincmd-save").click(function(){$(this).hasClass("disabled")||IDE.cmdProjectSave();return false});$("#wincmd-tbsave").click(function(){$(this).hasClass("disabled")||IDE.cmdProjectSave();return false});$("#wincmd-tbsubmitentry").click(function(){$(this).hasClass("disabled")||
IDE.cmdProjectSubmitEntry();return false});$("#wincmd-editproject").click(function(){$(this).hasClass("disabled")||IDE.cmdProjectSaveAs(true,null,g_loc.getText("dialog.edittitle"));return false});$("#wincmd-saveas").click(function(){$(this).hasClass("disabled")||IDE.cmdProjectSaveAs();return false});$("#wincmd-submit").click(IDE.cmdSubmitProject);$("#wincmd-autosave").click(function(){if(!$(this).hasClass("disabled"))if($(this).hasClass("autosave")){$(this).removeClass("autosave").text(g_loc.getText("menu.autosave_on"));
IDE.autosave=false;setPreference("autosave","off")}else{$(this).addClass("autosave").text(g_loc.getText("menu.autosave_off"));IDE.autosave=true;setPreference("autosave","on")}return false});IDE.autosave=prefs.autosave=="on";IDE.autosave?$("#wincmd-autosave").addClass("autosave").text(g_loc.getText("menu.autosave_off")):$("#wincmd-autosave").removeClass("autosave").text(g_loc.getText("menu.autosave_on"));$("#wincmd-joinstudent").click(function(){$(this).hasClass("disabled")||IDE.cmdJoinStudent();return false});
$("#wincmd-logout").click(function(){$(this).hasClass("disabled")||IDE.cmdLogout();return false});$(".toolbar-top .menu-link, #wincmd-user").click(function(){var b=$(".sub-menu");b.removeClass("active");$(this).siblings(".sub-menu").addClass("active");if(b.hasClass("active")){$("body").on("click",function(){b.removeClass("active")});$(".sub-menu a").on("click",function(){b.removeClass("active")})}return false});$("#wincmd-resetall").click(function(){$(this).hasClass("disabled")||IDE.cmdResetActors();
return false});$("#wincmd-showgrid").click(function(){Runtime.stage.showGrid(!Runtime.stage.isGridVisible());return false});$("#wincmd-search").click(function(){$(this).hasClass("disabled")||WinCode.showSearch();return false});$("#wincmd-undo").click(function(){$(this).hasClass("disabled")||(window.WinPaint&&$("#win-paint").is(":visible")?WinPaint.cmdUndo():IDE.cmdUndo());return false});$("#wincmd-redo").click(function(){$(this).hasClass("disabled")||(window.WinPaint&&$("#win-paint").is(":visible")?
WinPaint.cmdRedo():IDE.cmdRedo());return false});$("#wincmd-delete").click(function(){$(this).hasClass("disabled")||(WinCode.getSelection().length>0?WinCode.deleteSelection():WinAssets.getSelection()&&WinAssets.deleteActor());return false});$("#wincmd-cut").click(function(){$(this).hasClass("disabled")||(WinCode.getSelection().length>0?WinCode.cutSelection():WinAssets.getSelection()&&WinAssets.cutActor());return false});$("#wincmd-copy").click(function(){$(this).hasClass("disabled")||(WinCode.getSelection().length>
0?WinCode.copySelection():WinAssets.getSelection()&&WinAssets.copyActor());return false});$("#wincmd-paste").click(function(){$(this).hasClass("disabled")||(IDE.Clipboard.get("blocks")?WinCode.pasteSelection():IDE.Clipboard.get("sprite")&&WinAssets.pasteActor());return false});$("#wincmd-movefront").click(function(){$(this).hasClass("disabled")||WinAssets.moveFront()});$("#wincmd-moveback").click(function(){$(this).hasClass("disabled")||WinAssets.moveBack()});$("#wincmd-backpack").click(function(){$(this).hasClass("disabled")||
IDE.cmdBackpack();return false});$("#wincmd-share, .wincmd-share").click(function(){$(this).hasClass("disabled")||IDE.cmdProjectShare();return false});$("#wincmd-rearrange").click(function(){$(this).hasClass("disabled")||WinCode.relayoutBlocks();return false});$("#wincmd-norearrange").click(function(){$(this).hasClass("disabled")||WinCode.setLayoutMethod("none");return false});$("#wincmd-autorearrangebox").click(function(){$(this).hasClass("disabled")||WinCode.setLayoutMethod("box");return false});
$("#wincmd-autorearrangelinear").click(function(){$(this).hasClass("disabled")||WinCode.setLayoutMethod("linear");return false});$("#wincmd-savetblock").click(function(){$(this).hasClass("disabled")||WinAssets.saveActor();return false});$("#wincmd-unlocktblock").click(function(){$(this).hasClass("disabled")||WinAssets.unlockActor();return false});$("#wincmd-debugger").click(function(){$(this).hasClass("disabled")||WinTools.showDebugger();return false});$("#wincmd-canvasview").click(function(){$("#stagecmd-edit").click();
return false});$("#wincmd-codeview").click(function(){$("#codecmd-edit").click();return false});$("#wincmd-stageminmax").click(function(){$("#stagecmd-minmax").click();return false});$("#wincmd-blockcodesplit").click(function(){if(!$(this).hasClass("disabled")){if($("#win-code .blockview").hasClass("hidden")||$("#win-code .codeview").hasClass("hidden")){$("#win-media-sidebar").addClass("hidden");$("#win-levels").addClass("hidden");$("#codecmd-edit").addClass("selected").siblings().removeClass("selected");
WinStage.editTiles();$("#win-code .sprite-position").addClass("hidden");WinCode.enableBlockView(true);WinCode.enableCodeView(true);WinCode.adjustWindow();WinTools.minimize(true)}else{$("#win-code .sprite-position").removeClass("hidden");WinCode.enableBlockView(true);WinCode.enableCodeView(false);WinCode.adjustWindow();WinTools.minimize(false)}IDE.adjustPanels()}return false});$("#wincmd-createlib").click(function(){$(this).hasClass("disabled")||WinTools.createLibrary();return false});$("#wincmd-loadlib").click(function(){$(this).hasClass("disabled")||
WinTools.loadLibrary();return false});$("#wincmd-createblank").click(function(){$(this).hasClass("disabled")||WinAssets._addAssetAsActor([{url:"ide/imgs/blank.png",name:"actor",code:'[{"func":"registerDraw","values":[],"containers":[],"next":{"func":"blockPenDrawRectangle","values":[{"type":"number","value":"-40"},{"type":"number","value":"40"},{"type":"number","value":"80"},{"type":"number","value":"80"}],"containers":[],"next":{"func":"blockPenDrawLine","values":[{"type":"number","value":"-40"},{"type":"number","value":"40"},{"type":"number","value":"40"},{"type":"number","value":"-40"}],"containers":[],"next":{"func":"blockPenDrawLine","values":[{"type":"number","value":"-40"},{"type":"number","value":"-40"},{"type":"number","value":"40"},{"type":"number","value":"40"}],"containers":[]}}},"x":40,"y":40}]'}]);
return false});$("#wincmd-createtext").click(function(){$(this).hasClass("disabled")||IDE.promptDialog("Enter actor text",function(b){var b=b.replace('"','\\"'),c=WinAssets._addAssetAsActor([{url:"ide/imgs/blank.png",name:"actor",code:'[{"func":"registerFlagTrigger","next":{"func":"blockPenSetFontColor","values":[{"type":"color","value":"#000000"}],"next":{"func":"blockPenSetFont","values":[{"type":"choice","value":"normal"},{"type":"choice","value":"72"},{"type":"choice","value":"Arial,Helvetica,sans-serif"}],"next":{"func":"blockLooksSetLabel","values":[{"type":"string","value":"'+
b+'"}]}}},"x":40,"y":40}]'}]);if(c){c.font=c.spriteObj.font="normal 72px Arial,Helvetica,sans-serif";c.fontColor="#000000";c.spriteObj.label=b}});return false});$("#wincmd-cloneactor").click(function(){$(this).hasClass("disabled")||WinAssets.cloneActor();return false});$("#wincmd-buildexpression").click(function(){$(this).hasClass("disabled")||window.WinExpressions&&WinExpressions.show();return false});$("#wincmd-legacy").click(function(){if(WinStage._isLegacyMode){WinCode.enableBlockView(true);WinCode.enableCodeView(true)}else{WinCode.enableCodeView(false);
WinCode.enableBlockView(true);WinCode._generateBlocks()}WinStage.enableLegacy(!WinStage._isLegacyMode);return false});$("#wincmd-lessonbundle").click(function(){IDE.createLessonBundle();return false});$("#wincmd-projectbundle").click(function(){IDE.createProjectBundle();return false});$("#wincmd-exportscript").click(function(){$(this).hasClass("disabled")||window.WinCode&&WinCode.exportScript();return false});$("#wincmd-importscript").click(function(){$(this).hasClass("disabled")||window.WinCode&&
WinCode.importScript();return false});$("#wincmd-makewidget").click(function(){$(this).hasClass("disabled")||IDE.cmdMakeWidget();return false});$("#wincmd-makecrx").click(function(){$(this).hasClass("disabled")||IDE.cmdMakeCRX();return false});$("#wincmd-lesson").click(function(){$(this).hasClass("disabled")||IDE.cmdCreateLesson();return false});$("#wincmd-runlesson").click(function(){if(!$(this).hasClass("disabled")&&$("#annotations li").length>0&&IDE.currentProjectId)window.location="ide/?l="+
IDE.currentProjectId;return false});$("#wincmd-puzzle").click(function(){$(this).hasClass("disabled")||IDE.cmdCreatePuzzle();return false});$("#wincmd-quiz").click(function(){$(this).hasClass("disabled")||IDE.cmdCreateQuiz();return false});$("#wincmd-annotate").click(function(){$(this).hasClass("disabled")||IDE.cmdCreateAnnotation();return false});$("#wincmd-showannotate").click(function(){$(this).hasClass("disabled")||IDE.cmdShowAnnotation();return false});$("#wincmd-annotationhelp").click(function(){$(this).hasClass("disabled")||
WinAnnotation.showHelp();return false});$(".wincmd-home").click(function(){$(this).hasClass("disabled")||IDE.cmdExit();return false});$(".toolbar-top img.logo").click(function(){IDE.cmdExit()});$("#wincmd-tbbackpack").click(function(){$(this).hasClass("disabled")||IDE.cmdBackpack();return false});$("#wincmd-tbundo").click(function(){$(this).hasClass("disabled")||(window.WinPaint&&$("#win-paint").is(":visible")?WinPaint.cmdUndo():IDE.cmdUndo());return false});$("#wincmd-tbredo").click(function(){$(this).hasClass("disabled")||
(window.WinPaint&&$("#win-paint").is(":visible")?WinPaint.cmdRedo():IDE.cmdRedo());return false});$("#ide-header .project-title span").click(function(){$("#ide-header .project-title span").addClass("hidden");$("#ide-header .project-title input").removeClass("hidden").focus();return false});$("#ide-header .project-title input").blur(function(){$("#ide-header .project-title span").removeClass("hidden");$("#ide-header .project-title input").addClass("hidden");var b=$.trim($(this).val());if(b==""){b=
IDE.defaultProjectName;$(this).val(b)}IDE.setTitle(b);IDE.dirty()}).keydown(function(b){b.keyCode==13&&$(this).blur()});$("#wincmd-project input.label").focus(function(){$(this).addClass("active");$.trim($(this).val())==IDE.defaultProjectName&&$(this).val("")}).blur(function(){$(this).removeClass("active");var b=$.trim($(this).val());if(b==""){b=IDE.defaultProjectName;$(this).val(b)}IDE.setTitle(b);IDE.dirty()}).keydown(function(b){b.keyCode==13&&$(this).blur()});$("#wincmd-help").click(function(){$("#stagecmd-edit").hasClass("selected")?
Help.cmdHelp(null,"help/level-editor"):Help.cmdHelp();return false});$("li.wincmd-help .launchhelp").click(function(){$("li.wincmd-help").removeClass("active");Help.cmdHelp();return false});$("li.wincmd-help span input").keydown(function(b){if(b.keyCode==13){$("li.wincmd-help").removeClass("active");Help.cmdHelp($("li.wincmd-help span input").val());$("li.wincmd-help span input").val("").blur()}});$("li.wincmd-help span a.ask").click(function(){$("li.wincmd-help").removeClass("active");Help.cmdHelp($("li.wincmd-help span input").val());
$("li.wincmd-help span input").val("").blur();return false});$("#wincmd-restoreide").click(function(){System.restoreIde();return false})},canDrop:function(b,c,d,e){if($("li.wincmd-help").hasClass("active")&&(e instanceof Block||e instanceof Label)){d=$("li.wincmd-help div.popover div.helpbox");if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight())return true}return false},drop:function(b,c,d,e,f){if(WinToolbar.canDrop(b,c,d,e,f)){f==WinCode&&
WinCode.dragCanceled(e);$.ajax({url:"ide/help/blockhelp",data:{f:e.func},success:function(b){if(b!="error"){var b=JSON.parse(b),c=$("li.wincmd-help .blockhelp").empty().removeClass("hidden");c.html(b.question+"<br/>"+b.answer+'<br/><a href="#" class="more">More in Help</a>').find("span.script q").each(function(){var b=$(this).text(),b=JSON.parse(b),b=ObjectIO.deserializeScriptStep(b);$(this).css("display","none").parent().append(b.getImage())});c.find("a.more").click(function(){$("li.wincmd-help").removeClass("active").find(".blockhelp").empty().addClass("hidden");
Help.cmdHelp("@question "+e.func);return false})}}});return true}return false}},WinBackpack={objects:[],enable:function(b){b?$("#wincmd-tbbackpack").removeClass("hidden"):$("#wincmd-tbbackpack").addClass("hidden")},init:function(){$("#wincmd-tbbackpack").removeClass("hidden");$("#win-backpack").resizable(WinBackpack._resize).draggable({handle:"h2"}).find("a.window-close").click(function(){$("#win-backpack").addClass("hidden");return false});WinBackpack._resize()},hide:function(){$("#win-backpack").addClass("hidden")},
showIfAdded:function(){$.ajax({url:"api/backpacklist.aspx",success:function(b){b=JSON.parse(b);b.length>0&&WinBackpack._latestTimestamp!=b[b.length-1].timestamp.sec&&WinBackpack.show()}})},show:function(){$("#win-backpack").removeClass("hidden").css("width",570).css("height",250).css("left",window.innerWidth-570).css("top",$(".toolbar-top").outerHeight());$("#win-backpack .overlay").detach();$("#win-backpack ul").empty();$.ajax({url:"api/backpacklist.aspx",success:function(b){b=JSON.parse(b);if(!b||
b.length==0)$("#win-backpack").append('<div class="overlay">'+g_loc.getText("backpack.empty")+"</div>").find("div.overlay").css("top",$("#win-backpack h2").outerHeight(true)).find("a").click(function(){return false});else{WinBackpack._latestTimestamp=b[b.length-1].timestamp.sec;for(var c=b.length-1;c>=0;c--){var d,e=null;if(b[c].type=="code")d=new WinBackpack.Resource(null,b[c].data,null);else if(b[c].type=="sprite"){d=new WinBackpack.Resource(b[c].img,null,b[c].data);JSON.parse(d.sprite).locked&&
(e="ide/imgs/tblock_tab.png")}if(d){d.id=b[c]._id.$id;WinBackpack.objects.push(d);var f=$('<li bid="'+b[c]._id.$id+'"><img class="main" src="'+d.img+'"/><a class="hidden" href="#">X</a></li>');e&&f.append('<img class="indicator" src="'+e+'"/>');$("#win-backpack ul").append(f);f.mouseenter(WinBackpack._mouseenter).mouseleave(WinBackpack._mouseleave).find("a").click(WinBackpack._click)}}}}});WinBackpack._resize()},add:function(b){var c="",d="",e="",f=null;if(b.code){c="code";d=b.code;e=null}else if(b.sprite){c=
"sprite";d=b.sprite;e=b.img;JSON.parse(d).locked&&(f="ide/imgs/tblock_tab.png")}$.ajax({url:"api/backpackadd.aspx",type:"POST",data:{t:c,d:d,i:e},success:function(c){$("#win-backpack .overlay").detach();b.id=c;WinBackpack.objects.push(b);if(!$("#win-backpack").hasClass("hidden")){c=$('<li bid="'+c+'"><img class="main" src="'+b.img+'"/><a class="hidden" href="#">X</a></li>');f&&c.append('<img class="indicator" src="'+f+'"/>');$("#win-backpack ul").prepend(c);c.mouseenter(WinBackpack._mouseenter).mouseleave(WinBackpack._mouseleave).find("a").click(WinBackpack._click)}}})},
_resize:function(){$("#win-backpack > div.items").css("top",$("#win-backpack h2").outerHeight(true))},_mouseenter:function(){$(this).find("a").removeClass("hidden")},_mouseleave:function(){$(this).find("a").addClass("hidden")},_click:function(){var b=$(this).parents("li").attr("bid");WinBackpack.remove(b);$(this).detach();return false},remove:function(b){for(var c=0;c<WinBackpack.objects.length;c++)if(WinBackpack.objects[c].id==b){WinBackpack.objects.splice(c,1);$("#win-backpack ul li[bid="+b+"]").detach();
WinBackpack.objects.length==0&&$("#win-backpack").append('<div class="overlay"><span>'+g_loc.getText("backpack.empty")+"</span></div>").find("div.overlay").css("top",$("#win-backpack h2").outerHeight(true));$.ajax({url:"api/backpackdelete.aspx",type:"POST",data:{i:b}});break}},canDrag:function(b,c){var d=false;if(!$("#win-backpack").hasClass("hidden")){var e=$("#win-backpack");b>=e.offset().left&&(b<=e.offset().left+e.outerWidth()&&c>=e.offset().top&&c<=e.offset().top+e.outerHeight())&&(d=true)}return d},
getDragObj:function(b,c){var d=null;if(!$("#win-backpack").hasClass("hidden")){var e=$("#win-backpack"),f=$("#win-backpack h2");b>=e.offset().left&&(b<=e.offset().left+e.outerWidth()&&c>=e.offset().top+f.outerHeight()&&c<=e.offset().top+e.outerHeight())&&$("#win-backpack li").each(function(e,f){f=$(f);if(b>=f.offset().left&&b<=f.offset().left+f.outerWidth()&&c>=f.offset().top&&c<=f.offset().top+f.outerHeight()){var j=f.attr("bid");if(j)for(var k=0;k<WinBackpack.objects.length;k++)if(WinBackpack.objects[k].id==
j){if(WinBackpack.objects[k].code)d=ObjectIO.deserializeScriptStep(JSON.parse(WinBackpack.objects[k].code));else if(WinBackpack.objects[k].sprite){j=WinBackpack.objects[k];d=new WinAssets.DragObject(j.img,j.sprite)}break}return false}})}return d},canDrop:function(b,c,d,e,f){var d=false,g=$("#wincmd-tbbackpack");if(e instanceof Block||e instanceof Label)b+e.x>g.offset().left+g.outerWidth()||(b+e.x+e.width<g.offset().left||c+e.y+e.height<g.offset().top||c+e.y>g.offset().top+g.outerHeight())||(d=true);
if(!d&&e instanceof WinAssets.DragObject){var h=e.img.width,j=e.img.height;if(h>128){j=j*128/h;h=128}if(j>128){h=h*128/j;j=128}b-h/2>g.offset().left+g.outerWidth()||(b+h/2<g.offset().left||c+j/2<g.offset().top||c-j/2>g.offset().top+g.outerHeight())||(d=true)}if(!d&&!$("#win-backpack").hasClass("hidden")){g=$("#win-backpack");b>=g.offset().left&&(b<=g.offset().left+g.outerWidth()&&c>=g.offset().top&&c<=g.offset().top+g.outerHeight())&&(d=true)}if(d){if($("#win-backpack").hasClass("hidden")){if($(".toolbar-top").hasClass("hidden")||
$("#wincmd-tbbackpack").parent().hasClass("hidden"))return false;WinBackpack.show()}if(f!=WinBackpack&&(e instanceof Block||e instanceof Label)||f!=WinBackpack&&e instanceof WinAssets.DragObject)return true}return false},dragOver:function(b,c,d,e){var d=false,f=$("#wincmd-tbbackpack");if(e instanceof Block||e instanceof Label)b+e.x>f.offset().left+f.outerWidth()||(b+e.x+e.width<f.offset().left||c+e.y+e.height<f.offset().top||c+e.y>f.offset().top+f.outerHeight())||(d=true);if(!d&&e instanceof WinAssets.DragObject){var g=
e.img.width,e=e.img.height;if(g>128){e=e*128/g;g=128}if(e>128){g=g*128/e;e=128}b-g/2>f.offset().left+f.outerWidth()||(b+g/2<f.offset().left||c+e/2<f.offset().top||c-e/2>f.offset().top+f.outerHeight())||(d=true)}if(!d&&!$("#win-backpack").hasClass("hidden")){f=$("#win-backpack");b>=f.offset().left&&(b<=f.offset().left+f.outerWidth()&&c>=f.offset().top&&c<=f.offset().top+f.outerHeight())&&(d=true)}if(d&&$("#win-backpack").hasClass("hidden")){if($(".toolbar-top").hasClass("hidden")||$("#wincmd-tbbackpack").parent().hasClass("hidden"))return false;
WinBackpack.show()}},drop:function(b,c,d,e,f){var d=false,g=$("#wincmd-tbbackpack");if(e instanceof Block||e instanceof Label)b+e.x>g.offset().left+g.outerWidth()||(b+e.x+e.width<g.offset().left||c+e.y+e.height<g.offset().top||c+e.y>g.offset().top+g.outerHeight())||(d=true);if(!d&&e instanceof WinAssets.DragObject){var h=e.img.width,j=e.img.height;if(h>128){j=j*128/h;h=128}if(j>128){h=h*128/j;j=128}b-h/2>g.offset().left+g.outerWidth()||(b+h/2<g.offset().left||c+j/2<g.offset().top||c-j/2>g.offset().top+
g.outerHeight())||(d=true)}if(!d&&!$("#win-backpack").hasClass("hidden")){g=$("#win-backpack");b>=g.offset().left&&(b<=g.offset().left+g.outerWidth()&&c>=g.offset().top&&c<=g.offset().top+g.outerHeight())&&(d=true)}if(d)if(e instanceof Block||e instanceof Label){b=e.x;c=e.y;e.x=0;e.y=0;e.showDragHandle=false;d=new WinBackpack.Resource(null,e,null);WinBackpack.add(d);e.x=b;e.y=c;f==WinCode&&IDE.Clipboard.doUndo()}else if(e instanceof WinAssets.DragObject&&e.sprite){d=new WinBackpack.Resource(e.img.src,
null,e.sprite);WinBackpack.add(d)}},_sanitize:function(b){if(b&&typeof b=="object"){for(var c in b)if(!b.classname&&c=="id"){b[c]=void 0;delete b[c]}else WinBackpack._sanitize(b[c]);if(b.length)for(c=0;c<b.length;c++)WinBackpack._sanitize(b[c])}},Resource:function(b,c,d){if(c){if(c instanceof Block){b=c.copy();b.x=0;b.y=0;b.showDragHandle=false;c=JSON.stringify(ObjectIO.genScriptObj(b))}else if(c instanceof Label){b=c.copy();b.x=0;b.y=0;b.showDragHandle=false;b._computeBounds();c=JSON.stringify(ObjectIO.genValueObj(b))}else if(typeof c==
"string"){b=ObjectIO.deserializeScriptStep(JSON.parse(c)).copy();c=b instanceof Block?JSON.stringify(ObjectIO.genScriptObj(b)):JSON.stringify(ObjectIO.genValueObj(b))}else{b=ObjectIO.deserializeScriptStep(c).copy();c=JSON.stringify(ObjectIO.genScriptObj(b))}this.code=c;this.img=b.getImage().src}else if(d){c=JSON.parse(d);WinBackpack._sanitize(c);this.sprite=d=JSON.stringify(c);this.img=b}}},WinAssets={_forceBackgroundAssets:!1,_enableDelete:!0,_enableContextMenu:!0,_enableHideInSandbox:!1,_enableLockInSandbox:!1,
_enableSandbox:!1,_disableCodeDrop:!1,_listeners:[],enable:function(b){b?$("#win-assets").removeClass("hidden"):$("#win-assets").addClass("hidden");IDE.adjustPanels()},enableDecorations:function(b){b?$("#win-assets h1").removeClass("hidden"):$("#win-assets h1").addClass("hidden");IDE.adjustPanels()},enableDelete:function(b){b?$("#win-assets a.delete").removeClass("hidden"):$("#win-assets a.delete").addClass("hidden");WinAssets._enableDelete=b},enableAddByURL:function(b){var c=$("#addassetsdialog");
if(b){c.find(".import-options .link").removeClass("hidden");$(".import-options .link").click(function(){$(this).toggleClass("selected");$("#image-url").toggleClass("hidden")});c.find("input[type=text]").unbind().keypress(function(b){var c=$("#addassetsdialog input[type=text]").val();if(b.which==13){WinAssets._callback&&generateImageFromUrl(c,function(){WinAssets._callback([{url:c,name:""}])});$.modal.close()}});$("#win-properties .looks .url").removeClass("hidden")}else{c.find("#image-url").addClass("hidden");
$("#win-properties .looks .url").addClass("hidden")}},enableSandbox:function(b){b?$("#win-assets > div.actors ul li.stage").removeClass("hidden"):$("#win-assets > div.actors ul li.stage").addClass("hidden");b?$("#win-assets .actors li.stage").addClass("hidden"):$("#win-assets .actors li.stage").removeClass("hidden");var c=$("#win-assets > div.actors ul");$("li.actor",c).each(function(c,e){var f=$(e),g=f.data("sprite");if(g.hiddenInSandbox||g.lockedInSandbox)if(b){g.hiddenInSandbox&&f.addClass("hidden");
if(g.lockedInSandbox){g.spriteObj.selectable=false;g.spriteObj.draggable=false}}else{g.hiddenInSandbox&&f.removeClass("hidden");if(g.lockedInSandbox){g.spriteObj.selectable=true;g.spriteObj.draggable=true}}});WinAssets._enableSandbox=b},enableStrip:function(b){if(b){$("#win-assets").addClass("strip");$("#win-assets .tab-content").sortable("disable")}else{$("#win-assets").removeClass("strip");$("#win-assets .tab-content").sortable("enable")}},init:function(){$("#actors-tab").click(function(){$("#win-assets").removeClass("scenes");
$("#win-assets").addClass("actors");Runtime.sprites.length>0&&IDE.selectAsset(Runtime.sprites[0]);return false});$("#scenes-tab").click(function(){$("#win-assets").addClass("scenes");$("#win-assets").removeClass("actors");IDE.selectAsset(null);return false});$("#win-assets").removeClass("hidden");WinAssets.adjustWindow();WinAssets.trackActor(null);$("#assetcmd-addactor").click(WinAssets._addActorButton);$("#assetcmd-addscene").click(WinAssets._addSceneButton);window.setInterval(WinAssets.update,1E3);
$("#win-assets .assets-toolbar a.delete").click(function(){WinAssets.cutActor();return false});$("#win-assets .assets-toolbar a.duplicate").click(function(){WinAssets.cloneActor();return false});$("#win-assets .assets-toolbar a.advanced").click(function(){IDE.editingActor&&IDE.editingActor.locked?WinProperties.show("interfaces"):WinProperties.show();return false});$("#win-assets .actors").mousedown(function(b){if(b.which==3&&!$("#win-assets").hasClass("strip")){WinAssets.showContextMenu(b,null);return false}});
$("#win-assets .background").mousedown(function(b){if(b.which==3&&!$("#win-assets").hasClass("strip")){WinAssets.showContextBgMenu(b,null);return false}});$("#win-assets > div").css("top",$("#win-assets h1").outerHeight()+"px");$("#addassetsdialog .cmd-draw").click(function(){if(!$(this).hasClass("disabled")){WinMediaAssets.reset();$.modal.close();window.WinPaint&&WinPaint.edit(g_loc.getText("title.paint_create_actor"),null,null,null,function(b,c,d){WinAssets._callback&&WinAssets._callback([{url:b,
cx:c,cy:d}])})}return false});$("#addassetsdialog .character").click(function(){if(!$(this).hasClass("disabled")){WinMediaAssets.reset();$.modal.close();window.WinSpine&&WinSpine.showCreator(function(b,c){Sprites.addSprite({cx:500,cy:500,scale:b=="Tiny"?1:0.25,label:"actor",costumeName:"actor",img:"avatar://spine",forceNumber:false,skeletonType:b,skeletonParts:c},function(b){b.spriteObj.setPosition(Runtime.stage.getWidth()/2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/2-Runtime.stage.tileLayer.getScrollOffsetY());
IDE.selectAsset(b);IDE.Clipboard.undoAddActor(b)})})}return false});$("#addassetsdialog .blank").click(function(){if(!$(this).hasClass("disabled")){WinMediaAssets.reset();$.modal.close();WinAssets._callback&&WinAssets._callback([{url:"ide/imgs/blank.png"}])}return false});$("#addassetsdialog .cmd-vector").click(function(){if(!$(this).hasClass("disabled")){WinMediaAssets.reset();$.modal.close();window.WinSVGPaint&&WinSVGPaint.edit(g_loc.getText("title.paint_create_actor"),null,null,null,function(b,
c,d){WinAssets._callback&&WinAssets._callback([{url:b,cx:c,cy:d}])})}return false});$("#addassetsdialog .import-image").change(function(b){$.each(b.originalEvent.target.files,function(b,d){var e=getFilename(d.name);if(d.type.match("image.*")){var f=new FileReader;f.onload=function(b){$.ajax({url:WinMediaAssets.medialibsave,type:"POST",data:{d:b.target.result},success:function(b){b=JSON.parse(b);WinAssets._callback&&WinAssets._callback([{url:"/assets/user/"+b.id+".png",name:e}])}})};f.readAsDataURL(d)}else if(d.type==
"audio/mp3"||d.type=="audio/mpeg"||d.type=="audio/vnd.wav"){var g=".mp3";d.type=="audio/vnd.wav"&&(g=".wav");f=new FileReader;f.onload=function(b){$.ajax({url:WinMediaAssets.medialibsave,type:"POST",data:{d:b.target.result},success:function(b){b=JSON.parse(b);WinAssets._callback&&WinAssets._callback([{url:"/assets/user/"+b.id+g,name:e}])}})};f.readAsDataURL(d)}})});$("#addassetsdialog .import").click(function(){if(!$(this).hasClass("disabled")){WinMediaAssets.reset();$.modal.close();$("#addassetsdialog").find(".import-image").click()}return false});
$("#addassetsdialog .photo").click(function(){if(!$(this).hasClass("disabled")){WinMediaAssets.reset();$.modal.close();MediaCapture.supportsCapture&&WinMediaCapture.showPictureTaker(function(b){WinAssets._callback&&WinAssets._callback([{url:b,name:"Photo"}])})}return false});$("#win-assets .tab-content").sortable({items:"li.actor",stop:function(){IDE.dirty();var b=[];$("#win-assets .tab-content li.actor").each(function(c,d){$(d).hasClass("stacked")||b.push($(d).data("sprite"))});Runtime.sprites=b}})},
_addActorButton:function(){$("#addassetsdialog h2").text("Add an Actor");$("#addassetsdialog .character").removeClass("hidden");WinAssets._callback=WinAssets._addAssetAsActor;$("#addassetsdialog a.library").unbind().click(function(){WinMediaAssets.showPicker("Add an Actor",WinAssets._addAssetAsActor,{backgrounds:true,actors:true,images:true,sounds:true,charStudio:true})})},_addSceneButton:function(){$("#addassetsdialog h2").text("Add a Scene");$("#addassetsdialog .character").addClass("hidden");WinAssets._callback=
WinAssets._addAssetAsScene;$("#addassetsdialog a.library").unbind().click(function(){WinMediaAssets.showPicker("Add an Scene",WinAssets._addAssetAsScene,{backgrounds:true,actors:false,images:false,sounds:true,charStudio:false})})},_addAssetAsActor:function(b,c,d){var e=b[0],f=getFileExt(e.url);if(f==".mp3"||f==".wav"){if(IDE.editingActor){IDE.addResourceTo(e.url,e.name,IDE.editingActor);return IDE.editingActor}IDE.addResourceTo(e.url,e.name,Runtime.background);return Runtime.background}if(f==".actor")ObjectIO.loadSprite(e.url,
function(b){b.spriteObj.setPosition(Runtime.stage.getWidth()/2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/2-Runtime.stage.tileLayer.getScrollOffsetY());Runtime.stage.draw();IDE.computeAll();IDE.draw();IDE.selectAsset(b);IDE.Clipboard.undoAddActor(b)});else if(WinAssets._forceBackgroundAssets)var g=Runtime.background.addCostume({img:e.url,name:e.name},function(){Runtime.background.setCostumeByName(g.name);IDE.Clipboard.undoAddCostume(Runtime.background,g)});else{IDE.dirty();
f=1;if(e.url.indexOf("avatar://")==0&&(Runtime.stage.width<800||Runtime.stage.height<800))f=0.5;var h=Sprites.addSprite({cx:e.cx,cy:e.cy,scale:f,label:d?d:e.name?e.name:"actor",costumeName:e.name?e.name:"actor",img:e.url,forceNumber:false},function(){h.spriteObj.setPosition(Runtime.stage.getWidth()/2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/2-Runtime.stage.tileLayer.getScrollOffsetY());IDE._ignoreUpdates=true;for(var c=1;c<b.length;c++)h.addCostume({img:b[c].url,name:b[c].name,
cx:b[c].cx,cy:b[c].cy});IDE._ignoreUpdates=false;b[0].code&&ObjectIO.deserializeScripts(h,JSON.parse(b[0].code));IDE.selectAsset(h);IDE.Clipboard.undoAddActor(h)});if(c)h.avatarid=c;return h}},_addAssetAsScene:function(b){for(var c=0;c<b.length;c++){var d=b[c],e=getFileExt(d.url);if(e==".mp3"||e==".wav")IDE.addResourceTo(d.url,d.name,Runtime.background);else var f=Runtime.background.addCostume({img:d.url,name:d.name},function(){Runtime.background.setCostumeByName(f.name);IDE.Clipboard.undoAddCostume(Runtime.background,
f)})}},reset:function(){$("#win-assets > div ul").empty();var b=$('<li class="addactor"><a href="#addassetsdialog" rel="modal:open"><div class="middle"><i class="icon-plus-2"></i></div><div class="edit">Add Actor</div><div class="asset-actions"></div></a></li>');b.find("a").click(WinAssets._addActorButton);$("#win-assets > div.actors > ul").append(b);WinAssets.trackActor(null)},adjustWindow:function(){if($("#win-assets").hasClass("strip")){var b=$("#win-assets > div.background"),c=$("#win-assets > div.actors"),
d=$("#win-assets h1:visible").outerHeight()+0,e=d+b.outerHeight();b.css("top",d);c.css("top",e)}else $("#win-assets > div").css("top",$("#win-assets h1:visible").outerHeight()+0)},broadcastListeners:function(b){for(var c=0;c<WinAssets._listeners.length;c++)WinAssets._listeners[c](b)},addListener:function(b){WinAssets._listeners.push(b)},removeListener:function(b){for(var c=0;c<WinAssets._listeners.length;c++)WinAssets._listeners[c]==b&&WinAssets._listeners.splice(c,1)},removeAllListeners:function(){WinAssets._listeners=
[]},unregisterActor:function(b){$("#win-assets > div > ul > li").each(function(){if($(this).hasClass("stacked")){$(this).find("li").each(function(){if($(this).data("sprite")==b){$(this).detach();b==IDE.editingActor&&IDE.selectAsset(null);return false}});var c=$(this).find("li");if(c.length<=1){c=$(c[0]);c.detach();c.insertAfter($(this));$(this).detach()}else c.length<=0?$(this).detach():$(this).parents("li").find("> .edit span").text("("+c.length+") "+b.classname)}else if($(this).data("sprite")==
b){$(this).detach();b==IDE.editingActor&&IDE.selectAsset(null);return false}})},_addBlankSprite:function(){IDE.dirty();var b=Sprites.addSprite({costumeName:"blank",img:"ide/imgs/blank.png",forceNumber:false});b.spriteObj.setPosition(Runtime.stage.getWidth()/2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/2-Runtime.stage.tileLayer.getScrollOffsetY());IDE.selectAsset(b);IDE.Clipboard.undoAddActor(b)},deleteActor:function(b){var c=b?b.data("sprite"):IDE.editingActor;IDE.dirty();
IDE.confirmDialog(g_loc.formatText("winassets.confirmdelete",c.label),function(){c.deleteActor();IDE.Clipboard.undoDeleteActor(c)})},cutActor:function(b){if(!b){b=$("#win-assets .actors > ul > li.selected");b.length>0&&b.hasClass("stacked")&&(b=b.find("li.selected"));if(b.length<=0)return}var c=b.data("sprite");IDE.dirty();IDE.confirmDialog(g_loc.formatText("winassets.confirmdelete",c.label),function(){IDE.Clipboard.clear();IDE.Clipboard.add("sprite",JSON.stringify(ObjectIO.serializeSprite(c)));c.deleteActor();
IDE.Clipboard.undoDeleteActor(c)})},copyActor:function(b){if(!b){b=$("#win-assets .actors li.selected");if(b.length<=0)return}b=b.data("sprite");IDE.Clipboard.clear();IDE.Clipboard.add("sprite",JSON.stringify(ObjectIO.serializeSprite(b)))},pasteActor:function(){var b=IDE.Clipboard.get("sprite");b&&ObjectIO.deserializeSprite(JSON.parse(b))},saveActor:function(b){if(!b){b=$("#win-assets .actors li.selected");if(b.length<=0)return}b=b.data("sprite");IDE.dirty();IDE.cmdActorSave(b)},unlockActor:function(b){if(!b){b=
$("#win-assets .actors li.selected");if(b.length<=0)return}IDE.confirmDialog(g_loc.getText("winproperties.confirmunlock"),function(){var c=b.data("sprite");IDE.dirty();c.locked=false;for(var d=0;d<c.scripts.length;d++)c.scripts[d].hidden=false;for(d=0;d<c.costumes.length;d++)c.costumes[d].hidden=false;for(d=0;d<c.sounds.length;d++)c.sounds[d].hidden=false;WinTools.reset();IDE.selectAsset(c)});return false},cloneActor:function(b){if(!b){b=$("#win-assets .actors li.selected");if(b.length<=0)return}b=
b.data("sprite");IDE.dirty();IDE.selectAsset(IDE.cloneActor(b))},detachActor:function(b){if(!b){b=$("#win-assets .actors li.selected");if(b.length<=0)return}b=b.data("sprite");if(b.id&&b.classname){IDE.dirty();delete b.id;delete b.classname;Runtime.unregisterScripts(b);var c=ObjectIO.serializeScripts(b);b.scripts=[];ObjectIO.deserializeScripts(b,c);Runtime.registerScripts(b);WinAssets.refresh();IDE.selectAsset(b)}},toggleHideActorInSandbox:function(b){if(!b){b=$("#win-assets .actors li.selected");
if(b.length<=0)return}b=b.data("sprite");b.hiddenInSandbox=!b.hiddenInSandbox;b.lockedInSandbox=b.hiddenInSandbox;IDE.dirty();return false},toggleLockActorInSandbox:function(b){if(!b){b=$("#win-assets .actors li.selected");if(b.length<=0)return}b=b.data("sprite");b.lockedInSandbox=!b.lockedInSandbox;IDE.dirty();return false},moveFront:function(b){if(!b){b=$("#win-assets .actors li.selected");if(b.length<=0)return}b.data("sprite").spriteObj.moveToTop();Runtime.stage.draw();IDE.dirty()},moveBack:function(b){if(!b){b=
$("#win-assets .actors li.selected");if(b.length<=0)return}b.data("sprite").spriteObj.moveToBottom();Runtime.stage.draw();IDE.dirty()},_mouseEnter:function(){var b=$(this).find("a.delete").addClass("hidden");b.hasClass("hidden")&&b.removeClass("hidden")},trackActor:function(b){var c=null;if(b){c=$('<li class="actor"><div class="middle"><img class="main" src=""/><img class="indicator hidden" src="ide/imgs/tblock_tab.png"/></div><div class="edit"><span></span><input type="text" class="hidden"/></div><div class="asset-actions"><a class="looks-tab icon-cog-2"></a><a class="delete icon-cancel-2"></a></div></li>');
b.hidden&&c.addClass("hidden");c.data("sprite",b).find("span").text(b.label);if(b.id&&b.classname&&!b.locked){c.attr("data-classname",b.classname);var d=null;$("#win-assets > div.actors > ul > li").each(function(){if($(this).attr("data-classname")==b.classname){d=$(this).find("ul");if(d.length==0){d=$("<ul></ul>");var c=$(this).clone();c.data("sprite",$(this).data("sprite"));c.insertAfter($(this));$(this).detach();d.append($(this));c.append(d).addClass("stacked");$("#win-assets > div.actors > ul").append(c);
var e=$('<a href="#" class="expander"></a>');c.append(e);e.click(function(){$(this).parents("li").toggleClass("expand");return false});c.dblclick(function(){$(this).toggleClass("expand");return false});c.find(".middle").click(WinAssets._handleClick)}return false}});if(d){d.append(c);var e=d.find("li").length;d.parents("li.stacked").find("> .edit span").text("("+e+") "+b.classname)}else{$("#win-assets > div.actors > ul").append(c);c.find("span").text(b.label)}}else{$("#win-assets > div.actors > ul").append(c);
c.find("span").text(b.label)}b.costumes[0].imgObj&&c.find("img.main").attr("src",b.costumes[0].imgObj.src);b.locked&&c.find("img:last").removeClass("hidden");c.dblclick(function(){IDE.editingActor&&(!IDE.editingActor.lockedInSandbox&&!$("#win-assets").hasClass("strip")&&!$("#win-assets").hasClass("noactions"))&&(IDE.editingActor.locked?WinProperties.show("interfaces"):WinProperties.show("looks"));return false});c.mousedown(function(){if(event.which==3&&!$("#win-assets").hasClass("strip")){WinAssets.showContextMenu(event,
$(this));return false}});c.find("> .asset-actions a.looks-tab").click(function(){IDE.editingActor&&IDE.editingActor.locked?WinProperties.show("interfaces"):WinProperties.show("looks");return false});c.find("> .asset-actions a.delete").click(function(){WinAssets.cutActor();return false});c.find("> .edit").click(function(){if(!$("#win-assets").hasClass("hidenames")&&!$(this).find("span").hasClass("hidden")&&!$("#win-assets").hasClass("strip")){$("#win-assets .actors-tab li .edit span").removeClass("hidden");
$("#win-assets .actors-tab li .edit input").addClass("hidden");WinAssets._selectActor($(this).parents("li"));if(IDE.editingActor){$(this).find("span").addClass("hidden");$(this).find("input").removeClass("hidden").val(IDE.editingActor.label).focus()}}return false});c.find("> .edit input").blur(function(){if(IDE.editingActor!=null){IDE.dirty();var b=$(this).val(),b=IDE.editingActor.changeSpriteName(b);$(this).parent(".edit").find("span").text(b)}$("#win-assets .actors-tab li .edit span").removeClass("hidden");
$("#win-assets .actors-tab li .edit input").addClass("hidden")}).keypress(function(b){b.which==13&&$(this)[0].blur()});c.data("sprite",b)}else{c=$('<li class="stage"><div class="middle"><img class="main" src="ide/imgs/default-background.png"/></div><div class="edit">Stage</div><div class="asset-actions"><a class="looks-tab icon-cog-2"></a></div></li>');$("#win-assets > div.actors > ul").append(c);c.find(".looks-tab").click(function(){WinProperties.show("looks");return false});c.dblclick(function(){!$("#win-assets").hasClass("strip")&&
!$("#win-assets").hasClass("noactions")&&WinProperties.show("looks");return false})}c.click(WinAssets._handleClick)},_handleClick:function(){var b=$(this).data("sprite");if(WinAssets._enableSandbox&&b&&b.lockedInSandbox)return false;$("#win-assets .actors-tab li .edit span").removeClass("hidden");$("#win-assets .actors-tab li .edit input").addClass("hidden");$(this)[0].tagName=="LI"?WinAssets._selectActor($(this)):WinAssets._selectActor($(this).parents("li"));return false},_selectActor:function(b){$("#win-assets > div li").removeClass("selected");
b.addClass("selected");b=b.data("sprite");WinAssets.broadcastListeners(b)},getSelection:function(){var b=$("#win-assets .actors li.selected");return b.length>0?b:null},showBackground:function(b){if(b){IDE.selectAsset(null);WinProperties.show("looks")}else Runtime.sprites.length>0&&IDE.selectAsset(Runtime.sprites[0])},selectAsset:function(b){if(b&&b!=Runtime.background){$("#win-assets .actors li").removeClass("selected");$("#win-assets .actors > ul > li").each(function(){var c=false;$(this).hasClass("stacked")?
$(this).find("li").each(function(){if($(this).data("sprite")==b){$(this).addClass("selected");c=true;return false}}):$(this).data("sprite")==b&&(c=true);if(c){$(this).addClass("selected");$("#win-assets").removeClass("scenes");$("#win-assets").addClass("actors");return false}})}else{$("#win-assets .actors li").removeClass("selected");$("#win-assets .actors li.stage").addClass("selected")}},showContextBgMenu:function(b){if(WinAssets._enableSandbox)return false;if(!WinCode._readOnly&&WinAssets._enableContextMenu){$(".choice-chooser").detach();
var c=window.outerHeight-b.pageY,d=b.pageX,e=b.pageY,f=$('<div class="choice-chooser"><ul></ul></div>');f.css("left",d+"px");f.css("top",e+"px");if(c<190){e=b.pageY-90;f.css("top",e+"px")}$("body").append(f);f=f.find("ul");b=$("<li>"+g_loc.getText("menu.addannotation")+"</li>");b.click(function(){$(".choice-chooser").detach();WinAnnotation.isVisible||WinAnnotation.show();WinAnnotation.switchEditMode();var b=$('<p><a class="link" href="#" data-stage="Stage"><img src="ide/imgs/blank.png"/></a></p>');
Runtime.background.costumes.length>0&&b.find("img").attr("src",Runtime.background.costumes[Runtime.background.currentCostume-1].img);WinAnnotation.addNote(b)});f.append(b)}},showContextMenu:function(b,c){if(WinAssets._enableSandbox&&c&&c.data("sprite")&&c.data("sprite").lockedInSandbox)return false;if(!WinCode._readOnly&&WinAssets._enableContextMenu){$(".choice-chooser").detach();var d=b.pageX,e=b.pageY,f=$('<div class="choice-chooser"><ul></ul></div>');f.css("left",d+"px");f.css("top",e+"px");$("body").append(f);
d=f.find("ul");e=$("<li>"+g_loc.getText("menu.addannotation")+"</li>");e.click(function(){$(".choice-chooser").detach();WinAnnotation.isVisible||WinAnnotation.show();WinAnnotation.switchEditMode();var b=$('<p><a class="link" href="#"><img src="ide/imgs/blank.png"/></a></p>'),d=c.data("sprite");b.find("a").attr("data-actor",d.label);d.costumes.length>0&&(d.costumes[d.currentCostume-1].imgPreview?b.find("img").attr("src",d.costumes[d.currentCostume-1].imgPreview):b.find("img").attr("src",d.costumes[d.currentCostume-
1].img));WinAnnotation.addNote(b)});d.append(e);if(c&&window.WinLessons&&WinLessons.currentPbIdx<0){e=$("<li>"+g_loc.getText("menu.cut")+"</li>");c&&$("#win-assets .actors li.selected").length>0?e.click(function(){$(".choice-chooser").detach();WinAssets.cutActor(c)}):e.addClass("disabled");d.append(e);e=$("<li>"+g_loc.getText("menu.copy")+"</li>");c&&$("#win-assets .actors li.selected").length>0?e.click(function(){$(".choice-chooser").detach();WinAssets.copyActor(c)}):e.addClass("disabled");d.append(e);
e=$("<li>"+g_loc.getText("menu.paste")+"</li>");IDE.Clipboard.get("sprite")?e.click(function(){$(".choice-chooser").detach();WinAssets.pasteActor()}):e.addClass("disabled");d.append(e);e=$("<li>"+g_loc.getText("menu.cloneactor")+"</li>");c?e.click(function(){$(".choice-chooser").detach();WinAssets.cloneActor()}):e.addClass("disabled");d.append(e);if(c.data("sprite").locked){e=$("<li>"+g_loc.getText("winassets.menuunlockactor")+"</li>");e.click(function(){$(".choice-chooser").detach();WinAssets.unlockActor(c)})}else{e=
$("<li>"+g_loc.getText("winassets.menusaveactor")+"</li>");e.click(function(){$(".choice-chooser").detach();WinAssets.saveActor(c)})}d.append(e);e=c.data("sprite");if(e.id&&e.classname){e=$("<li>Detach Actor</li>");e.click(function(){$(".choice-chooser").detach();WinAssets.detachActor(c)});d.append(e)}if(WinAssets._enableHideInSandbox){e=c.data("sprite").hiddenInSandbox?g_loc.getText("winassets.showinsandbox"):g_loc.getText("winassets.hideinsandbox");e=$("<li>"+e+"</li>");e.click(function(){$(".choice-chooser").detach();
WinAssets.toggleHideActorInSandbox(c)});d.append(e)}if(WinAssets._enableLockInSandbox&&!c.data("sprite").hiddenInSandbox){e=c.data("sprite").lockedInSandbox?g_loc.getText("winassets.unlockinsandbox"):g_loc.getText("winassets.lockinsandbox");e=$("<li>"+e+"</li>");e.click(function(){$(".choice-chooser").detach();WinAssets.toggleLockActorInSandbox(c)});d.append(e)}}b.pageY+d.height()>window.innerHeight&&f.css("top",window.innerHeight-d.height());b.pageX+d.width()>window.innerWidth&&f.css("left",window.innerWidth-
d.width())}},refresh:function(){$("#win-assets > div ul").empty();WinAssets.trackActor(null);for(var b=0;b<Runtime.sprites.length;b++)WinAssets.trackActor(Runtime.sprites[b])},update:function(){$("#win-assets > div li").each(function(){var b=$(this).data("sprite");if(b==null)b=Runtime.background;if(b.costumes.length>0){var c=$(this).find("img:first"),d=b.getCostumeByName(b.currentCostume);if(d[1].img=="avatar://spine"){if(d[1].imgPreview){d=d[1].imgPreview;c.attr("src")!=d&&c.attr("src",d)}}else d[1].imgObj?
c.attr("src")!=d[1].imgObj.src&&c.attr("src",d[1].imgObj.src):c.attr("src")!=d[1].img&&d[1].img.substring(0,9)!="avatar://"&&c.attr("src",d[1].img)}else{c=$(this).find("img:first");c.attr("src")!="ide/imgs/blank.png"&&c.attr("src","ide/imgs/blank.png")}b.locked?$(this).find("img:last").removeClass("hidden"):b!=Runtime.background&&$(this).find("img:last").addClass("hidden");if(b.id&&b.classname){c=$(this).parents("li.stacked");d=c.find("li").length;c.find("> .edit span").text("("+d+") "+b.classname)}else $(this).find("span").text(b.label)})},
canDrag:function(b,c){if(!$("#win-assets").hasClass("hidden")&&!$("#win-assets").hasClass("strip")&&!$("#win-assets").hasClass("noactions")){var d=$("#win-assets");if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight())for(var d=$("#win-assets .actors li.actor"),e=0;e<d.length;e++){var f=$(d[e]).find("div.middle");if(b>=f.offset().left&&b<=f.offset().left+f.outerWidth()&&c>=f.offset().top&&c<=f.offset().top+f.outerHeight())return true}}return false},
getDragObj:function(b,c){if(!$("#win-assets").hasClass("hidden")){var d=$("#win-assets");if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight())for(var d=$("#win-assets .actors li.actor"),e=0;e<d.length;e++){var f=$(d[e]).find("div.middle");if(b>=f.offset().left&&b<=f.offset().left+f.outerWidth()&&c>=f.offset().top&&c<=f.offset().top+f.outerHeight())return new WinAssets.DragObject(f.find("img").attr("src"),Runtime.sprites[e])}}return null},DragObject:function(b,
c){this.img=new Image;this.img.src=b;this.sprite=c instanceof Sprite?JSON.stringify(ObjectIO.serializeSprite(c)):c}};WinAssets.DragObject.prototype.draw=function(b){var c=this.img.width,d=this.img.height;if(c>128){d=d*128/c;c=128}if(d>128){c=c*128/d;d=128}b.drawImage(this.img,-c/2,-d/2,c,d)};
WinAssets.canDrop=function(b,c,d,e,f){if(!$("#win-assets").hasClass("hidden")){d=$("#win-assets");if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight()){if(f!=WinAssets&&e instanceof WinMediaAssets.DragObject&&(e.ext=="jpg"||e.ext=="png"||e.ext=="gif"||e.ext=="actor"||e.ext=="jpeg")||f!=WinAssets&&e instanceof WinAssets.DragObject)return true;if(!WinAssets._disableCodeDrop&&(e instanceof Block||e instanceof Label)){var g=false;$("#win-assets > div li").each(function(d,
e){e=$(e);e.data("sprite");if(b>=e.offset().left&&b<e.offset().left+e.outerWidth()&&c>=e.offset().top&&c<e.offset().top+e.outerHeight()){g=true;return false}});return g}}}return false};
WinAssets.drop=function(b,c,d,e,f){if(!$("#win-assets").hasClass("hidden")){d=$("#win-assets");if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight())if(e instanceof WinMediaAssets.DragObject&&(e.ext=="jpg"||e.ext=="png"||e.ext=="gif"||e.ext=="actor"||e.ext=="jpeg")){IDE.dirty();var g=false,d=$("#win-assets > div li");d.each(function(d,f){var f=$(f),k=f.data("sprite");if(k&&!k.locked&&b>=f.offset().left&&b<f.offset().left+f.outerWidth()&&c>=
f.offset().top&&c<f.offset().top+f.outerHeight()){var l=e.path;if(l.substring(l.length-6)==".actor")ObjectIO.loadSprite(l,function(b){b.spriteObj.setPosition(Runtime.stage.getWidth()/2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/2-Runtime.stage.tileLayer.getScrollOffsetY());Runtime.stage.draw();IDE.computeAll();IDE.draw();IDE.selectAsset(b);IDE.Clipboard.undoAddActor(b)});else if(e.ext=="mp3"||e.ext=="wav")if(k=f.data("sprite")){l=k.addSound({name:e.file,sound:l});IDE.Clipboard.undoAddSound(k,
l)}else{l=Runtime.background.addSound({name:e.file,sound:l});IDE.Clipboard.undoAddSound(Runtime.background,l)}else if(k=f.data("sprite")){l=k.addCostume({name:e.file,img:l});k.setCostumeByName(l.name);IDE.Clipboard.undoAddCostume(k,l)}else{l=Runtime.background.addCostume({name:e.file,img:l});Runtime.background.setCostumeByName(l.name);IDE.selectAsset(null);IDE.Clipboard.undoAddCostume(Runtime.background,l)}g=true;Runtime.stage.draw();return false}});if(!g){d=e.path;if(d.substring(d.length-6)==".actor")ObjectIO.loadSprite(d,
function(b){b.spriteObj.setPosition(Runtime.stage.getWidth()/2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/2-Runtime.stage.tileLayer.getScrollOffsetY());Runtime.stage.draw();IDE.computeAll();IDE.draw();IDE.selectAsset(b);IDE.Clipboard.undoAddActor(b)});else if(d.indexOf("/Backgrounds/")>=0){d=Runtime.background.addCostume({name:e.file,img:d});Runtime.background.setCostumeByName(d.name);IDE.selectAsset(null);IDE.Clipboard.undoAddCostume(Runtime.background,d)}else{d=Sprites.addSprite({costumeName:e.file,
img:d,forceNumber:false});d.spriteObj.x=Runtime.stage.getWidth()/2;d.spriteObj.y=Runtime.stage.getHeight()/2;IDE.selectAsset(d);IDE.Clipboard.undoAddActor(d)}}}else if(f!=WinAssets&&e instanceof WinAssets.DragObject){IDE.dirty();e.sprite instanceof Sprite||ObjectIO.deserializeSprite(JSON.parse(e.sprite))}else if(!WinAssets._disableCodeDrop&&(e instanceof Block||e instanceof Label)){d=$("#win-assets > div li");d.each(function(d,g){var g=$(g),k=g.data("sprite");if(b>=g.offset().left&&b<g.offset().left+
g.outerWidth()&&c>=g.offset().top&&c<g.offset().top+g.outerHeight()){f==WinCode&&IDE.Clipboard.doUndo();IDE.selectAsset(k);var l=WinCode.findBlankSpace();e.x=l.x;e.y=l.y;e._computeBounds();if(!k)k=Runtime.background;k.scripts.push(e);WinCode.draw();if(e.func.substring(0,8)=="register"){k=new Script({sprite:k,scriptBlock:e});k.currentBlock=k.scriptBlock;k.invokeStep()}return false}});IDE.dirty()}}};
if("undefined"==typeof window.WinMediaLib)var WinMediaLib={mediasave:"/api/mediasave",mediasubcategories:"/api/mediasubcategories2",mediafiles:"/api/mediafiles2",mediasetsfiles:"/api/mediasetsfiles2",mediadelete:"/api/mediadelete",_ignoreHidden:!1,showSearch:!0,fetchTypes:".png,.gif,.jpg,.jpeg,.svg,.actor,.mp3,.wav",currentPath:""};
WinMediaLib.init=function(){$("#win-medialib-sublevel-content").bind("drop",WinMediaLib.handleDropEvent).on("dragover",function(b){b.preventDefault()});$("#win-medialib .tabs .tab").click(WinMediaLib._topCategoryClicked);$("#win-medialib .import-image").change(function(b){$.each(b.originalEvent.target.files,function(b,d){var e=getFilename(d.name);if(d.type.match("image.*")){var f=new FileReader;f.onload=function(b){$.ajax({url:WinMediaLib.mediasave,type:"POST",data:{d:b.target.result},success:function(b){b=
JSON.parse(b);WinMediaLib._callback&&WinMediaLib._callback([{url:"/assets/user/"+b.id+".png",name:e}])}})};f.readAsDataURL(d)}else if(d.type=="audio/mp3"||d.type=="audio/mpeg"||d.type=="audio/vnd.wav"){var g=".mp3";d.type=="audio/vnd.wav"&&(g=".wav");f=new FileReader;f.onload=function(b){$.ajax({url:WinMediaLib.mediasave,type:"POST",data:{d:b.target.result},success:function(b){b=JSON.parse(b);WinMediaLib._callback&&WinMediaLib._callback([{url:"/assets/user/"+b.id+g,name:e}])}})};f.readAsDataURL(d)}})});
$("#win-medialib ul.content").scroll(WinMediaLib._loadIntoView)};WinMediaLib.adjustWindow=function(){$("#preview").hasClass("hidden")||WinPreview.adjustWindow()};WinMediaLib.setSelectionCallback=function(b){WinMediaLib._selectionCallback=b};WinMediaLib.hide=function(){$.modal.close()};
WinMediaLib.showPicker=function(b,c,d,e,f){WinMediaLib._callback=d;WinMediaLib._filters=e;e=(window.innerWidth-20)*0.8;d=window.innerHeight-$(".toolbar-top").outerHeight()-20;$("#win-medialib").addClass("hastabs").find(".tabpanel").addClass("hastree").removeClass("haspath");$("#win-medialib").css("width",e).css("height",d);$("#win-medialib").modal();!WinMediaLib.simplifiedResources&&$("#win-medialib .tabpanel .content li").length==0&&$("#win-medialib .tabs .tab.people").click();$("#win-medialib .okBtn").unbind().click(function(){WinMediaLib._addResources();
$.modal.close();return false});$("#win-medialib .cancelBtn").unbind().click(function(){$.modal.close();return false});$("#win-medialib .cart").empty().append(g_loc.getText("wincontent.emptycart"));$("#win-medialib ul.content li").removeClass("selected");$("#win-medialib-search").length==0&&WinMediaLib.showSearch&&$("#win-medialib").parents(".ui-dialog").append('<em id="win-medialib-search">Search <input type="text"/></em>');if($("#win-medialib-actions").length==0){$("#win-medialib").parent().find(".ui-dialog-titlebar").css("height",
25).append('<div id="win-medialib-actions"><a class="draw" title="Draw" href="#"></a> <a class="import" title="Import" href="#"></a> <a class="photo" title="Photo" href="#"></a> <a class="record" title="Record" href="#"></a></div>');$("#win-medialib-actions .draw").click(function(){if(!$(this).hasClass("disabled")){$.modal.close();window.WinPaint&&WinPaint.edit(g_loc.getText("title.paint_create_actor"),null,null,null,function(b,c,d){WinMediaLib._callback&&WinMediaLib._callback([{url:b,name:"drawing",
cx:c,cy:d}])})}return false});$("#win-medialib-actions .import").click(function(){if(!$(this).hasClass("disabled")){$("#win-medialib .import-image").click();$.modal.close()}return false});$("#win-medialib-actions .photo").click(function(){if(!$(this).hasClass("disabled")&&MediaCapture.supportsCapture){$.modal.close();WinMediaCapture.showPictureTaker(function(b){WinMediaLib._callback&&WinMediaLib._callback([{url:b,name:"Photo"}])})}return false});$("#win-medialib-actions .record").click(function(){if(!$(this).hasClass("disabled")&&
MediaCapture.supportsCapture){$.modal.close();WinMediaCapture.showAudioRecorder(function(b){IDE.editingActor?IDE.addResourceTo(b,"Recording",IDE.editingActor):IDE.addResourceTo(b,"Recording",Runtime.background)})}return false})}e=$("#director-info").hasClass("hidden")?window.innerHeight-$(".toolbar-top").outerHeight()-windowPadding*4:window.innerHeight-$(".toolbar-top").outerHeight()-windowPadding*4-$("#director-info").outerHeight();e>d&&(e=d);$("#win-medialib").css("height",e).modal();if(typeof b==
"string")$("#win-medialib").removeClass("hascontext");else{$("#win-medialib").addClass("hascontext");$("#win-medialib .addingto .context").text(b.title);b.actor.costumes&&b.actor.costumes.length>0?$("#win-medialib .addingto .thumbnail").css("background-image","url("+b.actor.costumes[0].imgObj.src+")"):$("#win-medialib .addingto .thumbnail").css("background-image","url(ide/imgs/blank.png)");$("#win-medialib .addingto .name").text(b.actor.label)}if(WinMediaLib.simplifiedResources){WinPreview.hide();
WinMediaLib.switchSimplified();f&&f()}else{$("#win-medialib").addClass("hastabs").find(".tabpanel").addClass("hastree");$("#win-medialib-actions .draw").removeClass("hidden");$("#win-medialib-actions .photo").removeClass("hidden");$("#win-medialib-actions .record").addClass("hidden");!WinMediaLib._filters||WinMediaLib._filters.sounds?$("#win-medialib .tab.sounds").removeClass("hidden"):$("#win-medialib .tab.sounds").addClass("hidden");!WinMediaLib._filters||WinMediaLib._filters.code?$("#win-medialib .tab.tynkerblocks").removeClass("hidden"):
$("#win-medialib .tab.tynkerblocks").addClass("hidden");if(c)if(c.indexOf("Backgrounds")==0)$("#win-medialib .tabs .tab.scenes").click();else if(c.indexOf("Images/People")==0)$("#win-medialib .tabs .tab.people").click();else if(c.indexOf("Images/Animals")==0)$("#win-medialib .tabs .tab.animals").click();else if(c.indexOf("Images/Things")==0)$("#win-medialib .tabs .tab.things").click();else if(c.indexOf("Images/Animations")==0)$("#win-medialib .tabs .tab.animations").click();else if(c.indexOf("Images/Collections")==
0)$("#win-medialib .tabs .tab.collections").click();else if(c.indexOf("TynkerBlocks")==0)$("#win-medialib .tabs .tab.tynkerblocks").click();else if(c.indexOf("MyStuff")==0)$("#win-medialib .tabs .tab.mystuff").click();else if(c.indexOf("Sounds")==0){$("#win-medialib .tabs .tab.sounds").click();$("#win-medialib").removeClass("hastabs").find(".tabpanel").removeClass("hastree");$("#win-medialib-actions .draw").addClass("hidden");$("#win-medialib-actions .photo").addClass("hidden");$("#win-medialib-actions .record").removeClass("hidden")}}$("#win-medialib-search input").unbind().focus(function(){if($(this).val()==
g_loc.getText("wincontent.search")){$(this).val("");$(this).css("color","#000")}}).blur(function(){if($(this).val()==""){$(this).val(g_loc.getText("wincontent.search"));$(this).css("color","#aaa")}}).click(function(){$(this).focus()}).keyup(function(b){if(b.keyCode==13||(b.metaKey||b.ctrlKey)&&b.which==70){WinPreview.hide();if(b=$.trim($(this).val())){$("#win-medialib").removeClass("hastabs");$("#win-medialib .tabpanel").removeClass("hastree").addClass("haspath").find(".path").html('<span></span> <a href="#">Search</a> &gt; '+
b).unbind().click(function(){$("#win-medialib .tabpanel").addClass("hastree");$("#win-medialib .tabpanel").removeClass("haspath");if(WinMediaLib._filters&&WinMediaLib._filters.sounds){$("#win-medialib .tabs .tab.sounds").click();$("#win-medialib").removeClass("hastabs")}else{$("#win-medialib .tabs .tab:first").click();$("#win-medialib").addClass("hastabs")}return false});var c="";if($("#win-medialib-sublevel").hasClass("hidden")){$("#win-medialib-sublevel-content-path").html("<h3>All &gt; Search</h3>");
$("#win-medialib-toplevel").addClass("hidden");$("#win-medialib-sublevel").removeClass("hidden");$("#win-medialib-sublevel-breadcrumb div").html("Search");$("#win-medialib-sublevel-breadcrumb div").click(WinMediaLib._fetchSubCategories(null,d));$("#win-medialib-sublevel-category ul").empty();WinPreview.hide();c=b}else{var d=$("#win-medialib-sublevel-breadcrumb div").text();if(d=="TynkerBlocks")c="TynkerBlocks/"+b;else if(WinMediaLib._filters){b="";if(WinMediaLib._filters.sounds){$("#win-medialib-sublevel-content-path").html("<h3>Search</h3>");
b='@ftype "audio/vnd.wav" | @ftype "audio/mp3" | @ftype "audio/mpeg"'}else if(WinMediaLib._filters.images)if(d=="Search")b='@ftype !"audio/vnd.wav" @ftype !"audio/mp3" @ftype !"audio/mpeg"';else{$("#win-medialib-sublevel-content-path").html("<h3>"+d+" &gt; Search</h3>");b='@ftype !"audio/vnd.wav" @ftype !"audio/mp3" @ftype !"audio/mpeg" @fhierarchy "'+d+'"'}c=b+" @*"+$(this).val()+"*"}else c="@*"+$(this).val()+"*"}WinMediaLib._fetchFiles("search/"+c,f)}else{$("#win-medialib").addClass("hastabs");
$("#win-medialib .tabpanel").addClass("hastree");$("#win-medialib .tab.people").click();$(this).blur()}}}).val(g_loc.getText("wincontent.search")).css("color","#aaa")};
WinMediaLib.handleDropEvent=function(b,c){b.originalEvent.stopPropagation();b.originalEvent.preventDefault();for(var d=b.originalEvent.dataTransfer.files,e=0;e<d.length;e++){var f=d[e];if(f.type=="image/jpeg"||f.type=="image/png"||f.type=="image/gif"||f.type=="image/svg+xml"||f.type=="audio/mp3"||f.type=="audio/mpeg"||f.type=="audio/vnd.wav"||f.type=="audio/wav"){var g=new FileReader;g.onload=function(b){IDE.showProgress(g_loc.getText("wincontent.progressimporting"));$.ajax({url:WinMediaLib.mediasave,
type:"POST",data:"d="+encodeURIComponent(b.target.result),success:function(b){b=JSON.parse(b);IDE.showProgress(null);WinMediaLib._fetchFiles("MyStuff",null,true);c&&c(b.id,b.contentType)},error:function(){IDE.showProgress(null)}})};g.onerror=function(){IDE.showProgress(null)};g.readAsDataURL(f)}}};WinMediaLib.scrollIntoView=function(b){$("#win-medialib .tabpanel ul.content").scrollTop($("#win-medialib .tabpanel ul.content").scrollTop()+b.position().top)};
WinMediaLib.setSimplified=function(b){WinMediaLib.simplifiedResources=b};WinMediaLib.getAssetInSimplified=function(b,c){var d=null;$("#win-medialib .tabpanel ul.content li img.main").each(function(){if($(this).attr("path")==b&&(!c||c==$(this).attr("resname"))){d=$(this).parent().parent();return false}});return d};
WinMediaLib.switchSimplified=function(b){if(WinMediaLib.simplifiedResources){$("#win-medialib .tabpanel").removeClass("hidden");$("#win-medialib").removeClass("hastabs");$("#win-medialib .tabpanel").removeClass("hastree");$("#win-medialib-search").addClass("hidden");var c=WinMediaLib.simplifiedResources,d=$("#win-medialib .tabpanel ul.content");d.empty();$.each(c,function(e,f){if(f.sound){if(!b||b.sounds){var g=f.name;if(!g||g.indexOf(".")<0)g="Sound."+ext;var h=f.sound,j=false;$("#win-medialib .cart li img").each(function(){if($(this).attr("path")==
h){j=true;return false}});var g=f.name,k=g.lastIndexOf(".");k>0&&(g=g.substring(0,k));var l=$('<li class="audio'+(j?" selected":"")+'"><div class="middle"><img class="main" path="'+h+'" src="'+f.img+'" alt="'+f.name+'" title="'+f.name+'"/></div><em>'+g+"</em></li>");d.append(l);l.click(WinMediaLib._fileClicked)}}else if(f.actor){if(!b||b.tblocks){g=f.name;k=g.lastIndexOf(".");k>0&&(g=g.substring(0,k));h=f.actor;l=$('<li class="image'+(j?" selected":"")+'"><div class="check">&#xe087;</div><div class="middle"><img class="main" path="/assets/code/'+
h+'.actor" src="'+f.img+'" alt="'+f.name+'" title="'+f.name+'"/></div><img class="indicator" src="ide/imgs/tblock_tab.png"/><em>'+g+"</em></li>");d.append(l);l.click(WinMediaLib._fileClicked)}}else if(f.img&&(!b||b.images)){g=f.name;k=g.lastIndexOf(".");k>0&&(g=g.substring(0,k));h=f.img;if(h.indexOf("avatar://")<0)l=$('<li class="image'+(j?" selected":"")+'"><div class="check">&#xe087;</div><div class="middle"><img class="main" path="'+h+'" src="'+f.img+'" alt="'+f.name+'" title="'+f.name+'"/></div><em>'+
g+"</em></li>");else{k="";if(f.skelType){k=f.name;l=$('<li class="image'+(j?" selected":"")+'"><div class="check">&#xe087;</div><div class="middle"><img class="main" path="'+h+'" resname="'+k+'" src="ide/imgs/blank.png" alt="'+f.name+'" title="'+f.name+'"/></div><em>'+g+"</em></li>");WinSpine.generatePreview(f.skelType,f.skelParts,function(b){l.find("img").attr("src",b)})}else l=$('<li class="image'+(j?" selected":"")+'"><div class="check">&#xe087;</div><div class="middle"><img class="main" path="'+
h+'" src="/imgs/logo.png" alt="'+c[e].name+'" title="'+c[e].name+'"/></div><em>'+g+"</em></li>")}d.append(l);l.click(WinMediaLib._fileClicked)}})}else{$("#win-medialib").addClass("hastabs");$("#win-medialib .tabpanel").addClass("hastree")}};WinMediaLib._fetchSubCategories=function(b,c,d){if(c==void 0||!c)c="";$.ajax({url:WinMediaLib.mediasubcategories,data:{id:b,p:c},success:function(b){WinMediaLib._receivedSubCategory(b);d&&d()}})};
WinMediaLib._fetchFiles=function(b,c,d){$.ajax({url:WinMediaLib.mediafiles,data:{p:b,ih:WinMediaLib._ignoreHidden,t:WinMediaLib.fetchTypes},success:function(e){b.substr(0,6);if(b!=WinMediaLib.currentPath||d){WinMediaLib.currentPath=b;WinMediaLib._receivedFiles(e)}c&&c(b)}})};WinMediaLib._fetchSetsFiles=function(b,c){$.ajax({url:WinMediaLib.mediasetsfiles,data:{p:b,t:WinMediaLib.fetchTypes},success:function(d){WinMediaLib.currentPath=b;WinMediaLib._receivedSetsFiles(d);c&&c(b)}})};
WinMediaLib._receivedFiles=function(b){if(b=JSON.parse(b)){for(var c=$("#win-medialib .tabpanel.media"),c=c.find("ul.content").empty().scrollTop(0),d=0;d<b.length;d++){var e,f=b[d].path,g=f.lastIndexOf(".");e=g>0&&g+1<f.length?f.substring(g+1):"";var h=false;$("#win-medialib .cart li img").each(function(){if($(this).attr("path")==f){h=true;return false}});if((!WinMediaLib._filters||WinMediaLib._filters.sounds)&&(e=="mp3"||e=="wav")){var j=b[d].name;if(!j||j.indexOf(".")<0)j="Sound."+e;e=$('<li class="border audio'+
(h?" selected":"")+'"><div class="middle"><img class="main" path="'+f+'" src="'+b[d].img+'" alt="'+b[d].name+'" title="'+b[d].name+'"/></div><div class="info"><em>'+b[d].name+'</em><span><a class="play" href="#">Play</a></span></div><div class="check">&#xe087;</div></li>');if(b[d].path.indexOf("/assets/user/")==0){e.append('<a class="delete" href="#">&#xe086;</a>');e.find("a.delete").click(WinMediaLib._deleteMedia)}c.append(e);e.click(WinMediaLib._fileClicked);e.find("a.play").click(function(){soundManager.stopAll();
if($(this).text()=="Play"){$(this).text("Stop");var b=$(this).parents("li"),c=b.data("sound");if(!c){c=soundManager.createSound({id:"s"+Math.random(),url:b.find("img.main").attr("path")});$(this).parent().data("sound",c)}c.play({onfinish:function(){b.find("a.play").text("Play")}})}else $(this).text("Play");return false})}else if((!WinMediaLib._filters||!WinMediaLib._filters.sounds)&&!(e=="mp3"||e=="wav")){j=b[d].name;g=j.lastIndexOf(".");g>0&&(j=j.substring(0,g));g=$("<li"+(h?' class="selected"':
"")+'><div class="middle"><img class="main" path="'+b[d].path+'" origSrc="'+b[d].img+'" src="ide/imgs/blank.png" alt="'+b[d].name+'" title="'+b[d].name+'"/></div><div class="check">&#xe087;</div><em>'+j+"</em></li>");if(b[d].path.indexOf("/assets/user/")==0){g.append('<a class="delete" href="#">&#xe086;</a>');g.find("a.delete").click(WinMediaLib._deleteMedia);e=="actor"&&g.append('<img class="indicator" src="ide/imgs/tblock_tab.png"/>');g.click(WinMediaLib._fileClicked);c.append(g)}else if(b[d].path.indexOf("/assets/code/")==
0){if(!WinMediaLib.filters||WinMediaLib._filters.code){g.append('<img class="indicator" src="ide/imgs/tblock_tab.png"/>');g.addClass("border");e=$('<div class="info"><em>'+b[d].name+'</em><span><a class="details" href="#">Details</a> | <a class="add" href="#">Add</a></span></div>');e.find("a.details").click(WinMediaLib._previewActor);g.click(WinMediaLib._fileClicked);g.find("a.add").click(WinMediaLib._fileClicked);g.append(e);c.append(g)}}else if(!WinMediaLib.filters||WinMediaLib._filters.images){g.click(WinMediaLib._fileClicked);
c.append(g)}}}WinMediaLib._loadIntoView()}};WinMediaLib._loadIntoView=function(){var b=$("#win-medialib ul.content"),c=b.outerHeight();b.find("li").each(function(b,e){var f=$(e),g=f.find("img.main");if(f.position().top<c)(f=g.attr("origSrc"))&&f!=g.attr("src")&&g.attr("src",f)})};WinMediaLib._previewActor=function(){var b=$(this).parents("li").find("img.main").attr("path"),b=b.substring(b.length-6-24,b.length-6);WinPreview.show(b);return false};WinMediaLib._mouseenterPlay=function(){$(this).find("a").removeClass("hidden")};
WinMediaLib._mouseleavePlay=function(){$(this).find("a").addClass("hidden")};WinMediaLib._deleteMedia=function(){var b=$(this).parent().find("img").attr("path"),b=b.substring(b.lastIndexOf("/")+1,b.indexOf("."));IDE.confirmDialog(g_loc.getText("wincontent.confirmdelete"),function(){$.ajax({url:WinMediaLib.mediadelete,type:"POST",data:"i="+encodeURIComponent(b),success:function(){WinMediaLib.currentPath="";WinMediaLib._fetchFiles("MyStuff",null,true)}})});return false};
WinMediaLib._addToCart=function(b,c,d,e,f){$("#win-medialib .cart ul").length==0&&$("#win-medialib .cart").empty().append("<ul></ul>");b=e=="group"?$('<li class="group"><img path="'+b+'" src="'+c+'" type="'+e+'" alt="'+d+'" title="'+d+'"/><a href="#">&#xe086;</a></li>'):$('<li><img path="'+b+'" src="'+c+'" type="'+e+'" alt="'+d+'" title="'+d+'"/><a href="#">&#xe086;</a></li>');b.find("img").after(f);$("#win-medialib .cart ul").append(b);f=$("#win-medialib .cart li").length;$("#win-medialib").parent().find(".ui-dialog-buttonset .ui-button-text:eq(0)").text(g_loc.formatText("dialog.btnaddcount",
f));b.find("a").click(function(){var b=$(this).parent().find("img").attr("path");WinMediaLib._removeFromCart(b);return false})};
WinMediaLib._removeFromCart=function(b){$("#win-medialib .tabpanel ul.content li").each(function(){if($(this).find("img").attr("path")==b){$(this).removeClass("selected");$(this).find("img.add").attr("src","ide/imgs/blackplus.png");$(this).find("a.preview img").attr("src","ide/imgs/preview-play.png");$(this).find(".inspector img").attr("src","ide/imgs/blackinspector.png");return false}});$("#win-medialib .cart li img").each(function(){if($(this).attr("path")==b){$(this).parent().detach();return false}});
if($("#win-medialib .cart li").length==0){$("#win-medialib .cart").empty().append(g_loc.getText("wincontent.emptycart"));$("#win-medialib").parent().find(".ui-dialog-buttonset .ui-button-text:eq(0)").removeClass("button1");$("#win-medialib").parent().find(".ui-dialog-buttonset button:eq(0)").css("border","1px solid lightGrey")}$("#win-medialib").parent().find(".ui-dialog-buttonset .ui-button-text:eq(0)").text(g_loc.formatText("dialog.btnaddcount",$("#tools-media .cart li").length))};
WinMediaLib._fileClicked=function(){WinMediaLib._addRemoveItem($(this));return false};
WinMediaLib._addRemoveItem=function(b){b[0].tagName!="LI"&&(b=b.parents("li"));var c=b.find("img.main").attr("path"),d=b.find("img.main").attr("src");if(b.hasClass("selected")){b.removeClass("selected");b.find("img.add").attr("src","ide/imgs/blackplus.png");b.find(".inspector img").attr("src","ide/imgs/blackinspector.png");WinMediaLib._removeFromCart(c);WinMediaLib._selectionCallback&&WinMediaLib._selectionCallback(c,false)}else{b.addClass("selected");b.find("img.add").attr("src","ide/imgs/blackcheck.png");
b.find("a.preview img").attr("src","ide/imgs/blackcheck.png");b.find(".inspector img").attr("src","ide/imgs/blackcheck.png");var e=b.find("img.main").attr("title"),f="single";b.hasClass("group")&&(f="group");b=b.find("img.set").clone();WinMediaLib._addToCart(c,d,e,f,b);WinMediaLib._selectionCallback&&WinMediaLib._selectionCallback(c,true)}return false};
WinMediaLib._addResources=function(){if(WinMediaLib._callback){var b=[];$("#win-medialib .cart li").each(function(){var c=$(this).find("img").not(".set");c.attr("type");if(c.attr("type")=="group")$(this).find("img.set").each(function(){var c=$(this).attr("path"),d=$(this).attr("name");d.indexOf(".")>0&&(d=d.substring(0,d.indexOf(".")));b.push({url:c,name:d})});else{var d=c.attr("path"),c=c.attr("title");c.indexOf(".")>0&&(c=c.substring(0,c.indexOf(".")));b.push({url:d,name:c})}});WinMediaLib._callback(b)}};
WinMediaLib._receivedSubCategory=function(b){if(b=JSON.parse(b)){$("#win-medialib .tabpanel").addClass("hidden").addClass("hastree");var c=$("#win-medialib .tabpanel.media").removeClass("hidden").find(".treenav ul");c.empty();c.append("<li><h1>"+$("#win-medialib .tab.selected span").text()+"</h1></li>");for(var d=false,e=true,f=0;f<b.length;f++){var g=b[f];if(!(WinMediaLib.fetchTypes.indexOf(".svg")<0&&g.name.toLowerCase().indexOf("svg")>=0)&&(WinMediaLib.showTynker||!(g.name.toLowerCase().indexOf("tynker")>=
0))){var h=g.count;if(!g.count)h=g.allcount;g.path.indexOf("Sounds")>=0&&(d=true);$el=$('<li><a href="#" name="'+g.name+'" path="'+g.path+'" count="'+g.count+'">'+toUCWord(g.name)+"<em>"+h+"</em></a></li>");$el.click(WinMediaLib._subCategoryClicked);c.append($el);if(g.subdir&&g.subdir.length>0){for(var h=$("<ul></ul>"),j=0;j<g.subdir.length;j++){var k=g.subdir[j],k=$('<li><a href="#" name="'+k.name+'" path="'+k.path+'">'+toUCWord(k.name)+"</a></li>");k.click(WinMediaLib._subCategoryClicked);h.append(k)}$el.append(h)}if(e){e=
false;$el.addClass("selected")}}}if(d){$el=$('<li><a href="#" name="My Sounds" path="MyStuff" count="1">My Sounds</a></li>');$el.click(WinMediaLib._subCategoryClicked);c.append($el)}WinMediaLib.currentPath="";b[0].path.substring(b[0].path.indexOf("/")+1).replace(/\//g," > ");b[0].count>0?WinMediaLib._fetchFiles(b[0].path):WinMediaLib._fetchSetsFiles(b[0].path)}};
WinMediaLib._receivedSetsFiles=function(b){var b=JSON.parse(b),c=$("#win-medialib .tabpanel.media");c.scrollTop(0);for(var c=c.find("ul.content").empty(),d=0;d<b.length;d++){var e=b[d];if(e.count){var f=e.group,g="";if(f)for(var h=0;h<f.length;h++)g=g+('<img class="hidden set" name="'+f[h].name+'" path="'+f[h].path+'" />');var j=false;$("#win-medialib .cart li img").each(function(){if($(this).attr("path")==e.path){j=true;return false}});$el=$('<li class="border group'+(j?" selected":"")+'"><div class="count">'+
e.count+'</div><div class="middle"> <img class="main" name="'+e.name+'" path="'+e.path+'" count="'+e.count+'" src="'+e.img+'" alt="'+e.name+'" title="'+e.name+'" />'+g+'</div><div class="info"> <em>'+e.name+'</em><span><a class="details" href="#">Details</a>'+(e.path.indexOf("Sounds")>=0?"":' | <a class="add" href="#">Add</a>')+'</span></div></div><div class="check">&#xe087;</div></li>');$el.find("a.details").click(WinMediaLib._groupClicked);if(e.path.indexOf("Sounds")>=0)$el.click(WinMediaLib._groupClicked);
else{$el.click(WinMediaLib._fileClicked);$el.find("a.add").click(WinMediaLib._fileClicked)}c.append($el)}}};
WinMediaLib._topCategoryClicked=function(){$(this).find("span").text();var b=$(this).attr("path");$(this).attr("id");$("#win-medialib-search input").val(g_loc.getText("wincontent.search")).css("color","#aaa");$("#win-medialib .tabs .tab").removeClass("selected");$("#win-medialib .tabpanel").removeClass("haspath");$(this).addClass("selected");if(b=="TynkerBlocks"||b=="MyStuff"){$("#win-medialib .tabpanel").removeClass("hastree");WinMediaLib._fetchFiles(b)}else{$("#win-medialib .tabpanel").addClass("hastree");
WinMediaLib._fetchSubCategories("",b)}return false};
WinMediaLib._subCategoryClicked=function(){var b=$(this).find("a").attr("path"),c=$(this).find("a").attr("count"),d=$(this);if(d.hasClass("child")){$("#win-medialib .tabpanel.media .treenav li.selected").find("ul").find("li.selected").removeClass("selected");$("#win-medialib .tabpanel.media .treenav li.selected").addClass("skip")}else{$selected=$("#win-medialib .tabpanel.media .treenav li.selected");if($selected.hasClass("skip")){$selected.removeClass("skip");return}$selected.removeClass("selected")}d.addClass("selected");
d=b.substring(b.indexOf("/")+1).replace(/\//g," > ");$("#win-medialib-sublevel-content-path").html("<h3>"+d+"</h3>");c>0?WinMediaLib._fetchFiles(b):WinMediaLib._fetchSetsFiles(b);return false};
WinMediaLib._groupClicked=function(){var b=$(this);b.find("img.main").length==0&&(b=b.parents("li"));var c=b.find("img.main").attr("path"),b=b.find("img.main").attr("count");$("#win-medialib .tabpanel").removeClass("hastree");var d=WinMediaLib.currentPath,e=d.substring(d.indexOf("/")+1).replace(/\//g," &gt; "),f=c.substring(d.length+1);$("#win-medialib .tabpanel").addClass("haspath").find(".path").html('<span></span> <a href="#">'+e+"</a> &gt; "+f).unbind().click(function(){$("#win-medialib .tabpanel").addClass("hastree");
$("#win-medialib .tabpanel").removeClass("haspath");WinMediaLib._fetchSetsFiles(d);return false});b>0?WinMediaLib._fetchFiles(c):WinMediaLib._fetchSetsFiles(c);return false};
if("undefined"==typeof window.WinMediaAssets)var WinMediaAssets={medialibtree:"api/medialibtree.aspx",medialibtheme:"api/medialibtheme.aspx",medialibsearch:"api/medialibsearch.aspx",medialibmy:"api/medialibmy.aspx",medialibsave:"api/medialibsave.aspx",medialibdelete:"api/medialibdelete.aspx",medialibtynkerblocks:"api/medialibtynkerblocks.aspx",sound:null,displayOrder:"characters creatures props images backgrounds scenes music tracks sounds ".split(" "),_ignoreHidden:!1,showSearch:!0};
WinMediaAssets.init=function(){var b=$("#win-media-assets");b.find(".import-image").change(WinMediaAssets._importImage);b.find(".cmd-draw").click(function(){WinMediaAssets.selectMyStuff("drawing");$(this).addClass("selected").siblings().removeClass("selected")});b.find(".cmd-upload").click(function(){WinMediaAssets.selectMyStuff("upload");$(this).addClass("selected").siblings().removeClass("selected")});b.find(".cmd-uploadsound").click(function(){WinMediaAssets.selectMyStuff("upload");$(this).addClass("selected").siblings().removeClass("selected")});
b.find(".cmd-camera").click(function(){WinMediaAssets.selectMyStuff("photo");$(this).addClass("selected").siblings().removeClass("selected")});b.find(".cmd-record").click(function(){WinMediaAssets.selectMyStuff("audio");$(this).addClass("selected").siblings().removeClass("selected")});b.find(".cmd-legacymedia").click(function(){$.modal.close();WinMediaAssets._showBackgrounds||WinMediaAssets._showImages?WinMediaLib.showPicker("","",WinMediaAssets._callback,{sounds:false}):WinMediaAssets._showSounds&&
WinMediaLib.showPicker("","Sounds",WinMediaAssets._callback,{sounds:WinMediaAssets._showSounds})});b.find(".search input").focus(function(){$(this).val("")}).blur(function(){WinMediaAssets.searchAssets($(this).val())}).click(function(){$(this).focus()}).keyup(function(b){b.keyCode==13&&$(this).blur()});!window.WinPaint&&!window.WinSVGPaint&&$("#win-media-assets .cmd-draw").detach();window.WinMediaCapture||$("#win-media-assets .cmd-camera").detach();window.WinMediaLib||$("#win-media-assets .cmd-legacymedia").detach()};
WinMediaAssets.adjustWindow=function(){};WinMediaAssets.setSelectionCallback=function(b){WinMediaAssets._selectionCallback=b};WinMediaAssets.hide=function(){$.modal.close()};WinMediaAssets.getAssetInSimplified=function(b,c){var d=null;$("#win-media-assets .tab-content-inner li").each(function(){if($(this).attr("path")==b&&(!c||c==$(this).attr("resname"))){d=$(this).parent().parent();return false}});return d};
WinMediaAssets.scrollIntoView=function(b){$("#win-media-assets .tab-content-inner").scrollTop($("#win-media-assets .tab-content-inner").scrollTop()+b.position().top)};
WinMediaAssets.showSimplePicker=function(b,c,d){WinMediaAssets._callback=c;WinMediaAssets._callbackObj=null;WinMediaAssets._showBackgrounds=false;WinMediaAssets._showImages=false;WinMediaAssets._showSounds=false;b=$("#win-media-assets");b.modal();b.find(".search input").val("");b.find(".theme-selector .theme").empty();b.find(".theme-selector .theme a").removeClass("selected");b=b.find(".tab-content .tab-content-inner");b.empty();var e=$("<ul></ul>");b.append(e);$(d).each(function(b,c){var d,j=c.name,
k=j.indexOf(".");k>0&&(j=j.substring(0,k));if(c.skelParts){var k=c.skelType,l=c.skelParts;d=$('<li data-name="'+j+'" data-type="skel" data-path="avatar://spine"><img src="ide/imgs/blank.png"/><span></span></li>');d.data("skelType",k);d.data("skelParts",l);WinSpine.generatePreview(k,l,function(b){d.find("img").attr("src",b)})}else d=c.sound?$('<li class="sound-asset" data-name="'+j+'" data-type="sound" data-path="'+c.sound+'"><div class="icon-volume-high"></div><span class="asset-name"></span></li>'):
c.actor?$('<li data-name="'+j+'" data-type="actor" data-path="/assets/code/'+c.actor+'.actor"><img src="'+c.img+'"/><span></span></li>'):$('<li data-name="'+j+'" data-type="img" data-path="'+c.img+'"><img src="'+c.img+'"/><span></span></li>');d.find("span.asset-name").text(j);d.click(WinMediaAssets._pickSimpleAsset);e.append(d)})};WinMediaAssets.reset=function(){WinMediaAssets._showBackgrounds=false;WinMediaAssets._showImages=false;WinMediaAssets._showSounds=false};
WinMediaAssets.showPicker=function(b,c,d,e,f){b=$("#win-media-assets");b.modal();WinMediaAssets._callback=c;WinMediaAssets._callbackObj=e;var c=!d||d.backgrounds,e=!d||d.images,g=!d||d.sounds,d=e&&(!d||d.actors);if(WinMediaAssets._showBackgrounds==c&&WinMediaAssets._showImages==e&&WinMediaAssets._showSounds==g)f&&f();else{WinMediaAssets._showBackgrounds=c;WinMediaAssets._showImages=e;WinMediaAssets._showSounds=g;WinMediaAssets._showActors=d;if(WinMediaAssets._showSounds)if(MediaCapture.supportsCapture){b.find(".cmd-uploadsound").removeClass("hidden");
b.find(".cmd-record").removeClass("hidden")}else{b.find(".cmd-uploadsound").addClass("hidden");b.find(".cmd-record").addClass("hidden")}else{b.find(".cmd-uploadsound").addClass("hidden");b.find(".cmd-record").addClass("hidden")}if(WinMediaAssets._showBackgrounds||WinMediaAssets.showImages){b.find(".cmd-draw").removeClass("hidden");b.find(".cmd-upload").removeClass("hidden");b.find(".cmd-uploadsound").addClass("hidden");MediaCapture.supportsCapture?b.find(".cmd-camera").removeClass("hidden"):b.find(".cmd-camera").addClass("hidden")}else{b.find(".cmd-draw").addClass("hidden");
b.find(".cmd-upload").addClass("hidden");b.find(".cmd-camera").addClass("hidden");b.find(".cmd-camera").addClass("hidden")}var h=$("<ul></ul>");b.find(".search input").val("");b.find(".theme-selector .theme").empty().append(h);$.ajax({url:WinMediaAssets.medialibtree,success:function(b){for(var c="",d=0;d<b.length;d++){var e=b[d];if(e.dir=="themes")for(var g=0;g<e.entries.length;g++){var q=$('<li class="tab" data-theme="'+e.entries[g].dir+'" data-path="'+e.entries[g].path+'">'+e.entries[g].dir+"</li>");
q.click(WinMediaAssets._themeClicked);h.append(q);if(!c)c=e.entries[g].path}}if(WinMediaAssets._showBackgrounds||WinMediaAssets._showImages)for(d=0;d<b.length;d++){e=b[d];if(e.dir=="images")for(g=0;g<e.entries.length;g++){var p=e.entries[g],q=$('<li class="tab subitems" data-theme="'+p.dir+'" data-path="'+p.path+'">'+p.dir+'<ul class="hidden"></ul></li>');q.click(WinMediaAssets._categoryClicked);h.append(q);if(p.entries)for(var q=q.find("ul"),s=0;s<p.entries.length;s++){var r=$('<li class="sub-tab" data-theme="'+
p.entries[s].dir+'" data-path="'+p.entries[s].path+'">'+p.entries[s].dir+"</a></li>");r.click(WinMediaAssets._themeClicked);q.append(r)}}}if(WinMediaAssets._showSounds)for(d=0;d<b.length;d++){e=b[d];if(e.dir=="sounds"||e.dir=="music")for(g=0;g<e.entries.length;g++){p=e.entries[g];q=$('<li class="tab subitems" data-theme="'+p.dir+'" data-path="'+p.path+'">'+p.dir+'<ul class="hidden"></ul></li>');q.click(WinMediaAssets._categoryClicked);h.append(q);if(p.entries){q=q.find("ul");for(s=0;s<p.entries.length;s++){r=
$('<li class="sub-tab" data-theme="'+p.entries[s].dir+'" data-path="'+p.entries[s].path+'">'+p.entries[s].dir+"</a></li>");r.click(WinMediaAssets._themeClicked);q.append(r)}}}}if(WinMediaAssets._showBackgrounds&&WinMediaAssets._showImages&&WinMediaAssets._showSounds&&WinMediaAssets._showActors){q=$('<li class="tab" data-theme="TynkerBlocks" data-path="tynkerblocks">TynkerBlocks</li>');q.click(WinMediaAssets._tynkerblocksClicked);h.append(q)}c?f?WinMediaAssets.showTheme(c,null,f):WinMediaAssets.showTheme(c):
f&&f()}})}};WinMediaAssets._themeClicked=function(){var b=$("#win-media-assets");b.find(".search input").val("");b.find(".tab-content").removeClass("mystuff");if($(this).hasClass("sub-tab")){$(this).parents("ul").find("li").removeClass("selected");$(this).addClass("selected");WinMediaAssets.showTheme($(this).attr("data-path"),$(this).parents("li.tab").attr("data-path"))}else{b.find(".theme-selector .theme li.tab ul").addClass("hidden");WinMediaAssets.showTheme($(this).attr("data-path"))}return false};
WinMediaAssets._tynkerblocksClicked=function(){var b=$("#win-media-assets");b.find(".search input").val("");b.find(".tab-content").removeClass("mystuff");WinMediaAssets.showTynkerblocks();return false};
WinMediaAssets._categoryClicked=function(){var b=$("#win-media-assets");b.find(".search input").val("");b.find(".theme-selector .theme li.tab ul").addClass("hidden");b=$(this).find("ul");b.removeClass("hidden");b.find("li").removeClass("selected");b=b.find("li:first");b.addClass("selected");WinMediaAssets.showTheme(b.attr("data-path"),$(this).attr("data-path"));return false};
WinMediaAssets.searchAssets=function(b){$("#win-media-assets .theme-selector .theme a.tab").removeClass("selected");$.ajax({url:WinMediaAssets.medialibsearch,data:{q:b},success:function(c){if(c.length>0)WinMediaAssets._showResults(c);else{c=$('<div class="no-search-results"></div>');c.text('Sorry, no matches were found for "'+b+'". Please try another search term.');$("#win-media-assets .tab-content-inner").empty().append(c)}},error:function(){var c=$('<div class="no-search-results"></div>');c.text('Sorry, no matches were found for "'+
b+'". Please try another search term.');$("#win-media-assets .tab-content-inner").empty().append(c)}})};WinMediaAssets.showTheme=function(b,c,d){$.ajax({url:WinMediaAssets.medialibtheme,data:{t:b},success:function(e){c&&(b=c);$("#win-media-assets .theme-selector .theme li.tab").each(function(c,d){$(d).attr("data-path")==b?$(d).addClass("selected"):$(d).removeClass("selected")});WinMediaAssets._showResults(e);d&&d()}})};
WinMediaAssets._showResults=function(b,c){var d=$("#win-media-assets .tab-content .tab-content-inner");d.scrollTop(0);d.empty();for(var e=0;e<WinMediaAssets.displayOrder.length;e++)for(var f=0;f<b.length;f++){var g=b[f];if(!(g.dir=="backgrounds"||g.dir=="scenes")||WinMediaAssets._showBackgrounds)if(g.dir&&!(g.dir=="sounds"||g.dir=="music")||WinMediaAssets._showSounds)if(!g.dir||!(g.dir!="sounds"&&g.dir!="music"&&g.dir!="backgrounds"&&g.dir!="scenes"&&!WinMediaAssets._showImages))if(WinMediaAssets.displayOrder[e]==
g.dir&&g.entries.length>0){f=$("<h3></h3>");f.text(g.dir.charAt(0).toUpperCase()+g.dir.substring(1));for(var h=$("<ul></ul>"),j=0;j<g.entries.length;j++){var k=null,l=g.entries[j];if(l.dir){if(l.entries.length>0){for(var k=null,m=0;m<l.entries.length;m++)if(l.entries[m].type=="actor"){k=l.entries[m];l.entries.splice(m,1);break}WinMediaAssets._showActors||(k=null);if(k){m=k.name;l=m.indexOf(".");l>0&&(m=m.substring(0,l));k=$('<li class="stack-asset" data-name="'+m+'" data-type="actor" data-id="'+k.id+
'" data-url="'+k.url+'"><img src="'+k.img+'"/><span class="asset-name"></span><span class="costume-count">Actor with code</span></li>')}else{m=l.dir;k=$('<li class="stack-asset" data-section="'+g.dir+'" data-name="'+m+'" data-type="dir"><img src="'+l.entries[0].url+'"/><span class="asset-name"></span><span class="costume-count">'+l.entries.length+" costumes </span></li>");k.data("entries",l.entries);k.mouseenter(WinMediaAssets._startAnimation).mouseleave(WinMediaAssets._stopAnimation)}}}else{var m=
l.name,n=m.indexOf(".");n>0&&(m=m.substring(0,n));if(l.type=="mp3"||l.type=="wav"){if(c){k=$('<li class="sound-asset" data-section="'+g.dir+'" data-name="'+m+'" data-type="'+l.type+'" data-id="'+l.id+'" data-url="/assets/user/'+l.id+"."+l.type+'" data-my="true"><div class="icon-volume-high"></div><span class="asset-name"></span><a href="#" class="cmd-play">Play</a><a href="#" class="cmd-delete"></a></li>');k.find("a.cmd-delete").click(WinMediaAssets._deleteClicked)}else k=$('<li class="sound-asset" data-section="'+
g.dir+'" data-name="'+m+'" data-type="'+l.type+'" data-id="'+l.id+'" data-url="'+l.url+'"><div class="icon-volume-high"></div><span class="asset-name"></span><a href="#" class="cmd-play">Play</a></li>');k.find("a.cmd-play").click(WinMediaAssets._playClicked)}else if(l.type=="actor")WinMediaAssets._showActors&&(k=$('<li class="stack-asset" data-name="'+m+'" data-type="actor" data-id="'+l.id+'" data-url="'+l.url+'"><img src="'+l.img+'"/><span class="asset-name"></span><span class="costume-count">Actor with code</span></li>'));
else{if(c){k=$('<li data-section="'+g.dir+'" data-name="'+m+'" data-type="'+l.type+'" data-id="'+l.id+'" data-url="/assets/user/'+l.id+"."+l.type+'" data-my="true"><img src="/assets/user/'+l.id+"."+l.type+'"/><span class="asset-name"></span><a href="#" class="cmd-delete"></a></li>');k.find("a.cmd-delete").click(WinMediaAssets._deleteClicked)}else k=$('<li data-section="'+g.dir+'" data-name="'+m+'" data-type="'+l.type+'" data-id="'+l.id+'" data-url="'+l.url+'"><img src="'+l.url+'"/><span class="asset-name"></span></li>');
(g.dir=="backgrounds"||g.dir=="scenes")&&k.addClass("scene-asset")}}if(k){k.find("span.asset-name").text(m);k.click(WinMediaAssets._pickAsset);h.append(k)}}if(h.find(">li").length>0){d.append(f);d.append(h)}break}else if(WinMediaAssets.displayOrder[e]==""&&!b[f].dir){h=d.find("ul.data-flat");if(h.length===0){h=$('<ul class="data-flat"></ul>');d.append(h)}l=b[f];m=l.name;n=m.indexOf(".");n>0&&(m=m.substring(0,n));if(l.type=="mp3"||l.type=="wav"){k=$('<li class="sound-asset" data-section="'+g.dir+'" data-name="'+
m+'" data-type="'+l.type+'" data-id="'+l.id+'" data-url="'+l.url+'"><div class="icon-volume-high"></div><span class="asset-name"></span><a href="#" class="cmd-play">Play</a></li>');k.find("a.cmd-play").click(WinMediaAssets._playClicked)}else if(l.type!="actor"||WinMediaAssets._showActors)k=$('<li data-section="'+g.dir+'" data-name="'+m+'" data-type="'+l.type+'" data-id="'+l.id+'" data-url="'+l.url+'"><img src="'+l.url+'"/><span class="asset-name"></span></li>');k.find("span.asset-name").text(m);k.click(WinMediaAssets._pickAsset);
h.append(k)}}if(c){if(!h){h=$("<ul></ul>");d.append(h)}d=$('<a class="asset-action" href="#"></a>');if(c=="upload"){d.text("Upload an Asset");d.click(WinMediaAssets._upload)}else if(c=="photo"){d.text("Take a Picture");d.click(WinMediaAssets._camera)}else if(c=="drawing"){e=$('<a class="asset-action" href="#">Vector Image</a>');e.click(WinMediaAssets._drawVector);h.prepend(e);d.text("Draw an Image");d.click(WinMediaAssets._draw)}else if(c=="audio"){d.text("Record Audio");d.click(WinMediaAssets._record);
e=$('<a class="asset-action" href="#"></a>');e.text("Upload a Sound File");e.click(WinMediaAssets._upload);h.prepend(e)}h.prepend(d)}};WinMediaAssets.showTynkerblocks=function(){$.ajax({url:WinMediaAssets.medialibtynkerblocks,success:function(b){$("#win-media-assets .theme-selector .theme li.tab").each(function(b,d){$(d).attr("data-path")=="tynkerblocks"?$(d).addClass("selected"):$(d).removeClass("selected")});WinMediaAssets._showTynkerblocksResults(b)}})};
WinMediaAssets._showTynkerblocksResults=function(b){var c=$("#win-media-assets .tab-content .tab-content-inner");c.scrollTop(0);c.empty();for(var d=0;d<b.length;d++){var e=b[d],f=$("<h3></h3>");f.text(e.dir.charAt(0).toUpperCase()+e.dir.substring(1));c.append(f);f=$("<ul></ul>");c.append(f);for(var g=0;g<e.entries.length;g++){var h,j=e.entries[g];h=$('<li class="stack-asset" data-name="'+j.name+'" data-type="actor" data-id="'+j.id+'" data-url="'+j.url+'"><img src="'+j.img+'"/><span class="asset-name"></span><span class="costume-count">Actor with code</span></li>');
h.find("span.asset-name").text(j.name);h.click(WinMediaAssets._pickAsset);f.append(h)}}};WinMediaAssets._playClicked=function(){soundManager.stopAll();if($(this).text()=="Play"){$(this).text("Stop");var b=$(this).parents("li");soundManager.createSound({id:"s"+Math.random(),url:b.attr("data-url")}).play({onfinish:function(){b.find("a.cmd-play").text("Play")}})}else $(this).text("Play");return false};
WinMediaAssets._deleteClicked=function(){var b=$(this).parents("li"),c=b.attr("data-id");$.ajax({url:WinMediaAssets.medialibdelete,data:{i:c},success:function(){b.detach()}});return false};WinMediaAssets._pickSimpleAsset=function(){var b=$(this);b.attr("data-type");WinMediaAssets._callback([{section:b.attr("data-section"),name:b.attr("data-name"),url:b.attr("data-path")}],null,null,WinMediaAssets._callbackObj);$.modal.close();return false};
WinMediaAssets._pickAsset=function(){var b=$(this),c=b.attr("data-type");if(c=="dir"){for(var c=b.data("entries"),d=[],e=0;e<c.length;e++){var f=c[e].name,g=f.indexOf(".");g>0&&(f=f.substring(0,g));b.attr("data-my");d.push({name:f,url:c[e].url})}WinMediaAssets._callback(d,null,null,WinMediaAssets._callbackObj)}else{c!="actor"&&b.attr("data-my");WinMediaAssets._callback([{section:b.attr("data-section"),name:b.attr("data-name"),url:b.attr("data-url")}],null,null,WinMediaAssets._callbackObj)}$.modal.close();
return false};WinMediaAssets._startAnimation=function(){var b=$(this),c=b.data("timer");c>0&&window.clearInterval(c);c=window.setInterval(function(){var c=b.data("entries"),e=b.data("index");e||(e=0);e=(e+1)%c.length;b.data("index",e);b.find("img").attr("src",c[e].url)},500);b.data("timer",c)};WinMediaAssets._stopAnimation=function(){var b=$(this),c=b.data("timer");c>0&&window.clearInterval(c);b.data("timer",-1)};WinMediaAssets.setSimplified=function(b){WinMediaAssets.simplifiedResources=b};
WinMediaAssets.getAssetInSimplified=function(b,c){var d=null;$("#win-media-assets .tab-content-inner li").each(function(){if($(this).attr("data-path")==b&&(!c||c==$(this).attr("data-name"))){d=$(this);return false}});return d};
WinMediaAssets._importImage=function(b){$.each(b.originalEvent.target.files,function(b,d){var e=getFilename(d.name);if(d.type.match("image.*")){var f=new FileReader;f.onload=function(b){$.ajax({url:WinMediaAssets.medialibsave,type:"POST",data:{t:"upload",d:b.target.result},success:function(b){b=JSON.parse(b);WinMediaAssets._callback&&WinMediaAssets._callback([{url:"/assets/user/"+b.id+".png",name:e}],null,null,WinMediaAssets._callbackObj)}})};f.readAsDataURL(d)}else if(d.type=="audio/mp3"||d.type==
"audio/mpeg"||d.type=="audio/vnd.wav"){var g=".mp3";d.type=="audio/vnd.wav"&&(g=".wav");f=new FileReader;f.onload=function(b){$.ajax({url:WinMediaAssets.medialibsave,type:"POST",data:{d:b.target.result},success:function(b){b=JSON.parse(b);WinMediaAssets._callback&&WinMediaAssets._callback([{url:"/assets/user/"+b.id+g,name:e}],null,null,WinMediaAssets._callbackObj)}})};f.readAsDataURL(d)}})};
WinMediaAssets.selectMyStuff=function(b){$("#win-media-assets .theme-selector .theme li").removeClass("selected");$("#win-media-assets .tab-content").addClass("mystuff");$.ajax({url:WinMediaAssets.medialibmy,success:function(c){for(var d=[{dir:"sounds",entries:[]},{dir:"images",entries:[]}],e=0;e<c.length;e++){var f=c[e];if(!f.tags)if(f.type=="png")f.tags="upload";else if(f.type=="jpg")f.tags="photo";else if(f.type=="svg")f.tags="drawing";else if(f.type=="mp3"||f.type=="wav")f.tags="audio";f.tags==
b&&(f.tags=="audio"?d[0].entries.push(f):d[1].entries.push(f))}WinMediaAssets._showResults(d,b);if(WinMediaAssets._showSounds&&d[0].entries.length<=0||!WinMediaAssets._showSounds&&d[1].entries.length<=0)b=="drawing"?WinMediaAssets._draw():b=="photo"?WinMediaAssets._camera():b=="audio"&&WinMediaAssets._record()},error:function(){b=="drawing"?WinMediaAssets._draw():b=="upload"?WinMediaAssets._showResults([],b):b=="photo"?WinMediaAssets._camera():b=="audio"&&WinMediaAssets._record()}})};
WinMediaAssets._draw=function(){WinPaint.edit(g_loc.getText("title.paint_create_actor"),null,null,null,function(b,c,d){WinMediaAssets._callback([{name:"Drawing",url:b,cx:c,cy:d}],null,null,WinMediaAssets._callbackObj)});$.modal.close();return false};WinMediaAssets._drawVector=function(){WinSVGPaint.edit(g_loc.getText("title.paint_create_actor"),null,null,null,function(b,c,d){WinMediaAssets._callback([{name:"Drawing",url:b,cx:c,cy:d}],null,null,WinMediaAssets._callbackObj)});$.modal.close();return false};
WinMediaAssets._upload=function(){$("#win-media-assets .import-image").click();$.modal.close();return false};WinMediaAssets._camera=function(){if(MediaCapture.supportsCapture){$.modal.close();WinMediaCapture.showPictureTaker(function(b){WinMediaAssets._callback&&WinMediaAssets._callback([{url:b,name:"Photo"}],null,null,WinMediaAssets._callbackObj)})}return false};
WinMediaAssets._record=function(){if(MediaCapture.supportsCapture){$.modal.close();WinMediaCapture.showAudioRecorder(function(b){IDE.editingActor?IDE.addResourceTo(b,"Recording",IDE.editingActor):IDE.addResourceTo(b,"Recording",Runtime.background)})}return false};if("undefined"==typeof window.WinMediaSidebar)var WinMediaSidebar={lastSelectedTile:1,tiles:"api/tiles.aspx"};
WinMediaSidebar.init=function(){var b=$("#win-media-sidebar");b.find(".global-toolbar");b.find("input[name=search]").focus(function(){$(this).val("")}).blur(function(){WinMediaSidebar.searchAssets($(this).val())}).click(function(){$(this).focus()}).keyup(function(b){b.keyCode==13&&$(this).blur()});b.find("a.search-clear").click(function(){$("#win-media-sidebar input[name=search]").val("");$("#win-media-sidebar .container").empty().append('<div class="tiles-wrapper"></div>');WinMediaSidebar.showPicker("",
WinMediaSidebar._callback,{},WinMediaSidebar._callbackObj);return false});b=b.find(".actionbar");b.find(".background").click(function(){Runtime.stage.tileLayer.scrollBgOffset=true;IDE.dirty();Runtime.stage.setStageExpand(false);Runtime.stage.tileLayer.enableTiles(true);Runtime.stage.draw();WinMediaAssets.showPicker("Add a Background",function(b){for(var d=0;d<b.length;d++){var e=b[d],f=getFileExt(e.url);if(f==".mp3"||f==".wav")IDE.addResourceTo(e.url,e.name,Runtime.background);else{Runtime.background.costumes.pop();
var g=Runtime.background.addCostume({img:e.url,name:e.name},function(){Runtime.background.currentCostume=-1;Runtime.background.setCostumeByName(g.name);IDE.Clipboard.undoAddCostume(Runtime.background,g)});break}}},{backgrounds:true,images:false,sounds:false,charStudio:false},null,function(){WinMediaAssets.showTheme("themes/Game Elements")});return false});b.find(".media").click(function(){WinMediaAssets.showPicker("Add an Actor",WinAssets._addAssetAsActor,{backgrounds:false,actors:true,images:true,
sounds:true,charStudio:true});return false});b.find(".draw").click(function(){WinMediaAssets.showPicker("Add an Actor",WinAssets._addAssetAsActor,{backgrounds:true,actors:true,images:true,sounds:false,charStudio:true},null,function(){WinMediaAssets.selectMyStuff("drawing")});return false});b.find(".import").click(function(){WinMediaAssets.showPicker("Add an Actor",WinAssets._addAssetAsActor,{backgrounds:true,actors:true,images:true,sounds:true,charStudio:true},null,function(){WinMediaAssets.selectMyStuff("upload")});
return false});b.find(".photo").click(function(){WinMediaAssets.showPicker("Add an Actor",WinAssets._addAssetAsActor,{backgrounds:true,actors:true,images:true,sounds:false,charStudio:true},null,function(){WinMediaAssets.selectMyStuff("photo")});return false});b.find(".voice").click(function(){WinMediaAssets.showPicker("Add an Actor",WinAssets._addAssetAsActor,{backgrounds:false,actors:false,images:false,sounds:true,charStudio:true},null,function(){WinMediaAssets.selectMyStuff("audio")});return false});
b.find(".character").click(function(){WinMediaAssets.reset();$.modal.close();window.WinSpine&&WinSpine.showCreator(function(b,d){Sprites.addSprite({cx:500,cy:500,scale:b=="Tiny"?1:0.25,label:"actor",costumeName:"actor",img:"avatar://spine",forceNumber:false,skeletonType:b,skeletonParts:d},function(b){b.spriteObj.setPosition(Runtime.stage.getWidth()/2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/2-Runtime.stage.tileLayer.getScrollOffsetY());IDE.selectAsset(b);IDE.Clipboard.undoAddActor(b)})});
return false});$("#win-media-sidebar .global-toolbar .select-tool").click(WinMediaSidebar.handleSelectMode);$("#win-media-sidebar .global-toolbar .tile-tool").click(WinMediaSidebar.handleTileMode);$("#win-media-sidebar .global-toolbar .remove-tool").click(WinMediaSidebar.handleDeleteMode);$("#stage-canvas").dblclick(function(){if($("#stagecmd-edit").hasClass("selected")){var b=IDE.editingActor;b&&(!b.lockedInSandbox&&b.skeleton.skeleton)&&WinSpine.showCreator(function(d,e){b.loadSkeleton(d,e)},b.skeleton.type,
b.skeleton.parts)}});$("#stagecmd-run").click(function(){WinMediaSidebar.handleSelectMode()});$("#win-levels .leveltoggle").click(function(){if($("#win-levels").hasClass("collapsed")){$("#win-levels").removeClass("collapsed");$("#win-media-sidebar").removeClass("collapsed")}else{$("#win-levels").addClass("collapsed");$("#win-media-sidebar").addClass("collapsed")}IDE.adjustPanels();return false})};WinMediaSidebar.adjustWindow=function(){};
WinMediaSidebar.hide=function(){$("#win-media-sidebar").addClass("hidden");IDE.adjustPanels()};WinMediaSidebar.scrollIntoView=function(b){$("#win-media-sidebar .tab-content-inner").scrollTop($("#win-media-sidebar .tab-content-inner").scrollTop()+b.position().top)};WinMediaSidebar.reset=function(){WinMediaSidebar._showBackgrounds=false;WinMediaSidebar._showImages=false;WinMediaSidebar._showSounds=false};
WinMediaSidebar.enableLevels=function(b){b?$("#win-levels").removeClass("hidden"):$("#win-levels").addClass("hidden");IDE.adjustPanels()};
WinMediaSidebar.showLevels=function(){var b=$("#win-levels").find("ul");b.empty();var c=$('<li class="add"><span class="icon-plus-2"></span><span>New Level</span></li>');b.prepend(c);c.click(function(){IDE.showProgress(g_loc.getText("dialog.projectloading"));$("#win-levels li.selected").find("span").text();var c=Runtime.stage.captureScreenshot();IDE._doProjectSave(null,null,c,false,true,Runtime.currentLevelIndex,null,function(){$("#win-levels li").removeClass("selected");var c=$('<li><img src=""/><span></span><input type="text" class="hidden"/><a href="#" class="remove icon-cancel-2"></a></li>');
c.insertBefore(b.find("li.add"));c.find("img").attr("src","ide/imgs/blank.png");c.find("span").text("Level "+(Runtime.levels.length+1));Runtime.levels.push({name:"Level "+(Runtime.levels.length+1),screenshotid:""});Runtime.currentLevelIndex=Runtime.levels.length-1;c.addClass("selected");WinMediaSidebar._addHandlers(c);ObjectIO.deserialize({projectName:IDE.currentProjectName,levels:Runtime.levels,currentLevel:Runtime.currentLevelIndex,name:"Level "+Runtime.levels.length,background:{scaleType:"stretch",
width:1364,height:768,canvasWidth:380,canvasHeight:213,canvasExpand:true,currentBackground:0,scripts:[{func:"registerFlagTrigger",values:[],next:{func:"blockPhysicsStart",values:[]},x:20,y:20}],backgrounds:[],sounds:[],documentation:{description:"",inboundEvents:[],outboundEvents:[],properties:[]}},sprites:[],variables:{},cloudVariables:{},varDefaults:{},lists:{},cloudLists:{},physics:{enabled:false,gravity:{x:0,y:10}},watchers:[],scrollBgOffset:false,tilesEnabled:true});IDE.dirty();IDE.selectAsset(null);
IDE.showProgress(null)})});for(var d=false,e=0;e<Runtime.levels.length;e++){c=$('<li><img src=""/><span></span><input type="text" class="hidden"/><a href="#" class="remove icon-cancel-2"></a></li>');c.insertBefore(b.find("li.add"));Runtime.levels[e].screenshotid?c.find("img").attr("src","/assets/screenshot/"+Runtime.levels[e].screenshotid+".png"):c.find("img").attr("src","ide/imgs/blank.png");c.find("span").text(Runtime.levels[e].name);if(e==Runtime.currentLevelIndex){c.addClass("selected");d=true}WinMediaSidebar._addHandlers(c)}d||
$("#win-levels ul li:first").addClass("selected")};
WinMediaSidebar._addHandlers=function(b){b.click(function(){if(!$(this).hasClass("selected")){$("#win-levels li").removeClass("selected");$(this).addClass("selected");IDE.showProgress(g_loc.getText("dialog.projectloading"));var b=$(this).index(),d=Runtime.stage.captureScreenshot();IDE._doProjectSave(null,null,d,false,true,Runtime.currentLevelIndex,null,function(){Runtime.loadLevel(b,null,function(){IDE.showProgress(null)})})}return false});b.find("span").click(function(){$(this).addClass("hidden");$(this).parents("li").find("input").removeClass("hidden").val($(this).text()).focus();
return false});b.find("input").blur(function(){$(this).addClass("hidden");var b=$(this).parents("li"),d=$(this).val();Runtime.currentLevelName=d;Runtime.levels[b.index()].name=d;var e=b.index();if(e>=0){WinMediaSidebar._renameLevel(e,d);b.find("span").removeClass("hidden").text(d)}}).keypress(function(b){b.which==13&&$(this)[0].blur()});b.find("a").click(function(){if($("#win-levels li").length>2){var b=$(this).parents("li"),d=b.index();d>=0&&IDE.confirmDialog(g_loc.formatText("winassets.confirmdelete",
b.find("span").text()),function(){WinMediaSidebar._removeLevel(d);Runtime.loadLevel(0);$("#win-levels li").removeClass("selected");$("#win-levels li:first").addClass("selected");b.detach();return false},g_loc.getText("dialog.btnyes"),g_loc.getText("dialog.btnno"))}else IDE.alertDialog("Cannot remove level.  You need at least one level in a project.");return false})};WinMediaSidebar._renameLevel=function(b,c){$.ajax({url:"api/levelrename.aspx",data:{id:IDE.currentProjectId,s:b,n:c}})};
WinMediaSidebar._removeLevel=function(b){$.ajax({url:"api/leveldelete.aspx",data:{id:IDE.currentProjectId,s:b}})};WinMediaSidebar._findActor=function(b){var c="";$("#win-media-sidebar ul.actors li.actor").each(function(d,e){var f=$(e);if(f.attr("data-id")==b){c=f.find("span").text();c=JSON.parse(c);if(f.hasClass("hidden"))c.hideInUI=true;return false}});return c};
WinMediaSidebar.showPicker=function(b,c,d,e){WinMediaSidebar._callback=c;WinMediaSidebar._callbackObj=e;var f=$("#win-media-sidebar");WinMediaSidebar.lastSelectedTile=1;$("#win-media-sidebar .global-toolbar li").removeClass("selected");$("#win-media-sidebar .global-toolbar li:first").addClass("selected");$("#win-media-sidebar .tiles li").removeClass("selected");f.find(".tiles-wrapper").length<=0&&$.ajax({url:WinMediaSidebar.tiles,dataType:"json",success:function(b){f.find(".actionbar .tiletype").empty();
$(b).each(function(b,c){var d=$('<div class="tiles-wrapper"></div>');f.find(".container").append(d);b>0&&d.addClass("hidden");var e=$('<a href="#" class="btn-round small"></a>');e.text(c.label);e.click(function(){f.find(".actionbar .tiletype a").removeClass("active");$(this).addClass("active");f.find(".container .tiles-wrapper").addClass("hidden");d.removeClass("hidden");return false});f.find(".actionbar .tiletype").append(e);b==0&&e.addClass("active");if(c.backgrounds){var g=$('<ul class="actors"></ul>'),
n=$("<h3>Backgrounds</h3>");d.append(n);d.append(g);$(c.backgrounds).each(function(b,c){var d=$('<li class="background"><span class="hidden"></span></li>');d.attr("name",c.name);d.find("span").text(c.image);generateImageFromUrl(c.preview,function(b){d.append(b)});g.append(d)})}for(e=0;e<c.tiles.length;e++){var q=c.tiles[e],n=$("<h3></h3>");n.text(q.label);d.append(n);if(e===0){var p=$('<div class="size btn-group"><a class="btn-round white micro one" href="#"> 1x </a><a class="btn-round white micro three" href="#"> 3x </a><a class="btn-round white micro five" href="#"> 5x </a></div>');
p.find(".one").click(function(){$("#win-media-sidebar h3 .size a").removeClass("blue").addClass("white");$("#win-media-sidebar h3 .size a.one").addClass("blue");Canvas.tileSize=0});p.find(".three").click(function(){$("#win-media-sidebar h3 .size a").removeClass("blue").addClass("white");$("#win-media-sidebar h3 .size a.three").addClass("blue");Canvas.tileSize=1});p.find(".five").click(function(){$("#win-media-sidebar h3 .size a").removeClass("blue").addClass("white");$("#win-media-sidebar h3 .size a.five").addClass("blue");
Canvas.tileSize=2});Canvas.tileSize==1?p.find(".three").addClass("blue"):Canvas.tileSize==2?p.find(".five").addClass("blue"):p.find(".one").addClass("blue");n.append(p)}g=$('<ul class="tiles"></ul>');d.append(g);var q=q.tiles,s;for(s in Runtime.stage.tileLayer._tileSetMapping)if(!q||q.indexOf(s)>=0){b=Runtime.stage.tileLayer._tileSetMapping[s];p=b>0?$('<li data-type="'+b+'"><img class="tile" src="ide/level/'+s+'-preview.png"/></li>'):$('<li data-type="0"><img class="tile" src="ide/imgs/blank.png"/></li>');
g.append(p);p.click(function(){WinStage.cmdStop();Runtime.stage.tileLayer.currentTileType=parseInt($(this).attr("data-type"));WinMediaSidebar.lastSelectedTile=Runtime.stage.tileLayer.currentTileType;$(".global-toolbar .tile-tool").addClass("selected").siblings().removeClass("selected");$("#win-media-sidebar .tiles li").removeClass("selected");$(this).addClass("selected");Runtime.stage.setDesignMode("place");$("#stage-canvas").css("cursor","auto");Runtime.stage.tileLayer.enableTiles(true);return false})}}for(e=
0;e<c.actors.length;e++){var g=$('<ul class="actors"></ul>'),n=null;if(c.actors[e].hidden)g.addClass("hidden");else{n=$("<h3>"+c.actors[e].label+"</h3>");d.append(n)}d.append(g);if(c.actors[e].code){p=$('<li class="template hidden"></li>');p.text(c.actors[e].code);g.append(p)}$(c.actors[e].objects).each(function(b,c){if(c.launch){var d=$('<a href="#">Add</a>');n&&n.append(d);c.defaultcode&&d.find("span").text(c.defaultcode);c.requirelibs&&d.attr("data-libs",c.requirelibs.join(","));c.requireactors&&
d.attr("data-actors",c.requireactors.join(","));c.launch=="Character"?d.click(WinMediaSidebar._addCharacter):c.launch=="Media"&&d.click(WinMediaSidebar._addMedia)}else{d=$('<li class="actor"><span class="hidden"></span></li>');d.attr("data-id",c.id);c.requirelibs&&d.attr("data-libs",c.requirelibs.join(","));c.requireactors&&d.attr("data-actors",c.requireactors.join(","));d.find("span").text(c.sprite);g.append(d);generateImageFromUrl(c.preview,function(b){d.append(b)})}})}})}})};
WinMediaSidebar._addCharacter=function(){var b=$(this).parents("ul").find("li.template").text(),c=$(this).find("span.template").text(),d=$(this).attr("data-libs"),e=$(this).attr("data-actors");window.WinSpine&&WinSpine.showCreator(function(f,g){Sprites.addSprite({cx:500,cy:500,scale:0.25,label:"actor",costumeName:"actor",img:"avatar://spine",forceNumber:false,skeletonType:f,skeletonParts:g},function(f){f.spriteObj.setPosition(Runtime.stage.getWidth()/2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/
2-Runtime.stage.tileLayer.getScrollOffsetY());if(b){b=JSON.parse(b);for(var g=0;g<b.length;g++)b[g].hidden=true;ObjectIO.deserializeScripts(f,b)}if(c){c=JSON.parse(c);ObjectIO.deserializeScripts(f,c)}if(d)for(var k=d.split(","),g=0;g<k.length;g++)Runtime.requireLibrary(k[g],function(){WinTools.reset()});if(e){k=e.split(",");for(g=0;g<k.length;g++){var l=WinMediaSidebar._findActor(k[g]);if(l&&!Sprites.getSpriteByName(l.label)){l.hidden=true;ObjectIO.deserializeSprite(l)}}}IDE.selectAsset(f);IDE.Clipboard.undoAddActor(f)})});
return false};
WinMediaSidebar._addMedia=function(){var b=$(this).parents("ul").find("li.template").text(),c=$(this).find("span.template").text(),d=$(this).attr("data-libs"),e=$(this).attr("data-actors");WinMediaAssets.showPicker("Add an Actor",function(f,g,h){var j=f[0],k=getFileExt(j.url);if(k==".mp3"||k==".wav"){if(IDE.editingActor){IDE.addResourceTo(j.url,j.name,IDE.editingActor);return IDE.editingActor}IDE.addResourceTo(j.url,j.name,Runtime.background);return Runtime.background}if(k==".actor")ObjectIO.loadSprite(j.url,function(b){b.spriteObj.setPosition(Runtime.stage.getWidth()/
2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/2-Runtime.stage.tileLayer.getScrollOffsetY());Runtime.stage.draw();IDE.computeAll();IDE.draw();IDE.selectAsset(b);window.WinProperties&&WinProperties.show("interfaces");IDE.Clipboard.undoAddActor(b)});else{IDE.dirty();k=1;if(j.url.indexOf("avatar://")==0&&(Runtime.stage.width<800||Runtime.stage.height<800))k=0.5;var l=Sprites.addSprite({cx:j.cx,cy:j.cy,scale:k,label:h?h:j.name?j.name:"actor",costumeName:j.name?j.name:"actor",img:j.url,
forceNumber:false},function(){l.spriteObj.setPosition(Runtime.stage.getWidth()/2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/2-Runtime.stage.tileLayer.getScrollOffsetY());IDE._ignoreUpdates=true;for(var g=1;g<f.length;g++)l.addCostume({img:f[g].url,name:f[g].name,cx:f[g].cx,cy:f[g].cy});IDE._ignoreUpdates=false;f[0].code&&ObjectIO.deserializeScripts(l,JSON.parse(f[0].code));if(b){b=JSON.parse(b);for(g=0;g<b.length;g++)b[g].hidden=true;ObjectIO.deserializeScripts(l,b)}if(c){c=
JSON.parse(c);ObjectIO.deserializeScripts(l,c)}if(d)for(var h=d.split(","),g=0;g<h.length;g++)Runtime.requireLibrary(h[g],function(){WinTools.reset()});if(e){h=e.split(",");for(g=0;g<h.length;g++){var j=WinMediaSidebar._findActor(h[g]);if(j&&!Sprites.getSpriteByName(j.label)){j.hidden=true;ObjectIO.deserializeSprite(j)}}}IDE.selectAsset(l);IDE.Clipboard.undoAddActor(l)});if(g)l.avatarid=g}},{backgrounds:true,actors:true,images:true,sounds:true,charStudio:true});$("#win-media-assets").modal();return false};
WinMediaSidebar._addAsset=function(b,c,d){var e=b[0],f=getFileExt(e.url);if(f==".mp3"||f==".wav"||e.section=="scenes"){IDE.addResourceTo(e.url,e.name,Runtime.background);return Runtime.background}if(f==".actor")ObjectIO.loadSprite(e.url,function(b){b.spriteObj.setPosition(Runtime.stage.getWidth()/2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/2-Runtime.stage.tileLayer.getScrollOffsetY());Runtime.stage.draw();IDE.computeAll();IDE.draw();IDE.selectAsset(b);window.WinProperties&&
WinProperties.show("interfaces");IDE.Clipboard.undoAddActor(b)});else{IDE.dirty();f=1;if(e.url.indexOf("avatar://")==0&&(Runtime.stage.width<800||Runtime.stage.height<800))f=0.5;var g=Sprites.addSprite({cx:e.cx,cy:e.cy,scale:f,label:d?d:e.name?e.name:"actor",costumeName:e.name?e.name:"actor",img:e.url,forceNumber:false},function(){g.spriteObj.setPosition(Runtime.stage.getWidth()/2-Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.getHeight()/2-Runtime.stage.tileLayer.getScrollOffsetY());IDE._ignoreUpdates=
true;for(var c=1;c<b.length;c++)g.addCostume({img:b[c].url,name:b[c].name,cx:b[c].cx,cy:b[c].cy});IDE._ignoreUpdates=false;b[0].code&&ObjectIO.deserializeScripts(g,JSON.parse(b[0].code));IDE.selectAsset(g);IDE.Clipboard.undoAddActor(g)});if(c)g.avatarid=c;return g}};
WinMediaSidebar.searchAssets=function(b){$.ajax({url:WinMediaAssets.medialibsearch,data:{q:b},success:function(c){if(c.length>0){var d=$("#win-media-sidebar"),e=d.find(".container");e.empty().append("<h3>Search Results</h3>");d=$('<ul class="images"></ul>');e.append(d);for(var f=false,e=0;e<c.length;e++){var g=c[e];if(g.dir!="backgrounds"&&g.dir!="scenes")for(var h=0;h<g.entries.length;h++){var j=g.entries[h];if(j.type!="mp3"){if(j.entries&&j.entries.length>0){f=$('<li class="image"><img name="'+
j.entries[0].name+'" src="'+j.entries[0].url+'" alt="'+j.dir+'"/><span class="hidden"></span></li>');d.append(f);for(var k=1;k<j.entries.length;k++)f.append('<img name="'+j.entries[k].name+'" src="'+j.entries[k].url+'" class="hidden"/>')}else{f=$('<li class="image"><img src="'+j.url+'" alt="'+j.name+'"/><span class="hidden"></span></li>');d.append(f)}f=true}}}}if(!f){d=$("#win-media-sidebar");e=d.find(".container");e.empty().append("<h3>Search Results</h3>");e.append('Sorry, no matches were found for "'+
b+'". Please try another search term.')}},error:function(){var c=$("#win-media-sidebar").find(".container");c.empty().append("<h3>Search Results</h3>");c.append('Sorry, no matches were found for "'+b+'". Please try another search term.')}})};
WinMediaSidebar._showResults=function(b,c){var d=$("#win-media-sidebar .tab-content .tab-content-inner");d.scrollTop(0);d.empty();for(var e=0;e<WinMediaSidebar.displayOrder.length;e++)for(var f=0;f<b.length;f++){var g=b[f];if(!(g.dir=="backgrounds"||g.dir=="scenes")||WinMediaSidebar._showBackgrounds)if(g.dir&&!(g.dir=="sounds"||g.dir=="music")||WinMediaSidebar._showSounds)if(!g.dir||!(g.dir!="sounds"&&g.dir!="music"&&g.dir!="backgrounds"&&g.dir!="scenes"&&!WinMediaSidebar._showImages))if(WinMediaSidebar.displayOrder[e]==
g.dir&&g.entries.length>0){var h=$("<h3></h3>");h.text(g.dir.charAt(0).toUpperCase()+g.dir.substring(1));d.append(h);h=$("<ul></ul>");d.append(h);for(f=0;f<g.entries.length;f++){var j,k=g.entries[f];if(k.dir){if(k.entries.length>0){var l=k.dir;j=$('<li class="stack-asset" data-name="'+l+'" data-type="dir"><img src="'+k.entries[0].url+'"/><span class="asset-name"></span><span class="costume-count">'+k.entries.length+" costumes </span></li>");j.data("entries",k.entries);j.mouseenter(WinMediaSidebar._startAnimation).mouseleave(WinMediaSidebar._stopAnimation)}}else{l=
k.name;j=l.indexOf(".");j>0&&(l=l.substring(0,j));if(k.type=="mp3"||k.type=="wav"){if(c){j=$('<li class="sound-asset" data-name="'+l+'" data-type="'+k.type+'" data-id="'+k.id+'" data-url="/assets/user/'+k.id+"."+k.type+'" data-my="true"><div class="icon-volume-high"></div><span class="asset-name"></span><a href="#" class="cmd-play">Play</a><a href="#" class="cmd-delete"></a></li>');j.find("a.cmd-delete").click(WinMediaSidebar._deleteClicked)}else j=$('<li class="sound-asset" data-name="'+l+'" data-type="'+
k.type+'" data-id="'+k.id+'" data-url="'+k.url+'"><div class="icon-volume-high"></div><span class="asset-name"></span><a href="#" class="cmd-play">Play</a></li>');j.find("a.cmd-play").click(WinMediaSidebar._playClicked)}else{if(c){j=$('<li data-name="'+l+'" data-type="'+k.type+'" data-id="'+k.id+'" data-url="/assets/user/'+k.id+"."+k.type+'" data-my="true"><img src="/assets/user/'+k.id+"."+k.type+'"/><span class="asset-name"></span><a href="#" class="cmd-delete"></a></li>');j.find("a.cmd-delete").click(WinMediaSidebar._deleteClicked)}else j=
$('<li data-name="'+l+'" data-type="'+k.type+'" data-id="'+k.id+'" data-url="'+k.url+'"><img src="'+k.url+'"/><span class="asset-name"></span></li>');(g.dir=="backgrounds"||g.dir=="scenes")&&j.addClass("scene-asset")}}j.find("span.asset-name").text(l);j.click(WinMediaSidebar._pickAsset);h.append(j)}break}else if(WinMediaSidebar.displayOrder[e]==""&&!b[f].dir){h=d.find("ul.data-flat");if(h.length===0){h=$('<ul class="data-flat"></ul>');d.append(h)}k=b[f];l=k.name;j=l.indexOf(".");j>0&&(l=l.substring(0,
j));if(k.type=="mp3"||k.type=="wav"){j=$('<li class="sound-asset" data-name="'+l+'" data-type="'+k.type+'" data-id="'+k.id+'" data-url="'+k.url+'"><div class="icon-volume-high"></div><span class="asset-name"></span><a href="#" class="cmd-play">Play</a></li>');j.find("a.cmd-play").click(WinMediaSidebar._playClicked)}else j=$('<li data-name="'+l+'" data-type="'+k.type+'" data-id="'+k.id+'" data-url="'+k.url+'"><img src="'+k.url+'"/><span class="asset-name"></span></li>');j.find("span.asset-name").text(l);
j.click(WinMediaSidebar._pickAsset);h.append(j)}}if(c){if(!h){h=$("<ul></ul>");d.append(h)}d=$('<a class="asset-action" href="#"></a>');if(c=="upload"){d.text("Upload an Asset");d.click(WinMediaSidebar._upload)}else if(c=="photo"){d.text("Take a Picture");d.click(WinMediaSidebar._camera)}else if(c=="drawing"){d.text("Draw an Image");d.click(WinMediaSidebar._draw)}else if(c=="audio"){d.text("Record Audio");d.click(WinMediaSidebar._record);e=$('<a class="asset-action" href="#"></a>');e.text("Upload a Sound File");
e.click(WinMediaSidebar._upload);h.prepend(e)}h.prepend(d)}};WinMediaSidebar._playClicked=function(){soundManager.stopAll();if($(this).text()=="Play"){$(this).text("Stop");var b=$(this).parents("li");soundManager.createSound({id:"s"+Math.random(),url:b.attr("data-url")}).play({onfinish:function(){b.find("a.cmd-play").text("Play")}})}else $(this).text("Play");return false};
WinMediaSidebar._deleteClicked=function(){var b=$(this).parents("li"),c=b.attr("data-id");$.ajax({url:WinMediaSidebar.medialibdelete,data:{i:c},success:function(){b.detach()}});return false};
WinMediaSidebar._pickAsset=function(){var b=$(this),c=b.attr("data-type");if(c=="dir"){for(var c=b.data("entries"),d=[],e=0;e<c.length;e++){var f=c[e].name,g=f.indexOf(".");g>0&&(f=f.substring(0,g));b.attr("data-my");d.push({name:f,url:c[e].url})}WinMediaSidebar._callback(d,null,null,WinMediaSidebar._callbackObj)}else{c!="actor"&&b.attr("data-my");WinMediaSidebar._callback([{name:b.attr("data-name"),url:b.attr("data-url")}],null,null,WinMediaSidebar._callbackObj)}$.modal.close();return false};
WinMediaSidebar.handleSelectMode=function(){$("#win-media-sidebar .global-toolbar li").removeClass("selected");$("#win-media-sidebar .tiles li").removeClass("selected");$("#win-media-sidebar .global-toolbar li.select-tool").addClass("selected");Runtime.stage.setDesignMode("normal");$("#stage-canvas").css("cursor","auto");return false};
WinMediaSidebar.handleTileMode=function(){$("#win-media-sidebar .global-toolbar li").removeClass("selected");$("#win-media-sidebar .global-toolbar li.tile-tool").addClass("selected");Runtime.stage.setDesignMode("place");Runtime.stage.tileLayer.currentTileType=WinMediaSidebar.lastSelectedTile;$("#win-media-sidebar .tiles-wrapper .tiles li").each(function(b,c){b==Runtime.stage.tileLayer.currentTileType?$(c).addClass("selected"):$(c).removeClass("selected")});$("#stage-canvas").css("cursor","auto");
Runtime.stage.tileLayer.enableTiles(true);return false};WinMediaSidebar.handleDeleteMode=function(){$("#win-media-sidebar .global-toolbar li").removeClass("selected");$("#win-media-sidebar .tiles li").removeClass("selected");$("#win-media-sidebar .global-toolbar li.remove-tool").addClass("selected");Runtime.stage.setDesignMode("remove");$("#stage-canvas").css("cursor",'url("ide/imgs/trashcan-cursor.png"), auto');return false};
WinMediaSidebar.canDrag=function(b,c){var d=false;if(!$("#win-media-sidebar").hasClass("hidden")){var e=$("#win-media-sidebar");b>=e.offset().left&&(b<=e.offset().left+e.outerWidth()&&c>=e.offset().top&&c<=e.offset().top+e.outerHeight())&&(d=true)}return d};
WinMediaSidebar.getDragObj=function(b,c){var d=null;if(!$("#win-media-sidebar").hasClass("hidden")){var e=$("#win-media-sidebar");b>=e.offset().left&&(b<=e.offset().left+e.outerWidth()&&c>=e.offset().top&&c<=e.offset().top+e.outerHeight())&&$("#win-media-sidebar li.actor,li.image,li.background").each(function(e,g){var h=$(g);if(b>=h.offset().left&&b<=h.offset().left+h.outerWidth()&&c>=h.offset().top&&c<=h.offset().top+h.outerHeight()){WinStage.cmdStop();$("#win-media-sidebar .tiles li").removeClass("selected");
$("#win-media-sidebar li.select-tool").addClass("selected");Runtime.stage.setDesignMode("normal");var j=h.parents("ul").find("li.template").text();if(j)for(var j=JSON.parse(j),k=0;k<j.length;k++)j[k].hidden=true;if(h.hasClass("actor")){if(k=h.find("span").text()){k=JSON.parse(k);if(j)k.scripts=k.scripts.concat(j);k=JSON.stringify(k)}d=new WinAssets.DragObject(h.find("img").attr("src"),k);d.requiredlibs=h.attr("data-libs");d.requiredactors=h.attr("data-actors")}else if(h.hasClass("background")){j=
h.find("span").text();d=new WinAssets.DragObject(j,{type:"background",name:h.attr("name"),url:j})}else if(h.hasClass("image")){var k=h.find("img")[0],j=h.find("img").attr("src"),l={label:"actor",scripts:[],costumes:[{name:"image",img:j,cx:k.width/2,cy:k.height/2}],currentCostume:1,sounds:[],scale:1,x:0,y:0,rotation:0,rotateLock:1,isHidden:false,volume:100,locked:false,hiddenInSandbox:false,lockedInSandbox:false,zIndex:0,physics:{isStatic:false,isActive:true,geometry:"circular",density:1,friction:0.5,
restitution:0.2},variables:{},varDefaults:{},lists:{}};h.find("img.hidden").each(function(b,c){l.costumes.push({name:"image"+(b+1),img:c.src,cx:c.width,cy:c.height})});d=new WinAssets.DragObject(j,JSON.stringify(l))}return false}})}return d};
WinMediaSidebar.dragCompleted=function(b){if(b.requiredlibs)for(var c=b.requiredlibs.split(","),d=0;d<c.length;d++)Runtime.requireLibrary(c[d],function(){WinTools.reset()});if(b.requiredactors){b=b.requiredactors.split(",");for(d=0;d<b.length;d++)if((c=WinMediaSidebar._findActor(b[d]))&&!Sprites.getSpriteByName(c.label)){c.hidden=true;ObjectIO.deserializeSprite(c)}}};
var WinMediaCapture={meterLevel:null,meterSize:100,mediaId:null,initialized:!1,audioStream:null,videoStream:null,audioCallback:null,videoCallback:null,audioRecorder:null,audio_context:null,init:function(){MediaCapture.init();if(!WinMediaCapture.initialized){if(window.IDE&&MediaCapture.supportsCapture){WinMediaCapture.meterSize=$("#audiocapture .meter").innerWidth();WinMediaCapture.meterLevel=$("#audiocapture .meter .level");for(var b=0;b<g_palette.length;b++)if(g_palette[b].label=="Looks"){if(g_steps.blockLooksVideo){g_steps.blockLooksVideo.hidden=
false;g_palette[b].items.push(g_steps.blockLooksVideo);g_steps.blockLooksVideoTransparency.hidden=false;g_palette[b].items.push(g_steps.blockLooksVideoTransparency)}}else if(g_palette[b].label=="Sensing"&&g_steps.valueSensingVideo){g_steps.valueSensingVideo.hidden=false;g_steps.valueSensingSoundLevel.hidden=false;g_palette[b].items.push(g_steps.valueSensingVideo);g_palette[b].items.push(g_steps.valueSensingSoundLevel)}}WinMediaCapture.initialized=true}},stop:function(){if(WinMediaCapture.audioRecorder){WinMediaCapture.audioRecorder.stop();
WinMediaCapture.audioRecorder=null}if(WinMediaCapture.audioStream){var b=WinMediaCapture.audioStream.getAudioTracks();if(b)for(var c=0;c<b.length;c++)b[c].stop();WinMediaCapture.audioStream=null}if(WinMediaCapture.videoStream){if(b=WinMediaCapture.videoStream.getTracks())for(c=0;c<b.length;c++)b[c].stop();WinMediaCapture.videoStream=null}},_audioCallback:function(b,c){for(var d=0,e=0;e<b.length;e=e+16){var f=b[e],g=c[e];f<0?-f>d&&(d=-f):f>0&&f>d&&(d=f);g<0?-g>d&&(d=-g):g>0&&g>d&&(d=g)}WinMediaCapture.meterLevel.css("width",
WinMediaCapture.meterSize*(d>1?1:d))},_recordButton:function(){if(!$(this).hasClass("disabled")){WinMediaCapture.startRecord();$(".recorderwidget .status").text("Recording...");$(".recorderwidget .record").addClass("disabled").addClass("selected");$(".recorderwidget .stop").removeClass("disabled").removeClass("selected");$(".recorderwidget .play").removeClass("disabled").removeClass("selected");WinMediaCapture._startTimer()}return false},_playButton:function(){if(!$(this).hasClass("disabled")){$(".recorderwidget .status").text("Playing...");
$(".recorderwidget .record").addClass("disabled").removeClass("selected");$(".recorderwidget .stop").removeClass("disabled").removeClass("selected");$(".recorderwidget .play").addClass("disabled").addClass("selected");if(WinMediaCapture.audioRecorder&&WinMediaCapture.audioRecorder.isRecording())WinMediaCapture.stopRecord(function(b){WinMediaCapture._startTimer();soundManager.createSound({id:"recorder",url:b,autoPlay:true,onfinish:function(){WinMediaCapture._stopTimer();soundManager.destroySound("recorder");
$(".recorderwidget .status").text("");$(".recorderwidget .record").removeClass("disabled").removeClass("selected");$(".recorderwidget .stop").addClass("disabled").removeClass("selected");$(".recorderwidget .play").removeClass("disabled").removeClass("selected")}})},true);else{WinMediaCapture._startTimer();soundManager.createSound({id:"recorder",url:"/assets/voice/"+IDE.currentProjectId+".mp3",autoPlay:true,onfinish:function(){WinMediaCapture._stopTimer();soundManager.destroySound("recorder");$(".recorderwidget .status").text("");
$(".recorderwidget .record").removeClass("disabled").removeClass("selected");$(".recorderwidget .stop").addClass("disabled").removeClass("selected");$(".recorderwidget .play").removeClass("disabled").removeClass("selected")}})}}return false},_stopButton:function(){$(".recorderwidget .status").text("");if(!$(this).hasClass("disabled")){WinMediaCapture._stopTimer();if(WinMediaCapture.audioRecorder&&WinMediaCapture.audioRecorder.isRecording()){$(".recorderwidget .status").text("Saving...");WinMediaCapture.stopRecord(function(){$(".recorderwidget .status").text("");
$(".recorderwidget .record").removeClass("disabled").removeClass("selected");$(".recorderwidget .stop").addClass("disabled").removeClass("selected");$(".recorderwidget .play").removeClass("disabled").removeClass("selected")},true)}else{soundManager.stopAll();soundManager.destroySound("recorder");$(".recorderwidget .record").removeClass("disabled").removeClass("selected");$(".recorderwidget .stop").addClass("disabled").removeClass("selected");$(".recorderwidget .play").removeClass("disabled").removeClass("selected")}}return false},
_startWidgetCapture:function(){var b=$(".recorderwidget");b.find("span").removeClass("hidden");b.find("ul").addClass("hidden");if(!WinMediaCapture.audio_context)WinMediaCapture.audio_context=new AudioContext;navigator.getUserMedia({audio:true},function(c){var d=WinMediaCapture.audio_context.createMediaStreamSource(c);WinMediaCapture.audioStream=c;WinMediaCapture.audioRecorder=new Recorder(d,{levelCallback:WinMediaCapture._audioCallback});$(".recorderwidget span").addClass("hidden");$(".recorderwidget ul").removeClass("hidden");
WinMediaCapture.startRecord();$(".recorderwidget .status").text("Recording...");$(".recorderwidget .record").addClass("disabled").addClass("selected");$(".recorderwidget .stop").removeClass("disabled");$(".recorderwidget .play").removeClass("disabled");WinMediaCapture._startTimer();b.find("li.record").unbind().click(WinMediaCapture._recordButton);b.find("li.stop").unbind().click(WinMediaCapture._stopButton);b.find("li.play").unbind().click(WinMediaCapture._playButton)},function(){$(".recorderwidget span").removeClass("hidden").text("Please give me permission");
$(".recorderwidget ul").addClass("hidden")})},_startTimer:function(){$(".recorderwidget .timer").addClass("selected");WinMediaCapture.startTime=Date.now();window.clearInterval(WinMediaCapture._timerId);WinMediaCapture._timerId=window.setInterval(function(){var b=parseInt((Date.now()-WinMediaCapture.startTime)/1E3),c=parseInt(b/60),b=b%60;b<10&&(b="0"+b);$(".recorderwidget li.timer").removeClass("hidden").text(c+":"+b)},1E3)},_stopTimer:function(){$(".recorderwidget .timer").removeClass("selected");
window.clearInterval(WinMediaCapture._timerId)},showRecorderWidget:function(b,c){if(WinMediaCapture.audioStream){var d=WinMediaCapture.audioStream.getAudioTracks();if(d)for(var e=0;e<d.length;e++)d[e].stop();WinMediaCapture.audioStream=null}WinMediaCapture.mediaId=null;WinMediaCapture.audioRecorder=null;if(MediaCapture.supportsCapture){d=$('<div class="recorderwidget"><span class="hidden">Press the "Allow" button.</span><ul><li class="timer">0:00</li><li class="record"></li><li class="stop disabled"></li><li class="play"></li><li class="status"></li></ul></div>');
b.append(d);d.find("li.record").click(WinMediaCapture._startWidgetCapture);d.find("li.stop").click(WinMediaCapture._stopButton);d.find("li.play").click(WinMediaCapture._playButton);WinMediaCapture.audioCallback=c}},showAudioRecorder:function(b){if(WinMediaCapture.audioStream){var c=WinMediaCapture.audioStream.getAudioTracks();if(c)for(var d=0;d<c.length;d++)c[d].stop();WinMediaCapture.audioStream=null}WinMediaCapture.mediaId=null;WinMediaCapture.audioRecorder=null;if(MediaCapture.supportsCapture){$("#audiocapture .askpermission").removeClass("hidden");
$("#audiocapture .nopermission").addClass("hidden");$("#audiocapture .content").addClass("hidden");WinMediaCapture.audioCallback=b;if(!WinMediaCapture.audio_context)WinMediaCapture.audio_context=new AudioContext;navigator.getUserMedia({audio:true},function(b){var c=WinMediaCapture.audio_context.createMediaStreamSource(b);WinMediaCapture.audioStream=b;WinMediaCapture.audioRecorder=new Recorder(c,{levelCallback:WinMediaCapture._audioCallback});$("#audiocapture .askpermission").addClass("hidden");$("#audiocapture .nopermission").addClass("hidden");
$("#audiocapture .content").removeClass("hidden");$("#audiocapture .record").removeClass("disabled");$("#audiocapture .stop").addClass("disabled");$("#audiocapture .play").addClass("disabled")},function(){$("#audiocapture .askpermission").addClass("hidden");$("#audiocapture .nopermission").removeClass("hidden");$("#audiocapture .content").addClass("hidden");$("#audiocapture .record").addClass("disabled");$("#audiocapture .stop").addClass("disabled");$("#audiocapture .play").addClass("disabled")});
$("#audiocapture .record").addClass("disabled").unbind().click(function(){WinMediaCapture.startRecord();$("#audiocapture .record").addClass("disabled");$("#audiocapture .stop").removeClass("disabled");$("#audiocapture .play").removeClass("disabled")});$("#audiocapture .stop").addClass("disabled").unbind().click(function(){$("#audiocapture .play").addClass("disabled");if(WinMediaCapture.audioRecorder.isRecording())WinMediaCapture.stopRecord(function(){$("#audiocapture .record").removeClass("disabled");
$("#audiocapture .stop").addClass("disabled");$("#audiocapture .play").removeClass("disabled")});else{soundManager.stopAll();soundManager.destroySound("recorder");$("#audiocapture .record").removeClass("disabled");$("#audiocapture .stop").addClass("disabled");$("#audiocapture .play").removeClass("disabled")}});$("#audiocapture .play").addClass("disabled").unbind().click(function(){$("#audiocapture .record").addClass("disabled");$("#audiocapture .stop").removeClass("disabled");$("#audiocapture .play").addClass("disabled");
WinMediaCapture.audioRecorder.isRecording()?WinMediaCapture.stopRecord(function(b){soundManager.createSound({id:"recorder",url:b,autoPlay:true,onfinish:function(){soundManager.destroySound("recorder");$("#audiocapture .record").removeClass("disabled");$("#audiocapture .stop").addClass("disabled");$("#audiocapture .play").removeClass("disabled")}})}):WinMediaCapture.mediaId&&soundManager.createSound({id:"recorder",url:"/assets/user/"+WinMediaCapture.mediaId+".mp3",autoPlay:true,onfinish:function(){soundManager.destroySound("recorder");
$("#audiocapture .record").removeClass("disabled");$("#audiocapture .stop").addClass("disabled");$("#audiocapture .play").removeClass("disabled")}})});$("#audiocapture").modal();$("#audiocapture").on("modal:close",function(){if(WinMediaCapture.audioRecorder){WinMediaCapture.audioRecorder.stop();WinMediaCapture.audioRecorder=null}if(WinMediaCapture.audioStream){var b=WinMediaCapture.audioStream.getAudioTracks();if(b)for(var c=0;c<b.length;c++)b[c].stop();WinMediaCapture.audioStream=null}WinMediaCapture.mediaId&&
$.ajax({url:"api/medialibdelete.aspx",type:"POST",data:{i:WinMediaCapture.mediaId}})});$("#audiocapture a.cancelBtn").unbind().click(function(){$.modal.close();return false});$("#audiocapture a.okBtn").unbind().click(function(){if(WinMediaCapture.audioRecorder&&WinMediaCapture.audioRecorder.isRecording())WinMediaCapture.stopRecord(function(){var b=WinMediaCapture.mediaId;WinMediaCapture.mediaId=null;WinMediaCapture.audioCallback&&b&&WinMediaCapture.audioCallback("/assets/user/"+b+".mp3");$.modal.close()});
else{var b=WinMediaCapture.mediaId;WinMediaCapture.mediaId=null;WinMediaCapture.audioCallback&&b&&WinMediaCapture.audioCallback("/assets/user/"+b+".mp3");$.modal.close()}return false})}},startRecord:function(){MediaCapture.supportsCapture&&WinMediaCapture.audioRecorder&&WinMediaCapture.audioRecorder.record()},stopRecord:function(b,c){if(MediaCapture.supportsCapture&&WinMediaCapture.audioRecorder){IDE.showProgress(g_loc.getText("dialog.projectloading"));WinMediaCapture.audioRecorder.stop();WinMediaCapture.audioRecorder.exportWAV(function(d){WinMediaCapture.mediaId&&
$.ajax({url:"api/medialibdelete.aspx",type:"POST",data:{i:WinMediaCapture.mediaId}});saveurl=c?"/api/projectsavevoice":"api/medialibsave.aspx";var e=new FileReader;e.onload=function(d){$.ajax({url:saveurl,type:"POST",data:{p:IDE.currentProjectId,t:"audio",d:d.target.result},success:function(d){var d=JSON.parse(d),e="";if(d.result){e=d.id;WinMediaCapture.mediaId=e}b&&(c?b("/assets/voice/"+IDE.currentProjectId+".mp3"):b("/assets/user/"+e+".mp3"));IDE.showProgress(null)},error:function(){IDE.showProgress(null)}})};
e.readAsDataURL(d);WinMediaCapture.audioRecorder&&WinMediaCapture.audioRecorder.clear()})}},deleteAudio:function(){$.ajax({url:"api/medialibdelete.aspx",type:"POST",data:"i="+encodeURIComponent(mediaId),success:function(){}})},showPictureTaker:function(b,c){WinMediaCapture.videoStream=null;if(MediaCapture.supportsCapture){WinMediaCapture.videoCallback=b;$("#videocapture").modal();$("#videocapture").on("modal:close",function(){if(WinMediaCapture.videoStream){var b=WinMediaCapture.videoStream.getTracks();
if(b)for(var c=0;c<b.length;c++)b[c].stop();WinMediaCapture.videoStream=null}});$("#videocapture a.okBtn").unbind().click(function(){WinMediaCapture.takeSnapshot();$.modal.close();return false});$("#videocapture a.cancelBtn").unbind().click(function(){$.modal.close();if(WinMediaCapture.videoStream){var b=WinMediaCapture.videoStream.getTracks();if(b)for(var c=0;c<b.length;c++)b[c].stop();WinMediaCapture.videoStream=null}return false});$("#videocapture .askpermission").removeClass("hidden");$("#videocapture .nopermission").addClass("hidden");
$("#videocapture .content").addClass("hidden");var d=$("#videocapture video")[0];navigator.getUserMedia({video:true},function(b){d.src=window.URL.createObjectURL(b);WinMediaCapture.videoStream=b;$("#videocapture .askpermission").addClass("hidden");$("#videocapture .nopermission").addClass("hidden");$("#videocapture .content").removeClass("hidden")},function(){$("#videocapture .askpermission").addClass("hidden");$("#videocapture .nopermission").removeClass("hidden");$("#videocapture .content").addClass("hidden");
c&&c()})}},takeSnapshot:function(){if(WinMediaCapture.videoStream){var b=document.createElement("canvas"),c=$("#videocapture video")[0];b.width=c.videoWidth;b.height=c.videoHeight;b.getContext("2d").drawImage(c,0,0,b.width,b.height);$.ajax({url:"api/medialibsave.aspx",type:"POST",data:{t:"photo",d:b.toDataURL("image/png")},success:function(c){var c=JSON.parse(c),d="";if(c.result)d=c.id;WinMediaCapture.videoCallback&&WinMediaCapture.videoCallback("/assets/user/"+d+".png",b.width/2,b.height/2)}});if(c=
WinMediaCapture.videoStream.getTracks())for(var d=0;d<c.length;d++)c[d].stop();WinMediaCapture.videoStream=null}}},WinSpine={_callback:null,_defaultType:null,updateId:0,animationTimeScale:1,totalTime:0,lastTime:0,currentType:null,currentPreset:null,currentParts:{},notify:!1,rewards:null,rewardTypes:null,skeletonData:null,skeleton:null,skeletonBounds:null,stateData:null,state:null,defaultAnimation:"",init:function(){var b=$("#win-spine");b.find(".cancelBtn").click(function(){WinSpine.clearNotification();
window.clearInterval(WinSpine.updateId);WinSpine.updateId=0;$("#win-spine").addClass("hidden");$("#win-spine .presetchooser").removeClass("hidden");$("#win-spine .partschooser").addClass("hidden");WinSpine.editingSprite=null;return false});b.find(".saveBtn").click(function(){WinSpine.clearNotification();window.clearInterval(WinSpine.updateId);WinSpine.updateId=0;$("#win-spine").addClass("hidden");$("#win-spine .presetchooser").removeClass("hidden");$("#win-spine .partschooser").addClass("hidden");
WinSpine._callback&&WinSpine._callback(WinSpine.currentType,WinSpine.currentParts);WinSpine.editingSprite=null;return false});b.find(".presetsBtn").click(function(){window.clearInterval(WinSpine.updateId);WinSpine.updateId=0;$(".winspine-header").addClass("presetchooser");$(".winspine-footer").addClass("presetchooser");$("#win-spine .presetchooser").removeClass("hidden");$("#win-spine .partschooser").addClass("hidden");return false});b.find(".resetBtn").click(function(){WinSpine.currentPreset&&WinSpine.selectPreset();
return false});$.ajax({url:"api/userrewards.aspx",data:{t:"notify"},success:function(b){if(b){b=JSON.parse(b);if(b.notify&&b.rewards&&b.types){WinSpine.notify=b.notify;WinSpine.rewards=b.rewards;WinSpine.rewardTypes=b.types}}}});WinSpine.totalTime=0;WinSpine.lastTime=Date.now();window.clearInterval(WinSpine.updateId);WinSpine.updateSkeleton();$(window).resize(WinSpine.adjustWindow);WinSpine.adjustWindow()},clearNotification:function(){if(WinSpine.notify){$.ajax({url:"/api/userrewards",type:"POST",data:{t:"clear"}});
var b=$("#win-spine");b.find(".new-item-tag-small").removeClass("new-item-tag-small");b.find(".new-item-preset-tag").removeClass("new-item-preset-tag");WinSpine.notify=false}},_handleCategoryClick:function(){if($(this).attr("data-group"))WinSpine.selectGroup($(this).attr("data-group"));else{WinSpine.currentType=$(this).attr("data-type");WinSpine.selectCategory()}return false},selectCategory:function(){var b=$("#win-spine");b.find(".presetchooser .character-class li").each(function(b,c){$(c).attr("data-type")==
WinSpine.currentType?$(c).addClass("selected"):$(c).removeClass("selected")});b=b.find(".presetchooser .presets ul");b.empty().scrollTop(0);if(g_parts[WinSpine.currentType]){for(var c=0;c<g_parts[WinSpine.currentType].presets.length;c++){var d=g_parts[WinSpine.currentType].presets[c];if(g_parts[WinSpine.currentType].allowed.indexOf(d)>=0){d=WinSpine.notify&&WinSpine.rewards[WinSpine.currentType]&&WinSpine.rewards[WinSpine.currentType].indexOf(d)>=0?$('<li class="tab" data-type="'+WinSpine.currentType+
'" data-preset="'+d+'"><div class="new-item-preset-tag"></div><img src="ide/avatar/previews/'+WinSpine.currentType+"/"+d+'/index.png"/></li>'):$('<li class="tab" data-type="'+WinSpine.currentType+'" data-preset="'+d+'"><img src="ide/avatar/previews/'+WinSpine.currentType+"/"+d+'/index.png"/></li>');b.append(d);d.click(WinSpine._handlePresetClick)}}for(c=0;c<g_parts[WinSpine.currentType].presets.length;c++){d=g_parts[WinSpine.currentType].presets[c];if(g_parts[WinSpine.currentType].allowed.indexOf(d)<
0){d=$('<li class="tab locked" data-type="'+WinSpine.currentType+'" data-preset="'+d+'"><img src="ide/avatar/previews/'+WinSpine.currentType+"/"+d+'/index.png"/><span class="locked-message"> </span></li>');b.append(d);d.click(WinSpine._handlePresetClick);d.mouseenter(WinSpine._handlePresetMouseEnter);d.mouseleave(WinSpine._handlePresetMouseLeave)}}}},selectGroup:function(b){var c=$("#win-spine");c.find(".presetchooser .character-class li").each(function(c,d){$(d).attr("data-group")==b?$(d).addClass("selected"):
$(d).removeClass("selected")});c=c.find(".presetchooser .presets ul");c.empty().scrollTop(0);var d=[],e=[],f=0,g;for(g in g_parts)if(g_parts[g].group==b){for(var h=0,j=0,k=0;k<g_parts[g].presets.length;k++){var l=g_parts[g].presets[k];if(g_parts[g].allowed.indexOf(l)>=0){l=WinSpine.notify&&WinSpine.rewards[g]&&WinSpine.rewards[g].indexOf(l)>=0?$('<li class="tab" data-type="'+g+'" data-preset="'+l+'"><div class="new-item-preset-tag"></div><img src="ide/avatar/previews/'+g+"/"+l+'/index.png"/></li>'):
$('<li class="tab" data-type="'+g+'" data-preset="'+l+'"><img src="ide/avatar/previews/'+g+"/"+l+'/index.png"/></li>');f+h*2>d.length?d.push(l):d.splice(f+h*2,0,l);h++;l.click(WinSpine._handlePresetClick)}}for(k=0;k<g_parts[g].presets.length;k++){l=g_parts[g].presets[k];if(g_parts[g].allowed.indexOf(l)<0){l=$('<li class="tab locked" data-type="'+g+'" data-preset="'+l+'"><img src="ide/avatar/previews/'+g+"/"+l+'/index.png"/><span class="locked-message"> </span></li>');f+j*2>e.length?e.push(l):e.splice(f+
j*2,0,l);j++;l.click(WinSpine._handlePresetClick);l.mouseenter(WinSpine._handlePresetMouseEnter);l.mouseleave(WinSpine._handlePresetMouseLeave)}}f++}for(k=0;k<d.length;k++)c.append(d[k]);for(k=0;k<e.length;k++)c.append(e[k])},_handlePresetClick:function(){if(!$(this).hasClass("locked")){WinSpine.currentType=$(this).attr("data-type");WinSpine.currentPreset=$(this).attr("data-preset");WinSpine.selectPreset();WinSpine.updateId=window.setInterval(function(){WinSpine.updateSkeleton()},1E3/60)}return false},
_handlePresetMouseEnter:function(){if($(this).hasClass("locked")){var b=$(this).attr("data-type"),c=$(this).attr("data-preset"),d=$(this).find("span.locked-message");$.ajax({url:"api/userrewards.aspx",data:{t:"unlock",c:b,p:c},success:function(b){if(b){b=JSON.parse(b);if(b.message&&b.message!="-1"){d.parent().parent().find("span.locked-message").css("display","none");d.html("Unlocked in "+b.message).css("display","block")}}}})}},_handlePresetMouseLeave:function(){$(this).hasClass("locked")&&$(this).find("span.locked-message").html("").css("display",
"none")},selectPreset:function(b){var c=$("#win-spine"),d=c.find(".groups ul");d.empty();WinSpine.currentParts=b?b:{};var e="",f;for(f in g_parts[WinSpine.currentType].groupings){var g=$('<li class="category"><a href="#" data-partgrouping="'+f+'"><img class="off" src="ide/avatar/previews/'+WinSpine.currentType+"/parts/top-"+f+'.png"/><img class="on" src="ide/avatar/previews/'+WinSpine.currentType+"/parts/top-"+f+'-active.png"/><img class="subcat-active" src="ide/avatar/previews/'+WinSpine.currentType+
"/parts/top-"+f+'-selected.png"/></a><ul class="subcat"></ul></li>');if(!e){e=f;g.addClass("selected")}g.find("a").click(WinSpine._handleGroupingClick);var h=g.find("ul.subcat"),j=g_parts[WinSpine.currentType].groupings[f];if(j.length>1)for(var k=0;k<j.length;k++){var l=j[k];if(!g_parts[WinSpine.currentType].macros[l]||k>0){l=$('<li class="subcategory"><a href="#" data-subcat="'+l+'"><img class="off" src="ide/avatar/previews/'+WinSpine.currentType+"/parts/"+l+'.png"/><img class="on" src="ide/avatar/previews/'+
WinSpine.currentType+"/parts/"+l+'-active.png"/></a></li>');h.append(l);l.find("a").click(WinSpine._handleSubcategoryClick)}}d.append(g)}for(f in g_parts[WinSpine.currentType].options)WinSpine.currentPreset&&g_parts[WinSpine.currentType].options[f].indexOf(WinSpine.currentPreset)<0||!WinSpine.currentPreset&&g_parts[WinSpine.currentType].options[f].indexOf(WinSpine.currentParts[f])<0?WinSpine.currentParts[f]="blank":!b&&g_parts[WinSpine.currentType].parts[f]&&(WinSpine.currentParts[f]=g_parts[WinSpine.currentType].presetexceptions&&
g_parts[WinSpine.currentType].presetexceptions[WinSpine.currentPreset]&&g_parts[WinSpine.currentType].presetexceptions[WinSpine.currentPreset][f]?g_parts[WinSpine.currentType].presetexceptions[WinSpine.currentPreset][f]:WinSpine.currentPreset);c.find(".winspine-header").removeClass("presetchooser");c.find(".winspine-footer").removeClass("presetchooser");c.find(".presetchooser").addClass("hidden");c.find(".partschooser").removeClass("hidden");WinSpine.showGrouping(e);WinSpine.adjustWindow();WinSpine.loadCharacter()},
_handleGroupingClick:function(){var b=$(this).attr("data-partgrouping");WinSpine.showGrouping(b);return false},showGrouping:function(b){var c=$("#win-spine");c.find(".groups ul.top > li a").each(function(c,d){var e=$(d);e.attr("data-partgrouping")==b?e.parent().addClass("selected").removeClass("active"):e.parent().removeClass("selected").removeClass("active")});if(g_parts[WinSpine.currentType].showoverride){var d=g_parts[WinSpine.currentType].macros[b];if(d){for(var e=false,f=0;f<d.length;f++){var g=
d[f],h=WinSpine.currentParts[g];if(!h)break;if(g_parts[WinSpine.currentType].showoverride[g]&&g_parts[WinSpine.currentType].showoverride[g].indexOf(h)>=0){e=true;break}}e||c.find(".groups ul.top > li a").each(function(c,d){var e=$(d);e.attr("data-partgrouping")==b&&e.parent().find("ul.subcat").addClass("hidden")})}}WinSpine.showSubcategory(g_parts[WinSpine.currentType].groupings[b][0])},_handleSubcategoryClick:function(){var b=$(this).attr("data-subcat");WinSpine.showSubcategory(b);return false},
showSubcategory:function(b){var c=$("#win-spine"),d=c.find(".parts ul");d.empty();c.find(".top ul li a").each(function(c,d){var e=$(d);if(e.attr("data-subcat")==b){e.parent().addClass("selected");e.parents("li.category").addClass("active")}else e.parent().removeClass("selected")});for(var c=g_parts[WinSpine.currentType].options[b],e=0;e<c.length;e++){var f=g_parts[WinSpine.currentType];if(f.allowed.indexOf(c[e])>=0&&(!f.showoverride||!f.showoverride[b]||f.showoverride[b].indexOf(c[e])>=0)){var g;
c[e]!="blank"&&(g=$('<li data-partgroup="'+b+'" data-part="'+c[e]+'"><img src="ide/avatar/previews/'+WinSpine.currentType+"/"+c[e]+"/"+b+'.png"/></li>'));WinSpine.currentParts[b]==c[e]&&g.addClass("selected");g_parts[WinSpine.currentType].macros[b]?g.click(WinSpine._handleMacroPartClick):g.click(WinSpine._handlePartClick);d.append(g)}}for(e=0;e<c.length;e++)if(g_parts[WinSpine.currentType].allowed.indexOf(c[e])<0){c[e]!="blank"&&(g=$('<li class="locked" data-partgroup="'+b+'" data-part="'+c[e]+'"><img src="ide/avatar/previews/'+
WinSpine.currentType+"/"+c[e]+"/"+b+'.png"/></li>'));WinSpine.currentParts[b]==c[e]&&g.addClass("selected");g_parts[WinSpine.currentType].macros[b]?g.click(WinSpine._handleMacroPartClick):g.click(WinSpine._handlePartClick);d.append(g)}g=$('<li data-partgroup="'+b+'" data-part="blank"><img src="ide/avatar/noFeature.png"/></li>');g_parts[WinSpine.currentType].macros[b]?g.click(WinSpine._handleMacroPartClick):g.click(WinSpine._handlePartClick);d.append(g)},_handleMacroPartClick:function(){if(!$(this).hasClass("locked")){$(this).parents("ul").find("li").removeClass("selected");
$(this).parents("li").addClass("selected");for(var b=$(this).attr("data-partgroup"),c=$(this).attr("data-part"),d=g_parts[WinSpine.currentType].macros[b],e=0;e<d.length;e++){var f=d[e],g;if(g_parts[WinSpine.currentType].options[f].indexOf(c)<0)g=WinSpine.currentParts[f]="blank";else g=WinSpine.currentParts[f]=c;var h=g_parts[WinSpine.currentType].parts[f];h||(h=g_parts[WinSpine.currentType].macros[f]);if(g=="blank")for(f=0;f<h.length;f++){var j=new Image;j.onload=function(){WinSpine.updateSkeleton()};
j.src="ide/imgs/blank.png";WinSpine.textures[h[f]]=j}else for(f=0;f<h.length;f++){j=new Image;j.onload=function(){WinSpine.updateSkeleton()};j.src="ide/avatar/skins/"+WinSpine.currentType+"/"+g+"/"+h[f]+".png";WinSpine.textures[h[f]]=j}}g=$("#win-spine");g.find(".groups ul.top > li a").each(function(c,d){var e=$(d);e.attr("data-partgrouping")==b&&e.parent().find("ul.subcat").removeClass("hidden")});if(g_parts[WinSpine.currentType].showoverride){h=false;for(e=0;e<d.length;e++)if(g_parts[WinSpine.currentType].showoverride[d[e]]&&
g_parts[WinSpine.currentType].showoverride[d[e]].indexOf(c)>=0){h=true;break}h||g.find(".groups ul.top > li a").each(function(c,d){var e=$(d);e.attr("data-partgrouping")==b&&e.parent().find("ul.subcat").addClass("hidden")})}}return false},_handlePartClick:function(){if(!$(this).hasClass("locked")){$(this).parents("ul").find("li").removeClass("selected");$(this).parents("li").addClass("selected");var b=$(this).attr("data-partgroup"),c=$(this).attr("data-part");WinSpine.currentParts[b]=c;var d=g_parts[WinSpine.currentType].parts[b];
d||(d=g_parts[WinSpine.currentType].macros[b]);if(c=="blank")for(b=0;b<d.length;b++){var e=new Image;e.onload=function(){WinSpine.updateSkeleton()};e.src="ide/imgs/blank.png";WinSpine.textures[d[b]]=e}else for(b=0;b<d.length;b++){e=new Image;e.onload=function(){WinSpine.updateSkeleton()};e.src="ide/avatar/skins/"+WinSpine.currentType+"/"+c+"/"+d[b]+".png";WinSpine.textures[d[b]]=e}}return false},loadCharacter:function(b){WinSpine.textures={};for(var c in g_parts[WinSpine.currentType].parts){var d=
g_parts[WinSpine.currentType].parts[c];if(!WinSpine.currentParts[c]||WinSpine.currentParts[c]=="blank")for(var e=0;e<d.length;e++){var f=new Image;f.onload=function(){WinSpine.updateSkeleton()};f.src="ide/imgs/blank.png";WinSpine.textures[d[e]]=f}else for(e=0;e<d.length;e++){f=new Image;f.onload=function(){WinSpine.updateSkeleton()};f.src="ide/avatar/skins/"+WinSpine.currentType+"/"+WinSpine.currentParts[c]+"/"+d[e]+".png";WinSpine.textures[d[e]]=f}}$.ajax({url:"ide/avatar/rigs/"+WinSpine.currentType+
".json",dataType:"json",success:function(c){var d=new spine.SkeletonJson({newRegionAttachment:function(b,c){var d=new spine.RegionAttachment(c);d.rendererObject=null;d.setUVs(0,0,1,1,false);d.regionOffsetX=0;d.regionOffsetY=0;d.width=d.regionOriginalWidth=d.regionWidth=1;d.height=d.regionOriginalHeight=d.regionHeight=1;return d},newBoundingBoxAttachment:function(b,c){return new spine.BoundingBoxAttachment(c)},newMeshAttachment:function(b,c){return new spine.MeshAttachment(c)},newSkinnedMeshAttachment:function(b,
c){return new spine.SkinnedMeshAttachment(c)}});WinSpine.skeletonData=d.readSkeletonData(c);WinSpine.skeleton=new spine.Skeleton(WinSpine.skeletonData);WinSpine.skeletonBounds=new spine.SkeletonImageBounds;WinSpine.stateData=new spine.AnimationStateData(WinSpine.skeletonData);WinSpine.defaultAnimation=WinSpine.skeletonData.animations[0].name;for(c=0;c<WinSpine.skeletonData.animations.length;c++){var e=WinSpine.skeletonData.animations[c].name;if(e.toLowerCase()=="idle"){WinSpine.defaultAnimation=e;
break}}for(c=0;c<WinSpine.skeletonData.animations.length;c++){e=WinSpine.skeletonData.animations[c].name;if(e!=WinSpine.defaultAnimation){WinSpine.stateData.setMixByName(WinSpine.defaultAnimation,e,0);WinSpine.stateData.setMixByName(e,WinSpine.defaultAnimation,0)}}WinSpine.state=new spine.AnimationState(WinSpine.stateData);WinSpine.state.setAnimationByName(0,WinSpine.defaultAnimation,true,0);WinSpine.skeleton.setSkinByName("default");WinSpine.skeleton.setSlotsToSetupPose();d=$("#win-spine").find(".animations ul");
d.empty();for(c=0;c<WinSpine.skeletonData.animations.length;c++){e=WinSpine.skeletonData.animations[c].name;if(e.toLowerCase()!="idle"&&e.indexOf("Back 3/4")!==0){e=$('<li><a href="#" data-animation="'+e+'">'+e+"</a></li>");e.find("a").click(WinSpine._handleAnimationClick);d.append(e)}}WinSpine.totalTime=0;WinSpine.lastTime=Date.now();WinSpine.updateSkeleton();b&&b()}});return false},_handleAnimationClick:function(){var b=$(this).attr("data-animation");$("#win-spine .animations li a").removeClass("selected");
$(this).addClass("selected");WinSpine.state.setAnimationByName(0,b,false);WinSpine.state.addAnimationByName(0,WinSpine.defaultAnimation,true,0);WinSpine.state.onEnd=function(b){b==1&&$("#win-spine .animations li a").removeClass("selected")};return false},_applySkelBoneTransform:function(b,c){c.parent&&WinSpine._applySkelBoneTransform(b,c.parent);b.translate(c.x,c.y);b.rotate(c.rotation*Math.PI/180);b.scale(c.scaleX,c.scaleY)},updateSkeleton:function(b){if(WinSpine.state){var c=Date.now();WinSpine.state.update((c-
WinSpine.lastTime)/1E3*WinSpine.animationTimeScale);WinSpine.lastTime=c;WinSpine.state.apply(WinSpine.skeleton);WinSpine.skeleton.updateWorldTransform();WinSpine.skeletonBounds.update(WinSpine.skeleton,true);b||(b=$("#win-spine canvas")[0].getContext("2d"));b.mozImageSmoothingEnabled=false;c=WinSpine.currentType=="Tiny"||WinSpine.currentType=="Small"?2:1;b.save();b.clearRect(0,0,b.canvas.width,b.canvas.height);b.translate(b.canvas.width/2,b.canvas.height-100);b.scale(c,-c);for(var c=WinSpine.skeleton.drawOrder,
d=0;d<c.length;d++){var e=c[d],f=e.attachment;if(f){b.save();WinSpine._applySkelBoneTransform(b,e.bone);b.translate(f.x,f.y);b.rotate(f.rotation*Math.PI/180);b.scale(f.scaleX,f.scaleY);b.scale(1,-1);(e=WinSpine.textures[f.name])&&b.drawImage(e,-f.width/2,-f.height/2,f.width,f.height);b.restore()}}b.restore()}},adjustWindow:function(){var b=$("#win-spine"),c=b.height()-b.find(".winspine-header").outerHeight()-b.find(".winspine-footer").outerHeight(),d=b.find(".winspine-content.partschooser").width()-
b.find(".winspine-content .animations").width()-b.find(".partschooser .chooser").outerWidth()-10,e=c;d<e?e=d:d=e;b.find("canvas").width(d).height(e).css("margin-top",(c-e)/2);b.find(".winspine-content").css("height",c);b.find(".animations").css("height",c);b.find(".groups").css("height",c-20);b.find(".parts").css("height",c-20)},showCreator:function(b,c,d){WinSpine._callback=b;var e={},f=$("#win-spine").find(".presetchooser .character-class ul");f.empty();for(var g in g_parts)if(!g_parts[g].alias){if(!WinSpine._defaultType)WinSpine._defaultType=
g;if(g_parts[g].allowed&&g_parts[g].allowed.length>0){var h=null;if(WinSpine.notify&&WinSpine.rewardTypes.indexOf(g)>=0){var j=g_parts[g].group;if(j){if(!e[j]){h=$('<li class="tab" data-group="'+j+'">'+j+' <div class="new-item-tag-small"></div></li>');e[j]=h}}else h=$('<li class="tab" data-type="'+g+'">'+g_parts[g].name+' <div class="new-item-tag-small"></div></li>')}else if(j=g_parts[g].group){if(!e[j]){h=$('<li class="tab" data-group="'+j+'">'+j+"</li>");e[j]=h}}else h=$('<li class="tab" data-type="'+
g+'">'+g_parts[g].name+"</li>");if(h){f.append(h);h.click(WinSpine._handleCategoryClick)}}}if(c){if(g_parts[c].alias)c=g_parts[c].alias;if(g_parts[c].group){WinSpine.selectGroup(g_parts[c].group);WinSpine.currentType=c}else{WinSpine.currentType=c;WinSpine.selectCategory()}}else{WinSpine.currentType=WinSpine._defaultType;WinSpine.selectCategory()}WinSpine.adjustWindow();e=$(".toolbar-top");f=4;!e.hasClass("hidden")&&e.hasClass("big")&&(f=f+(e.offset().top+e.outerHeight()));$("#win-spine .presetchooser").removeClass("hidden");
$("#win-spine .partschooser").addClass("hidden");$("#win-spine").css("top",f).removeClass("hidden");WinSpine.adjustWindow();WinSpine.saveCallback=b;if(c&&d){WinSpine.currentType=c;WinSpine.currentParts=d;if(!WinSpine.notify){WinSpine.selectPreset(d);WinSpine.updateId=window.setInterval(function(){WinSpine.updateSkeleton()},1E3/60)}}},hideCreator:function(){$("#win-spine").addClass("hidden");WinSpine.resetCreator()},resetCreator:function(){},_generatePreview:function(b){var c=document.createElement("canvas");
ctx=c.getContext("2d");ctx.mozImageSmoothingEnabled=false;c.width=128;c.height=128;ctx.save();if(b.type=="Tiny"){ctx.translate(64,-32);ctx.scale(0.25,0.25)}else if(b.type=="Troll"){ctx.translate(64,64);ctx.scale(0.25,0.25)}else if(b.type=="MonsterHighRig"){ctx.translate(64,64);ctx.scale(0.3,0.3)}else{ctx.translate(64,64);ctx.scale(0.125,0.125)}this._drawSkeleton(b,ctx);ctx.restore();return c},_drawSkeleton:function(b,c){if(b.state){c.save();c.translate(0,500);c.scale(1,-1);for(var d=b.skeleton.drawOrder,
e=0;e<d.length;e++){var f=d[e],g=f.attachment;if(g){c.save();WinSpine._applySkelBoneTransform(c,f.bone);c.translate(g.x,g.y);c.rotate(g.rotation*Math.PI/180);c.scale(g.scaleX,g.scaleY);c.scale(1,-1);(f=b.textures[g.name])&&c.drawImage(f,-g.width/2,-g.height/2,g.width,g.height);c.restore()}}c.restore()}},generatePreview:function(b,c,d){if(g_parts[b].alias)b=g_parts[b].alias;var e=this,f={textures:{},type:b,parts:c},g=1,h;for(h in g_parts[f.type].parts)for(var c=g_parts[f.type].parts[h],j=0;j<c.length;j++)g++;
for(h in g_parts[f.type].parts){c=g_parts[f.type].parts[h];if(!f.parts[h]||f.parts[h]=="blank")for(j=0;j<c.length;j++){var k=new Image;k.onload=function(){--g<=0&&d&&d(e._generatePreview(f).toDataURL("image/png"))};k.src=Sprites._blankImg;f.textures[c[j]]=k}else for(j=0;j<c.length;j++){k=new Image;k.onload=function(){e.updateSkeleton();Runtime.stage.draw();--g<=0&&d&&d(e._generatePreview(f).toDataURL("image/png"))};k.src=f.parts[h]=="blank"?Sprites._blankImg:f.parts[h]?"ide/avatar/skins/"+b+"/"+
f.parts[h]+"/"+c[j]+".png":Sprites._blankImg;f.textures[c[j]]=k}}$.ajax({url:"ide/avatar/rigs/"+f.type+".json",dataType:"json",success:function(b){var c=new spine.SkeletonJson({newRegionAttachment:function(b,c){var d=new spine.RegionAttachment(c);d.rendererObject=null;d.setUVs(0,0,1,1,false);d.regionOffsetX=0;d.regionOffsetY=0;d.regionOriginalWidth=d.regionWidth=1;d.regionOriginalHeight=d.regionHeight=1;return d},newBoundingBoxAttachment:function(b,c){return new spine.BoundingBoxAttachment(c)},newMeshAttachment:function(b,
c){return new spine.MeshAttachment(c)},newSkinnedMeshAttachment:function(b,c){return new spine.SkinnedMeshAttachment(c)}});f.skeletonData=c.readSkeletonData(b);f.skeleton=new spine.Skeleton(f.skeletonData);f.stateData=new spine.AnimationStateData(f.skeletonData);f.state=new spine.AnimationState(f.stateData);f.animationName=f.skeletonData.animations[0].name;for(b=0;b<f.skeletonData.animations.length;b++){c=f.skeletonData.animations[b].name;if(c.toLowerCase()=="idle"){f.animationName=c;break}}f.state.setAnimationByName(0,
f.animationName,true);f.skeleton.setSkinByName("default");f.skeleton.setSlotsToSetupPose();f.skeletonBounds=new spine.SkeletonImageBounds;f.state.update(0);f.state.apply(f.skeleton);f.skeleton.updateWorldTransform();f.skeletonBounds.update(f.skeleton,true);--g<=0&&d&&d(e._generatePreview(f).toDataURL("image/png"))}})}},WinPreview={_id:0,init:function(){$("#preview > a").click(function(){WinPreview.hide();return false});WinPreview.adjustWindow()},adjustWindow:function(){$("#preview .content").css("top",
$("#preview h1").outerHeight()+"px");$("#preview iframe").attr("scrolling","no").attr("width",$("#preview .content").innerWidth()-40+"px").attr("height",$("#preview .content").outerHeight()-40+"px")},timedShow:function(b){window.clearTimeout(WinPreview._id);if(b)WinPreview._id=window.setTimeout(function(){WinPreview.show(b)},$("#preview").hasClass("hidden")?2500:250)},show:function(b){$("#preview").removeClass("hidden");WinPreview.adjustWindow();if(b){$("#preview iframe").attr("src","ide/preview?s="+
b).focus();WinPreview._titleId=window.setInterval(function(){var b=$("#preview iframe")[0].contentWindow.document.title;$("#preview h1").text(b)},1E3)}WinPreview.adjustWindow()},hide:function(){window.clearTimeout(WinPreview._id);window.clearInterval(WinPreview._titleId);$("#preview").addClass("hidden");$("#preview iframe").attr("src","blank.html")}},WinPaint={tool:"pencil",toolType:null,fillColor:"#000000",strokeColor:"#000000",selectedColor:"stroke",size:4,transparency:95,stampSize:64,text:"",fontFamily:"Arial",
fontSize:10,fontIsBold:!1,fontIsItalic:!1,fontIsUnderline:!1,canvas:null,context:null,viewport:null,viewportContext:null,overlay:null,overlayContext:null,center:null,centerContext:null,selection:null,selectionContext:null,buffer:null,bufferContext:null,undoLimit:20,undoStack:[],redoIndex:0,dirty:!1,editingUrl:0,editingWidth:0,editingHeight:0,centerVisible:!0,centerX:null,centerY:null,penDown:!1,lastX:0,lastY:0,dropZoneVisible:!1,gridVisible:!0,resizeHandleSize:6,growFactor:1.1,shrinkFactor:0.9,rotateLeverSize:6,
brushBristles:[],brushNumberBristles:20,brushRefreshRate:15,brushEasing:0.7,proportionalResize:!0,viewportX:0,viewportY:0,zoomLevel:1,minZoomLevel:0.0625,maxZoomLevel:16,viewportWidth:480,viewportHeight:320,discardMoveTolerance:15,init:function(){WinPaint.canvas=document.createElement("canvas");WinPaint.context=WinPaint.canvas.getContext("2d");WinPaint.viewport=document.createElement("canvas");WinPaint.viewportContext=WinPaint.viewport.getContext("2d");WinPaint.overlay=document.createElement("canvas");
WinPaint.overlayContext=WinPaint.overlay.getContext("2d");WinPaint.selection=document.createElement("canvas");WinPaint.selectionContext=WinPaint.selection.getContext("2d");WinPaint.center=document.createElement("canvas");WinPaint.centerContext=WinPaint.center.getContext("2d");WinPaint.buffer=document.createElement("canvas");WinPaint.bufferContext=WinPaint.buffer.getContext("2d");WinPaint.mask=document.createElement("canvas");WinPaint.maskContext=WinPaint.mask.getContext("2d");$("#win-paint .canvas").append(WinPaint.canvas);
$("#win-paint .canvas").append(WinPaint.viewport);$("#win-paint .canvas").append(WinPaint.overlay);$("#win-paint .canvas").append(WinPaint.selection);$("#win-paint .canvas").append('<div id="drop-zone" class="hidden"><p>'+g_loc.getText("paint.drop_zone")+"</p></div>");$("#win-paint .canvas").append(WinPaint.center);$("#win-paint .canvas").append(WinPaint.buffer);$("#win-paint .canvas").append(WinPaint.mask);$(WinPaint.canvas).addClass("hidden");$(WinPaint.selection).addClass("hidden");$(WinPaint.buffer).addClass("hidden");
$("#win-paint .tool-options .pencil li").each(function(b,c){var f=$(c).attr("radius");$(c).find("div").css("border-radius",Math.floor(f/2)).css("width",f).css("height",f)});$("#win-paint .tool-options .pencil .oval li").each(function(b,c){$(c).attr("type");var f=$(c).attr("radius");$(c).find("div").css("border-radius",Math.floor(f/2)).css("width",f).css("height",f*0.5)});$("#win-paint .tool-options .pencil .pen li").each(function(b,c){var f=$(c).attr("size");$(c).find("div").css("width",f).css("height",
f)});ColorPicker.init("#win-paint");for(var b=0;b<WinPaint.brushNumberBristles;b++){var c=Math.random()*0.05+WinPaint.brushEasing;WinPaint.brushBristles.push({dx:WinPaint.canvas.width/2,dy:WinPaint.canvas.height/2,ax:0,ay:0,div:0.1,ease:c})}$("#win-paint .edit-menu").click(WinPaint.cmdEditMenu);$("#win-paint .edit ul li a").click(WinPaint.cmdSelectEditMenuOption);$("#win-paint .zoom ul li").click(WinPaint.cmdSelectZoomOption);$("#win-paint .font-family").click(WinPaint.cmdChooseFontFamily);$("#win-paint .font-family").next().find("a").click(WinPaint.cmdSelectFontFamily);
$("#win-paint .font-size").click(WinPaint.cmdChooseFontSize);$("#win-paint .font-size").next().find("a").click(WinPaint.cmdSelectFontSize);$("#win-paint .font-style.bold").click(WinPaint.cmdToggleBold);$("#win-paint .font-style.italic").click(WinPaint.cmdToggleItalic);$("#win-paint .font-style.underline").click(WinPaint.cmdToggleUnderline);$("#win-paint .pencilsize").click(WinPaint.cmdChoosePencilSize);$("#win-paint .brushsize").click(WinPaint.cmdChooseBrushSize);$("#win-paint .stampsize").click(WinPaint.cmdChooseStamp);
$("#win-paint .fillcolor").click(WinPaint.cmdChooseFillColor);$("#win-paint .strokecolor").click(WinPaint.cmdChooseStrokeColor);$("#win-paint .color-predefined").mouseover(function(){$(".color-tray",this).show()});$("#win-paint .color-predefined").mouseleave(function(){$(".color-tray",this).hide()});$("#win-paint .color-predefined li").click(WinPaint.cmdChoosePredefinedColor);$("#win-paint .tool-color").click(WinPaint.cmdChooseColor);$("#win-paint .tool-eyedropper").click(WinPaint.cmdToolColor);$("#win-paint li.selection-type").click(WinPaint.cmdChooseSelectionType);
$("#win-paint li.cut").click(WinPaint.cmdCut);$("#win-paint li.copy").click(WinPaint.cmdCopy);$("#win-paint li.paste").click(WinPaint.cmdPaste);$("#win-paint li.flip-horizontally").click(WinPaint.cmdFlipHorizontally);$("#win-paint li.flip-vertically").click(WinPaint.cmdFlipVertically);$("#win-paint li.grow").click(WinPaint.cmdGrow);$("#win-paint li.shrink").click(WinPaint.cmdShrink);$("#win-paint li.zoom-type").click(WinPaint.cmdChooseZoomType);$("#win-paint li.undo").click(WinPaint.cmdUndo);$("#win-paint li.redo").click(WinPaint.cmdRedo);
$("#win-paint .tool-pencil").click(WinPaint.cmdToolPencil);$("#win-paint .tool-brush").click(WinPaint.cmdToolBrush);$("#win-paint .tool-eraser").click(WinPaint.cmdToolEraser);$("#win-paint .tool-fill").click(WinPaint.cmdToolFill);$("#win-paint .tool-shape").click(WinPaint.cmdToolShape);$("#win-paint .tool-rectangle").click(WinPaint.cmdToolRectangle);$("#win-paint .tool-filledrectangle").click(WinPaint.cmdToolFilledRectangle);$("#win-paint .tool-ellipse").click(WinPaint.cmdToolEllipse);$("#win-paint .tool-filledellipse").click(WinPaint.cmdToolFilledEllipse);
$("#win-paint .tool-line").click(WinPaint.cmdToolLine);$("#win-paint .tool-text").click(WinPaint.cmdToolText);$("#win-paint .tool-selection").click(WinPaint.cmdToolSelection);$("#win-paint .tool-stamp").click(WinPaint.cmdToolStamp);$("#win-paint .tool-center").click(WinPaint.cmdToolCenter);$("#win-paint .pencil li").click(WinPaint.cmdChoosePredefinedPencilSize);$("#win-paint .pencil .oval li").click(WinPaint.cmdChoosePredefinedBrushSize);$("#win-paint .pencil .pen li").click(WinPaint.cmdChoosePredefinedPenSize);
$("#win-paint .centertool li").click(WinPaint.cmdCenter);$("#win-paint .pencil .slider").slider({min:1,max:40,value:WinPaint.size,slide:function(){WinPaint.size=$("#win-paint .pencil .slider").slider("value");$("#win-paint .pencil .pencilsize span").css("border-radius",Math.floor(WinPaint.size/2)).css("width",WinPaint.size).css("height",WinPaint.size);$("#win-paint .pencil .showsize div").css("border-radius",Math.floor(WinPaint.size/2)).css("width",WinPaint.size).css("height",WinPaint.size);$("#win-paint .pencil .size").text(WinPaint.size)},
change:function(){WinPaint.size=$("#win-paint .pencil .slider").slider("value");$("#win-paint .pencil .pencilsize span").css("border-radius",Math.floor(WinPaint.size/2)).css("width",WinPaint.size).css("height",WinPaint.size);$("#win-paint .pencil .showsize div").css("border-radius",Math.floor(WinPaint.size/2)).css("width",WinPaint.size).css("height",WinPaint.size);$("#win-paint .pencil .pencilsize").next().addClass("hidden");$("#win-paint .pencil .size").text(WinPaint.size)}});$("#win-paint .pencil .size").text(WinPaint.size);
WinPaint.transparency=95;$("#win-paint .brush .slider").slider({min:0,max:100,value:WinPaint.transparency,slide:function(){WinPaint.transparency=$("#win-paint .brush .slider").slider("value");$("#win-paint .brush .size").text(WinPaint.transparency+"%")},change:function(){WinPaint.transparency=$("#win-paint .brush .slider").slider("value");$("#win-paint .brush .size").text(WinPaint.transparency+"%")}});$("#win-paint .brush .size").text(WinPaint.transparency+"%");WinPaint.stampImg=new Image;$("#win-paint .stamp .slider").slider({min:8,
max:128,value:WinPaint.stampSize,slide:function(){WinPaint.stampSize=$("#win-paint .stamp .slider").slider("value");$("#win-paint .stamp .size").text(WinPaint.stampSize)},change:function(){WinPaint.stampSize=$("#win-paint .stamp .slider").slider("value");$("#win-paint .stamp .size").text(WinPaint.stampSize)}});$("#win-paint .stamp .slider").slider("value",WinPaint.stampSize);$("#win-paint .tools li.tool-shape").mouseenter(function(){$(this).find("div").removeClass("hidden")}).mouseleave(function(){$(this).find("div").addClass("hidden")}).find("div").mouseleave(function(){$(this).find("div").addClass("hidden")});
$("#win-paint h1 a.close").click(function(){$("#win-paint").addClass("hidden");return false});$(WinPaint.mask).mousedown(WinPaint._mousedown);$(WinPaint.mask).mouseup(WinPaint._mouseup);$(WinPaint.mask).mouseenter(WinPaint._mouseenter);$(WinPaint.mask).mousemove(WinPaint._mousemove);$(WinPaint.mask).bind("mouseleave",WinPaint._mouseup);$(WinPaint.mask).bind("dragover",WinPaint._dragover);$(WinPaint.mask).bind("dragleave",WinPaint._dragleave);$(WinPaint.mask).bind("drop",WinPaint._drop);$(WinPaint.mask).bind("mousewheel",
WinPaint._onScroll).bind("DOMMouseScroll",WinPaint._onScroll);$("#import-image-file").change(WinPaint._change);WinPaint.resetTools();WinPaint.adjustWindow();window.WinSVGPaint&&window.WinSVGPaint.init()},resetTools:function(){WinPaint.updateToggleCenterText();WinPaint.text="";WinPaint.fontFamily="Arial";$("#win-paint .font-family span").text(WinPaint.fontFamily);WinPaint.fontSize=30;$("#win-paint .font-size span").text(WinPaint.fontSize);WinPaint.fontIsBold=false;WinPaint.fontIsItalic=false;WinPaint.fontIsUnderline=
false;$("#win-paint .font-style").removeClass("selected");WinPaint.size=4;$("#win-paint .pencilsize span").css("border-radius",Math.floor(WinPaint.size/2)).css("width",WinPaint.size).css("height",WinPaint.size);$("#win-paint .brushsize span").css("border-radius",Math.floor(WinPaint.size/2)).css("width",WinPaint.size).css("height",WinPaint.size);WinPaint.transparency=95;$("#win-paint .pensize span").css("width",WinPaint.size).css("height",WinPaint.size);WinPaint.selectedColor="stroke";WinPaint.strokeColor=
"#000000";$("#win-paint .strokecolor").addClass("selected").find("> div").css("border","4px solid "+WinPaint.strokeColor);WinPaint.fillColor="#0000ff";$("#win-paint .fillcolor").removeClass("selected").find("> div").css("background-color",WinPaint.fillColor);WinPaint.cmdToolPencil();WinPaint.context.strokeStyle=WinPaint.strokeColor;WinPaint.context.fillStyle=WinPaint.fillColor;WinPaint.context.lineWidth=WinPaint.size;WinPaint.context.lineCap="round";WinPaint.viewportContext.imageSmoothingEnabled=
false;WinPaint.viewportContext.mozImageSmoothingEnabled=false;WinPaint.viewportContext.webkitImageSmoothingEnabled=false;WinPaint.selectionContext.imageSmoothingEnabled=false;WinPaint.selectionContext.mozImageSmoothingEnabled=false;WinPaint.selectionContext.webkitImageSmoothingEnabled=false;WinPaint.overlayContext.imageSmoothingEnabled=false;WinPaint.overlayContext.mozImageSmoothingEnabled=false;WinPaint.overlayContext.webkitImageSmoothingEnabled=false;WinPaint.zoomTo(1);WinPaint.undoClear()},_editImage:function(b){if(WinPaint.editingWidth>
WinPaint.canvas.width){WinPaint.canvas.width=WinPaint.editingWidth;$(WinPaint.canvas).css("width",WinPaint.editingWidth)}else if(WinPaint.editingWidth<=Runtime.stage.getWidth()){WinPaint.editingWidth=Runtime.stage.getWidth();WinPaint.canvas.width=WinPaint.editingWidth;$(WinPaint.canvas).css("width",WinPaint.canvas.width)}if(WinPaint.editingHeight>WinPaint.canvas.height){WinPaint.canvas.height=WinPaint.editingHeight;$(WinPaint.canvas).css("height",WinPaint.editingHeight)}else if(WinPaint.editingHeight<=
Runtime.stage.getHeight()){WinPaint.editingHeight=Runtime.stage.getHeight();WinPaint.canvas.height=WinPaint.editingHeight;$(WinPaint.canvas).css("height",WinPaint.canvas.height)}WinPaint.context.drawImage(b,(WinPaint.canvas.width-b.width)/2,(WinPaint.canvas.height-b.height)/2);var c=WinPaint.findBounds();WinPaint.centerX=WinPaint.centerX===void 0||WinPaint.centerX===null?Math.floor(c.left+(c.right-c.left)/2):(WinPaint.canvas.width-b.width)/2+WinPaint.centerX;WinPaint.centerY=WinPaint.centerY===void 0||
WinPaint.centerY===null?Math.floor(c.top+(c.bottom-c.top)/2):(WinPaint.canvas.height-b.height)/2+WinPaint.centerY;WinPaint.adjustWindow();WinPaint.viewportX=-($("#win-paint div.canvas").innerWidth()-WinPaint.editingWidth)/2;WinPaint.viewportY=-($("#win-paint div.canvas").innerHeight()-WinPaint.editingHeight)/2;WinPaint.updateViewport()},hide:function(){$("#win-paint").addClass("hidden");window.WinSVGPaint&&window.WinSVGPaint.hide()},edit:function(b,c,d,e,f){if(window.WinSVGPaint&&c&&c.indexOf(".svg")>
0)WinSVGPaint.edit(b,c,d,e,f);else{var g=$("#win-paint ul.stampoptions");if(g.children().length==0){for(var h=["b_8ball","b_alien","b_apple","b_balloon","b_bird","b_butterfly","b_butterfly2","b_candy","b_clover","b_cupcake","b_disco","b_fish2","b_flower","b_flower2","b_football","b_heart","b_invader1","b_ladybug","b_octopus","b_pirateflag2","b_pirate-flag","b_planet","b_puffer","b_raindrop","b_robot1","b_robot2","b_rocket","b_trex","b_turtle","b_ufo","b_unicorn","b_wheel"],j=0;j<h.length;j++)g.append('<li type="stampoption"><img src="imgs/paint/brushes/'+
h[j]+'.png" /></li>');g.find("li").click(WinPaint.cmdChoosePredefinedStamp)}$("#win-paint").removeClass("hidden");g=window.innerWidth;h=window.innerHeight;g<Runtime.stage.getWidth()&&(g=Runtime.stage.getWidth());h<Runtime.stage.getHeight()&&(h=Runtime.stage.getHeight());WinPaint.viewportWidth=g;WinPaint.viewportHeight=h;if(c){WinPaint.editingUrl=c;WinPaint.editingWidth=0;WinPaint.editingHeight=0;WinPaint.canvas.width=g;WinPaint.canvas.height=h;$(WinPaint.canvas).css("width",g).css("height",h);WinPaint.viewport.width=
g;WinPaint.viewport.height=h;$(WinPaint.viewport).css("width",g).css("height",h);WinPaint.overlay.width=g;WinPaint.overlay.height=h;$(WinPaint.overlay).css("width",g).css("height",h);WinPaint.selection.width=g;WinPaint.selection.height=h;$(WinPaint.selection).css("width",g).css("height",h);WinPaint.center.width=g;WinPaint.center.height=h;$(WinPaint.center).css("width",g).css("height",h);WinPaint.buffer.width=g;WinPaint.buffer.height=h;$(WinPaint.buffer).css("width",g).css("height",h);WinPaint.mask.width=
g;WinPaint.mask.height=h;$(WinPaint.mask).css("width",g).css("height",h);var k=new Image;k.onload=function(){WinPaint.editingWidth=k.width;WinPaint.editingHeight=k.height;WinPaint.resetTools();WinPaint._editImage(k);WinPaint.addUndo()};k.src=c}else{WinPaint.editingWidth=Runtime.stage.getWidth();WinPaint.editingHeight=Runtime.stage.getHeight();WinPaint.canvas.width=WinPaint.editingWidth;WinPaint.canvas.height=WinPaint.editingHeight;$(WinPaint.canvas).css("width",WinPaint.editingWidth).css("height",
WinPaint.editingHeight);WinPaint.viewport.width=g;WinPaint.viewport.height=h;$(WinPaint.viewport).css("width",g).css("height",h);WinPaint.overlay.width=g;WinPaint.overlay.height=h;$(WinPaint.overlay).css("width",g).css("height",h);WinPaint.selection.width=g;WinPaint.selection.height=h;$(WinPaint.selection).css("width",g).css("height",h);WinPaint.center.width=g;WinPaint.center.height=h;$(WinPaint.center).css("width",g).css("height",h);WinPaint.buffer.width=g;WinPaint.buffer.height=h;$(WinPaint.buffer).css("width",
g).css("height",h);WinPaint.mask.width=g;WinPaint.mask.height=h;$(WinPaint.mask).css("width",g).css("height",h);WinPaint.resetTools();WinPaint.addUndo()}WinPaint.doneCallback=f;b||(b="Paint");WinPaint.clearCanvas(false);WinPaint.centerX=d;WinPaint.centerY=e;WinPaint.centerChanged=false;$("#win-paint .save").unbind().click(function(){(WinPaint.redoIndex>1||WinPaint.centerChanged)&&WinPaint.save();$("#win-paint").addClass("hidden");return false});$("#win-paint .exit").unbind().click(function(){if(WinPaint.redoIndex>
1||WinPaint.centerChanged){IDE.confirmDialog("There are changes to the image. Do you want to discard your changes?",function(){$("#win-paint").addClass("hidden")},"Discard Changes","Cancel",function(){});$("#confirm").modal()}else $("#win-paint").addClass("hidden");return false});WinPaint.adjustWindow();WinPaint.viewportX=-($("#win-paint div.canvas").innerWidth()-WinPaint.editingWidth)/2;WinPaint.viewportY=-($("#win-paint div.canvas").innerHeight()-WinPaint.editingHeight)/2;WinPaint.updateViewport();
return false}},save:function(){WinPaint._commit();var b=WinPaint.findBounds();if(WinPaint.centerX===void 0||WinPaint.centerX===null||WinPaint.centerY===void 0||WinPaint.centerY===null){WinPaint.centerX=Math.floor(b.left+(b.right-b.left)/2);WinPaint.centerY=Math.floor(b.top+(b.bottom-b.top)/2)}if(b.left>b.right){b.left=0;b.right=0;WinPaint.centerX=0}else WinPaint.centerX=Math.floor(WinPaint.centerX-b.left);if(b.top>b.bottom){b.top=0;b.bottom=0;WinPaint.centerY=0}else WinPaint.centerY=Math.floor(WinPaint.centerY-
b.top);var c=document.createElement("canvas"),d=c.getContext("2d");c.width=b.right-b.left+1;c.height=b.bottom-b.top+1;b=WinPaint.context.getImageData(b.left,b.top,b.right-b.left+1,b.bottom-b.top+1);d.putImageData(b,0,0);if(WinPaint.dirty){WinPaint.dirty=false;c=c.toDataURL();c="d="+encodeURIComponent(c)+"&t=drawing";WinPaint.mediaId&&(c=c+("&i="+encodeURIComponent(WinPaint.mediaId)));$.ajax({url:"api/medialibsave.aspx",type:"POST",data:c,success:function(b){b=JSON.parse(b);if(b.result)WinPaint.mediaId=
b.id;WinPaint.doneCallback&&WinPaint.doneCallback("/assets/user/"+WinPaint.mediaId+".png",WinPaint.centerX,WinPaint.centerY)}})}else WinPaint.editingUrl&&WinPaint.doneCallback&&WinPaint.doneCallback(WinPaint.editingUrl,WinPaint.centerX,WinPaint.centerY);$("#win-paint").addClass("hidden");return false},adjustWindow:function(){},_mousedown:function(b){$("#win-paint .menu").addClass("hidden");ColorPicker.hide();WinPaint.penDown=true;var c=b.pageX-$(WinPaint.viewport).offset().left,b=b.pageY-$(WinPaint.viewport).offset().top;
WinPaint.context.save();WinPaint.context.translate(WinPaint.viewportX,WinPaint.viewportY);WinPaint.context.scale(1/WinPaint.zoomLevel,1/WinPaint.zoomLevel);if(WinPaint.tool=="pencil"&&WinPaint.toolType=="oval"){WinPaint.dirty=true;for(var d=0;d<WinPaint.brushBristles.length;d++){WinPaint.brushBristles[d].ax=0;WinPaint.brushBristles[d].ay=0;WinPaint.brushBristles[d].dx=c;WinPaint.brushBristles[d].dy=b}WinPaint.brushInterval=window.setInterval(WinPaint._updateBrush,WinPaint.brushRefreshRate)}else if(WinPaint.tool==
"pencil"){WinPaint.dirty=true;WinPaint.context.lineCap="round";WinPaint.context.lineWidth=WinPaint.size*WinPaint.zoomLevel;WinPaint.context.strokeStyle=WinPaint.strokeColor;WinPaint.context.beginPath();WinPaint.context.moveTo(c,b);WinPaint.context.lineTo(c+1,b);WinPaint.context.stroke()}else if(WinPaint.tool=="brush"){WinPaint.dirty=true;WinPaint.context.lineCap="round";WinPaint.context.lineWidth=WinPaint.size*WinPaint.zoomLevel;d=parseColor(WinPaint.strokeColor);WinPaint.context.strokeStyle="rgba("+
d.r+","+d.g+","+d.b+","+(1-WinPaint.transparency/100)+")";WinPaint.context.beginPath();WinPaint.context.moveTo(c,b);WinPaint.context.lineTo(c+1,b);WinPaint.context.stroke()}else if(WinPaint.tool=="stamp"){WinPaint.dirty=true;var d=WinPaint.stampImg.width*WinPaint.stampSize/WinPaint.stampImg.width*WinPaint.zoomLevel,e=WinPaint.stampImg.height*WinPaint.stampSize/WinPaint.stampImg.width*WinPaint.zoomLevel;WinPaint.context.drawImage(WinPaint.stampImg,c-d/2,b-e/2,d,e)}else if(WinPaint.tool=="pen"){WinPaint.dirty=
true;WinPaint.context.restore();WinPaint.context.fillStyle=WinPaint.strokeColor;d=b/WinPaint.zoomLevel+WinPaint.viewportY;WinPaint.context.fillRect(Math.round(c/WinPaint.zoomLevel+WinPaint.viewportX-WinPaint.size/2),Math.round(d-WinPaint.size/2),WinPaint.size,WinPaint.size)}else if(WinPaint.tool=="colorpicker"){$("#win-paint .tool-eyedropper").removeClass("selected");WinPaint.tool=WinPaint.lastTool;c=c/WinPaint.zoomLevel+WinPaint.viewportX;b=b/WinPaint.zoomLevel+WinPaint.viewportY;d=WinPaint.context.getImageData(c,
b,1,1);d="rgb("+d.data[0]+","+d.data[1]+","+d.data[2]+")";if(WinPaint.selectedColor=="fill"){$("#win-paint .fillcolor > div").css("background-color",d);WinPaint.fillColor=d}else if(WinPaint.selectedColor=="stroke"){$("#win-paint .strokecolor > div").css("border","4px solid "+d);WinPaint.strokeColor=d}}else if(WinPaint.tool=="text"){WinPaint.dirty=true;WinPaint.context.restore();WinPaint._commit();WinPaint.text="";WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);
WinPaint.overlayContext.strokeStyle=WinPaint.strokeColor;WinPaint.overlayContext.lineWidth=2;WinPaint.overlayContext.beginPath();WinPaint.overlayContext.moveTo(c,b);WinPaint.overlayContext.lineTo(c,b-WinPaint.fontSize*WinPaint.zoomLevel);WinPaint.overlayContext.closePath();WinPaint.overlayContext.stroke()}else if(WinPaint.tool=="move"){$(WinPaint.selection).addClass("hidden");switch(WinPaint.getSelectionLocation(c,b)){case "rotation_lever":WinPaint.rotationAngle=0;WinPaint.tool="rotate";break;case "nw_corner":WinPaint.tool=
"nw-resize";break;case "ne_corner":WinPaint.tool="ne-resize";break;case "se_corner":WinPaint.tool="se-resize";break;case "sw_corner":WinPaint.tool="sw-resize";break;case "n_edge":WinPaint.tool="n-resize";break;case "e_edge":WinPaint.tool="e-resize";break;case "w_edge":WinPaint.tool="w-resize";break;case "s_edge":WinPaint.tool="s-resize";break;case "outside":WinPaint.context.restore();WinPaint._commit()}}else if(WinPaint.tool=="selection"||WinPaint.tool=="cut"||WinPaint.tool=="copy"||WinPaint.tool==
"paste"||WinPaint.tool=="stamp-selection"){if(WinPaint.toolType=="lasso"){WinPaint.dirty=true;WinPaint.overlayContext.lineCap="round";WinPaint.overlayContext.lineWidth=1;WinPaint.overlayContext.strokeStyle="#333";WinPaint.overlayContext.beginPath();WinPaint.overlayContext.moveTo(c,b);WinPaint.overlayContext.lineTo(c+1,b);WinPaint.overlayContext.stroke();WinPaint.lassoPathPoints=[{x:c,y:b}]}}else if(WinPaint.tool=="zoom"&&WinPaint.toolType=="zoom-in"){e=WinPaint.viewportY+(b-WinPaint.viewportHeight/
2/2)/WinPaint.zoomLevel;d=Math.max(WinPaint.viewportX+(c-WinPaint.viewportWidth/2/2)/WinPaint.zoomLevel,0);e=Math.max(e,0);WinPaint.zoomIn(d,e);if(WinPaint.zoomLevel>=WinPaint.maxZoomLevel){WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.toolType="zoom-out";$("#win-paint .zoom ul li.zoom-type").removeClass("selected");$("#win-paint .zoom ul li.zoom-type."+WinPaint.toolType).addClass("selected")}}else if(WinPaint.tool=="zoom"&&WinPaint.toolType=="zoom-out"){WinPaint.zoomOut();
if(WinPaint.zoomLevel<=WinPaint.minZoomLevel){WinPaint.toolType="zoom-in";$("#win-paint .zoom ul li.zoom-type").removeClass("selected");$("#win-paint .zoom ul li.zoom-type."+WinPaint.toolType).addClass("selected")}}else if(WinPaint.tool=="center"){WinPaint.centerX=Math.round(c/WinPaint.zoomLevel+WinPaint.viewportX);WinPaint.centerY=Math.round(b/WinPaint.zoomLevel+WinPaint.viewportY)}WinPaint.lastX=c;WinPaint.lastY=b;WinPaint.context.restore();WinPaint.updateViewport()},_mouseup:function(b){if(!WinPaint.penDown)return false;
WinPaint.penDown=false;var c=b.pageX-$(WinPaint.viewport).offset().left,b=b.pageY-$(WinPaint.viewport).offset().top;WinPaint.checkDiscardableMove(c,b);WinPaint.context.save();WinPaint.context.translate(WinPaint.viewportX,WinPaint.viewportY);WinPaint.context.scale(1/WinPaint.zoomLevel,1/WinPaint.zoomLevel);if(WinPaint.tool=="pencil"&&WinPaint.toolType=="oval"){window.clearInterval(WinPaint.brushInterval);WinPaint.addUndo()}else if(WinPaint.tool=="pencil")WinPaint.addUndo();else if(WinPaint.tool=="eraser")WinPaint.addUndo();
else if(WinPaint.tool=="brush")WinPaint.addUndo();else if(WinPaint.tool=="pen")WinPaint.addUndo();else if(WinPaint.tool=="stamp")WinPaint.addUndo();else if(WinPaint.tool=="line"&&!WinPaint.isDiscardableMove){WinPaint.dirty=true;var d=WinPaint.size*WinPaint.zoomLevel;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.lineCap="round";WinPaint.overlayContext.lineWidth=d;WinPaint.overlayContext.strokeStyle=WinPaint.strokeColor;WinPaint.overlayContext.beginPath();
WinPaint.overlayContext.moveTo(WinPaint.lastX,WinPaint.lastY);WinPaint.overlayContext.lineTo(c,b);WinPaint.overlayContext.stroke();var e=Math.min(WinPaint.lastX,c)-d,f=Math.min(WinPaint.lastY,b)-d,c=Math.max(WinPaint.lastX,c)+d,b=Math.max(WinPaint.lastY,b)+d;WinPaint.selectionX=e;WinPaint.selectionY=f;WinPaint.selectionWidth=c-e+1;WinPaint.selectionHeight=b-f+1;WinPaint.selectionContext.drawImage(WinPaint.overlay,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight,
0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.tool="move";WinPaint.toolType="move-line"}else if((WinPaint.tool=="rectangle"||WinPaint.tool=="filledrectangle")&&!WinPaint.isDiscardableMove){WinPaint.dirty=true;d=WinPaint.size*WinPaint.zoomLevel;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.lineCap="round";WinPaint.overlayContext.lineWidth=d;WinPaint.overlayContext.strokeStyle=WinPaint.strokeColor;
WinPaint.overlayContext.fillStyle=WinPaint.fillColor;WinPaint.overlayContext.beginPath();var e=Math.min(WinPaint.lastX,c),f=Math.min(WinPaint.lastY,b),g=Math.abs(WinPaint.lastX-c),h=Math.abs(WinPaint.lastY-b);WinPaint.overlayContext.rect(e,f,g,h);WinPaint.tool=="filledrectangle"&&WinPaint.fillColor!="none"&&WinPaint.overlayContext.fill();WinPaint.overlayContext.stroke();b=e-d;c=f-d;WinPaint.selectionX=b;WinPaint.selectionY=c;WinPaint.selectionWidth=e+g+d-b+1;WinPaint.selectionHeight=f+h+d-c+1;WinPaint.selectionContext.drawImage(WinPaint.overlay,
WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.toolType=WinPaint.tool=="filledrectangle"?"move-filledrectangle":"move-rectangle";WinPaint.tool="move"}else if((WinPaint.tool=="ellipse"||WinPaint.tool=="filledellipse")&&!WinPaint.isDiscardableMove){WinPaint.dirty=true;d=WinPaint.size*WinPaint.zoomLevel;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);
WinPaint.overlayContext.lineCap="round";WinPaint.overlayContext.lineWidth=d;WinPaint.overlayContext.strokeStyle=WinPaint.strokeColor;WinPaint.overlayContext.fillStyle=WinPaint.fillColor;WinPaint.overlayContext.beginPath();var e=Math.min(WinPaint.lastX,c),f=Math.min(WinPaint.lastY,b),g=Math.abs(WinPaint.lastX-c),h=Math.abs(WinPaint.lastY-b),j=Math.max(g,h),k=g/j,l=h/j;WinPaint.overlayContext.save();WinPaint.overlayContext.translate((WinPaint.lastX+c)/2,(WinPaint.lastY+b)/2);WinPaint.overlayContext.scale(k,
l);WinPaint.overlayContext.beginPath();WinPaint.overlayContext.arc(0,0,j/2,0,Math.PI*2,false);WinPaint.overlayContext.closePath();WinPaint.overlayContext.restore();WinPaint.tool=="filledellipse"&&WinPaint.fillColor!="none"&&WinPaint.overlayContext.fill();WinPaint.overlayContext.stroke();b=e-d;c=f-d;WinPaint.selectionX=b;WinPaint.selectionY=c;WinPaint.selectionWidth=e+g+d-b+1;WinPaint.selectionHeight=f+h+d-c+1;WinPaint.selectionContext.drawImage(WinPaint.overlay,WinPaint.selectionX,WinPaint.selectionY,
WinPaint.selectionWidth,WinPaint.selectionHeight,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.toolType=WinPaint.tool=="filledellipse"?"move-filledellipse":"move-ellipse";WinPaint.tool="move";WinPaint.addUndo()}else if(WinPaint.tool!="move")if((WinPaint.tool=="selection"||WinPaint.tool=="cut"||WinPaint.tool=="copy"||WinPaint.tool=="paste"||WinPaint.tool=="stamp-selection")&&!WinPaint.isDiscardableMove){WinPaint.dirty=true;c=parseInt(c);b=parseInt(b);
WinPaint.lastX=parseInt(WinPaint.lastX);WinPaint.lastY=parseInt(WinPaint.lastY);var e=Math.min(WinPaint.lastX,c),f=Math.min(WinPaint.lastY,b),d=Math.abs(WinPaint.lastX-c)+1,g=Math.abs(WinPaint.lastY-b)+1,m=Math.floor(e/WinPaint.zoomLevel+WinPaint.viewportX),n=Math.floor(f/WinPaint.zoomLevel+WinPaint.viewportY),q=Math.ceil(d/WinPaint.zoomLevel),p=Math.ceil(g/WinPaint.zoomLevel),e=(m-WinPaint.viewportX)*WinPaint.zoomLevel,f=(n-WinPaint.viewportY)*WinPaint.zoomLevel,d=q*WinPaint.zoomLevel,g=p*WinPaint.zoomLevel;
WinPaint.selectionX=e;WinPaint.selectionY=f;WinPaint.selectionWidth=d;WinPaint.selectionHeight=g;WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);if(WinPaint.toolType!="rectangle")if(WinPaint.toolType=="ellipse"){j=Math.max(WinPaint.selectionWidth,WinPaint.selectionHeight);k=WinPaint.selectionWidth/j;l=WinPaint.selectionHeight/j;WinPaint.selectionContext.save();WinPaint.selectionContext.translate((WinPaint.lastX+
c)/2-WinPaint.selectionX,(WinPaint.lastY+b)/2-WinPaint.selectionY);WinPaint.selectionContext.scale(k,l);WinPaint.selectionContext.beginPath();WinPaint.selectionContext.arc(0,0,j/2,0,Math.PI*2,false);WinPaint.selectionContext.restore();WinPaint.selectionContext.save();WinPaint.selectionContext.clip();WinPaint.overlayContext.save();WinPaint.overlayContext.translate((WinPaint.lastX+c)/2,(WinPaint.lastY+b)/2);WinPaint.overlayContext.scale(k,l);WinPaint.overlayContext.beginPath();WinPaint.overlayContext.arc(0,
0,j/2,0,Math.PI*2,false);WinPaint.overlayContext.stroke();WinPaint.overlayContext.restore()}else if(WinPaint.toolType=="lasso"){WinPaint.lassoPathPoints.push({x:c,y:b});f=e=c;k=j=b;WinPaint.overlayContext.beginPath();for(h in WinPaint.lassoPathPoints){l=WinPaint.lassoPathPoints[h];WinPaint.overlayContext.lineTo(l.x,l.y);e=Math.min(e,l.x);f=Math.max(f,l.x);j=Math.min(j,l.y);k=Math.max(k,l.y)}WinPaint.overlayContext.closePath();WinPaint.overlayContext.stroke();d=Math.abs(f-e)+1;g=Math.abs(k-j)+1;WinPaint.selectionX=
e;WinPaint.selectionY=j;WinPaint.selectionWidth=Math.abs(f-e)+1;WinPaint.selectionHeight=Math.abs(k-j)+1;WinPaint.selectionContext.save();WinPaint.selectionContext.translate(-WinPaint.selectionX,-WinPaint.selectionY);WinPaint.selectionContext.beginPath();for(h in WinPaint.lassoPathPoints){l=WinPaint.lassoPathPoints[h];WinPaint.selectionContext.lineTo(l.x,l.y)}WinPaint.selectionContext.restore();WinPaint.selectionContext.save();WinPaint.selectionContext.clip()}WinPaint.selectionContext.drawImage(WinPaint.canvas,
m,n,q,p,0,0,d,g);WinPaint.selectionContext.restore();WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();if(WinPaint.tool=="stamp-selection")WinPaint.tool="stamp";else{if(WinPaint.toolType=="rectangle")WinPaint.context.save();else if(WinPaint.toolType=="ellipse"){g=Math.abs(WinPaint.lastX-c)+1;h=Math.abs(WinPaint.lastY-b)+1;
j=Math.max(g,h);k=g/j;l=h/j;WinPaint.context.save();WinPaint.context.translate((WinPaint.lastX+c)/2,(WinPaint.lastY+b)/2);WinPaint.context.scale(k,l);WinPaint.context.beginPath();WinPaint.context.arc(0,0,j/2,0,Math.PI*2,false);WinPaint.context.restore();WinPaint.context.save();WinPaint.context.clip()}else if(WinPaint.toolType=="lasso"){WinPaint.context.beginPath();for(h in WinPaint.lassoPathPoints){l=WinPaint.lassoPathPoints[h];WinPaint.context.lineTo(l.x,l.y)}WinPaint.context.save();WinPaint.context.clip()}WinPaint.context.clearRect(WinPaint.selectionX,
WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.context.restore();WinPaint.tool="move"}}else if(WinPaint.tool=="fill"){WinPaint.dirty=true;c=Math.round(c/WinPaint.zoomLevel+WinPaint.viewportX);b=Math.round(b/WinPaint.zoomLevel+WinPaint.viewportY);ff_floodFill(c,b,WinPaint.context,WinPaint.fillColor,10);WinPaint.addUndo()}else if(WinPaint.tool=="rotate"){WinPaint.dirty=true;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.save();
WinPaint.overlayContext.translate(WinPaint.selectionX+WinPaint.selectionWidth/2,WinPaint.selectionY+WinPaint.selectionHeight/2);WinPaint.overlayContext.rotate(WinPaint.rotationAngle);WinPaint.overlayContext.translate(-(WinPaint.selectionX+WinPaint.selectionWidth/2),-(WinPaint.selectionY+WinPaint.selectionHeight/2));WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);
WinPaint.overlayContext.restore();b=WinPaint.getRotationBoundingBox(WinPaint.overlayContext,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight,WinPaint.rotationAngle);WinPaint.selectionX=Math.max(b.left,0);WinPaint.selectionY=Math.max(b.top,0);WinPaint.selectionWidth=b.right-b.left+1;WinPaint.selectionHeight=b.bottom-b.top+1;WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.selectionContext.drawImage(WinPaint.overlay,
Math.round(WinPaint.selectionX),Math.round(WinPaint.selectionY),WinPaint.selectionWidth,WinPaint.selectionHeight,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.tool="move"}else if(WinPaint.tool=="center"){WinPaint.centerStyle="#222";WinPaint.centerChanged=true}else if(WinPaint.tool=="nw-resize"){d=WinPaint.lastX-c;g=WinPaint.lastY-b;WinPaint.proportionalResize&&(d=g=Math.max(d,g));b=WinPaint.selectionWidth;c=WinPaint.selectionHeight;WinPaint.selectionX=
WinPaint.selectionX-d;WinPaint.selectionY=WinPaint.selectionY-g;WinPaint.selectionWidth=WinPaint.selectionWidth+d;WinPaint.selectionHeight=WinPaint.selectionHeight+g;WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height);WinPaint.bufferContext.drawImage(WinPaint.selection,0,0);WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.selectionContext.drawImage(WinPaint.buffer,0,0,b,c,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);
WinPaint.tool="move"}else if(WinPaint.tool=="ne-resize"){d=c-WinPaint.lastX;g=WinPaint.lastY-b;WinPaint.proportionalResize&&(d=g=Math.max(d,g));b=WinPaint.selectionWidth;c=WinPaint.selectionHeight;WinPaint.selectionY=WinPaint.selectionY-g;WinPaint.selectionWidth=WinPaint.selectionWidth+d;WinPaint.selectionHeight=WinPaint.selectionHeight+g;WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height);WinPaint.bufferContext.drawImage(WinPaint.selection,0,0);WinPaint.selectionContext.clearRect(0,
0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.selectionContext.drawImage(WinPaint.buffer,0,0,b,c,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.tool="move"}else if(WinPaint.tool=="se-resize"){d=c-WinPaint.lastX;g=b-WinPaint.lastY;WinPaint.proportionalResize&&(d=g=Math.max(d,g));b=WinPaint.selectionWidth;c=WinPaint.selectionHeight;WinPaint.selectionWidth=WinPaint.selectionWidth+d;WinPaint.selectionHeight=WinPaint.selectionHeight+g;WinPaint.bufferContext.clearRect(0,
0,WinPaint.buffer.width,WinPaint.buffer.height);WinPaint.bufferContext.drawImage(WinPaint.selection,0,0);WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.selectionContext.drawImage(WinPaint.buffer,0,0,b,c,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.tool="move"}else if(WinPaint.tool=="sw-resize"){d=WinPaint.lastX-c;g=b-WinPaint.lastY;WinPaint.proportionalResize&&(d=g=Math.max(d,g));b=WinPaint.selectionWidth;c=WinPaint.selectionHeight;
WinPaint.selectionX=WinPaint.selectionX-d;WinPaint.selectionWidth=WinPaint.selectionWidth+d;WinPaint.selectionHeight=WinPaint.selectionHeight+g;WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height);WinPaint.bufferContext.drawImage(WinPaint.selection,0,0);WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.selectionContext.drawImage(WinPaint.buffer,0,0,b,c,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.tool=
"move"}else if(WinPaint.tool=="n-resize"){g=WinPaint.lastY-b;c=WinPaint.selectionHeight;WinPaint.selectionY=WinPaint.selectionY-g;WinPaint.selectionHeight=WinPaint.selectionHeight+g;WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height);WinPaint.bufferContext.drawImage(WinPaint.selection,0,0);WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.selectionContext.drawImage(WinPaint.buffer,0,0,WinPaint.selectionWidth,c,0,0,WinPaint.selectionWidth,
WinPaint.selectionHeight);WinPaint.tool="move"}else if(WinPaint.tool=="e-resize"){d=c-WinPaint.lastX;b=WinPaint.selectionWidth;WinPaint.selectionWidth=WinPaint.selectionWidth+d;WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height);WinPaint.bufferContext.drawImage(WinPaint.selection,0,0);WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.selectionContext.drawImage(WinPaint.buffer,0,0,b,WinPaint.selectionHeight,0,0,WinPaint.selectionWidth,
WinPaint.selectionHeight);WinPaint.tool="move"}else if(WinPaint.tool=="s-resize"){g=b-WinPaint.lastY;c=WinPaint.selectionHeight;WinPaint.selectionHeight=WinPaint.selectionHeight+g;WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height);WinPaint.bufferContext.drawImage(WinPaint.selection,0,0);WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.selectionContext.drawImage(WinPaint.buffer,0,0,WinPaint.selectionWidth,c,0,0,WinPaint.selectionWidth,
WinPaint.selectionHeight);WinPaint.tool="move"}else if(WinPaint.tool=="w-resize"){d=WinPaint.lastX-c;b=WinPaint.selectionWidth;WinPaint.selectionX=WinPaint.selectionX-d;WinPaint.selectionWidth=WinPaint.selectionWidth+d;WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height);WinPaint.bufferContext.drawImage(WinPaint.selection,0,0);WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.selectionContext.drawImage(WinPaint.buffer,
0,0,b,WinPaint.selectionHeight,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.tool="move"}WinPaint.context.restore();WinPaint.updateViewport()},_mouseenter:function(b){if(WinPaint.penDown&&(WinPaint.tool=="pencil"||WinPaint.tool=="brush")){WinPaint.lastX=b.pageX-$(WinPaint.canvas).offset().left;WinPaint.lastY=b.pageY-$(WinPaint.canvas).offset().top}},_mousemove:function(b){var c=b.pageX-$(WinPaint.viewport).offset().left,d=b.pageY-$(WinPaint.viewport).offset().top;WinPaint.checkDiscardableMove(c,
d);if(WinPaint.penDown){WinPaint.context.save();WinPaint.context.translate(WinPaint.viewportX,WinPaint.viewportY);WinPaint.context.scale(1/WinPaint.zoomLevel,1/WinPaint.zoomLevel);if(WinPaint.tool=="pencil"&&WinPaint.toolType=="oval"){WinPaint.lastX=c;WinPaint.lastY=d}else if(WinPaint.tool=="pencil"){WinPaint.dirty=true;WinPaint.context.lineCap="round";WinPaint.context.lineWidth=WinPaint.size*WinPaint.zoomLevel;WinPaint.context.strokeStyle=WinPaint.strokeColor;WinPaint.context.beginPath();WinPaint.context.moveTo(WinPaint.lastX,
WinPaint.lastY);WinPaint.context.lineTo(c,d);WinPaint.lastX=c;WinPaint.lastY=d;WinPaint.context.stroke();WinPaint.context.restore()}else if(WinPaint.tool=="brush"){WinPaint.dirty=true;WinPaint.context.lineCap="round";WinPaint.context.lineWidth=WinPaint.size*WinPaint.zoomLevel;var e=parseColor(WinPaint.strokeColor);WinPaint.context.strokeStyle="rgba("+e.r+","+e.g+","+e.b+","+(1-WinPaint.transparency/100)+")";WinPaint.context.beginPath();WinPaint.context.moveTo(WinPaint.lastX,WinPaint.lastY);WinPaint.context.lineTo(c,
d);WinPaint.lastX=c;WinPaint.lastY=d;WinPaint.context.stroke();WinPaint.context.restore()}else if(WinPaint.toolType=="wetbrush"){WinPaint.dirty=true;var e=WinPaint.stampImg.width*WinPaint.stampSize/WinPaint.stampImg.width*WinPaint.zoomLevel,f=WinPaint.stampImg.height*WinPaint.stampSize/WinPaint.stampImg.width*WinPaint.zoomLevel;WinPaint.context.drawImage(WinPaint.stampImg,c-e/2,d-f/2,e,f);WinPaint.lastX=c;WinPaint.lastY=d}else if(WinPaint.tool=="stamp"){WinPaint.dirty=true;e=WinPaint.stampImg.width*
WinPaint.stampSize/WinPaint.stampImg.width*WinPaint.zoomLevel;f=WinPaint.stampImg.height*WinPaint.stampSize/WinPaint.stampImg.width*WinPaint.zoomLevel;WinPaint.context.drawImage(WinPaint.stampImg,c-e/2,d-f/2,e,f);WinPaint.lastX=c;WinPaint.lastY=d}else if(WinPaint.tool=="pen"){WinPaint.dirty=true;WinPaint.context.restore();WinPaint.context.fillStyle=WinPaint.strokeColor;d=d/WinPaint.zoomLevel+WinPaint.viewportY;WinPaint.context.fillRect(Math.round(c/WinPaint.zoomLevel+WinPaint.viewportX-WinPaint.size/
2),Math.round(d-WinPaint.size/2),WinPaint.size,WinPaint.size)}else if(WinPaint.tool=="eraser"){WinPaint.dirty=true;e=WinPaint.context.globalCompositeOperation;WinPaint.context.globalCompositeOperation="destination-out";WinPaint.context.strokeStyle="rgba(255, 255, 255, 1.0)";WinPaint.context.lineCap="round";WinPaint.context.lineWidth=WinPaint.size*WinPaint.zoomLevel;WinPaint.context.beginPath();WinPaint.context.moveTo(WinPaint.lastX,WinPaint.lastY);WinPaint.context.lineTo(c,d);WinPaint.lastX=c;WinPaint.lastY=
d;WinPaint.context.stroke();WinPaint.context.globalCompositeOperation=e}else if(WinPaint.tool=="line"&&!WinPaint.isDiscardableMove){WinPaint.dirty=true;WinPaint.overlayContext.lineCap="round";WinPaint.overlayContext.lineWidth=WinPaint.size*WinPaint.zoomLevel;WinPaint.overlayContext.strokeStyle=WinPaint.strokeColor;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.beginPath();WinPaint.overlayContext.moveTo(WinPaint.lastX,WinPaint.lastY);WinPaint.overlayContext.lineTo(c,
d);WinPaint.overlayContext.stroke()}else if((WinPaint.tool=="rectangle"||WinPaint.tool=="filledrectangle")&&!WinPaint.isDiscardableMove){WinPaint.dirty=true;WinPaint.overlayContext.lineCap="round";WinPaint.overlayContext.lineWidth=WinPaint.size*WinPaint.zoomLevel;WinPaint.overlayContext.strokeStyle=WinPaint.strokeColor;if(WinPaint.tool=="filledrectangle")WinPaint.overlayContext.fillStyle=WinPaint.fillColor;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.beginPath();
e=Math.min(WinPaint.lastX,c);f=Math.min(WinPaint.lastY,d);WinPaint.overlayContext.rect(e,f,Math.abs(WinPaint.lastX-c),Math.abs(WinPaint.lastY-d));WinPaint.tool=="filledrectangle"&&WinPaint.fillColor!="none"&&WinPaint.overlayContext.fill();WinPaint.overlayContext.stroke()}else if((WinPaint.tool=="ellipse"||WinPaint.tool=="filledellipse")&&!WinPaint.isDiscardableMove){WinPaint.dirty=true;WinPaint.overlayContext.lineCap="round";WinPaint.overlayContext.lineWidth=WinPaint.size*WinPaint.zoomLevel;WinPaint.overlayContext.strokeStyle=
WinPaint.strokeColor;if(WinPaint.tool=="filledellipse")WinPaint.overlayContext.fillStyle=WinPaint.fillColor;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.beginPath();Math.min(WinPaint.lastX,c);Math.min(WinPaint.lastY,d);var g=Math.abs(WinPaint.lastX-c),f=Math.abs(WinPaint.lastY-d),e=Math.max(g,f),g=g/e,f=f/e;WinPaint.overlayContext.save();WinPaint.overlayContext.translate((WinPaint.lastX+c)/2,(WinPaint.lastY+d)/2);WinPaint.overlayContext.scale(g,
f);WinPaint.overlayContext.beginPath();WinPaint.overlayContext.arc(0,0,e/2,0,Math.PI*2,false);WinPaint.overlayContext.closePath();WinPaint.overlayContext.restore();WinPaint.tool=="filledellipse"&&WinPaint.fillColor!="none"&&WinPaint.overlayContext.fill();WinPaint.overlayContext.stroke()}else if(WinPaint.tool=="move"){WinPaint.dirty=true;switch(WinPaint.getSelectionLocation(c,d)){case "inside":e=c-WinPaint.lastX;f=d-WinPaint.lastY;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);
WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,Math.round(WinPaint.selectionX+e),Math.round(WinPaint.selectionY+f),WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.selectionX=WinPaint.selectionX+e;WinPaint.selectionY=WinPaint.selectionY+f;WinPaint.lastX=c;WinPaint.lastY=d;WinPaint.drawSelectionOutline();$("#win-paint > div.canvas").css("cursor","move");break;case "rotation_lever":$("#win-paint > div.canvas").css("cursor","move");
break;default:$("#win-paint > div.canvas").css("cursor","crosshair")}}else if((WinPaint.tool=="selection"||WinPaint.tool=="cut"||WinPaint.tool=="copy"||WinPaint.tool=="paste"||WinPaint.tool=="stamp-selection")&&!WinPaint.isDiscardableMove){WinPaint.dirty=true;WinPaint.overlayContext.lineCap="round";WinPaint.overlayContext.lineWidth=1;WinPaint.overlayContext.strokeStyle="#333";e=Math.min(WinPaint.lastX,c);f=Math.min(WinPaint.lastY,d);WinPaint.overlayContext.beginPath();if(WinPaint.toolType=="rectangle"){WinPaint.overlayContext.clearRect(0,
0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.rect(e,f,Math.abs(WinPaint.lastX-c)+1,Math.abs(WinPaint.lastY-d)+1)}else if(WinPaint.toolType=="ellipse"){g=Math.abs(WinPaint.lastX-c)+1;f=Math.abs(WinPaint.lastY-d)+1;e=Math.max(g,f);g=g/e;f=f/e;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.save();WinPaint.overlayContext.translate((WinPaint.lastX+c)/2,(WinPaint.lastY+d)/2);WinPaint.overlayContext.scale(g,f);WinPaint.overlayContext.beginPath();
WinPaint.overlayContext.arc(0,0,e/2,0,Math.PI*2,false);WinPaint.overlayContext.restore()}else if(WinPaint.toolType=="lasso"){WinPaint.overlayContext.moveTo(WinPaint.lastX,WinPaint.lastY);WinPaint.overlayContext.lineTo(c,d);WinPaint.lastX=c;WinPaint.lastY=d;WinPaint.lassoPathPoints.push({x:c,y:d})}WinPaint.overlayContext.stroke()}else if(WinPaint.tool=="center"){WinPaint.centerX=Math.round(c/WinPaint.zoomLevel+WinPaint.viewportX);WinPaint.centerY=Math.round(d/WinPaint.zoomLevel+WinPaint.viewportY);
WinPaint.centerStyle="#f00"}else if(WinPaint.tool=="rotate"){e=c-WinPaint.lastX;f=WinPaint.selectionY+WinPaint.selectionHeight/2-d;WinPaint.rotationAngle=Math.atan2(e,f);WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.save();WinPaint.overlayContext.translate(WinPaint.selectionX+WinPaint.selectionWidth/2,WinPaint.selectionY+WinPaint.selectionHeight/2);WinPaint.overlayContext.rotate(WinPaint.rotationAngle);WinPaint.overlayContext.translate(-(WinPaint.selectionX+
WinPaint.selectionWidth/2),-(WinPaint.selectionY+WinPaint.selectionHeight/2));WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.overlayContext.restore()}else if(WinPaint.tool=="nw-resize"){e=WinPaint.lastX-c;f=WinPaint.lastY-d;WinPaint.proportionalResize&&(e=f=Math.max(e,f));var c=WinPaint.selectionX,d=WinPaint.selectionY,
g=WinPaint.selectionWidth,h=WinPaint.selectionHeight;WinPaint.selectionX=WinPaint.selectionX-e;WinPaint.selectionY=WinPaint.selectionY-f;WinPaint.selectionWidth=WinPaint.selectionWidth+e;WinPaint.selectionHeight=WinPaint.selectionHeight+f;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,g,h,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();
WinPaint.selectionX=c;WinPaint.selectionY=d;WinPaint.selectionWidth=g;WinPaint.selectionHeight=h}else if(WinPaint.tool=="ne-resize"){e=c-WinPaint.lastX;f=WinPaint.lastY-d;WinPaint.proportionalResize&&(e=f=Math.max(e,f));d=WinPaint.selectionY;g=WinPaint.selectionWidth;h=WinPaint.selectionHeight;WinPaint.selectionY=WinPaint.selectionY-f;WinPaint.selectionWidth=WinPaint.selectionWidth+e;WinPaint.selectionHeight=WinPaint.selectionHeight+f;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);
WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,g,h,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.selectionY=d;WinPaint.selectionWidth=g;WinPaint.selectionHeight=h}else if(WinPaint.tool=="se-resize"){e=c-WinPaint.lastX;f=d-WinPaint.lastY;WinPaint.proportionalResize&&(e=f=Math.max(e,f));g=WinPaint.selectionWidth;h=WinPaint.selectionHeight;WinPaint.selectionWidth=WinPaint.selectionWidth+e;WinPaint.selectionHeight=
WinPaint.selectionHeight+f;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,g,h,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.selectionWidth=g;WinPaint.selectionHeight=h}else if(WinPaint.tool=="sw-resize"){e=WinPaint.lastX-c;f=d-WinPaint.lastY;WinPaint.proportionalResize&&(e=f=Math.max(e,f));c=WinPaint.selectionX;g=WinPaint.selectionWidth;
h=WinPaint.selectionHeight;WinPaint.selectionX=WinPaint.selectionX-e;WinPaint.selectionWidth=WinPaint.selectionWidth+e;WinPaint.selectionHeight=WinPaint.selectionHeight+f;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,g,h,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.selectionX=c;WinPaint.selectionWidth=g;WinPaint.selectionHeight=
h}else if(WinPaint.tool=="n-resize"){f=WinPaint.lastY-d;d=WinPaint.selectionY;g=WinPaint.selectionWidth;h=WinPaint.selectionHeight;WinPaint.selectionY=WinPaint.selectionY-f;WinPaint.selectionHeight=WinPaint.selectionHeight+f;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,g,h,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.selectionY=
d;WinPaint.selectionHeight=h}else if(WinPaint.tool=="e-resize"){e=c-WinPaint.lastX;g=WinPaint.selectionWidth;h=WinPaint.selectionHeight;WinPaint.selectionWidth=WinPaint.selectionWidth+e;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,g,h,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.selectionWidth=g}else if(WinPaint.tool==
"s-resize"){f=d-WinPaint.lastY;g=WinPaint.selectionWidth;h=WinPaint.selectionHeight;WinPaint.selectionHeight=WinPaint.selectionHeight+f;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,g,h,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.selectionHeight=h}else if(WinPaint.tool=="w-resize"){e=WinPaint.lastX-c;c=WinPaint.selectionX;
g=WinPaint.selectionWidth;h=WinPaint.selectionHeight;WinPaint.selectionX=WinPaint.selectionX-e;WinPaint.selectionWidth=WinPaint.selectionWidth+e;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,g,h,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.selectionX=c;WinPaint.selectionWidth=g}WinPaint.context.restore();WinPaint.updateViewport()}else if(WinPaint.tool==
"move")switch(WinPaint.getSelectionLocation(c,d)){case "nw_corner":$("#win-paint > div.canvas").css("cursor","nw-resize");break;case "ne_corner":$("#win-paint > div.canvas").css("cursor","ne-resize");break;case "se_corner":$("#win-paint > div.canvas").css("cursor","se-resize");break;case "sw_corner":$("#win-paint > div.canvas").css("cursor","sw-resize");break;case "n_edge":$("#win-paint > div.canvas").css("cursor","n-resize");break;case "e_edge":$("#win-paint > div.canvas").css("cursor","e-resize");
break;case "s_edge":$("#win-paint > div.canvas").css("cursor","s-resize");break;case "w_edge":$("#win-paint > div.canvas").css("cursor","w-resize");break;case "inside":$("#win-paint > div.canvas").css("cursor","move");break;case "rotation_lever":$("#win-paint > div.canvas").css("cursor","move");break;default:$("#win-paint > div.canvas").css("cursor","crosshair")}else if(WinPaint.tool=="stamp"){WinPaint.dirty=true;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);
WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,c-WinPaint.selectionWidth/2,d-WinPaint.selectionHeight/2,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline(false);$("#win-paint > div.canvas").css("cursor","crosshair")}else if(WinPaint.tool=="zoom"&&WinPaint.toolType=="zoom-in"){e=WinPaint.viewportWidth/2;f=WinPaint.viewportHeight/2;c=c-e/2;d=d-f/2;WinPaint.overlayContext.lineWidth=1;WinPaint.overlayContext.strokeStyle=
"#222";WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.strokeRect(c,d,e,f)}b.preventDefault();return false},_updateText:function(){WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);var b=WinPaint.fontSize*WinPaint.zoomLevel+"px "+WinPaint.fontFamily;WinPaint.fontIsBold&&(b="bold "+b);WinPaint.fontIsItalic&&(b="italic "+b);WinPaint.overlayContext.font=b;WinPaint.overlayContext.lineWidth=2*WinPaint.zoomLevel;
WinPaint.overlayContext.strokeStyle=WinPaint.strokeColor;WinPaint.overlayContext.fillStyle=WinPaint.fillColor;WinPaint.overlayContext.textAlign="left";WinPaint.overlayContext.textBaseline="bottom";WinPaint.overlayContext.fillText(WinPaint.text,WinPaint.lastX,WinPaint.lastY);WinPaint.overlayContext.strokeText(WinPaint.text,WinPaint.lastX,WinPaint.lastY);b=WinPaint.overlayContext.measureText(WinPaint.text).width;if(WinPaint.fontIsUnderline){WinPaint.overlayContext.lineWidth=1;WinPaint.overlayContext.strokeStyle=
WinPaint.fillColor;WinPaint.overlayContext.beginPath();WinPaint.overlayContext.moveTo(WinPaint.lastX,WinPaint.lastY);WinPaint.overlayContext.lineTo(WinPaint.lastX+b,WinPaint.lastY);WinPaint.overlayContext.closePath();WinPaint.overlayContext.stroke()}},_updateBrush:function(){WinPaint.context.lineWidth=WinPaint.size*WinPaint.zoomLevel;WinPaint.context.strokeStyle=WinPaint.strokeColor;WinPaint.context.save();WinPaint.context.translate(WinPaint.viewportX,WinPaint.viewportY);WinPaint.context.scale(1/
WinPaint.zoomLevel,1/WinPaint.zoomLevel);for(var b=0;b<WinPaint.brushBristles.length;b++){WinPaint.context.beginPath();WinPaint.context.moveTo(WinPaint.brushBristles[b].dx,WinPaint.brushBristles[b].dy);var c=WinPaint.brushBristles[b].ax=(WinPaint.brushBristles[b].ax+(WinPaint.brushBristles[b].dx-WinPaint.lastX)*WinPaint.brushBristles[b].div)*WinPaint.brushBristles[b].ease;WinPaint.brushBristles[b].dx=WinPaint.brushBristles[b].dx-c;var c=WinPaint.brushBristles[b].dx,d=WinPaint.brushBristles[b].ay=
(WinPaint.brushBristles[b].ay+(WinPaint.brushBristles[b].dy-WinPaint.lastY)*WinPaint.brushBristles[b].div)*WinPaint.brushBristles[b].ease;WinPaint.brushBristles[b].dy=WinPaint.brushBristles[b].dy-d;WinPaint.context.lineTo(c,WinPaint.brushBristles[b].dy);WinPaint.context.stroke()}WinPaint.context.restore()},_dragover:function(b){b.stopPropagation();b.preventDefault();$("#drop-zone").removeClass("hidden");WinPaint.dropZoneVisible=true},_dragleave:function(){if(WinPaint.dropZoneVisible){$("#drop-zone").addClass("hidden");
WinPaint.dropZoneVisible=false}},_drop:function(b){WinPaint._commit();if(WinPaint.dropZoneVisible){$("#drop-zone").addClass("hidden");WinPaint.dropZoneVisible=false}b.stopPropagation();b.preventDefault();WinPaint.lastX=(b.originalEvent.pageX-$(WinPaint.viewport).offset().left)/WinPaint.zoomLevel+WinPaint.viewportX;WinPaint.lastY=(b.originalEvent.pageY-$(WinPaint.viewport).offset().top)/WinPaint.zoomLevel+WinPaint.viewportY;for(var b=b.originalEvent.dataTransfer.files,c=0,d;d=b[c];c++)if(d.type.match("image.*")){var e=
new FileReader;e.onload=WinPaint._onLoadImage;e.readAsDataURL(d)}},_change:function(b){WinPaint._commit();b=b.originalEvent.target.files;WinPaint.lastX=WinPaint.editingWidth/2;WinPaint.lastY=WinPaint.editingHeight/2;for(var c=0,d;d=b[c];c++)if(d.type.match("image.*")){var e=new FileReader;e.onload=WinPaint._onLoadImage;e.readAsDataURL(d)}},_keypress:function(b){WinPaint._onKeyPress(b.keyCode,b.charCode);return false},_keydown:function(b){if(b.keyCode==8){WinPaint._onKeyPress(b.keyCode,b.charCode);
return false}b.keyCode>=37&&b.keyCode<=40&&WinPaint._onKeyPress(b.keyCode,b.charCode)},_onKeyPress:function(b,c){if(WinPaint.tool=="text"){if(b==8){if(WinPaint.text.length>0)WinPaint.text=WinPaint.text.substring(0,WinPaint.text.length-1)}else if(b==32)WinPaint.text=WinPaint.text+" ";else if(c&&c==b)WinPaint.text=WinPaint.text+String.fromCharCode(c);WinPaint._updateText();var d=WinPaint.overlayContext.measureText(WinPaint.text).width;WinPaint.overlayContext.strokeStyle="#000000";WinPaint.overlayContext.lineWidth=
2;WinPaint.overlayContext.beginPath();WinPaint.overlayContext.moveTo(WinPaint.lastX+d,WinPaint.lastY);WinPaint.overlayContext.lineTo(WinPaint.lastX+d,WinPaint.lastY-WinPaint.fontSize*WinPaint.zoomLevel);WinPaint.overlayContext.closePath();WinPaint.overlayContext.stroke()}else if(b==8)WinPaint.cmdCut();else if(b==27){if(WinPaint.tool=="stamp"){WinPaint.tool="stamp-selection";WinPaint.toolType="rectangle";WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height)}}else if(b==
37){WinPaint._commit();WinPaint.viewportX=WinPaint.viewportX-WinPaint.viewportWidth/WinPaint.zoomLevel/4;WinPaint.updateViewport()}else if(b==38){WinPaint._commit();WinPaint.viewportY=WinPaint.viewportY-WinPaint.viewportHeight/WinPaint.zoomLevel/4;WinPaint.updateViewport()}else if(b==39){WinPaint._commit();WinPaint.viewportX=WinPaint.viewportX+WinPaint.viewportWidth/WinPaint.zoomLevel/3;WinPaint.updateViewport()}else if(b==40){WinPaint._commit();WinPaint.viewportY=WinPaint.viewportY+WinPaint.viewportHeight/
WinPaint.zoomLevel/3;WinPaint.updateViewport()}},_onScroll:function(b){b.preventDefault();WinPaint._commit();var b=getScrollVectors(b),c=$("#win-paint div.canvas").innerWidth(),d=$("#win-paint div.canvas").innerHeight();if(WinPaint.editingWidth*WinPaint.zoomLevel>c){WinPaint.viewportX=WinPaint.viewportX-b.x/WinPaint.zoomLevel;if(WinPaint.viewportX<0)WinPaint.viewportX=0;if((WinPaint.editingWidth-WinPaint.viewportX)*WinPaint.zoomLevel<c)WinPaint.viewportX=WinPaint.editingWidth-c/WinPaint.zoomLevel}if(WinPaint.editingHeight*
WinPaint.zoomLevel>d){WinPaint.viewportY=WinPaint.viewportY-b.y/WinPaint.zoomLevel;if(WinPaint.viewportY<0)WinPaint.viewportY=0;if((WinPaint.editingHeight-WinPaint.viewportY)*WinPaint.zoomLevel<d)WinPaint.viewportY=WinPaint.editingHeight-d/WinPaint.zoomLevel}WinPaint.updateViewport()},_onLoadImage:function(b){var c=$("#import-image");c.unbind();c.attr("src","");c.attr("src",b.target.result);c.load(function(){WinPaint.cmdToolSelection();var b=c[0];WinPaint.dirty=true;WinPaint.selectionContext.clearRect(0,
0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.selectionX=(WinPaint.lastX-b.width/2-WinPaint.viewportX)*WinPaint.zoomLevel;WinPaint.selectionY=(WinPaint.lastY-b.height/2-WinPaint.viewportY)*WinPaint.zoomLevel;WinPaint.selectionWidth=Math.min(b.width,WinPaint.canvas.width)*WinPaint.zoomLevel;WinPaint.selectionHeight=Math.min(b.height,WinPaint.canvas.height)*WinPaint.zoomLevel;WinPaint.selectionContext.drawImage(b,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.overlayContext.drawImage(WinPaint.selection,
0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.tool="move"})},findBounds:function(){return WinPaint.findBoxBounds(WinPaint.context,0,0,WinPaint.canvas.width,WinPaint.canvas.height)},findBoxBounds:function(b,c,d,e,f){for(var b=b.getImageData(c,d,e,f).data,g={top:d+f,left:c+e,bottom:d,right:c},h=0,j=d;j<d+f;j++)for(var k=c;k<c+e;k++){if(b[h+3]){if(k<g.left)g.left=
k;if(k>g.right)g.right=k;if(j<g.top)g.top=j;if(j>g.bottom)g.bottom=j}h=h+4}return g},checkDiscardableMove:function(b,c){var d=Math.sqrt(Math.pow(b-WinPaint.lastX,2)+Math.pow(c-WinPaint.lastY,2));WinPaint.isDiscardableMove=WinPaint.isDiscardableMove&&d<=WinPaint.discardMoveTolerance},_commit:function(){if(WinPaint.tool=="text")if(WinPaint.text){WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);var b=WinPaint.fontSize+"px "+WinPaint.fontFamily;WinPaint.fontIsBold&&
(b="bold "+b);WinPaint.fontIsItalic&&(b="italic "+b);WinPaint.context.font=b;WinPaint.context.lineWidth=2;WinPaint.context.strokeStyle=WinPaint.strokeColor;WinPaint.context.fillStyle=WinPaint.fillColor;WinPaint.context.textAlign="left";WinPaint.context.textBaseline="bottom";WinPaint.context.fillText(WinPaint.text,WinPaint.lastX/WinPaint.zoomLevel+WinPaint.viewportX,WinPaint.lastY/WinPaint.zoomLevel+WinPaint.viewportY);WinPaint.context.strokeText(WinPaint.text,WinPaint.lastX/WinPaint.zoomLevel+WinPaint.viewportX,
WinPaint.lastY/WinPaint.zoomLevel+WinPaint.viewportY);b=WinPaint.overlayContext.measureText(WinPaint.text).width;if(WinPaint.fontIsUnderline){WinPaint.context.lineWidth=1;WinPaint.context.strokeStyle=WinPaint.fillColor;WinPaint.context.beginPath();WinPaint.context.moveTo(WinPaint.lastX/WinPaint.zoomLevel+WinPaint.viewportX,WinPaint.lastY/WinPaint.zoomLevel+WinPaint.viewportY);WinPaint.context.lineTo(WinPaint.lastX/WinPaint.zoomLevel+b/WinPaint.zoomLevel+WinPaint.viewportX,WinPaint.lastY/WinPaint.zoomLevel+
WinPaint.viewportY);WinPaint.context.closePath();WinPaint.context.stroke()}WinPaint.text="";WinPaint.addUndo()}else WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);else if(WinPaint.tool=="move"){var b=Math.round(WinPaint.selectionX/WinPaint.zoomLevel+WinPaint.viewportX),c=Math.round(WinPaint.selectionY/WinPaint.zoomLevel+WinPaint.viewportY);WinPaint.context.drawImage(WinPaint.selection,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,b,c,WinPaint.selectionWidth/
WinPaint.zoomLevel,WinPaint.selectionHeight/WinPaint.zoomLevel);WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.addUndo();WinPaint.tool=WinPaint.toolType=="move-line"?"line":WinPaint.toolType=="move-rectangle"?"rectangle":WinPaint.toolType=="move-filledrectangle"?"filledrectangle":WinPaint.toolType=="move-ellipse"?"ellipse":WinPaint.toolType=="move-filledellipse"?
"filledellipse":"selection"}else WinPaint.tool=="stamp"?WinPaint.tool="stamp-selection":WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.isDiscardableMove=true;WinPaint.updateViewport()},_clearToolSelection:function(){$("#win-paint .text").addClass("hidden");$("#win-paint .pencil").addClass("hidden");$("#win-paint .brush").addClass("hidden");$("#win-paint .shape").addClass("hidden");$("#win-paint .centertool").addClass("hidden");$("#win-paint .colorpicker").addClass("hidden");
$("#win-paint .fillcolor").addClass("hidden");$("#win-paint .strokecolor").addClass("hidden");$("#win-paint .copy").addClass("hidden");$("#win-paint .stamp").addClass("hidden");$("#win-paint .menu").addClass("hidden");$("#win-paint .paint-tools").removeClass("selected");WinPaint.clearCenter()},_showColorPicker:function(){$("#win-paint .colorpicker").removeClass("hidden");$("#win-paint .fillcolor").removeClass("hidden");$("#win-paint .strokecolor").removeClass("hidden");WinPaint.cmdChooseFillColor()},
_showFillColorPicker:function(){$("#win-paint .colorpicker").removeClass("hidden");$("#win-paint .fillcolor").removeClass("hidden");WinPaint.cmdChooseFillColor()},_showStrokeColorPicker:function(){$("#win-paint .colorpicker").removeClass("hidden");$("#win-paint .strokecolor").removeClass("hidden");WinPaint.cmdChooseStrokeColor()},cmdEditMenu:function(){$("#win-paint .menu").not($(this).next()).addClass("hidden");var b=$("#win-paint .tool-options .edit");$(this).next().toggleClass("hidden").css("right",
$("#win-paint").innerWidth()-(b.position().left+b.outerWidth())).css("top",b.position().top+b.outerHeight());return false},cmdSelectEditMenuOption:function(){$("#win-paint .menu").addClass("hidden");switch($(this).attr("data-option")){case "import_image":WinPaint.lastX=WinPaint.viewportX+WinPaint.editingWidth/2;WinPaint.lastY=WinPaint.viewportY+WinPaint.editingHeight/2;$("#import-image-file").click();break;case "clear_canvas":WinPaint.clearCanvas();break;case "flip_canvas_horizontal":WinPaint.flipCanvasHorizontally();
break;case "flip_canvas_vertical":WinPaint.flipCanvasVertically();break;case "toggle_center":WinPaint.toggleCenter();break;case "toggle_grid":WinPaint.toggleGrid()}return false},cmdSelectZoomOption:function(){WinPaint._commit();switch($(this).attr("data-option")){case "zoom_out":WinPaint.zoomOut();break;case "zoom_in":WinPaint.zoomIn();break;case "zoom_to":WinPaint.zoomTo(parseFloat($(this).attr("data-value")))}},cmdChooseFontFamily:function(){$("#win-paint .menu").addClass("hidden");$(this).next().toggleClass("hidden").css("left",
$(this).position().left).css("top",$(this).position().top+$(this).outerHeight());return false},cmdSelectFontFamily:function(){$("#win-paint .menu").addClass("hidden");WinPaint.fontFamily=$(this).text();$("#win-paint .font-family span").text(WinPaint.fontFamily);WinPaint._updateText();return false},cmdChooseFontSize:function(){$("#win-paint .menu").addClass("hidden");$(this).next().toggleClass("hidden").css("left",$(this).position().left).css("top",$(this).position().top+$(this).outerHeight());return false},
cmdSelectFontSize:function(){$("#win-paint .menu").addClass("hidden");WinPaint.fontSize=parseInt($(this).text());$("#win-paint .font-size span").text(WinPaint.fontSize);WinPaint._updateText();return false},cmdToggleBold:function(){$("#win-paint .menu").addClass("hidden");$(this).toggleClass("selected");WinPaint.fontIsBold=$(this).hasClass("selected");WinPaint._updateText();return false},cmdToggleItalic:function(){$("#win-paint .menu").addClass("hidden");$(this).toggleClass("selected");WinPaint.fontIsItalic=
$(this).hasClass("selected");WinPaint._updateText();return false},cmdToggleUnderline:function(){$("#win-paint .menu").addClass("hidden");$(this).toggleClass("selected");WinPaint.fontIsUnderline=$(this).hasClass("selected");WinPaint._updateText();return false},cmdChoosePencilSize:function(){$("#win-paint .menu").addClass("hidden");$(this).next().toggleClass("hidden").css("left",$(this).position().left).css("top",$(this).position().top+$(this).outerHeight());return false},cmdChooseBrushSize:function(){$("#win-paint .menu").addClass("hidden");
$(this).next().toggleClass("hidden").css("left",$(this).position().left).css("top",$(this).position().top+$(this).outerHeight());return false},cmdChooseStamp:function(){$("#win-paint .menu").addClass("hidden");$(this).next().toggleClass("hidden").css("left",$(this).position().left).css("top",$(this).position().top+$(this).outerHeight());return false},cmdChoosePredefinedPencilSize:function(){$("#win-paint .menu").addClass("hidden");WinPaint.size=parseInt($(this).attr("radius"));$("#win-paint .pencil .slider").slider("value",
WinPaint.size);$("#win-paint .pencilsize div img").addClass("hidden");$("#win-paint .pencilsize div span").css("border-radius",Math.floor(WinPaint.size/2)).css("width",WinPaint.size).css("height",WinPaint.size);$("#win-paint .pencilsize div span").removeClass("hidden");$("#win-paint .pencil .showsize div").addClass("oval");$("#win-paint .pencil .showsize div").css("border-radius",Math.floor(WinPaint.size/2)).css("width",WinPaint.size).css("height",WinPaint.size);$("#win-paint .pencil .showsize div img").addClass("hidden");
$("#win-paint .brush .showsize div").addClass("oval");$("#win-paint .brush .showsize div").css("border-radius",Math.floor(WinPaint.size/2)).css("width",WinPaint.size).css("height",WinPaint.size);$("#win-paint .brush .showsize div img").addClass("hidden");return false},cmdChoosePredefinedStamp:function(){$("#win-paint .menu").addClass("hidden");WinPaint.toolType=$(this).attr("type");WinPaint.stampImg.src=$("img",this).attr("src");$("#win-paint .stampsize div span").addClass("hidden");$("#win-paint .stampsize div img").attr("src",
WinPaint.stampImg.src);$("#win-paint .stampsize div img").removeClass("hidden");return false},cmdChoosePenSize:function(){$("#win-paint .menu").addClass("hidden");$(this).next().toggleClass("hidden").css("left",$(this).position().left).css("top",$(this).position().top+$(this).outerHeight());return false},cmdChoosePredefinedPenSize:function(){WinPaint._commit();WinPaint._clearToolSelection();WinPaint._showStrokeColorPicker();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_pencil"));
$("#win-paint .pencil").removeClass("hidden");$("#win-paint .tool-pencil").addClass("selected");$("#win-paint .menu").addClass("hidden");WinPaint.tool="pen";WinPaint.size=parseInt($(this).attr("size"));$("#win-paint .pencil .slider").slider("value",WinPaint.size);$("#win-paint .pensize span").css("width",WinPaint.size*WinPaint.size).css("height",WinPaint.size*WinPaint.size);return false},cmdChooseFillColor:function(){$("#win-paint .menu").addClass("hidden");$("#win-paint .fillcolor").addClass("selected");
$("#win-paint .strokecolor").removeClass("selected");WinPaint.selectedColor="fill"},cmdChooseStrokeColor:function(){$("#win-paint .menu").addClass("hidden");$("#win-paint .fillcolor").removeClass("selected");$("#win-paint .strokecolor").addClass("selected");WinPaint.selectedColor="stroke"},cmdChoosePredefinedColor:function(){$("#win-paint .menu").addClass("hidden");$("#win-paint .tool-eyedropper").removeClass("selected");var b=$(this).css("background-color");b||(b="none");if(WinPaint.selectedColor==
"fill"){$("#win-paint .fillcolor > div").css("background-color",b);WinPaint.fillColor=b}else if(WinPaint.selectedColor=="stroke"){$("#win-paint .strokecolor > div").css("border","4px solid "+b);WinPaint.strokeColor=b}WinPaint.tool=="text"&&WinPaint._updateText();return false},cmdChooseColor:function(){$("#win-paint .menu").addClass("hidden");$("#win-paint .tool-eyedropper").removeClass("selected");var b=$("#win-paint .tool-color");ColorPicker.show(b.offset().left,b.offset().top,0,function(b){if(WinPaint.selectedColor==
"fill"){$("#win-paint .fillcolor > div").css("background-color",b);WinPaint.fillColor=b}else if(WinPaint.selectedColor=="stroke"){$("#win-paint .strokecolor > div").css("border","4px solid "+b);WinPaint.strokeColor=b}});return false},cmdToolColor:function(){$("#win-paint .menu").addClass("hidden");$("#win-paint .tool-eyedropper").addClass("selected");WinPaint.lastTool=WinPaint.tool;WinPaint.tool="colorpicker";return false},cmdChooseSelectionType:function(){WinPaint._commit();if(WinPaint.tool=="move")WinPaint.tool=
"selection";else if(WinPaint.tool=="stamp")WinPaint.tool="stamp-selection";WinPaint.toolType=$(this).attr("data-tool_type");$("#win-paint li.selection-type").removeClass("selected");$(this).addClass("selected");return false},cmdCut:function(){WinPaint.tool="cut";WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.addUndo();return false},cmdCopy:function(){WinPaint.tool="copy";return false},cmdPaste:function(){if(WinPaint.tool=="move")WinPaint.context.drawImage(WinPaint.selection,
0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,WinPaint.selectionX/WinPaint.zoomLevel+WinPaint.viewportX,WinPaint.selectionY/WinPaint.zoomLevel+WinPaint.viewportY,WinPaint.selectionWidth/WinPaint.zoomLevel,WinPaint.selectionHeight/WinPaint.zoomLevel);else{WinPaint.tool="move";WinPaint.context.drawImage(WinPaint.selection,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,WinPaint.selectionX/WinPaint.zoomLevel+WinPaint.viewportX,WinPaint.selectionY/WinPaint.zoomLevel+WinPaint.viewportY,WinPaint.selectionWidth/
WinPaint.zoomLevel,WinPaint.selectionHeight/WinPaint.zoomLevel);WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight)}WinPaint.addUndo();return false},cmdFlipHorizontally:function(){WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height);WinPaint.bufferContext.drawImage(WinPaint.selection,0,0);WinPaint.selectionContext.clearRect(0,
0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.selectionContext.save();WinPaint.selectionContext.scale(-1,1);WinPaint.selectionContext.drawImage(WinPaint.buffer,-WinPaint.selectionWidth,0);WinPaint.selectionContext.restore();WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);
WinPaint.drawSelectionOutline();WinPaint.tool="move";WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height)},cmdFlipVertically:function(){WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height);WinPaint.bufferContext.drawImage(WinPaint.selection,0,0);WinPaint.selectionContext.clearRect(0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.selectionContext.save();WinPaint.selectionContext.scale(1,-1);WinPaint.selectionContext.drawImage(WinPaint.buffer,
0,-WinPaint.selectionHeight);WinPaint.selectionContext.restore();WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.tool="move";WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height)},cmdGrow:function(){WinPaint.scaleSelection(WinPaint.growFactor,
WinPaint.growFactor);WinPaint.tool="move"},cmdShrink:function(){WinPaint.scaleSelection(WinPaint.shrinkFactor,WinPaint.shrinkFactor);WinPaint.tool="move"},cmdChooseZoomType:function(){WinPaint._commit();WinPaint.toolType=$(this).attr("data-tool_type");$("#win-paint .zoom ul li.zoom-type").removeClass("selected");$("#win-paint .zoom ul li.zoom-type."+WinPaint.toolType).addClass("selected")},cmdToolPencil:function(){WinPaint._commit();WinPaint._clearToolSelection();WinPaint._showStrokeColorPicker();
$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_pencil"));$("#win-paint .pencil").removeClass("hidden");$("#win-paint .tool-pencil").addClass("selected");WinPaint.tool="pencil";return false},cmdToolBrush:function(){WinPaint._commit();WinPaint._clearToolSelection();WinPaint._showStrokeColorPicker();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_brush"));$("#win-paint .pencil").removeClass("hidden");$("#win-paint .brush").removeClass("hidden");$("#win-paint .tool-brush").addClass("selected");
WinPaint.tool="brush";return false},cmdToolStamp:function(){WinPaint._commit();WinPaint._clearToolSelection();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_stamp"));$("#win-paint .stamp").removeClass("hidden");$("#win-paint .tool-stamp").addClass("selected");WinPaint.tool="stamp";$("#win-paint .stamp .stampoptions li:first").click();return false},cmdToolEraser:function(){WinPaint._commit();WinPaint._clearToolSelection();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_eraser"));
$("#win-paint .tool-eraser").addClass("selected");$("#win-paint .pencil").removeClass("hidden");WinPaint.tool="eraser";return false},cmdToolFill:function(){WinPaint._commit();WinPaint._clearToolSelection();WinPaint._showFillColorPicker();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_fill"));$("#win-paint .tool-fill").addClass("selected");WinPaint.tool="fill";return false},cmdToolShape:function(){$(this).hasClass("ellipse")?WinPaint.cmdToolEllipse():$(this).hasClass("line")?WinPaint.cmdToolLine():
WinPaint.cmdToolRectangle()},cmdToolRectangle:function(){WinPaint._commit();WinPaint._clearToolSelection();WinPaint._showColorPicker();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_rectangle"));$("#win-paint .tool-shape").addClass("selected");$("#win-paint .pencil").removeClass("hidden");$("#win-paint .tool-shape div").addClass("hidden");$("#win-paint .tool-shape").addClass("rectangle");$("#win-paint .tool-shape").removeClass("filledrectangle");$("#win-paint .tool-shape").removeClass("ellipse");
$("#win-paint .tool-shape").removeClass("filledellipse");$("#win-paint .tool-shape").removeClass("line");WinPaint.tool="rectangle";return false},cmdToolFilledRectangle:function(){WinPaint._commit();WinPaint._clearToolSelection();WinPaint._showColorPicker();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_rectangle"));$("#win-paint .tool-shape").addClass("selected");$("#win-paint .pencil").removeClass("hidden");$("#win-paint .tool-shape div").addClass("hidden");$("#win-paint .tool-shape").removeClass("rectangle");
$("#win-paint .tool-shape").addClass("filledrectangle");$("#win-paint .tool-shape").removeClass("ellipse");$("#win-paint .tool-shape").removeClass("filledellipse");$("#win-paint .tool-shape").removeClass("line");WinPaint.tool="filledrectangle";return false},cmdToolEllipse:function(){WinPaint._commit();WinPaint._clearToolSelection();WinPaint._showColorPicker();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_ellipse"));$("#win-paint .tool-shape").addClass("selected");$("#win-paint .pencil").removeClass("hidden");
$("#win-paint .tool-shape div").addClass("hidden");$("#win-paint .tool-shape").removeClass("rectangle");$("#win-paint .tool-shape").removeClass("filledrectangle");$("#win-paint .tool-shape").addClass("ellipse");$("#win-paint .tool-shape").removeClass("filledellipse");$("#win-paint .tool-shape").removeClass("line");WinPaint.tool="ellipse";return false},cmdToolFilledEllipse:function(){WinPaint._commit();WinPaint._clearToolSelection();WinPaint._showColorPicker();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_ellipse"));
$("#win-paint .tool-shape").addClass("selected");$("#win-paint .pencil").removeClass("hidden");$("#win-paint .tool-shape div").addClass("hidden");$("#win-paint .tool-shape").removeClass("rectangle");$("#win-paint .tool-shape").removeClass("filledrectangle");$("#win-paint .tool-shape").addClass("ellipse");$("#win-paint .tool-shape").removeClass("filledellipse");$("#win-paint .tool-shape").removeClass("line");WinPaint.tool="filledellipse";return false},cmdToolLine:function(){WinPaint._commit();WinPaint._clearToolSelection();
WinPaint._showStrokeColorPicker();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_line"));$("#win-paint .tool-shape").addClass("selected");$("#win-paint .pencil").removeClass("hidden");$("#win-paint .tool-shape div").addClass("hidden");$("#win-paint .tool-shape").removeClass("rectangle");$("#win-paint .tool-shape").removeClass("filledrectangle");$("#win-paint .tool-shape").removeClass("ellipse");$("#win-paint .tool-shape").removeClass("filledellipse");$("#win-paint .tool-shape").addClass("line");
WinPaint.tool="line";return false},cmdToolText:function(){WinPaint._commit();WinPaint._clearToolSelection();WinPaint._showColorPicker();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_text"));$("#win-paint .text").removeClass("hidden");$("#win-paint .tool-text").addClass("selected");WinPaint.tool="text";return false},cmdToolSelection:function(){WinPaint._commit();WinPaint._clearToolSelection();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_selection"));$("#win-paint .copy").removeClass("hidden");
$("#win-paint .tool-selection").addClass("selected");$("#win-paint li.selection-type").removeClass("selected");$("#win-paint li.selection-type.selrectangle").addClass("selected");WinPaint.tool="selection";WinPaint.toolType="rectangle";return false},cmdToolZoom:function(){WinPaint._commit();WinPaint._clearToolSelection();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_zoom"));$("#win-paint .zoom").removeClass("hidden");$("#win-paint .tool-zoom").addClass("selected");$("#win-paint .zoom ul li.zoom-type").removeClass("selected");
WinPaint.tool="zoom";WinPaint.toolType="zoom-in";$("#win-paint .zoom ul li.zoom-type."+WinPaint.toolType).addClass("selected");return false},cmdToolCenter:function(){WinPaint._commit();WinPaint._clearToolSelection();$("#win-paint .tool-options .label").text(g_loc.getText("paint.tool_center"));$("#win-paint .tool-center").addClass("selected");$("#win-paint .centertool").removeClass("hidden");WinPaint.tool="center";WinPaint.drawCenter();return false},undoClear:function(){WinPaint.undoStack=[];WinPaint.redoIndex=
0},addUndo:function(){WinPaint.undoStack.length>0&&WinPaint.redoIndex<WinPaint.undoStack.length&&WinPaint.undoStack.splice(WinPaint.redoIndex,WinPaint.undoStack.length-WinPaint.redoIndex);var b=new Image;try{b.src=WinPaint.canvas.toDataURL()}catch(c){if(c.name=="SECURITY_ERR"&&c.code==18)return}WinPaint.undoStack.push(b);WinPaint.undoStack.length>WinPaint.undoLimit?WinPaint.undoStack.splice(0,1):WinPaint.redoIndex++},cmdUndo:function(){WinPaint._commit();if(WinPaint.undoStack.length>0&&WinPaint.redoIndex>
1){var b=WinPaint.undoStack[WinPaint.redoIndex-2];WinPaint.context.clearRect(0,0,WinPaint.canvas.width,WinPaint.canvas.height);WinPaint.context.drawImage(b,0,0);WinPaint.updateViewport();WinPaint.redoIndex--}return false},cmdRedo:function(){WinPaint._commit();if(WinPaint.undoStack.length>0&&WinPaint.redoIndex<WinPaint.undoStack.length){var b=WinPaint.undoStack[WinPaint.redoIndex];WinPaint.context.clearRect(0,0,WinPaint.canvas.width,WinPaint.canvas.height);WinPaint.context.drawImage(b,0,0);WinPaint.updateViewport();
WinPaint.redoIndex++}return false},cmdCenter:function(b){var b=$(this),c=WinPaint.findBounds();if(b.hasClass("center-tl")){WinPaint.centerX=Math.floor(c.left);WinPaint.centerY=Math.floor(c.top)}else if(b.hasClass("center-ml")){WinPaint.centerX=Math.floor(c.left);WinPaint.centerY=Math.floor(c.top+(c.bottom-c.top)/2)}else if(b.hasClass("center-bl")){WinPaint.centerX=Math.floor(c.left);WinPaint.centerY=Math.floor(c.bottom)}else if(b.hasClass("center-tc")){WinPaint.centerX=Math.floor(c.left+(c.right-
c.left)/2);WinPaint.centerY=Math.floor(c.top)}else if(b.hasClass("center-c")){WinPaint.centerX=Math.floor(c.left+(c.right-c.left)/2);WinPaint.centerY=Math.floor(c.top+(c.bottom-c.top)/2)}else if(b.hasClass("center-bc")){WinPaint.centerX=Math.floor(c.left+(c.right-c.left)/2);WinPaint.centerY=Math.floor(c.bottom)}else if(b.hasClass("center-tr")){WinPaint.centerX=Math.floor(c.right);WinPaint.centerY=Math.floor(c.top)}else if(b.hasClass("center-mr")){WinPaint.centerX=Math.floor(c.right);WinPaint.centerY=
Math.floor(c.top+(c.bottom-c.top)/2)}else if(b.hasClass("center-br")){WinPaint.centerX=Math.floor(c.right);WinPaint.centerY=Math.floor(c.bottom)}WinPaint.updateViewport()},drawCenter:function(b){b=b||"#000";if(WinPaint.centerX===void 0||WinPaint.centerX===null||WinPaint.centerY===void 0||WinPaint.centerY===null){var c=WinPaint.findBounds();WinPaint.centerX=Math.floor(c.left+(c.right-c.left)/2);WinPaint.centerY=Math.floor(c.top+(c.bottom-c.top)/2)}WinPaint.centerContext.save();WinPaint.centerContext.scale(WinPaint.zoomLevel,
WinPaint.zoomLevel);WinPaint.centerContext.translate(-WinPaint.viewportX,-WinPaint.viewportY);WinPaint.centerContext.lineWidth=1/WinPaint.zoomLevel;WinPaint.centerContext.strokeStyle=b;WinPaint.centerContext.beginPath();WinPaint.centerContext.moveTo(WinPaint.centerX,0);WinPaint.centerContext.lineTo(WinPaint.centerX,WinPaint.center.height);WinPaint.centerContext.stroke();WinPaint.centerContext.beginPath();WinPaint.centerContext.moveTo(0,WinPaint.centerY);WinPaint.centerContext.lineTo(WinPaint.center.width,
WinPaint.centerY);WinPaint.centerContext.stroke();WinPaint.centerContext.restore();WinPaint.centerVisible=true;WinPaint.updateToggleCenterText()},clearCenter:function(){WinPaint.centerContext.clearRect(0,0,WinPaint.center.width,WinPaint.center.height);WinPaint.centerVisible=false;WinPaint.updateToggleCenterText();WinPaint.updateViewport()},drawGrid:function(){$("#win-paint div.canvas").css("background-image","");WinPaint.gridVisible=true;WinPaint.updateToggleGridText()},clearGrid:function(){$("#win-paint div.canvas").css("background-image",
"none");WinPaint.gridVisible=false;WinPaint.updateToggleGridText()},drawSelectionOutline:function(b){b=b!=null?b:true;WinPaint.overlayContext.save();WinPaint.overlayContext.lineWidth=1;WinPaint.overlayContext.strokeStyle="#333";WinPaint.overlayContext.fillStyle="#fff";WinPaint.overlayContext.beginPath();WinPaint.overlayContext.strokeRect(WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);if(b){b=WinPaint.selectionX+WinPaint.selectionWidth/2;WinPaint.rotationLeverX=
b-WinPaint.rotateLeverSize/2;WinPaint.rotationLeverY=WinPaint.selectionY-30-WinPaint.rotateLeverSize/2;WinPaint.overlayContext.moveTo(b,WinPaint.selectionY-30);WinPaint.overlayContext.lineTo(b,WinPaint.selectionY);WinPaint.overlayContext.stroke();WinPaint.overlayContext.closePath();WinPaint.overlayContext.beginPath();WinPaint.overlayContext.rect(WinPaint.rotationLeverX,WinPaint.rotationLeverY,WinPaint.rotateLeverSize,WinPaint.rotateLeverSize);WinPaint.overlayContext.fill();var b=WinPaint.resizeHandleSize/
2,c=WinPaint.selectionWidth/2,d=WinPaint.selectionHeight/2;WinPaint.overlayContext.stroke();WinPaint.overlayContext.beginPath();WinPaint.overlayContext.rect(WinPaint.selectionX-b,WinPaint.selectionY-b,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize);WinPaint.overlayContext.fill();WinPaint.overlayContext.stroke();WinPaint.overlayContext.beginPath();WinPaint.overlayContext.rect(WinPaint.selectionX+WinPaint.selectionWidth-b,WinPaint.selectionY-b,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize);
WinPaint.overlayContext.fill();WinPaint.overlayContext.stroke();WinPaint.overlayContext.beginPath();WinPaint.overlayContext.rect(WinPaint.selectionX+WinPaint.selectionWidth-b,WinPaint.selectionY+WinPaint.selectionHeight-b,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize);WinPaint.overlayContext.fill();WinPaint.overlayContext.stroke();WinPaint.overlayContext.beginPath();WinPaint.overlayContext.rect(WinPaint.selectionX-b,WinPaint.selectionY+WinPaint.selectionHeight-b,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize);
WinPaint.overlayContext.fill();WinPaint.overlayContext.stroke();WinPaint.overlayContext.beginPath();WinPaint.overlayContext.rect(WinPaint.selectionX+c-b,WinPaint.selectionY-b,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize);WinPaint.overlayContext.fill();WinPaint.overlayContext.stroke();WinPaint.overlayContext.beginPath();WinPaint.overlayContext.rect(WinPaint.selectionX+WinPaint.selectionWidth-b,WinPaint.selectionY+d-b,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize);WinPaint.overlayContext.fill();
WinPaint.overlayContext.stroke();WinPaint.overlayContext.beginPath();WinPaint.overlayContext.rect(WinPaint.selectionX+c-b,WinPaint.selectionY+WinPaint.selectionHeight-b,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize);WinPaint.overlayContext.fill();WinPaint.overlayContext.stroke();WinPaint.overlayContext.beginPath();WinPaint.overlayContext.rect(WinPaint.selectionX-b,WinPaint.selectionY+d-b,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize);WinPaint.overlayContext.fill();WinPaint.overlayContext.stroke()}WinPaint.overlayContext.restore()},
updateToggleCenterText:function(){var b=!WinPaint.centerVisible?g_loc.getText("paint.menu_showcenter"):g_loc.getText("paint.menu_hidecenter");$("#win-paint .edit .menu .toggle-center").text(b)},updateToggleGridText:function(){var b=!WinPaint.gridVisible?g_loc.getText("paint.menu_showgrid"):g_loc.getText("paint.menu_hidegrid");$("#win-paint .edit .menu .toggle-grid").text(b)},updateViewport:function(){WinPaint.viewportX=parseInt(WinPaint.viewportX);WinPaint.viewportY=parseInt(WinPaint.viewportY);WinPaint.viewportContext.clearRect(0,
0,WinPaint.viewport.width,WinPaint.viewport.height);WinPaint.viewportContext.save();WinPaint.viewportContext.scale(WinPaint.zoomLevel,WinPaint.zoomLevel);WinPaint.viewportContext.translate(-WinPaint.viewportX,-WinPaint.viewportY);WinPaint.centerContext.clearRect(0,0,WinPaint.center.width,WinPaint.center.height);WinPaint.centerContext.save();WinPaint.centerContext.scale(WinPaint.zoomLevel,WinPaint.zoomLevel);WinPaint.centerContext.translate(-WinPaint.viewportX,-WinPaint.viewportY);if(WinPaint.zoomLevel>=
4){WinPaint.centerContext.lineWidth=1/WinPaint.zoomLevel;WinPaint.centerContext.strokeStyle="#aaa";WinPaint.centerContext.beginPath();for(var b=0;b<WinPaint.center.width;b=b+1){WinPaint.centerContext.moveTo(b,0);WinPaint.centerContext.lineTo(b,WinPaint.center.height)}for(b=0;b<WinPaint.center.height;b=b+1){WinPaint.centerContext.moveTo(0,b);WinPaint.centerContext.lineTo(WinPaint.center.width,b)}WinPaint.centerContext.stroke();WinPaint.clearGrid()}else{WinPaint.drawGrid();$("#win-paint .canvas").css("background-size",
30*WinPaint.zoomLevel+"px")}WinPaint.viewportContext.drawImage(WinPaint.canvas,0,0);WinPaint.viewportContext.restore();WinPaint.centerContext.restore();WinPaint.centerVisible&&WinPaint.drawCenter(WinPaint.centerStyle);WinPaint.maskContext.save();WinPaint.maskContext.fillStyle="#999";WinPaint.maskContext.clearRect(-1E5,-1E5,2E5,2E5);WinPaint.maskContext.fillRect(parseInt(-WinPaint.viewportX*WinPaint.zoomLevel-1E5),parseInt(-WinPaint.viewportY*WinPaint.zoomLevel),1E5,1E5);WinPaint.maskContext.fillRect(-1E5,
parseInt(-WinPaint.viewportY*WinPaint.zoomLevel-1E5),2E5,1E5);WinPaint.maskContext.fillRect(parseInt((WinPaint.canvas.width-WinPaint.viewportX)*WinPaint.zoomLevel),parseInt(-WinPaint.viewportY*WinPaint.zoomLevel),1E5,1E5);WinPaint.maskContext.fillRect(parseInt(-WinPaint.viewportX*WinPaint.zoomLevel-1E4),parseInt((WinPaint.canvas.height-WinPaint.viewportY)*WinPaint.zoomLevel),1E5,1E5);WinPaint.maskContext.restore()},clearCanvas:function(b){b=b!=null?b:true;WinPaint.mediaId=0;WinPaint.dirty=true;WinPaint.context.clearRect(0,
0,WinPaint.canvas.width,WinPaint.canvas.height);WinPaint.viewportContext.clearRect(0,0,WinPaint.viewport.width,WinPaint.viewport.height);WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,WinPaint.overlay.height);WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.centerContext.clearRect(0,0,WinPaint.center.width,WinPaint.center.height);WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height);b&&WinPaint.addUndo()},
flipCanvasHorizontally:function(){WinPaint.selectionContext.drawImage(WinPaint.canvas,0,0);WinPaint.context.clearRect(0,0,WinPaint.canvas.width,WinPaint.canvas.height);WinPaint.context.save();WinPaint.context.scale(-1,1);if(WinPaint.centerX===void 0||WinPaint.centerX===null){var b=WinPaint.findBounds();WinPaint.centerX=Math.floor(b.left+(b.right-b.left)/2);WinPaint.centerY=Math.floor(b.top+(b.bottom-b.top)/2)}WinPaint.context.drawImage(WinPaint.selection,-2*WinPaint.centerX,0);WinPaint.context.restore();
WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.addUndo();WinPaint.updateViewport()},flipCanvasVertically:function(){WinPaint.selectionContext.drawImage(WinPaint.canvas,0,0);WinPaint.context.clearRect(0,0,WinPaint.canvas.width,WinPaint.canvas.height);WinPaint.context.save();WinPaint.context.scale(1,-1);if(WinPaint.centerY===void 0||WinPaint.centerY===null){var b=WinPaint.findBounds();WinPaint.centerX=Math.floor(b.left+(b.right-b.left)/2);WinPaint.centerY=
Math.floor(b.top+(b.bottom-b.top)/2)}WinPaint.context.drawImage(WinPaint.selection,0,-2*WinPaint.centerY);WinPaint.context.restore();WinPaint.selectionContext.clearRect(0,0,WinPaint.selection.width,WinPaint.selection.height);WinPaint.addUndo();WinPaint.updateViewport()},zoomTo:function(b){WinPaint._commit();WinPaint.zoomLevel=b;WinPaint.viewportX=-($("#win-paint div.canvas").innerWidth()/WinPaint.zoomLevel-WinPaint.editingWidth)/2;WinPaint.viewportY=-($("#win-paint div.canvas").innerHeight()/WinPaint.zoomLevel-
WinPaint.editingHeight)/2;WinPaint.updateViewport();WinPaint.updateZoomLevelDisplay()},zoomIn:function(b,c){b=b!=null?b:WinPaint.viewportX;c=c!=null?c:WinPaint.viewportY;WinPaint._commit();WinPaint.zoomLevel=WinPaint.zoomLevel*2;WinPaint.zoomLevel=Math.min(WinPaint.zoomLevel,WinPaint.maxZoomLevel);WinPaint.viewportX=b+$("#win-paint div.canvas").innerWidth()/2/WinPaint.zoomLevel;WinPaint.viewportY=c+$("#win-paint div.canvas").innerHeight()/2/WinPaint.zoomLevel;WinPaint.updateViewport();WinPaint.updateZoomLevelDisplay()},
zoomOut:function(b,c){b=b!=null?b:WinPaint.viewportX;c=c!=null?c:WinPaint.viewportY;WinPaint._commit();WinPaint.zoomLevel=WinPaint.zoomLevel/2;WinPaint.zoomLevel=Math.max(WinPaint.zoomLevel,WinPaint.minZoomLevel);WinPaint.viewportX=b-WinPaint.mask.width/2/WinPaint.zoomLevel;WinPaint.viewportY=c-WinPaint.mask.height/2/WinPaint.zoomLevel;var d=$("#win-paint div.canvas").innerWidth(),e=$("#win-paint div.canvas").innerHeight();if(WinPaint.viewportX<0)WinPaint.viewportX=0;if((WinPaint.editingWidth-WinPaint.viewportX)*
WinPaint.zoomLevel<d)WinPaint.viewportX=WinPaint.editingWidth-d/WinPaint.zoomLevel;if(WinPaint.viewportY<0)WinPaint.viewportY=0;if((WinPaint.editingHeight-WinPaint.viewportY)*WinPaint.zoomLevel<e)WinPaint.viewportY=WinPaint.editingHeight-e/WinPaint.zoomLevel;if(WinPaint.editingWidth*WinPaint.zoomLevel<=d&&WinPaint.editingHeight*WinPaint.zoomLevel<=e){WinPaint.viewportX=-(d/WinPaint.zoomLevel-WinPaint.editingWidth)/2;WinPaint.viewportY=-(e/WinPaint.zoomLevel-WinPaint.editingHeight)/2}WinPaint.updateViewport();
WinPaint.updateZoomLevelDisplay()},updateZoomLevelDisplay:function(){$("#win-paint li.indicator").removeClass("active");var b=false;$("#win-paint li.indicator").each(function(){if(!b){var c=parseFloat($(this).attr("data-value"));if(WinPaint.zoomLevel<=c){$(this).addClass("active");b=true}}})},toggleCenter:function(){WinPaint.centerVisible?WinPaint.clearCenter():WinPaint.drawCenter()},toggleGrid:function(){WinPaint.gridVisible?WinPaint.clearGrid():WinPaint.drawGrid()},scaleSelection:function(b,c){var d=
WinPaint.selectionWidth*b,e=WinPaint.selectionHeight*c;WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height);WinPaint.bufferContext.drawImage(WinPaint.selection,0,0);WinPaint.selectionContext.clearRect(0,0,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.selectionContext.drawImage(WinPaint.buffer,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,0,0,d,e);WinPaint.selectionWidth=d;WinPaint.selectionHeight=e;WinPaint.overlayContext.clearRect(0,0,WinPaint.overlay.width,
WinPaint.overlay.height);WinPaint.overlayContext.drawImage(WinPaint.selection,0,0,WinPaint.selectionWidth,WinPaint.selectionHeight,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight);WinPaint.drawSelectionOutline();WinPaint.bufferContext.clearRect(0,0,WinPaint.buffer.width,WinPaint.buffer.height)},getSelectionLocation:function(b,c){var d=WinPaint.resizeHandleSize/2,e=WinPaint.selectionWidth/2,f=WinPaint.selectionHeight/2;return WinPaint.isContained(b,c,WinPaint.rotationLeverX,
WinPaint.rotationLeverY,WinPaint.rotateLeverSize,WinPaint.rotateLeverSize)?"rotation_lever":WinPaint.isContained(b,c,WinPaint.selectionX-d,WinPaint.selectionY-d,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize)?"nw_corner":WinPaint.isContained(b,c,WinPaint.selectionX+WinPaint.selectionWidth-d,WinPaint.selectionY-d,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize)?"ne_corner":WinPaint.isContained(b,c,WinPaint.selectionX+WinPaint.selectionWidth-d,WinPaint.selectionY+WinPaint.selectionHeight-d,
WinPaint.resizeHandleSize,WinPaint.resizeHandleSize)?"se_corner":WinPaint.isContained(b,c,WinPaint.selectionX-d,WinPaint.selectionY+WinPaint.selectionHeight-d,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize)?"sw_corner":WinPaint.isContained(b,c,WinPaint.selectionX+e-d,WinPaint.selectionY-d,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize)?"n_edge":WinPaint.isContained(b,c,WinPaint.selectionX+WinPaint.selectionWidth-d,WinPaint.selectionY+f-d,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize)?
"e_edge":WinPaint.isContained(b,c,WinPaint.selectionX+e-d,WinPaint.selectionY+WinPaint.selectionHeight-d,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize)?"s_edge":WinPaint.isContained(b,c,WinPaint.selectionX-d,WinPaint.selectionY+f-d,WinPaint.resizeHandleSize,WinPaint.resizeHandleSize)?"w_edge":WinPaint.isContained(b,c,WinPaint.selectionX,WinPaint.selectionY,WinPaint.selectionWidth,WinPaint.selectionHeight)?"inside":"outside"},isContained:function(b,c,d,e,f,g){return b>=d&&b<=d+f&&c>=e&&c<=e+
g},getRotationBoundingBox:function(b,c,d,e,f,g){var h=c+e/2,j=d+f/2,k=c+e,l=d+f,e=WinPaint.transformX(c,d,h,j,g),f=WinPaint.transformY(c,d,h,j,g),m=WinPaint.transformX(k,d,h,j,g),d=WinPaint.transformY(k,d,h,j,g),n=WinPaint.transformX(k,l,h,j,g),k=WinPaint.transformY(k,l,h,j,g),q=WinPaint.transformX(c,l,h,j,g),g=WinPaint.transformY(c,l,h,j,g),c=Math.min.apply(Math,[e,m,n,q]),h=Math.max.apply(Math,[e,m,n,q]),j=Math.min.apply(Math,[f,d,k,g]),f=Math.max.apply(Math,[f,d,k,g]);return WinPaint.findBoxBounds(b,
c,j,Math.abs(h-c),Math.abs(f-j))},transformX:function(b,c,d,e,f){return d+(b-d)*Math.cos(f)+(c-e)*Math.sin(f)},transformY:function(b,c,d,e,f){return e-(b-d)*Math.sin(f)+(c-e)*Math.cos(f)},distance:function(b,c){var d=c.y-b.y;return Math.sqrt(Math.pow(c.x-b.x,2)+Math.pow(d,2))},angle:function(b,c){return Math.atan2(c.x-b.x,c.y-b.y)}},WinSVGPaint={init:function(){$("#win-svgpaint > .save").unbind().click(function(){WinSVGPaint.save();WinSVGPaint.hide();return false});$("#win-svgpaint > .exit").unbind().click(function(){IDE.confirmDialog("Do you want to discard your changes?",
function(){WinSVGPaint.hide()},"Discard Changes","Cancel",function(){});$("#confirm").modal();return false});WinSVGPaint.adjustWindow();$(window).resize(WinSVGPaint.adjustWindow)},adjustWindow:function(){var b=$("#win-svgpaint");b.hasClass("hidden")||b.find("iframe").css("height",b.innerHeight()-b.find(".buttonbar").outerHeight())},hide:function(){var b=$("#win-svgpaint");b.addClass("hidden");b.find("iframe").attr("src")!="ide/imgs/blank.png"&&b.find("iframe").attr("src","ide/imgs/blank.png")},
enableDialogButtons:function(b){b?$("#win-svgpaint .buttonbar button").removeClass("disable"):$("#win-svgpaint .buttonbar button").addClass("disable")},edit:function(b,c,d,e,f){WinSVGPaint.doneCallback=f;c?$("#win-svgpaint").removeClass("hidden").find("iframe").attr("src","ide/paint/index.html?image_url="+escape(c)+"&cx="+d+"&cy="+e+"&initTool=select&dimensions="+Runtime.stage.getWidth()+","+Runtime.stage.getHeight()):$("#win-svgpaint").removeClass("hidden").find("iframe").attr("src","ide/paint/index.html?dimensions="+
Runtime.stage.getWidth()+","+Runtime.stage.getHeight());$("#win-svgpaint iframe")[0].onload=function(){$("#win-svgpaint iframe").focus()};WinSVGPaint.adjustWindow();return false},save:function(){$("#win-svgpaint iframe")[0].contentWindow.svgCanvas.save();return false},_doneCallback:function(b,c,d){$.ajax({url:"api/medialibsave.aspx",type:"POST",data:{t:"drawing",d:b},success:function(b){b=JSON.parse(b);if(b.result)WinSVGPaint.mediaId=b.id;WinSVGPaint.doneCallback&&WinSVGPaint.doneCallback("/assets/user/"+
WinSVGPaint.mediaId+".svg",c,d);WinSVGPaint.hide()}})}},WinLessons={cMilestoneButtonTimeout:3E3,cDoForMeTimeout:1E4,_doForMeId:null,_locPrefix:"",sideImage:null,_listeners:[],playIndex:0,helpButton:null,_enableButtonTimeout:null,_nextButtonTimeout:null,_id:1,_scriptNumber:0,_stepNumber:0,_displayEndNotes:!0,_displayHidePlaybar:!1,globalVars:{},blocksUsed:[],resourcesUsed:[],currentPbIdx:-2,currentPlayStep:null,init:function(){$("#annotations ul").sortable({handle:".context,.info",update:function(){$("#annotations li").each(function(b){$(this).find("h1").text(b+
1);$(this).data("info")})}});WinCode.addChangeListener(WinLessons.blocksChanged);$("#lesson-dialog div.buttons > a").click(function(){UIUtil.hideDialog($("#lesson-dialog"),function(){$("#lesson-dialog").empty();WinLessons.playAnnotations()});return false});return false},addListener:function(b){WinLessons._listeners.indexOf(b)<0&&WinLessons._listeners.push(b)},removeListener:function(b){b=WinLessons._listeners.indexOf(b);b>=0&&WinLessons._listeners.splice(b,1)},removeAllListeners:function(){WinLessons._listeners=
[]},_broadcast:function(b){for(var c=0;c<WinLessons._listeners.length;c++)WinLessons._listeners[c](b)},initializeLargestId:function(){WinLessons._id=1;for(var b=0;b<Runtime.background.scripts.length;b++)WinLessons._findLargestId(Runtime.background.scripts[b]);WinLessons._findLargestId(Runtime.background.scripts);for(b=0;b<Runtime.sprites.length;b++)for(var c=Runtime.sprites[b].scripts,d=0;d<c.length;d++)WinLessons._findLargestId(c[d]);WinLessons._id++;return WinLessons._id},show:function(){$("#annotations li").length==
0?WinLessons._loadLesson(WinLessons._show):WinLessons._show()},_show:function(){$("#win-lessons-details input").val()||$("#win-lessons-details input").val(IDE.currentProjectName);$("#win-lessons-details textarea.description").val()||$("#win-lessons-details textarea.description").val(IDE.currentProjectDescription);var b=$("#win-lessons-desc");b.find(".buttonbar").empty();var c=$('<a href="#" class="btn-right btn-round medium action">'+g_loc.getText("winlessons.btncreatenew")+"</a>");b.find(".buttonbar").append(c);
c.click(function(){if(!$("#win-lessons-details input").val()||!$("#win-lessons-details textarea").val())IDE.showInfoDialog("Error","Please enter a lesson name and description");else{for(var b=0;b<Runtime.background.scripts.length;b++)Scripts.clearIds(Runtime.background.scripts[b]);for(b=0;b<Runtime.sprites.length;b++)for(var c=Runtime.sprites[b].scripts,f=0;f<c.length;f++)Scripts.clearIds(c[f]);$("#annotations ul").empty();WinLessons.constructFromProject();$.modal.close();WinLessons.showList()}return false});
c=$('<a href="#" class="btn-right btn-round medium secondary">'+g_loc.getText("winlessons.btncancel")+"</a>");b.find(".buttonbar").append(c);c.click(function(){$.modal.close();return false});if($("#win-lessons li").length>0){c=$('<a href="#" class="btn-right btn-round medium secondary">'+g_loc.getText("winlessons.btnupdateexisting")+"</a>");b.find(".buttonbar").append(c);c.click(function(){if(!$("#win-lessons-details input").val()||!$("#win-lessons-details textarea").val())IDE.showInfoDialog("Error",
"Please enter a lesson name and description");else{$.modal.close();WinLessons.constructFromProject();WinLessons.showList()}return false});c=$('<a href="#" class="btn-right btn-round medium secondary">'+g_loc.getText("winlessons.btneditexisting")+"</a>");b.find(".buttonbar").append(c);c.click(function(){if(!$("#win-lessons-details input").val()||!$("#win-lessons-details textarea").val())IDE.showInfoDialog("Error","Please enter a lesson name and description");else{$.modal.close();WinLessons.showList()}return false});
c=$('<a href="#" class="btn-right btn-round medium secondary">'+g_loc.getText("winlessons.btnremove")+"</a>");b.find(".buttonbar").append(c);c.click(function(){$.modal.close();$("#annotations ul").empty();$("#wincmd-runlesson").addClass("disabled");var b=Runtime.stage.captureScreenshot();IDE._doProjectSave(IDE.currentProjectName,IDE.currentProjectDescription,b,false,true,Runtime.currentLevelIndex,null,function(){WinLessons._saveLesson()});return false})}b.css("height",window.innerHeight).css("width",
window.innerWidth).modal()},showList:function(){$("#win-lessons").modal();$("#win-lessons .saveplayBtn").unbind().click(function(){var b=Runtime.stage.captureScreenshot();IDE.currentProjectDescription=$("#win-lessons-details textarea").val();IDE._doProjectSave($("#win-lessons-details input").val(),$("#win-lessons-details textarea").val(),b,false,true,Runtime.currentLevelIndex,null,function(){WinLessons._saveLesson(function(){window.location="/ide?l="+IDE.currentProjectId})});return false});$("#win-lessons .saveBtn").unbind().click(function(){var b=
Runtime.stage.captureScreenshot();IDE.currentProjectDescription=$("#win-lessons-details textarea").val();IDE._doProjectSave($("#win-lessons-details input").val(),$("#win-lessons-details textarea").val(),b,false,true,Runtime.currentLevelIndex,null,function(){WinLessons._saveLesson()});return false});$("#win-lessons .closeBtn").unbind().click(function(){$.modal.close();return false});$("#win-lessons .adddialogBtn").unbind().click(WinLessons.addDialog);$("#win-lessons .addfreeplayBtn").unbind().click(WinLessons.addFreeplay);
$("#win-lessons .addcheckpointBtn").unbind().click(WinLessons.addCheckpoint);$("#win-lessons .toggleskipBtn").unbind().click(WinLessons.toggleAllSkip);$("#win-lessons .showhideskipBtn").unbind().click(WinLessons.toggleShowHideSkip);$("#win-lessons").css("height",window.innerHeight).css("width",window.innerWidth).modal();return false},hide:function(){$.modal.close()},reset:function(){playIndex=0;helpButton=null;_id=1;currentPbIdx=-2;$("#annotations ul").empty();$("#win-lessons-details input").val("");
$("#win-lessons-details textarea").val("")},_getId:function(){return WinLessons._id++},getDetails:function(){return{name:$("#win-lessons-details input").val(),description:$("#win-lessons-details textarea.description").val(),showPlayer:$("#win-lessons-details .showplayer")[0].checked,instructions:$("#win-lessons-details textarea.instructions").val()}},setDetails:function(b){WinLessons.ownerid=b.ownerid;var c="";WinLessons._locPrefix&&(c=g_loc.getText(WinLessons._locPrefix+"name",c));$("#win-lessons-details input").val(c);
c="";b.description&&(c=b.description);WinLessons._locPrefix&&(c=g_loc.getText(WinLessons._locPrefix+"description",c));$("#win-lessons-details textarea").val(c);IDE.currentProjectDescription=c;$("#win-lessons-details .showplayer")[0].checked=b.showPlayer?true:false;c="";b.instructions&&(c=b.instructions);WinLessons._locPrefix&&(c=g_loc.getText(WinLessons._locPrefix+"instructions",c));$("#win-lessons-details textarea.instructions").val(c);IDE.currentProjectInstructions=c},getNotes:function(){var b=
{globalVars:WinLessons.globalVars,blocks:WinLessons.blocksUsed,resources:WinLessons.resourcesUsed,notes:[]};$("#annotations li").each(function(){b.notes.push($(this).data("info"))});var c=0,d;do{d=WinLessons._findSkipRange(b.notes,c);if(d!=null){b.notes[d[0]].snapshot=WinLessons.trimSteps(b.notes,d[1]);c=d[1]+1}}while(d!=null);for(c=0;c<b.notes.length;c++)if(b.notes[c].milestoneType==4)b.notes[c].snapshot=WinLessons.trimSteps(b.notes,c);return b},jumpToSnapshot:function(b){var c=0;$("#annotations li").each(function(d){var e=
$(this).data("info");if(e.milestoneType==4){if(c==b){e=e.snapshot;e.background.canvasWidth=$(Runtime.stage.container).innerWidth();e.background.canvasHeight=$(Runtime.stage.container).innerHeight();e=JSON.stringify(e);ObjectIO.deserialize(e,function(){WinLessons.currentPbIdx=d;var b=IDE._ignoreUpdates;IDE._ignoreUpdates=false;WinLessons.playAnnotations();IDE._ignoreUpdates=b});return false}c++}})},setNotes:function(b){WinLessons.globalVars=b.globalVars;WinLessons.blocksUsed=b.blocks;WinLessons.resourcesUsed=
b.resources;WinLessons.initialState=b.initialState;WinLessons._makeNotes(b.notes)},_makeNotes:function(b){var c=$("#annotations ul");c.empty();for(var d=0;d<b.length;d++){var e=b[d],f=e.text;e.text=f;var g=!e.block&&!e.attached&&!e.resource&&!e.properties;if(e.milestoneType==1){if(WinLessons._locPrefix){f=g_loc.getText(WinLessons._locPrefix+"-1-"+e.id,f);e.text=f}f=$('<li class="sortable"><div class="context"><h1 class="milestone">'+($("#annotations li").length+1)+'</h1></div><div class="info">Milestone</div><div class="content"><span>'+
f+'</span></div><a href="#" class="delete">X</a></li>')}else if(e.milestoneType==2){if(WinLessons._locPrefix){f=g_loc.getText(WinLessons._locPrefix+"-2-"+e.id,f);e.text=f}f=$('<li class="sortable"><div class="context"><h1 class="freeplay">'+($("#annotations li").length+1)+'</h1></div><div class="info">Freeplay</div><div class="content"><span>'+f+'</span></div><a href="#" class="delete">X</a></li>')}else if(e.milestoneType==3){if(WinLessons._locPrefix){f=g_loc.getText(WinLessons._locPrefix+"-3-"+e.id,
f);e.text=f}f=$('<li class="sortable"><div class="context"><h1 class="dialog">'+($("#annotations li").length+1)+'</h1></div><div class="info">Dialog</div><div class="content"><span>'+f+'</span></div><a href="#" class="delete">X</a></li>')}else if(e.milestoneType==4){if(WinLessons._locPrefix){f=g_loc.getText(WinLessons._locPrefix+"-4-"+e.id,f);e.text=f}f=$('<li class="sortable checkpoint"><div class="context"><h1 class="checkpoint">'+($("#annotations li").length+1)+'</h1></div><div class="info">Checkpoint</div><div class="content"><span>'+
f+'</span></div><a href="#" class="delete">X</a></li>')}else{if(g){if(WinLessons._locPrefix){f=g_loc.getText(WinLessons._locPrefix+"-0-"+e.id,f);e.text=f}f=$('<li><div class="context"><h1>'+($("#annotations li").length+1)+'</h1></div><div class="info"></div><div class="content"><span>'+f+'</span></div><a href="#" class="delete">X</a></li>')}else{if(WinLessons._locPrefix){f=g_loc.getText(WinLessons._locPrefix+e.id,f);e.text=f}f=$('<li class="unsortable"><div class="context"><h1>'+($("#annotations li").length+
1)+'</h1><label class="skip"><input type="checkbox"'+(e.skip?" checked":"")+'/>Skip</label></div><div class="info"></div><div class="content"><span>'+f+'</span></div><a href="#" class="delete">X</a></li>')}if(e.spriteName)(g=Sprites.getSpriteByName(e.spriteName))&&g.costumes.length>0&&(g.costumes[0].imgPreview?f.find("h1").after('<br/><img src="'+g.costumes[0].imgPreview+'"/>'):f.find("h1").after('<br/><img src="'+g.costumes[0].img+'"/>'));else Runtime.background.costumes.length>0&&(Runtime.background.costumes[0].imgPreview?
f.find("h1").after('<br/><img src="'+Runtime.background.costumes[0].imgPreview+'"/>'):f.find("h1").after('<br/><img src="'+Runtime.background.costumes[0].img+'"/>'));if(e.block){g=WinLessons.makeInfo(e);f.find(".content").append('<span class="sinfo">(Script '+(e.scriptNum+1)+", Step "+(e.stepNum+1)+")</span>");f.find(".info").append(g.img)}else if(e.resource){g=getFileExt(e.resource);if(g==".mp3"||g==".wav")f.find(".info").append('<img src="ide/imgs/content/sound.png"/>');else if(g==".actor")(g=
Sprites.getSpriteByName(e.spriteName))&&g.costumes.length>0&&(g.costumes[0].imgPreview?f.find(".info").append('<img src="'+g.costumes[0].imgPreview+'"/>'):f.find(".info").append('<img src="'+g.costumes[0].img+'"/>'));else(g=Sprites.getSpriteByName(e.spriteName))&&g.costumes.length>0?g.costumes[0].imgPreview?f.find(".info").append('<img src="'+g.costumes[0].imgPreview+'"/>'):f.find(".info").append('<img src="'+e.resource+'"/>'):f.find(".info").append('<img src="'+e.resource+'"/>')}else if(e.block==
null){if(e.attached&&e.attached.length>=3){g=e.name?WinLessons.makeBlockByName({block:e.attached[0],name:e.name,label:e.labelText}):WinLessons.makeBlockByName({block:e.attached[0]});f.find(".content").append('<span class="sinfo">(Script '+(e.scriptNum+1)+", Step "+(e.stepNum+1)+")</span>");if(g){g.x=g.y=0;g._computeBounds();f.find(".info").append(g.getImage())}f.find(".info").append("<br/>set value at #"+(e.attached[2]+1)+" to "+e.attached[3])}}else if(e.attached.length>=3){g=e.name?WinLessons.makeBlockByName({block:e.attached[0],
name:e.name,label:e.labelText}):WinLessons.makeBlockByName({block:e.attached[0]});f.find(".content").append('<span class="sinfo">(Script '+(e.scriptNum+1)+", Step "+(e.stepNum+1)+")</span>");if(g){g.x=g.y=0;g._computeBounds();f.find(".info").append(g.getImage())}f.find(".info").append("<br/>set value at #"+(e.attached[2]+1)+" to "+e.attached[3])}}if(f.find("label.skip input").length>0)f.find("label.skip input").click(WinLessons._enableSkip)[0].checked=e.skip;f.click(WinLessons._selectEvent);f.find(".content").click(WinLessons._editEvent);
f.find("a.delete").click(WinLessons._deleteEvent);f.data("info",e);c.append(f)}b.length>0&&IDE.currentProjectId?$("#wincmd-runlesson").removeClass("disabled"):$("#wincmd-runlesson").addClass("disabled")},toggleShowHideSkip:function(){$("#annotations li.collapsed").length>0?$("#annotations li").removeClass("collapsed"):$("#annotations input[type=checkbox]").each(function(){this.checked&&$(this).parents("li").addClass("collapsed")})},toggleAllSkip:function(){var b=$("#annotations input[type=checkbox]");
b.length>0&&b[0].checked?b.each(function(){this.checked=false;var b=$(this).parents("li").data("info");if(b){b.skip=this.checked;$(this).data("info",b)}}):b.each(function(){this.checked=true;var b=$(this).parents("li").data("info");if(b){b.skip=this.checked;$(this).data("info",b)}})},addNote:function(){var b=$("#annotations li.selected");$("#annotations ul li textarea").blur();$("#annotations ul li").removeClass("selected");var c={text:"<div><p>"+g_loc.getText("winlessons.addnotetext")+"</p></div>",
block:null,spriteName:null,attached:null,resource:null,id:WinLessons._getId()},d=$('<li class="selected"><div class="context"><h1>'+($("#annotations li").length+1)+'</h1><label class="skip"><input type="checkbox"'+(c.skip?" checked":"")+'/>Skip</label></div><div class="info"></div><div class="content"><span>'+c.text+'</span></div><a href="#" class="delete">X</a></li>');if(d.find("label.skip input").length>0)d.find("label.skip input").click(WinLessons._enableSkip)[0].checked=c.skip;d.click(WinLessons._selectEvent);
d.find(".content").click(WinLessons._editEvent);d.find("a.delete").click(WinLessons._deleteEvent);if(b.length>0){b.after(d);$("#annotations li").each(function(b){$(this).find("h1").text(b+1);$(this).data("info")})}else{$("#annotations ul").append(d);$("#annotations").animate({scrollTop:$("#annotations")[0].scrollHeight},1E3)}d.data("info",c);return false},addCheckpoint:function(){var b=$("#annotations li.selected");$("#annotations ul li textarea").blur();$("#annotations ul li").removeClass("selected");
var c={text:"<div><p>"+g_loc.getText("winlessons.addcheckpointtext")+"</p></div>",milestoneType:4,block:null,spriteName:null,attached:null,resource:null,id:WinLessons._getId()},d=$('<li class="sortable checkpoint"><div class="context"><h1 class="checkpoint">'+($("#annotations li").length+1)+'</h1></div><div class="info">Checkpoint</div><div class="content"><span>'+c.text+'</span></div><a href="#" class="delete">X</a></li>');if(d.find("label.skip input").length>0)d.find("label.skip input").click(WinLessons._enableSkip)[0].checked=
c.skip;d.click(WinLessons._selectEvent);d.find(".content").click(WinLessons._editEvent);d.find("a.delete").click(WinLessons._deleteEvent);if(b.length>0){b.after(d);$("#annotations li").each(function(b){$(this).find("h1").text(b+1);$(this).data("info")})}else{$("#annotations ul").append(d);$("#annotations").animate({scrollTop:$("#annotations")[0].scrollHeight},1E3)}d.data("info",c);return false},addDialog:function(){var b=$("#annotations li.selected");$("#annotations ul li textarea").blur();$("#annotations ul li").removeClass("selected");
var c={text:"<div><p>"+g_loc.getText("winlessons.adddialogtext")+"</p></div>",milestoneType:3,block:null,spriteName:null,attached:null,resource:null,id:WinLessons._getId()},d=$('<li class="sortable"><div class="context"><h1 class="dialog">'+($("#annotations li").length+1)+'</h1><label class="skip"><input type="checkbox"'+(c.skip?" checked":"")+'/>Skip</label></div><div class="info">Dialog</div><div class="content"><span>'+c.text+'</span><a href="#" class="delete">X</a></li>');if(d.find("label.skip input").length>
0)d.find("label.skip input").click(WinLessons._enableSkip)[0].checked=c.skip;d.click(WinLessons._selectEvent);d.find(".content").click(WinLessons._editEvent);d.find("a.delete").click(WinLessons._deleteEvent);if(b.length>0){b.after(d);$("#annotations li").each(function(b){$(this).find("h1").text(b+1);$(this).data("info")})}else{$("#annotations ul").append(d);$("#annotations").animate({scrollTop:$("#annotations")[0].scrollHeight},1E3)}d.data("info",c);return false},addFreeplay:function(){var b=$("#annotations li.selected");
$("#annotations ul li textarea").blur();$("#annotations ul li").removeClass("selected");var c={text:"<div><p>"+g_loc.getText("winlessons.addfreeplaytext")+"</p></div>",milestoneType:2,block:null,spriteName:null,attached:null,resource:null,id:WinLessons._getId()},d=$('<li class="sortable"><div class="context"><h1 class="freeplay">'+($("#annotations li").length+1)+'</h1><label class="skip"><input type="checkbox"'+(c.skip?" checked":"")+'/>Skip</label></div><div class="info">Freeplay</div><div class="content"><span>'+
c.text+'</span><a href="#" class="delete">X</a></li>');if(d.find("label.skip input").length>0)d.find("label.skip input").click(WinLessons._enableSkip)[0].checked=c.skip;d.click(WinLessons._selectEvent);d.find(".content").click(WinLessons._editEvent);d.find("a.delete").click(WinLessons._deleteEvent);if(b.length>0){b.after(d);$("#annotations li").each(function(b){$(this).find("h1").text(b+1);$(this).data("info")})}else{$("#annotations ul").append(d);$("#annotations").animate({scrollTop:$("#annotations")[0].scrollHeight},
1E3)}d.data("info",c);return false},addMilestone:function(){var b=$("#annotations li.selected");$("#annotations ul li textarea").blur();$("#annotations ul li").removeClass("selected");var c={text:"<div><p>"+g_loc.getText("winlessons.addmilestonetext")+"</p></div>",milestoneType:1,block:null,spriteName:null,attached:null,resource:null,id:WinLessons._getId()},d=$('<li class="sortable"><div class="context"><h1 class="milestone">'+($("#annotations li").length+1)+'</h1><label class="skip"><input type="checkbox"'+
(c.skip?" checked":"")+'/>Skip</label></div><div class="info">Milestone</div><div class="content"><span>'+c.text+'</span><a href="#" class="delete">X</a></li>');if(d.find("label.skip input").length>0)d.find("label.skip input").click(WinLessons._enableSkip)[0].checked=c.skip;d.click(WinLessons._selectEvent);d.find(".content").click(WinLessons._editEvent);d.find("a.delete").click(WinLessons._deleteEvent);if(b.length>0){b.after(d);$("#annotations li").each(function(b){$(this).find("h1").text(b+1);$(this).data("info")})}else{$("#annotations ul").append(d);
$("#annotations").animate({scrollTop:$("#annotations")[0].scrollHeight},1E3)}d.data("info",c);return false},_enableSkip:function(){var b=$(this).parents("li").data("info");if(b){b.skip=$(this)[0].checked;$(this).data("info",b)}},_selectEvent:function(){if(!$(this).hasClass("selected")){$("#annotations ul li textarea").blur();$("#annotations ul li").removeClass("selected");$(this).addClass("selected")}},_editEvent:function(){if($(this).parents("li").find("textarea").length>0)return false;$("#annotations ul li textarea").blur();
var b=$(this).parents("li").data("info").text,c=$("<textarea></textarea>");c.blur(WinLessons._editDoneEvent).keypress(function(b){b.which==13&&$(this)[0].blur()});c.val(b);$(this).find("span:first").empty().append(c);c.focus()},_editDoneEvent:function(){var b=$(this).val(),c=$(this).parents("li"),d=c.data("info");d.text=b;c.data("info",d);c.find("span:first").empty().html(b);$("#annotations li").each(function(b){$(this).find("h1").removeClass("hidden").text(b+1);$(this).data("info")});c.find(".content").click(WinLessons._editEvent)},
_deleteEvent:function(){$(this).parents("li").detach();return false},_refreshEvent:function(){var b=$(this).parents("li"),c=b.data("info"),d=WinLessons._makeDefaultStepNote(c);b.find("> span").empty().append(d);c.text="<div>"+d+"</div>";return false},_makeDefaultStepNote:function(b){var c,d;if(b.block!=null)if(b.block.substring(0,5)=="value")if(b.attached==null){c=g_loc.formatText("lessontitle.label",b.spriteName?b.spriteName:"Stage");d=g_loc.formatText("generate.label",WinLessons._createBlockLabel(b.block),
b.spriteName?b.spriteName:"Stage")}else if(b.attached.length==3){c=g_loc.formatText("lessontitle.addtolabelsocket",b.spriteName?b.spriteName:"Stage");d=g_loc.formatText("generate.addtolabelsocket",WinLessons._createBlockLabel(b.block),WinLessons._createBlockLabel(b.attached[0]),b.spriteName?b.spriteName:"Stage")}else{if(b.attached.length==2){c=g_loc.formatText("lessontitle.addtoblocksocket",b.spriteName?b.spriteName:"Stage");d=g_loc.formatText("generate.addtoblocksocket",WinLessons._createBlockLabel(b.block),
WinLessons._createBlockLabel(b.attached[0]),b.spriteName?b.spriteName:"Stage")}}else if(b.attached==null){c=g_loc.formatText("lessontitle.block",b.spriteName?b.spriteName:"Stage");d=g_loc.formatText("generate.block",WinLessons._createBlockLabel(b.block),b.spriteName?b.spriteName:"Stage")}else if(b.attached.length==3){c=g_loc.formatText("lessontitle.blockcontainer",b.spriteName?b.spriteName:"Stage");d=g_loc.formatText("generate.blockcontainer",WinLessons._createBlockLabel(b.block),WinLessons._createBlockLabel(b.attached[0]),
b.spriteName?b.spriteName:"Stage")}else{c=g_loc.formatText("lessontitle.blocknext",b.spriteName?b.spriteName:"Stage");d=g_loc.formatText("generate.blocknext",WinLessons._createBlockLabel(b.block),WinLessons._createBlockLabel(b.attached[0]),b.spriteName?b.spriteName:"Stage")}else if(b.attached){c=g_loc.formatText("lessontitle.setvalue",b.spriteName?b.spriteName:"Stage");d=g_loc.formatText("generate.setvalue",WinLessons._createBlockLabel(b.attached[0]),b.attached[3],b.spriteName?b.spriteName:"Stage")}else if(b.resource){c=
getFileExt(b.resource);d=false;if(b.spriteName){var e=Sprites.getSpriteByName(b.spriteName);if(e.costumes.length>1)for(var f=1;f<e.costumes.length;f++)if(e.costumes[f].img==b.resource){d=true;break}if(!d&&e.sounds.length>0)for(f=0;f<e.sounds.length;f++)if(e.sounds[f].sound==b.resource){d=true;break}}if(!b.spriteName||d)if(c==".mp3"||c==".wav")if(b.spriteName){c=g_loc.formatText("lessontitle.addsound",b.spriteName,b.resourceName);d=g_loc.formatText("generate.addsound",b.resourceName,b.spriteName)}else{c=
g_loc.formatText("lessontitle.bgsound",b.resourceName);d=g_loc.formatText("generate.bgsound",b.resourceName)}else if(b.spriteName){c=g_loc.formatText("lessontitle.addcostume",b.spriteName);d=g_loc.formatText("generate.addcostume",b.resourceName,b.spriteName)}else{c=g_loc.getText("lessontitle.bgimg");d=g_loc.formatText("generate.bgimg",b.resourceName)}else if(b.resource=="ide/imgs/blank.png"){c=g_loc.getText("lessontitle.addsprite");d=g_loc.formatText("generate.addblank")}else if(getFileExt(b.resource)==
".actor"){c=g_loc.getText("lessontitle.addtblock");d=g_loc.formatText("generate.addtblock",WinLessons._createTBlockLabel(b.resource,b.spriteName))}else{c=g_loc.getText("lessontitle.addsprite");d=g_loc.formatText("generate.addsprite",b.spriteName)}}else if(b.properties){c=g_loc.formatText("lessontitle.property",b.spriteName);for(e in b.properties)d=g_loc.formatText("generate.property",e,b.spriteName,b.properties[e])}else d=b.text;b="<div>";c&&(b=b+("<h2>"+c+"</h2>"));return b+("<p>"+d+"</p>")+"</div>"},
trimSteps:function(b,c){var d=ObjectIO.serialize(),d=JSON.parse(d);if(!b){b=[];$("#annotations li").each(function(){b.push($(this).data("info"))})}if(b){for(var e=c+1;e<b.length;e++)b[e].block?WinLessons.trimBlock(d,b[e].spriteName,b[e].id):b[e].resource&&WinLessons.trimResource(d,b[e].spriteName,b[e].resource);for(e=0;e<d.sprites.length;e++)if(d.sprites[e].costumes.length==0){d.sprites.splice(e,1);e--}}return d},_findSkipRange:function(b,c){if(!b){b=[];$("#annotations li").each(function(){b.push($(this).data("info"))})}if(b){for(c||
(c=0);c<b.length;c++)if(b[c].skip)break;if(c<b.length){for(var d=c;d<b.length;d++)if(!b[d].skip)break;return[c,d-1]}}return null},trimResource:function(b,c,d){if(c)for(var e=0;e<b.sprites.length;e++){if(b.sprites[e].label==c){if(b.sprites[e].classname)b.sprites.splice(e,1);else{c=false;b=b.sprites[e];for(e=0;e<b.costumes.length;e++)if(b.costumes[e].img==d){b.costumes.splice(e,1);c=true;break}if(!c)for(e=0;e<b.sounds.length;e++)if(b.sounds[e].sound==d){b.sounds.splice(e,1);break}}break}}else{c=false;
for(e=0;e<b.background.backgrounds.length;e++)if(b.background.backgrounds[e].img==d){b.background.backgrounds.splice(e,1);c=true;break}if(!c)for(e=0;e<b.background.sounds.length;e++)if(b.background.sounds[e].sound==d){b.background.sounds.splice(e,1);break}}},findBlockAndTrim:function(b,c){if(b.containers)for(var d=0;d<b.containers.length;d++)if(b.containers[d]){if(b.containers[d].id==c){b.containers.splice(d,1);return}WinLessons.findBlockAndTrim(b.containers[d],c)}if(b.values)for(d=0;d<b.values.length;d++)if(b.values[d].id==
c){b.values[d].type="string";b.values[d].value="";delete b.values[d].func;return}b.next&&(b.next.id==c?delete b.next:WinLessons.findBlockAndTrim(b.next,c))},trimBlock:function(b,c,d){if(c&&b.sprites)for(var e=0;e<b.sprites.length;e++){if(b.sprites[e].label==c){if(b=b.sprites[e].scripts)for(e=0;e<b.length;e++)if(b[e].id==d){b.splice(e,1);break}else if(WinLessons.findBlockAndTrim(b[e],d))break;break}}else if(b=b.background.scripts)for(e=0;e<b.length;e++)if(b[e].id==d){b.splice(e,1);break}else if(WinLessons.findBlockAndTrim(b[e],
d))break},_findLargestId:function(b){if(b instanceof Block){if(b.id>WinLessons._id)WinLessons._id=b.id;WinLessons._findLargestId(b.label);for(var c=0;c<b._containers.length;c++)b._containers[c]!=null&&WinLessons._findLargestId(b._containers[c]);b.next!=null&&WinLessons._findLargestId(b.next)}else if(b instanceof Label){if(b.id>WinLessons._id)WinLessons._id=b.id;for(c=0;c<b._children.length;c++)WinLessons._findLargestId(b._children[c])}},_getBlockIds:function(b,c){if(c instanceof Block){b.indexOf(c.id)<
0&&b.push(c.id);for(var b=WinLessons._getBlockIds(b,c.label),d=0;d<c._containers.length;d++)c._containers[d]!=null&&(b=WinLessons._getBlockIds(b,c._containers[d]));c.next!=null&&(b=WinLessons._getBlockIds(b,c.next))}else if(c instanceof Label){b.indexOf(c.id)<0&&b.push(c.id);for(d=0;d<c._children.length;d++)b=WinLessons._getBlockIds(b,c._children[d])}return b},_actorExists:function(b,c){for(var d=false,e=0;e<b.length;e++)if(b[e].spriteName==c.label){d=true;break}for(var f=[],e=0;e<c.scripts.length;e++)f=
WinLessons._getBlockIds(f,c.scripts[e]);if(!d){for(var g=null,e=0;e<f.length&&!d;e++)for(var h=0;h<b.length;h++)if(b[h].id==f[e]){d=true;g=b[h].spriteName;console.log("rename sprite from "+b[h].spriteName+" to "+c.label);break}if(d)for(e=0;e<b.length;e++)if(b[e].spriteName==g)b[e].spriteName=c.label}return d},_assetExists:function(b,c,d,e){for(var f=0;f<b.length;f++){var g=b[f];if((e==null||g.resource==e)&&g.spriteName==c&&g.resourceName==d)return f}return-1},_replaceAsset:function(b,c,d,e,f){for(var g=
getFileExt(e),h=false,j=0;j<b.length;j++){var k=b[j];if(k.resource==e&&k.spriteName==c&&k.resourceName==d){console.log("found asset:"+c+","+d+","+e);h=true;k.used=true;break}}if(!h){for(var l=g==".mp3"||g==".wav",j=0;j<b.length;j++){k=b[j];if(k.spriteName==c&&k.resourceName==d){var m=getFileExt(k.resource);if((m=m==".mp3"||m==".wav")&&l||!m&&!l){console.log("replace resource:"+c+","+d+","+e);b[j].resource=e;b[j]._positionIndex=void 0;delete b[j]._positionIndex;h=true;k.used=true;break}}}if(!h)for(j=
0;j<b.length;j++)if(b[j].spriteName==c&&b[j]._positionIndex==f){m=getFileExt(b[j].resource);if((m=m==".mp3"||m==".wav")&&l||!m&&!l){console.log("replace resource by index:"+c+","+d+","+e);b[j].resource=e;b[j]._positionIndex=void 0;delete b[j]._positionIndex;h=true;b[j].used=true;break}}if(!h){console.log("create resource:"+c+","+d+","+e);f=b.length-1;if(g==".mp3"||g==".wav"){console.log("  sound");for(j=b.length-1;j>=0;j--){k=b[j];if(k.resource){g=getFileExt(k.resource);if((g==".mp3"||g==".wav")&&
k.spriteName==c){console.log("    index:"+j);f=j;break}}}}else{console.log("  image:"+g);for(j=b.length-1;j>=0;j--){k=b[j];if(k.resource){g=getFileExt(k.resource);if((g==".png"||g==".jpg"||g==".gif"||g==".svg")&&k.spriteName==c){console.log("    index:"+j);f=j;break}}}}c={block:null,spriteName:c,resource:e,resourceName:d,attached:null,id:WinLessons._getId(),used:true};c.text=WinLessons._makeDefaultStepNote(c);b.splice(f+1,0,c)}}},_replaceProperties:function(b,c,d,e){for(var f=false,g=0;g<b.length;g++){var h=
b[g];if(h.spriteName==c&&h.properties[d]!==void 0){console.log("replace property value:"+c+","+d);f=true;h.properties[d]=e;h.used=true;break}}if(!f){console.log("create property value:"+c+","+d);f=b.length-1;for(g=b.length-1;g>=0;g--){h=b[g];if(h.spriteName==c&&h.properties){f=g;break}}c={block:null,spriteName:c,resource:null,resourceName:null,resourceThumbnail:null,attached:null,properties:{},id:WinLessons._getId(),used:true};c.properties[d]=e;c.text=WinLessons._makeDefaultStepNote(c);b.splice(f+
1,0,c)}},constructFromProject:function(){var b=WinLessons.getNotes();WinLessons.blocksUsed=[];WinLessons.resourcesUsed=[];WinLessons._id=1;for(var c=0;c<b.notes.length;c++)if(b.notes[c].id>WinLessons._id)WinLessons._id=b.notes[c].id;for(c=0;c<Runtime.background.scripts.length;c++)WinLessons._findLargestId(Runtime.background.scripts[c]);WinLessons._findLargestId(Runtime.background.scripts);for(c=0;c<Runtime.sprites.length;c++)for(var d=Runtime.sprites[c].scripts,e=0;e<d.length;e++)WinLessons._findLargestId(d[e]);
WinLessons._id++;for(c=0;c<b.notes.length;c++){var f=b.notes[c];if(!f.block&&!f.spriteName&&!f.attached&&!f.resource)f.used=true}e={};for(c=0;c<b.notes.length;c++){f=b.notes[c];if(f.resource&&f.spriteName){d=f.spriteName;if(!d)d=Runtime.background;e[d]||(e[d]=0);f._positionIndex=e[d];e[d]++}}for(c=0;c<Runtime.background.costumes.length;c++){f=Runtime.background.costumes[c];WinLessons._replaceAsset(b.notes,null,f.name,f.img,c)}for(c=0;c<Runtime.background.sounds.length;c++){f=Runtime.background.sounds[c];
WinLessons._replaceAsset(b.notes,null,f.name,f.sound,c)}WinLessons.globalVars=Runtime.background.variables;for(c=0;c<Runtime.sprites.length;c++){d=Runtime.sprites[c];if(d.locked){d.captureScreenshot();e=WinLessons._assetExists(b.notes,d.label,d.costumes[0].name,"/assets/code/"+d.id+".actor");if(e>=0){console.log("existing tblock:"+d.label);e=b.notes[e];e._sprite=d;e.properties={x:d.spriteObj.x,y:d.spriteObj.y,rotation:d.spriteObj.rotation,rotateLock:d.spriteObj.rotateLock,scale:d.spriteObj.scale.x};
e.used=true}else{console.log("new tblock:"+d.label);e={block:null,_sprite:d,spriteName:d.label,resource:"/assets/code/"+d.id+".actor",resourceName:d.costumes[0].name,attached:null,properties:{x:d.spriteObj.x,y:d.spriteObj.y,rotation:d.spriteObj.rotation,rotateLock:d.spriteObj.rotateLock,scale:d.spriteObj.scale.x},id:WinLessons._getId(),used:true};b.notes.push(e);e.text=WinLessons._makeDefaultStepNote(e)}}else{if(WinLessons._actorExists(b.notes,d)){console.log("existing actor:"+d.label);e=WinLessons._assetExists(b.notes,
d.label,d.costumes[0].name,null);if(e>=0){console.log("existing actor - asset exists:"+d.label+","+d.costumes[0].name);e=b.notes[e];e._sprite=d;e.resource=d.costumes[0].img;e.resourceName=d.costumes[0].name;e.properties={variables:d.variables,x:d.spriteObj.x,y:d.spriteObj.y,rotation:d.spriteObj.rotation,rotateLock:d.spriteObj.rotateLock,scale:d.spriteObj.scale.x};e.used=true}else{console.log("existing actor - did not find");for(var g=false,e=0;e<b.notes.length;e++)if(b.notes[e].spriteName==d.label&&
b.notes[e].resource){console.log("existing actor - replacing first costume:"+d.label);e=b.notes[e];e._sprite=d;e.resource=d.costumes[0].img;e.resourceName=d.costumes[0].name;e.properties={variables:d.variables,x:d.spriteObj.x,y:d.spriteObj.y,rotation:d.spriteObj.rotation,rotateLock:d.spriteObj.rotateLock,scale:d.spriteObj.scale.x};e.used=true;break}}}else{console.log("new actor:"+d.label);e={block:null,_sprite:d,spriteName:d.label,resource:d.costumes[0].img,resourceName:d.costumes[0].name,attached:null,
properties:{variables:d.variables,x:d.spriteObj.x,y:d.spriteObj.y,rotation:d.spriteObj.rotation,rotateLock:d.spriteObj.rotateLock,scale:d.spriteObj.scale.x},id:WinLessons._getId(),used:true};b.notes.push(e);e.text=WinLessons._makeDefaultStepNote(e)}for(e=1;e<Runtime.sprites[c].costumes.length;e++){f=Runtime.sprites[c].costumes[e];WinLessons._replaceAsset(b.notes,d.label,f.name,f.img,e)}for(e=0;e<Runtime.sprites[c].sounds.length;e++){f=Runtime.sprites[c].sounds[e];WinLessons._replaceAsset(b.notes,
d.label,f.name,f.sound,e)}}}for(c=0;c<Runtime.sprites.length;c++){d=Runtime.sprites[c];if(d.locked)for(var h in d.varDefaults)d.variables[h]!==d.varDefaults[h]&&WinLessons._replaceProperties(b.notes,d.label,h,d.variables[h])}for(c=WinLessons._scriptNumber=0;c<Runtime.background.scripts.length;c++){WinLessons._stepNumber=0;WinLessons._constructBlocksFor(null,Runtime.background.scripts[c],b.notes);WinLessons._scriptNumber++}for(c=0;c<Runtime.sprites.length;c++){d=Runtime.sprites[c];if(d.locked)for(e=
0;e<d.scripts.length;e++){if(!d.scripts[e].hidden){WinLessons._stepNumber=0;WinLessons._constructBlocksFor(d.label,d.scripts[e],b.notes);WinLessons._scriptNumber++}}else if(!d.hiddenInSandbox&&!d.lockedInSandbox)for(e=0;e<d.scripts.length;e++){h=d.scripts[e];if(!h.hiddenInSandbox&&!h.lockedInSandbox){WinLessons._stepNumber=0;WinLessons._constructBlocksFor(d.label,h,b.notes);WinLessons._scriptNumber++}}}for(c=0;c<b.notes.length;c++)if(b.notes[c].used){b.notes[c].used=void 0;delete b.notes[c].used}else{console.log("removing: "+
c);console.log(b.notes[c]);b.notes.splice(c,1);c--}for(c=0;c<b.notes.length;c++){f=b.notes[c];if(f.resource){f._positionIndex=void 0;delete f._positionIndex}}for(c=0;c<b.notes.length;c++){f=b.notes[c];if(f.block){h=f.scriptNum;d=f.stepNum;for(e=c+1;e<b.notes.length;e++){f=b.notes[e];if(f.scriptNum==h&&f.stepNum<d)for(g=0;g<c;g++){var j=b.notes[g];if(j.scriptNum==h&&f.stepNum<j.stepNum){b.notes.splice(e,1);b.notes.splice(g,0,f);c++;break}}}}}b.blocks=[];for(c=0;c<b.notes.length;c++){f=b.notes[c];if(f.block){g=
false;for(e=0;e<b.blocks.length;e++)if(b.blocks[e].func==f.block)if(f.name){if(b.blocks[e].name==f.name){g=true;break}}else{g=true;break}g||(f.name?b.blocks.push({func:f.block,name:f.name,label:f.label,count:1}):b.blocks.push({func:f.block,count:1}))}}WinLessons.blocksUsed=b.blocks;b.resources=[];for(c=0;c<b.notes.length;c++){f=b.notes[c];if(f.resource){g=false;for(e=0;e<b.resources.length;e++)if(b.resources[e].img==f.resource||b.resources[e].sound==f.resource||f._sprite&&b.resources[e].actor&&b.resources[e].actor==
f._sprite.id){g=true;break}f.resource=="avatar://spine"&&(g=false);if(!g){e=getFileExt(f.resource);if(e==".mp3"||e==".wav")b.resources.push({sound:f.resource,img:"ide/imgs/sound.png",name:f.resourceName+e,count:1});else if(e==".actor")b.resources.push({img:f._sprite.captureScreenshot(),name:f._sprite.classname?f._sprite.classname:f._sprite.label,actor:f._sprite.id,count:1});else if(f.resource=="avatar://spine")(d=Sprites.getSpriteByName(f.spriteName))&&d.skeleton.type&&b.resources.push({img:f.resource,
name:f.spriteName,skelType:d.skeleton.type,skelParts:d.skeleton.parts,count:1});else b.resources.push({img:f.resource,name:f.resourceName+e,count:1})}f._sprite=void 0;delete f._sprite}}WinLessons.resourcesUsed=b.resources;WinLessons._makeNotes(b.notes);$("#wincmd-runlesson").removeClass("disabled");return false},_createBlockLabel:function(b){var c=findStepByFunc(b);return c?c.readName?c.readName:c.label.replace(RegExp(/{[^}]+}/g),"[ ]"):b},_createTBlockLabel:function(b,c){for(var b=getFilename(b),
d=0;d<WinLessons.resourcesUsed.length;d++)if(WinLessons.resourcesUsed[d].actor==b)return WinLessons.resourcesUsed[d].name;return c},_findBlock:function(b,c){for(var d=0;d<b.length;d++)if(b[d].id==c){console.log("found:"+c);return d}console.log("not found:"+c);return-1},_findBlockValue:function(b,c,d){for(var e=0;e<b.length;e++)if(b[e].attached&&b[e].attached[1]==c&&b[e].attached[2]==d){console.log("found socket:"+c+","+d+" at "+e);return e}console.log("not found socket:"+c+","+d);return-1},_insertNewBlock:function(b,
c){for(var d=-1,e=0;e<b.length;e++)if(b[e].block&&b[e].id==c.attached[1]){d=e;for(e=e+1;e<b.length;e++){if(!b[e].attached||b[e].attached[1]!=c.attached[1])break;d=e}break}b.splice(d+1,0,c);console.log("inserted new block");console.log(c)},_constructBlocksFor:function(b,c,d,e){if(c instanceof Label){if(c.parent==null){if(!c.id)c.id=WinLessons._getId();var f=WinLessons._findBlock(d,c.id);if(f>=0){d[f].scriptNum=WinLessons._scriptNumber;d[f].stepNum=WinLessons._stepNumber++;d[f].attached=null;d[f].used=
true}else{f={scriptNum:WinLessons._scriptNumber,stepNum:WinLessons._stepNumber++,block:c.func,spriteName:b,resource:null,attached:null,id:c.id,used:true};if(c.func=="valueVar"||c.func=="valueList"||c.func=="valueControlCall"){f.name=c.name;var g=Sprites.getSpriteByName(name);if(g)f.isGlobal=typeof g.variables[c.name]!="undefined"?false:true}else if(c.func=="valueParam")f.name=c.name;f.text=WinLessons._makeDefaultStepNote(f);d.push(f);console.log("inserted new dangling label");console.log(f)}}else if(c.parent instanceof
LabelInput)if(e.length>1){if(!c.id)c.id=WinLessons._getId();f=WinLessons._findBlock(d,c.id);if(f>=0){d[f].scriptNum=WinLessons._scriptNumber;d[f].stepNum=WinLessons._stepNumber++;d[f].attached=[e[0].func,e[0].id,e[1]];d[f].used=true}else{f={scriptNum:WinLessons._scriptNumber,stepNum:WinLessons._stepNumber++,block:c.func,spriteName:b,resource:null,attached:[e[0].func,e[0].id,e[1]],id:c.id,used:true};if(c.func=="valueVar"||c.func=="valueList"||c.func=="valueControlCall"){f.name=c.name;if(g=Sprites.getSpriteByName(name))f.isGlobal=
typeof g.variables[c.name]!="undefined"?false:true}else if(c.func=="valueParam")f.name=c.name;f.text=WinLessons._makeDefaultStepNote(f);(c.func!="valueParam"||e[0].func!="registerFunction")&&WinLessons._insertNewBlock(d,f)}}else{if(!c.id)c.id=WinLessons._getId();f=WinLessons._findBlock(d,c.id);if(f>=0){d[f].scriptNum=WinLessons._scriptNumber;d[f].stepNum=WinLessons._stepNumber++;d[f].attached=[e[0].func,e[0].id];d[f].used=true}else{f={scriptNum:WinLessons._scriptNumber,stepNum:WinLessons._stepNumber++,
block:c.func,spriteName:b,resource:null,attached:[e[0].func,e[0].id],id:c.id,used:true};if(c.func=="valueVar"||c.func=="valueList"||c.func=="valueControlCall"){f.name=c.name;if(g=Sprites.getSpriteByName(name))f.isGlobal=typeof g.variables[c.name]!="undefined"?false:true}else if(c.func=="valueParam")f.name=c.name;f.text=WinLessons._makeDefaultStepNote(f);WinLessons._insertNewBlock(d,f)}}else{if(!c.id)c.id=WinLessons._getId();f=WinLessons._findBlock(d,c.id);if(f>=0){d[f].scriptNum=WinLessons._scriptNumber;
d[f].stepNum=WinLessons._stepNumber++;d[f].attached=[c.parent.func,c.parent.id];d[f].used=true}else{f={scriptNum:WinLessons._scriptNumber,stepNum:WinLessons._stepNumber++,block:c.func,spriteName:b,resource:null,attached:[c.parent.func,c.parent.id],id:c.id,used:true};if(c.func=="valueVar"||c.func=="valueList"||c.func=="valueControlCall"){f.name=c.name;if(g=Sprites.getSpriteByName(name))f.isGlobal=typeof g.variables[c.name]!="undefined"?false:true}else if(c.func=="valueParam")f.name=c.name;f.text=WinLessons._makeDefaultStepNote(f);
WinLessons._insertNewBlock(d,f)}}for(f=e=0;f<c._children.length;f++)if(c._children[f]instanceof LabelInput){WinLessons._constructBlocksFor(b,c._children[f],d,[c,e]);e++}}else if(c instanceof LabelInput)if(c._child!=null)WinLessons._constructBlocksFor(b,c._child,d,e);else{if(c.label!=c.defaultLabel){if(!c.id)c.id=WinLessons._getId();f=WinLessons._findBlockValue(d,e[0].id,e[1]);if(f>=0){d[f].scriptNum=WinLessons._scriptNumber;if(e[0].func=="valueControlCall"||e[0].func=="blockControlCall"){d[f].name=
c.parent.parent.name;d[f].labelText=c.parent.parent.labelText}d[f].stepNum=WinLessons._stepNumber++;d[f].attached=[e[0].func,e[0].id,e[1],c.label];d[f].used=true}else{f={scriptNum:WinLessons._scriptNumber,stepNum:WinLessons._stepNumber++,block:null,spriteName:b,resource:null,attached:[e[0].func,e[0].id,e[1],c.label],id:c.id,used:true};if(e[0].func=="valueControlCall"||e[0].func=="blockControlCall"){f.name=c.parent.parent.name;f.labelText=c.parent.parent.labelText}f.text=WinLessons._makeDefaultStepNote(f);
WinLessons._insertNewBlock(d,f)}}}else if(c instanceof Block){if(c.parent==null){if(!c.id)c.id=WinLessons._getId();f=WinLessons._findBlock(d,c.id);if(f>=0){d[f].scriptNum=WinLessons._scriptNumber;d[f].stepNum=WinLessons._stepNumber++;d[f].attached=null;if(c.func=="registerFunction"){d[f].name=c.name;d[f].label=c.labelText}else if(c.func=="blockControlCall"){d[f].name=c.name;d[f].label=c.labelText}d[f].used=true}else{f={scriptNum:WinLessons._scriptNumber,stepNum:WinLessons._stepNumber++,block:c.func,
spriteName:b,resource:null,attached:null,id:c.id,used:true};if(c.func=="registerFunction"){f.name=c.name;f.label=c.labelText}else if(c.func=="blockControlCall"){f.name=c.name;f.label=c.labelText}f.text=WinLessons._makeDefaultStepNote(f);d.push(f);console.log("inserted new start block");console.log(f)}}else if(e.length>1){if(!c.id)c.id=WinLessons._getId();f=WinLessons._findBlock(d,c.id);if(f>=0){d[f].scriptNum=WinLessons._scriptNumber;d[f].stepNum=WinLessons._stepNumber++;d[f].attached=[e[0].func,
e[0].id,e[1]];if(c.name){d[f].name=c.name;d[f].label=c.labelText}d[f].used=true}else{f={scriptNum:WinLessons._scriptNumber,stepNum:WinLessons._stepNumber++,block:c.func,spriteName:b,resource:null,attached:[e[0].func,e[0].id,e[1]],id:c.id,used:true};if(c.name){f.name=c.name;f.label=c.labelText}f.text=WinLessons._makeDefaultStepNote(f);WinLessons._insertNewBlock(d,f)}}else{if(!c.id)c.id=WinLessons._getId();f=WinLessons._findBlock(d,c.id);if(f>=0){d[f].scriptNum=WinLessons._scriptNumber;d[f].stepNum=
WinLessons._stepNumber++;d[f].attached=[e[0].func,e[0].id];if(c.name){d[f].name=c.name;d[f].label=c.labelText}d[f].used=true}else{f={scriptNum:WinLessons._scriptNumber,stepNum:WinLessons._stepNumber++,block:c.func,spriteName:b,resource:null,attached:[e[0].func,e[0].id],id:c.id,used:true};if(c.name){f.name=c.name;f.label=c.labelText}f.text=WinLessons._makeDefaultStepNote(f);WinLessons._insertNewBlock(d,f)}}for(f=e=0;f<c.label._children.length;f++)if(c.label._children[f]instanceof LabelInput){WinLessons._constructBlocksFor(b,
c.label._children[f],d,[c,e]);e++}for(f=0;f<c._containers.length;f++)WinLessons._constructBlocksFor(b,c._containers[f],d,[c,f]);c.next!=null&&WinLessons._constructBlocksFor(b,c.next,d,[c])}},enableLessonHandlers:function(b,c){if(b){$("#win-properties .looks .add").unbind("click").click(WinLessons._looksAddCostume);$("#win-properties .sounds .add").unbind("click").click(WinLessons._soundsAddSound);$("#assetcmd-addscene").unbind("click").click(WinLessons._addScene);c==".actor"?$("#assetcmd-addactor").unbind("click").click(WinLessons._addTBlock):
$("#assetcmd-addactor").unbind("click").click(WinLessons._addActor);Blocks._scale=1;WinCode.draw();$("#win-code").removeClass("mintools").find(".zoom").addClass("hidden");$("#win-tools .palette a.toolsshow").addClass("hidden");$("#win-tools .palette .blocks").css("overflow-y","hidden");$("#win-tools .palette .blocks").css("overflow-y","hidden");WinCode.addChangeListener(WinLessons.blocksChanged);WinCode._enableContextMenu=false;WinCode._enableCutCopyPaste=false}else{WinTools.hilightBlock(null);WinCode.hilightBlock(null);
IDE.hideMask();$("#assetcmd-addscene").unbind("click").click(WinAssets._addSceneButton);$("#assetcmd-addactor").unbind("click").click(WinAssets._addActorButton);$("#win-properties .looks .add").unbind("click").click(WinProperties._addCostumeButton);$("#win-properties .sounds .add").unbind("click").click(WinProperties._addSoundButton);Blocks._scale=1;WinCode.draw();$("#win-code").removeClass("mintools").find(".zoom").removeClass("hidden");$("#win-tools .palette a.toolsshow").removeClass("hidden");
$("#win-tools .palette .blocks").css("overflow-y","");WinCode.removeChangeListener(WinLessons.blocksChanged);WinCode._enableContextMenu=true;WinCode._enableCutCopyPaste=true}},enableMenu:function(b){if(b){$(".toolbar-top .main").removeClass("hidden");$(".toolbar-top .puzzle").addClass("hidden");$("#wincmd-new").removeClass("disabled");$("#wincmd-open").removeClass("disabled");$("#wincmd-save").removeClass("disabled");$("#wincmd-saveas").removeClass("disabled");$("#wincmd-autosave").removeClass("disabled");
$("#wincmd-share").removeClass("disabled");$("#wincmd-importscratch").removeClass("disabled");$("#wincmd-find").removeClass("disabled");$("#wincmd-undo").removeClass("disabled");$("#wincmd-redo").removeClass("disabled");$("#wincmd-delete").removeClass("disabled");$("#wincmd-cut").removeClass("disabled");$("#wincmd-copy").removeClass("disabled");$("#wincmd-paste").removeClass("disabled");$("#wincmd-movefront").removeClass("disabled");$("#wincmd-moveback").removeClass("disabled");$("#wincmd-backpack").removeClass("disabled");
$("#wincmd-rearrange").removeClass("disabled");$("#wincmd-savetblock").removeClass("disabled");$("#wincmd-unlocktblock").removeClass("disabled");$("#wincmd-createblank").removeClass("disabled");$("#wincmd-clone").removeClass("disabled");$("#wincmd-lesson").removeClass("disabled");$("#wincmd-help").removeClass("disabled");$("#wincmd-tbbackpack").removeClass("disabled");$("#wincmd-tbundo").removeClass("disabled");$("#wincmd-tbredo").removeClass("disabled");$("#wincmd-tbsave").removeClass("disabled");
$("#wincmd-project input").attr("disabled",null)}else{$(".toolbar-top .main").addClass("hidden");$(".toolbar-top .puzzle").removeClass("hidden").empty();$(".toolbar-top .puzzle.title").text(IDE.currentProjectName);$("#wincmd-new").addClass("disabled");$("#wincmd-open").addClass("disabled");$("#wincmd-save").addClass("disabled");$("#wincmd-saveas").addClass("disabled");$("#wincmd-autosave").addClass("disabled");$("#wincmd-share").addClass("disabled");$("#wincmd-importscratch").addClass("disabled");
$("#wincmd-find").removeClass("disabled");$("#wincmd-undo").addClass("disabled");$("#wincmd-redo").addClass("disabled");$("#wincmd-delete").addClass("disabled");$("#wincmd-cut").addClass("disabled");$("#wincmd-copy").addClass("disabled");$("#wincmd-paste").addClass("disabled");$("#wincmd-movefront").addClass("disabled");$("#wincmd-moveback").addClass("disabled");$("#wincmd-backpack").addClass("disabled");$("#wincmd-rearrange").addClass("disabled");$("#wincmd-savetblock").addClass("disabled");$("#wincmd-unlocktblock").addClass("disabled");
$("#wincmd-createblank").addClass("disabled");$("#wincmd-clone").addClass("disabled");$("#wincmd-lesson").addClass("disabled");$("#wincmd-help").addClass("disabled");$("#wincmd-tbbackpack").addClass("disabled");$("#wincmd-tbundo").addClass("disabled");$("#wincmd-tbredo").addClass("disabled");$("#wincmd-tbsave").addClass("disabled");$("#wincmd-project input").attr("disabled","disabled")}},stopPlay:function(){IDE._clearDirty();WinLessons.currentPbIdx=-2;WinLessons.currentPlayStep=null;WinLessons.enableMenu(true);
WinTools.hilightBlock(null);WinCode.hilightBlock(null);IDE.hideMask();WinTools.showSimplified(false);WinTools.reset();WinLessons.enableLessonHandlers(false)},resetCurrent:function(b){var c=$("#annotations li");if(WinLessons.currentPbIdx>=0&&WinLessons.currentPbIdx<c.length){c=$(c[WinLessons.currentPbIdx]).data("info");WinLessons.currentPlayStep=c;c=JSON.parse(WinLessons.currentPlayStep.state);c.background.canvasWidth=$(Runtime.stage.container).innerWidth();c.background.canvasHeight=$(Runtime.stage.container).innerHeight();
c=JSON.stringify(c);ObjectIO.deserialize(c,function(){WinCode.computeAll();WinCode.draw();IDE.selectAsset(null);IDE.hideMask();WinLessons.showHint();b&&b()})}},goBack:function(){dismissChoosers();WinLessons.currentPbIdx--;if(WinLessons.currentPbIdx<=0){WinLessons.currentPbIdx=-1;IDE.reset();WinLessons.playAnnotations()}else{for(var b=$("#annotations li"),c=b[WinLessons.currentPbIdx],c=$(c).data("info"),d=WinLessons.currentPbIdx;c&&(c.skip||c.milestoneType==4)&&WinLessons.currentPbIdx>=0;){WinLessons.currentPbIdx--;
c=b[WinLessons.currentPbIdx];c=$(c).data("info")}if(c&&c.state&&WinLessons.currentPbIdx>=0){WinLessons.currentPlayStep=c;b=JSON.parse(WinLessons.currentPlayStep.state);b.background.canvasWidth=$(Runtime.stage.container).innerWidth();b.background.canvasHeight=$(Runtime.stage.container).innerHeight();b=JSON.stringify(b);ObjectIO.deserialize(b);WinCode.computeAll();WinCode.draw();IDE.selectAsset(null);WinLessons.showHint()}else WinLessons.currentPbIdx=d+1}return false},makeBlockByName:function(b){return b.block==
"registerFunction"?new Block({cat:"functions",name:b.name,label:b.label,hasFlap:false,func:"registerFunction"}):b.block=="blockControlCall"?new Block({cat:"functions",name:b.name,label:b.label,func:"blockControlCall"}):b.block=="valueControlCall"?new Label({cat:"functions",name:b.name,label:b.label,value:"string",func:"valueControlCall"}):b.block=="valueParam"?new Label({cat:"functions",name:b.name,value:"string",func:"valueParam"}):b.block=="valueScriptVar"?new Label({cat:"localvar",name:b.name,
value:"string",func:"valueScriptVar"}):b.block=="valueVar"?new Label({cat:"var",name:b.name,value:"string",func:"valueVar"}):b.block=="valueList"?new Label({cat:"list",label:b.name,value:"string",func:"valueList"}):makeBlockByName(b.block)},playButtonForNext:function(){WinLessons.saveCanvasWidth=$("#win-stage canvas").outerWidth();WinLessons.saveCanvasHeight=$("#win-stage canvas").outerHeight();IDE.showMaskElement(null);WinTools.hilightBlock(null);WinCode.hilightBlock(null);WinTools.showSimplified(false);
WinTools.reset();Blocks.allowAddInOptions=true;IDE.hideMask();IDE.showAnnotation({text:null,show:false});$("#stagecmd-grid").addClass("hidden");$("#stagecmd-minmax").addClass("hidden");WinPuzzle.toolbarButton(g_loc.getText("dialog.btnreplaylesson"),function(){window.location.reload();return false},"");WinPuzzle.toolbarButton(g_loc.getText("dialog.btncontinue"),function(){$("#stagecmd-grid").removeClass("hidden");$("#stagecmd-minmax").removeClass("hidden");WinLessons.currentPbIdx=-2;WinLessons.currentPlayStep=
null;WinLessons.enableMenu(true);WinProperties.enable(true);WinCode.enable(true);WinAssets.enable(true);WinStage.enableDecorations(true);$("#stage-buttons ul.toolleft").removeClass("hidden");$("#stage-buttons ul.toolright").removeClass("hidden");WinStage.enableToolbar(true);WinSidebar.hide();$("#wincmd-tbinfo").addClass("hidden");Runtime.stage.enableDragging(true);var b=$("#win-stage");b.css("width",WinLessons.saveCanvasWidth).css("height",WinLessons.saveCanvasHeight+b.find("h1").outerHeight()+b.find("#stage-buttons").outerHeight());
WinStage.adjustWindow();WinStage.cmdStop();IDE.adjustPanels();IDE._clearDirty();WinLessons._broadcast("done");WinLessons.enableLessonHandlers(false);if(Director.isRunning()){IDE.showAnnotation({show:false});Director.execute()}return false},"active");var b="";if(WinLessons._displayEndNotes){$("#win-lessons-details textarea.instructions").val()&&(b=b+"<h2>Instructions</h2>"+$("#win-lessons-details textarea.instructions").val());IDE.currentProjectDetails&&(b=b+"<h2>Details</h2>"+("<p>"+IDE.currentProjectDetails+
"</p>"));if(IDE.currentProjectConcepts){b=b+"<h2>Concepts</h2>";if(typeof IDE.currentProjectConcepts=="string")b=b+("<p>"+IDE.currentProjectConcepts+"</p>");else{var b=b+"<ul>",c;for(c in IDE.currentProjectConcepts)b=b+("<li>"+c+"</span></li>");b=b+"</ul>"}}}WinProperties.enable(false);WinCode.enable(false);WinAssets.enable(false);WinStage.enableDecorations(false);$("#stage-buttons ul.toolleft").addClass("hidden");$("#stage-buttons ul.toolright").addClass("hidden");WinStage.enableToolbar(!WinLessons._displayHidePlaybar);
if(b){WinSidebar.show(false,true);WinSidebar.setContent(b)}Runtime.stage.enableDragging(false);IDE.adjustPanels();$("#stagecmd-run").unbind("click").click(function(){WinStage.cmdStart()});WinStage.cmdStart();return false},_startAnnotations:function(){WinTools.showSimplified(true,WinLessons.blocksUsed);WinLessons.hide();$("#win-stage canvas").css("width",420).css("height",280);IDE.adjustPanels();$("#wincmd-tbsave").addClass("disabled");WinCode._enableDragToDelete=false;Blocks.allowAddInOptions=false;
WinCode._scripts=[];$.ajax({url:"/api/lessonstarted",type:"POST",data:"l="+(IDE.currentProjectId?IDE.currentProjectId:WinLessons.lessonId)})},playAnnotations:function(){IDE._clearDirty();IDE.hideMask();WinLessons.enableMenu(false);WinAssets.enableDelete(false);if(WinLessons.currentPbIdx==-2){WinLessons._startAnnotations();WinLessons.currentPbIdx=-1;WinLessons.currentPlayStep=null;Runtime.background.variables=WinLessons.globalVars;var b=$.trim($("#win-lessons-details textarea.instructions").val());
if($("#win-lessons-details .showplayer")[0].checked){var c=$('<div id="tutorial-preview"><h1 class="big">'+$("#win-lessons-details input").val()+'</h1><div class="instructions"><p class="big">'+$("#win-lessons-details textarea.description").val()+"</p>"+(b?'<p class="notbig">'+b+"</p>":"")+'</div><div class="preview"><div class="previewframe" style="width:408;height:308px;background-image:url(/assets/pscreenshot/'+(IDE.currentProjectId?IDE.currentProjectId:WinLessons.lessonId)+'.png);background-size:cover;"></div><a href="#" class="play tryit icon-play-2"></a></div></div>');
$("#infopopup").removeClass("w500nm").addClass("w800nm");c.find("a.play").click(function(){var b=$('<iframe width="480" height="360" src="ide/embedded?p='+(IDE.currentProjectId?IDE.currentProjectId:WinLessons.lessonId)+'&autostart=yes&controls=autohide" scrolling="no"></iframe>');$(this).addClass("hidden").parent().append(b).find(".previewframe").detach();b.load(function(){$(this).focus()});return false});var d=$('<a class="btn-round medium action notdisable" href="#">Get Started</a>')}else{c=$('<h1 class="big">'+
$("#win-lessons-details input").val()+'</h1><p class="big">'+$("#win-lessons-details textarea.description").val()+"</p></div>");d=$('<a class="btn-round medium action" href="#">Get Started</a>')}var e=WinLessons._formatPopupText(c);d.click(function(){$("#infopopup").addClass("w500nm").removeClass("w800nm").find("iframe").attr("src","ide/imgs/blank.png");IDE.showInfoPopup();WinLessons.playAnnotations();$("#mask-box").css("display","");return false});IDE.showInfoPopup(c,e,d,false,true);$("#mask-box").css("display",
"none");c=$("#infopopup");if(b&&c.hasClass("wCharacter")){c.css("width","1000px").find(".content").css("width","auto");c.css("top",(window.innerHeight-c.height())/2).css("left",(window.innerWidth-c.width())/2)}}else{b=$("#annotations li");if(WinLessons.currentPbIdx>=b.length-1){WinLessons.currentPbIdx=-2;WinLessons.currentPlayStep=null;IDE._clearDirty();$.ajax({url:"/api/lessondone",type:"POST",data:"l="+(IDE.currentProjectId?IDE.currentProjectId:WinLessons.lessonId)});IDE.hideMask();IDE.showAnnotation({text:null,
show:false});IDE.showFlashAnimation("right","right"+Math.floor(Math.random()*10+1),function(){var b=$(g_loc.getText("generate.defaultlaststep")),c=WinLessons._formatPopupText(b),d=$('<a class="btn-round medium blue" href="#">'+g_loc.getText("button.preview")+"</a>");d.click(function(){IDE.showInfoPopup();WinLessons.playButtonForNext();$("#mask-box").css("display","");return false});IDE.showInfoPopup(b,c,d,false,true);$("#mask-box").css("display","none")})}else{WinLessons.currentPbIdx++;d=b[WinLessons.currentPbIdx];
d=$(d).data("info");if(d.skip)if(c=d.snapshot){c.background.canvasWidth=$(Runtime.stage.container).innerWidth();c.background.canvasHeight=$(Runtime.stage.container).innerHeight();c=JSON.stringify(c);$("#annotations li").each(function(b,c){var d=$(c).data("info");if(b>WinLessons.currentPbIdx){WinLessons.currentPbIdx++;if(!d||!d.skip)return false}});d=b[WinLessons.currentPbIdx];d=$(d).data("info");WinLessons.currentPbIdx--;var f=WinCode._broadcastChange;WinCode._broadcastChange=function(){};var g=IDE.currentProjectName;
ObjectIO.deserialize(c,function(){IDE.setTitle(g);WinCode._broadcastChange=f;IDE.selectAsset(null);WinLessons.playAnnotations();WinCode.computeAll();WinCode.draw()})}else WinLessons.playAnnotations();else{WinLessons.currentPlayStep=d;IDE.hideMask();WinLessons.enableLessonHandlers(true);Director.infobarShow(false);WinLessons.showHint();if(d){d.state=ObjectIO.serialize();d.toolInfo=[]}WinLessons.monitorAction();return false}}}},_looksAddCostume:function(){WinLessons.Note.displayNote(WinLessons.Note.stageMessage.title,
WinLessons.Note.stageMessage.body,null,WinLessons.Note.stageMessage.id,false,false,true);var b=IDE.editingActor?g_loc.formatText("wincontent.selectcostumes",IDE.editingActor.label):g_loc.getText("wincontent.selectbackgrounds"),c=WinLessons.currentPlayStep.resourceName;WinMediaAssets.showSimplePicker(b,function(b){if(b.length>0){IDE.editingActor?IDE.addResourceTo(b[0].url,c,IDE.editingActor):IDE.addResourceTo(b[0].url,c,Runtime.background);window.setTimeout(WinLessons.playAnnotations,1)}},WinLessons.resourcesUsed);
IDE.hideMask();if(b=WinMediaAssets.getAssetInSimplified(WinLessons.currentPlayStep.resource)){WinMediaAssets.scrollIntoView(b);IDE.showMaskElement(b)}return false},_addScene:function(){WinLessons.Note.displayNote(WinLessons.Note.stageMessage.title,WinLessons.Note.stageMessage.body,null,WinLessons.Note.stageMessage.id,false,false,true);var b=g_loc.getText("wincontent.selectbackgrounds"),c=WinLessons.currentPlayStep.resourceName;WinMediaAssets.showSimplePicker(b,function(b){if(b.length>0){IDE.addResourceTo(b[0].url,
c,Runtime.background);window.setTimeout(WinLessons.playAnnotations,1)}},WinLessons.resourcesUsed);IDE.hideMask();if(b=WinMediaAssets.getAssetInSimplified(WinLessons.currentPlayStep.resource)){WinMediaAssets.scrollIntoView(b);IDE.showMaskElement(b)}return false},_soundsAddSound:function(){WinLessons.Note.displayNote(WinLessons.Note.stageMessage.title,WinLessons.Note.stageMessage.body,null,WinLessons.Note.stageMessage.id,false,false,true);var b=IDE.editingActor?g_loc.formatText("wincontent.selectsounds",
IDE.editingActor.label):g_loc.formatText("wincontent.selectsounds","Stage"),c=WinLessons.currentPlayStep.resourceName;WinMediaAssets.showSimplePicker(b,function(b){if(b.length>0){IDE.editingActor?IDE.addResourceTo(b[0].url,c,IDE.editingActor):IDE.addResourceTo(b[0].url,c,Runtime.background);window.setTimeout(WinLessons.playAnnotations,1)}},WinLessons.resourcesUsed);IDE.hideMask();if(b=WinMediaAssets.getAssetInSimplified(WinLessons.currentPlayStep.resource)){WinMediaAssets.scrollIntoView(b);IDE.showMaskElement(b)}return false},
_addActor:function(){WinLessons.Note.displayNote(WinLessons.Note.stageMessage.title,WinLessons.Note.stageMessage.body,null,WinLessons.Note.stageMessage.id,false,false,true);var b=WinLessons.currentPlayStep.spriteName,c=WinLessons.currentPlayStep.resourceName,d=WinLessons.currentPlayStep.properties;WinMediaAssets.showSimplePicker(g_loc.getText("wincontent.selectactor"),function(e){if(e.length>0)if(e[0].url=="avatar://spine"){for(var g=null,h=0;h<WinLessons.resourcesUsed.length;h++)if(WinLessons.resourcesUsed[h].name==
e[0].name){g=WinLessons.resourcesUsed[h];break}g&&Sprites.addSprite({cx:500,cy:500,scale:0.25,label:e[0].name,costumeName:e[0].name,img:"avatar://spine",forceNumber:false,skeletonType:g.skelType,skeletonParts:g.skelParts},function(b){b.spriteObj.setPosition(Runtime.stage.getWidth()/2,Runtime.stage.getHeight()/2);IDE.selectAsset(b);IDE.Clipboard.undoAddActor(b);if(d){b.spriteObj.rotateLock=d.rotateLock?d.rotateLock:0;b.spriteObj.setRotation(d.rotation);b.spriteObj.setScale(d.scale);b.spriteObj.setPosition(d.x,
d.y);if(d.variables)b.variables=d.variables;Runtime.stage.draw()}window.setTimeout(WinLessons.playAnnotations,1)})}else IDE.addResourceTo(e[0].url,c,null,function(c){c.changeSpriteName(b);if(d){c.spriteObj.rotateLock=d.rotateLock?d.rotateLock:0;c.spriteObj.setRotation(d.rotation);c.spriteObj.setScale(d.scale);c.spriteObj.setPosition(d.x,d.y);if(d.variables)c.variables=d.variables;Runtime.stage.draw()}window.setTimeout(WinLessons.playAnnotations,1)})},WinLessons.resourcesUsed);IDE.hideMask();var e=
WinLessons.currentPlayStep.resource;if(e=e=="avatar://spine"?WinMediaAssets.getAssetInSimplified(e,WinLessons.currentPlayStep.spriteName):WinMediaAssets.getAssetInSimplified(e)){WinMediaAssets.scrollIntoView(e);IDE.showMaskElement(e)}return false},_addTBlock:function(){WinLessons.Note.displayNote(WinLessons.Note.stageMessage.title,WinLessons.Note.stageMessage.body,null,WinLessons.Note.stageMessage.id,false,false,true);var b=WinLessons.currentPlayStep.spriteName,c=WinLessons.currentPlayStep.resourceName,
d=WinLessons.currentPlayStep.properties;WinMediaAssets.showSimplePicker(g_loc.getText("wincontent.selectactor"),function(e){e.length>0&&IDE.addResourceTo(e[0].url,c,null,function(c){c.changeSpriteName(b);if(d){c.spriteObj.setRotation(d.rotation);c.spriteObj.setScale(d.scale);c.spriteObj.setPosition(d.x,d.y);Runtime.stage.draw()}window.setTimeout(WinLessons.playAnnotations,1)})},WinLessons.resourcesUsed);IDE.hideMask();var e=WinMediaAssets.getAssetInSimplified(WinLessons.currentPlayStep.resource);
if(e){WinMediaAssets.scrollIntoView(e);IDE.showMaskElement(e)}return false},showHint:function(){window.clearTimeout(WinLessons._doForMeId);var b=WinLessons.currentPlayStep;if(b){var c=null,d="",e="",f="",g="",d=IDE._ignoreUpdates;IDE._ignoreUpdates=false;if(b.spriteName){var h=Sprites.getSpriteByName(b.spriteName);IDE.editingActor!=h&&IDE.selectAsset(h)}else b.milestoneType!=2&&b.milestoneType!=3&&b.milestoneType!=4&&IDE.editingActor&&IDE.selectAsset(null);IDE._ignoreUpdates=d;if(b.block!=null){c=
WinTools.hilightBlock(b.block,b.name);WinTools.hilightBlock(null)}if(b.attached!=null){d=WinCode.findBlockWithId(b.attached[1]);b.block==null?b.attached.length>=3&&(d=b.attached[0].substring(0,3)=="val"?d.getSocketAtChild(b.attached[2]):d.label.getSocketAtChild(b.attached[2])):b.block.substring(0,3)=="val"&&b.attached.length>=3&&(d=b.attached[0].substring(0,3)=="val"?d.getSocketAtChild(b.attached[2]):d.label.getSocketAtChild(b.attached[2]));if(d instanceof LabelInput){d.label="";d._computeBounds()}WinCode.hilightBlock(d)}if(b.block!=
null){WinProperties.hide();var g=b,e=WinLessons.makeInfo(g),f=e.img,d=e.title,e=e.note,h=$("<div>"+b.text+"</div>"),j=h.find("h2").html();j||(j=d);var k;if(g.spriteName){if(k=Sprites.getSpriteByName(g.spriteName))k=Sprites.getSpriteByName(g.spriteName).costumes[0].imgObj}else if(Runtime.background.costumes.length>0)k=Runtime.background.costumes[0].imgObj;if(k){j=$("<span></span>").append($(k).clone()).append(j);j.find("img").css("height","70px").css("float","right").css("margin-left","10px").css("margin-top",
"-20px").css("margin-right","-30px")}(k=h.find("p").html())||(k=e);k=$("<span>"+k+"<br/></span>");e=$('<a class="btn-round action small" href="#">'+g_loc.getText("button.showme")+"</a>");e.click(function(){WinLessons.showMe(null,1E3);return false});k.append(e);var l=$('<a class="btn-round green small floatright hidden" href="#">'+g_loc.getText("button.dothisforme")+"</a>");l.click(function(){WinLessons.performAction();return false});k.append(l);WinLessons._doForMeId=window.setTimeout(function(){l.removeClass("hidden")},
WinLessons.cDoForMeTimeout);IDE.showMaskElement($("#win-code .code canvas"),c);WinLessons.Note.displayNote(j,k,f,b.id,false,false,true)}else if(b.attached){WinProperties.hide();d=g_loc.formatText("lessontitle.setvalue",b.spriteName?b.spriteName:"Stage");e=g_loc.formatText("generate.setvalue",WinLessons._createBlockLabel(b.attached[0]),b.attached[3],b.spriteName?b.spriteName:"Stage");h=$("<div>"+b.text+"</div>");(j=h.find("h2").html())||(j=d);g=b;if(g.spriteName){if(k=Sprites.getSpriteByName(g.spriteName))k=
Sprites.getSpriteByName(g.spriteName).costumes[0].imgObj}else if(Runtime.background.costumes.length>0)k=Runtime.background.costumes[0].imgObj;if(k){j=$("<span></span>").append($(k).clone()).append(j);j.find("img").css("height","32px").css("float","right").css("margin-left","10px")}(k=h.find("p").html())||(k=e);IDE.showMaskElement($("#win-code .code canvas"),{x:0,y:0,width:0,height:0},false,true);WinLessons.Note.displayNote(j,k,null,b.id,false,false,true)}else if(b.resource){c=getFileExt(b.resource);
WinLessons.enableLessonHandlers(false);if(!b.spriteName||Sprites.getSpriteByName(b.spriteName))if(c==".mp3"||c==".wav"){WinProperties.show("sounds");IDE.showMaskElement($("#win-properties .sounds .add"));if(b.spriteName){IDE.selectAsset(Sprites.getSpriteByName(b.spriteName));d=g_loc.formatText("lessontitle.addsound",b.spriteName,b.resourceName);e=g_loc.formatText("generate.addsound",b.resourceName,b.spriteName);f=g_loc.getText("intlessontitle.addsound");g=g_loc.formatText("lessontext.addsound",b.spriteName,
b.resourceName)}else{d=g_loc.formatText("lessontitle.bgsound",b.resourceName);e=g_loc.formatText("generate.bgsound",b.resourceName);f=g_loc.getText("intlessontitle.bgsound");g=g_loc.formatText("lessontext.bgsound",b.resourceName)}}else if(b.spriteName){WinProperties.show("looks");WinAssets.showBackground(false);IDE.showMaskElement($("#win-properties .looks .add"));IDE.selectAsset(Sprites.getSpriteByName(b.spriteName));d=g_loc.formatText("lessontitle.addcostume",b.spriteName);e=g_loc.formatText("generate.addcostume",
b.resourceName,b.spriteName);f=g_loc.getText("intlessontitle.addcostume");g=g_loc.formatText("lessontext.addcostume",b.spriteName,b.resourceName)}else{WinProperties.hide();WinAssets.showBackground(true);IDE.showMaskElement($("#win-properties .looks a.add"));d=g_loc.getText("lessontitle.bgimg");e=g_loc.formatText("generate.bgimg",b.resourceName);f=g_loc.getText("intlessontitle.bgimg");g=g_loc.formatText("lessontext.bgimg",b.resourceName)}else if(b.resource=="ide/imgs/blank.png"){WinAssets.showBackground(false);
IDE.showMaskElement($("#assetcmd-addblank"));d=g_loc.getText("lessontitle.addsprite");e=g_loc.formatText("generate.addblank")}else{if(getFileExt(b.resource)==".actor"){WinAssets.showBackground(false);IDE.showMaskElement($("#assetcmd-addactor"));d=g_loc.getText("lessontitle.addtblock");e=g_loc.formatText("generate.addtblock",WinLessons._createTBlockLabel(b.resource,b.spriteName))}else{WinAssets.showBackground(false);IDE.showMaskElement($("#assetcmd-addactor"));WinProperties.hide();d=g_loc.getText("lessontitle.addsprite");
e=g_loc.formatText("generate.addsprite",b.spriteName)}f=g_loc.getText("intlessontitle.addsprite");g=g_loc.formatText("lessontext.addsprite",b.spriteName)}k=b.resourceThumbnail;if(!k)k=b.resource;h=$("<div>"+b.text+"</div>");(j=h.find("h2").html())||(j=d);k=h.find("p").html();WinLessons.Note.stageMessage={title:j,body:k,id:b.id};e?WinLessons.Note.displayNote(f,g,null,b.id,false,false,true):WinLessons.Note.displayNote(j,k,null,b.id,false,false,true);WinLessons.enableLessonHandlers(true,c)}else if(b.properties){IDE.showMaskElement(null);
d=g_loc.formatText("lessontitle.property",b.spriteName);for(j in b.properties)e=g_loc.formatText("generate.property",j,b.spriteName,b.properties[j]);h=$("<div>"+b.text+"</div>");(j=h.find("h2").html())||(j=d);(k=h.find("p").html())||(k=e);WinLessons.Note.displayNote(j,k,null,b.id,false,false,true)}else{c=$("#annotations li");if(WinLessons.currentPbIdx>=c.length-1){IDE._clearDirty();$.ajax({url:"/api/lessondone",type:"POST",data:"l="+(IDE.currentProjectId?IDE.currentProjectId:WinLessons.lessonId)});
IDE.hideMask();IDE.showAnnotation({text:null,show:false});IDE.showFlashAnimation("right","right"+Math.floor(Math.random()*10+1),function(){var c=$(b.text),d=$('<a class="btn-round medium action" href="#">'+g_loc.getText("button.preview")+"</a>"),e=WinLessons._formatPopupText(c);d.click(function(){IDE.showInfoPopup();WinLessons.playButtonForNext();$("#mask-box").css("display","");return false});IDE.showInfoPopup(c,e,d,false,true);$("#mask-box").css("display","none")})}else{IDE.showMaskElement(null);
if(b.milestoneType==1){IDE.showMaskElement(null);c=$(b.text);e=WinLessons._formatPopupText(c);IDE.showInfoPopup(c,e,null,false,true);$("#mask-box").css("display","none");WinLessons._milestoneTimeoutId=window.setTimeout(function(){IDE.showInfoPopup();WinLessons.playAnnotations();$("#mask-box").css("display","")},WinLessons.cMilestoneButtonTimeout)}else if(b.milestoneType==2){IDE.showAnnotation({show:false});IDE.hideMask();WinCode.hilightBlock(null);WinCode._enableDragToDelete=true;WinAssets.enableDelete(true);
Director.infobarReset();Director.infobarClearChoices();Director.infobarShow(true);c=$(b.text);c.find("span.play_hilight").append('<img src="ide/imgs/lesson/play.png"/>');c.find("code").each(function(){var b=$(this).text();try{var c=JSON.parse(b),d=ObjectIO.deserializeScriptStep(c);$(this).empty().append(d.getImage())}catch(e){}});Director.infobarSetContent(c);Director.infobarShowClose(false);Director.infobarShowPrev(false);var m=ObjectIO.serialize();WinPuzzle.toolbarButton(g_loc.getText("dialog.btnprev"),
function(){WinCode._enableDragToDelete=false;var b=JSON.parse(m);b.background.canvasWidth=$(Runtime.stage.container).innerWidth();b.background.canvasHeight=$(Runtime.stage.container).innerHeight();b=JSON.stringify(b);Runtime.stopScripts();WinAssets.enableDelete(false);ObjectIO.deserialize(b,function(){WinStage.restore();WinCode.computeAll();WinCode.draw();IDE.selectAsset(null);IDE.hideMask();WinLessons.enableLessonHandlers(true);Director.infobarShow(false);WinLessons.goBack()});WinPuzzle.toolbarRemoveButtons();
return false},"secondary");WinPuzzle.toolbarButton(g_loc.getText("dialog.btncontinue"),function(){WinCode._enableDragToDelete=false;var b=JSON.parse(m);b.background.canvasWidth=$(Runtime.stage.container).innerWidth();b.background.canvasHeight=$(Runtime.stage.container).innerHeight();b=JSON.stringify(b);Runtime.stopScripts();WinAssets.enableDelete(false);ObjectIO.deserialize(b,function(){WinStage.restore();WinCode.computeAll();WinCode.draw();IDE.selectAsset(null);IDE.hideMask();WinLessons.enableLessonHandlers(true);
Director.infobarShow(false);WinLessons.playAnnotations()});WinPuzzle.toolbarRemoveButtons();return false},"active");Director.infobarShowNext(false);Director.infobarEnableNext(false);Director.infobarResetButtons();c=$(b.text);c.find("span.play_hilight_full").append('<img src="ide/imgs/lesson/play_full.png"/>');e=WinLessons._formatPopupText(c);f=$('<a class="btn-round medium action" href="#">'+g_loc.getText("dialog.btntryitout")+"</a>");f.click(function(){IDE.showInfoPopup();$("#mask-box").css("display",
"");return false});IDE.showInfoPopup(c,e,f,false,true);$("#mask-box").css("display","none");WinLessons.enableLessonHandlers(false)}else if(b.milestoneType==3){c=$(b.text);e=WinLessons._formatPopupText(c);if(WinLessons.currentPbIdx>1){f=$('<a class="btn-round action secondary" href="#">'+g_loc.getText("dialog.btnprev")+'</a><a class="btn-round medium action" href="#">'+g_loc.getText("dialog.btnnext")+"</a>");$(f[0]).click(function(){IDE.showInfoPopup();WinLessons.goBack();$("#mask-box").css("display",
"");return false});$(f[1]).click(function(){IDE.showInfoPopup();WinLessons.playAnnotations();$("#mask-box").css("display","");return false})}else{f=$('<a class="btn-round medium action" href="#">'+g_loc.getText("dialog.btnnext")+"</a>");f.click(function(){IDE.showInfoPopup();WinLessons.playAnnotations();$("#mask-box").css("display","");return false})}IDE.showInfoPopup(c,e,f,false,true);$("#mask-box").css("display","none")}else if(b.milestoneType==4)window.setTimeout(WinLessons.playAnnotations,1);
else{IDE.showMaskElement(null);c=$(b.text);e=WinLessons._formatPopupText(c);f=$('<a class="btn-round medium action" href="#">'+g_loc.getText("dialog.btnnext")+"</a>");f.click(function(){IDE.showInfoPopup();WinLessons.playAnnotations();$("#mask-box").css("display","");return false});IDE.showInfoPopup(c,e,f,false,true);$("#mask-box").css("display","none")}}}}},makeInfo:function(b){var c=null,d,e;if(b.block.substring(0,5)=="value")if(b.attached==null){var c=$('<div class="blocks"><em class="block value">'+
b.block+"</em></div>"),f=WinLessons.makeBlockByName(b);if(f){f.x=f.y=0;f._computeBounds();c.empty().append(f.getImage()).removeClass("block").removeClass("value")}d=g_loc.formatText("lessontitle.label",b.spriteName?b.spriteName:"Stage");e=g_loc.formatText("generate.label",WinLessons._createBlockLabel(f.func),b.spriteName?b.spriteName:"Stage")}else if(b.attached.length==3){e=b.attached[0];d=b.attached[1];var g=b.attached[2],c=$('<div class="blocks"><em class="block value">'+b.block+'</em> <img src="imgs/plug_into.png"/> <em class="value block">'+
e+"</em></div>"),h=WinLessons.makeBlockByName(b),f=makeBlockByName(e);if(!f)(f=WinCode.findBlockWithId(d))&&(f=f.copy());d=WinLessons.makeBlockByName(b);if(h&&f&&d){f instanceof Block?f.label.setValue(g,d):f.setValue(g,d);f.x=f.y=0;f._computeBounds();c.find("em:first").empty().append(h.getImage());c.find("em:last").empty().append(f.getImage());c.find("em").removeClass("block").removeClass("value")}d=g_loc.formatText("lessontitle.addtolabelsocket",b.spriteName?b.spriteName:"Stage");e=g_loc.formatText("generate.addtolabelsocket",
WinLessons._createBlockLabel(h.func),WinLessons._createBlockLabel(e),b.spriteName?b.spriteName:"Stage")}else{if(b.attached.length==2){e=b.attached[0];d=b.attached[1];c=$('<div class="blocks"><em class="block value">'+b.block+'</em> <img src="imgs/plug_into.png"/> <em class="block">'+e+"</em></div>");h=WinLessons.makeBlockByName(b);if(d)(f=WinCode.findBlockWithId(d))&&(f=f.copy());f||(f=makeBlockByName(e));d=WinLessons.makeBlockByName(b);if(h&&f&&d){f.label.setValue(g,d);f.x=f.y=0;f._computeBounds();
c.find("em:first").empty().append(h.getImage());c.find("em:last").empty().append(f.getImage());c.find("em").removeClass("block").removeClass("value")}d=g_loc.formatText("lessontitle.addtoblocksocket",b.spriteName?b.spriteName:"Stage");e=g_loc.formatText("generate.addtoblocksocket",WinLessons._createBlockLabel(h.func),WinLessons._createBlockLabel(e),b.spriteName?b.spriteName:"Stage")}}else if(b.attached==null){c=$('<div class="blocks"><em class="block">'+b.block+"</em></div>");if(f=WinLessons.makeBlockByName(b)){f.x=
f.y=0;f.y=slotHeight;f._computeBounds();c.find("em").empty().removeClass("block").append(f.getImage())}d=g_loc.formatText("lessontitle.block",b.spriteName?b.spriteName:"Stage");e=g_loc.formatText("generate.block",WinLessons._createBlockLabel(f.func),b.spriteName?b.spriteName:"Stage")}else if(b.attached.length==3){e=b.attached[0];d=b.attached[1];g=b.attached[2];c=$('<div class="blocks"><em class="block">'+b.block+'</em> <img src="imgs/plug_into.png"/> <em class="block">'+e+"</em></div>");h=WinLessons.makeBlockByName(b);
f=makeBlockByName(e);if(!f)(f=WinCode.findBlockWithId(d))&&(f=f.copy());f.hilight=true;d=WinLessons.makeBlockByName(b);if(h&&f&&d){f.addToContainer(g,d);f.x=f.y=0;f.y=slotHeight;f._computeBounds();c.find("em:first").empty().append(h.getImage());c.find("em:last").empty().append(f.getImage());c.find("em").removeClass("block")}d=g_loc.formatText("lessontitle.blockcontainer",b.spriteName?b.spriteName:"Stage");e=g_loc.formatText("generate.blockcontainer",WinLessons._createBlockLabel(h.func),WinLessons._createBlockLabel(e),
b.spriteName?b.spriteName:"Stage")}else{e=b.attached[0];d=b.attached[1];c=$('<div class="blocks"><em class="block">'+b.block+'</em> <img src="imgs/plug_into.png"/> <em class="block">'+e+"</em></div>");h=WinLessons.makeBlockByName(b);if(d)(f=WinCode.findBlockWithId(d))&&(f=f.copy());f||(f=WinLessons.makeBlockByName({block:e,name:b.name,label:b.labelText}));f.hilight=true;d=WinLessons.makeBlockByName(b);if(h&&f&&d){f.next=d;f.x=f.y=0;f.y=slotHeight;f._computeBounds();c.find("em:first").empty().append(h.getImage());
c.find("em:last").empty().append(f.getImage());c.find("em").removeClass("block")}d=g_loc.formatText("lessontitle.blocknext",b.spriteName?b.spriteName:"Stage");e=g_loc.formatText("generate.blocknext",WinLessons._createBlockLabel(h.func),WinLessons._createBlockLabel(e),b.spriteName?b.spriteName:"Stage")}return{img:c,title:d,note:e}},showMe:function(b,c){if(WinLessons.currentPlayStep.block!=null){WinCode.show();WinTools.show();WinLessons.currentPlayStep==null?IDE.selectAsset(null):IDE.selectAsset(Sprites.getSpriteByName(WinLessons.currentPlayStep.spriteName));
var d=WinTools.cloneBlock(WinLessons.currentPlayStep.block,true),e=d.x,f=d.y;d.x=0;d.y=0;d._computeBlockBounds();var g,h;g=WinLessons.currentPlayStep.attached;if(g==null){h=WinCode.findBlankSpace();g=h.x;h=h.y;WinCode.scrollTo(g-10,h-40)}else if(g.length>2){h=WinCode.findBlockWithId(g[1]);h=WinLessons.currentPlayStep.block.substring(0,3)=="val"?h instanceof Block?h.label.getContainerPos(g[2]):h.getContainerPos(g[2]):h.getContainerPos(g[2]);g=h[0];h=h[1]}else{h=WinCode.findBlockWithId(g[1]);g=h.x;
h=h.y+h.height}g=g+$(WinCode.canvas).offset().left;h=h+$(WinCode.canvas).offset().top;g=g+WinCode.context.offsetX;h=h+WinCode.context.offsetY;c?DragLayer.showDragging(d,e,f,g,h,c?c:2E3,b):b(g,h)}else b&&typeof b=="function"&&b(0,0);return false},_goNext:function(){var b=$("#annotations li");WinLessons.currentPbIdx++;noteInfo=$(b[WinLessons.currentPbIdx]).data("info");WinLessons.currentPlayStep=noteInfo;WinLessons.showHint();if(noteInfo){noteInfo.state=ObjectIO.serialize();noteInfo.toolInfo=[]}WinLessons.monitorAction()},
performAction:function(){dismissChoosers();WinLessons.currentPlayStep.skipped=true;WinLessons.resetCurrent(function(){WinLessons.showMe(function(b,c){if(WinLessons.currentPlayStep.block!=null){var d=WinTools.cloneBlock(WinLessons.currentPlayStep.block);d.x=0;d.y=0;WinCode.canDrop(b,c,1,d,WinLessons.Note)?WinCode.drop(b,c,1,d,WinLessons.Note):WinTools.dragCanceled(d)}else if(WinLessons.currentPlayStep.attached){var d=WinLessons.currentPlayStep.attached,e=d[2],f=d[3],d=WinCode.findBlockWithId(d[1]);
d instanceof Block?d.label.setValue(e,f):d instanceof Label&&d.setValue(e,f);dismissChoosers()}else if(WinLessons.currentPlayStep.resource){var f=WinLessons.currentPlayStep.resource,g=WinLessons.currentPlayStep.spriteName,e=WinLessons.currentPlayStep.resourceName,h=WinLessons.currentPlayStep.properties;if(g)if(Sprites.getSpriteByName(g)){IDE.addResourceTo(f,e,Sprites.getSpriteByName(g));WinLessons._goNext()}else WinLessons.currentPlayStep.resource=="ide/imgs/blank.png"?IDE.addResourceTo(WinLessons.currentPlayStep.resource,
e,null,function(b){b.changeSpriteName(g);if(h){b.spriteObj.rotateLock=h.rotateLock?h.rotateLock:0;b.spriteObj.setRotation(h.rotation);b.spriteObj.setScale(h.scale);b.spriteObj.setPosition(h.x,h.y);Runtime.stage.draw()}WinLessons._goNext()}):IDE.addResourceTo(f,e,null,function(b){b.changeSpriteName(g);if(h){if(!b.classname||!b.id)b.spriteObj.rotateLock=h.rotateLock?h.rotateLock:0;b.spriteObj.setRotation(h.rotation);b.spriteObj.setScale(h.scale);b.spriteObj.setPosition(h.x,h.y);Runtime.stage.draw()}WinLessons._goNext()});
else{IDE.addResourceTo(f,e,Runtime.background);WinLessons._goNext()}}else if(WinLessons.currentPlayStep.spriteName){f=WinLessons.currentPlayStep.properties;for(d=0;d<Runtime.sprites.length;d++)if(Runtime.sprites[d].label==WinLessons.currentPlayStep.spriteName){d=Runtime.sprites[d];for(e in f){d.variables[e]=f[e];WinProperties.update()}break}}else WinLessons.playAnnotations();WinLessons.currentPbIdx>=$("#annotations li").length&&WinLessons.playAnnotations()},0)});return false},monitorAction:function(){var b=
WinLessons.currentPlayStep;if(b!=null&&b.spriteName!=null&&b.resource==null&&b.block==null&&b.properties){for(var c=false,d=null,e=null,f=0;f<Runtime.sprites.length;f++){var g=Runtime.sprites[f];if(g.label==b.spriteName){var d=g,h;for(h in b.properties){e=h;if(b.properties[h]==g.variables[h]){WinLessons.playAnnotations();c=g;break}}}}if(c)$("#win-properties .interfaces .objprops li").removeClass("hilight");else{IDE.editingActor!=d&&IDE.selectAsset(d);($("#win-properties").hasClass("hidden")||$("#win-properties h2[for=interfaces]").next().hasClass("hidden"))&&
WinProperties.show("interfaces");$("#win-properties .interfaces .objprops li").each(function(b,c){if($(c).find("em").text()==e){$(c).addClass("hilight");$("#win-properties").scrollTop($(c).offset().top);IDE.showMaskElement($(c));return false}});window.setTimeout(WinLessons.monitorAction,1E3)}}},blocksChanged:function(b,c){if(b!="move"&&WinLessons.currentPlayStep!=null&&(IDE.editingActor==null&&WinLessons.currentPlayStep.spriteName==null||IDE.editingActor!=null&&WinLessons.currentPlayStep.spriteName==
IDE.editingActor.label)){b!="valueChange"&&IDE.showMaskElement($("#win-code .code canvas"),{x:0,y:0,width:0,height:0},false,true);if(b=="attachTo"){if(c.func==WinLessons.currentPlayStep.block){var d=WinLessons.currentPlayStep.attached;if(d==null){if(c.parent==null){c.id=WinLessons.currentPlayStep.id;WinLessons.playAnnotations();WinCode.refresh();return}}else if(d.length>2){var e=d[2];if(c instanceof Label){if(c.parent!=null&&c.parent.parent!=null&&c.parent.parent.indexForBlockInChildren(c)==e){c.id=
WinLessons.currentPlayStep.id;WinLessons.playAnnotations();WinCode.refresh();return}}else if(c instanceof Block&&c.parent!=null&&c.parent.indexForBlockInContainer(c)==e){c.id=WinLessons.currentPlayStep.id;WinLessons.playAnnotations();WinCode.refresh();return}}else{e=WinCode.findBlockWithId(d[1]);if(c.parent!=null&&c.parent.next==c&&c.parent==e){c.id=WinLessons.currentPlayStep.id;WinLessons.playAnnotations();WinCode.refresh();return}}}}else if(b=="valueChange"){if((d=WinLessons.currentPlayStep.attached)&&
WinLessons.currentPlayStep.block==null){var e=d[1],f=d[2],g=d[3],h=c.parent.id;if((h===void 0||h==0)&&c.parent.parent!=null)h=c.parent.parent.id;d=c.parent.indexForBlockInChildren(c);if(h==e&&d==f){if(c.label==g||"0"+c.label==g||c.label=="0"+g||c.label+"."==g||c.label==g+"."||c.label+".0"==g||c.label==g+".0"){WinLessons.currentPlayStep=null;window.setTimeout(WinLessons.playAnnotations,1);WinCode.refresh();return}if(c.parent&&c.parent.parent&&["blockLooksSay","blockLooksSayFor","blockLooksThink","blockLooksThinkFor",
"blockSensingAskAndWait","blockSensingAskChoices"].indexOf(c.parent.parent.func)>=0){if(g&&c.label){WinLessons.currentPlayStep=null;window.setTimeout(WinLessons.playAnnotations,1)}WinCode.refresh();return}if(c.parent&&c.parent.parent&&["blockPenSetFillColor","blockPenSetColor"].indexOf(c.parent.parent.func)>=0){c.label=g;WinLessons.currentPlayStep=null;window.setTimeout(WinLessons.playAnnotations,1);WinCode.refresh();return}if(c.parent&&["valueSensingTouchingColor","valueSensingSeeColor"].indexOf(c.parent.func)>=
0){c.label=g;WinLessons.currentPlayStep=null;window.setTimeout(WinLessons.playAnnotations,1);WinCode.refresh();return}}}}else b=="delete"&&WinLessons.goBack();WinCode.refresh()}},_loadLesson:function(b){$.ajax({url:"/api/lessonload",type:"POST",data:{p:IDE.currentProjectId?IDE.currentProjectId:WinLessons.lessonId},success:function(c){window.WinLessons&&WinLessons.reset();c=JSON.parse(c);if(c.result!==false){ObjectIO.deserializeLesson(c);WinLessons.lessonId=IDE.currentProjectId}b&&b()},error:function(){b&&
b()}})},_saveLesson:function(b){var c="l="+encodeURIComponent(JSON.stringify(ObjectIO.serializeLesson()))+"&id="+(IDE.currentProjectId?IDE.currentProjectId:WinLessons.lessonId)+"&pb=false";$.ajax({url:"/api/lessonsave",type:"POST",data:c,success:function(){b&&b()}})},_formatPopupText:function(b){var c=WinLessons.sideImage,d=b.find("img.infographic");if(d.length>0){c=d.attr("src");d.detach()}b.find("code").each(function(){var b=$(this).text();try{var c=JSON.parse(b),d=ObjectIO.deserializeScriptStep(c);
$(this).empty().append(d.getImage())}catch(h){}});return c?$('<img src="'+c+'"/>'):null},Note:{}};WinLessons.Note.init=function(){$("#learndialog .buttonbar a.button2").click(function(){IDE.cmdExit()});$("#learndialog .buttonbar a.button1").click(function(){$("#learndialog").addClass("hidden");return false})};WinLessons.Note._goBack=function(){$(this).hasClass("btndisabled")||WinLessons.goBack();return false};
WinLessons.Note._formatText=function(b){var c;try{c=$(b)}catch(d){}if(!c||c.length==0)c=$("<div><p>"+b+"</p></div>");else if(c.length>1||c[0].tagName!="DIV"){c=$("<div></div>");c.append(b)}c.find("em").each(function(b,c){c=$(c);c.hasClass("var")&&c.text(prefs[c.attr("n")])});return c};
WinLessons.Note.displayNote=function(b,c,d,e,f,g,h){e=$("<div><h2></h2><p></p></div>");b?e.find("h2").append(b):e.find("h2").empty();d?e.find("h2").after(d):e.find("h2").next()[0].tagName=="DIV"&&e.find("h2").next().detach();e.find("p").append(c);e.find("span.play_hilight").append('<img src="ide/imgs/lesson/play.png"/>');if(!f){b=$('<a class="navlink" href="#">Previous Step</a>');e.append(b);b.click(WinLessons.Note._goBack)}h={text:e,showClose:h?false:true};if(g){h.bgcolor="#ffffff";h.showClose=
false}h.el=IDE._maskElement;if($(h.el).parents("#win-properties").length>0)h.preferVertical=true;else if($(h.el).parents("#win-code").length>0)h.preferInset=true;IDE.showAnnotation(h)};
var WinSidebar={isVisible:!1,isRight:!1,init:function(){$("#win-sidebar a.window-close").click(function(){WinSidebar.hide();return false});$("#wincmd-tbinfo").click(function(){WinSidebar.isVisible?WinSidebar.hide():WinSidebar.show(WinSidebar.isRight);return false})},show:function(b,c){$("#wincmd-tbinfo").removeClass("hidden");if(b===void 0)b=WinSidebar.isRight;WinSidebar.isVisible=true;WinSidebar.isRight=b?true:false;WinSidebar.isRight=false;$("#win-sidebar").removeClass("hidden");c?$("#win-sidebar a.window-close").addClass("hidden"):
$("#win-sidebar a.window-close").removeClass("hidden");$("#win-sidebar").css("width",0).animate({width:250},{duration:500,progress:function(){IDE.adjustPanels()}})},hide:function(){$("#win-sidebar").css("width",250).animate({width:0},{duration:500,progress:function(){IDE.adjustPanels()},done:function(){WinSidebar.isVisible=false;$("#win-sidebar").addClass("hidden")}})},setContent:function(b){$("#win-sidebar .content").html(b)},_replaceContents:function(){$("#win-sidebar .content").find("code").each(function(){var b=
$(this).text(),c=JSON.parse(b),c=ObjectIO.deserializeScriptStep(c);$(this).css("display","inline-block").empty().append(c.getImage()).append('<q style="display:none">'+b+"</q>")});$("#win-sidebar .content q").each(function(){var b=$(this).html();$(this).empty().text(b)});$("#win-sidebar .content a[href=code]").click(function(){IDE.showPopup($(this).find("q").text());return false})},load:function(b,c){$.ajax({url:b,success:function(b){WinSidebar.setContent(b);c&&c();WinSidebar._replaceContents()}})}},
WinAnnotation={width:300,isVisible:!1,hideNotes:!1,allowAdvanced:!1,finalActionButton:"",finalActionCallback:null,init:function(){var b=$("#win-annotation");b.bind("dragstart",function(){return false});$("#win-tools a.tutorial").click(function(){$("#win-tools .tutorialtabs a").removeClass("active");$(this).addClass("active");WinAnnotation.expand(true);return false});$("#win-tools a.blocks").click(function(){$("#win-tools .tutorialtabs a").removeClass("active");$(this).addClass("active");WinAnnotation.expand(false);
return false});var c=$('<div class="addnote"><span class="icon-plus-2"></span> Add a new note</div>');c.on("click",WinAnnotation.addNoteClicked);b.find("a.addnewnote").on("click",WinAnnotation.addNoteClicked);b.find("a.help").on("click",WinAnnotation.showHelp);var d=$('<div class="actions"><a href="#" class="nobtn-round secondary small previous">Back</a> <span class="step">1 / 3</span> <a href="#" class="btn-round action next small floatright">Next</a><a href="#" class="btn-round action done hidden small floatright">Done</a></div>');
b.find(".content").sortable({items:"div.entry",handle:".note,.note-actions",stop:function(){WinAnnotation._updateOrder();IDE.dirty()}}).append(c);b.append(d);b.on("click",function(c){var d=$(c.target);c.target.tagName!="A"&&(d=d.parents("a"));var g=d.parents(".note"),h=d.parents(".jqte_editor");if(d.length>0&&d[0].tagName=="A"&&(g.length>0||h.length>0)&&(b.hasClass("playmode")||d.hasClass("link"))){c.preventDefault();WinAnnotation.visitLink(d)}});b.find("a.pageview").on("click",WinAnnotation.switchPageView);
b.find("a.listview").on("click",WinAnnotation.switchListView);b.find("a.edit").on("click",WinAnnotation.switchEditMode);b.find("a.play").on("click",WinAnnotation.switchPlayMode);b.find("a.previous").on("click",WinAnnotation.prevClicked);b.find("a.next").on("click",WinAnnotation.nextClicked);b.find("a.done").on("click",WinAnnotation.hide);b.find(".collapsed .expand").click(function(){WinAnnotation.expand(true);return false});b.find(".expanded .collapse").click(function(){WinAnnotation.expand(false);
return false});WinCode.addChangeListener(WinAnnotation.blocksChanged)},blocksChanged:function(b){b=="delete"&&WinAnnotation._updateOrder()},hasNotes:function(){return $("#win-annotation .entry").length>0},addNote:function(b){var c=$("#win-annotation .content");c.find(".entry").removeClass("selected");var d=WinAnnotation.allowAdvanced?$('<div class="entry selected"><div class="note-actions"><\!--span class="page"></span--\><span class="preview"></span><a href="#" class="remove icon-cancel"></a><a href="#" class="icon-mic recorder" title="Record voice"></a><a href="#" class="audioplayer hidden"></a><a href="#" class="context icon-blocked"></a><a href="#" class="actor"><img src="ide/imgs/blank.png" style="display:none"/> <span>No selection</span></a><a href="#" class="size icon-blocked"></a></div></div>'):
$('<div class="entry selected"><div class="note-actions"><span class="page"></span><span class="preview"></span><a href="#" class="remove icon-cancel"></a><a href="#" class="icon-mic recorder" title="Record voice"></a><a href="#" class="audioplayer hidden"></a></div>');c.find("div.addnote").before(d);d.click(WinAnnotation.selectItem);d.find("a.remove").on("click",WinAnnotation.removeClicked);d.find("a.audioplayer").on("click",WinAnnotation.playStopClicked);d.find("a.context").on("click",WinAnnotation.contextClicked);
d.find("a.actor").on("click",WinAnnotation.actorClicked);d.find("a.size").on("click",WinAnnotation.sizeClicked);c=$('<div class="note"></div>');d.append(c);c.append(b);c.on("click",WinAnnotation.clickedComment);d.find("a.recorder").on("click",WinAnnotation.recordClicked);WinAnnotation._updateOrder();c.click();c=$("#win-annotation .content");c.scrollTop(c[0].scrollHeight-c.height());WinAnnotation.updateOwner();return d},addNoteClicked:function(b){b&&b.preventDefault();WinAnnotation.addNote("",false)},
switchPageView:function(b){b&&b.preventDefault();var c=$("#win-annotation");if($("#win-tools").hasClass("showannotations")){c.addClass("pageview").removeClass("listview");var d=c.find(".entry").length;c.find(".entry").each(function(b,f){if($(f).hasClass("selected")){b>0?c.find("a.previous").addClass("action").removeClass("secondary"):c.find("a.previous").removeClass("action").addClass("secondary");if(b<d-1){c.find("a.next").removeClass("hidden");c.find("a.done").addClass("hidden")}else{c.find("a.next").addClass("hidden");
c.find("a.done").removeClass("hidden")}}});$("#win-annotation .content").scrollTop(0)}else{$("#win-tools").addClass("showannotations");$("#win-code").removeClass("mintools");WinTools.adjustWindow()}},switchListView:function(b){b&&b.preventDefault();b=$("#win-annotation");if($("#win-tools").hasClass("showannotations")){b.removeClass("pageview").addClass("listview");var c=b.find(".entry.selected");c.length>0&&b.find(".content").scrollTop(c.position().top)}else{$("#win-tools").addClass("showannotations");
$("#win-code").removeClass("mintools");WinTools.adjustWindow()}},isEditMode:function(){return $("#win-annotation").hasClass("editmode")},switchEditMode:function(b){b&&b.preventDefault();b=$("#win-annotation");b.addClass("editmode").removeClass("playmode");b.find(".content").sortable("enable")},switchPlayMode:function(b){b&&b.preventDefault();var c=$("#win-annotation");c.removeClass("editmode").addClass("playmode");WinAnnotation.updateTitle();c.find(".selected").length<=0&&WinAnnotation._selectEntry(c.find(".entry:first"));
WinAnnotation._runEntry(c.find(".entry.selected"));c.find(".jqte_linkform").css("display","none");c.find(".jqte_editor").blur();c.find("a.previous").addClass("action").removeClass("secondary");var d=c.find(".entry").length;c.find(".entry").each(function(b,f){var g=$(f);if(g.hasClass("selected")){b>0?c.find("a.previous").addClass("action").removeClass("secondary"):c.find("a.previous").removeClass("action").addClass("secondary");if(b<d-1){c.find("a.next").removeClass("hidden");c.find("a.done").addClass("hidden")}else{c.find("a.next").addClass("hidden");
c.find("a.done").removeClass("hidden")}if(window.soundManager){soundManager.stopAll();c.find(".audioplayer").addClass("play");if(g.attr("data-audio")){g.find(".audioplayer").removeClass("hidden").removeClass("play");if(g.attr("data-audio")){var h=soundManager.createSound({url:g.attr("data-audio")});h.play({onfinish:function(){h.unload();g.find(".audioplayer").addClass("play")}})}}else g.find(".audioplayer").addClass("hidden")}else g.find(".audioplayer").addClass("hidden")}});c.find(".content").sortable("disable")},
playStopClicked:function(b){b&&b.preventDefault();var c=$(this),b=c.parents(".entry");if(b.attr("data-audio"))if(c.hasClass("play")){c.removeClass("play");var d=soundManager.createSound({url:b.attr("data-audio")});d.play({onfinish:function(){d.unload();c.addClass("play")}})}else{soundManager.stopAll();$("#win-annotation .audioplayer").addClass("play")}},contextClicked:function(b){b&&b.preventDefault();var b=$(this),c="";if(b.hasClass("icon-blocked")){b.removeClass("icon-blocked").addClass("icon-picture");
c="stage"}else if(b.hasClass("icon-picture")){b.removeClass("icon-picture").addClass("icon-file-xml");c="code"}else if(b.hasClass("icon-file-xml")){b.removeClass("icon-file-xml").addClass("icon-list-title");c="level"}else if(b.hasClass("icon-list-title")){b.removeClass("icon-list-title").addClass("icon-blocked");c=""}b.parents(".entry").attr("data-context",c)},actorClicked:function(b){b&&b.preventDefault();var c=$(this),b=$('<div class="choice-chooser"><ul></ul></div>');$("body").append(b);b.css("position",
"absolute").css("top",c.offset().top+c.outerHeight()).css("left",c.offset().left);var b=b.find("ul"),d=$('<li><img src="ide/imgs/blank.png"/> No selection</li>');d.click(function(){c.find("img").attr("src","ide/imgs/blank.png").css("display","none");c.find("span").text("No selection");c.parents("div.entry").attr("data-actor","").attr("data-stage","");$(".choice-chooser").detach()});b.append(d);d=$('<li><img src="ide/imgs/blank.png"/> Stage</li>');d.click(function(){c.find("img").attr("src","ide/imgs/blank.png").css("display",
"none");c.find("span").text("Stage");c.parents("div.entry").attr("data-actor","").attr("data-stage","Stage");$(".choice-chooser").detach()});b.append(d);for(var e=0;e<Runtime.sprites.length;e++){d=Runtime.sprites[e];d=$('<li><img src="'+d.costumes[0].imgObj.src+'"/> '+d.label+"</li>");b.append(d);d.click(function(){var b=$(this).find("img").attr("src"),d=$.trim($(this).text());c.find("img").attr("src",b).css("display","");c.find("span").text(d);c.parents("div.entry").attr("data-actor",d).attr("data-stage",
"");$(".choice-chooser").detach()})}},sizeClicked:function(b){b&&b.preventDefault();var b=$(this),c="";if(b.hasClass("icon-collapse")){b.removeClass("icon-collapse").addClass("icon-expand-2");c="full"}else if(b.hasClass("icon-expand-2")){b.removeClass("icon-expand-2").addClass("icon-blocked");c=""}else{b.removeClass("icon-blocked").addClass("icon-collapse");c="half"}b.parents(".entry").attr("data-size",c)},prevClicked:function(b){b&&b.preventDefault();var c=$("#win-annotation"),d=c.find(".entry").length;
c.find(".entry").each(function(b,f){var g=$(f);if(g.hasClass("selected")){if(b>0){g=g.removeClass("selected").prev();WinAnnotation._selectEntry(g);WinAnnotation._runEntry(g);b--;b>0?c.find("a.previous").addClass("action").removeClass("secondary"):c.find("a.previous").removeClass("action").addClass("secondary");if(b<d-1){c.find("a.next").removeClass("hidden");c.find("a.done").addClass("hidden")}else{c.find("a.next").addClass("hidden");c.find("a.done").removeClass("hidden")}c.find(".toggle .step").text("Step "+
(b+1)+" / "+d)}return false}});c.find(".content").scrollTop(0)},nextClicked:function(b){b&&b.preventDefault();var c=$("#win-annotation"),d=c.find(".entry").length;c.find(".entry").each(function(b,f){var g=$(f);if(g.hasClass("selected")){if(b<d-1){g=g.removeClass("selected").next();WinAnnotation._selectEntry(g);WinAnnotation._runEntry(g);b++;b>0?c.find("a.previous").addClass("action").removeClass("secondary"):c.find("a.previous").removeClass("action").addClass("secondary");if(b<d-1){c.find("a.next").removeClass("hidden");
c.find("a.done").addClass("hidden")}else{c.find("a.next").addClass("hidden");c.find("a.done").removeClass("hidden")}c.find(".toggle .step").text("Step "+(b+1)+" / "+d)}return false}});c.find(".content").scrollTop(0)},registerFinalAction:function(b,c){$("#win-annotation a.done").text(b).unbind().on("click",c)},flashBlocks:function(b,c,d){if(d>=0){b.setSelected(!b.showSelected,c);WinCode.draw();window.setTimeout(function(){WinAnnotation.flashBlocks(b,c,d-1)},150)}},selectItem:function(b){b&&b.preventDefault();
b=$(this);WinAnnotation._selectEntry(b)},_selectEntry:function(b){$("#win-annotation .entry").removeClass("selected");b.addClass("selected");var c=1,d=0;$("#win-annotation .entry").each(function(b,e){d++;$(e).hasClass("selected")&&(c=b+1)});$("#win-annotation .toggle .step").text("Step "+c+" / "+d);$("#win-annotation .expanded .subject").text("Step "+c+" / "+d);var e=$("#win-annotation .entry.selected h1:first").text();e||(e=$("#win-annotation .entry.selected h2:first").text());e||(e=$("#win-annotation .entry.selected h3:first").text());
$("#win-annotation .expanded .tutorial-sound").unbind().click(function(){var b=$(this);if(b.hasClass("icon-volume-high")){b.removeClass("icon-volume-high").addClass("icon-mute");soundManager.mute()}else{b.addClass("icon-volume-high").removeClass("icon-mute");soundManager.unmute()}return false});$("#win-annotation .collapsed .subject").text("(Step "+c+" / "+d+") "+e);if(!$("#win-annotation").hasClass("editmode")){e=b.attr("data-size");e=e=="full"?$("#win-tools").innerHeight()-8:e=="half"?$("#win-tools").innerHeight()/
2-8:$("#win-annotation .entry.selected pre").length>0?$("#win-tools").innerHeight()-8:$("#win-tools").innerHeight()/2-8;$(".tools-resize-handle").css("top",e);$("#win-annotation").css("height",e);$("#win-tools .palette").css("top",e);if(window.WinStage)b.attr("data-context")=="level"?WinStage.setStageState(true):WinStage.setStageState(false);else{if(WinAnnotation.isVisible){e=$("#win-annotation .entry.selected").attr("data-size");e=="full"?$(".tools-resize-handle").css("top",window.innerHeight-$(".toolbar-top").outerHeight()):
e=="half"&&$(".tools-resize-handle").css("top",(window.innerHeight-$(".toolbar-top").outerHeight())/2)}IDE.adjustPanels()}}},_runEntry:function(b){WinCode.clearSelection();WinCode.draw();var c=b.hasClass("entry")?b.find(".note"):b.parents(".entry").find(".note"),d=b.attr("data-actor");if(d)WinAnnotation.selectAsset(Sprites.getSpriteByName(d));else(d=b.attr("data-stage"))?WinAnnotation.selectAsset(null):WinAnnotation.visitLink(c.find("a.link:first"));if(window.soundManager){soundManager.stopAll();
$("#win-annotation .audioplayer").addClass("play");if(b.attr("data-audio")){if($("#win-annotation").hasClass("playmode")){b.find(".audioplayer").removeClass("hidden").removeClass("play");var e=soundManager.createSound({url:b.attr("data-audio")});e.play({onfinish:function(){e.unload();b.find(".audioplayer").addClass("play")}})}}else b.find(".audioplayer").addClass("hidden")}else b.find(".audioplayer").addClass("hidden")},selectAsset:function(b){IDE.selectAsset(b)},visitLink:function(b){if(b.hasClass("link")){b.attr("data-stage")?
WinAnnotation.selectAsset(null):b.attr("data-actor")&&WinAnnotation.selectAsset(Sprites.getSpriteByName(b.attr("data-actor")));var c=b.attr("data-blockid");if(c&&c!="0")if(c=WinCode.findBlockWithId(parseInt(c))){WinCode.centerBlock(c);WinCode.clearSelection();b.attr("data-endblockid")?WinAnnotation.flashBlocks(c,parseInt(b.attr("data-endblockid")),4):c.setSelected(true,false);WinCode.draw()}}else if(b.length>0){c=$('<a href="#" class="btnDefaultOrange">OK</a>');c.click(function(){$("#infopopup").addClass("w600nm").removeClass("w800nm");
showInfoPopup();return false});$("#infopopup").removeClass("w600nm").addClass("w800nm");showInfoPopup('<iframe src="'+b.attr("href")+'" width="100%" height="400px"></iframe>',null,c,false,true)}},removeClicked:function(b){b&&b.preventDefault();var c=$(this).parents(".entry");IDE.confirmDialog("Are you sure you wish to remove this note?",function(){c.detach();WinAnnotation._updateOrder();IDE.dirty()},"Yes","No")},clickedComment:function(b){if(!$("#win-annotation").hasClass("playmode")){var c=$(b.target);
b.target.tagName!="A"&&(c=c.parents("a"));b&&b.preventDefault();c=$(this).parents(".entry");c.find(".jqte_editor").blur();c.find("div.note").jqte({b:true,i:false,u:true,remove:false,color:false,format:true,formats:[["p","Normal"],["h1","Header"],["h2","Sub-header"],["h3","User Action"],["pre","Draggable"]],p:true,br:true,link:true,unlink:true,rule:false,left:false,right:false,center:false,ol:false,ul:true,sub:false,sup:false,fsize:false,indent:false,outdent:false,strike:false,source:false,blur:function(){if(c.find(".jqte_linkform:visible").length<=
0){var b="<p>"+c.find("textarea").val()+"</p>",b=b.replace(/\<p(|\s+.*?)>(.*?)<p(|\s+.*?)>(.*?)<\/p>\s*<\/p>/gim,"<p$1>$2</p><p$3>$4</p>"),b=b.replace(/\<p><\/p>/gim,""),b=$('<div class="note">'+b+"</div>");b.on("click",WinAnnotation.clickedComment);c.find(".jqte").after(b);window.setTimeout(function(){c.find(".jqte").detach()},1);IDE.dirty();c.find("p").removeClass("draggable");c.find("p img").each(function(){var b=$(this);b.attr("data-locked")!="true"&&b.attr("data-block")&&b.parents("p").addClass("draggable")});
c.find("p.draggable").replaceWith(function(){return $("<pre/>",{html:$(this).html()})});c.find("pre *").each(function(){var b=$(this);if(b.prop("tagName")=="PRE"){b.after(b.find("*"));b.detach()}else b.prop("tagName")!="A"&&b.prop("tagName")!="IMG"?b.detach():b.attr("style","")});c.find("pre a").each(function(){var b=$(this),c=b;b.find("*").each(function(){var b=$(this);b.detach();c.after(b);c=b});b.detach()});WinAnnotation.hideNotes=false}}});c.find(".jqte_linkinput").blur(function(){c.find(".jqte_linkform").css("display",
"none")});var d=RegExp("<\!--.*?--\>","g");c.find(".jqte_editor").bind("paste",function(b){b.preventDefault();if(b.clipboardData||b.originalEvent&&b.originalEvent.clipboardData){for(b=(b.originalEvent||b).clipboardData.getData("text/html");d.test(b);)b=b.replace(d,"");var c=$("<div></div>");c.append(b);c.find("*").each(function(b,c){var d=$(c),e=false;if(c.tagName=="A"){if(d.hasClass("link")){e=true;d.attr("href","#")}d.removeAttr("style");d.removeAttr("class")}else if(c.tagName=="SPAN"){var f=d.attr("style");
if(f)(f=f.match(/color:[ ]?rgb\([0-9, ]+\);/))&&d.attr("style",f[0]);else d.removeAttr("style");d.removeAttr("class")}else if(c.nodeType==8)d.detach();else{d.removeAttr("style");d.removeAttr("class")}e&&d.addClass("link")});document.execCommand("insertHtml",false,c.html())}else if(window.clipboardData){b=window.clipboardData.getData("Text");c=$(b);c[0].tagName=="A"&&c.find("img").length==1||(b=window.clipboardData.getData("Text"));document.selection.createRange().pasteHTML(b)}WinAnnotation.hideNotes=
false});WinAnnotation.updateOwner();b=$('<div class="jqte_tool unselectable"><a href="#" class="icon-pictures" title="Add Image"></a></div>');b.find("a").on("click",WinAnnotation.addAssetClicked).hover(WinAnnotation.iconHoverIn,WinAnnotation.iconHoverOut);c.find(".jqte_toolbar").append(b);c.find(".jqte_editor").focus()}},iconHoverIn:function(){$(".jqte_title").remove();$(this).parents(".entry").find(".jqte").append('<div class="jqte_title"><div class="jqte_titleArrow"><div class="jqte_titleArrowIcon"></div></div><div class="jqte_titleText">'+
$(this).attr("title")+"</div></div>");var b=$(".jqte_title:first");b.find(".jqte_titleArrowIcon");var c=$(this).position(),d=c.left+$(this).outerWidth()-b.outerWidth()/2-$(this).outerWidth()/2,c=c.top+$(this).outerHeight()+5;b.delay(400).css({top:c,left:d}).fadeIn(200)},iconHoverOut:function(){$(".jqte_title").remove()},recordClicked:function(b){b&&b.preventDefault();var c=$(this).parents("div.entry");if(c.find("a.recorder").hasClass("icon-mic"))WinMediaCapture.showAudioRecorder(function(b){c.attr("data-audio",
b);c.find("a.recorder").addClass("icon-mic-2").removeClass("icon-mic");IDE.dirty();WinAnnotation._updateOrder();WinAnnotation.updateOwner()});else{c.removeAttr("data-audio");c.find("a.recorder").addClass("icon-mic").removeClass("icon-mic-2");IDE.dirty();WinAnnotation._updateOrder()}},addAssetClicked:function(b){b&&b.preventDefault();b=$(this).parents("div.entry");$("#win-media-assets").modal();WinMediaAssets.showPicker("Select an Asset",WinAnnotation.addAsset,{backgrounds:true,actors:false,images:true,
sounds:window.soundManager?true:false,charStudio:false},b)},addAsset:function(b,c,d,e){if(!e&&WinMediaAssets._callbackObj)e=WinMediaAssets._callbackObj;if(e){b=b[0];c=getFileExt(b.url);c==".mp3"||c==".wav"?e.attr("data-audio",b.url):e.find(".note").append('<p><img src="'+b.url+'"/></p>')}WinAnnotation._updateOrder();WinAnnotation.updateOwner()},_updateOrder:function(){var b=$("#win-annotation .entry").length;$("#win-annotation .entry").each(function(c,d){var e=$(d);e.find(".page").text("Step "+(c+
1)+" / "+b);e.find(".preview").empty();if(window.soundManager){soundManager.stopAll();$("#win-annotation .audioplayer").addClass("play");if(e.attr("data-audio")){e.find(".audioplayer").removeClass("hidden").addClass("play");e.find(".recorder").removeClass("icon-mic").addClass("icon-mic-2")}else{e.find(".audioplayer").addClass("hidden");e.find(".recorder").addClass("icon-mic").removeClass("icon-mic-2")}}e.find("a.link").each(function(b,c){var d=$(c);if(d.attr("data-stage")){if(d.attr("data-blockid")){for(var e=
false,k=0;k<Runtime.background.scripts.length;k++){var l=Blocks.findBlockWithId(Runtime.background.scripts[k],d.attr("data-blockid"));if(l){e=true;break}}e||d.addClass("removelink").children().each(function(b,c){$(c).detach();d.after(c)})}}else if(d.attr("data-actor")){var m=Sprites.getSpriteByName(d.attr("data-actor"));if(m&&d.attr("data-blockid")){e=false;for(k=0;k<m.scripts.length;k++)if(l=Blocks.findBlockWithId(m.scripts[k],d.attr("data-blockid"))){e=true;break}e||d.addClass("removelink").children().each(function(b,
c){$(c).detach();d.after(c)})}}});e.find(".removelink").detach()});WinCode.draw();WinAnnotation.hideNotes=false},show:function(b){WinAnnotation.isVisible=true;WinAnnotation.updateTitle();$("#win-tools").removeClass("pin");b||WinAnnotation._selectEntry($("#win-annotation .entry.selected"));$("#wincmd-showannotate").text(g_loc.getText("menu.hideannotate"));if(b){$("#win-code").addClass("editannotations");$("#wincmd-annotate").addClass("hidden")}else $("#win-code").removeClass("editannotations");$("#wincmd-showannotate").removeClass("hidden");
$("#win-tools").addClass("showannotations");WinCode._assignIds();b?WinAnnotation.switchEditMode():WinAnnotation.switchPlayMode();WinTools.adjustWindow()},expand:function(b){if(b){$("#win-tools").addClass("showannotations");$("#win-annotation .expanded").removeClass("hidden");$("#win-annotation .collapsed").addClass("hidden");$(".tools-resize-handle").removeClass("hidden");b=$("#win-tools .palette").innerHeight()-8;$("#win-annotation").css("height",b);$("#win-tools .palette").css("top",b);b=b+$(".tutorialtabs").outerHeight();
$(".tools-resize-handle").css("top",b);WinAnnotation._selectEntry($("#win-annotation .entry.selected"))}else{$("#win-annotation .expanded").addClass("hidden");$("#win-annotation .collapsed").removeClass("hidden");$(".tools-resize-handle").addClass("hidden");b=$("#win-annotation .collapsed").outerHeight();$("#win-annotation").css("height",b);b=b+$(".tutorialtabs").outerHeight();$(".tools-resize-handle").css("top",b);$("#win-tools .palette").css("top",b)}},isExpanded:function(){return $("#win-tools").hasClass("showannotations")&&
$("#win-annotation").outerHeight()>$("#win-annotation .actions").outerHeight()},hide:function(b){WinAnnotation.isVisible=false;b&&b.preventDefault();(!prefs["category-pin"]||prefs["category-pin"]=="on")&&$("#win-tools").addClass("pin");$("#wincmd-showannotate").text(g_loc.getText("menu.showannotate"));WinAnnotation.hasNotes()?$("#wincmd-showannotate").removeClass("hidden"):$("#wincmd-showannotate").addClass("hidden");$("#wincmd-annotate").removeClass("hidden");$("#win-tools").removeClass("showannotations");
$("#win-annotation").removeClass("editmode").removeClass("playmode");$("#win-code").removeClass("editannotations");WinTools.adjustWindow();WinCode.adjustWindow()},showHelp:function(){Help.cmdHelp(null,"ide/help/tutorial-designer")},updateOwner:function(){IDE.currentLessonOwnerId=prefs.userid},serialize:function(){var b=[],c=RegExp("http[s]?://([a-zA-Z]+.)tynker.co[m]?(.*)","g");$("#win-annotation .entry").each(function(d,e){var f={},g=$(e);if(g.attr("data-audio"))for(f.audio=g.attr("data-audio");c.test(f.audio);)f.audio=
f.audio.replace(c,"$2");var h=g.attr("data-context"),j=g.attr("data-actor"),k=g.attr("data-stage"),l=g.attr("data-size");f.comment=g.find("div.note").html();if(!f.comment)f.comment=g.find("textarea.note").val();for(;c.test(f.comment);)f.comment=f.comment.replace(c,"$2");g="<p>"+f.comment+"</p>";g=g.replace(/\<p(|\s+.*?)>(.*?)<p(|\s+.*?)>(.*?)<\/p>\s*<\/p>/gim,"<p$1>$2</p><p$3>$4</p>");g=g.replace(/\<p><\/p>/gim,"");g=$(g);g.find("a").each(function(b,c){var d=$(c),e=d.attr("data-block");if(e){d.find("img").attr("data-block",
e);d.removeAttr("data-block")}});g.find("img").each(function(b,c){var d=$(c);d.attr("data-block")&&d.attr("src","ide/imgs/blank.png")});var m=$("<div></div>");m.append(g);if(h)f.context=h;if(j)f.actor=j;if(k)f.stage="stage";if(l)f.size=l;f.comment=m.html();b.push(f)});return b.length>0?JSON.stringify(b):""},updateTitle:function(){prefs.lessonowner&&prefs.lessonowner.displayName?$("#win-annotation .title").text(IDE.currentProjectName+" by "+prefs.lessonowner.displayName):$("#win-annotation .title").text(IDE.currentProjectName)},
deserialize:function(b){var c=$("#win-annotation .content");c.find(".entry").detach();WinAnnotation.updateTitle();for(var d=RegExp("http[s]?://([a-zA-Z]+.)tynker.co[m]?(.*)","g"),e=RegExp("<\!--.*?--\>","g"),f=/\<p><\/p>/gim,g=0;g<b.length;g++){var h=WinAnnotation.allowAdvanced?$('<div class="entry selected"><div class="note-actions"><\!--span class="page"></span--\><span class="preview"></span><a href="#" class="remove icon-cancel"></a><a href="#" class="icon-mic recorder" title="Record voice"></a><a href="#" class="audioplayer hidden"></a><a href="#" class="context icon-blocked"></a><a href="#" class="actor"><img src="ide/imgs/blank.png" style="display:none"/> <span>No selection</span></a><a href="#" class="size icon-blocked"></a></div></div>'):
$('<div class="entry selected"><div class="note-actions"><span class="page"></span><span class="preview"></span><a href="#" class="remove icon-cancel"></a><a href="#" class="icon-mic recorder" title="Record voice"></a><a href="#" class="audioplayer hidden"></a></div>');c.find("div.addnote").before(h);h.click(WinAnnotation.selectItem);h.find("a.remove").on("click",WinAnnotation.removeClicked);h.find("a.audioplayer").on("click",WinAnnotation.playStopClicked);h.find("a.context").on("click",WinAnnotation.contextClicked);
h.find("a.actor").on("click",WinAnnotation.actorClicked);h.find("a.size").on("click",WinAnnotation.sizeClicked);var j=b[g].audio;if(j){for(;d.test(j);)j=j.replace(d,"$2");h.attr("data-audio",j);h.find(".recorder").removeClass("icon-mic").addClass("icon-mic-2").attr("title","Remove recording")}h.find("a.recorder").on("click",WinAnnotation.recordClicked);var j=$('<div class="note"></div>'),k=b[g].context;if(k){h.attr("data-context",k);k=="stage"?h.find("a.context").removeClass("icon-blocked").addClass("icon-picture"):
k=="code"?h.find("a.context").removeClass("icon-blocked").addClass("icon-file-xml"):k=="level"&&h.find("a.context").removeClass("icon-blocked").addClass("icon-list-title")}if(k=b[g].actor){h.attr("data-actor",k);h.find("a.actor span").text(k);(k=Sprites.getSpriteByName(k))&&k.costumes.length>0?h.find("a.actor img").attr("src",k.costumes[0].imgObj.src).css("display",""):h.find("a.actor img").attr("src","ide/imgs/blank.png").css("display","none")}else{if(k=b[g].stage){h.attr("data-stage","Stage");
h.find("a.actor span").text("Stage")}else h.find("a.actor span").text("No selection");h.find("a.actor img").attr("src","ide/imgs/blank.png").css("display","none")}if(k=b[g].size){h.attr("data-size",k);k=="full"?h.find("a.size").removeClass("icon-blocked").addClass("icon-expand-2"):k=="half"&&h.find("a.size").removeClass("icon-blocked").addClass("icon-collapse")}h.append(j);if(h=b[g].comment){for(;d.test(h);)h=h.replace(d,"$2");for(;e.test(h);)h=h.replace(e,"");for(;f.test(h);)h=h.replace(f,"");j.html(h);
j.find("p img").each(function(){var b=$(this);if(b.attr("data-locked")!="true"&&b.attr("data-block")){b.parents("p").addClass("draggable");var c=b.attr("data-block");if(c){c=WinAnnotation._repair(c,b);b.attr("data-block",c)}}});j.find("p.draggable").replaceWith(function(){return $("<pre/>",{html:$(this).html()})});j.find("pre *").each(function(){var b=$(this);if(b.prop("tagName")=="PRE"){b.after(b.find("*"));b.detach()}else if(b.prop("tagName")!="A"&&b.prop("tagName")!="IMG")b.detach();else{b.attr("style",
"");if(!b.attr("data-block")){var c=b.parent();b.detach();c.after(b)}}});j.find("pre").each(function(){$(this).find("*").length===0&&$(this).detach()});j.find("pre a").each(function(){var b=$(this),c=b;b.find("*").each(function(){var b=$(this);b.detach();c.after(b);c=b});b.detach()});j.find("*").each(function(b,c){var d=$(c),e=false;if(c.tagName=="A"){if(d.hasClass("link")){e=true;d.attr("href","#")}var f=d.attr("data-block");if(f){f=WinAnnotation._repair(f,d);d.removeAttr("data-block");d.find("img").attr("data-block",
f)}d.removeAttr("style");d.removeAttr("class")}else if(c.tagName=="SPAN"){if(f=d.attr("style"))(f=f.match(/color:[ ]?rgb\([0-9, ]+\);/))?d.attr("style",f[0]):d.removeAttr("style");d.removeAttr("class")}else if(c.tagName=="IMG"){if(f=d.attr("data-block")){f=WinAnnotation._repair(f,d);try{f=ObjectIO.deserializeScriptStep(JSON.parse(f));f.getImage(function(b){d.attr("src",b.src)})}catch(g){}}}else{d.removeAttr("style");d.removeAttr("class")}e&&d.addClass("link")})}j.on("click",WinAnnotation.clickedComment)}WinAnnotation._updateOrder();
c.find(".entry:first").addClass("selected").click()},_repair:function(b,c){if(b=="{"){for(var d=false,b=b+'"',e=c[0].attributes,f=0;f<e.length;f++){var g=e[f].name;if(["style","class","id","href","src","data-block","data-blockid","data-endblockid","data-actor","data-stage"].indexOf(g)<0){d&&(b=b+" ");b=b+g;d=true}}if(!d){c=c.parent();e=c[0].attributes;for(f=0;f<e.length;f++){g=e[f].name;if(["style","class","id","href","src","data-block","data-blockid","data-endblockid","data-actor","data-stage"].indexOf(g)<
0){d&&(b=b+" ");b=b+g;d=true}}}if(d){for(var h in g_steps){d=RegExp('"'+h.toLowerCase()+'"',"g");b=b.replace(d,'"'+h+'"')}b=b.replace(/valuevar/g,"valueVar");b=b.replace(/containerlabels/g,"containerLabels");b=b.replace(/labeltext/g,"labelText");b=b.substring(0,b.length-1)}}return b},canDrag:function(b,c){var d=false,e=$("#win-annotation");e.is(":visible")&&e.hasClass("playmode")&&b>=e.offset().left&&(b<=e.offset().left+e.outerWidth()&&c>=e.offset().top&&c<=e.offset().top+e.outerHeight())&&(d=true);
return d},getDragObj:function(b,c){var d=null,e=$("#win-annotation");e.is(":visible")&&e.hasClass("playmode")&&b>=e.offset().left&&(b<=e.offset().left+e.outerWidth()&&c>=e.offset().top&&c<=e.offset().top+e.outerHeight())&&e.find("img").each(function(e,g){var h=$(g),j=h.attr("data-block");if(j){var k=h.offset();if(h.attr("data-locked")!="true"&&b>=k.left&&c>=k.top&&b<=k.left+h.outerWidth()&&c<=k.top+h.outerHeight()){d=ObjectIO.deserializeScriptStep(JSON.parse(j));d.x=k.left-b;d.y=k.top-c;d._computeBounds();
return false}}});return d},canDrop:function(b,c,d,e,f){d=$("#win-annotation");if(d.is(":visible")&&b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight())if(d.hasClass("editmode")){if(f!=WinBackpack&&(e instanceof Block||e instanceof Label)||f!=WinBackpack&&e instanceof WinAssets.DragObject)return true}else if(f==WinCode&&(e instanceof Block||e instanceof Label))return true;return false},dragOver:function(b,c){var d=$("#win-annotation");d.is(":visible")&&
b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight()&&d.hasClass("editmode")&&d.find(".entry").each(function(b,d){var g=$(d);c>=g.offset().top&&c<=g.offset().top+g.outerHeight()?g.addClass("selected"):g.removeClass("selected")})},_getLastBlock:function(b){return b.next?WinAnnotation._getLastBlock(b.next):b},drop:function(b,c,d,e,f){c=$("#win-annotation");b=c.find(".entry.selected");if(c.hasClass("editmode")){if(e instanceof Block||e instanceof
Label){if(f==WinCode||f==WinTools){IDE.Clipboard.doUndo();f=e.lockedInSandbox?$('<p><a class="link" href="#"></a></p>'):$('<pre><a class="link" href="#"></a></pre>');(c=e.id)&&f.find("a").attr("data-blockid",c);(c=WinAnnotation._getLastBlock(e).id)&&f.find("a").attr("data-endblockid",c);c=e.x;d=e.y;e.x=0;e.y=0;e.showDragHandle=false;e.setSelected(false,true);e._computeBounds();f.find("a").append($(e.getImage()));e.x=c;e.y=d;e._computeBounds();Scripts.clearIds(e);c=false;if(e.lockedInSandbox){delete e.lockedInSandbox;
c=true}!IDE.editingActor||IDE.editingActor==Runtime.background?f.find("a").attr("data-stage","Stage"):IDE.editingActor&&f.find("a").attr("data-actor",IDE.editingActor.label);if(e instanceof Block){e=JSON.stringify(ObjectIO.genScriptObj(e));f.find("img").attr("data-block",e);c&&f.find("img").attr("data-locked","true").addClass("locked")}else if(e instanceof Label){e=JSON.stringify(ObjectIO.genValueObj(e));f.find("img").attr("data-block",e);c&&f.find("img").attr("data-locked","true").addClass("locked")}b.find("div.note").append(f).append("<p><br/></p>")}}else if(e instanceof
WinAssets.DragObject){f=$('<p><a class="link" href="#"></a></p>');c="";if(e.sprite){var d=JSON.parse(e.sprite),g=d.currentCostume;if(g>0&&g<=d.costumes.length)if(c=d.costumes[g-1]){c=c.img;c.indexOf(".png")<0&&c.indexOf(".jpg")<0&&(c="")}else c="";d=d.label;f.find("a").attr("data-actor",d)}else f.find("a").attr("data-stage","Stage");f.find("a").append(c?'<img src="'+c+'"/>':$(e.img).clone());b.find("div.note").append(f)}WinAnnotation._updateOrder()}else{(e instanceof Block||e instanceof Label)&&WinCode._broadcastChange("delete",
e);return true}}},WinPuzzle={puzzleTitle:"",puzzleInstructions:"",originalProject:null,stageScripts:null,actors:null,enableFieldEdit:!1,enableDelete:!1,enableDeleteStart:!1,enableScrolling:!1,showTools:!1,blocksInTools:!1,blocksOnCanvas:!0,scrambledBlocks:[],startingBlocks:[],init:function(){$("#win-editor > a.close").click(function(){$("#win-editor").toggleClass("minimized");IDE.adjustPanels();return false});$("#win-editor a.solve").click(function(){$("#win-editor").addClass("minimized");IDE.adjustPanels();
Runtime.sendEvent("tynker.validate","any");return false})},adjustWindow:function(){},editBegin:function(){WinPuzzle.originalProject=ObjectIO.serialize();WinProperties.enable(false);WinTools.enable(false);if(!WinPuzzle.puzzleTitle)WinPuzzle.puzzleTitle=IDE.currentProjectName;if(!WinPuzzle.puzzleInstructions)IDE.puzzleInstructions=IDE.currentProjectDescription?IDE.currentProjectDescription:IDE.currentProjectName;$(".toolbar-top .main").addClass("hidden");$(".toolbar-top .puzzle").removeClass("hidden").empty();
$(".toolbar-top .title.puzzle").append('<input type="text"/> <textarea></textarea>');var b=$(".toolbar-top .title.puzzle input"),c=$(".toolbar-top .title.puzzle textarea");b.val(WinPuzzle.puzzleTitle);c.val(WinPuzzle.puzzleInstructions);b.focus(function(){$(this).addClass("active")}).blur(function(){$(this).removeClass("active");WinPuzzle.puzzleTitle=$(this).val();IDE.dirty()}).keydown(function(b){b.keyCode==13&&$(this).blur()});c.focus(function(){$(this).addClass("active")}).blur(function(){$(this).removeClass("active");
WinPuzzle.puzzleInstructions=$(this).val();IDE.dirty()});WinPuzzle.toolbarRemoveButtons();WinPuzzle.toolbarButton("Reset Puzzle",function(){WinPuzzle.originalProject&&ObjectIO.deserialize(WinPuzzle.originalProject,function(){for(var b=0;b<Runtime.sprites.length;b++)for(var c=0;c<Runtime.sprites[b].scripts.length;c++)WinCode.markBlockChildren(Runtime.sprites[b].scripts[c],false);for(b=0;b<Runtime.background.scripts.length;b++)WinCode.markBlockChildren(Runtime.background.scripts[b],false);Runtime.sprites.length>
0?IDE.selectAsset(Runtime.sprites[0]):IDE.selectAsset(null)});return false},"tertiary");WinPuzzle.toolbarButton("Done Editing",function(){WinPuzzle.editEnd();return false});WinCode.enableDecorations(false);WinStage.enableDecorations(false);WinAssets.enableDecorations(false);IDE.adjustPanels();WinAssets._enableContextMenu=false;WinAssets.enableDelete(false);IDE._enableKeyboardShortcuts=false;WinCode._enableRun=false;WinCode._enableDelete=false;WinCode._enableContextMenu=false;WinCode._enableFieldEdit=
false;WinCode._enableDragToDelete=false;WinCode._enableCutCopyPaste=false;WinCode._enableDoubleClick=false;for(b=0;b<Runtime.background.scripts.length;b++)WinPuzzle._saveOriginalParents(Runtime.background.scripts[b]);for(b=0;b<Runtime.sprites.length;b++)for(var c=Runtime.sprites[b],d=0;d<c.scripts.length;d++)WinPuzzle._saveOriginalParents(c.scripts[d]);WinPuzzle.scramble()},editEnd:function(){for(var b=0;b<Runtime.background.scripts.length;b++)WinPuzzle._restoreAttachment(Runtime.background.scripts[b],
Runtime.background);WinPuzzle._cleanScripts(Runtime.background);for(b=0;b<Runtime.background.scripts.length;b++)WinPuzzle._cleanOriginals(Runtime.background.scripts[b]);for(b=0;b<Runtime.sprites.length;b++){for(var c=Runtime.sprites[b],d=0;d<c.scripts.length;d++)WinPuzzle._restoreAttachment(c.scripts[d],c);WinPuzzle._cleanScripts(c);for(d=0;d<c.scripts.length;d++)WinPuzzle._cleanOriginals(c.scripts[d])}for(b=0;b<Runtime.background.scripts.length;b++)if(WinPuzzle._hasMark(Runtime.background.scripts[b]))Runtime.background.scripts[b].marked=
true;for(b=0;b<Runtime.sprites.length;b++){c=Runtime.sprites[b];for(d=0;d<c.scripts.length;d++)if(WinPuzzle._hasMark(c.scripts[d]))c.scripts[d].marked=true}WinCode.draw();WinProperties.enable(true);WinTools.enable(true);WinCode.enableDecorations(true);WinCode.enable(true);WinStage.enableDecorations(true);WinAssets.enableDecorations(true);$(".toolbar-top .main").removeClass("hidden");$(".toolbar-top .puzzle").addClass("hidden").empty();IDE.adjustPanels();WinAssets._enableContextMenu=true;WinAssets.enableDelete(true);
IDE._enableKeyboardShortcuts=true;WinCode._enableRun=true;WinCode._enableDelete=true;WinCode._enableContextMenu=true;WinCode._enableFieldEdit=true;WinCode._enableDragToDelete=true;WinCode._enableCutCopyPaste=true;WinCode._enableDoubleClick=true},toolbarTitle:function(b){b?$(".toolbar-top .title.puzzle").text(b):$(".toolbar-top .title.puzzle").text("")},toolbarText:function(b){WinPuzzle.description=b},toolbarRemoveButtons:function(){$(".toolbar-top .buttons.puzzle").empty()},toolbarButton:function(b,
c,d){b=$('<a class="action-btn '+d+'" href="#">'+b+"</a>");$(".toolbar-top .buttons.puzzle").append(b);b.click(function(){c&&c();return false})},showInfo:function(b){var c="<h1>"+WinPuzzle.puzzleTitle+"</h1><p>"+WinPuzzle.puzzleInstructions+"</p>",d=$('<a class="btnDefaultOrange medium">OK</a>');d.click(function(){IDE.showInfoPopup();b&&b();return false});IDE.showInfoPopup(c,null,d,true,true)},puzzleBegin:function(){WinPuzzle.toolsPalette=g_palette;WinPuzzle.scrambledBlocks=[];WinPuzzle.startingBlocks=
[];WinPuzzle._savedProject=ObjectIO.serialize();WinProperties.enable(false);WinTools.enable(WinPuzzle.showTools);WinTools.enableSearch(false);WinAssets.enable(false);WinCode.enable(true);WinStage.enableToolbar(false);WinCode.enableDocked(true);$("#win-editor > a.close").removeClass("hidden");$("#win-code .trash").css("display","none");$("#win-editor .puzzlebar").removeClass("hidden");$("#win-editor").addClass("over");window.WinToolbar&&WinToolbar.enable(true);$(".toolbar-top .main").addClass("hidden");
$(".toolbar-top .puzzle").removeClass("hidden").empty();if(!WinPuzzle.puzzleTitle)WinPuzzle.puzzleTitle=IDE.currentProjectName;if(!WinPuzzle.puzzleInstructions)WinPuzzle.puzzleInstructions=IDE.currentProjectDescription;WinPuzzle.toolbarTitle(IDE.currentProjectName);WinPuzzle.toolbarText(IDE.puzzleInstructions);WinPuzzle.toolbarRemoveButtons();WinPuzzle.toolbarButton("",WinPuzzle.showInfo,"icon-info");WinCode.enableDecorations(false);WinStage.enableDecorations(false);IDE._enableKeyboardShortcuts=false;
WinCode._enableRun=false;WinCode._enableDelete=WinPuzzle.enableDelete;WinCode._enableDeleteStart=WinPuzzle.enableDeleteStart;WinCode._enableScrolling=WinPuzzle.enableScrolling;WinCode._enableContextMenu=false;WinCode._enableFieldEdit=WinPuzzle.enableFieldEdit;WinCode._enableDragToDelete=WinPuzzle.enableDelete;WinCode._enableCutCopyPaste=false;WinCode._enableDoubleClick=false;IDE.adjustPanels();WinPuzzle.scramble();for(var b=[],c=0;c<Runtime.sprites.length;c++){for(var d=Runtime.sprites[c],e=false,
f=0;f<d.scripts.length;f++){if(!d.scripts[f].marked&&(!d.scripts[f].tags||d.scripts[f].tags.indexOf("visible")<0))d.scripts[f].hidden=true;else{e=true;Runtime.sprites[c].scripts[f].locked=true}WinCode.markBlockChildren(Runtime.sprites[c].scripts[f],false)}e&&b.push(d)}e=false;for(c=0;c<Runtime.background.scripts.length;c++){if(Runtime.background.scripts[c].marked){e=true;Runtime.background.scripts[f].locked=true}else Runtime.background.scripts[c].hidden=true;WinCode.markBlockChildren(Runtime.background.scripts[c],
false)}e&&b.push(null);WinCode.reRender();WinCode.draw();if(WinPuzzle.blocksInTools){d={label:"Misc",cat:"misc",items:[]};g_palette=[d];for(c=0;c<WinPuzzle.scrambledBlocks.length;c++)d.items.push(WinPuzzle.scrambledBlocks[c]);WinTools.enableSearch(false);WinTools.reset()}WinCode._showHidden=false;Runtime.stage.enableDragging(false);b.length>0?IDE.selectAsset(b[0]):IDE.selectAsset(null);if(b.length>1){WinAssets.enable(true);WinAssets.enableDecorations(false);WinAssets._enableContextMenu=false;WinAssets.enableDelete(false);
b.indexOf(null)<=0&&$("#win-assets > div.background").addClass("hidden");$("#win-assets > div.actors li").each(function(c,d){var e=$(d);b.indexOf(e.data("sprite"))<0&&e.addClass("hidden")})}WinAssets.enableDelete(false);WinPuzzle.showInfo(function(){WinStage.cmdStart()})},restoreTools:function(){if(WinPuzzle.toolsPalette){g_palette=WinPuzzle.toolsPalette;WinPuzzle.toolsPalette=null;WinPuzzle.scrambledBlocks=[];WinPuzzle.startingBlocks=[];WinTools.reset()}},puzzleEnd:function(){if(WinPuzzle.toolsPalette){g_palette=
WinPuzzle.toolsPalette;WinPuzzle.toolsPalette=null;WinPuzzle.scrambledBlocks=[];WinPuzzle.startingBlocks=[]}ObjectIO.deserialize(WinPuzzle._savedProject);WinProperties.enable(true);WinTools.enable(true);WinTools.enableSearch(true);WinAssets.enable(true);WinCode.enableDecorations(true);WinStage.enableDecorations(true);WinStage.enableToolbar(true);WinCode.enableDocked(false);$("#win-editor > a.close").addClass("hidden");$("#win-code .trash").css("display","");$("#win-editor .puzzlebar").addClass("hidden");
$("#win-editor").removeClass("over");$(".toolbar-top .main").removeClass("hidden");$(".toolbar-top .puzzle").addClass("hidden").empty();WinAssets._enableContextMenu=true;WinAssets.enableDelete(true);IDE._enableKeyboardShortcuts=true;WinCode._enableRun=true;WinCode._enableDelete=true;WinCode._enableDeleteStart=true;WinCode._enableScrolling=true;WinCode._enableContextMenu=true;WinCode._enableFieldEdit=true;WinCode._enableDragToDelete=true;WinCode._enableCutCopyPaste=true;WinCode._enableDoubleClick=
true;IDE.adjustPanels()},countBlocksUsed:function(){for(var b=0,c=0;c<Runtime.background.scripts.length;c++){var d=Runtime.background.scripts[c];if(!d.hasFlap&&(d.marked||!d.hidden))b=b+WinPuzzle._countBlocks(d)}for(c=0;c<Runtime.sprites.length;c++){var e=Runtime.sprites[c];if(!e.instantiated)for(var f=0;f<e.scripts.length;f++){d=e.scripts[f];if(!d.hasFlap&&(d.marked||!d.hidden))b=b+WinPuzzle._countBlocks(d)}}return b},_countBlocks:function(b){var c=0;if(b)if(b instanceof Label)for(var d=0;d<b._children.length;d++)c=
c+WinPuzzle._countBlocks(b._children[d]);else if(b instanceof Block){c=c+(1+WinPuzzle._countBlocks(b.label));for(d=0;d<b._containers.length;d++)c=c+WinPuzzle._countBlocks(b._containers[d]);c=c+WinPuzzle._countBlocks(b.next)}return c},_findMarks:function(b,c){if(b instanceof Block){(b.marked||b.tags&&b.tags.indexOf("visible")>=0)&&c.push(b);WinPuzzle._findMarks(b.label,c);for(var d=b.getNumContainers(),e=0,d=b.getNumContainers();e<d;e++){var f=b.getBlockAtContainer(e);f&&WinPuzzle._findMarks(f,c)}b.next&&
WinPuzzle._findMarks(b.next,c)}else if(b instanceof Label){(b.marked||b.tags&&b.tags.indexOf("visible")>=0)&&c.push(b);e=0;for(d=b.getNumSockets();e<d;e++)(f=b.getSocketAtChild(e))&&f._child&&WinPuzzle._findMarks(f._child,c)}return c},findMarks:function(b){for(var b=b.scripts,c=[],d=0;d<b.length;d++)WinPuzzle._findMarks(b[d],c);return c},scramble:function(){var b=null,c=WinPuzzle.findMarks(Runtime.background);if(c.length==0)for(var d=0;d<Runtime.sprites.length;d++){c=WinPuzzle.findMarks(Runtime.sprites[d]);
if(c.length>0){b=Runtime.sprites[d];break}}else b=Runtime.background;if(c&&b){for(d=0;d<c.length;d++)if(c[d].parent)c[d].detach();else for(var e=0;e<b.scripts.length;e++)if(b.scripts[e]==c[d]){b.scripts.splice(e,1);break}for(e=[];c.length>0;){var f=Math.floor(Math.random()*c.length),g=c[f];if(g.hasFlap){WinPuzzle.blocksOnCanvas&&b.scripts.unshift(g);for(var h=false,d=0;d<WinPuzzle.scrambledBlocks.length;d++)if(WinPuzzle.scrambledBlocks[d].labelText==g.labelText||WinPuzzle.scrambledBlocks[d].label==
g.label){h=true;break}h||WinPuzzle.scrambledBlocks.push(g.copy())}else{e.push(g);h=false;for(d=0;d<WinPuzzle.scrambledBlocks.length;d++)if(WinPuzzle.scrambledBlocks[d].labelText==g.labelText||WinPuzzle.scrambledBlocks[d].label==g.label){h=true;break}h||WinPuzzle.scrambledBlocks.push(g.copy());WinPuzzle.startingBlocks.push(g.copy())}c.splice(f,1)}for(d=0;d<e.length;d++)b.scripts.unshift(e[d]);IDE.selectAsset(b);WinCode.relayoutBlocks(true)}else Runtime.sprites.length>0&&(b=Runtime.sprites[0]);IDE.selectAsset(b)},
_hasMark:function(b){if(b){if(b.marked)return true;if(b instanceof Block){if(WinPuzzle._hasMark(b.next)||WinPuzzle._hasMark(b.label))return true;for(var c=b.getNumContainers(),d=0;d<c;d++)if(WinPuzzle._hasMark(b.getBlockAtContainer(d)))return true}else if(b instanceof Label){c=b.getNumSockets();for(d=0;d<c;d++)if(WinPuzzle._hasMark(b.getSocketAtChild(d)))return true}}return false},_cleanScripts:function(b){for(var c=0;c<b.scripts.length;c++)if(b.scripts[c]==null){b.scripts.splice(c,1);c--}},_restoreAttachment:function(b,
c){if(b&&b.origParent&&b.parent!=b.origParent.parent){b.marked=true;var d=b.origParent;if(d.parent!=null){if(b.parent==null)for(var e=0;e<c.scripts.length;e++)if(c.scripts[e]==b){c.scripts[e]=null;break}d.inContainer?d.parent.addToContainer(d.container,b):d.isNext?d.parent.add(b):d.isSocket&&d.parent.parent.setValue(d.socket,b)}}},_cleanOriginals:function(b){b&&b.origParent&&delete b.origParent;if(b instanceof Block){WinPuzzle._cleanOriginals(b.label);for(var c=b.getNumContainers(),d=0;d<c;d++)WinPuzzle._cleanOriginals(b.getBlockAtContainer(d));
b.next&&WinPuzzle._cleanOriginals(b.next)}else if(b instanceof Label){c=b.getNumSockets();for(d=0;d<c;d++)WinPuzzle._cleanOriginals(b.getSocketAtChild(d))}},_saveOriginalParents:function(b,c){if(b){b.origParent=c?c:{};b.origParent.parent=b.parent;if(b instanceof Block){WinPuzzle._saveOriginalParents(b.label);for(var d=b.getNumContainers(),e=0;e<d;e++)WinPuzzle._saveOriginalParents(b.getBlockAtContainer(e),{inContainer:true,container:e});b.next&&WinPuzzle._saveOriginalParents(b.next,{isNext:true})}else if(b instanceof
Label){d=b.getNumSockets();for(e=0;e<d;e++){var f=b.getSocketAtChild(e);f._child&&WinPuzzle._saveOriginalParents(f._child,{isSocket:true,socket:e})}}}},_diff:function(){for(var b=0;b<WinPuzzle.stageScripts.length;b++);for(b=0;b<WinPuzzle.actors.length;b++)for(var c=WinPuzzle.actors[b],d=0;d<c.scripts.length;d++);},setUpPuzzleExercise:function(b,c){IDE._ignoreDirty=true;WinCode.enableDocked(true);$("#win-editor > a.close").removeClass("hidden");$("#win-code .trash").css("display","none");$("#win-editor .puzzlebar").removeClass("hidden");
$("#win-editor").addClass("over");$("#win-code a.switchview").addClass("hidden");WinCode.enableDecorations(false);WinProperties.enable(false);WinTools.enableSearch(false);WinAssets.enable(true);WinAssets.enableStrip(true);WinStage.enableDecorations(false);WinSidebar.hide();WinStage.enableToolbar(false);window.WinToolbar&&WinToolbar.enable(true);$(".toolbar-top .main").addClass("hidden");$(".toolbar-top .puzzle").removeClass("hidden").empty();WinPuzzle.puzzleTitle=b;WinPuzzle.puzzleInstructions=c;
WinPuzzle.toolbarTitle(b);WinPuzzle.toolbarText(c);WinPuzzle.toolbarRemoveButtons();WinPuzzle.toolbarButton("",WinPuzzle.showInfo,"icon-info");IDE._enableKeyboardShortcuts=false;Canvas.hideSelections=true;WinCode._enableRun=false;WinCode._enableDelete=true;WinCode._enableDeleteStart=true;WinCode._enableScrolling=WinPuzzle.enableScrolling;WinCode._enableContextMenu=false;WinCode._enableFieldEdit=true;WinCode._enableDragToDelete=WinPuzzle.enableDelete;WinCode._enableCutCopyPaste=false;WinCode._enableDoubleClick=
false;WinCode.draw();if(WinPuzzle.blocksInTools){var d={label:"Misc",cat:"misc",items:[]};g_palette=[d];for(var e=0;e<WinPuzzle.scrambledBlocks.length;e++)d.items.push(WinPuzzle.scrambledBlocks[e]);WinTools.enableSearch(false);WinTools.reset()}Runtime.stage.enableDragging(false);WinAssets.enableDelete(false);$("#wincmd-restoreide").detach();$("#win-stage").css("width",window.innerWidth);IDE.adjustPanels();WinCode.adjustWindow();WinCode.enableSandbox(true);WinAssets.enableSandbox(true)}},WinExpressions=
{keywords:"PI E var round rand length abs floor ceil int sqrt sin cos tan asin acos atan ln log exp exp10 constant join".split(" "),re:RegExp(/^[a-zA-Z_][a-zA-Z0-9_]*$/),show:function(b,c){WinExpressions.expression=null;var d=$("#win-expressions");d.find(".blockimage").empty();d.find(".expression").val(b?b:"").unbind().keyup(function(){WinExpressions.build()});b&&WinExpressions.build();d.find(".exprhelpbtn a").unbind().click(function(){d.find(".exprhelp").toggleClass("hidden");d.find(".exprhelp").hasClass("hidden")?
$(this).html('More <span class="down"></span>'):$(this).html('Less <span class="up"></span>');d.modal();return false});var e=d.find("p.variables").empty(),f=false,g;for(g in Runtime.background.variables){f=$('<span class="global"><a class="op" op="'+WinExpressions._fixVar(g)+'" href="#">'+g+"</a></span>");e.append(f);f=true}if(IDE.editingActor&&IDE.editingActor!=Runtime.background)for(g in IDE.editingActor.variables){f=$('<span class="local"><a class="op" op="'+WinExpressions._fixVar(g)+'" href="#">'+
g+"</span>");e.append(f);f=true}f?d.find("div.variables").removeClass("hidden"):d.find("div.variables").addClass("hidden");d.find("a.op").unbind().click(function(){var b=d.find(".expression"),c=b.val(),e=$(this).attr("op"),f=b[0].selectionStart;b.val($.trim(c.substring(0,f)+" "+e+" "+c.substring(f)));WinExpressions.build();b[0].selectionStart=b[0].selectionEnd=f+e.length+1;b.focus();return false});d.modal();d.find(".okBtn").unbind().click(function(){try{var b=WinExpressions.expression.copy();if(c)c($.trim(d.find(".expression").val()),
b);else{b._computeBounds();b.x=-WinCode.context.offsetX+(WinCode.canvas.width-b.width)/2;b.y=-WinCode.context.offsetY+(WinCode.canvas.height-b.height)/2;WinCode._scripts.push(b)}b._computeBounds();WinCode._getScrollBounds();WinCode.draw()}catch(e){}$.modal.close();return false});d.find(".cancelBtn").unbind().click(function(){$.modal.close();return false})},hide:function(){$.modal.close()},_fixVar:function(b){for(var c="",d=b[0],c=d>="a"&&d<="z"||d>="A"&&d<"Z"||d=="_"?d:"_",e=1;e<b.length;e++){d=b[e];
c=d>="a"&&d<="z"||d>="A"&&d<"Z"||d>="0"&&d<="9"||d=="_"?c+d:c+"_"}return c},_resolveVars:function(b){if(b&&b instanceof Label){if(b.func=="valueVar"){if(IDE.editingActor&&IDE.editingActor!=Runtime.background)for(var c in IDE.editingActor.variables)if(WinExpressions._fixVar(c)==b.name){b.name=c;b._children[0].label=c;break}for(c in Runtime.background.variables)if(WinExpressions._fixVar(c)==b.name){b.name=c;b._children[0].label=c;break}}for(c=0;c<b._children.length;c++)b._children[c]instanceof LabelInput&&
b._children[c]._child&&WinExpressions._resolveVars(b._children[c]._child)}},build:function(){var b=$("#win-expressions .expression").val();try{WinExpressions.expression=g_expressionBuilder.parse(b);WinExpressions._resolveVars(WinExpressions.expression);var c=WinExpressions.expression.getImage();$("#win-expressions .blockimage").empty().append(c);$("#win-expressions .expression").removeClass("error")}catch(d){$("#win-expressions .expression").addClass("error")}},buildObject:function(b){try{var c=g_expressionBuilder.parse(b);
WinExpressions._resolveVars(c);return c}catch(d){}return null}},g_expressionBuilder=function(){function b(){this.yy={}}var c={trace:function(){},yy:{},symbols_:{error:2,expression:3,logical_or_expression:4,EOF:5,primary_expression:6,IDENTIFIER:7,NUMBER:8,STRING:9,"(":10,")":11,postfix_expression:12,"[":13,"]":14,argument_expression_list:15,",":16,unary_expression:17,unary_operator:18,"+":19,"-":20,"~":21,"!":22,multiplicative_expression:23,"*":24,"/":25,"%":26,additive_expression:27,shift_expression:28,
"<<":29,">>":30,">>>":31,relational_expression:32,"<":33,">":34,"<=":35,">=":36,equality_expression:37,"==":38,"!=":39,and_expression:40,"&":41,exclusive_or_expression:42,"^":43,inclusive_or_expression:44,"|":45,logical_and_expression:46,"&&":47,"||":48,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IDENTIFIER",8:"NUMBER",9:"STRING",10:"(",11:")",13:"[",14:"]",16:",",19:"+",20:"-",21:"~",22:"!",24:"*",25:"/",26:"%",29:"<<",30:">>",31:">>>",33:"<",34:">",35:"<=",36:">=",38:"==",39:"!=",41:"&",
43:"^",45:"|",47:"&&",48:"||"},productions_:[0,[3,2],[6,1],[6,1],[6,1],[6,3],[12,1],[12,4],[12,3],[12,4],[15,1],[15,3],[17,1],[17,2],[18,1],[18,1],[18,1],[18,1],[23,1],[23,3],[23,3],[23,3],[27,1],[27,3],[27,3],[28,1],[28,3],[28,3],[28,3],[32,1],[32,3],[32,3],[32,3],[32,3],[37,1],[37,3],[37,3],[40,1],[40,3],[42,1],[42,3],[44,1],[44,3],[46,1],[46,3],[4,1],[4,3]],performAction:function(b,c,d,h,j,k){b=k.length-1;switch(j){case 1:return k[b-1];case 2:if(k[b]=="PI"){j=makeBlockByName("valueOpConstants");
j.setValue(0,"pi")}else if(k[b]=="E"){j=makeBlockByName("valueOpConstants");j.setValue(0,"e")}else j=new Label({cat:"var",func:"valueVar",name:k[b]});this.$=j;break;case 3:this.$=k[b];break;case 4:this.$=k[b].substring(1,k[b].length-1);break;case 5:this.$=k[b-1];break;case 7:j=makeBlockByName("valueOpLetter");j.setValue(0,k[b-1]);j.setValue(1,k[b-3]);this.$=j;break;case 8:if(k[b-2]instanceof Label)j=k[b-2].name;else throw new Exception("invalid function");break;case 9:if(k[b-1].length<=0)throw new Exception("invalid parameters");
j=k[b-3];switch(j){case "var":j=new Label({cat:"var",func:"valueVar",name:k[b-1][0]});break;case "round":j=makeBlockByName("valueOpRound");j.setValue(0,k[b-1][0]);break;case "rand":j=makeBlockByName("valueOpRandom");if(k[b-1].length!=2)throw new Exception("invalid rand parameters");j.setValue(0,k[b-1][0]);j.setValue(1,k[b-1][1]);break;case "length":j=makeBlockByName("valueOpLength");j.setValue(0,k[b-1][0]);break;case "abs":j=makeBlockByName("valueOpMath");j.setValue(0,"abs");j.setValue(1,k[b-1][0]);
break;case "floor":j=makeBlockByName("valueOpMath");j.setValue(0,"floor");j.setValue(1,k[b-1][0]);break;case "ceil":j=makeBlockByName("valueOpMath");j.setValue(0,"ceiling");j.setValue(1,k[b-1][0]);break;case "int":j=makeBlockByName("valueOpMath");j.setValue(0,"int");j.setValue(1,k[b-1][0]);break;case "sqrt":j=makeBlockByName("valueOpMath");j.setValue(0,"sqrt");j.setValue(1,k[b-1][0]);break;case "sin":j=makeBlockByName("valueOpMath");j.setValue(0,"sin");j.setValue(1,k[b-1][0]);break;case "cos":j=makeBlockByName("valueOpMath");
j.setValue(0,"cos");j.setValue(1,k[b-1][0]);break;case "tan":j=makeBlockByName("valueOpMath");j.setValue(0,"tan");j.setValue(1,k[b-1][0]);break;case "asin":j=makeBlockByName("valueOpMath");j.setValue(0,"asin");j.setValue(1,k[b-1][0]);break;case "acos":j=makeBlockByName("valueOpMath");j.setValue(0,"acos");j.setValue(1,k[b-1][0]);break;case "atan":j=makeBlockByName("valueOpMath");j.setValue(0,"atan");j.setValue(1,k[b-1][0]);break;case "ln":j=makeBlockByName("valueOpMath");j.setValue(0,"ln");j.setValue(1,
k[b-1][0]);break;case "log":j=makeBlockByName("valueOpMath");j.setValue(0,"log");j.setValue(1,k[b-1][0]);break;case "exp":j=makeBlockByName("valueOpMath");j.setValue(0,"e^");j.setValue(1,k[b-1][0]);break;case "exp10":j=makeBlockByName("valueOpMath");j.setValue(0,"10^");j.setValue(1,k[b-1][0]);break;case "constant":j=makeBlockByName("valueOpConstants");j.setValue(0,k[b-1][0]);break;case "join":c=k[b-1].length;if(c>=2){j=makeBlockByName("valueOpJoin");j.setValue(0,k[b-1][c-2]);j.setValue(1,k[b-1][c-
1]);for(c=c-3;c>=0;c--){d=makeBlockByName("valueOpJoin");d.setValue(0,k[b-1][c]);d.setValue(1,j);j=d}this.$=j}else throw new Exception("invalid join parameters");break;default:throw new Exception("invalid function: "+k[b-3]);}this.$=j;break;case 10:this.$=[k[b]];break;case 11:k[b-2].push(k[b]);this.$=k[b-2];break;case 12:this.$=k[b];break;case 13:switch(k[b-1]){case "+":this.$=k[b];break;case "-":j=makeBlockByName("valueOpMultiply");j.setValue(0,-1);j.setValue(1,k[b]);this.$=j;break;case "~":j=makeBlockByName("valueOpNot");
j.setValue(0,k[b]);this.$=j;break;case "!":j=makeBlockByName("valueOpNot");j.setValue(0,k[b]);this.$=j;break;default:throw new Exception("illegal unary operator: "+k[b-1]);}break;case 14:this.$=k[b];break;case 15:this.$=k[b];break;case 16:this.$=k[b];break;case 17:this.$=k[b];break;case 19:j=makeBlockByName("valueOpMultiply");j.setValue(0,k[b-2]);j.setValue(1,k[b]);this.$=j;break;case 20:j=makeBlockByName("valueOpDivide");j.setValue(0,k[b-2]);j.setValue(1,k[b]);this.$=j;break;case 21:j=makeBlockByName("valueOpMod");
j.setValue(0,k[b-2]);j.setValue(1,k[b]);this.$=j;break;case 23:j=makeBlockByName("valueOpAdd");j.setValue(0,k[b-2]);j.setValue(1,k[b]);this.$=j;break;case 24:j=makeBlockByName("valueOpSubtract");j.setValue(0,k[b-2]);j.setValue(1,k[b]);this.$=j;break;case 26:j=makeBlockByName("valueOpBinary");j.setValue(0,k[b-2]);j.setValue(1,"<<");j.setValue(2,k[b]);this.$=j;break;case 27:j=makeBlockByName("valueOpBinary");j.setValue(0,k[b-2]);j.setValue(1,">>");j.setValue(2,k[b]);this.$=j;break;case 28:j=makeBlockByName("valueOpBinary");
j.setValue(0,k[b-2]);j.setValue(1,">>>");j.setValue(2,k[b]);this.$=j;break;case 30:j=makeBlockByName("valueOpLess");j.setValue(0,k[b-2]);j.setValue(1,k[b]);this.$=j;break;case 31:j=makeBlockByName("valueOpGreater");j.setValue(0,k[b-2]);j.setValue(1,k[b]);this.$=j;break;case 32:j=makeBlockByName("valueOpBinary");j.setValue(0,k[b-2]);j.setValue(1,"<=");j.setValue(2,k[b]);this.$=j;break;case 33:j=makeBlockByName("valueOpBinary");j.setValue(0,k[b-2]);j.setValue(1,">=");j.setValue(2,k[b]);this.$=j;break;
case 35:j=makeBlockByName("valueOpEqual");j.setValue(0,k[b-2]);j.setValue(1,k[b]);this.$=j;break;case 36:j=makeBlockByName("valueOpBinary");j.setValue(0,k[b-2]);j.setValue(1,"!=");j.setValue(2,k[b]);this.$=j;break;case 38:j=makeBlockByName("valueOpBinary");j.setValue(0,k[b-2]);j.setValue(1,"and");j.setValue(2,k[b]);this.$=j;break;case 40:j=makeBlockByName("valueOpBinary");j.setValue(0,k[b-2]);j.setValue(1,"xor");j.setValue(2,k[b]);this.$=j;break;case 42:j=makeBlockByName("valueOpBinary");j.setValue(0,
k[b-2]);j.setValue(1,"or");j.setValue(2,k[b]);this.$=j;break;case 44:j=makeBlockByName("valueOpAnd");j.setValue(0,k[b-2]);j.setValue(1,k[b]);this.$=j;break;case 46:j=makeBlockByName("valueOpOr");j.setValue(0,k[b-2]);j.setValue(1,k[b]);this.$=j}},table:[{3:1,4:2,6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,32:8,37:7,40:6,42:5,44:4,46:3},{1:[3]},{5:[1,24],48:[1,25]},{5:[2,45],11:[2,45],16:[2,45],47:[1,26],48:[2,45]},{5:[2,43],11:[2,
43],16:[2,43],45:[1,27],47:[2,43],48:[2,43]},{5:[2,41],11:[2,41],16:[2,41],43:[1,28],45:[2,41],47:[2,41],48:[2,41]},{5:[2,39],11:[2,39],16:[2,39],41:[1,29],43:[2,39],45:[2,39],47:[2,39],48:[2,39]},{5:[2,37],11:[2,37],16:[2,37],38:[1,30],39:[1,31],41:[2,37],43:[2,37],45:[2,37],47:[2,37],48:[2,37]},{5:[2,34],11:[2,34],16:[2,34],33:[1,32],34:[1,33],35:[1,34],36:[1,35],38:[2,34],39:[2,34],41:[2,34],43:[2,34],45:[2,34],47:[2,34],48:[2,34]},{5:[2,29],11:[2,29],16:[2,29],29:[1,36],30:[1,37],31:[1,38],33:[2,
29],34:[2,29],35:[2,29],36:[2,29],38:[2,29],39:[2,29],41:[2,29],43:[2,29],45:[2,29],47:[2,29],48:[2,29]},{5:[2,25],11:[2,25],16:[2,25],19:[1,39],20:[1,40],29:[2,25],30:[2,25],31:[2,25],33:[2,25],34:[2,25],35:[2,25],36:[2,25],38:[2,25],39:[2,25],41:[2,25],43:[2,25],45:[2,25],47:[2,25],48:[2,25]},{5:[2,22],11:[2,22],16:[2,22],19:[2,22],20:[2,22],24:[1,41],25:[1,42],26:[1,43],29:[2,22],30:[2,22],31:[2,22],33:[2,22],34:[2,22],35:[2,22],36:[2,22],38:[2,22],39:[2,22],41:[2,22],43:[2,22],45:[2,22],47:[2,
22],48:[2,22]},{5:[2,18],11:[2,18],16:[2,18],19:[2,18],20:[2,18],24:[2,18],25:[2,18],26:[2,18],29:[2,18],30:[2,18],31:[2,18],33:[2,18],34:[2,18],35:[2,18],36:[2,18],38:[2,18],39:[2,18],41:[2,18],43:[2,18],45:[2,18],47:[2,18],48:[2,18]},{5:[2,12],11:[2,12],13:[1,44],16:[2,12],19:[2,12],20:[2,12],24:[2,12],25:[2,12],26:[2,12],29:[2,12],30:[2,12],31:[2,12],33:[2,12],34:[2,12],35:[2,12],36:[2,12],38:[2,12],39:[2,12],41:[2,12],43:[2,12],45:[2,12],47:[2,12],48:[2,12]},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,
23],12:13,17:45,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20]},{5:[2,6],11:[2,6],13:[2,6],16:[2,6],19:[2,6],20:[2,6],24:[2,6],25:[2,6],26:[2,6],29:[2,6],30:[2,6],31:[2,6],33:[2,6],34:[2,6],35:[2,6],36:[2,6],38:[2,6],39:[2,6],41:[2,6],43:[2,6],45:[2,6],47:[2,6],48:[2,6]},{5:[2,2],10:[1,46],11:[2,2],13:[2,2],16:[2,2],19:[2,2],20:[2,2],24:[2,2],25:[2,2],26:[2,2],29:[2,2],30:[2,2],31:[2,2],33:[2,2],34:[2,2],35:[2,2],36:[2,2],38:[2,2],39:[2,2],41:[2,2],43:[2,2],45:[2,2],47:[2,2],48:[2,2]},{7:[2,14],8:[2,
14],9:[2,14],10:[2,14],19:[2,14],20:[2,14],21:[2,14],22:[2,14]},{7:[2,15],8:[2,15],9:[2,15],10:[2,15],19:[2,15],20:[2,15],21:[2,15],22:[2,15]},{7:[2,16],8:[2,16],9:[2,16],10:[2,16],19:[2,16],20:[2,16],21:[2,16],22:[2,16]},{7:[2,17],8:[2,17],9:[2,17],10:[2,17],19:[2,17],20:[2,17],21:[2,17],22:[2,17]},{5:[2,3],11:[2,3],13:[2,3],16:[2,3],19:[2,3],20:[2,3],24:[2,3],25:[2,3],26:[2,3],29:[2,3],30:[2,3],31:[2,3],33:[2,3],34:[2,3],35:[2,3],36:[2,3],38:[2,3],39:[2,3],41:[2,3],43:[2,3],45:[2,3],47:[2,3],48:[2,
3]},{5:[2,4],11:[2,4],13:[2,4],16:[2,4],19:[2,4],20:[2,4],24:[2,4],25:[2,4],26:[2,4],29:[2,4],30:[2,4],31:[2,4],33:[2,4],34:[2,4],35:[2,4],36:[2,4],38:[2,4],39:[2,4],41:[2,4],43:[2,4],45:[2,4],47:[2,4],48:[2,4]},{4:47,6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,32:8,37:7,40:6,42:5,44:4,46:3},{1:[2,1],14:[2,1]},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,
32:8,37:7,40:6,42:5,44:4,46:48},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,32:8,37:7,40:6,42:5,44:49},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,32:8,37:7,40:6,42:50},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,32:8,37:7,40:51},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,
17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,32:8,37:52},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,32:53},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,32:54},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:55},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,
18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:56},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:57},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:58},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:59},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,
19],22:[1,20],23:11,27:60},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:61},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:62},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:63},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:64,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20]},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],
12:13,17:65,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20]},{6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:66,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20]},{3:67,4:2,6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,32:8,37:7,40:6,42:5,44:4,46:3},{5:[2,13],11:[2,13],16:[2,13],19:[2,13],20:[2,13],24:[2,13],25:[2,13],26:[2,13],29:[2,13],30:[2,13],31:[2,13],33:[2,13],34:[2,13],35:[2,13],36:[2,13],38:[2,13],39:[2,13],41:[2,13],43:[2,
13],45:[2,13],47:[2,13],48:[2,13]},{4:70,6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],11:[1,68],12:13,15:69,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,32:8,37:7,40:6,42:5,44:4,46:3},{11:[1,71],48:[1,25]},{5:[2,46],11:[2,46],16:[2,46],47:[1,26],48:[2,46]},{5:[2,44],11:[2,44],16:[2,44],45:[1,27],47:[2,44],48:[2,44]},{5:[2,42],11:[2,42],16:[2,42],43:[1,28],45:[2,42],47:[2,42],48:[2,42]},{5:[2,40],11:[2,40],16:[2,40],41:[1,29],43:[2,40],45:[2,40],47:[2,40],48:[2,40]},{5:[2,38],
11:[2,38],16:[2,38],38:[1,30],39:[1,31],41:[2,38],43:[2,38],45:[2,38],47:[2,38],48:[2,38]},{5:[2,35],11:[2,35],16:[2,35],33:[1,32],34:[1,33],35:[1,34],36:[1,35],38:[2,35],39:[2,35],41:[2,35],43:[2,35],45:[2,35],47:[2,35],48:[2,35]},{5:[2,36],11:[2,36],16:[2,36],33:[1,32],34:[1,33],35:[1,34],36:[1,35],38:[2,36],39:[2,36],41:[2,36],43:[2,36],45:[2,36],47:[2,36],48:[2,36]},{5:[2,30],11:[2,30],16:[2,30],29:[1,36],30:[1,37],31:[1,38],33:[2,30],34:[2,30],35:[2,30],36:[2,30],38:[2,30],39:[2,30],41:[2,30],
43:[2,30],45:[2,30],47:[2,30],48:[2,30]},{5:[2,31],11:[2,31],16:[2,31],29:[1,36],30:[1,37],31:[1,38],33:[2,31],34:[2,31],35:[2,31],36:[2,31],38:[2,31],39:[2,31],41:[2,31],43:[2,31],45:[2,31],47:[2,31],48:[2,31]},{5:[2,32],11:[2,32],16:[2,32],29:[1,36],30:[1,37],31:[1,38],33:[2,32],34:[2,32],35:[2,32],36:[2,32],38:[2,32],39:[2,32],41:[2,32],43:[2,32],45:[2,32],47:[2,32],48:[2,32]},{5:[2,33],11:[2,33],16:[2,33],29:[1,36],30:[1,37],31:[1,38],33:[2,33],34:[2,33],35:[2,33],36:[2,33],38:[2,33],39:[2,33],
41:[2,33],43:[2,33],45:[2,33],47:[2,33],48:[2,33]},{5:[2,26],11:[2,26],16:[2,26],19:[1,39],20:[1,40],29:[2,26],30:[2,26],31:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26],38:[2,26],39:[2,26],41:[2,26],43:[2,26],45:[2,26],47:[2,26],48:[2,26]},{5:[2,27],11:[2,27],16:[2,27],19:[1,39],20:[1,40],29:[2,27],30:[2,27],31:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27],38:[2,27],39:[2,27],41:[2,27],43:[2,27],45:[2,27],47:[2,27],48:[2,27]},{5:[2,28],11:[2,28],16:[2,28],19:[1,39],20:[1,40],29:[2,28],30:[2,28],
31:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28],38:[2,28],39:[2,28],41:[2,28],43:[2,28],45:[2,28],47:[2,28],48:[2,28]},{5:[2,23],11:[2,23],16:[2,23],19:[2,23],20:[2,23],24:[1,41],25:[1,42],26:[1,43],29:[2,23],30:[2,23],31:[2,23],33:[2,23],34:[2,23],35:[2,23],36:[2,23],38:[2,23],39:[2,23],41:[2,23],43:[2,23],45:[2,23],47:[2,23],48:[2,23]},{5:[2,24],11:[2,24],16:[2,24],19:[2,24],20:[2,24],24:[1,41],25:[1,42],26:[1,43],29:[2,24],30:[2,24],31:[2,24],33:[2,24],34:[2,24],35:[2,24],36:[2,24],38:[2,24],
39:[2,24],41:[2,24],43:[2,24],45:[2,24],47:[2,24],48:[2,24]},{5:[2,19],11:[2,19],16:[2,19],19:[2,19],20:[2,19],24:[2,19],25:[2,19],26:[2,19],29:[2,19],30:[2,19],31:[2,19],33:[2,19],34:[2,19],35:[2,19],36:[2,19],38:[2,19],39:[2,19],41:[2,19],43:[2,19],45:[2,19],47:[2,19],48:[2,19]},{5:[2,20],11:[2,20],16:[2,20],19:[2,20],20:[2,20],24:[2,20],25:[2,20],26:[2,20],29:[2,20],30:[2,20],31:[2,20],33:[2,20],34:[2,20],35:[2,20],36:[2,20],38:[2,20],39:[2,20],41:[2,20],43:[2,20],45:[2,20],47:[2,20],48:[2,20]},
{5:[2,21],11:[2,21],16:[2,21],19:[2,21],20:[2,21],24:[2,21],25:[2,21],26:[2,21],29:[2,21],30:[2,21],31:[2,21],33:[2,21],34:[2,21],35:[2,21],36:[2,21],38:[2,21],39:[2,21],41:[2,21],43:[2,21],45:[2,21],47:[2,21],48:[2,21]},{14:[1,72]},{5:[2,8],11:[2,8],13:[2,8],16:[2,8],19:[2,8],20:[2,8],24:[2,8],25:[2,8],26:[2,8],29:[2,8],30:[2,8],31:[2,8],33:[2,8],34:[2,8],35:[2,8],36:[2,8],38:[2,8],39:[2,8],41:[2,8],43:[2,8],45:[2,8],47:[2,8],48:[2,8]},{11:[1,73],16:[1,74]},{11:[2,10],16:[2,10],48:[1,25]},{5:[2,
5],11:[2,5],13:[2,5],16:[2,5],19:[2,5],20:[2,5],24:[2,5],25:[2,5],26:[2,5],29:[2,5],30:[2,5],31:[2,5],33:[2,5],34:[2,5],35:[2,5],36:[2,5],38:[2,5],39:[2,5],41:[2,5],43:[2,5],45:[2,5],47:[2,5],48:[2,5]},{5:[2,7],11:[2,7],13:[2,7],16:[2,7],19:[2,7],20:[2,7],24:[2,7],25:[2,7],26:[2,7],29:[2,7],30:[2,7],31:[2,7],33:[2,7],34:[2,7],35:[2,7],36:[2,7],38:[2,7],39:[2,7],41:[2,7],43:[2,7],45:[2,7],47:[2,7],48:[2,7]},{5:[2,9],11:[2,9],13:[2,9],16:[2,9],19:[2,9],20:[2,9],24:[2,9],25:[2,9],26:[2,9],29:[2,9],30:[2,
9],31:[2,9],33:[2,9],34:[2,9],35:[2,9],36:[2,9],38:[2,9],39:[2,9],41:[2,9],43:[2,9],45:[2,9],47:[2,9],48:[2,9]},{4:75,6:15,7:[1,16],8:[1,21],9:[1,22],10:[1,23],12:13,17:12,18:14,19:[1,17],20:[1,18],21:[1,19],22:[1,20],23:11,27:10,28:9,32:8,37:7,40:6,42:5,44:4,46:3},{11:[2,11],16:[2,11],48:[1,25]}],defaultActions:{},parseError:function(b){throw Error(b);},parse:function(b){function c(){var b;b=d.lexer.lex()||1;typeof b!=="number"&&(b=d.symbols_[b]||b);return b}var d=this,h=[0],j=[null],k=[],l=this.table,
m="",n=0,q=0,p=0;this.lexer.setInput(b);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc=="undefined")this.lexer.yylloc={};b=this.lexer.yylloc;k.push(b);var s=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError==="function")this.parseError=this.yy.parseError;for(var r,o,t,u,w={},z,A;;){t=h[h.length-1];if(this.defaultActions[t])u=this.defaultActions[t];else{if(r===null||typeof r=="undefined")r=c();u=l[t]&&l[t][r]}if(typeof u==="undefined"||
!u.length||!u[0]){u="";if(!p){o=[];for(z in l[t])this.terminals_[z]&&z>2&&o.push("'"+this.terminals_[z]+"'");u=this.lexer.showPosition?"Parse error on line "+(n+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+o.join(", ")+", got '"+(this.terminals_[r]||r)+"'":"Parse error on line "+(n+1)+": Unexpected "+(r==1?"end of input":"'"+(this.terminals_[r]||r)+"'");this.parseError(u,{text:this.lexer.match,token:this.terminals_[r]||r,line:this.lexer.yylineno,loc:b,expected:o})}if(p==3){if(r==1)throw Error(u||
"Parsing halted.");q=this.lexer.yyleng;m=this.lexer.yytext;n=this.lexer.yylineno;b=this.lexer.yylloc;r=c()}for(;;){if((2).toString()in l[t])break;if(t===0)throw Error(u||"Parsing halted.");h.length=h.length-2;j.length=j.length-1;k.length=k.length-1;t=h[h.length-1]}o=r==2?null:r;r=2;t=h[h.length-1];u=l[t]&&l[t][2];p=3}if(u[0]instanceof Array&&u.length>1)throw Error("Parse Error: multiple actions possible at state: "+t+", token: "+r);switch(u[0]){case 1:h.push(r);j.push(this.lexer.yytext);k.push(this.lexer.yylloc);
h.push(u[1]);r=null;if(o){r=o;o=null}else{q=this.lexer.yyleng;m=this.lexer.yytext;n=this.lexer.yylineno;b=this.lexer.yylloc;p>0&&p--}break;case 2:A=this.productions_[u[1]][1];w.$=j[j.length-A];w._$={first_line:k[k.length-(A||1)].first_line,last_line:k[k.length-1].last_line,first_column:k[k.length-(A||1)].first_column,last_column:k[k.length-1].last_column};if(s)w._$.range=[k[k.length-(A||1)].range[0],k[k.length-1].range[1]];t=this.performAction.call(w,m,q,n,this.yy,u[1],j,k);if(typeof t!=="undefined")return t;
if(A){h=h.slice(0,A*-2);j=j.slice(0,-1*A);k=k.slice(0,-1*A)}h.push(this.productions_[u[1]][0]);j.push(w.$);k.push(w._$);t=l[h[h.length-2]][h[h.length-1]];h.push(t);break;case 3:return true}}return true}},d=function(){return{EOF:1,parseError:function(b,c){if(this.yy.parser)this.yy.parser.parseError(b,c);else throw Error(b);},setInput:function(b){this._input=b;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc=
{first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges)this.yylloc.range=[0,0];this.offset=0;return this},input:function(){var b=this._input[0];this.yytext=this.yytext+b;this.yyleng++;this.offset++;this.match=this.match+b;this.matched=this.matched+b;if(b.match(/(?:\r\n?|\n).*/g)){this.yylineno++;this.yylloc.last_line++}else this.yylloc.last_column++;this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return b},unput:function(b){var c=b.length,d=b.split(/(?:\r\n?|\n)/g);
this._input=b+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-c-1);this.offset=this.offset-c;b=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(d.length-1)this.yylineno=this.yylineno-(d.length-1);var h=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:d?(d.length===b.length?this.yylloc.first_column:
0)+b[b.length-d.length].length-d[0].length:this.yylloc.first_column-c};if(this.options.ranges)this.yylloc.range=[h[0],h[0]+this.yyleng-c];return this},more:function(){this._more=true;return this},less:function(b){this.unput(this.match.slice(b))},pastInput:function(){var b=this.matched.substr(0,this.matched.length-this.match.length);return(b.length>20?"...":"")+b.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var b=this.match;b.length<20&&(b=b+this._input.substr(0,20-b.length));return(b.substr(0,
20)+(b.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var b=this.pastInput(),c=Array(b.length+1).join("-");return b+this.upcomingInput()+"\n"+c+"^"},next:function(){if(this.done)return this.EOF;if(!this._input)this.done=true;var b,c,d;if(!this._more)this.match=this.yytext="";for(var h=this._currentRules(),j=0;j<h.length;j++)if((c=this._input.match(this.rules[h[j]]))&&(!b||c[0].length>b[0].length)){b=c;d=j;if(!this.options.flex)break}if(b){if(c=b[0].match(/(?:\r\n?|\n).*/g))this.yylineno=
this.yylineno+c.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:c?c[c.length-1].length-c[c.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length};this.yytext=this.yytext+b[0];this.match=this.match+b[0];this.matches=b;this.yyleng=this.yytext.length;if(this.options.ranges)this.yylloc.range=[this.offset,this.offset=this.offset+this.yyleng];this._more=false;this._input=this._input.slice(b[0].length);this.matched=
this.matched+b[0];b=this.performAction.call(this,this.yy,this,h[d],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input)this.done=false;if(b)return b}else return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var b=this.next();return typeof b!=="undefined"?b:this.lex()},begin:function(b){this.conditionStack.push(b)},popState:function(){return this.conditionStack.pop()},
_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(b){this.begin(b)},options:{},performAction:function(b,c,d){switch(d){case 1:return 8;case 2:return 7;case 3:return 9;case 4:return 9;case 5:return 24;case 6:return 25;case 7:return 26;case 8:return 20;case 9:return 19;case 10:return 43;case 11:return 10;case 12:return 11;case 13:return 13;case 14:return 14;
case 15:return 29;case 16:return 31;case 17:return 30;case 18:return 35;case 19:return 36;case 20:return 38;case 21:return 39;case 22:return 33;case 23:return 34;case 24:return 21;case 25:return 22;case 26:return 43;case 27:return 47;case 28:return 48;case 29:return 41;case 30:return 45;case 31:return 16;case 32:return 5;case 33:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+(\.[0-9]+)?\b)/,/^(?:[a-zA-Z_][a-zA-Z0-9_]*)/,/^(?:"[^\"]*")/,/^(?:'[^\']*')/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:-)/,/^(?:\+)/,
/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\[)/,/^(?:\])/,/^(?:<<)/,/^(?:>>>)/,/^(?:>>)/,/^(?:<=)/,/^(?:>=)/,/^(?:==)/,/^(?:!=)/,/^(?:<)/,/^(?:>)/,/^(?:~)/,/^(?:!)/,/^(?:\^)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:&)/,/^(?:\|)/,/^(?:,)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33],inclusive:true}}}}();c.lexer=d;b.prototype=c;c.Parser=b;return new b}();
"undefined"!==typeof require&&"undefined"!==typeof exports&&(exports.parser=g_expressionBuilder,exports.Parser=g_expressionBuilder.Parser,exports.parse=function(){return g_expressionBuilder.parse.apply(g_expressionBuilder,arguments)},exports.main=function(b){if(!b[1])throw Error("Usage: "+b[0]+" FILE");b=typeof process!=="undefined"?require("fs").readFileSync(require("path").resolve(b[1]),"utf8"):require("file").path(require("file").cwd()).join(b[1]).read({charset:"utf-8"});return exports.parser.parse(b)},
"undefined"!==typeof module&&require.main===module&&exports.main("undefined"!==typeof process?process.argv.slice(1):require("system").args));
var Help={indexPage:"help/index.aspx",searchPage:"help/search",init:function(b,c){b||(b="help/index.aspx");c||(c="help/search");Help.indexPage=b;Help.searchPage=c;$("#help").resizable().draggable({});$("#help > a").click(Help.hideHelp);$("#help .header h1 a").click(function(){$("#help iframe").attr("src",Help.indexPage);return false});$("#help .header label a").click(function(){$("#help .header label input").val("");$("#help iframe").attr("src",Help.indexPage);return false})},hideHelp:function(){$("#help").addClass("hidden").find("iframe").attr("src",
"ide/imgs/blank.png");return false},fetchHelp:function(b){b!=Help.lastUrl&&$.ajax({url:b,success:function(c){Help.lastUrl=b;Help.showHelp(c)}})},cmdHelp:function(b,c){window.WinBackpack&&WinBackpack.hide();var d=$("#help");d.removeClass("hidden").find("iframe").attr("src",Help.indexPage);d.css("width",d.outerWidth()).css("height",d.outerHeight()).css("right","").css("bottom","");d.find(".footer a").unbind().click(function(){Help.hideHelp();return false});d.find(".header input").val("").unbind().keydown(function(b){b.keyCode==
13&&d.find("iframe").attr("src",Help.searchPage+"?q="+escape($(this).val()))});b?d.find("iframe").attr("src",Help.searchPage+"?q="+escape(b)):c&&d.find("iframe").attr("src",c)},canDrag:function(b){if(!$("#help").hasClass("hidden")){var c=b.pageX,b=b.pageY,d=$("#help");if(c>=d.offset().left&&c<=d.offset().left+d.outerWidth()&&b>=d.offset().top&&b<=d.offset().top+d.outerHeight()-40)return true}return false},getDragObj:function(){return null},canDrop:function(){return false},drop:function(){},dragCanceled:function(){},
hideIDEHelp:function(){$("*").removeClass("winhilight");IDE.hideMask();if(Help._savedIDEHelp){for(var b=Help._savedIDEHelp.length-1;b>=0;b--)Help._savedIDEHelp[b].cleanup&&Help._savedIDEHelp[b].cleanup();Help._savedIDEHelp=null}},showIDEHelp:function(b,c,d,e){$("*").removeClass("winhilight");Help._savedIDEHelp=[];for(var f=null,g=null,h=Help._ideHelpSections,j=0;j<b.length;j++)if(h=h[b[j]]){Help._savedIDEHelp.push(h);h.select&&h.select();if(c)g=h;else if(f)h.hilight();else{var f=h,k=h.hilight();d&&
IDE.showMaskElement(k,null,e,true)}h=h.parts}else break;c&&g&&g.hilight()},_ideHelpSections:{studio:{hilight:function(){return null},cleanup:function(){}},"window.stage":{hilight:function(){return $("#win-stage").addClass("winhilight")},cleanup:function(){$("#win-stage").removeClass("winhilight")},parts:{"button.share":{hilight:function(){return $("#stagecmd-share").addClass("winhilight")},cleanup:function(){$("#stagecmd-share").removeClass("winhilight")}},"button.grid":{hilight:function(){return $("#stagecmd-grid").addClass("winhilight")},
cleanup:function(){$("#stagecmd-grid").removeClass("winhilight")}},"button.run":{hilight:function(){return $("#stagecmd-run").addClass("winhilight")},cleanup:function(){$("#stagecmd-run").removeClass("winhilight")}},"button.stop":{hilight:function(){return $("#stagecmd-stop").addClass("winhilight")},cleanup:function(){$("#stagecmd-stop").removeClass("winhilight")}}}},"window.assets":{hilight:function(){return $("#win-assets").addClass("winhilight")},cleanup:function(){$("#win-assets").removeClass("winhilight")},
parts:{"button.createnew":{hilight:function(){return $("#assetcmd-paint").addClass("winhilight")},cleanup:function(){$("#assetcmd-paint").removeClass("winhilight")}},"button.newactor":{hilight:function(){return $("#assetcmd-addactor").addClass("winhilight")},cleanup:function(){$("#assetcmd-addactor").removeClass("winhilight")}},"button.newblank":{hilight:function(){return $("#assetcmd-addblank").addClass("winhilight")},cleanup:function(){$("#assetcmd-addblank").removeClass("winhilight")}}}},"window.media":{select:function(){WinMediaAssets.showPicker("Media Library",
null,{backgrounds:false,images:true,sounds:false})},hilight:function(){return $("#win-medialib").addClass("winhilight")},cleanup:function(){$("#win-medialib").removeClass("winhilight");WinMediaAssets.hide()},parts:{}},"properties.interfaces":{select:function(){if(!IDE.editingActor||!IDE.editingActor.locked)for(var b=0;b<Runtime.sprites.length;b++)if(Runtime.sprites[b].locked){IDE.selectAsset(Runtime.sprites[b]);break}IDE.editingActor&&IDE.editingActor.locked&&WinProperties.show("interfaces")},hilight:function(){return IDE.editingActor&&
IDE.editingActor.locked?$("#win-properties div.interfaces").addClass("winhilight"):null},cleanup:function(){$("#win-properties div.interfaces").removeClass("winhilight")},parts:{properties:{hilight:function(){$("#win-properties div.interfaces").scrollTop($("#win-properties div.objprops").position().top);return $("#win-properties div.objprops").addClass("winhilight")},cleanup:function(){$("#win-properties div.objprops").removeClass("winhilight")}},incoming:{hilight:function(){$("#win-properties div.interfaces").scrollTop($("#win-properties div.inbound").position().top);
return $("#win-properties div.inbound").addClass("winhilight")},cleanup:function(){$("#win-properties div.inbound").removeClass("winhilight")}},outgoing:{hilight:function(){$("#win-properties div.interfaces").scrollTop($("#win-properties div.outbound").position().top);return $("#win-properties div.outbound").addClass("winhilight")},cleanup:function(){$("#win-properties div.outbound").removeClass("winhilight")}}}},"properties.looks":{select:function(){if(IDE.editingActor&&IDE.editingActor.locked)for(var b=
0;b<Runtime.sprites.length;b++)if(!Runtime.sprites[b].locked){IDE.selectAsset(Runtime.sprites[b]);break}(!IDE.editingActor||!IDE.editingActor.locked)&&WinProperties.show("looks")},hilight:function(){return!IDE.editingActor||!IDE.editingActor.locked?$("#win-properties div.looks").addClass("winhilight"):null},cleanup:function(){$("#win-properties div.looks").removeClass("winhilight")},parts:{"button.createnew":{hilight:function(){return $("#win-properties div.looks button.create").addClass("winhilight")},
cleanup:function(){$("#win-properties div.looks button.create").removeClass("winhilight")}},"button.addnew":{hilight:function(){return $("#win-properties div.looks button.add").addClass("winhilight")},cleanup:function(){$("#win-properties div.looks button.add").removeClass("winhilight")}},item:{hilight:function(){return $("#win-properties div.looks div.pcostumes li:first").addClass("winhilight")},cleanup:function(){$("#win-properties div.looks div.pcostumes li:first").removeClass("winhilight")},parts:{"input.name":{hilight:function(){return $("#win-properties div.looks div.pcostumes li:first input[type=text]").addClass("winhilight")},
cleanup:function(){$("#win-properties div.looks div.pcostumes li:first input[type=text]").removeClass("winhilight")}},"button.edit":{hilight:function(){return $("#win-properties div.looks div.pcostumes li:first button").addClass("winhilight")},cleanup:function(){$("#win-properties div.looks div.pcostumes li:first button").removeClass("winhilight")}}}}}},"properties.sounds":{select:function(){WinProperties.show("sounds")},hilight:function(){return $("#win-properties div.sounds").addClass("winhilight")},
cleanup:function(){$("#win-properties div.sounds").removeClass("winhilight")},parts:{"button.addnew":{hilight:function(){return $("#win-properties div.sounds button.add").addClass("winhilight")},cleanup:function(){$("#win-properties div.sounds button.add").removeClass("winhilight")}},item:{hilight:function(){$("#win-properties div.sounds div.psounds").scrollTop($("#win-properties div.sounds div.psounds li:first").position().top);return $("#win-properties div.sounds div.psounds li:first").addClass("winhilight")},
cleanup:function(){$("#win-properties div.sounds div.psounds li:first").removeClass("winhilight")},parts:{"input.name":{hilight:function(){return $("#win-properties div.sounds div.psounds li:first input[type=text]").addClass("winhilight")},cleanup:function(){$("#win-properties div.sounds div.psounds li:first input[type=text]").removeClass("winhilight")}},"button.play":{hilight:function(){return $("#win-properties div.sounds div.psounds li:first a.play").addClass("winhilight")},cleanup:function(){$("#win-properties div.sounds div.psounds li:first a.play").removeClass("winhilight")}},
"button.stop":{hilight:function(){return $("#win-properties div.sounds div.psounds li:first a.stop").addClass("winhilight")},cleanup:function(){$("#win-properties div.sounds div.psounds li:first a.stop").removeClass("winhilight")}},"button.delete":{hilight:function(){return $("#win-properties div.sounds div.psounds li:first a.delete").addClass("winhilight")},cleanup:function(){$("#win-properties div.sounds div.psounds li:first a.delete").removeClass("winhilight")}}}}}},"properties.notes":{select:function(){if(!IDE.editingActor||
IDE.editingActor&&IDE.editingActor.locked)for(var b=0;b<Runtime.sprites.length;b++)if(!Runtime.sprites[b].locked){IDE.selectAsset(Runtime.sprites[b]);break}IDE.editingActor&&WinProperties.show("notes")},hilight:function(){return IDE.editingActor?$("#win-properties div.notes").addClass("winhilight"):null},cleanup:function(){$("#win-properties div.notes").removeClass("winhilight")},parts:{description:{hilight:function(){$("#win-properties div.notes").scrollTop($("#win-properties div.description").position().top);
return $("#win-properties div.notes div.description").addClass("winhilight")},cleanup:function(){$("#win-properties div.notes div.description").removeClass("winhilight")}},incoming:{hilight:function(){$("#win-properties div.notes").scrollTop($("#win-properties div.inbound").position().top);return $("#win-properties div.notes div.inbound").addClass("winhilight")},cleanup:function(){$("#win-properties div.notes div.inbound").removeClass("winhilight")},parts:{item:{hilight:function(){$("#win-properties div.notes").scrollTop($("#win-properties div.notes div.inbound li:first").position().top);
return $("#win-properties div.notes div.inbound li:first").addClass("winhilight")},cleanup:function(){$("#win-properties div.notes div.inbound li:first").removeClass("winhilight")},parts:{description:{hilight:function(){return $("#win-properties div.notes div.inbound li:first input.description").addClass("winhilight")},cleanup:function(){$("#win-properties div.notes div.inbound li:first input.description").removeClass("winhilight")}}}}}},outgoing:{hilight:function(){$("#win-properties div.notes").scrollTop($("#win-properties div.outbound").position().top);
return $("#win-properties div.notes div.outbound").addClass("winhilight")},cleanup:function(){$("#win-properties div.notes div.outbound").removeClass("winhilight")},parts:{item:{hilight:function(){$("#win-properties div.notes").scrollTop($("#win-properties div.notes div.outbound li:first").position().top);return $("#win-properties div.notes div.outbound li:first").addClass("winhilight")},cleanup:function(){$("#win-properties div.notes div.outbound li:first").removeClass("winhilight")},parts:{description:{hilight:function(){return $("#win-properties div.notes div.outbound li:first input.description").addClass("winhilight")},
cleanup:function(){$("#win-properties div.notes div.outbound li:first input.description").removeClass("winhilight")}}}}}},properties:{hilight:function(){$("#win-properties div.notes").scrollTop($("#win-properties div.notes div.objprops").position().top);return $("#win-properties div.notes div.objprops").addClass("winhilight")},cleanup:function(){$("#win-properties div.notes div.objprops").removeClass("winhilight")},parts:{item:{hilight:function(){$("#win-properties div.notes").scrollTop($("#win-properties div.notes div.objprops li:first").position().top);
return $("#win-properties div.notes div.objprops li:first").addClass("winhilight")},cleanup:function(){$("#win-properties div.notes div.objprops li:first").removeClass("winhilight")},parts:{description:{hilight:function(){$("#win-properties div.notes").scrollTop($("#win-properties div.notes div.objprops li:first input.smalldescription").position().top);return $("#win-properties div.notes div.objprops li:first input.smalldescription").addClass("winhilight")},cleanup:function(){$("#win-properties div.notes div.objprops li:first input.smalldescription").removeClass("winhilight")}},
defaultvalue:{hilight:function(){$("#win-properties div.notes").scrollTop($("#win-properties div.notes div.objprops li:first input.default").position().top);return $("#win-properties div.notes div.objprops li:first input.default").addClass("winhilight")},cleanup:function(){$("#win-properties div.notes div.objprops li:first input.default").removeClass("winhilight")}}}}}}}},"actorproperties.advanced":{select:function(){WinProperties.show("advanced")},hilight:function(){return $("#win-properties div.advanced").addClass("winhilight")},
cleanup:function(){$("#win-properties div.advanced").removeClass("winhilight")},parts:{"button.maketblock":{hilight:function(){if(!IDE.editingActor.locked){$("#win-properties div.advanced").scrollTop($("#win-properties a.maketblock").position().top);return $("#win-properties div.advanced div.buttons a.save").addClass("winhilight")}return null},cleanup:function(){$("#win-properties div.advanced div.buttons a.save").removeClass("winhilight")}},"button.unlocktblock":{hilight:function(){if(IDE.editingActor.locked){$("#win-properties div.advanced").scrollTop($("#win-properties a.unlock").position().top);
return $("#win-properties div.advanced div.buttons a.unlock").addClass("winhilight")}return null},cleanup:function(){$("#win-properties div.advanced div.buttons a.unlock").removeClass("winhilight")}},"button.clone":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#win-properties a.clone").position().top);return $("#win-properties div.advanced div.buttons a.clone").addClass("winhilight")},cleanup:function(){$("#win-properties div.advanced div.buttons a.clone").removeClass("winhilight")}},
"section.rotation":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#sprite-rotate").position().top);return $("#sprite-rotate").addClass("winhilight")},cleanup:function(){$("#sprite-rotate").removeClass("winhilight")}},"button.allowdragging":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#sprite-dragging").position().top);return $("#win-properties div.advanced span.sprite-dragging").addClass("winhilight")},cleanup:function(){$("#win-properties div.advanced span.sprite-dragging").removeClass("winhilight")}},
"input.friction":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#sprite-friction").position().top);return $("#sprite-friction").addClass("winhilight")},cleanup:function(){$("#sprite-friction").removeClass("winhilight")}},"input.restitution":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#sprite-restitution").position().top);return $("#sprite-restitution").addClass("winhilight")},cleanup:function(){$("#sprite-restitution").removeClass("winhilight")}},"input.density":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#sprite-density").position().top);
return $("#sprite-density").addClass("winhilight")},cleanup:function(){$("#sprite-density").removeClass("winhilight")}},"section.geometry":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#sprite-geometry").position().top);return $("#sprite-geometry").addClass("winhilight")},cleanup:function(){$("#sprite-geometry").removeClass("winhilight")}},"button.isstatic":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#sprite-static").position().top);return $("#sprite-static").parent().addClass("winhilight")},
cleanup:function(){$("#sprite-static").parent().removeClass("winhilight")}},"button.isactive":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#sprite-active").position().top);return $("#sprite-active").parent().addClass("winhilight")},cleanup:function(){$("#sprite-active").parent().removeClass("winhilight")}}}},"stageproperties.advanced":{select:function(){IDE.editingActor&&IDE.selectAsset(null);WinProperties.show("advanced")},hilight:function(){return $("#win-properties div.advanced").addClass("winhilight")},
cleanup:function(){$("#win-properties div.advanced").removeClass("winhilight")},parts:{description:{hilight:function(){$("#win-properties div.advanced").scrollTop($("#win-properties div.advanced div.stage textarea").position().top);return $("#win-properties div.advanced div.stage textarea").addClass("winhilight")},cleanup:function(){$("#win-properties div.advanced div.stage textarea").removeClass("winhilight")}},"button.bgimgnormal":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#win-properties div.advanced input[value=normal]").position().top);
return $("#win-properties div.advanced input[value=normal]").parent().addClass("winhilight")},cleanup:function(){$("#win-properties div.advanced input[value=normal]").parent().removeClass("winhilight")}},"button.bgimgstretch":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#win-properties div.advanced input[value=stretch]").position().top);return $("#win-properties div.advanced input[value=stretch]").parent().addClass("winhilight")},cleanup:function(){$("#win-properties div.advanced input[value=stretch]").parent().removeClass("winhilight")}},
"button.bgimgtile":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#win-properties div.advanced input[value=tile]").position().top);return $("#win-properties div.advanced input[value=tile]").parent().addClass("winhilight")},cleanup:function(){$("#win-properties div.advanced input[value=tile]").parent().removeClass("winhilight")}},"button.bgfixed":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#bgfixed").position().top);return $("#bgfixed").parent().addClass("winhilight")},
cleanup:function(){$("#bgfixed").parent().removeClass("winhilight")}},"button.bgstretch":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#bgstretch").position().top);return $("#bgstretch").parent().addClass("winhilight")},cleanup:function(){$("#bgstretch").parent().removeClass("winhilight")}},"input.bgwidth":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#bgfixed-width").position().top);return $("#bgfixed-width").parent().addClass("winhilight")},cleanup:function(){$("#bgfixed-width").parent().removeClass("winhilight")}},
"input.bgheight":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#bgfixed-height").position().top);return $("#bgfixed-height").parent().addClass("winhilight")},cleanup:function(){$("#bgfixed-height").parent().removeClass("winhilight")}},"button.enablephysics":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#bg-physics").position().top);return $("#bg-physics").parent().addClass("winhilight")},cleanup:function(){$("#bg-physics").parent().removeClass("winhilight")}},
"input.gravityx":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#bg-gravity-x").position().top);return $("#bg-gravity-x").parent().addClass("winhilight")},cleanup:function(){$("#bg-gravity-x").parent().removeClass("winhilight")}},"input.gravityy":{hilight:function(){$("#win-properties div.advanced").scrollTop($("#bg-gravity-y").position().top);return $("#bg-gravity-y").parent().addClass("winhilight")},cleanup:function(){$("#bg-gravity-y").parent().removeClass("winhilight")}}}},
"window.code":{select:function(){WinCode.show()},hilight:function(){return $("#win-code").addClass("winhilight")},cleanup:function(){$("#win-code").removeClass("winhilight")},parts:{"input.search":{hilight:function(){return $("#win-code div.search").addClass("winhilight")},cleanup:function(){$("#win-code div.search").removeClass("winhilight")}},categories:{hilight:function(){return $("#tools-categories").addClass("winhilight")},cleanup:function(){$("#tools-categories").removeClass("winhilight")}},
tools:{hilight:function(){return $("#tools-blocks").addClass("winhilight")},cleanup:function(){$("#tools-blocks").removeClass("winhilight")}},workspace:{hilight:function(){return $("#win-code > canvas").addClass("winhilight")},cleanup:function(){$("#win-code > canvas").removeClass("winhilight")}}}},"window.toolbar":{hilight:function(){return $(".toolbar-top").addClass("winhilight")},cleanup:function(){$(".toolbar-top").removeClass("winhilight")},parts:{"button.home":{hilight:function(){return $(".wincmd-home").addClass("winhilight")},
cleanup:function(){$(".wincmd-home").removeClass("winhilight")}},"button.menu":{hilight:function(){return $("#wincmd-project").addClass("winhilight")},cleanup:function(){$("#wincmd-project").removeClass("winhilight")}},"button.undo":{hilight:function(){return $("#wincmd-tbundo").addClass("winhilight")},cleanup:function(){$("#wincmd-tbundo").removeClass("winhilight")}},"button.redo":{hilight:function(){return $("#wincmd-tbredo").addClass("winhilight")},cleanup:function(){$("#wincmd-tbredo").removeClass("winhilight")}},
"button.save":{hilight:function(){return $("#wincmd-tbsave").addClass("winhilight")},cleanup:function(){$("#wincmd-tbsave").removeClass("winhilight")}},"button.voice":{hilight:function(){return $("#wincmd-tbtalk").addClass("winhilight")},cleanup:function(){$("#wincmd-tbtalk").removeClass("winhilight")}}}}}},WinStage={enableDragging:!0,_showToolbarWhenMaximized:!1,_isStageState:!1,_isLegacyMode:!0,enable:function(b){b?$("#win-stage").removeClass("hidden"):$("#win-stage").addClass("hidden");IDE.adjustPanels()},
enableDecorations:function(b){b?$("#win-stage h1").removeClass("hidden"):$("#win-stage h1").addClass("hidden");IDE.adjustPanels()},enableToolbar:function(b){b?$("#stage-buttons").removeClass("hidden"):$("#stage-buttons").addClass("hidden");IDE.adjustPanels()},enableLegacy:function(b){WinStage._isLegacyMode=b;WinStage.setStageState(false)},setStageState:function(b){if(b){if(WinStage._isLegacyMode){$("#win-media-sidebar").removeClass("hidden");$("#win-levels").removeClass("hidden");WinStage.enableToolbar(true)}else{$("#win-media-sidebar").removeClass("hidden").addClass("collapsed");
$("#win-levels").removeClass("hidden").addClass("collapsed");WinStage.enableToolbar(false)}$(".canvas-toggle a").removeClass("selected");$("#stagecmd-edit").addClass("selected");WinCode.enable(false);WinProperties.enable(false);WinAssets.enable(false);WinStage.enable(true);WinStage.editTiles();if(WinAnnotation.isVisible){b=$("#win-annotation");b.detach();b.css("top",$(".toolbar-top").height()).css("left",0).css("bottom",0).css("width",250).css("height","").css("display","block").css("border-right",
"1px solid #aaa").find(".collapse").addClass("hidden");$("body").append(b)}$("#stagecmd-zoomin").removeClass("hidden");$("#stagecmd-zoomout").removeClass("hidden");IDE.adjustPanels()}else{if(WinAnnotation.isVisible){b=$("#win-annotation");b.detach();$("#win-tools .palette").after(b);b.css("height","").css("top","").css("left","").css("bottom","").css("width","").css("display","").css("border-right","").find(".collapse").removeClass("hidden");b=$("#win-annotation .entry.selected").attr("data-size");
b=="full"?$(".tools-resize-handle").css("top",window.innerHeight-$(".toolbar-top").outerHeight()):b=="half"&&$(".tools-resize-handle").css("top",(window.innerHeight-$(".toolbar-top").outerHeight())/2)}if(WinStage._isLegacyMode){$("#win-media-sidebar").addClass("hidden").removeClass("collapsed");$("#win-levels").addClass("hidden").removeClass("collapsed");$(".canvas-toggle a").removeClass("selected");$("#codecmd-edit").addClass("selected");WinCode.enable(true);WinProperties.enable(false);WinAssets.enable(true);
WinStage.enable(true);WinStage.enableToolbar(true);Runtime.stage.tileLayer.showGrid(false);$("#win-tools").css("top",0);$("#win-editor").removeClass("fullscreen");$(".runbutton").addClass("hidden");IDE.adjustPanels()}else{$("#win-media-sidebar").addClass("hidden").removeClass("collapsed");$("#win-levels").addClass("hidden").removeClass("collapsed");$(".canvas-toggle a").removeClass("selected");$("#codecmd-edit").addClass("selected");WinCode.enable(true);WinProperties.enable(false);WinAssets.enable(true);
WinStage.enable(false);WinStage.enableToolbar(false);Runtime.stage.tileLayer.showGrid(false);$("#win-editor").addClass("fullscreen");$(".runbutton").removeClass("hidden");IDE.adjustPanels();$("#win-tools").css("top",-($("#win-code").offset().top-$("#ide-header").outerHeight()))}$("#stagecmd-zoomin").addClass("hidden");$("#stagecmd-zoomout").addClass("hidden");Runtime.stage.canvasScale=1;Runtime.stage.tileLayer.setScrollOffset(Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.tileLayer.getScrollOffsetY());
Runtime.stage.draw()}},init:function(){$("#stagecmd-edit").click(function(){WinStage.setStageState(true);return false});$("#codecmd-edit").click(function(){WinStage.setStageState(false);return false});$("#stagecmd-minmax").click(WinStage.minmax);$("#stagecmd-reset").click(function(){for(var b=0;b<Runtime.sprites.length;b++)Runtime.sprites[b].bringIntoView();Runtime.stage.draw();return false});$("#stagecmd-grid").click(function(){WinStage.cmdGrid();return false});$("#stagecmd-run").click(function(){WinStage.cmdStart();
return false});$(".runbutton .play").click(function(){WinStage._isStageState=!WinCode.isEnabled();WinStage.setStageState(true);WinMediaSidebar.enableLevels(false);WinMediaSidebar.hide();WinStage.cmdStart();return false});$("#stagecmd-pause").click(function(){WinStage.cmdPause();return false});$("#stagecmd-resume").click(function(){WinStage.cmdResume();return false});$("#stagecmd-stop").click(function(){WinStage.cmdStop();return false});$(".runbutton .stop").click(function(){WinStage.setStageState(WinStage._isStageState);
WinStage.cmdStop();return false});$("#stagecmd-inspect").click(function(){window.WinTools&&WinTools.showDebugger();return false});$("#stagecmd-zoomin").click(function(){Runtime.stage.canvasScale=Runtime.stage.canvasScale+0.1;if(Runtime.stage.canvasScale>4)Runtime.stage.canvasScale=4;var b=Math.min(Runtime.stage.actorsLayer.canvas.width/(Runtime.stage.tileLayer.mapWidth*Runtime.stage.tileLayer.tileSize),Runtime.stage.actorsLayer.canvas.height/(Runtime.stage.tileLayer.mapHeight*Runtime.stage.tileLayer.tileSize));
if(Runtime.stage.canvasScale<b)Runtime.stage.canvasScale=b;Runtime.stage.tileLayer.setScrollOffset(Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.tileLayer.getScrollOffsetY());Runtime.stage.draw();return false});$("#stagecmd-zoomout").click(function(){Runtime.stage.canvasScale=Runtime.stage.canvasScale-0.1;if(Runtime.stage.canvasScale<0.1)Runtime.stage.canvasScale=0.1;var b=Math.min(Runtime.stage.actorsLayer.canvas.width/(Runtime.stage.tileLayer.mapWidth*Runtime.stage.tileLayer.tileSize),
Runtime.stage.actorsLayer.canvas.height/(Runtime.stage.tileLayer.mapHeight*Runtime.stage.tileLayer.tileSize));if(Runtime.stage.canvasScale<b)Runtime.stage.canvasScale=b;Runtime.stage.tileLayer.setScrollOffset(Runtime.stage.tileLayer.getScrollOffsetX(),Runtime.stage.tileLayer.getScrollOffsetY());Runtime.stage.draw();return false});Runtime.addRuntimeListener(WinStage.runtimeChanged);Runtime.stage.addListener("mousemoved",WinStage.mousemoved);$("#stage-canvas").mouseleave(function(){$("#win-stage #stage-buttons .pointerpos").addClass("hidden")}).mouseenter(function(){$("#win-stage #stage-buttons .pointerpos").removeClass("hidden")});
Runtime.blockEvents(true)},editTiles:function(){if($("#win-media-sidebar").hasClass("hidden")){$("#win-stage").removeClass("centeredframe");WinMediaSidebar.hide();WinCode.enable(true);WinAssets.enable(true);WinStage.enableDecorations(true);Runtime.stage.setDesignMode("normal");var b=parseInt($("#win-stage").attr("data-lastwidth"));b&&$("#win-stage").css("width",b);$("#win-stage").removeAttr("data-lastwidth");Runtime.stage.tileLayer.showGrid(false)}else{$("#win-stage").attr("data-lastwidth",""+$("#win-stage").innerWidth());
$("#win-stage").addClass("centeredframe");WinMediaSidebar.showLevels();WinMediaSidebar.showPicker("title",null,null,null);WinProperties.enable(false);WinCode.enable(false);WinAssets.enable(false);WinStage.enableDecorations(false);Runtime.stage.tileLayer.showGrid(true)}IDE.adjustPanels();return false},restore:function(){var b=$("#stagecmd-minmax");if(!b.hasClass("maximize")){b.addClass("maximize").removeClass("minimize");$("#win-stage").css("width",window.innerWidth*0.4);if(WinStage._minState){WinCode.enable(WinStage._minState.code);
WinAssets.enable(WinStage._minState.assets);WinStage._showToolbarWhenMaximized||WinToolbar.enable(WinStage._minState.toolbar);WinStage.enableDecorations(WinStage._minState.stage)}else{WinCode.enable(true);WinAssets.enable(true);WinStage._showToolbarWhenMaximized||WinToolbar.enable(true);WinStage.enableDecorations(true)}}},minmax:function(){var b=$(this);if(b.hasClass("maximize")){b.removeClass("maximize icon-full-screen").addClass("minimize icon-contract");$("#win-stage").removeClass("centeredframe");
if($("#win-media-sidebar").hasClass("hidden"))$("#win-stage").attr("data-lastwidth",""+$("#win-stage").innerWidth());else{$("#win-stage").attr("data-showsidebar","true");$("#win-media-sidebar").addClass("hidden");WinMediaSidebar.hide();WinMediaSidebar.enableLevels(false);WinCode.enable(true);WinAssets.enable(true);WinStage.enableDecorations(true);Runtime.stage.setDesignMode("normal");Runtime.stage.tileLayer.showGrid(false)}WinStage._minState={code:WinCode._enabled,properties:WinProperties._enabled,
assets:!$("#win-assets").hasClass("hidden"),toolbar:!$(".toolbar-top").hasClass("hidden"),stage:!$("#stage-controls").hasClass("hidden")};WinProperties.enable(false);WinCode.enable(false);WinAssets.enable(false);WinStage.enableDecorations(false);WinToolbar.enable(false);$(".buttons.stage.main").removeClass("hidden")}else{b.addClass("maximize icon-full-screen").removeClass("minimize icon-contract");if(WinStage._minState){WinCode.enable(WinStage._minState.code);WinAssets.enable(WinStage._minState.assets);
WinStage.enableDecorations(WinStage._minState.stage)}else{WinCode.enable(true);WinAssets.enable(true);WinStage.enableDecorations(true)}WinStage._showToolbarWhenMaximized||WinToolbar.enable(true);if($("#win-stage").attr("data-showsidebar")=="true"){$("#win-stage").removeAttr("data-showsidebar");$("#win-media-sidebar").removeClass("hidden");$("#win-stage").addClass("centeredframe");WinMediaSidebar.showPicker("title",null,null,null);WinMediaSidebar.enableLevels(true);WinProperties.enable(false);WinCode.enable(false);
WinAssets.enable(false);WinStage.enableDecorations(false);Runtime.stage.tileLayer.showGrid(true)}else{$("#win-stage").removeClass("centeredframe");(b=parseInt($("#win-stage").attr("data-lastwidth")))&&$("#win-stage").css("width",b);$("#win-stage").removeAttr("data-lastwidth")}}IDE.adjustPanels()},mousemoved:function(b){b=Runtime.stage.getMousePos();$("#win-stage #stage-buttons .pointerpos").text("["+Math.floor(b.x-Runtime.stage.getWidth()/2)+","+Math.floor(Runtime.stage.getHeight()/2-b.y)+"]")},cmdStart:function(){FocusManager.clearFocus();
WinCode.draw();Runtime.startScripts();WinStage.showStarted()},showStarted:function(){Runtime.blockEvents(false);$(".stagecmd-run").addClass("hidden");$(".stagecmd-stop").removeClass("hidden");$(".stagecmd-pause").removeClass("hidden");$(".stagecmd-resume").addClass("hidden");$(".runbutton").addClass("playing")},cmdStop:function(){Runtime.stopScripts();Runtime.stage.enableDragging(WinStage.enableDragging);Runtime.blockEvents(true);WinStage.showStopped()},showStopped:function(){$(".stagecmd-run").removeClass("hidden");
$(".stagecmd-stop").addClass("hidden");$(".stagecmd-pause").addClass("hidden");$(".stagecmd-resume").addClass("hidden");$(".runbutton").removeClass("playing")},cmdPause:function(){Runtime.pauseScripts();WinStage.showPaused()},cmdResume:function(){FocusManager.clearFocus();WinCode.draw();Runtime.resumeScripts();WinStage.showStarted()},showPaused:function(){$(".stagecmd-run").addClass("hidden");$(".stagecmd-stop").removeClass("hidden");$(".stagecmd-pause").addClass("hidden");$(".stagecmd-resume").removeClass("hidden");
$(".runbutton").addClass("playing")},adjustWindow:function(){var b=$("#stage-canvas").innerWidth(),c=$("#stage-canvas").innerHeight(),d=$("#win-stage").innerWidth(),e=$("#win-stage").innerHeight()-$("#win-stage .sprite-position:visible").outerHeight()-$("#stage-buttons:visible").outerHeight();$("#stage-canvas").css("width",d).css("height",e);$("#win-stage canvas").css("width",d).css("height",e);(b!=d||c!=e)&&Runtime.stage.updateStageSize();Runtime.stage.draw();Physics.updateWorld()},show:function(){$("#win-stage").removeClass("hidden")},
hide:function(){$("#win-stage").addClass("hidden")},canDrop:function(b,c,d,e){if(!$("#win-stage").hasClass("hidden")){d=$("#win-stage");if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight())if(e instanceof WinMediaAssets.DragObject&&(e.ext=="jpg"||e.ext=="png"||e.ext=="gif"||e.ext=="actor"||e.ext=="jpeg"||e.ext=="mp3"||e.ext=="wav")){d=$("#stage-canvas");b=b-d.offset().left;c=c-d.offset().top;if(b>=0&&b<d.width()&&c>=0&&c<d.height())return true}else if(window.WinAssets&&
e instanceof WinAssets.DragObject||window.WinTools&&(e.watchable||e.func=="valueVar"))return true}return false},drop:function(b,c,d,e,f,g){if(!$("#win-stage").hasClass("hidden")){var h=b,j=c,b=$("#win-stage");if(h>=b.offset().left&&h<=b.offset().left+b.outerWidth()&&j>=b.offset().top&&j<=b.offset().top+b.outerHeight())if(e instanceof WinMediaAssets.DragObject&&(e.ext=="jpg"||e.ext=="png"||e.ext=="gif"||e.ext=="actor"||e.ext=="jpeg"||e.ext=="mp3"||e.ext=="wav")){IDE.dirty();b=$("#stage-canvas");h=
h-b.offset().left;j=j-b.offset().top;c=e.path;if(c.substring(c.length-6)==".actor")ObjectIO.loadSprite(c,function(b){h=h/Runtime.stage.canvasScale;j=j/Runtime.stage.canvasScale;b.spriteObj.setPosition(h-Runtime.stage.tileLayer.scrollOffset.x,j-Runtime.stage.tileLayer.scrollOffset.y);Runtime.stage.draw();IDE.computeAll();IDE.draw();IDE.selectAsset(b);g&&g(b);IDE.Clipboard.undoAddActor(b)});else if(e.ext=="mp3"||e.ext=="wav")if((b=null)&&!b.locked){e=b.sprite.addSound({name:e.file,sound:c});g&&g(k);
IDE.Clipboard.undoAddSound(k,e)}else{e=Runtime.background.addSound({name:e.file,sound:c});g&&g(k);IDE.Clipboard.undoAddSound(Runtime.background,e)}else if((b=null)&&!b.sprite.locked){e=b.sprite.addCostume({name:e.file,img:c});b.sprite.setCostumeByName(e.name);g&&g(k);IDE.Clipboard.undoAddCostume(k,e)}else if(c.indexOf("/Backgrounds/")>=0){e=Runtime.background.addCostume({name:e.file,img:c});Runtime.background.setCostumeByName(e.name);IDE.selectAsset(null);g&&g(k);IDE.Clipboard.undoAddCostume(Runtime.background,
e)}else{var h=h/Runtime.stage.canvasScale,j=j/Runtime.stage.canvasScale,k=Sprites.addSprite({costumeName:e.file,img:c,forceNumber:false},g);k.spriteObj.setPosition(h-Runtime.stage.tileLayer.scrollOffset.x,j-Runtime.stage.tileLayer.scrollOffset.y);IDE.Clipboard.undoAddActor(k)}Runtime.stage.draw()}else if(e instanceof WinAssets.DragObject){IDE.dirty();if(!(e.sprite instanceof Sprite))if(e.sprite&&e.sprite.type=="background"){e=Runtime.background.addCostume({name:e.sprite.name,img:e.sprite.url});Runtime.background.setCostumeByName(e.name);
IDE.selectAsset(null);g&&g(k);IDE.Clipboard.undoAddCostume(Runtime.background,e)}else ObjectIO.deserializeSprite(JSON.parse(e.sprite),function(b){var c=$("#stage-canvas");h=h-c.offset().left;j=j-c.offset().top;h=h*Runtime.stage.getWidth()/c.innerWidth();j=j*Runtime.stage.getHeight()/c.innerHeight();h=h/Runtime.stage.canvasScale;j=j/Runtime.stage.canvasScale;b.spriteObj.setPosition(h-Runtime.stage.tileLayer.scrollOffset.x,j-Runtime.stage.tileLayer.scrollOffset.y);Runtime.stage.draw()})}else if(window.WinTools&&
(e.watchable||e.func=="valueVar")){b=$("#stage-canvas");h=h-b.offset().left;j=j-b.offset().top;h=h*Runtime.stage.getWidth()/b.innerWidth()-Runtime.stage.getWidth()/2;j=Runtime.stage.getHeight()/2-j*Runtime.stage.getHeight()/b.innerHeight();h=h/Runtime.stage.canvasScale;j=j/Runtime.stage.canvasScale;Runtime.addWatcher(IDE.editingActor,e,h-Runtime.stage.tileLayer.scrollOffset.x,j-Runtime.stage.tileLayer.scrollOffset.y)}}},runtimeChanged:function(b){if(b=="start")$("#win-stage").addClass("running");
else if(b=="stop"){Runtime.stage.enableDragging(WinStage.enableDragging);Runtime.blockEvents(true);$("#win-stage").removeClass("running")}},cmdGrid:function(){if($("#stagecmd-grid").hasClass("on")){$("#stagecmd-grid").removeClass("on");Runtime.stage.showGrid(false)}else{$("#stagecmd-grid").addClass("on");Runtime.stage.showGrid(true)}}},WinProperties={_enabled:!0,enableDoubleclick:!1,enableUnlock:!0,enable:function(b){if(b){WinProperties._enabled=true;$("#win-editor .info-bar").removeClass("hidden");
$("#win-properties").css("height",window.innerHeight*0.8);$("#win-properties").modal();WinProperties.show("looks");$("#win-editor").hasClass("hidden")&&$("#win-editor").removeClass("hidden");$("#win-editor").removeClass("nodecorations")}else{WinProperties._enabled=false;$("#win-editor .info-bar").addClass("hidden");$.modal.close();WinCode._enabled?$("#win-code").removeClass("hidden"):$("#win-editor").addClass("hidden");$("#win-editor h1").hasClass("hidden")&&$("#win-editor").addClass("nodecorations")}IDE.adjustPanels()},
init:function(){$("#win-editor .info-bar").removeClass("hidden");$("#win-editor h1 div").click(WinProperties.minmax);$("#win-properties .prop-tabs a.interfaces-tab").click(function(){WinProperties.show("interfaces");return false});$("#win-properties .prop-tabs a.looks-tab").click(function(){WinProperties.show("looks");return false});$("#win-properties .prop-tabs a.sounds-tab").click(function(){WinProperties.show("sounds");return false});$("#win-properties .prop-tabs a.advanced-tab").click(function(){WinProperties.show("advanced");
return false});$(".close-property").click(function(){$("#win-properties").addClass("hidden")});$(".help").mouseenter(function(){$(this).find("p").removeClass("hidden")}).mouseleave(function(){$(this).find("p").addClass("hidden")});$("#win-editor a.reset").click(function(){IDE.dirty();var b=IDE.editingSprite;if(b)b.bringIntoView();else for(b=0;b<Runtime.sprites.length;b++)Runtime.sprites[b].bringIntoView();Runtime.stage.draw();return false});$("#win-properties .buttons a.unlock").click(function(){IDE.confirmDialog(g_loc.getText("winproperties.confirmunlock"),
function(){if(IDE.editingActor){IDE.dirty();IDE.editingActor.locked=false;for(var b=0;b<IDE.editingActor.scripts.length;b++)IDE.editingActor.scripts[b].hidden=false;for(b=0;b<IDE.editingActor.costumes.length;b++)IDE.editingActor.costumes[b].hidden=false;for(b=0;b<IDE.editingActor.sounds.length;b++)IDE.editingActor.sounds[b].hidden=false;WinTools.reset();IDE.selectAsset(IDE.editingActor)}});return false});$("#win-properties .buttons a.save").click(function(){IDE.editingActor&&IDE.cmdActorSave(IDE.editingActor);
return false});if(window.WinSpine){$("#win-properties .tab-container.looks .avatar").click(function(){var b=IDE.editingActor;b&&WinSpine.showCreator(function(d,e){b.loadSkeleton(d,e)},b.skeleton.type,b.skeleton.parts)});Runtime.stage.addListener("doubleclicked",function(){if(WinProperties.enableDoubleClick){var b=IDE.editingActor;b&&(b.skeleton&&b.skeleton.skeletonData)&&WinSpine.showCreator(function(d,e){b.loadSkeleton(d,e)},b.skeleton.type,b.skeleton.parts)}})}$("#win-properties .tab-container.looks .add").click(WinProperties._addCostumeButton);
$("#win-properties .tab-container.looks .draw").click(function(){if(!$(this).hasClass("disabled")){window.WinPaint&&WinPaint.edit(g_loc.getText("title.paint_create_actor"),null,null,null,function(b,d,e){WinProperties._addAssetAsCostume([{url:b,name:"drawing",cx:d,cy:e}])});$.modal.close()}return false});$("#win-properties .tab-container.looks .url input").keypress(function(b){var d=$("#win-properties .looks .url input").val();b.which==13&&generateImageFromUrl(d,function(){WinProperties._addAssetAsCostume([{url:d,
name:"URL"}])})});$("#win-properties .tab-container.sounds .url input").keypress(function(b){var d=$("#win-properties .sounds .url input").val();b.which==13&&(IDE.editingActor?IDE.addResourceTo(d,"Audio",IDE.editingActor):IDE.addResourceTo(d,"Audio",Runtime.background))});$("#win-properties .tab-container.sounds .add").click(WinProperties._addSoundButton);$("#bg-tilemap").click(function(){IDE.dirty();this.checked?Runtime.stage.tileLayer.enableTiles(true):Runtime.stage.tileLayer.enableTiles(false)});
$("#bg-scrollbg").click(function(){IDE.dirty();if(this.checked){Runtime.stage.tileLayer.scrollBgOffset=true;IDE.dirty();Runtime.stage.setStageExpand(false);WinProperties._updateCanvas();$("#bgexpand")[0].checked=false}else Runtime.stage.tileLayer.scrollBgOffset=false});$("#bg-tilemap-width").blur(function(){IDE.dirty();var b=parseInt($("#bg-tilemap-width").val());b<Runtime.stage.getWidth()/Runtime.stage.tileLayer.tileSize?b=Math.ceil(Runtime.stage.getWidth()/Runtime.stage.tileLayer.tileSize):b>100&&
(b=100);var d=parseInt($("#bg-tilemap-height").val());d<Runtime.stage.getHeight()/Runtime.stage.tileLayer.tileSize?d=Math.ceil(Runtime.stage.getHeight()/Runtime.stage.tileLayer.tileSize):d>100&&(d=100);$("#bg-tilemap-width").val(b);$("#bg-tilemap-height").val(d);Runtime.stage.tileLayer.setSize(b,d)}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#bg-tilemap-height").blur(function(){IDE.dirty();var b=parseInt($("#bg-tilemap-width").val());b<Runtime.stage.getWidth()/Runtime.stage.tileLayer.tileSize?
b=Math.ceil(Runtime.stage.getWidth()/Runtime.stage.tileLayer.tileSize):b>100&&(b=100);var d=parseInt($("#bg-tilemap-height").val());d<Runtime.stage.getHeight()/Runtime.stage.tileLayer.tileSize?d=Math.ceil(Runtime.stage.getHeight()/Runtime.stage.tileLayer.tileSize):d>100&&(d=100);$("#bg-tilemap-width").val(b);$("#bg-tilemap-height").val(d);Runtime.stage.tileLayer.setSize(b,d)}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#bg-physics").click(function(){IDE.dirty();this.checked?Physics.isSimulationRunning()||
Physics.runSimulation():Physics.isSimulationRunning()&&Physics.stopSimulation()});$("#bg-gravity-x").blur(function(){IDE.dirty();Physics.updateGravity(parseFloat($("#bg-gravity-x").val()),parseFloat($("#bg-gravity-y").val()))}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#bg-gravity-y").blur(function(){IDE.dirty();Physics.updateGravity(parseFloat($("#bg-gravity-y").val()),parseFloat($("#bg-gravity-y").val()))}).keypress(function(b){b.which==13&&$(this)[0].blur()});$(".stage input[type=radio]").click(function(){IDE.dirty();
Runtime.stage.setBackgroundType($(this).val());WinProperties._updateCanvas()});$("#bgfixed-width").blur(function(){IDE.dirty();WinProperties._updateCanvas()}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#bgfixed-height").blur(function(){IDE.dirty();WinProperties._updateCanvas()}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#bgexpand").click(function(){IDE.dirty();Runtime.stage.setStageExpand(this.checked);WinProperties._updateCanvas()});$("#project-name").blur(function(){IDE.dirty();
IDE.setTitle($(this).val())}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#win-properties .tab-container.advanced .stage textarea").blur(function(){IDE.dirty();IDE.currentProjectDescription=$(this).val()}).keypress(function(b){b.which==13&&$(this)[0].blur()});$(".sprite-rotate input").click(function(){IDE.dirty();if(IDE.editingActor){$(this).val()=="rotate"?IDE.editingActor.spriteObj.setRotateLock(0):$(this).val()=="flip"?IDE.editingActor.spriteObj.setRotateLock(1):$(this).val()=="norotate"&&
IDE.editingActor.spriteObj.setRotateLock(2);Runtime.stage.draw()}});$("input.sprite-dragging").click(function(){IDE.dirty();IDE.editingActor&&IDE.editingActor.spriteObj.setDraggable(this.checked)});$("#sprite-name span").click(function(){$(this).addClass("hidden");var b=$(this).text();if(IDE.editingActor)b=IDE.editingActor.label;$(this).parent().find("input").removeClass("hidden").val(b).focus()});$("#sprite-name input").blur(function(){if(IDE.editingActor){IDE.dirty();var b=IDE.editingActor.changeSpriteName($(this).val());
$(this).addClass("hidden");$("#sprite-name span").text(b).removeClass("hidden")}}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#win-code .sprite-position .toggle").click(function(){$("#win-code .sprite-position .details").toggleClass("show");return false});$("#sprite-x span").click(function(){$(this).addClass("hidden");var b=$(this).text();IDE.editingActor&&(b=IDE.editingActor.spriteObj.x-Runtime.stage.getWidth()/2);$(this).parent().find("input").removeClass("hidden").val(b).focus()});
$("#sprite-x input").blur(function(){if(IDE.editingActor){IDE.dirty();var b=parseFloat($(this).val());isNaN(b)&&(b=0);var d=Runtime.stage.getWidth()/2+b;IDE.editingActor.spriteObj.setPosition(d,IDE.editingActor.spriteObj.y);Runtime.stage.draw();$(this).addClass("hidden");$("#sprite-x span").text(Math.round(b*10)/10).removeClass("hidden")}}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#sprite-y span").click(function(){$(this).addClass("hidden");var b=$(this).text();IDE.editingActor&&(b=
Runtime.stage.getHeight()/2-IDE.editingActor.spriteObj.y);$(this).parent().find("input").removeClass("hidden").val(b).focus()});$("#sprite-y input").blur(function(){if(IDE.editingActor){IDE.dirty();var b=IDE.editingActor.spriteObj.x,d=parseFloat($(this).val());isNaN(d)&&(d=0);var e=Runtime.stage.getHeight()/2-d;IDE.editingActor.spriteObj.setPosition(b,e);Runtime.stage.draw();$(this).addClass("hidden");$("#sprite-y span").text(Math.round(d*10)/10).removeClass("hidden")}}).keypress(function(b){b.which==
13&&$(this)[0].blur()});$("#sprite-angle span").click(function(){$(this).addClass("hidden");var b=$(this).text();if(IDE.editingActor){b=(Math.floor(IDE.editingActor.spriteObj.rotation)+90)%360;b>180&&(b=b-360)}$(this).parent().find("input").removeClass("hidden").val(b).focus()});$("#sprite-angle input").blur(function(){if(IDE.editingActor){IDE.dirty();var b=parseFloat($(this).val());isNaN(b)&&(b=90);IDE.editingActor.spriteObj.setRotation(-(90-b));b=(Math.floor(IDE.editingActor.spriteObj.rotation)+
90)%360;b>180&&(b=b-360);Runtime.stage.draw();$(this).addClass("hidden");$("#sprite-angle span").text(b).removeClass("hidden")}}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#sprite-scale span").click(function(){$(this).addClass("hidden");var b=$(this).text();IDE.editingActor&&(b=IDE.editingActor.spriteObj.scale.x*100);$(this).parent().find("input").removeClass("hidden").val(b).focus()});$("#sprite-scale input").blur(function(){if(IDE.editingActor){IDE.dirty();var b=parseFloat($(this).val())/
100;isNaN(b)&&(b=1);IDE.editingActor.spriteObj.setScale(b);Runtime.stage.draw();$(this).addClass("hidden");$("#sprite-scale span").text(Math.round(b*1E3)/10).removeClass("hidden")}}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#sprite-layer span").click(function(){$(this).addClass("hidden");$(this).parent().find("input").removeClass("hidden").val(IDE.editingActor.spriteObj.zIndex).focus()});$("#sprite-layer input").blur(function(){if(IDE.editingActor){IDE.dirty();var b=parseInt($(this).val());
IDE.editingActor.spriteObj.setZIndex(b);Runtime.stage.draw();$(this).addClass("hidden");$("#sprite-layer span").text(b).removeClass("hidden")}}).keypress(function(b){b.which==13&&$(this)[0].blur()});var b=function(){IDE.editingActor&&Physics.updateFixture(IDE.editingActor.spriteObj,parseFloat($("#sprite-density").val()),parseFloat($("#sprite-friction").val()),parseFloat($("#sprite-restitution").val()))};$("#sprite-matpreset").change(function(){var b=$(this).val().split(",");$("#sprite-friction").val(b[0]).blur();
$("#sprite-restitution").val(b[1]).blur()});$("#sprite-density").blur(function(){IDE.dirty();b()}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#sprite-friction").blur(function(){IDE.dirty();b()}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#sprite-restitution").blur(function(){IDE.dirty();b()}).keypress(function(b){b.which==13&&$(this)[0].blur()});$("#sprite-geometry input").click(function(){if(IDE.editingActor){IDE.dirty();Physics.updateBody(IDE.editingActor.spriteObj,{geometry:$(this).val()})}});
$("#sprite-static").click(function(){if(IDE.editingActor){IDE.dirty();IDE.editingActor.spriteObj.physicsBody.SetType(this.checked?b2Body.b2_staticBody:b2Body.b2_dynamicBody)}});$("#sprite-active").click(function(){if(IDE.editingActor){IDE.dirty();IDE.editingActor.spriteObj.physicsBody.SetActive(this.checked)}});window.setInterval(WinProperties.periodicUpdate,1E3);WinProperties.adjustWindow()},_addCostumeButton:function(){var b="";if(IDE.editingActor&&IDE.editingActor!=Runtime.background){b=g_loc.getText("winmedialib.addcostume");
WinMediaAssets.showPicker(b,WinProperties._addAssetAsCostume,{backgrounds:true,actors:false,images:true,sounds:false,charStudio:false})}else{b=g_loc.getText("winmedialib.addscene");WinMediaAssets.showPicker(b,WinProperties._addAssetAsCostume,{backgrounds:true,actors:false,images:false,sounds:false,charStudio:false})}},_addSoundButton:function(){WinProperties._soundsAddSound()},minmax:function(){var b=$(this);if(b.hasClass("maximize")){b.removeClass("maximize").addClass("minimize");WinProperties._minState=
{properties:WinProperties._enabled,assets:!$("#win-assets").hasClass("hidden"),toolbar:!$(".toolbar-top").hasClass("hidden"),stage:!$("#win-stage").hasClass("hidden")};WinAssets.enable(false);WinProperties.enable(false);WinToolbar.enable(false);WinStage.enable(false)}else{b.addClass("maximize").removeClass("minimize");$("#win-stage").css("width",window.innerWidth*0.4);if(WinStage._minState){WinProperties.enable(WinStage._minState.properties);WinCode.enable(true);WinAssets.enable(WinStage._minState.assets);
WinToolbar.enable(WinStage._minState.toolbar);WinStage.enable(WinStage._minState.stage)}else{WinProperties.enable(true);WinCode.enable(true);WinAssets.enable(true);WinToolbar.enable(true);WinStage.enable(true)}}},_looksCreateCostume:function(){var b=IDE.editingActor?g_loc.formatText("title.paint_create_costume",IDE.editingActor.label):g_loc.getText("title.paint_create_bg");window.WinPaint&&WinPaint.edit(b,null,null,null,function(b){IDE.editingActor?IDE.addResourceTo(b,g_loc.getText("wincontent.defaultlabel"),
IDE.editingActor):IDE.addResourceTo(b,g_loc.getText("wincontent.defaultlabel"),Runtime.background)});$.modal.close();return false},_addAssetAsCostume:function(b){IDE._ignoreUpdates=true;for(var c=0;c<b.length;c++)IDE.editingActor?IDE.addResourceTo(b[c].url,b[c].name,IDE.editingActor):IDE.addResourceTo(b[c].url,b[c].name,Runtime.background);IDE._ignoreUpdates=false;WinProperties.update()},_soundsAddSound:function(){var b="";if(IDE.editingActor){root="Sounds";b=g_loc.getText("winmedialib.addsoundtoactor")}else{root=
"Sounds";b=g_loc.getText("winmedialib.addsoundtostage")}WinMediaAssets.showPicker(b,WinProperties._addAssetAsCostume,{backgrounds:false,actors:false,images:false,sounds:true,charStudio:false});return false},_addAssetAsSound:function(b){IDE._ignoreUpdates=true;for(var c=0;c<b.length;c++)IDE.editingActor?IDE.addResourceTo(b[c].url,b[c].name,IDE.editingActor):IDE.addResourceTo(b[c].url,b[c].name,Runtime.background);IDE._ignoreUpdates=false;WinProperties.update()},_soundsRecordSound:function(){WinMediaCapture.showAudioRecorder(function(b){IDE.editingActor?
IDE.addResourceTo(b,"Recording",IDE.editingActor):IDE.addResourceTo(b,"Recording",Runtime.background)});return false},adjustWindow:function(){$("#win-editor > div.container").css("top",$("#win-editor h1:visible").outerHeight()+0);$("#win-editor").hasClass("docked")?$("#win-code .code canvas").css("top",0).attr("height",$("#win-code .code").innerHeight()):WinCode.adjustWindow()},displayTab:function(b){$("#win-properties").removeClass("looks").removeClass("sounds").removeClass("advanced").removeClass("interfaces").removeClass("notes").addClass(b)},
show:function(b){$("#win-properties").css("height",window.innerHeight*0.8);$("#win-properties").modal();$("#win-properties").removeClass("hidden").removeClass("looks").removeClass("sounds").removeClass("advanced").removeClass("interfaces").removeClass("notes").addClass(b);b=="looks"&&(IDE.editingActor&&IDE.editingActor!=Runtime.background)&&WinProperties.updateCostumes(IDE.editingActor);return false},hide:function(){$.modal.close();return false},periodicUpdate:function(){if(IDE.editingActor==null){$("#win-editor .stage-properties").removeClass("hidden");
$("#win-editor .lockedactor-properties").addClass("hidden");$("#win-editor .actor-properties").addClass("hidden");WinProperties.updateBackgroundDetails()}else if(IDE.editingActor.spriteObj){$("#win-editor .stage-properties").addClass("hidden");IDE.editingActor.locked?$("#win-editor .lockedactor-properties").removeClass("hidden"):$("#win-editor .actor-properties").removeClass("hidden");WinProperties.updateSpriteDetails(IDE.editingActor)}else{$("#win-editor .stage-properties").removeClass("hidden");
$("#win-editor .lockedactor-properties").addClass("hidden");$("#win-editor .actor-properties").addClass("hidden");WinProperties.updateLibraryDetails(IDE.editingActor)}},updateLibraryDetails:function(b){WinProperties.updateBackgroundDetails();$("#sprite-name span").text(g_loc.formatText("wincode.codeforlabel",b.label))},showLibrary:function(b){WinProperties.showBackground();$("#sprite-name span").text(g_loc.formatText("wincode.codeforlabel",b.label))},update:function(){if(IDE.editingActor==null){WinProperties.updateCostumes(Runtime.background);
WinProperties.updateSounds(Runtime.background);WinProperties.updateBackgroundDetails()}else if(IDE.editingActor.spriteObj){WinProperties.updateCostumes(IDE.editingActor);WinProperties.updateSounds(IDE.editingActor);WinProperties.updateSpriteDetails(IDE.editingActor);IDE.editingActor.locked&&WinProperties.updateInterfaces(IDE.editingActor)}else WinProperties.updateLibraryDetails(IDE.editingActor)},_updateCanvas:function(){var b=parseInt($("#bgfixed-width").val()),c=parseInt($("#bgfixed-height").val());
b<=100&&(b=600);c<=100&&(c=400);Runtime.stage.setSize(b,c);Runtime.background.filtersChanged=true;Runtime.background.updateCostume();IDE.adjustPanels();Runtime.stage.draw();return false},showBackground:function(){$("#win-properties").removeClass("tblock");$("#win-properties").hasClass("interfaces")&&WinProperties.displayTab("looks");$("#win-properties .prop-tabs .looks-tab span").text(g_loc.getText("button.tab_scenes"));$("#win-properties .tab-container.looks a.add").text(g_loc.getText("dialog.btnaddscene"));
$("#win-properties .stage").removeClass("hidden");$("#win-properties .actors").addClass("hidden");WinProperties.updateBackgroundDetails();WinProperties.updateCostumes(Runtime.background);WinProperties.updateSounds(Runtime.background);$("#win-editor .sprite-position").addClass("hidden");$("#win-editor").hasClass("docked")?$("#win-code .code canvas").css("top",0).attr("height",$("#win-code .code").innerHeight()):WinCode.adjustWindow();WinCode.draw();$("#win-editor a.reset").addClass("hidden");$("#win-properties .buttons a.unlock").addClass("hidden");
$("#win-properties .buttons a.clone").addClass("hidden");$("#win-properties .buttons a.save").addClass("hidden")},updateBackgroundDetails:function(){$("#win-properties .tab-container.advanced .stage h3").text("Properties for Stage");$("#bg-tilemap")[0].checked=Runtime.stage.tileLayer.isTilesEnabled();try{if(!$("#bg-tilemap-width").is(":focus")&&!$("#bg-tilemap-height").is(":focus")){$("#bg-tilemap-width").val(Runtime.stage.tileLayer.getWidth());$("#bg-tilemap-height").val(Runtime.stage.tileLayer.getHeight())}}catch(b){}$("#bg-scrollbg")[0].checked=
Runtime.stage.tileLayer.scrollBgOffset;$("#bg-physics")[0].checked=Physics.isSimulationRunning();var c=$("#win-properties .stage input[type=radio]");if(Runtime.stage.bgtype=="stretch"){c[0].checked=false;c[1].checked=true;c[2].checked=false}else if(Runtime.stage.bgtype=="tile"){c[0].checked=false;c[1].checked=false;c[2].checked=true}else{c[0].checked=true;c[1].checked=false;c[2].checked=false}try{if(!$("#bgfixed-width").is(":focus")&&!$("#bgfixed-height").is(":focus")){$("#bgfixed-width").attr("disabled",
null).val(Runtime.stage.width);$("#bgfixed-height").attr("disabled",null).val(Runtime.stage.height);IDE.adjustPanels()}$("#bgexpand")[0].checked=Runtime.stage.expand;var d=$("#project-name");d.is(":focus")||d.val(IDE.currentProjectName?IDE.currentProjectName:IDE.defaultProjectName);d=$("#win-properties .tab-container.advanced .stage textarea");d.is(":focus")||d.val(IDE.currentProjectDescription?IDE.currentProjectDescription:g_loc.getText("dialog.defaultprojdesc"));d=$("#bg-gravity-x");d.is(":focus")||
d.val(Physics.getGravity().x);d=$("#bg-gravity-y");d.is(":focus")||d.val(Physics.getGravity().y)}catch(e){}WinProperties.updateCostumeSelection(Runtime.background)},updateCostumeSelection:function(b){var c=$("#win-properties .tab-container.looks ul li"),b=b.currentCostume-1;if(b>=0&&b<c.length){c.removeClass("selected");$(c[b]).addClass("selected")}},showSprite:function(b){if(b.locked){$("#win-properties").addClass("tblock");WinProperties.displayTab("interfaces")}else{$("#win-properties").removeClass("tblock");
$("#win-properties").hasClass("interfaces")&&WinProperties.displayTab("looks")}$("#win-properties .prop-tabs .looks-tab span").text(g_loc.getText("button.tab_costumes"));$("#win-properties .tab-container.looks a.add").text(g_loc.getText("dialog.btnaddcostume"));$("#win-properties .stage").addClass("hidden");$("#win-properties .actors").removeClass("hidden");WinProperties.updateCostumes(b);WinProperties.updateSounds(b);WinProperties.updateSpriteDetails(b);IDE.editingActor.locked&&WinProperties.updateInterfaces(b);
$("#win-editor .sprite-position").removeClass("hidden");$("#win-editor").hasClass("docked")&&$("#win-code .code canvas").css("top",0).attr("height",$("#win-code .code").innerHeight());WinCode.adjustWindow();WinCode.draw();$("#win-editor a.reset").removeClass("hidden");if(b.locked){if(WinProperties.enableUnlock){$("#win-properties .buttons a.unlock").removeClass("hidden");$("#win-properties .buttons a.clone").removeClass("hidden")}else{$("#win-properties .buttons a.unlock").addClass("hidden");$("#win-properties .buttons a.clone").addClass("hidden")}$("#win-properties .buttons a.save").addClass("hidden")}else{$("#win-properties .buttons a.unlock").addClass("hidden");
if(WinProperties.enableUnlock){$("#win-properties .buttons a.clone").removeClass("hidden");$("#win-properties .buttons a.save").removeClass("hidden")}else{$("#win-properties .buttons a.clone").addClass("hidden");$("#win-properties .buttons a.save").addClass("hidden")}}},updateSpriteDetails:function(b){b&&b!=Runtime.stage?$("#win-properties .tab-container.advanced .actors h3 span:first").text("Properties for "+b.label):$("#win-properties .tab-container.advanced .actors h3 span:first").text("Properties for Stage");
$(".sprite-rotate").each(function(c,d){var e=$(d).find("input");e[0].checked=b.spriteObj.rotateLock==0;e[1].checked=b.spriteObj.rotateLock==1;e[2].checked=b.spriteObj.rotateLock==2});$("input.sprite-dragging").each(function(c,d){d.checked=b.spriteObj.draggable});b.getCostumeByName(b.currentCostume);if(b.id&&b.classname)for(var c=0,d=0;d<Runtime.sprites.length;d++){var e=Runtime.sprites[d];e.id==b.id&&e.classname==b.classname&&c++}$("#sprite-name span").text(b.label);$("#sprite-x span").text(Math.round((b.spriteObj.x-
Runtime.stage.getWidth()/2)*10)/10);$("#sprite-y span").text(Math.round((Runtime.stage.getHeight()/2-b.spriteObj.y)*10)/10);d=Math.floor(b.spriteObj.rotation);c=$("#sprite-angle").parent().find("em");c.css("-webkit-transform","rotate("+d+"deg)");c.css("-moz-transform","rotate("+d+"deg)");c.css("-ms-transform","rotate("+d+"deg)");c=(d+90)%360;c>180&&(c=c-360);$("#sprite-angle span").text(c);$("#sprite-scale span").text(Math.round(b.spriteObj.scale.x*1E3)/10);$("#sprite-layer span").text(b.spriteObj.zIndex);
d=Physics.getSpriteProperties(b.spriteObj);c=$("#sprite-density");c.is(":focus")||c.val(d.density);c=$("#sprite-friction");c.is(":focus")||c.val(d.friction);c=$("#sprite-restitution");c.is(":focus")||c.val(d.restitution);c=$("#sprite-geometry input");if(d.geometry=="circular"){c[0].checked=true;c[1].checked=false}else{c[0].checked=false;c[1].checked=true}$("#sprite-static")[0].checked=d.isStatic;$("#sprite-active")[0].checked=d.isActive;WinProperties.updateCostumeSelection(b)},updateCostumes:function(b){b&&
b!=Runtime.stage?$("#win-properties .tab-container.looks h3").text("Costumes for "+b.label):$("#win-properties .tab-container.looks h3").text("Costumes for Stage");var c=$("#win-properties .looks ul");c.empty();$("#win-properties .tab-container.looks .avatar").addClass("hidden");var d;IDE.editingActor&&IDE.editingActor.avatarid&&(d=RegExp(/avatar:\/\/([0-9a-zA-Z]+)\/([0-9a-zA-Z ]+)\/([0-9]+)/));b.skeleton.skeletonData&&$("#win-properties .tab-container.looks .avatar").removeClass("hidden");$.each(b.costumes,
function(e,f){if(!f.hidden){if(f.imgObj){var g=$('<li class="costume"><div class="img"></div><div class="costume-details"><div><span><input type="text"/></div> <a class="icon-brush edit"></a> <a class="icon-copy-2-2 copy"></a></span></div><a href="#" class="button delete icon-cancel-2"></a></li>');if(f.imgPreview){var h=new Image;h.src=f.imgPreview;g.find(".img").append(h);g.find(".costume-details").css("visibility","hidden");g.find("a.delete").detach();g.find("a.edit").detach();g.find("a.copy").detach()}else{g.find(".img").append($(f.imgObj).clone());
h=f.img;if(d)if((h=d.exec(h))&&h.length==4){avatarid=h[1];IDE.editingActor.avatarid=avatarid;g.find("a.edit").detach();g.find("a.copy").detach()}}}else if((h=f.img)&&h.substring(0,9)!="avatar://"&&h.substring(0,8)!="block://")g=$('<li class="costume"><div class="img"><img src="'+h+'"/></div><div class="costume-details"><div><span><input type="text"/></span></div><a class="icon-brush edit"></a> <a class="icon-copy-2-2 copy"></a></span></div><a href="#" class="button delete icon-cancel-2"></a></li>');
else{g=$('<li class="costume"><div class="img"><img src="ide/imgs/blank.png"/></div><div class="costume-details"><div><span><input type="text"/></span></div><a class="icon-brush edit"></a> <a class="icon-copy-2-2 copy"></a></span></div><a href="#" class="button delete icon-cancel-2"></a></li>');if(d)if((h=d.exec(h))&&h.length==4){avatarid=h[1];IDE.editingActor.avatarid=avatarid;g.find("a.edit").detach();g.find("a.copy").detach()}}if(b.skeleton.skeletonData&&f.imgPreview){$("#win-properties .tab-container.looks .avatar").removeClass("hidden");
$.each(b.skeleton.skeletonData.animations,function(d,e){var g=$('<li class="animation"><div class="img"><img src="ide/imgs/blank.png"/></div><div class="costume-details"><div>Preview: <em>'+e.name+"</em></div></li>");g.find("img")[0].src=f.imgPreview;c.append(g);g.click(function(){b.setCostumeByName(1);$("#win-properties .tab-container.looks li").removeClass("selected");$(this).addClass("selected");b.addAnimation({animation:"costume",name:"",startTime:0,timeout:e.duration*1E3,fps:30,costumePrefix:e.name,
numCostumes:-1,lastFrame:0,easing:Easing.easeLinear});window.requestAnimFrame(Runtime.runner);return false})})}else{c.append(g);g.data("costume",f)}b.currentCostume-1==e&&g.addClass("selected");h=g.find("input");f.imgPreview||g.click(function(){IDE.dirty();var c=$(this).find("input").val();b.setCostumeByName(c);$("#win-properties .tab-container.looks li").removeClass("selected");$(this).addClass("selected");return false});$(h[0]).val(f.name);$(h[0]).blur(function(){IDE.dirty();for(var c=$(this).val(),
d=false,e=0;e<b.costumes[e];e++)if(b.costumes[e].name==c){d=true;break}d?$(this).val(f.name):f.name=$(this).val()}).keypress(function(b){b.which==13&&$(this)[0].blur()});g.find("a.edit").click(function(){var b=$(this).parent().parent(),c=$(this).parent().parent().data("costume"),d=c.imgObj?c.imgObj.origSrc?c.imgObj.origSrc:c.imgObj.src:c.img,e=IDE.editingActor?g_loc.formatText("title.paint_edit_costume",IDE.editingActor.label):g_loc.getText("title.paint_edit_bg");window.WinPaint&&WinPaint.edit(e,
d,c.cx,c.cy,function(d,e,f){IDE.dirty();var g;g=IDE.editingActor!=null?IDE.editingActor:Runtime.background;c.img=d;c.cx=e;c.cy=f;generateImageFromUrl(c.img,function(d){c.imgObj=d;g&&g!=Runtime.background?g.spriteObj.setSpriteImg(c.imgObj,e,f):Runtime.stage.setBackgroundImg(d);b.find("img").attr("src",$(d).attr("src"))})});$.modal.close();return false});g.find("a.copy").click(function(){IDE.dirty();$(this).parent().parent();var b=$(this).parent().parent().data("costume"),c=b.img;if(IDE.editingActor==
null){b=Runtime.background.addCostume({img:c,cx:b.cx,cy:b.cy});Runtime.background.setCostumeByName(b.name);WinProperties.updateCostumes(Runtime.background)}else{var d=IDE.editingActor,b=d.addCostume({img:c,cx:b.cx,cy:b.cy});d.setCostumeByName(b.name);WinProperties.updateCostumes(d)}});g.find("a.delete").click(function(){var c=$(this).parent().find("input").val();(b==Runtime.background||b.costumes.length>1)&&IDE.confirmDialog(g_loc.formatText("winproperties.confirmdeletecostume",c),function(){IDE.dirty();
var d=b.getCostumeByName(c);b.deleteCostumeByName(c);WinProperties.updateCostumes(b);IDE.Clipboard.undoDeleteCostume(b,d[1],d[0])});return false})}});c.sortable({items:"li.costume",stop:function(){IDE.dirty();b.costumes=b.skeleton.skeletonData?[b.costumes[0]]:[];$("#win-properties .tab-container.looks li.costume").each(function(c,d){var g=$(d).data("costume");b.costumes.push(g)});b.currentCostume=b.currentCostume+1;b.setCostumeByName(b.currentCostume-1)}});b!=Runtime.background&&b.costumes.length<=
1&&$("#win-properties .tab-container.looks li a.delete").detach()},updateSounds:function(b){b&&b!=Runtime.stage?$("#win-properties .tab-container.sounds h3").text("Sounds for "+b.label):$("#win-properties .tab-container.sounds h3").text("Sounds for Stage");var c=$("#win-properties .tab-container.sounds ul");c.empty().sortable({stop:function(){IDE.dirty();b.sounds=[];$("#win-properties .tab-container.sounds li").each(function(c,e){var f=$(e).data("sound");b.sounds.push(f)})}});$.each(b.sounds,function(d,
e){if(!e.hidden){var f=$('<li><span class="icon-volume-high"></span><div class="sound-details"><input type="text"/> <a class="buttons play icon-play-2" href="#"></a><a href="#" class="buttons stop icon-stop"></div></a> <a href="#" class="button delete icon-cancel-2"></a></li>');c.append(f);f.data("sound",e);var g=f.find("input")[0];$(g).val(e.name);$(g).blur(function(){IDE.dirty();for(var c=$(this).val(),d=false,f=0;f<b.sounds[f];f++)if(b.sounds[f].name==c){d=true;break}d?$(this).val(e.name):e.name=
$(this).val()}).keypress(function(b){b.which==13&&$(this)[0].blur()});g=f.find("a.buttons");f.find("a.play").click(function(){if(!e.soundObj)e.soundObj=soundManager.createSound({id:"s"+Math.random(),url:e.sound});e.soundObj&&e.soundObj.play();return false});f.find("a.stop").click(function(){e.soundObj.stop();return false});f.find("a.delete").click(function(){var c=$(this).parent().find("input").val();IDE.confirmDialog(g_loc.formatText("winproperties.confirmdeletesound",c),function(){IDE.dirty();var d=
b.getSoundByName(c);b.deleteSoundByName(c);WinProperties.updateSounds(b);IDE.Clipboard.undoDeleteSound(b,d[1],d[0])});return false});f.click(function(){IDE.dirty();$("#win-properties .tab-container.sounds li").removeClass("selected");$(this).addClass("selected");return false})}})},updateInterfaces:function(b){WinProperties.makeInterfacesFor(b);$("#win-properties .tab-container.interfaces .inbound h3").text(g_loc.formatText("interfaces.receive",b.label));$("#win-properties .tab-container.interfaces .inbound p").html(g_loc.formatText("interfaces.receivehelp",
b.label));$("#win-properties .tab-container.interfaces .outbound h3").text(g_loc.formatText("interfaces.send",b.label));b.documentation.description?$("#win-properties .tab-container.interfaces .description p").text(b.documentation.description).parent().removeClass("hidden"):$("#win-properties .tab-container.interfaces .description").addClass("hidden");var c=b.documentation.inboundEvents,d=$("#win-properties .tab-container.interfaces .inbound ul");d.empty();for(var e=0,f=null,g=0;g<c.length;g++)if(c[g].visible===
void 0||c[g].visible){e++;var h=$("<li><p>"+c[g].description+"</p><span></span></li>");d.append(h);if(c[g].name.charAt(0)=="["){var f=c[g].name.substring(1,c[g].name.length-1),j=f.indexOf("|"),k;if(j>0){k=f.substring(j+1);f=f.substring(0,j)}if(j=findStepByFunc(f)){l=new Block(j);if(k){l.label.setValue(0,k);h.attr("param",k)}h.attr("func",f)}}else{l=new Block({cat:"flow",label:"when I receive {events}",hasFlap:false,func:"registerBroadcastTrigger"});l.label.setValue(0,c[g].name);h.attr("func","registerBroadcastTrigger");
h.attr("param",c[g].name)}(f=l.getImage())&&h.find("span").append(f);h.css("cursor","pointer").mouseenter(function(){$(this).find("p").addClass("selected")}).mouseleave(function(){$(this).find("p").removeClass("selected")}).click(function(){$(this).parent().find("li p").removeClass("playing");$(this).find("p").addClass("playing");var b=$(this).attr("func"),c=$(this).attr("param");b=="registerFlagTrigger"?Runtime.triggerFlag(IDE.editingActor):b=="registerSpriteTrigger"?Runtime.spriteClicked(IDE.editingActor):
b=="registerKeyTrigger"?Runtime.triggerKeyDown(c):b=="registerBroadcastTrigger"&&Runtime.sendEvent(c,IDE.editingActor.label,"hello");WinStage.showStarted()})}e<=0?d.parent().addClass("hidden"):d.parent().removeClass("hidden");c=b.documentation.outboundEvents;d=$("#win-properties .tab-container.interfaces .outbound ul");d.empty();e=0;f=null;for(g=0;g<c.length;g++)if(c[g].visible===void 0||c[g].visible){e++;h=$("<li><p>"+c[g].description+"</p><span></span></li>");d.append(h);var l=new Block({cat:"flow",
label:"broadcast {events}",func:"blockControlBroadcast"});l.label.setValue(0,c[g].name);(f=l.getImage())&&h.find("span").append(f)}e<=0?d.parent().addClass("hidden"):d.parent().removeClass("hidden");l=b.documentation.properties;d=$("#win-properties .tab-container.interfaces .objprops ul");d.empty();e=0;f=null;for(g=0;g<l.length;g++)if(l[g].visible===void 0||l[g].visible){e++;h=$("<li><em>"+l[g].name+"</em><span>"+(l[g].description?l[g].description:"&nbsp;")+'</span><span><input name="'+l[g].name+
'" type="text"/></span></li>');h.attr("name",l[g].name);d.append(h);if(b.varDefaults&&b.varDefaults[l[g].name]!==void 0)var m=b.varDefaults[l[g].name];b.variables&&b.variables[l[g].name]!==void 0&&(m=b.variables[l[g].name]);h.find("input").val(m).blur(function(){IDE.dirty();var c=$(this).val();if(c=="true")c=true;else if(c=="false")c=false;else{var d=""+c,c=parseFloat(c);""+c!=d&&(c=d)}b.variables[$(this).attr("name")]=c;b.locked||(b.varDefaults[$(this).attr("name")]=c)}).keydown(function(b){if(b.keyCode==
13){$(".choice-chooser").detach();$(this)[0].blur()}else if(b.keyCode==9){$(".choice-chooser").detach();$(this)[0].blur()}}).click(function(){var b=$(this).val(),c=[];if(parseFloat(b)==""+b)return false;if(b=="true"||b=="false"){c.push("true");c.push("false")}else{c.push("mouse-pointer");for(b=0;b<Runtime.sprites.length;b++)c.push(Runtime.sprites[b].label)}var d=$('<div class="choice-chooser"><ul></ul></div>');d.css("left",$(this).offset().left).css("top",$(this).offset().top+$(this).outerHeight()+
4).css("z-index","30000").mouseleave(function(){$(".choice-chooser").detach()});$("body").append(d);for(var d=d.find("ul"),e=this,b=0;b<c.length;b++){var f=$("<li>"+c[b]+"</li>");d.append(f);f.click(function(){$(e)[0].focus();$(e).val($(this).text());$(e)[0].blur();$(".choice-chooser").detach()})}d=$(".choice-chooser");d.offset().top+d.outerHeight()>window.innerHeight&&d.css("top",$(this).offset().top-4-d.outerHeight())})}e<=0?d.parent().addClass("hidden"):d.parent().removeClass("hidden")},makeInterfacesFor:function(b){var c;
if(b==null){c="stage";b=Runtime.background}else c=b.label;var d=Runtime.findInboundEventsOf(c),e=Runtime.findOutboundEventsOf(c);c=Runtime.findVariablesOf(c);if(!b.documentation)b.documentation={description:"",inboundEvents:[],outboundEvents:[],properties:[]};b=b.documentation;if(!b.inboundEvents)b.inboundEvents=[];for(var f=0;f<b.inboundEvents.length;f++)d.indexOf(b.inboundEvents[f].name)<0&&b.inboundEvents.splice(f,1);for(f=0;f<d.length;f++){for(var g=false,h=0;h<b.inboundEvents.length;h++)if(d[f]==
b.inboundEvents[h].name){g=true;break}g||b.inboundEvents.push({name:d[f],description:"",visible:true})}if(!b.outboundEvents)b.outboundEvents=[];for(f=0;f<b.outboundEvents.length;f++)e.indexOf(b.outboundEvents[f].name)<0&&b.outboundEvents.splice(f,1);for(f=0;f<e.length;f++){g=false;for(h=0;h<b.outboundEvents.length;h++)if(e[f]==b.outboundEvents[h].name){g=true;break}g||b.outboundEvents.push({name:e[f],description:"",visible:true})}if(!b.properties)b.properties=[];for(f=0;f<b.properties.length;f++)c.indexOf(b.properties[f].name)<
0&&b.properties.splice(f,1);for(f=0;f<c.length;f++){g=false;for(h=0;h<b.properties.length;h++)if(c[f]==b.properties[h].name){g=true;break}g||b.properties.push({name:c[f],description:"",visible:true})}},showInterfacesFor:function(b){if(b==null)b=Runtime.background;if(b.locked){WinProperties.makeInterfacesFor(b);var c=b.documentation.inboundEvents,d=b.documentation.outboundEvents,e=b.documentation.properties;$("#win-properties .tab-container.notes .description textarea").detach();$("#win-properties .tab-container.notes .description").append("<textarea></textarea>");
$("#win-properties .tab-container.notes .description textarea").val(b.documentation.description).blur(function(){IDE.dirty();b.documentation.description=$(this).val()}).keypress(function(b){b.which==13&&$(this).blur()});if(c.length==0)$("#win-properties .tab-container.notes .inbound").addClass("hidden");else{var f=$("#win-properties .tab-container.notes .inbound").removeClass("hidden").find("ul");f.empty();for(var g=0;g<c.length;g++){var h=$('<li><p><input class="description" idx="'+g+'" type="text"/></p><span></span></li>');
f.append(h);var j;if(c[g].name.charAt(0)=="["){var k=c[g].name.substring(1,c[g].name.length-1),l=k.indexOf("|"),m;if(l>0){m=k.substring(l+1);k=k.substring(0,l)}if(k=findStepByFunc(k)){j=new Block(k);m&&j.label.setValue(0,m)}}else{j=new Block({cat:"flow",label:"when I receive {events}",hasFlap:false,func:"registerBroadcastTrigger"});j.label.setValue(0,c[g].name)}if(j){h.find("span").append(j.getImage());h.find("input").val(c[g].description).blur(function(){IDE.dirty();c[parseInt($(this).attr("idx"))].description=
$(this).val()}).keypress(function(b){b.which==13&&$(this).blur()})}}}if(d.length==0)$("#win-properties .tab-container.notes .outbound").addClass("hidden");else{f=$("#win-properties .tab-container.notes .outbound").removeClass("hidden").find("ul");f.empty();for(g=0;g<d.length;g++){h=$('<li><span></span><input class="description" idx="'+g+'" type="text"/></li>');f.append(h);j=new Block({cat:"flow",label:"broadcast {events}",func:"blockControlBroadcast"});j.label.setValue(0,d[g].name);h.find("span").append(j.getImage());
h.find("input").val(d[g].description).blur(function(){IDE.dirty();d[parseInt($(this).attr("idx"))].description=$(this).val()}).keypress(function(b){b.which==13&&$(this).blur()})}}if(e.length==0)$("#win-properties .tab-container.notes .objprops").addClass("hidden");else{f=$("#win-properties .tab-container.notes .objprops").removeClass("hidden").find("ul");f.empty();for(g=0;g<e.length;g++){h=$('<li><span></span><input class="smalldescription" idx="'+g+'" type="text"/> = <input class="default" idx="'+
g+'" type="text"/></li>');f.append(h);j=new Label({cat:"var",label:e[g].name});h.find("span").append(j.getImage());h.find("input.smalldescription").val(e[g].description).blur(function(){IDE.dirty();e[parseInt($(this).attr("idx"))].description=$(this).val()}).keypress(function(b){b.which==13&&$(this).blur()});h.find("input.default").val(b.variables[e[g].name]).blur(function(){IDE.dirty();var c=$(this).val();if(c=="true")c=true;else if(c=="false")c=false;else{var d=""+c,c=parseFloat(c);""+c!=d&&(c=
d)}b.variables[e[parseInt($(this).attr("idx"))].name]=c}).keypress(function(b){b.which==13&&$(this).blur()})}}}}},WinTools={hidden:!1,container:null,hideInlineHelp:!1,hideGeneralHelp:!1,maxWidth:0,maxHeight:0,maxImgWidth:80,maxImgHeight:80,_skipCodeSearch:!1,_objects:[],_helpTimeoutId:-1,_helpTimeout:5E3,_helpClicked:!1,_searchTimeout:0,tblockTab:new Image,_searchTimeoutId:0,_lastSearchTerm:"",enable:function(b){b?$("#win-code").addClass("hastools"):$("#win-code").removeClass("hastools");WinCode.adjustWindow();
WinTools.adjustWindow()},enableSearch:function(b){b?$("#win-tools .palette .tools-code").addClass("hassearch"):$("#win-tools .palette .tools-code").removeClass("hassearch")},enableCat:function(b){b?$("#win-tools .tools-code").addClass("hascat"):$("#win-tools .tools-code").removeClass("hascat")},init:function(){$("#win-tools").removeClass("hidden");WinTools.tblockTab.src="ide/imgs/tblock_tab.png";$("#win-tools .palette .blocks").bind("dragstart",function(){return false}).bind("click",WinTools._mouseClick);
$("#win-tools > .tools .tab.notes").click(function(){$("#win-tools").addClass("showannotations");return false});$("#win-tools > .tools .tab.blocks").click(function(){$("#win-tools").removeClass("showannotations");WinTools.adjustWindow();return false});$("#win-tools a.toolsshow").click(function(){$("#win-code").toggleClass("mintools");WinCode.adjustWindow();WinTools.adjustWindow();IDE.adjustPanels();return false});$("#win-tools .search input").focus(function(){if(!$(this).val()){WinCode._searchIndex=
-1;WinCode._searchTerm="";WinCode.clearSelection();FocusManager.clearFocus();$("#win-tools .palette .tools-code").removeClass("searchstatus");WinTools.adjustWindow()}}).click(function(){$(this).focus().select()}).keyup(function(b){window.clearTimeout(WinTools._searchTimeoutId);b.keyCode==13?WinTools.handleShowSearch(b):WinTools._searchTimeoutId=window.setTimeout(function(){WinTools.handleShowSearch(b)},1E3)});$("#win-tools .search .search-clear").click(function(){WinTools.hideSearch();return false});
$("#win-tools .searchshow a.prev").click(function(){WinCode._handlePreviousSearch();WinTools._updateSearchButtons();return false});$("#win-tools .searchshow a.next").click(function(){WinCode._handleNextSearch();WinTools._updateSearchButtons();return false});$("#win-tools .blocks").mousemove(WinTools._mouseMove);$("#win-tools .palette .blocks").bind("mouseleave",function(){$(".tooltip").detach();window.clearTimeout(WinTools._helpTimeoutId);WinTools._helpClicked||$("#win-tools .palette .blocks > div.selected").removeClass("selected")});
$("#win-tools .tabs .common").click(function(){$("#win-tools .tabs .tab").removeClass("active");$(this).addClass("active");$("#win-tools .categories").removeClass("hover");WinTools.showCategory("common");return false});$("#win-tools .tabs .category").click(function(){if($(this).hasClass("active"))$("#win-tools .categories").addClass("hover");else{$("#win-tools .tabs .tab").removeClass("active");$(this).addClass("active");$("#win-tools .categories").removeClass("hover");var b=$(this).attr("cat");b==
"variables"?WinTools.showVariables():b=="functions"?WinTools.showFunctions():WinTools.showCategory(b)}return false});$("#win-tools .tabs .pin").click(function(){$("#win-tools").toggleClass("pin").find(".categories").removeClass("hover");$("#win-tools").hasClass("pin")?setPreference("category-pin","on"):setPreference("category-pin","off");WinTools.adjustWindow();return false}).bind("mouseenter",function(){$("#win-tools .categories").addClass("hover");WinTools.adjustWindow()});$("#win-tools .categories").bind("mouseleave",
function(){$("#win-tools .categories").removeClass("hover");WinTools.adjustWindow()});WinTools.reset();WinTools.adjustWindow();WinCode.addChangeListener(WinTools.updateFunctions);$("#win-tools .tabs a.search").click(function(){$("#win-tools .tools-code").toggleClass("hassearch");WinTools.adjustWindow();return false})},minimize:function(b){if(b)$("#win-code").addClass("mintools");else{$("#win-code").removeClass("mintools");WinTools.reset();WinTools.adjustWindow()}},_handleBlockHelp:function(b,c){if(!window.RenderCode||
!RenderCode.isCode()){var d=$("#win-tools .palette .blocks"),e=null;if(c.note)e=[c.note];else if(c.func=="blockControlCall"||c.func=="valueControlCall"){var f=IDE.editingActor;if(!f)f=Runtime.background;for(var g=0;g<f.scripts.length;g++){var h=f.scripts[g];if(h.func=="registerFunction"&&h.name==c.name){e=[];WinTools._getFunctionDocs(e,h.next);e.length<=0&&(e=null);break}}}else if(c.func=="blockControlCallLibrary"||c.func=="valueControlCallLibrary"){g=c.name.split("::");if(g.length>1){var f=g[1],
g=g[0],j=Runtime.getLibraryByName(g);if(j)for(g=0;g<j.scripts.length;g++){h=j.scripts[g];if(h.func=="registerFunction"&&h.name==f){e=[];WinTools._getFunctionDocs(e,h.next);e.length<=0&&(e=null);break}}}}if(e){d.find(">div").removeClass("selected").find(".info").detach();b.remove("div.info");h=$('<div class="info"></div>');f=$('<div class="description"></div>');for(g=0;g<e.length;g++)f.append("<p>"+e[g]+"</p>");f.find("span.script q").each(function(){var b=$(this).text(),b=JSON.parse(b),b=ObjectIO.deserializeScriptStep(b);
$(this).css("display","none").parent().append(b.getImage())});h.append(f);b.append(h).addClass("selected")}else if(!IDE.isMC&&c.func=="valueVar"){d.find(">div").removeClass("selected").find(".info").detach();h=$('<div class="info"></div>');h.append('<span class="value">Value: '+propertyGet(c.labelText,IDE.editingActor?IDE.editingActor.label:"")+"</span>");if(!WinTools.hideGeneralHelp&&IDE.editingActor&&IDE.editingActor.classname!="watcher"){f=$('<div class="buttons"></div>');$addWatcher=$('<a href="#" class="btn-round micro action">Add Watcher</a>');
$addWatcher.click(function(){c.watchable=="global"?Runtime.addWatcher(null,c):Runtime.addWatcher(IDE.editingActor,c);return false});f.append($addWatcher);h.append(f);b.remove("div.info");f=$('<div class="description"></div>');h.append(f);b.append(h);b.addClass("selected")}}else $.ajax({url:"ide/help/blockhelp",data:{t:IDE.isMC?"minecraft":"",f:c.func,n:c.name?c.name:""},success:function(e){d.find(">div").removeClass("selected").find(".info").detach();var f=$('<div class="info"></div>'),g=null;if(c.watchable||
c.func=="valueVar"){f.append('<span class="value">Value: '+propertyGet(c.labelText,IDE.editingActor?IDE.editingActor.label:"")+"</span>");if(!WinTools.hideGeneralHelp&&IDE.editingActor&&IDE.editingActor.classname!="watcher"){var h=$('<div class="buttons"></div>'),g=$('<a href="#" class="btn-round micro action">Add Watcher</a>');g.click(function(){c.watchable=="global"?Runtime.addWatcher(null,c):Runtime.addWatcher(IDE.editingActor,c);return false});h.append(g);f.append(h)}}if(e!="error"){e=JSON.parse(e);
b.remove("div.info");h=$('<div class="description"></div>');h.append(e.answer);h.find("span.script q").each(function(){var b=$(this).text(),b=JSON.parse(b),b=ObjectIO.deserializeScriptStep(b);$(this).css("display","none").parent().append(b.getImage())});if(!WinTools.hideGeneralHelp){e=$('<a href="#" class="more">More in Help</a>');e.click(function(){Help.cmdHelp("@question "+c.func);f.parent().removeClass("selected");f.detach();return false});h.append(e)}f.append(h);b.append(f);b.addClass("selected")}else if(g){b.append(f);
b.addClass("selected")}}})}},_mouseMove:function(b){window.clearTimeout(WinTools._helpTimeoutId);var c=b.pageX,d=b.pageY;if($("#win-code").hasClass("hastools")&&!$("#win-tools").hasClass("hidden")){var e=$("#win-tools .palette .blocks");if(c>=e.offset().left&&c<=e.offset().left+e.outerWidth()&&d>=e.offset().top&&d<=e.offset().top+e.outerHeight()){var f=null;e.find(".draggable").each(function(b,e){var g=$(e),h=g.offset();if(c>=h.left&&c<h.left+g.outerWidth()&&d>=h.top&&d<h.top+g.outerHeight()){f=g;
return false}});if(f){var g=f.data("draggable");if(g.disabled){var h=true,e=$(".tooltip");if(e.length==0){e=$('<div class="tooltip">'+g_loc.getText("wintools.disabledtooltip")+"</div>");$("body").append(e)}e.css("top",b.pageY).css("left",b.pageX)}else if(g instanceof Label&&g.func=="valueVar"){h=true;e=$(".tooltip");if(e.length==0){e='<div class="tooltip">';if(g.isGlobal)var j=Runtime.background.varDefaults[g.name],e=Runtime.background.cloudVariables&&Runtime.background.cloudVariables[g.name]?typeof j==
"string"?e+('[Cloud] Default: "'+j+'" - '):typeof j=="number"?e+("[Cloud] Default: "+j+" - "):e+"[Cloud] ":typeof j=="string"?e+('[Global] Default: "'+j+'" - '):typeof j=="number"?e+("[Global] Default: "+j+" - "):e+"[Global] ";else if(IDE.editingActor){j=IDE.editingActor.varDefaults[g.name];e=typeof j=="string"?e+('[Local] Default: "'+j+'" - '):typeof j=="number"?e+("[Local] Default: "+j+" - "):e+"[Local] "}j=g.isGlobal?Runtime.background.variables[g.name]:IDE.editingActor.variables[g.name];typeof j==
"string"?e=e+('Current: "'+j+'"'):typeof j=="number"&&(e=e+("Current: "+j));e=$(e+"</div>");$("body").append(e)}e.css("top",b.pageY).css("left",b.pageX)}else if(!WinTools.hideInlineHelp)WinTools._helpTimeoutId=window.setTimeout(function(){WinTools._handleBlockHelp(f,g);WinTools._helpClicked=false},WinTools._helpTimeout);h||$(".tooltip").detach();$("#tools-code").css("cursor","pointer")}else $(".tooltip").detach()}else $(".tooltip").detach()}else $(".tooltip").detach()},reset:function(){WinTools.container=
$("#win-tools .categories ul");WinTools.container.empty();var b=null;g_palette.length<2?$("#win-tools .palette .tools-code").removeClass("hascat"):$("#win-tools .palette .tools-code").addClass("hascat");for(var c=0;c<g_palette.length;c++)if(!g_palette[c].hidden){var d=g_palette[c].cat,e=g_palette[c].label;b||(b=d);d=$('<li cat="'+d+'" class="'+d+'">'+e+"</li>");WinTools.container.append(d)}WinTools.container.find("li").click(WinTools.handleShowCategory);for(c=0;c<Runtime.sprites.length;c++)WinTools.trackActor(Runtime.sprites[c]);
for(c=0;c<Runtime.libs.length;c++)WinTools.trackLibrary(Runtime.libs[c]);WinTools.showCategory(b);WinTools.adjustWindow()},showCat:function(b,c){for(var d=false,e=0;e<g_palette.length;e++)if(g_palette[e].cat==b){g_palette[e].hidden=!c;d=true}d&&WinTools.reset()},adjustWindow:function(){var b=$(".tools-resize-handle").offset().top-$(".toolbar-top").outerHeight(),b=b-$("#win-annotation").position().top;b<0&&(b=0);if(!$("#win-media-sidebar").is(":visible")){$("#win-annotation .expanded").removeClass("hidden");
$("#win-annotation .collapsed").addClass("hidden")}b>window.innerHeight-$(".toolbar-top").outerHeight()-8&&(b=window.innerHeight-$(".toolbar-top").outerHeight()-8);$("#win-annotation").parents("#win-tools").length>0&&$("#win-annotation").css("height",b);b=b+$("#win-annotation").position().top;$("#win-tools .palette").css("top",b);$("#win-annotation").hasClass("editmode")?$(".deletemask").css("top",b):$(".deletemask").css("top","");b=$("#win-tools .palette div.categories:visible").outerHeight();b=
b+$("#win-tools .palette div.search:visible").outerHeight();b=b+$("#win-tools .palette div.searchshow:visible").outerHeight();$("#win-tools .palette .blocks").css("top",b)},show:function(){},hide:function(){},trackLibrary:function(b){var c;c=$('<li class="library" cat="library" library="'+b.classname+'">'+b.label+"</li>");c.data("library",b);WinTools.container.find("hr").length==0&&WinTools.container.append("<hr/>");WinTools.container.append(c);c.click(WinTools.handleShowLibrary)},trackActor:function(b){if(b!=
Runtime.background&&b.locked){var c=false;WinTools.container.find("li.actor").each(function(d,f){if($(f).data("sprite")==b){$(f).attr("cat",b.label);$(f).find("img").attr("alt",b.classname?b.classname:b.label).attr("title",b.classname?b.classname:b.label);WinTools.showActor(null);c=true;return false}if(b.classname&&$(f).attr("classname")==b.classname){c=true;return false}});if(!c){var d=b.costumes[0].img,d=b.classname?$('<li class="actor" cat="'+b.label+'" classname="'+b.classname+'"><img src="'+
d+'" alt="'+b.classname+'" title="'+b.classname+'"/>'+b.classname+"</li>"):$('<li class="actor" cat="'+b.label+'"><img src="'+d+'" alt="'+b.label+'" title="'+b.label+'"/>'+b.label+"</li>");d.data("sprite",b);WinTools.container.find("hr").length==0&&WinTools.container.append("<hr/>");WinTools.container.append(d);d.click(WinTools.handleShowActor)}}},unregisterActor:function(b){if(b.classname)for(var c=0;c<Runtime.sprites.length;c++)if(Runtime.sprites[c].classname==b.classname)return;WinTools.container.find("li.actor").each(function(c,
e){if(b.classname&&$(e).attr("classname")==b.classname||$(e).find("img").attr("title")==b.label){$(e).detach();WinTools.container.find("hr").next().length==0&&WinTools.container.find("hr").detach();return false}})},showSearch:function(){$("#win-tools .search input").focus().val("");WinCode._searchIndex=-1;WinCode._searchTerm="";WinCode.clearSelection();FocusManager.clearFocus();$("#win-tools .palette .tools-code").removeClass("searchstatus")},hideSearch:function(){$("#win-tools .search input").val("").blur();
$("#win-tools .palette .tools-code").addClass("hascat").removeClass("searchstatus");WinTools.showCategory("common");WinTools.adjustWindow();WinTools._lastSearchTerm=""},_updateSearchButtons:function(){WinCode._hasPreviousSearch()?$("#win-tools .searchshow a.prev").removeClass("disabled"):$("#win-tools .searchshow a.prev").addClass("disabled");WinCode._hasNextSearch()?$("#win-tools .searchshow a.next").removeClass("disabled"):$("#win-tools .searchshow a.next").addClass("disabled");var b=WinCode._getSearchIndex(),
c=WinCode._getTotalCount();b>=0&&c>0?$("#win-tools .searchshow .index").text(b+1+" / "+c):$("#win-tools .searchshow .index").text("")},handleShowSearch:function(b){var c=$("#win-tools .search input").val().toLowerCase(),c=$.trim(c);if(!WinTools._skipCodeSearch&&c==WinTools._lastSearchTerm&&(b.keyCode==13||(b.metaKey||b.ctrlKey)&&b.which==70)){WinCode._handleNextSearch();WinTools._updateSearchButtons()}else if(b.keyCode==27)WinTools.hideSearch();else{WinTools._lastSearchTerm=c;$("#win-code").removeClass("mintools");
$("#win-tools .categories li").removeClass("selected");if(c){$("#win-tools .tools-code").removeClass("hascat").addClass("searchstatus");WinCode._searchIndex=-1;WinCode._searchTerm=c;WinCode.clearSelection();FocusManager.clearFocus();if(!WinTools._skipCodeSearch){b=WinCode.countSearch(c);b==1?$("#win-tools .palette .tools-code").addClass("searchstatus").find(".searchshow .count").text(g_loc.formatText("wintools.blocksused",b)):b>0?$("#win-tools .palette .tools-code").addClass("searchstatus").find(".searchshow .count").text(g_loc.formatText("wintools.blocksusedplural",
b)):$("#win-tools .palette .tools-code").removeClass("searchstatus")}WinTools._updateSearchButtons();WinTools.adjustWindow();b=RegExp(/{([a-zA-Z0-9 ]+):?([-a-zA-Z0-9#_./!? ]+)?}/g);$("#win-tools .blocks").scrollTop(0);var d=$("#win-tools .palette .blocks");d.empty();if("variables".indexOf(c)>=0){for(var e in Runtime.background.variables){var f=new Label({cat:"var",watchable:"global",name:e,value:"string",func:"valueVar"});f.isGlobal=true;var g=$('<div class="draggable"></div>');g.data("draggable",
f);d.append(g)}if(IDE.editingActor)for(e in IDE.editingActor.variables){f=new Label({cat:"var",watchable:"local",name:e,value:"string",func:"valueVar"});f.isGlobal=false;g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}for(e in Runtime.background.lists){f=new Label({cat:"list",watchable:null,name:e,value:"string",func:"valueList"});f.isGlobal=true;g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}if(IDE.editingActor)for(e in IDE.editingActor.lists){f=new Label({cat:"list",
watchable:null,name:e,value:"string",func:"valueList"});f.isGlobal=false;g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}}else{for(e in Runtime.background.variables)if(e.indexOf(c)>=0){f=new Label({cat:"var",watchable:"global",name:e,value:"string",func:"valueVar"});g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}if(IDE.editingActor)for(e in IDE.editingActor.variables)if(e.indexOf(c)>=0){f=new Label({cat:"var",watchable:"local",name:e,value:"string",func:"valueVar"});
g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}for(e in Runtime.background.lists)if(e.indexOf(c)>=0){f=new Label({cat:"list",watchable:null,name:e,value:"string",func:"valueList"});g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}if(IDE.editingActor)for(e in IDE.editingActor.lists)if(e.indexOf(c)>=0){f=new Label({cat:"list",watchable:null,name:e,value:"string",func:"valueList"});g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}}var h;
h=IDE.editingActor?IDE.editingActor.scripts:Runtime.background.scripts;for(var j=0;j<h.length;j++)if(h[j].func=="registerFunction"){f=h[j].name;if("functions".indexOf(c)===0||f.toLowerCase().replace(b,"").indexOf(c)>=0){for(var g=h[j].label._children,k=0;k<g.length;k++)g[k]instanceof LabelInput&&(f=f+(" {string:"+g[k].defaultLabel+"}"));f=new Block({cat:"functions",name:h[j].name,label:f,func:"blockControlCall"});g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}}for(j=0;j<Runtime.libs.length;j++){var l=
Runtime.libs[j];h=l.scripts;for(k=0;k<h.length;k++)if(h[k].func=="registerFunction"){f=h[k].name;if("library".indexOf(c)===0||f.toLowerCase().replace(b,"").indexOf(c)>=0){for(var g=h[k].label._children,m=0;m<g.length;m++)g[m]instanceof LabelInput&&(f=f+(" {string:"+g[m].defaultLabel+"}"));f=new Block({cat:"library",name:l.classname+"::"+h[k].name,label:f,func:"blockControlCallLibrary"});g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}}}h=[];for(e in g_steps){k=g_steps[e];if(!k.hidden&&
k.label){l=false;if(k.tags){for(j=0;j<k.tags.length;j++)if(k.tags[j].indexOf(c)>=0){l=true;break}if(l){h.push(k.func);f=k.value?new Label(k):new Block(k);if(k.hidden||!(WinTools._showingToolsFor&&k.omitActor||!WinTools._showingToolsFor&&k.omitbg)){g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}}}}}for(e in g_steps){k=g_steps[e];if(h.indexOf(k.func)<0&&!k.hidden&&k.label){f=k.label.toLowerCase().replace(b,"");j=f.indexOf(c);if(j===0&&f.length==c.length||j>0&&j+c.length<f.length&&
f[j-1]==" "||j===0&&j+c.length+1<f.length&&f[j+c.length+1]==" "){h.push(k.func);f=k.value?new Label(k):new Block(k);if(k.hidden||!(WinTools._showingToolsFor&&k.omitActor||!WinTools._showingToolsFor&&k.omitbg)){g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}}}}for(e in g_steps){k=g_steps[e];if(h.indexOf(k.func)<0&&!k.hidden&&k.label){l=false;f=k.label.toLowerCase().replace(b,"");f.indexOf(c)>=0?l=true:k.cat.indexOf(c)===0?l=true:k.concept&&k.concept.indexOf(c)===0&&(l=true);
if(l){h.push(k.func);f=k.value?new Label(k):new Block(k);if(k.hidden||!(WinTools._showingToolsFor&&k.omitActor||!WinTools._showingToolsFor&&k.omitbg)){g=$('<div class="draggable"></div>');g.data("draggable",f);d.append(g)}}}}WinTools.render()}else{$("#win-tools .tools-code").addClass("hascat").removeClass("searchstatus");WinTools.showCategory();WinTools.adjustWindow()}}},handleShowCategory:function(){var b=$(this).attr("cat"),c=$(this).text();if(b=="common"){$("#win-tools .tabs .tab").removeClass("active");
$("#win-tools .tabs .tab.common").addClass("active")}else{$("#win-tools .tabs .tab").removeClass("active");$("#win-tools .tabs .tab.category").addClass("active").find("span.label").text(c)}$("#win-tools .categories").removeClass("hover");$("#win-tools .tabs .category").attr("cat",b);b=="variables"?WinTools.showVariables():b=="functions"?WinTools.showFunctions():WinTools.showCategory(b);return false},handleShowActor:function(){var b=$(this).attr("cat");$("#win-tools .categories li").removeClass("selected").each(function(c,
d){d=$(d);if(d.attr("cat")==b){d.addClass("selected");return false}});WinTools.showActor(b)},showActor:function(b){var c=false;$("#win-tools .categories li.actor").each(function(d,e){if($(e).hasClass("selected")){b=$(e).attr("cat");c=true;return false}});if(c&&Sprites.getSpriteByName(b)){$("#win-tools .blocks").scrollTop(0);var d=$("#win-tools .palette .blocks");d.empty();for(var e=Runtime.findInboundEventsOf(b),f=0;f<e.length;f++)if(e[f].charAt(0)!="["){var g=new Block({cat:"events",label:"send message {events:"+
e[f]+"} to {actor:self} with {string}",func:"blockControlPostMessage"}),h=$('<div class="draggable"></div>');h.data("draggable",g);d.append(h);g=new Block({cat:"events",label:"send message {events:"+e[f]+"} to {actor:self} with {string} and wait",func:"blockControlPostMessageAndWait"});h=$('<div class="draggable"></div>');h.data("draggable",g);d.append(h)}e=Runtime.findOutboundEventsOf(b);for(f=0;f<e.length;f++){g=new Block({cat:"events",label:"when I receive {events:"+e[f]+"}",hasFlap:false,func:"registerBroadcastTrigger"});
h=$('<div class="draggable"></div>');h.data("draggable",g);d.append(h)}e=Runtime.findVariablesOf(b);for(f=0;f<e.length;f++){g=new Block({cat:"var",label:"set {properties:"+e[f]+"} of {actor:self} to {string:0}",func:"blockVarPropSet"});h=$('<div class="draggable"></div>');h.data("draggable",g);d.append(h);g=new Label({cat:"var",label:"property {properties:"+e[f]+"} of {actor:self}",value:"string",func:"valueVarPropGet"});h=$('<div class="draggable"></div>');h.data("draggable",g);d.append(h)}WinTools.render()}},
handleShowLibrary:function(){var b=$(this).attr("library");$("#win-tools .categories li").removeClass("selected");$(this).addClass("selected");WinTools.showLibrary(b)},showLibrary:function(b){for(var c=null,d=0;d<Runtime.libs.length;d++)if(Runtime.libs[d].classname==b){c=Runtime.libs[d];break}if(c){$("#win-tools .blocks").scrollTop(0);b=$("#win-tools .palette .blocks");b.empty();if(c.ownerid==prefs.userid){var e=$('<div><a href="#" class="btn-round small action">'+g_loc.getText("wintools.savebtn")+
"</a></div>");e.find("a").click(function(){WinTools.saveLibrary(c)});b.append(e);e=$('<div><a href="#" class="btn-round small action">'+g_loc.getText("wintools.editbtn")+"</a></div>");e.find("a").click(function(){IDE.selectAsset(null);IDE.selectAsset(c)});b.append(e);e=$('<div><a href="#" class="btn-round small secondary">'+g_loc.getText("wintools.deletebtn")+"</a></div>");e.find("a").click(function(){IDE.confirmDialog(g_loc.getText("wintools.deleteconfirm"),function(){WinTools.purgeLibrary(c)})});
b.append(e)}e=$('<div><a href="#" class="btn-round small secondary">'+g_loc.getText("wintools.removebtn")+"</a></div>");e.find("a").click(function(){IDE.confirmDialog(g_loc.getText("wintools.removeconfirm"),function(){WinTools.removeLibrary(c)})});b.append(e);for(var f=c.scripts,g=[],d=0;d<f.length;d++)if(f[d].func=="registerFunction"&&!f[d].hidden){var h=false;if(c.ownerid==prefs.userid||!f[d].hiddenInSandbox){for(e=0;e<g.length;e++)if(f[d].name<g[e].name){g.splice(e,0,f[d]);h=true;break}h||g.push(f[d])}}for(d=
0;d<g.length;d++){f=g[d].name;h=g[d].label._children;for(e=0;e<h.length;e++)h[e]instanceof LabelInput&&(f=f+(" {string:"+h[e].defaultLabel+"}"));f=new Block({cat:"library",name:c.classname+"::"+g[d].name,label:f,func:"blockControlCallLibrary"});e=$('<div class="draggable"></div>');e.data("draggable",f);b.append(e)}WinTools.render()}},reRender:function(){$("#win-tools .palette .blocks .draggable").each(function(b,c){$(c).data("draggable").reRender()});WinTools.render()},showCategory:function(b){if(!$("#win-tools").hasClass("simplified")){var c=
$("#win-tools .categories li.selected");if(!b){if(c.length>0&&IDE.editingActor==WinTools._showingToolsFor)return;b=c.attr("cat")}if(!(c.length>0&&c.attr("cat")==b&&IDE.editingActor==WinTools._showingToolsFor)){$("#win-tools .blocks").scrollTop(0);WinTools._showingToolsFor=IDE.editingActor;for(var c=-1,d=0;d<g_palette.length;d++)if(g_palette[d].cat==b){c=d;break}if(c<0){c=0;b=g_palette[0].cat}$("#win-tools .categories li").removeClass("selected").each(function(c,d){d=$(d);if(d.attr("cat")==b){d.addClass("selected");
return false}});var e=$("#win-tools .palette .blocks");e.empty();for(var f,d=0;d<g_palette[c].items.length;d++){var g=g_palette[c].items[d];if(g instanceof Block||g instanceof Label){var h=$('<div class="draggable"></div>');h.data("draggable",g);e.append(h)}else if(g.items){e.append("<h2>"+g.label+"</h2>");for(var j=g.items,k=0;k<j.length;k++){g=j[k];if(g instanceof Block||g instanceof Label){h=$('<div class="draggable"></div>');h.data("draggable",g);e.append(h)}else if(g.cat=="code"){f=IDE.editingActor?
ObjectIO.deserializeScriptStep(g,IDE.editingActor):ObjectIO.deserializeScriptStep(g,Runtime.background);h=$('<div class="draggable"></div>');h.data("draggable",g);e.append(h)}else if(!g.hidden&&(!WinTools._showingToolsFor||!g.omitActor)&&(WinTools._showingToolsFor||!g.omitbg)){f=g.value?new Label(g):new Block(g);h=$('<div class="draggable"></div>');h.data("draggable",f);e.append(h)}}for(k=0;k<j.length;k++){g=j[k];if(!(g instanceof Block||g instanceof Label))if(g.cat!="code"&&!g.hidden&&(WinTools._showingToolsFor&&
g.omitActor||!WinTools._showingToolsFor&&g.omitbg)){f=g.value?new Label(g):new Block(g);f.setDisabled(true);h=$('<div class="draggable"></div>');h.data("draggable",f);e.append(h)}}}else if(g.cat=="code"){f=IDE.editingActor?ObjectIO.deserializeScriptStep(g,IDE.editingActor):ObjectIO.deserializeScriptStep(g,Runtime.background);h=$('<div class="draggable"></div>');h.data("draggable",f);e.append(h)}else if(!g.hidden&&(!WinTools._showingToolsFor||!g.omitActor)&&(WinTools._showingToolsFor||!g.omitbg)){f=
g.value?new Label(g):new Block(g);h=$('<div class="draggable"></div>');h.data("draggable",f);e.append(h)}}WinTools.render()}}},spriteEvent:function(){},_removeAll:function(){},blocksChanged:function(b,c){b=="delete"&&WinTools._removeAll(c)},_mouseClick:function(b){var c=b.pageX,d=b.pageY;window.clearTimeout(WinTools._helpTimeoutId);if(WinTools.hideInlineHelp||$("#win-tools").hasClass("simplified"))return false;var e=$("#win-tools .palette .blocks");e.find(">div").removeClass("selected");c>=e.offset().left&&
(c<=e.offset().left+e.outerWidth()&&d>=e.offset().top&&d<=e.offset().top+e.outerHeight())&&e.find(">div").each(function(b,g){var h=$(g),j=h.offset();if(c>=j.left&&c<j.left+h.outerWidth()&&d>=j.top&&d<j.top+h.outerHeight()){if(h.hasClass("selected"))h.removeClass("selected");else if(h.hasClass("draggable")){WinTools._helpClicked=true;j=h.data("draggable");WinTools._handleBlockHelp(h,j)}else if(h.hasClass("article")){e.find(">div").removeClass("selected");h.addClass("selected")}return false}})},_getFunctionDocs:function(b,
c){if(c&&c.func=="blockInlineComment"){b.push(c.label._children[1].label);for(var d=0;d<c._containers.length;d++)WinTools._getFunctionDocs(b,c._containers[d]);WinTools._getFunctionDocs(b,c.next)}},showSimplified:function(b,c,d){if(b){$("#win-tools .palette .blocks").bind("mousewheel",function(){return false}).bind("DOMMouseScroll",function(){return false});Sprites.addSpriteListener(WinTools);WinCode.addChangeListener(WinTools.blocksChanged);$("#win-tools").addClass("simplified");WinTools.adjustWindow();
$("#win-tools .blocks").scrollTop(0);var e=$("#win-tools .palette .blocks");e.empty();if(c)for(b=0;b<c.length;b++){var f;f=c[b];if(f=f.func?f.func=="registerFunction"?new Block({cat:"functions",name:f.name,label:f.label,hasFlap:false,func:"registerFunction"}):f.func=="blockControlCall"?new Block({cat:"functions",name:f.name,label:f.label,func:"blockControlCall"}):f.func=="valueControlCall"?new Block({cat:"functions",name:f.name,label:f.label,func:"valueControlCall"}):f.func=="valueParam"?new Label({cat:"functions",
name:f.name,value:"string",func:"valueParam"}):f.func=="valueVar"?new Label({cat:"var",name:f.name,value:"string",func:"valueVar"}):f.func=="valueList"?new Label({cat:"list",label:f.name,value:"string",func:"valueList"}):makeBlockByName(f.func):makeBlockByName(f)){var g=$('<div class="draggable"></div>');g.data("draggable",f);e.append(g)}}else if(g_palette.length>0)for(b=0;b<g_palette[0].items.length;b++){f=makeBlockByName(g_palette[0].items[b].func);g=$('<div class="draggable"></div>');g.data("draggable",
f);e.append(g)}if(d)for(b=0;b<d.length;b++){c=d[b];if(c.actor){c.thumbnail=c.img;c.path="/code/"+c.actor+".actor"}else if(c.sound)c.thumbnail="ide/imgs/content/sound.png";else if(c.img){c.path=c.img;c.thumbnail=c.img;c.raw=true}}WinTools.render()}else{$("#win-tools").removeClass("simplified");WinTools.adjustWindow();Sprites.removeSpriteListener(WinTools);WinCode.removeChangeListener(WinTools.blocksChanged);$("#win-tools .palette .blocks").unbind("mousewheel").unbind("DOMMouseScroll")}},showVariables:function(){$("#win-tools .categories li").removeClass("selected");
$("#win-tools .categories li[cat=variables]").addClass("selected");$("#win-tools .blocks").scrollTop(0);var b=$("#win-tools .palette .blocks");b.empty();b.append("<h2>Create Variables</h2>");var c=new Block(g_steps.blockControlScriptVar),d=$('<div class="draggable"></div>');d.data("draggable",c);b.append(d);if(g_steps.valueNetworkParse&&!g_steps.valueNetworkParse.hidden){c=new Label(g_steps.valueNetworkParse);d=$('<div class="draggable"></div>');d.data("draggable",c);b.append(d)}else if(g_steps.valueControlParse&&
!g_steps.valueControlParse.hidden){c=new Label(g_steps.valueControlParse);d=$('<div class="draggable"></div>');d.data("draggable",c);b.append(d)}d=$('<div><a href="#" class="btn-round small action">Add Variable</a></div>');d.find("a").click(WinTools.cmdCreateVar);b.append(d);d=$('<div><a href="#" class="btn-round small secondary">Delete Variable</a></div>');d.find("a").click(WinTools.cmdDeleteVar);b.append(d);var e=false,f;for(f in Runtime.background.variables){if(!e){b.append("<h2>Global Variables</h2>");
e=true}c=new Label({cat:"var",watchable:"global",name:f,value:"string",func:"valueVar"});c.isGlobal=true;d=$('<div class="draggable"></div>');d.data("draggable",c);b.append(d)}e=false;if(IDE.editingActor)for(f in IDE.editingActor.variables){if(!e){b.append("<h2>Local Variables</h2>");e=true}c=new Label({cat:"var",watchable:"local",name:f,value:"string",func:"valueVar"});c.isGlobal=false;d=$('<div class="draggable"></div>');d.data("draggable",c);b.append(d)}b.append("<h2>Variable Operators</h2>");
WinTools._objects.push(new WinTools.TextLabel("Variable Operators"));for(e=0;e<g_varBlocks.length;e++){c=g_varBlocks[e];c=c.value?new Label(c):new Block(c);d=$('<div class="draggable"></div>');d.data("draggable",c);b.append(d)}b.append("<h2>Create Lists</h2>");d=$('<div><a href="#" class="btn-round small action">Add List</a></div>');d.find("a").click(WinTools.cmdCreateList);b.append(d);d=$('<div><a href="#" class="btn-round small secondary">Delete List</a></div>');d.find("a").click(WinTools.cmdDeleteList);
b.append(d);e=false;for(f in Runtime.background.lists){if(!e){b.append("<h2>Global Lists</h2>");e=true}c=new Label({cat:"list",watchable:null,name:f,value:"string",func:"valueList"});c.isGlobal=true;d=$('<div class="draggable"></div>');d.data("draggable",c);b.append(d)}if(IDE.editingActor){e=false;for(f in IDE.editingActor.lists){if(!e){b.append("<h2>Local Lists</h2>");e=true}c=new Label({cat:"list",watchable:null,name:f,value:"string",func:"valueList"});c.isGlobal=false;d=$('<div class="draggable"></div>');
d.data("draggable",c);b.append(d)}}b.append("<h2>List Operators</h2>");for(e=0;e<g_listBlocks.length;e++){c=g_listBlocks[e];c=c.value?new Label(c):new Block(c);d=$('<div class="draggable"></div>');d.data("draggable",c);b.append(d)}b.append("<h2>Object Operators</h2>");for(e=0;e<g_objBlocks.length;e++){c=g_objBlocks[e];c=c.value?new Label(c):new Block(c);d=$('<div class="draggable"></div>');d.data("draggable",c);b.append(d)}WinTools.render()},showFunctions:function(){var b;b=IDE.editingActor?IDE.editingActor.scripts:
Runtime.background.scripts;$("#win-tools .categories li").removeClass("selected");$("#win-tools .categories li[cat=functions]").addClass("selected");$("#win-tools .blocks").scrollTop(0);var c=$("#win-tools .palette .blocks");c.empty();if(g_steps.blockControlCallMember){var d=new Block(g_steps.blockControlCallMember),e=$('<div class="draggable"></div>');e.data("draggable",d);c.append(e)}if(g_steps.valueControlCallMember){d=new Label(g_steps.valueControlCallMember);e=$('<div class="draggable"></div>');
e.data("draggable",d);c.append(e)}d=new Block(g_steps.blockControlReturn);e=$('<div class="draggable"></div>');e.data("draggable",d);c.append(e);c.append("<h2>Functions</h2>");e=$('<div><a href="#" class="btn-round small action">Add Function</a></div>');e.find("a").click(WinTools.cmdCreateFunction);c.append(e);for(var f=[],g=0;g<b.length;g++)if(b[g].func=="registerFunction"){e=false;for(d=0;d<f.length;d++)if(b[g].name<f[d].name){f.splice(d,0,b[g]);e=true;break}e||f.push(b[g])}for(g=WinTools.maxWidth=
0;g<f.length;g++){b=f[g].name;e=f[g].label._children;for(d=0;d<e.length;d++)e[d]instanceof LabelInput&&(b=b+(" {string:"+e[d].defaultLabel+"}"));d=new Block({cat:"functions",name:f[g].name,label:b,func:"blockControlCall"});e=$('<div class="draggable"></div>');e.data("draggable",d);c.append(e)}WinTools.render()},cmdCreateFunction:function(){var b=$("#func-create");b.find("ul").empty();b.find("a.addBtn").unbind().click(function(){var c=$('<li><input type="text"/> <a class="delete icon-cancel" href="#"></a></li>');
b.find("ul").append(c);c.find("a").click(function(){$(this).parent().detach();return false});return false});b.find("input");b.find(".error").addClass("hidden");b.modal();b.find(".createBtn").text(g_loc.getText("dialog.btncreate")).unbind().click(function(){var c=true,d=b.find("input"),e=$.trim($(d[0]).val());if(e==""){c=false;b.find(".error").removeClass("hidden").text(g_loc.getText("func.err_fnblank"))}if(c)for(var f=0;f<WinCode._scripts.length;f++)if(WinCode._scripts[f].func=="registerFunction"&&
WinCode._scripts[f].name==e){c=false;b.find(".error").removeClass("hidden").text(g_loc.getText("func.err_fndup"));break}if(c){var g=[];d.each(function(d,e){if($(e).val()==""){c=false;b.find(".error").removeClass("hidden").text(g_loc.getText("func.err_paramblank"));return false}if(d>0)if(g.indexOf($(e).val())>=0){c=false;b.find(".error").removeClass("hidden").text(g_loc.getText("func.err_paramdup"))}else g.push($(e).val())})}if(c){WinTools.createFunction(e,g);$.modal.close()}return false});b.find(".cancelBtn").unbind().click(function(){$.modal.close();
return false})},createFunction:function(b,c){for(var d=b,e=0;e<c.length;e++)d=d+(" {param:"+c[e]+"}");d=new Block({hasFlap:false,cat:"functions",name:b,label:d,func:"registerFunction"});e=WinCode.findBlankSpace();d.x=e.x;d.y=e.y;d._computeBlockBounds();WinCode._scripts.push(d);WinTools.updateFunctions()},cmdEditFunction:function(b){if(b.func=="registerFunction"){var c=$("#func-create"),d=c.find("ul").empty();c.find("input").val(b.name);for(var e=b.label.getNumSockets(),f=0;f<e;f++){var g=b.label.getSocketAtChild(f),
h=$('<li><input type="text"/> <a class="delete icon-cancel" href="#"></a></li>');d.append(h);h.find("input").val(g._child.name);h.find("a").click(function(){IDE.dirty();$(this).parent().detach();return false})}c.find("a.addBtn").unbind().click(function(){var b=$('<li><input type="text"/> <a class="delete icon-cancel" href="#"></a></li>');c.find("ul").append(b);b.find("a").click(function(){IDE.dirty();$(this).parent().detach();return false});return false});c.find(".error").addClass("hidden");c.modal();
c.find(".createBtn").text(g_loc.getText("dialog.btnok")).unbind().click(function(){IDE.dirty();var d=true,e=c.find("input"),f=$(e[0]).val();if(f==""){d=false;c.find(".error").removeClass("hidden").text(g_loc.getText("func.err_fnblank"))}if(d)for(var g=0;g<WinCode._scripts.length;g++)if(WinCode._scripts[g]!=b&&WinCode._scripts[g].func=="registerFunction"&&WinCode._scripts[g].name==f){d=false;c.find(".error").removeClass("hidden").text(g_loc.getText("func.err_fndup"));break}if(d){var h=[];e.each(function(b,
e){if($(e).val()==""){d=false;c.find(".error").removeClass("hidden").text(g_loc.getText("func.err_paramblank"));return false}if(b>0)if(h.indexOf($(e).val())>=0){d=false;c.find(".error").removeClass("hidden").text(g_loc.getText("func.err_paramdup"))}else h.push($(e).val())})}if(d){WinCode.updateFunction(b,f,h);$.modal.close()}return false});c.find(".cancelBtn").unbind().click(function(){$.modal.close();return false})}},updateFunctions:function(){var b=$("#win-tools .palette .categories li.selected");
b.length==1&&$(b[0]).attr("cat")=="functions"&&WinTools.showFunctions()},cmdEditScriptVars:function(b){if(b.func=="blockControlScriptVar"){for(var c=$("#var-script"),d=c.find("ul").empty(),e=b.label.getNumSockets(),f=0;f<e;f++){var g=b.label.getSocketAtChild(f),h=$('<li><input type="text"/> <a class="delete icon-cancel" href="#"></a></li>');d.append(h);h.find("input").val(g._child.name);h.find("a").click(function(){$(this).parent().detach();return false})}c.find("a.addBtn").unbind().click(function(){var b=
$('<li><input type="text"/> <a class="delete icon-cancel" href="#"></a></li>');c.find("ul").append(b);b.find("a").click(function(){$(this).parent().detach();return false});return false});c.find(".error").addClass("hidden");c.modal();c.find(".okBtn").unbind().click(function(){var d=true,e=[];c.find("input").each(function(b,f){if($(f).val()==""){d=false;c.find(".error").removeClass("hidden").text(g_loc.getText("func.err_paramblank"));return false}if(e.indexOf($(f).val())>=0){d=false;c.find(".error").removeClass("hidden").text(g_loc.getText("func.err_paramdup"))}else e.push($(f).val())});
if(d){WinCode.updateScriptVars(b,e);$.modal.close()}return false});c.find(".cancelBtn").unbind().click(function(){$.modal.close();return false})}},cloneBlock:function(b){var c=null;$("#win-tools .palette .blocks .draggable").each(function(d,e){var f=$(e),g=f.data("draggable");if(g.func==b){c=g.copy();c.x=f.offset().left;c.y=f.offset().top;c._computeBlockBounds();return false}});return c},cloneResource:function(){},getHilightedAsset:function(){var b=null;if(WinTools._objects!=null)for(var c=0;c<WinTools._objects.length;c++){var d=
WinTools._objects[c];if(d.hilight){b={obj:d,x:0,y:0,width:d.width,height:d.height};break}}return b},hilightAsset:function(b){var c=null;if(WinTools._objects!=null)for(var d=0;d<WinTools._objects.length;d++){var e=WinTools._objects[d];if(e instanceof WinTools.Resource&&e.path==b){e.hilight=true;c={x:0,y:0,width:e.width,height:e.height}}else e.hilight=false}return c},hilightBlock:function(b,c){var d=null,e=$("#win-tools .palette .blocks");e.find("div.draggable").each(function(f,g){var h=$(g),j=h.data("draggable");
if((j instanceof Block||j instanceof Label)&&j.func==b&&(!c||j.name==c)){e.scrollTop(0).scrollLeft(0);e.scrollTop(h.offset().top-e.innerHeight()/2);d={x:h.offset().left,y:h.offset().top,width:h.outerWidth(),height:h.outerHeight()};return false}});return d},cmdCreateVar:function(){var b=$("#var-create");b.find(".error").addClass("hidden");b.find("input[name=name]").val("");b.find("input[name=doreset]")[0].checked=false;b.find("input[name=default]").val("");b.find("input[name=scope]").unbind().click(function(){$(this).val()==
"global"?b.find("input[name=cloud]").attr("disabled",null):b.find("input[name=cloud]").attr("disabled","disabled")});b.find("input[name=scope]:first")[0].checked=false;b.find("input[name=scope]:last")[0].checked=true;b.find("input[name=cloud]").attr("disabled","disabled")[0].checked=false;b.modal();b.find(".createBtn").unbind().click(function(){var c=$.trim(b.find("input[name=name]").val()),d=null;b.find("input[name=doreset]")[0].checked&&(d=b.find("input[name=default]").val());var e=b.find("input[name=scope]:first")[0].checked,
f=b.find("input[name=cloud]")[0].checked;c!=""&&WinTools.createVar(c,d,e,f);$.modal.close();return false});b.find(".cancelBtn").unbind().click(function(){$.modal.close();return false})},createVar:function(b,c,d,e){IDE.dirty();var f="";c!==null&&(f=valueToNative(c));if(d||!IDE.editingActor){Runtime.background.variables[b]=f;Runtime.background.varDefaults[b]=c===null?null:f;if(e){if(!Runtime.background.cloudVariables)Runtime.background.cloudVariables={};Runtime.background.cloudVariables[b]=true}}else{IDE.editingActor.variables[b]=
f;IDE.editingActor.varDefaults[b]=c===null?null:f}WinTools.updateVariables()},cmdDeleteVar:function(){$(".choice-chooser").detach();var b=$('<div class="choice-chooser"></div>');b.css("left",$(this).offset().left+$(this).outerWidth());b.css("top",$(this).offset().top);$("body").append(b);var c=false,d;for(d in Runtime.background.variables){c=true;break}if(c){b.append("<h1>Globals</h1>");var e=$("<ul></ul>");b.append(e);for(d in Runtime.background.variables){var f=$("<li>"+d+"</li>");f.click(WinTools.cmdDeleteGlobalVar);
e.append(f)}}if(IDE.editingActor){e=false;for(d in IDE.editingActor.variables){e=true;break}if(e){c=true;b.append("<h1>Locals</h1>");e=$("<ul></ul>");b.append(e);for(d in IDE.editingActor.variables){f=$("<li>"+d+"</li>");f.click(WinTools.cmdDeleteLocalVar);e.append(f)}}}c||b.append("<h1>No Variables</h1>")},cmdDeleteGlobalVar:function(){IDE.dirty();var b=$(this).text();delete Runtime.background.variables[b];Runtime.background.varDefaults&&delete Runtime.background.varDefaults[b];Runtime.background.cloudVariables&&
delete Runtime.background.cloudVariables[b];$(".choice-chooser").detach();WinTools.updateVariables()},cmdDeleteLocalVar:function(){IDE.dirty();if(IDE.editingActor){var b=$(this).text();delete IDE.editingActor.variables[b];IDE.editingActor.varDefaults&&delete IDE.editingActor.varDefaults[b];IDE.editingActor.cloudVariables&&delete IDE.editingActor.cloudVariables[b]}$(".choice-chooser").detach();WinTools.updateVariables()},cmdCreateList:function(){var b=$("#list-create");b.find(".error").addClass("hidden");
b.find("input[name=name]").val("");b.find("input[name=scope]").unbind().click(function(){$(this).val()=="global"?b.find("input[name=cloud]").attr("disabled",null):b.find("input[name=cloud]").attr("disabled","disabled")});b.find("input[name=scope]:first")[0].checked=false;b.find("input[name=scope]:last")[0].checked=true;b.find("input[name=cloud]").attr("disabled","disabled")[0].checked=false;b.modal();b.find(".createBtn").unbind().click(function(){var c=$.trim(b.find("input[name=name]").val()),d=b.find("input[name=scope]:first")[0].checked,
e=b.find("input[name=cloud]")[0].checked;c!=""&&WinTools.createList(c,d,e);$.modal.close();return false});b.find(".cancelBtn").unbind().click(function(){$.modal.close();return false})},createList:function(b,c,d){IDE.dirty();if(c||!IDE.editingActor){Runtime.background.lists[b]===void 0&&(Runtime.background.lists[b]=[]);if(d){if(!Runtime.background.cloudLists)Runtime.background.cloudLists={};Runtime.background.cloudLists[b]=true}}else IDE.editingActor.lists[b]===void 0&&(IDE.editingActor.lists[b]=[]);
WinTools.updateVariables()},cmdDeleteList:function(){$(".choice-chooser").detach();var b=$('<div class="choice-chooser"></div>');b.css("left",$(this).offset().left+$(this).outerWidth());b.css("top",$(this).offset().top);$("body").append(b);var c=false,d;for(d in Runtime.background.lists){c=true;break}if(c){b.append("<h1>Globals</h1>");var e=$("<ul></ul>");b.append(e);for(d in Runtime.background.lists){var f=$("<li>"+d+"</li>");f.click(WinTools.cmdDeleteGlobalList);e.append(f)}}if(IDE.editingActor){e=
false;for(d in IDE.editingActor.lists){e=true;break}if(e){c=true;b.append("<h1>Locals</h1>");e=$("<ul></ul>");b.append(e);for(d in IDE.editingActor.lists){f=$("<li>"+d+"</li>");f.click(WinTools.cmdDeleteLocalList);e.append(f)}}}c||b.append("<h1>No Lists</h1>")},cmdDeleteGlobalList:function(){IDE.dirty();delete Runtime.background.lists[$(this).text()];Runtime.background.cloudLists&&delete Runtime.background.cloudLists[$(this).text()];$(".choice-chooser").detach();WinTools.updateVariables()},cmdDeleteLocalList:function(){IDE.dirty();
IDE.editingActor&&delete IDE.editingActor.lists[$(this).text()];$(".choice-chooser").detach();WinTools.updateVariables()},updateVariables:function(){var b=$("#win-tools .categories li.selected");b.length==1&&$(b[0]).attr("cat")=="variables"&&WinTools.showVariables()},cmdEditVar:function(b){var c=b.name,d;d=b.isGlobal?Runtime.background.varDefaults[c]:IDE.editingActor.varDefaults[c];if(d===null||d===void 0)d=null;var e=$("#var-edit");e.find(".error").addClass("hidden");e.find("input[name=name]").val(c);
if(d===null){e.find("input[name=doreset]")[0].checked=false;e.find("input[name=default]").val("")}else{e.find("input[name=doreset]")[0].checked=true;e.find("input[name=default]").val(d)}e.modal();e.find(".okBtn").unbind().click(function(){IDE.dirty();var c=$.trim($("#var-edit input[name=name]").val()),d="",d=$("#var-edit input[name=doreset]")[0].checked?valueToNative($("#var-edit input[name=default]").val()):null,h=false;if(c&&c!=b.name)if(b.isGlobal)if(Runtime.background.variables[c]!==void 0)h=
true;else{Runtime.background.variables[c]=Runtime.background.variables[b.name];Runtime.background.varDefaults[c]=d;Runtime.background.cloudVariables&&Runtime.background.cloudVariables[b.name]&&(Runtime.background.cloudVariables[c]=true);delete Runtime.background.variables[b.name];Runtime.background.varDefaults&&delete Runtime.background.varDefaults[b.name];Runtime.background.cloudVariables&&delete Runtime.background.cloudVariables[b.name]}else if(IDE.editingActor.variables[c]!==void 0)h=true;else{IDE.editingActor.variables[c]=
IDE.editingActor.variables[b.name];IDE.editingActor.varDefaults[c]=d;IDE.editingActor.cloudVariables&&IDE.editingActor.cloudVariables[b.name]&&(IDE.editingActor.cloudVariables[c]=true);delete IDE.editingActor.variables[b.name];IDE.editingActor.varDefaults&&delete IDE.editingActor.varDefaults[b.name];IDE.editingActor.cloudVariables&&delete IDE.editingActor.cloudVariables[b.name]}else if(b.isGlobal){Runtime.background.varDefaults[b.name]=d;d!=null&&(Runtime.background.variables[b.name]=d)}else{IDE.editingActor.varDefaults[b.name]=
d;d!=null&&(IDE.editingActor.variables[b.name]=d)}if(h)e.find(".error").removeClass("hidden").text('Oops, the variable "'+c+'" already exists');else{WinTools.updateVariables();$.modal.close()}return false});e.find(".deleteBtn").unbind().click(function(){if(b.isGlobal){delete Runtime.background.variables[b.name];Runtime.background.varDefaults&&delete Runtime.background.varDefaults[b.name];Runtime.background.cloudVariables&&delete Runtime.background.cloudVariables[b.name]}else{delete IDE.editingActor.variables[b.name];
IDE.editingActor.varDefaults&&delete IDE.editingActor.varDefaults[b.name];IDE.editingActor.cloudVariables&&delete IDE.editingActor.cloudVariables[b.name]}WinTools.updateVariables();$.modal.close();return false});e.find(".cancelBtn").unbind().click(function(){$.modal.close();return false})},cmdEditList:function(b){var c=b.name,d=$("#list-edit");d.find(".error").addClass("hidden");d.find("input[name=name]").val(c);d.find("input[name=value]").val("");var e=d.find("ul").empty(),f=null;IDE.editingActor&&
IDE.editingActor.lists[c]!==void 0?f=IDE.editingActor.lists[c]:Runtime.background.lists[c]!==void 0&&(f=Runtime.background.lists[c]);for(c=0;c<f.length;c++)e.append("<li><b>"+(c+1)+"</b><span>"+f[c]+"</span></li>");d.modal();d.find(".okBtn").unbind().click(function(){var c=$.trim(d.find("input[name=name]").val()),e=false;if(c&&c!=b.name){IDE.dirty();if(b.isGlobal)if(Runtime.background.lists[c]!==void 0)e=true;else{Runtime.background.lists[c]=Runtime.background.lists[b.name];delete Runtime.background.lists[b.name]}else if(IDE.editingActor.lists[c]!==
void 0)e=true;else{IDE.editingActor.lists[c]=IDE.editingActor.lists[b.name];delete IDE.editingActor.lists[b.name]}if(e)d.find(".error").removeClass("hidden").text('Oops, the list "'+c+'" already exists');else{WinTools.updateVariables();$.modal.close()}return false}});d.find(".importBtn").unbind().click(function(){var c=$.trim(d.find("input[name=value]").val());try{c=JSON.parse(c);b.isGlobal?Runtime.background.lists[b.name]=c:IDE.editingActor.lists[b.name]=c}catch(e){}$.modal.close();return false});
d.find(".deleteBtn").unbind().click(function(){b.isGlobal?delete Runtime.background.lists[b.name]:delete IDE.editingActor.lists[b.name];WinTools.updateVariables();$.modal.close();return false});d.find(".cancelBtn").unbind().click(function(){$.modal.close();return false})},canDrop:function(b,c,d,e){if(WinCode._enableDragToDelete&&(WinCode._enableDeleteStart||!WinCode._enableDeleteStart&&e.hasFlap)&&!WinCode._readOnly&&!$("#win-code").hasClass("hidden")&&!$("#win-tools").hasClass("hidden")){d=$("#win-tools .tools-code");
if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight())return true}return false},drop:function(b,c,d,e,f){if(f==WinCode&&(e instanceof Block||e instanceof Label)){WinTools._removeAll(e);WinCode._broadcastChange("delete",e)}return true},hilightAccept:function(b,c){if(b&&c!=WinTools&&c!=WinAnnotation){$("#win-annotation");b instanceof Block||b instanceof Label?$("#win-tools .deletemask").fadeIn(150):$("#win-tools .deletemask").fadeOut(150)}else $("#win-tools .deletemask").fadeOut(150)},
canDrag:function(b,c){if(!$("#win-tools").hasClass("hidden")){var d=$("#win-tools .palette .blocks");if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight()){var e=null;d.find(".draggable").each(function(d,g){var h=$(g),j=h.offset();if(b>=j.left&&b<j.left+h.outerWidth()&&c>=j.top&&c<j.top+h.outerHeight()){h=h.data("draggable");if(!h.disabled){e=h;return false}}});if(e)return true}}return false},getDragObj:function(b,c){WinTools.hideHelpHover||
window.clearTimeout(WinTools._showBlockTimer);if(!$("#win-tools").hasClass("hidden")){var d=$("#win-tools .palette .blocks");if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight()){var e=null;d.find(".draggable").each(function(d,f){var j=$(f),k=j.offset();if(b>=k.left&&(b<k.left+j.outerWidth()&&c>=k.top&&c<k.top+j.outerHeight())&&!j.data("draggable").disabled){e=j;return false}});if(e){$(".tooltip").detach();d.find(".draggable").removeClass("selected").find("div.info").detach();
var d=e.data("draggable"),f=d.copy();f.x=e.offset().left-b;f.y=e.offset().top-c;(f instanceof Block||f instanceof Label)&&f._computeBlockBounds();f.obj=d;return f}}}return null},doubleClick:function(b,c){WinTools.hideHelpHover||window.clearTimeout(WinTools._showBlockTimer);if(!$("#win-tools").hasClass("hidden")){var d=$("#win-tools .palette .blocks");if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight()){var e=null;d.find(".draggable").each(function(d,
g){var h=$(g),j=h.offset();if(b>=j.left&&(b<j.left+h.outerWidth()&&c>=j.top&&c<j.top+h.outerHeight())&&!h.data("draggable").disabled){e=h;return false}});if(e){$(".tooltip").detach();d=e.data("draggable");if(d!=null&&d instanceof Label){d.func=="valueVar"&&WinTools.cmdEditVar(d);d.func=="valueList"&&WinTools.cmdEditList(d)}}}}},dragCanceled:function(){},loadLibrary:function(){var b=$("#library-list");$.ajax({url:"api/librarylist.aspx",success:function(c){var c=JSON.parse(c),d=b.find("ul");d.empty();
for(var e=0;e<c.length;e++){var f=$('<li libid="'+c[e]._id.$id+'"><span class="name"></span><span class="description"></span><span class="user"></span></li>');f.find(".name").text(c[e].name);f.find(".description").text(c[e].description);f.find(".user").text(c[e].username);f.click(function(){Runtime.requireLibraryId($(this).attr("libid"),function(){WinTools.reset()});$.modal.close();return false});d.append(f)}b.modal()}})},purgeLibrary:function(b){$.ajax({url:"api/librarydelete.aspx",data:{id:b.classname},
success:function(){WinTools.removeLibrary(b)}})},removeLibrary:function(b){for(var c=0;c<Runtime.libs.length;c++)if(Runtime.libs[c]==b){Runtime.libs.splice(c,1);WinTools.reset();break}},saveLibrary:function(b){var c=$("#library-save");c.find(".title").text(g_loc.getText("libsavedlg.titlesave"));c.find(".error").text("").addClass("hidden");$("#lib-name").val(b.label);$("#lib-namespace").val(b.classname).attr("disabled","disabled");$("#lib-description").val(b.description);c.find(".saveBtn .spinner").detach();
c.modal();c.find(".saveBtn").unbind().click(function(){var c=$.trim($("#lib-name").val()),e=$.trim($("#lib-description").val());if(!c||!e)$("#library-save .error").text("Please enter a name and description").removeClass("hidden");else{$("#library-save .saveBtn").prepend('<img class="spinner" src="image/loaders/loader16.gif"/>');b.label=c;$.ajax({url:"api/librarysave.aspx",type:"POST",data:{id:b.dbid,d:e,pb:$("#lib-ispublic")[0].checked,data:JSON.stringify(ObjectIO.serializeLibrary(b))},success:function(c){c=
JSON.parse(c);if(c.result){b.description=e;WinTools.reset();$.modal.close()}else $("#library-save .error").text("Please enter a unique namespace").removeClass("hidden")}})}return false});c.find(".cancelBtn").unbind().click(function(){$.modal.close();return false})},createLibrary:function(){var b=$("#library-save");b.find(".title").text(g_loc.getText("libsavedlg.titlecreate"));b.find(".error").text("").addClass("hidden");$("#lib-name").val("");$("#lib-namespace").val("").attr("disabled",null);$("#lib-description").val("");
b.modal();b.find(".saveBtn").unbind().click(function(){var b=$.trim($("#lib-name").val()),d=$.trim($("#lib-description").val()),e=$.trim($("#lib-namespace").val());if(b)if(e){var f=new Sprite({label:b,classname:e,isHidden:true});f.description=d;f.ownerid=prefs.userid;$.ajax({url:"api/librarysave.aspx",type:"POST",data:{id:"",ns:e,d:d,pb:false,data:JSON.stringify(ObjectIO.serializeLibrary(f))},success:function(b){b=JSON.parse(b);if(b.result){f.dbid=b.id;Runtime.libs.push(f);WinTools.reset();$.modal.close()}else $("#library-save .error").text("Please enter a unique namespace").removeClass("hidden")}})}else $("#library-save .error").text("Please enter a unique namespace").removeClass("hidden");
else $("#library-save .error").text("Please enter a name and description").removeClass("hidden");return false});b.find(".cancelBtn").unbind().click(function(){$.modal.close();return false})},showDebugger:function(){var b=$("#debugger");b.find(".variables").empty();b.find(".title a.refresh").unbind().click(function(){WinTools.refreshDebugger();return false});b.find("a.window-close").unbind().click(function(){b.addClass("hidden");return false});WinTools.refreshDebugger();b.removeClass("hidden").resizable().draggable({})},
refreshDebugger:function(){var b=$("#debugger").find(".actors ul").empty(),c=$('<li><a href="#">stage</a></li>');b.append(c);(!IDE.editingActor||IDE.editingActor==Runtime.background)&&c.addClass("selected");c.find("a").click(function(){WinTools.showDebugVariables(Runtime.background);b.find("li").removeClass("selected");$(this).parent().addClass("selected");return false});$(Runtime.sprites).each(function(){c=$('<li><a href="#"></a></li>');IDE.editingActor==this&&c.addClass("selected");var d=this;c.find("a").text(d.label).click(function(){WinTools.showDebugVariables(d);
b.find("li").removeClass("selected");$(this).parent().addClass("selected");return false});b.append(c)});WinTools.showDebugVariables(IDE.editingActor)},_showDebugVariables:function(b,c,d){if(b instanceof Array)if(b.length>0){d&&c.append("<h2>"+d+"</h2>");$container=$('<div class="container"></div>');c.append($container);c=$('<a href="#"><span class="icon-arrow-down"></span><span class="icon-arrow-up"></span></a>');c.click(function(){$(this).parent().toggleClass("expanded");return false});$container.append(c);
$container.append('<span class="type">list</span>');$container.find(">.type").text(b.join(","));var e=$("<table></table>");$container.append(e);for(c=0;c<b.length;c++){var f=$('<tr><td class="name"></td><td class="value"></td></tr>');f.find(">.name").text(c+":");WinTools._showDebugVariables(b[c],f.find(">.value"));e.append(f)}}else d||c.text("<empty list>");else if(b instanceof Number||b instanceof String||b instanceof Boolean)c.text(b);else if(b instanceof Object){var f=false,e=$("<table></table>"),
g;for(g in b){f=$('<tr><td class="name"></td><td class="value"></td></tr>');f.find(">.name").text(g+":");WinTools._showDebugVariables(b[g],f.find(">.value"));e.append(f);f=true}if(f){d&&c.append("<h2>"+d+"</h2>");$container=$('<div class="container"></div>');c.append($container);c=$('<a href="#"><span class="icon-arrow-down"></span><span class="icon-arrow-up"></span></a>');c.click(function(){$(this).parent().toggleClass("expanded");return false});$container.append(c);$container.append('<span class="type">object</span>');
$container.append(e)}else d||c.text("<empty object>")}else b?c.text(b):c.text("<empty>")},showDebugVariables:function(b){var c,d="Local";if(!b||b==Runtime.background){b=Runtime.background;d="Global";c=["background #","scene #","scene name","x gravity","y gravity","background offset x","background offset y","viewport offset x","viewport offset y"]}else c=["x position","y position","direction","angle","layer","rotation style","label","costume #","costume name","say","visible","size","volume","width",
"height","density","friction","restitution","angular velocity","angular damping","inertia","awake","linear damping","x linear velocity","y linear velocity"];var e=$("#debugger .variables").empty();WinTools._showDebugVariables(b.variables,e,d);WinTools._showDebugVariables(b.lists,e,"    ");for(d=0;d<Runtime.runningScripts.length;d++){var f=Runtime.runningScripts[d];if(f.sprite==b){WinTools._showDebugVariables(f.fnArgs,e,"Script "+(d+1)+" Function Arguments");e.find(">div").addClass("expanded").find(">a").addClass("hidden");
WinTools._showDebugVariables(f.scriptVars,e,"Script "+(d+1)+" Variables");e.find(">div").addClass("expanded").find(">a").addClass("hidden")}}if(b!=Runtime.background){WinTools._showDebugVariables(Runtime.background.variables,e,"Global");WinTools._showDebugVariables(Runtime.background.lists,e,"    ")}e.find(">div").addClass("expanded").find(">a").addClass("hidden");e.append("<h2>Properties</h2>");d=$('<div class="container"></div>');e.append(d);e=$('<a href="#"><span class="icon-arrow-down"></span><span class="icon-arrow-up"></span></a>');
e.click(function(){$(this).parent().toggleClass("expanded");return false});d.append(e);d.append('<span class="type">properties</span>');var g=$("<table></table>");d.append(g);$(c).each(function(c,d){var e=$('<tr><td class="name"></td><td class="value"></td></tr>');e.find(">.name").text(d);e.find(">.value").text(propertyGet(d,b.label));g.append(e)})},render:function(){$("#win-tools .palette .blocks .draggable").each(function(b,c){var d=$(c);d.data("draggable").getImage(function(b){d.empty();d.append(b);
b.width=(b.naturalWidth?b.naturalWidth:b.width)/2},2)})},Button:function(b,c){this.label=b;this.callback=c;this.fontSize=defaultLabelFontSize;this.fontColor=defaultInputFontColor;this.height=this.width=this.y=this.x=0}};WinTools.Button.prototype.getText=function(){return this.label};
WinTools.Button.prototype._computeBlockBounds=function(){if(window.WinCode){WinCode.context.font="bold "+this.fontSize+"px Arial";this.width=WinCode.context.measureText(this.label).width+6+labelRadius*2;this.height=this.fontSize+20}};WinTools.Button.prototype.copy=function(){return this};WinTools.Button.prototype.getChildAtPoint=function(b,c){return b>=this.x&&b<=this.x+this.width&&c>=this.y&&c<=this.y+this.height?this:null};
WinTools.Button.prototype.draw=function(b){b.save();b.textAlign="left";b.textBaseline="middle";b.font="bold "+this.fontSize+"px Arial";b.strokeStyle="#000";b.fillStyle="#fff";var c=this.fontSize+20;b.translate(this.x,this.y+(this.height-c)/2);b.beginPath();b.moveTo(0,labelRadius);b.arcTo(0,0,labelRadius,0,labelRadius);b.lineTo(this.width-labelRadius,0);b.arcTo(this.width,0,this.width,labelRadius,labelRadius);b.lineTo(this.width,this.height-labelRadius);b.arcTo(this.width,this.height,this.width-labelRadius,
this.height,labelRadius);b.lineTo(labelRadius,this.height);b.arcTo(0,this.height,0,this.height-labelRadius,labelRadius);b.closePath();b.fill();b.stroke();b.strokeStyle=this.fontColor;b.fillStyle=this.fontColor;b.fillText(this.label,3+labelRadius,c/2);b.restore()};WinTools.TextLabel=function(b){this.label=b;this.fontSize=20;this.fontColor="#fff";this.height=this.width=this.y=this.x=0};WinTools.TextLabel.prototype.getText=function(){return this.label};
WinTools.TextLabel.prototype._computeBlockBounds=function(){if(window.WinCode&&window.WinCode.context){WinCode.context.font="bold "+this.fontSize+"px Arial";this.width=WinCode.context.measureText(this.label).width+6+labelRadius*2;this.height=this.fontSize+20}};WinTools.TextLabel.prototype.copy=function(){return this};WinTools.TextLabel.prototype.getChildAtPoint=function(){return null};
WinTools.TextLabel.prototype.draw=function(b){b.save();b.textAlign="left";b.textBaseline="middle";b.font="normal "+this.fontSize+"px Open Sans";b.strokeStyle="#000";b.fillStyle="#aaa";var c=this.fontSize+18;b.translate(this.x,this.y+(this.height-c)/2);b.strokeStyle=this.fontColor;b.fillStyle=this.fontColor;b.fillText(this.label,0,c/2);b.beginPath();b.moveTo(0,c-this.fontSize*0.25);b.lineTo(WinTools.canvas.width-20,c-this.fontSize*0.25);b.stroke();b.restore()};
WinTools.Resource=function(b,c,d){this.path=b;this.imgSrc=c;this.name=d;this.img=new Image;this.img.src=c;this.hilight=false;this.height=this.width=this.y=this.x=0};
WinTools.Resource.prototype._computeBlockBounds=function(){this.width=this.img.width;this.height=this.img.height;if(this.width>this.height){this.height=WinTools.maxImgWidth*this.height/this.width;this.width=WinTools.maxImgWidth}else{this.width=WinTools.maxImgHeight*this.width/this.height;this.height=WinTools.maxImgHeight}this.width=this.width+(resBorder+resMargin+resPadding)*2;this.height=this.height+(resBorder+resMargin+resPadding)*2};
WinTools.Resource.prototype.copy=function(){return new WinMediaAssets.DragObject(this.path,this.imgSrc,this.name)};WinTools.Resource.prototype.getChildAtPoint=function(b,c){return b>=this.x&&b<=this.x+this.width&&c>=this.y&&c<=this.y+this.height?this:null};
WinTools.Resource.prototype.draw=function(b){b.save();if(this.hilight){b.strokeStyle="#0f0";b.fillStyle="#0f0";b.shadowColor="#0f0";b.shadowBlur=20}else{b.strokeStyle="#777";b.fillStyle="rgba(0, 0, 0, .3)"}var c=this.width-(resBorder+resPadding+resMargin)*2,d=this.height-(resBorder+resPadding+resMargin)*2;b.beginPath();b.moveTo(this.x+resMargin,this.y+resMargin);b.lineTo(this.x+this.width-resMargin,this.y+resMargin);b.lineTo(this.x+this.width-resMargin,this.y+this.height-resMargin);b.lineTo(this.x+
resMargin,this.y+this.height-resMargin);b.closePath();b.fill();b.stroke();b.drawImage(this.img,this.x+resMargin+resPadding+resBorder,this.y+resMargin+resPadding+1,c,d);this.path.substring(this.path.length-6)==".actor"&&b.drawImage(WinTools.tblockTab,this.x+this.width-resMargin-WinTools.tblockTab.width,this.y+this.height-resMargin-WinTools.tblockTab.height);b.restore()};
var FocusManager={currentFocus:null,setFocus:function(b,c){FocusManager.currentFocus=b.setFocus&&b.setFocus(true,WinCode.context,findPos(WinCode.canvas),c)?b:null},clearFocus:function(){if(FocusManager.currentFocus){FocusManager.currentFocus.setFocus&&FocusManager.currentFocus.setFocus(false,WinCode.context,findPos(WinCode.canvas));FocusManager.currentFocus=null;WinCode.clearSelection()}},getFocusedElement:function(){return FocusManager.currentFocus},_onKeyPress:function(b,c){if(FocusManager.currentFocus){if(b==
38||b==40||b==37||b==39)return FocusManager.currentFocus.keyPressed(b,c);if(b==27||b==13||b==9){FocusManager.clearFocus();return true}if(FocusManager.currentFocus.keyPressed(b,c)){FocusManager.currentFocus.getRoot()._computeBlockBounds();return true}}return false}},WinCode={_scripts:[],_changeListeners:[],_saveParent:null,_convertFuncValue:!0,_convertLibValue:!0,lockedUnlockedSeparator:100,blocksSpacing:20,lockedSeparatorTop:0,rightExtreme:0,bottomExtreme:0,canvas:null,context:null,_searchIndex:0,
_allowCodeEdit:!1,_enabled:!0,_readOnly:!1,_showHidden:!1,_hilightStep:!1,_enableInspector:!1,_enableHideInSandbox:!1,_enableLockInSandbox:!1,_enableSearch:!0,_enableContextMenu:!0,_enableRun:!0,_enableDelete:!0,_enableDeleteStart:!0,_enableFieldEdit:!0,_enableDragToDelete:!0,_enableCutCopyPaste:!0,_enableDoubleClick:!0,_enableScrolling:!0,_enableSandbox:!1,_zoomMode:"static",_world:null,_worldLeft:null,_worldTop:null,_worldTimestamp:0,_worldScale:30,_worldPadding:10,_autoLayoutMethod:"box",_languages:["JavaScript"],
_defaultLang:0,_changeListeners:[],isEnabled:function(){return WinCode._enabled},enable:function(b){if(b){WinCode._enabled=true;$("#win-code").removeClass("hidden");$("#win-editor .info-bar a.code").removeClass("hidden");$("#win-editor").hasClass("hidden")&&$("#win-editor").removeClass("hidden");!WinProperties._enabled&&$("#win-editor h1").hasClass("hidden")?$("#win-editor").addClass("nodecorations"):$("#win-editor").removeClass("nodecorations")}else{WinCode._enabled=false;$("#win-code").addClass("hidden");
$("#win-editor .info-bar a.code").addClass("hidden");WinProperties._enabled?$("#win-editor h1").hasClass("hidden")&&$("#win-editor").removeClass("nodecorations"):$("#win-editor").addClass("hidden")}IDE.adjustPanels()},enableDecorations:function(b){b?$("#win-editor").removeClass("nodecorations"):$("#win-editor").addClass("nodecorations");WinProperties.adjustWindow();WinCode.adjustWindow();IDE.adjustPanels()},enableDocked:function(b){b?$("#win-editor").addClass("docked"):$("#win-editor").removeClass("docked");
WinProperties.adjustWindow();WinCode.adjustWindow();IDE.adjustPanels()},enableSandbox:function(b){WinCode._enableSandbox=b;WinCode.draw()},dockedSize:function(b){b=="minimized"?$("#win-editor").removeClass("maximized").addClass("minimized").removeClass("runmode"):b=="maximized"?$("#win-editor").addClass("maximized").removeClass("minimized").removeClass("runmode"):b=="overlay"?$("#win-editor").removeClass("maximized").removeClass("minimized").addClass("runmode"):$("#win-editor").removeClass("maximized").removeClass("minimized").removeClass("runmode");
WinProperties.adjustWindow();WinCode.adjustWindow();IDE.adjustPanels()},enableBlockView:function(b){if(b){$("#win-code .blockview").removeClass("hidden");WinTools.reset();if($("#win-code .codeview").hasClass("hidden")){$("#win-code .blockview").css("right","0px");$("#win-code .blockview .switchview").removeClass("hidden")}else{$("#win-code .codeview").css("left","50%");$("#win-code .blockview").css("right","50%");$("#win-code .blockview .switchview").addClass("hidden");$("#win-stage").outerWidth()>
250&&$("#win-stage").css("width",$("#win-stage").outerWidth()*0.6).css("height",$("#win-stage").outerHeight()*0.6);$("#win-stage").css("left",window.innerWidth-$("#win-stage").outerWidth()).css("top",window.innerHeight-$("#win-stage").outerHeight());WinStage.adjustWindow()}}else{$("#win-code .blockview").addClass("hidden");if(!$("#win-code .codeview").hasClass("hidden")){$("#win-code .codeview").css("left","0px");$("#win-code .blockview .switchview").removeClass("hidden")}}IDE.adjustPanels()},enableCodeView:function(b){if(b){WinCode._generateCode();
$("#win-code .codeview").removeClass("hidden");if($("#win-code .blockview").hasClass("hidden")){$("#win-code .codeview").css("left","0px");$("#win-code .blockview .switchview").removeClass("hidden")}else{$("#win-code .codeview").css("left","50%");$("#win-code .blockview").css("right","50%");$("#win-code .blockview .switchview").addClass("hidden");$("#win-stage").outerWidth()>250&&$("#win-stage").css("width",$("#win-stage").outerWidth()*0.6).css("height",$("#win-stage").outerHeight()*0.6);$("#win-stage").css("left",
window.innerWidth-$("#win-stage").outerWidth()).css("top",window.innerHeight-$("#win-stage").outerHeight());WinStage.adjustWindow()}}else{$("#win-code .codeview").addClass("hidden");if(!$("#win-code .blockview").hasClass("hidden")){$("#win-code .blockview").css("right","0px");$("#win-code .blockview .switchview").removeClass("hidden")}}WinCode.adjustWindow()},_generateBlocks:function(){if(WinCode._languages[WinCode._defaultLang]=="JavaScript"){var b=IDE.editingActor?IDE.editingActor:Runtime.background;
try{var c=g_parser.parse(WinCode.editor.getValue());BlockGen.generate(c);Runtime.unregisterScripts(b);var d=WinCode.context.offsetX,e=WinCode.context.offsetY,f=BlockGen.getBackground();if(f.state){var g=Sprites._broadcastSpriteListeners;Sprites._broadcastSpriteListeners=function(){};Runtime.unregisterScripts(Runtime.background);Runtime.background.update(f.state);Runtime.background.variables=f.variables;Runtime.background.lists={};Runtime.background.scripts=f.scripts;Runtime.registerScripts(Runtime.background);
Sprites._broadcastSpriteListeners=g;WinCode._scripts=Runtime.background.scripts;WinCode._editBlocks(WinCode._scripts);WinCode.relayoutBlocks()}else if(IDE.editingActor){var h=BlockGen.getAllSprites();if(h.length>0){g=Sprites._broadcastSpriteListeners;Sprites._broadcastSpriteListeners=function(){};Runtime.unregisterScripts(IDE.editingActor);IDE.editingActor.update(h[0].state);IDE.editingActor.variables=h[0].variables;IDE.editingActor.lists={};IDE.editingActor.scripts=h[0].scripts;Runtime.registerScripts(IDE.editingActor);
Sprites._broadcastSpriteListeners=g;WinCode._scripts=IDE.editingActor.scripts;WinCode._editBlocks(WinCode._scripts);WinCode.relayoutBlocks()}}WinCode.scrollTo(-d,-e)}catch(j){console.log("Parse error from "+g_parser.yy.lexer.yylloc.first_line+":"+g_parser.yy.lexer.yylloc.first_column+" to "+g_parser.yy.lexer.yylloc.last_line+":"+g_parser.yy.lexer.yylloc.last_column);console.log(j.message);console.log(j.stack)}}},_generateCode:function(){var b="",c=WinCode._languages[WinCode._defaultLang]=="Swift"?
new SwiftCodeGen:new CodeGen,b=!IDE.editingActor||IDE.editingActor==Runtime.background?b+c.generateScene(!WinCode._allowCodeEdit):b+c.generateActor(IDE.editingActor,!WinCode._allowCodeEdit),c=WinCode.editor.getSession().getScrollLeft(),d=WinCode.editor.getSession().getScrollTop(),e=WinCode.context.offsetX,f=WinCode.context.offsetY;WinCode.editor.setValue(b);if(val=RegExp(/}, function\s*\(\s*\)/g).exec(b))for(var b=val.index,g=WinCode.editor.session.getDocument().$lines,h=WinCode.editor.session.doc.getNewLineCharacter(),
j=0,k=0;k<g.length;k++){var l=WinCode.editor.session.getLine(k).length;if(j+l>=b){WinCode.editor.session.foldAll(1,k);break}j=j+(l+h.length)}WinCode.editor.clearSelection();WinCode.editor.gotoLine(0,0,false);WinCode.clearSelection();WinCode.editor.getSession().setScrollLeft(c);WinCode.editor.getSession().setScrollTop(d);WinCode.scrollTo(-e,-f)},init:function(){$("#win-code .code canvas").bind("mousewheel",WinCode.onScroll).bind("DOMMouseScroll",WinCode.onScroll);$("#win-code .zoom .zoomin").click(function(){Blocks._scale=
Blocks._scale+0.1;if(Blocks._scale>2)Blocks._scale=2;WinCode.draw();return false});$("#win-code .zoom .zoomout").click(function(){Blocks._scale=Blocks._scale-0.1;if(Blocks._scale<0.1)Blocks._scale=0.1;WinCode.draw();return false});$("#win-code .zoom .zoomfit").click(function(){WinCode.showZoomMenu();return false});WinCode.canvas=$("#win-code .code canvas")[0];WinCode.context=WinCode.canvas.getContext("2d");WinCode.canvas.width=$("#win-code").innerWidth()-(!$("#win-tools").hasClass("hidden")?$("#win-tools").outerWidth():
0)-2;WinCode.canvas.height=$("#win-code").innerHeight()-2;WinCode.canvas.width=WinCode.canvas.width*2;$(WinCode.canvas).css("width",WinCode.canvas.width/2);WinCode.canvas.height=WinCode.canvas.height*2;WinCode.context.offsetX=0;WinCode.context.offsetY=0;WinCode.context.translateX=0;WinCode.context.translateY=0;WinCode.rightExtreme=WinCode.canvas.width;WinCode.bottomExtreme=WinCode.canvas.height;$("#win-code .code canvas").mousedown(WinCode.mousedown).mouseup(WinCode.mouseup).mousemove(WinCode.mouseover);
$("#win-code .codeview a.switchview").click(function(){WinCode.enableCodeView(false);WinCode.enableBlockView(true);WinCode._generateBlocks();return false});$("#win-code .blockview a.switchview").click(function(){WinStage._isLegacyMode?WinCode.enableBlockView(false):WinCode.enableBlockView(true);WinCode.enableCodeView(true);return false});WinCode._languages.length>1&&$("#win-code .codeview a.switchlang").removeClass("hidden").click(function(){WinCode._defaultLang=(WinCode._defaultLang+1)%WinCode._languages.length;
$("#win-code .codeview a.switchlang").text(WinCode._languages[WinCode._defaultLang]);WinCode._generateCode();return false});if($("#codeview").length>0){var b=ace.require("ace/ext/language_tools");WinCode.editor=ace.edit("codeview");WinCode.editor.getSession().setMode("ace/mode/tynkerscript");WinCode.editor.renderer.setShowGutter(true);WinCode.editor.renderer.setPrintMarginColumn(false);WinCode.editor.setTheme("ace/theme/ambiance");WinCode.editor.on("change",function(){if(WinCode._codeGenTimeoutId){window.clearTimeout(WinCode._codeGenTimeoutId);
WinCode._codeGenTimeoutId=0}if(WinCode.editor.isFocused()&&!$("#win-code .blockview").hasClass("hidden"))WinCode._codeGenTimeoutId=window.setTimeout(function(){WinCode._allowCodeEdit&&WinCode._generateBlocks()},150)});WinCode.editor.getSession().selection.on("changeCursor",function(){var b=WinCode.editor.session.getTextRange({start:{column:0,row:0},end:WinCode.editor.getCursorPosition()}),c=b.length,f=RegExp(/this\s*\.\s*[a-zA-Z0-9_]+.*function\s*\(\s*\)\s*{/g),b=WinCode.editor.getValue(),g,h=0;do if(g=
f.exec(b)){var j=g.index;f.lastIndex=g.index+g[0].length;if(j>c)break;h++}while(g);if(WinCode._scripts.length>0&&h>=0&&h<=WinCode._scripts.length){--h<0&&(h=0);c=WinCode._sortScripts(WinCode._scripts);b=-c[h].x+(WinCode.canvas.width-c[h].width)/2;b>0&&(b=0);h=-c[h].y+20;h>0&&(h=0);WinCode.scrollTo(-b,-h,true,function(){})}});WinCode.editor.setOptions({enableBasicAutocompletion:true,enableSnippets:true});WinCode.setCodeReadOnly(!WinCode._allowCodeEdit);var c=ace.require("ace/autocomplete/util");ID_REGEX=
/[a-zA-Z_0-9\$-\.]/;c.retrievePrecedingIdentifier=function(b,c,f){for(var f=f||ID_REGEX,g=[],c=c-1;c>=0;c--)if(f.test(b[c]))g.push(b[c]);else break;return g.reverse().join("")};c.retrieveFollowingIdentifier=function(b,c,f){for(var f=f||ID_REGEX,g=[];c<b.length;c++)if(f.test(b[c]))g.push(b[c]);else break;return g};b.addCompleter({getCompletions:function(b,c,f,g,h){var j=[];if(g){g_fnCompletion.forEach(function(b){b.indexOf(g)>=0&&j.push({name:b,value:b,score:1,meta:"library"})});g_builtinsCompletion.forEach(function(b){b.indexOf(g)>=
0&&j.push({name:b,value:b,score:1,meta:"library"})})}h(null,j)}})}if(window.RenderCode){$(".code-selector li.tynker").on("click",function(b){RenderCode.setCodeType("tynker");b.preventDefault();return false});$(".code-selector li.javascript").on("click",function(b){RenderCode.setCodeType("javascript");b.preventDefault();return false});$(".code-selector li.python").on("click",function(b){RenderCode.setCodeType("python");b.preventDefault();return false});$(".code-selector li.swift").on("click",function(b){RenderCode.setCodeType("swift");
b.preventDefault();return false})}WinCode._world=new b2World(new b2Vec2(0,0),true);WinCode._autoLayoutMethod=="box"?WinCode.updateSimulation(true):WinCode._autoLayoutMethod=="linear"&&WinCode.relayoutBlocks(false,true)},updateSimulation:function(b){var c=Date.now();WinCode._world.Step((c-WinCode._worldTimestamp)/1E3,10,10);WinCode._worldTimestamp=c;WinCode._world.ClearForces();for(var c=false,d=WinCode._world.GetBodyList();d;){if(b===true||d.IsAwake()&&d.IsActive()){var e=d.GetUserData();if(e&&WinCode._scripts.indexOf(e)>=
0){b===true&&d.SetAwake(true);var c=true,f=d.GetPosition();e.x=f.x*WinCode._worldScale-e.getMaxWidth()/2;e.y=f.y*WinCode._worldScale-(e.totalHeight?e.totalHeight:e.height)/2;e._computeBounds()}}d=d.GetNext()}WinCode.draw();c&&window.setTimeout(WinCode.updateSimulation,1E3/30)},addBody:function(b){var c=new b2BodyDef;c.type=b2Body.b2_dynamicBody;c.fixedRotation=true;c.position.x=(b.x+b.getMaxWidth()/2)/this._worldScale;c.position.y=(b.y+(b.totalHeight?b.totalHeight:b.height)/2)/this._worldScale;c.angle=
0;c.userData=b;var d=new b2FixtureDef;d.density=1;d.friction=1;d.restitution=0.2;d.shape=new b2PolygonShape;d.shape.SetAsBox((b.getMaxWidth()+this._worldPadding)/this._worldScale/2,((b.totalHeight?b.totalHeight:b.height)+this._worldPadding)/this._worldScale/2);c=this._world.CreateBody(c);c.CreateFixture(d);b=b.getRoot();b instanceof Block&&!b.hasFlap?c.SetActive(true):c.SetActive(false);WinCode._autoLayoutMethod=="box"?WinCode.updateSimulation(true):WinCode._autoLayoutMethod=="linear"&&WinCode.relayoutBlocks(false,
true)},updateWorldBody:function(b,c){for(var d=[],e=this._world.GetBodyList();e;){var f=e.GetUserData();if(f){var g=f.getRoot();if(g instanceof Block&&!g.hasFlap){e.SetActive(true);e.SetAwake(true)}else{e.SetActive(false);e.SetAwake(false)}for(var g=false,h=0;h<this._scripts.length;h++)if(this._scripts[h]==f){g=true;break}g||d.push(e);f&&(b&&b==f)&&d.push(e)}e=e.GetNext()}for(h=0;h<d.length;h++)this._world.DestroyBody(d[h]);if(!(b instanceof Block&&b.func=="blockComment")){e=new b2BodyDef;e.type=
b2Body.b2_dynamicBody;e.fixedRotation=true;e.position.x=(b.x+b.getMaxWidth()/2)/this._worldScale;e.position.y=(b.y+(b.totalHeight?b.totalHeight:b.height)/2)/this._worldScale;e.angle=0;e.userData=b;d=new b2FixtureDef;d.density=1;d.friction=1;d.restitution=0.2;d.shape=new b2PolygonShape;d.shape.SetAsBox((b.getMaxWidth()+this._worldPadding)/this._worldScale/2,((b.totalHeight?b.totalHeight:b.height)+this._worldPadding)/this._worldScale/2);e=this._world.CreateBody(e);e.CreateFixture(d);g=b.getRoot();g instanceof
Block&&!g.hasFlap?e.SetActive(true):e.SetActive(false)}c||(WinCode._autoLayoutMethod=="box"?WinCode.updateSimulation(true):WinCode._autoLayoutMethod=="linear"&&WinCode.relayoutBlocks(false,true))},flashBlocks:function(b,c){if(c>=0){b.setSelected(!b.showSelected,true);WinCode.draw();window.setTimeout(function(){WinCode.flashBlocks(b,c-1)},100)}},exportScript:function(){for(var b='<!DOCTYPE html>\n<html>\n<head>\n    <link href="/css/reset.css" rel="stylesheet"/>\n    <link href="ide/css/player.css" rel="stylesheet"/>\n    <script src="ide/code/runtime.js"><\/script>\n    <script src="ide/js/characters?t=standalone"><\/script>\n<script type="text/javascript">\n',
c=new CodeGen,b=b+c.generateScene(),d=0;d<Runtime.sprites.length;d++){c.reset();b=b+c.generateActor(Runtime.sprites[d])}b=b+"<\/script>\n</head>\n<body>\n</body>\n</html>\n";c=$("#importexportdlg");c.find("textarea").val(b);c.find(".importBtn").addClass("hidden");c.find(".cancelBtn").unbind().click(function(){$.modal.close();return false});c.modal()},importScript:function(){var b=$("#importexportdlg");b.find("textarea").val("");b.find(".importBtn").removeClass("hidden").unbind().click(function(){IDE.Clipboard.clear();
var b=$("#importexportdlg textarea").val();IDE.setTitle(null);IDE.reset();Runtime.reset();try{var d=g_parser.parse(b);BlockGen.generate(d);var e=BlockGen.getBackground();Runtime.background.update(e.state);Runtime.background.variables=e.variables;Runtime.background.lists={};Runtime.background.scripts=e.scripts;Runtime.registerScripts(Runtime.background);WinCode._scripts=Runtime.background.scripts;WinCode.relayoutBlocks();var f=BlockGen.getAllSprites(),g=f.length;f.forEach(function(b){Sprites.addSprite({},
function(c){c.update(b.state,function(c){c.variables=b.variables;c.lists={};c.scripts=b.scripts;Runtime.registerScripts(c);WinCode._scripts=c.scripts;WinCode.relayoutBlocks();--g<=0&&IDE.selectAsset(null)})})});g||IDE.selectAsset(null)}catch(h){console.log("Parse error from "+g_parser.yy.lexer.yylloc.first_line+":"+g_parser.yy.lexer.yylloc.first_column+" to "+g_parser.yy.lexer.yylloc.last_line+":"+g_parser.yy.lexer.yylloc.last_column);console.log(h);console.log("parse error");console.log(h.message);
console.log(h.stack);b=$('<textarea style="display:block;position:absolute;top:10px;left:10px;"></textarea>');b.text("Parse error from "+g_parser.yy.lexer.yylloc.first_line+":"+g_parser.yy.lexer.yylloc.first_column+" to "+g_parser.yy.lexer.yylloc.last_line+":"+g_parser.yy.lexer.yylloc.last_column+"\n\n"+h.message);b.css("height",window.innerHeight-20).css("width",window.innerWidth-20);$("body").append(b)}$.modal.close();return false});b.find(".cancelBtn").unbind().click(function(){$.modal.close();
return false});b.modal();return false},setReadOnly:function(b){(WinCode._readOnly=b)?$("#win-editor").css("pointer-events","none"):$("#win-editor").css("pointer-events","auto")},setCodeReadOnly:function(b){WinCode._allowCodeEdit=!b;if(WinCode._allowCodeEdit){$("#codeview").removeClass("noselection");if(WinCode.editor){WinCode.editor.setReadOnly(false);WinCode.editor.setHighlightActiveLine(true)}}else{$("#codeview").addClass("noselection");if(WinCode.editor){WinCode.editor.setReadOnly(true);WinCode.editor.setHighlightActiveLine(false)}}},
_handleShowSearch:function(b){if(b.keyCode==13||(b.metaKey||b.ctrlKey)&&b.which==70){var c=$(this).val();if(c!=WinCode._searchTerm){WinCode._searchIndex=0;WinCode._searchTerm=c;c=WinCode.searchBlock(WinCode._searchTerm,0)}else{WinCode._searchIndex++;(c=WinCode.searchBlock(WinCode._searchTerm,WinCode._searchIndex))||WinCode._searchIndex--}WinCode.clearSelection();FocusManager.clearFocus();if(c){c.setSelected(true,false);WinCode.centerBlock(c);c instanceof LabelInput&&FocusManager.setFocus(c);WinCode.draw()}b.preventDefault();
b.stopPropagation();return true}},_hasPreviousSearch:function(){return WinCode._searchIndex>0},_hasNextSearch:function(){return WinCode._searchIndex<WinCode._codeCount-1},_getSearchIndex:function(){return WinCode._searchIndex},_getTotalCount:function(){return WinCode._codeCount},_handlePreviousSearch:function(){WinCode._searchIndex--;if(WinCode._searchIndex<0)WinCode._searchIndex=0;else{if(!WinCode._searchTerm){WinCode._searchIndex=0;WinCode._searchTerm=$("#win-tools .search input").val()}var b=WinCode.searchBlock(WinCode._searchTerm,
WinCode._searchIndex);if(b){WinCode.clearSelection();FocusManager.clearFocus();b.setSelected(true,false);WinCode.centerBlock(b);b instanceof LabelInput&&FocusManager.setFocus(b);WinCode.draw()}}return false},_handleNextSearch:function(){WinCode._searchIndex++;if(!WinCode._searchTerm){WinCode._searchIndex=0;WinCode._searchTerm=$("#win-tools .search input").val()}var b=WinCode.searchBlock(WinCode._searchTerm,WinCode._searchIndex);if(b){WinCode.clearSelection();FocusManager.clearFocus();b.setSelected(true,
false);WinCode.centerBlock(b);b instanceof LabelInput&&FocusManager.setFocus(b);WinCode.draw()}else WinCode._searchIndex--;return false},reset:function(){FocusManager.clearFocus();WinCode._scripts=[];WinCode.context.offsetX=0;WinCode.context.offsetY=0;WinCode.draw()},adjustWindow:function(){if(WinCode.canvas){var b=$("#win-code .code").innerHeight();WinCode.canvas.width=$("#win-code .code").innerWidth()*2;$(WinCode.canvas).css("width",WinCode.canvas.width/2);$("#win-code .infobar").length>0&&(b=b-
$("#win-code .infobar").outerHeight());WinCode.canvas.height=b*2;WinCode.rightExtreme=WinCode.canvas.width;WinCode.bottomExtreme=WinCode.canvas.height;WinCode._getScrollBounds();$("#win-code .trash").addClass("hidden");if(WinCode._zoomMode=="width"){var b=WinCode.rightExtreme,c=WinCode.bottomExtreme,d=WinCode.canvas.width/2,e=WinCode.canvas.height/2;WinCode.context.offsetX=0;WinCode.context.offsetY=0;if(b<=d)Blocks._scale=1;else{Blocks._scale=d/b;if(Blocks._scale>1)Blocks._scale=1}}else if(WinCode._zoomMode==
"all"){b=WinCode.rightExtreme;c=WinCode.bottomExtreme;d=WinCode.canvas.width/2;e=WinCode.canvas.height/2;WinCode.context.offsetX=0;WinCode.context.offsetY=0;if(b<=d&&c<=e)Blocks._scale=1;else{Blocks._scale=d/b;if(c*Blocks._scale>e)Blocks._scale=e/c;if(Blocks._scale>1)Blocks._scale=1}}WinCode.draw()}},show:function(){$("#win-editor a.tabbutton").removeClass("selected");$("#win-editor a.code").addClass("selected")},hide:function(){},computeAll:function(){for(var b=0;b<WinCode._scripts.length;b++)WinCode._scripts[b]._computeBounds();
WinCode._getScrollBounds()},scrollTo:function(b,c,d,e){b<0&&(b=0);c<0&&(c=0);var f=WinCode.rightExtreme+WinCode.canvas.width/2,g=WinCode.bottomExtreme+WinCode.canvas.height/2;if(d){var h=WinCode.context.offsetX,j=WinCode.context.offsetY,k=-b,l=-c;k>0&&(k=0);f>WinCode.canvas.width?f+k<WinCode.canvas.width&&(k=WinCode.canvas.width-f):k=0;l>0&&(l=0);g>WinCode.canvas.height?g+l<WinCode.canvas.height&&(l=WinCode.canvas.height-g):l=0;animate(250,function(b,c){WinCode.context.offsetX=h+(k-h)*b/c;WinCode.context.offsetY=
j+(l-j)*b/c;WinCode.draw()},e)}else{WinCode.context.offsetX=-b;WinCode.context.offsetY=-c;if(WinCode.context.offsetX>0)WinCode.context.offsetX=0;if(f>WinCode.canvas.width){if(f+WinCode.context.offsetX<WinCode.canvas.width)WinCode.context.offsetX=WinCode.canvas.width-f}else WinCode.context.offsetX=0;if(WinCode.context.offsetY>0)WinCode.context.offsetY=0;if(g>WinCode.canvas.height){if(g+WinCode.context.offsetY<WinCode.canvas.height)WinCode.context.offsetY=WinCode.canvas.height-g}else WinCode.context.offsetY=
0;WinCode.draw();e&&e()}},centerBlock:function(b,c){var d=-b.x+(WinCode.canvas.width-b.width)/2;d>0&&(d=0);d<-b.x&&(d=-b.x);var e=-b.y+(WinCode.canvas.height-b.height)/2;e>0&&(e=0);e<-b.y&&(e=-b.y);WinCode.scrollTo(-d,-e,false,c)},showAnnotation:function(b,c,d){WinCode.centerBlock(b,function(){var e=$("#win-code .code canvas");IDE.showAnnotation({pos:{x:e.offset().left+WinCode.context.offsetX+b.x,y:e.offset().top+WinCode.context.offsetY+b.y,width:b.width,height:b.height},closeCallback:d,preferOffset:30,
text:c})})},findBlankSpace:function(){var b={};if(WinCode._scripts.length>0){b.x=20;b.y=WinCode.bottomExtreme}else{b.x=20;b.y=20}return b},findSelected:function(b){if(b){if(b.showSelected)return b;if(b instanceof Block){if(b.label)if(d=WinCode.findSelected(b.label))return d;for(c=0;c<b._containers.length;c++)if(b._containers[c]!=null)if(d=WinCode.findSelected(b._containers[c]))return d;if(b.next!=null)if(d=WinCode.findSelected(b.next))return d}else if(b instanceof Label)for(c=0;c<b._children.length;c++){if(b._children[c]!=
null)if(d=WinCode.findSelected(b._children[c]))return d}else if(b instanceof LabelInput&&b._child!=null)if(d=WinCode.findSelected(b._child))return d}else for(var c=0;c<WinCode._scripts.length;c++){var d=WinCode.findSelected(WinCode._scripts[c]);if(d)return d}return null},findEndSelected:function(b){if(b instanceof Block){for(var c=0;c<b._containers.length;c++)if(b._containers[c]!=null){var d=WinCode.findEndSelected(b._containers[c]);if(d)return d}if(b.next!=null&&b.next.showSelected)if(d=WinCode.findEndSelected(b.next))return d}else if(b instanceof
Label)for(c=0;c<b._children.length;c++){if(b._children[c]!=null)if(d=WinCode.findEndSelected(b._children[c]))return d}else if(b instanceof LabelInput&&b._child!=null)if(d=WinCode.findEndSelected(b._child))return d;return b},hilightBlock:function(b,c){FocusManager.clearFocus();b!=null&&WinCode.centerBlock(b,c);for(var d=0;d<WinCode._scripts.length;d++)WinCode._hilightBlock(WinCode._scripts[d],b);WinCode.draw()},_hilightBlock:function(b,c){b.hilight=b==c?true:false;if(b instanceof Block){WinCode._hilightBlock(b.label,
c);for(var d=0;d<b._containers.length;d++)b._containers[d]!=null&&WinCode._hilightBlock(b._containers[d],c);b.next!=null&&WinCode._hilightBlock(b.next,c)}else if(b instanceof Label)for(d=0;d<b._children.length;d++)WinCode._hilightBlock(b._children[d],c);else b instanceof LabelInput&&b._child!=null?WinCode._hilightBlock(b._child,c):b==c&&WinCode._enableFieldEdit&&FocusManager.setFocus(b)},findBlockWithId:function(b){for(var c=WinCode._scripts.length-1;c>=0;c--){var d=Blocks.findBlockWithId(WinCode._scripts[c],
b);if(d!=null)return d}return null},_doAssignIds:function(b){if(b instanceof Block){if(!b.id)b.id=WinLessons._getId();WinCode._doAssignIds(b.label);for(var c=0;c<b._containers.length;c++)b._containers[c]!=null&&WinCode._doAssignIds(b._containers[c]);b.next!=null&&WinCode._doAssignIds(b.next)}else if(b instanceof Label){if(!b.id&&(!b.parent||!(b.parent instanceof Block)))b.id=WinLessons._getId();for(c=0;c<b._children.length;c++)WinCode._doAssignIds(b._children[c])}else b instanceof LabelInput&&b._child!=
null&&WinCode._doAssignIds(b._child)},_assignIds:function(){WinLessons.initializeLargestId();for(var b=0;b<Runtime.background.scripts.length;b++)WinCode._doAssignIds(Runtime.background.scripts[b]);for(b=0;b<Runtime.sprites.length;b++)for(var c=Runtime.sprites[b].scripts,d=0;d<c.length;d++)WinCode._doAssignIds(c[d])},countSearch:function(b){WinCode._codeCount=0;if(b=$.trim(b))for(;WinCode.searchBlock(b,WinCode._codeCount);)WinCode._codeCount++;return WinCode._codeCount},searchBlock:function(b,c){for(var b=
b.toLowerCase(),d=[0],e=WinCode._scripts.length-1;e>=0;e--){var f=WinCode._searchBlock(WinCode._scripts[e],b,c,d);if(f!=null)return f}return null},_searchBlock:function(b,c,d,e){if(b){var f=g_steps[b.func];if(f)if((""+f.label).toLowerCase().indexOf(c)>=0){if(d==e[0])return b;e[0]++}else{if(f.cat.indexOf(c)>=0){if(d==e[0])return b;e[0]++}}else if(b.name&&b.name.indexOf(c)>=0){if(d==e[0])return b;e[0]++}if(b instanceof Block){f=WinCode._searchBlock(b.label,c,d,e);if(f!=null){if(d==e[0])return f;e[0]++}for(var g=
0;g<b._containers.length;g++){f=WinCode._searchBlock(b._containers[g],c,d,e);if(f!=null){if(d==e[0])return f;e[0]++}}if(b.next!=null){f=WinCode._searchBlock(b.next,c,d,e);if(f!=null){if(d==e[0])return f;e[0]++}}}else if(b instanceof Label)for(g=0;g<b._children.length;g++){f=WinCode._searchBlock(b._children[g],c,d,e);if(f!=null){if(d==e[0])return f;e[0]++}}else if(b instanceof LabelInput)if(b._child!=null){f=WinCode._searchBlock(b._child,c,d,e);if(f!=null){if(d==e[0])return f;e[0]++}}else if((""+b.label).toLowerCase().indexOf(c)>=
0){if(d==e[0])return b;e[0]++}}return null},_makeLocalVarIfMissing:function(b){if((b=$.trim(b))&&b!="_empty_"){var c=IDE.editingActor?IDE.editingActor:Runtime.background,d=false;c.variables[b]!==void 0&&(d=true);!d&&(c!=Runtime.background&&Runtime.background.variables[b]!==void 0)&&(d=true);d||(c.variables[b]="")}},_makeLocalListIfMissing:function(b){if((b=$.trim(b))&&b!="_empty_"){var c=IDE.editingActor?IDE.editingActor:Runtime.background,d=false;c.lists[b]!==void 0&&(d=true);!d&&(c!=Runtime.background&&
Runtime.background.lists[b]!==void 0)&&(d=true);d||(c.lists[b]=[])}},isScriptVariable:function(b,c){if(b){if(b.func=="blockControlScriptVar")for(var d=b.label.getNumSockets(),e=0;e<d;e++){var f=b.label.getSocketAtChild(e);if(f._child&&f._child.name==c)return true}if(b._containers)for(e=0;e<b._containers.length;e++)if(WinCode.isScriptVariable(b._containers[e],c))return true;if(WinCode.isScriptVariable(b.next,c))return true}return false},_ensureVarExists:function(){},refresh:function(){for(var b=0;b<
WinCode._scripts.length;b++)WinCode._scripts[b]._computeBounds();WinCode.draw()},reRender:function(){for(var b=0;b<WinCode._scripts.length;b++){var c=WinCode._scripts[b];c.hidden||c.reRender()}WinCode.draw()},draw:function(){WinCode.context.mozImageSmoothingEnabled=false;WinCode.context.clearRect(0,0,WinCode.canvas.width,WinCode.canvas.height);WinCode.context.font=defaultLabelFontWeight+" "+defaultLabelFontSize+"px "+defaultLabelFont;WinCode.context.save();WinCode.context.scale(Blocks._scale*2,Blocks._scale*
2);WinCode.context.translate(WinCode.context.offsetX+0.5,WinCode.context.offsetY+0.5);for(var b=0;b<WinCode._scripts.length;b++)if(!WinCode._enableSandbox||!WinCode._scripts[b].hiddenInSandbox)WinCode._scripts[b].hidden||WinCode._scripts[b].draw(WinCode.context);WinCode.context.restore()},drawExclude:function(b){WinCode.context.clearRect(0,0,WinCode.canvas.width,WinCode.canvas.height);WinCode.context.save();WinCode.context.translate(WinCode.context.offsetX+0.5,WinCode.context.offsetY+0.5);for(var c=
0;c<this._scripts.length;c++)WinCode._scripts[c]!=b&&WinCode._scripts[c].draw(WinCode.context);WinCode.context.restore()},editBlocksForSprite:function(b){var c=false;if(b!=null){if(b.scripts!=WinCode._scripts){WinCode.reset();WinCode._scripts=b.scripts;c=true}WinCode._editBlocks(b.scripts)}else{if(Runtime.background.scripts!=WinCode._scripts){WinCode.reset();WinCode._scripts=Runtime.background.scripts;c=true}WinCode._editBlocks(Runtime.background.scripts)}if(c)if($("#win-code .codeview:visible").length>
0&&$("#win-code .blockview:visible"))WinCode._generateCode();else{$("#win-code .codeview").addClass("hidden").css("left","0px");$("#win-code .blockview").removeClass("hidden").css("right","0px")}WinCode.draw()},_editBlocks:function(b){WinCode.clearSelection();WinCode.reset();WinCode._scripts=b;for(var c=0;c<b.length;c++)b[c]._computeBounds();$("#win-code .code canvas").outerHeight();WinCode._getScrollBounds();WinCode.draw();this._world=new b2World(new b2Vec2(0,0),true);this._worldTimestamp=Date.now();
var d=new b2BodyDef;d.type=b2Body.b2_staticBody;d.fixedRotation=true;d.position.x=0;d.position.y=0;d.angle=0;c=new b2FixtureDef;c.density=1;c.friction=0.5;c.restitution=0.2;c.shape=new b2PolygonShape;c.shape.SetAsBox(2E7/WinCode._worldScale,1/WinCode._worldScale);d.position.Set(2E6/WinCode._worldScale/2,0);var e=WinCode._world.CreateBody(d);e.CreateFixture(c);e.SetActive(true);c.shape.SetAsBox(1/WinCode._worldScale,2E7/WinCode._worldScale);d.position.Set(0,2E6/WinCode._worldScale/2);d=WinCode._world.CreateBody(d);
d.CreateFixture(c);d.SetActive(true);WinCode._scripts=b;for(c=0;c<b.length;c++){d=b[c];!d.hidden&&(!d.hiddenInSandbox&&!(d instanceof Block&&d.func=="blockComment"))&&WinCode.addBody(b[c])}},onScroll:function(b){var c=WinCode.rightExtreme+WinCode.canvas.width/2,d=WinCode.bottomExtreme+WinCode.canvas.height/2;if(WinCode._enableScrolling&&$("div.choice-chooser:visible").length==0){b.preventDefault();b=getScrollVectors(b);WinCode.context.offsetX=WinCode.context.offsetX+b.x;if(WinCode.context.offsetX>
0)WinCode.context.offsetX=0;if(c>WinCode.canvas.width){if(c+WinCode.context.offsetX<WinCode.canvas.width)WinCode.context.offsetX=WinCode.canvas.width-c}else WinCode.context.offsetX=0;WinCode.context.offsetY=WinCode.context.offsetY+b.y;if(WinCode.context.offsetY>0)WinCode.context.offsetY=0;if(d>WinCode.canvas.height){if(d+WinCode.context.offsetY<WinCode.canvas.height)WinCode.context.offsetY=WinCode.canvas.height-d}else WinCode.context.offsetY=0;WinCode.draw()}},_getScrollBounds:function(){var b=WinCode.findExtremes(true,
true);WinCode.rightExtreme=b.right+50;WinCode.bottomExtreme=b.bottom+50},_findExtremes:function(b,c,d){var e=d.x,f=d.y,g=d.x+d.width,h=d.y+d.height;if(d instanceof Block){for(var j=0;j<d._containers.length;j++)if(d._containers[j]!=null){var k=WinCode._findExtremes(b,c,d._containers[j]);if(k.left<e)e=k.left;if(k.right>g)g=k.right;if(k.top<f)f=k.top;if(k.bottom>h)h=k.bottom}if(d.next!=null){k=WinCode._findExtremes(b,c,d.next);if(k.left<e)e=k.left;if(k.right>g)g=k.right;if(k.top<f)f=k.top;if(k.bottom>
h)h=k.bottom}}return{left:e,right:g,top:f,bottom:h}},findExtremes:function(b,c){var d=1E7,e=1E7,f=0,g=0;if(WinCode._scripts.length>0)for(var h=0;h<WinCode._scripts.length;h++){if(c&&WinCode._scripts[h].hidden||b&&!WinCode._scripts[h].hidden){var j=WinCode._findExtremes(b,c,WinCode._scripts[h]);if(j.left<e)e=j.left;if(j.right>f)f=j.right;if(j.top<d)d=j.top;if(j.bottom>g)g=j.bottom}}else e=d=0;return{left:e,right:f,top:d,bottom:g}},_sortScripts:function(b){for(var c=[],d=0;d<b.length;d++)c.push({block:b[d],
bounds:WinCode._findExtremes(true,true,b[d])});c.sort(function(b,c){return(b.block.hidden||b.block.hiddenInSandbox)&&(!c.block.hidden||!c.block.hiddenInSandbox)?1:(!b.block.hidden||!b.block.hiddenInSandbox)&&(c.block.hidden||c.block.hiddenInSandbox)?-1:b.block.value&&!c.block.value?1:!b.block.value&&c.block.value?-1:b.block.hasFlap&&!c.block.hasFlap?1:!b.block.hasFlap&&c.block.hasFlap||b.block.y<c.block.y?-1:b.block.y>c.block.y?1:b.block.x<c.block.x?-1:b.block.y>c.block.y?1:0});b=[];for(d=0;d<c.length;d++)b.push(c[d].block);
return b},relayoutBlocks:function(b,c){IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);var d=[],d=WinCode._scripts;b||(d=WinCode._sortScripts(WinCode._scripts));for(var e=WinCode.blocksSpacing*2,f=0;f<d.length;f++){var g=d[f];if(!(g instanceof Block&&g.func=="blockComment")&&(!c||g instanceof Block&&!g.hasFlap)){g.x=WinCode.blocksSpacing*2;g.y=e;g._computeBounds();WinCode.updateWorldBody(g,true);e=e+(WinCode.blocksSpacing+(g.totalHeight?g.totalHeight:g.height))}}WinCode.draw();
WinCode._getScrollBounds();WinCode.scrollTo(-WinCode.context.offsetX,-WinCode.context.offsetY);IDE.dirty();WinCode._autoLayoutMethod=="box"&&WinCode.updateSimulation(true)},setLayoutMethod:function(b){switch(b){case "none":WinCode._autoLayoutMethod="none";break;case "box":WinCode._autoLayoutMethod="box";WinCode.updateSimulation(true);break;case "linear":WinCode._autoLayoutMethod="linear";WinCode.relayoutBlocks(false,true)}},adjustBlocks:function(b,c,d,e){for(var f=0;f<WinCode._scripts.length;f++)if(e&&
WinCode._scripts[f].hidden||d&&!WinCode._scripts[f].hidden){var g=WinCode._scripts[f];g.x=g.x+b;g.y=g.y+c;g._computeBounds();for(var h=this._world.GetBodyList();h;){var j=h.GetUserData();if(j&&j==g){h.SetTransform({position:new b2Vec2(g.x/WinCode._worldScale,g.y/Blocks._scale),GetAngle:function(){return 0}});break}h=h.GetNext()}}WinCode.draw()},addChangeListener:function(b){WinCode._changeListeners.indexOf(b)<0&&WinCode._changeListeners.push(b)},removeChangeListener:function(b){b=WinCode._changeListeners.indexOf(b);
b>=0&&WinCode._changeListeners.splice(b,1)},removeAllChangeListeners:function(){WinCode._mouseListeners=[]},_broadcastChange:function(b,c){b=="valueChange"&&IDE.dirty();for(var d=0;d<WinCode._changeListeners.length;d++)WinCode._changeListeners[d](b,c);!WinCode.editor.isFocused()&&!$("#win-code .codeview").hasClass("hidden")&&WinCode._generateCode()},getBlockAt:function(b,c){for(var d,e=WinCode._scripts.length-1;e>=0;e--)if(!WinCode._scripts[e].hidden&&(!WinCode._enableSandbox||!WinCode._scripts[e].hiddenInSandbox)){d=
WinCode._scripts[e].getChildAtPoint(b/Blocks._scale-WinCode.context.offsetX,c/Blocks._scale-WinCode.context.offsetY);if(d!=null)return d}return null},showContextMenu:function(b,c,d,e){WinCode._mousedown=false;WinCode._scrolling=null;WinCode._resizing=null;if(!WinCode._readOnly&&WinCode._enableContextMenu){$(".choice-chooser").detach();var f=b,g=c,b=$('<div class="choice-chooser"><ul></ul></div>');$("body").append(b);b=b.find("ul");c=$("<li>"+g_loc.getText("menu.addannotation")+"</li>");c.click(function(){$(".choice-chooser").detach();
WinAnnotation.isVisible||WinAnnotation.show();WinAnnotation.switchEditMode();var b=WinCode.findSelected();if(b){IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);b.detachSelected();var c=$('<p><a class="link" href="#"></a></p>');!IDE.editingActor||IDE.editingActor==Runtime.background?c.find("a").attr("data-stage","Stage"):IDE.editingActor&&c.find("a").attr("data-actor",IDE.editingActor.label);b instanceof Block?c.find("a").attr("data-block",JSON.stringify(ObjectIO.genScriptObj(b))):
b instanceof Label&&c.find("a").attr("data-block",JSON.stringify(ObjectIO.genValueObj(b)));c.find("a").attr("data-blockid",b.id);c.find("a").attr("data-endblockid",WinAnnotation._getLastBlock(b).id);var d=b.x,e=b.y;b.x=0;b.y=0;b.showDragHandle=false;b.setSelected(false,true);b._computeBounds();c.find("a").append($(b.getImage()));b.x=d;b.y=e;b._computeBounds();WinAnnotation.addNote(c);IDE.Clipboard.doUndo()}else WinAnnotation.addNote("")});b.append(c);c=$("<li>"+g_loc.getText("menu.rearrange")+"</li>");
c.click(function(){$(".choice-chooser").detach();WinCode.relayoutBlocks()});b.append(c);c=$('<li class="disabled">'+g_loc.getText("menu.edit")+"</li>");if(e&&e.func=="registerFunction")c.removeClass("disabled").click(function(){$(".choice-chooser").detach();WinTools.cmdEditFunction(e)});else if(e&&e.func=="blockControlScriptVar")c.removeClass("disabled").click(function(){$(".choice-chooser").detach();WinTools.cmdEditScriptVars(e)});else if(e&&e.func=="blockControlCall")for(d=0;d<WinCode._scripts.length;d++){if(WinCode._scripts[d].func==
"registerFunction"&&WinCode._scripts[d].name==e.name){var h=WinCode._scripts[d];c.removeClass("disabled").click(function(){$(".choice-chooser").detach();WinTools.cmdEditFunction(h)});break}}else if(e&&e.func=="valueParam"){if(e.parent instanceof LabelInput&&e.parent.parent instanceof Label&&e.parent.parent.parent instanceof Block&&e.parent.parent.parent.func=="registerFunction"){h=e.parent.parent.parent;c.removeClass("disabled").click(function(){$(".choice-chooser").detach();WinTools.cmdEditFunction(h)})}}else if(e&&
e.func=="valueScriptVar"&&e.parent instanceof LabelInput&&e.parent.parent instanceof Label&&e.parent.parent.parent instanceof Block&&e.parent.parent.parent.func=="blockControlScriptVar"){h=e.parent.parent.parent;c.removeClass("disabled").click(function(){$(".choice-chooser").detach();WinTools.cmdEditScriptVars(h)})}b.append(c);c=$('<li class="disabled">'+g_loc.getText("menu.cut")+"<span>ctrl-x</span></li>");e&&c.removeClass("disabled").click(function(){$(".choice-chooser").detach();WinCode.cutSelection()});
b.append(c);c=$('<li class="disabled">'+g_loc.getText("menu.copy")+"<span>ctrl-c</span></li>");e&&c.removeClass("disabled").click(function(){$(".choice-chooser").detach();WinCode.copySelection()});b.append(c);c=$('<li class="disabled">'+g_loc.getText("menu.paste")+"<span>ctrl-v</span></li>");IDE.Clipboard.get("blocks")&&c.removeClass("disabled").click(function(){$(".choice-chooser").detach();var b=findPos(WinCode.canvas);f=f-(b.left+WinCode.context.offsetX);g=g-(b.top+WinCode.context.offsetY);WinCode.pasteSelection({x:f,
y:g})});b.append(c);if(e){c=$("<li>Tag</li>");c.click(function(){$(".choice-chooser").detach();WinCode.tagBlock(e)});b.append(c)}if(e&&WinCode._enableInspector){c=$("<li>Inspect Script</li>");c.click(function(){$(".choice-chooser").detach();WinCode.inspectBlock(e)});b.append(c)}if(e&&WinCode._enableHideInSandbox){c=e.hiddenInSandbox?$("<li>Show in Sandbox</li>"):$("<li>Hide in Sandbox</li>");c.click(function(){$(".choice-chooser").detach();WinCode.toggleHideInSandbox(e)});b.append(c)}if(e&&WinCode._enableLockInSandbox){c=
e.lockedInSandbox?$("<li>Unlock in Sandbox</li>"):$("<li>Lock in Sandbox</li>");c.click(function(){$(".choice-chooser").detach();WinCode.toggleLockInSandbox(e)});b.append(c)}b=b.parent();b.css("left",f);if(g+b.outerHeight()>window.innerHeight)if(g-b.outerHeight()>0)b.css("top",g-b.outerHeight());else{c=$(".toolbar-top").outerHeight()+windowPadding;if(g-c>window.innerHeight-g){b.css("top",c);b.css("height",g-c)}else{b.css("top",g);b.css("height",window.innerHeight-g)}}else b.css("top",g)}},showZoomMenu:function(){WinCode._mousedown=
false;WinCode._scrolling=null;WinCode._resizing=null;$(".choice-chooser").detach();var b=$('<div class="choice-chooser"><ul></ul></div>');$("body").append(b);var b=b.find("ul"),c=$("<li>10%</li>");c.click(function(){$(".choice-chooser").detach();Blocks._scale=0.1;WinCode.draw();return false});b.append(c);c=$("<li>25%</li>");c.click(function(){$(".choice-chooser").detach();WinCode._zoomMode="static";Blocks._scale=0.25;WinCode.draw();return false});b.append(c);c=$("<li>50%</li>");c.click(function(){$(".choice-chooser").detach();
WinCode._zoomMode="static";Blocks._scale=0.5;WinCode.draw();return false});b.append(c);c=$("<li>75%</li>");c.click(function(){$(".choice-chooser").detach();WinCode._zoomMode="static";Blocks._scale=0.75;WinCode.draw();return false});b.append(c);c=$('<li><span class="icon-checkbox-unchecked"></span> 100%</li>');c.click(function(){$(".choice-chooser").detach();WinCode._zoomMode="static";Blocks._scale=1;WinCode.draw();return false});b.append(c);c=$("<li>150%</li>");c.click(function(){$(".choice-chooser").detach();
WinCode._zoomMode="static";Blocks._scale=1.5;WinCode.draw();return false});b.append(c);c=$("<li>200%</li>");c.click(function(){$(".choice-chooser").detach();WinCode._zoomMode="static";Blocks._scale=2;WinCode.draw();return false});b.append(c);c=$('<li><span class="icon-expand-3"></span> Fit Width</li>');c.click(function(){$(".choice-chooser").detach();WinCode._zoomMode="width";WinCode.adjustWindow();return false});b.append(c);c=$('<li><span class="icon-full-screen"></span> Fit All</li>');c.click(function(){$(".choice-chooser").detach();
WinCode._zoomMode="all";WinCode.adjustWindow();return false});b.append(c);var c=$("#win-code .zoom .zoomfit"),d=c.offset().left,e=c.offset().top,b=b.parent();b.css("left",d+(c.outerWidth()-b.outerWidth())/2);if(e+c.outerHeight()+b.outerHeight()>window.innerHeight)if(e-b.outerHeight()>0)b.css("top",e-b.outerHeight());else{d=$(".toolbar-top").outerHeight()+windowPadding;if(e-d>window.innerHeight-e){b.css("top",d);b.css("height",e-d)}else{b.css("top",e+c.outerHeight());b.css("height",window.innerHeight-
e-c.outerHeight())}}else b.css("top",e+c.outerHeight())},markBlockChildren:function(b,c){b.marked=c;if(b instanceof Label)for(var d=0;d<b._children.length;d++)b._children[d]instanceof LabelInput&&WinCode.markBlockChildren(b._children[d],c);else if(b instanceof LabelInput)b._child&&WinCode.markBlockChildren(b._child,c);else if(b instanceof Block){for(d=0;d<b.label._children.length;d++)b.label._children[d]instanceof LabelInput&&WinCode.markBlockChildren(b.label._children[d],c);for(d=0;d<b._containers.length;d++)b._containers[d]&&
WinCode.markBlockChildren(b._containers[d],c);b.next&&WinCode.markBlockChildren(b.next,c)}},changeParams:function(b,c){if(b)if(b instanceof LabelInput){if(b._child&&b._child instanceof Label)if(b._child.func=="valueParam"){if(c[b._child.name]){b._child.name=c[b._child.name];b._child.label=b._child.name;b._child._children[0].label=b._child.name}}else WinCode.changeParams(b._child,c)}else if(b instanceof Label)for(var d=b.getNumSockets(),e=0;e<d;e++)WinCode.changeParams(b.getSocketAtChild(e),c);else if(b instanceof
Block){d=b.label.getNumSockets();for(e=0;e<d;e++)WinCode.changeParams(b.label.getSocketAtChild(e),c);if(b._containers)for(e=0;e<b._containers.length;e++)WinCode.changeParams(b._containers[e],c);b.next&&WinCode.changeParams(b.next,c)}},changeFuncs:function(b,c,d,e){if(b){if(b.func=="blockControlCall"&&b.labelText==c){for(var f=[],g=b.label.getNumSockets(),h=0;h<g;h++)f.push(b.label.getSocketAtChild(h));b.labelText=e;b.name=d;b.label=new Label({label:e,cat:b.cat});b.label.parent=b;b.label.draggable=
false;for(var j=b.label.getNumSockets(),h=0;h<g&&h<j;h++){b.label.setValue(h,f[h]._child);b.label.setValue(h,f[h].label)}}if(b._containers)for(h=0;h<b._containers.length;h++)WinCode.changeFuncs(b._containers[h],c,d,e);b.next&&WinCode.changeFuncs(b.next,c,d,e)}},updateFunction:function(b,c,d){IDE.dirty();IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);for(var e={},f=b.name,g=b.label.getNumSockets(),h=0;h<g;h++){var j=b.label.getSocketAtChild(h)._child.name;e[j]=
d[h];f=f+(" {string:"+j+"}")}WinCode.changeParams(b.next,e);g=e=c;for(h=0;h<d.length;h++){e=e+(" {param:"+d[h]+"}");g=g+(" {string:"+d[h]+"}")}for(h=0;h<WinCode._scripts.length;h++){WinCode.changeFuncs(WinCode._scripts[h],f,c,g);WinCode._scripts[h]._computeBounds()}b.labelText=e;b.name=c;b.label=new Label({label:e+" {button:editfn}",cat:b.cat});b.label.parent=b;b.label.draggable=false;b._computeBounds();WinCode.draw();WinTools.updateFunctions()},changeScriptVars:function(b,c){if(b instanceof LabelInput){if(b._child&&
b._child instanceof Label&&b._child.func=="valueScriptVar"&&c[b._child.name]){b._child.name=c[b._child.name];b._child.label=b._child.name;b._child._children[0].label=b._child.name}}else if(b){for(var d=b.label.getNumSockets(),e=0;e<d;e++)WinCode.changeScriptVars(b.label.getSocketAtChild(e),c);if(b._containers)for(e=0;e<b._containers.length;e++)WinCode.changeScriptVars(b._containers[e],c);b.next&&WinCode.changeScriptVars(b.next,c)}},updateScriptVars:function(b,c){IDE.dirty();IDE.Clipboard.undoBlockAction(IDE.editingActor?
IDE.editingActor:Runtime.background);for(var d={},e=b.label.getNumSockets(),f=0;f<e;f++){var g=b.label.getSocketAtChild(f)._child.name;d[g]=c[f]}WinCode.changeScriptVars(b.next,d);d="script variables";for(f=0;f<c.length;f++)d=d+(" {scriptvar:"+c[f]+"}");d=d+"{varargs:valueScriptVar}";b.labelText=d;b.label=new Label({label:d,cat:b.cat});b.label.parent=b;b.label.draggable=false;b._computeBounds();WinCode.draw()},tagBlock:function(b){var c=$("#edit-tags");c.find("input[type=text]").val(b.tags?b.tags.join(","):
"");c.modal();c.find(".okBtn").unbind().click(function(){IDE.dirty();b.tags=c.find("input[type=text]").val();b.tags=b.tags.split(",");for(var d=0;d<b.tags.length;d++)b.tags[d]=$.trim(b.tags[d]);b.tags.length==0&&delete b.tags;WinCode.draw();$.modal.close();return false});c.find(".cancelBtn").unbind().click(function(){$.modal.close();return false})},_cleanScript:function(b){if(b.values)if(b.values.length==0)delete b.values;else for(var c=0;c<b.values.length;c++)WinCode._cleanScript(b.values[c]);if(b.containers)if(b.containers.length==
0)delete b.containers;else for(c=0;c<b.containers.length;c++)b.containers[c]&&WinCode._cleanScript(b.containers[c]);b.id&&delete b.id;b.next&&WinCode._cleanScript(b.next);return b},inspectBlock:function(b){b=b.getRoot();if(b instanceof Block)var c=ObjectIO.genScriptObj(b);else b instanceof Label&&(c=ObjectIO.genValueObj(b));c=WinCode._cleanScript(c);c=JSON.stringify(c);b=$("#importexportdlg");b.find(".importBtn").addClass("hidden");b.find("textarea").val(c);b.modal();b.find(".cancelBtn").unbind().click(function(){$.modal.close();
return false});return false},toggleHideInSandbox:function(b){b.hiddenInSandbox=!b.hiddenInSandbox;IDE.dirty();return false},toggleLockInSandbox:function(b){WinCode._lockInSandbox(b,!b.lockedInSandbox);IDE.dirty();return false},_lockInSandbox:function(b,c){b.lockedInSandbox=c;for(var d=0;d<b._containers.length;d++)WinCode._lockInSandbox(b._containers[d],c);b.next&&WinCode._lockInSandbox(b.next,c)},editComment:function(b){if(b.func=="blockComment"){var c=$("#edit-comment");c.find("textarea").val(b.labelText);
c.modal();c.find(".okBtn").unbind().click(function(){IDE.dirty();b.labelText=c.find("textarea").val();WinCode.draw();$.modal.close();return false});c.find(".cancelBtn").unbind().click(function(){$.modal.close();return false})}},doubleClick:function(b,c){if(WinCode._enableDoubleClick&&!$("#win-code").hasClass("hidden")&&!$("#win-code .blockview").hasClass("hidden")){var d=b,e=c,f=$("#win-code"),g=f.find(".zoom");if(!(d>g.offset().left&&d<g.offset().left+g.outerWidth()&&e>g.offset().top&&e<g.offset().top+
g.outerHeight())&&d>=f.offset().left&&d<=f.offset().left+f.outerWidth()&&e>=f.offset().top&&e<=f.offset().top+f.outerHeight()){f=findPos(WinCode.canvas);d=d-f.left;e=e-f.top;if(d>=0&&d<WinCode.canvas.width&&e>=0&&e<WinCode.canvas.height)if(f=WinCode.getBlockAt(d,e))if(WinCode._enableFieldEdit&&f.func=="registerFunction")WinTools.cmdEditFunction(f);else if(WinCode._enableFieldEdit&&f.func=="valueParam")f.parent instanceof LabelInput&&(f.parent.parent instanceof Label&&f.parent.parent.parent instanceof
Block&&f.parent.parent.parent.func=="registerFunction")&&WinTools.cmdEditFunction(f.parent.parent.parent);else if(WinCode._enableFieldEdit&&f.func=="blockControlScriptVar")WinTools.cmdEditScriptVars(f);else if(WinCode._enableFieldEdit&&f.func=="valueScriptVar")f.parent instanceof LabelInput&&(f.parent.parent instanceof Label&&f.parent.parent.parent instanceof Block&&f.parent.parent.parent.func=="blockControlScriptVar")&&WinTools.cmdEditScriptVars(f.parent.parent.parent);else if(WinCode._enableFieldEdit&&
f.func=="blockComment")WinCode.editComment(f);else{if(WinCode._enableRun){d=f.getRoot();d=new Script({sprite:IDE.editingActor?IDE.editingActor:Runtime.background,scriptBlock:d});Runtime.scheduleToRun(d)}}else if(Blocks._scale!=1){d=d/Blocks._scale-WinCode.context.offsetX;e=e/Blocks._scale-WinCode.context.offsetY;Blocks._scale=1;WinCode.context.offsetX=WinCode.canvas.width/2-d;if(WinCode.context.offsetX>0)WinCode.context.offsetX=0;WinCode.context.offsetY=WinCode.canvas.height/2-e;if(WinCode.context.offsetY>
0)WinCode.context.offsetY=0;WinCode.draw()}}}},canDrag:function(b,c,d){if(!WinCode._resizing&&!$("#win-code").hasClass("hidden")&&!$("#win-code .blockview").hasClass("hidden")){var e=b,f=c,g=$("#win-code");if(e>=g.offset().left&&e<=g.offset().left+g.outerWidth()&&f>=g.offset().top&&f<=g.offset().top+g.outerHeight()){if(FocusManager.getFocusedElement()){g=FocusManager.getFocusedElement().getPopup();if(g!=null&&g.length>0&&e>=g.offset().left&&e<g.offset().left+g.width()&&f>=g.offset().top&&f<g.offset().top+
g.height())return false}g=findPos(WinCode.canvas);e=e-g.left;f=f-g.top;if(e>=0&&e<WinCode.canvas.width&&f>=0&&f<WinCode.canvas.height){FocusManager.clearFocus();e=WinCode.getBlockAt(e,f);if(WinCode._readOnly)if(e)WinCode._broadcastChange("select",e);else return true;else if(e==null)if(d==3)WinCode.showContextMenu(b,c,d,null);else return true;else{if(d==3){WinCode.showContextMenu(b,c,d,e);return false}return WinCode._enableSandbox&&(e.getRoot().hiddenInSandbox||e.lockedInSandbox)?false:true}}}}return false},
getDragObj:function(b,c){if(!WinCode._readOnly&&!$("#win-code").hasClass("hidden")&&!$("#win-code .blockview").hasClass("hidden")){var d=b,e=c,f=$("#win-code");if(d>=f.offset().left&&d<=f.offset().left+f.outerWidth()&&e>=f.offset().top&&e<=f.offset().top+f.outerHeight()){f=findPos(WinCode.canvas);d=d-f.left;e=e-f.top;if(d>=0&&d<WinCode.canvas.width&&e>=0&&e<WinCode.canvas.height){var g=WinCode.getBlockAt(d,e);if(g!=null){var h=null;IDE.dirty();g.id||WinCode._assignIds();if(g.showSelected){g=WinCode.findSelected();
(h=g.getRoot())&&Runtime.stopBlock(h);IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);if(g instanceof Label&&g.parent instanceof LabelInput&&g.parent.parent instanceof Label&&g.parent.parent.parent instanceof Block&&(!g.parent.parent.parent.hasFlap&&g.func=="valueParam"||g.parent.parent.parent.func=="blockControlScriptVar"&&g.func=="valueScriptVar")){IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);g=g.copy()}else if(g instanceof
Block)g.detachSelected();else{g.detach();g.setSelected(false,true)}var j=WinCode._scripts.indexOf(g);if(j>=0){WinCode._scripts.splice(j,1);Runtime.unregisterBlock(g)}h&&WinCode.updateWorldBody(h)}else{WinCode.clearSelection();if(g instanceof Label&&g.parent instanceof LabelInput&&g.parent.parent instanceof Label&&g.parent.parent.parent instanceof Block&&(!g.parent.parent.parent.hasFlap&&g.func=="valueParam"||g.parent.parent.parent.func=="blockControlScriptVar"&&g.func=="valueScriptVar")){IDE.Clipboard.undoBlockAction(IDE.editingActor?
IDE.editingActor:Runtime.background);g=g.copy()}else{IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);j=g.x+slotBegin+slotWidth;if(g instanceof Block&&g.label){var k=g.label.getSocketAtChild(0);if(k&&k.x>j)j=k.x}else if(g instanceof Label)if((k=g.getSocketAtChild(0))&&k.x>j)j=k.x;if(g instanceof Block&&(d/Blocks._scale-WinCode.context.offsetX<g.x||d/Blocks._scale-WinCode.context.offsetX>j)){if(g.parent)(h=g.getRoot())&&Runtime.stopBlock(h);j=null;if(g.next){g.next.parent=
g.parent;j=g.next;if(g.next.parent==null){WinCode._scripts.push(g.next);WinCode.updateWorldBody(g.next)}}if(g.parent){for(var j=g.parent,k=false,l=0;l<g.parent._containers.length;l++)if(g.parent._containers[l]==g){g.parent._containers[l]=g.next;k=true;break}if(!k)g.parent.next=g.next}j&&j._computeBounds();g.next=null;g.parent=null}else{if(g.parent)(h=g.getRoot())&&Runtime.stopBlock(h);g.detach()}j=WinCode._scripts.indexOf(g);j>=0&&WinCode._scripts.splice(j,1);Runtime.unregisterBlock(g)}}g.x=g.x+(f.left+
WinCode.context.offsetX-(d/Blocks._scale+f.left));g.y=g.y+(f.top+WinCode.context.offsetY-(e/Blocks._scale+f.top));g._computeBlockBounds();WinCode.draw();h&&WinCode.updateWorldBody(h);return g}}}}return null},canDrop:function(b,c,d,e){if(!WinCode._readOnly&&!$("#win-code").hasClass("hidden")&&!$("#win-code .blockview").hasClass("hidden")){d=$("#win-code");if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight()){d=findPos(WinCode.canvas);b=b-d.left;
c=c-d.top;if((e instanceof Block||e instanceof Label)&&b>=0&&b<WinCode.canvas.width&&c>=0&&c<WinCode.canvas.height){FocusManager.clearFocus();return true}}}return false},clearSelection:function(){for(var b=Runtime.background,c=0;c<b.scripts.length;c++)b.scripts[c].setSelected(false,true);for(var d=0;d<Runtime.sprites.length;d++){b=Runtime.sprites[d];for(c=0;c<b.scripts.length;c++)b.scripts[c].setSelected(false,true)}for(d=0;d<Runtime.libs.length;d++){b=Runtime.libs[d];for(c=0;c<b.scripts.length;c++)b.scripts[c].setSelected(false,
true)}WinCode.draw()},getSelection:function(){for(var b=[],c=0;c<WinCode._scripts.length;c++)WinCode._getStartSelection(WinCode._scripts[c],b);return b},_getStartSelection:function(b,c){if(b instanceof Label)if(b.showSelected)c.push(b);else for(var d=b.getNumSockets(),e=0;e<d;e++){var f=b.getSocketAtChild(e);f._child&&WinCode._getStartSelection(f._child,c)}else if(b.showSelected)c.push(b);else{WinCode._getStartSelection(b.label,c);if(b._containers)for(e=0;e<b._containers.length;e++)b._containers[e]!=
null&&WinCode._getStartSelection(b._containers[e],c);b.next&&WinCode._getStartSelection(b.next,c)}},deleteSelection:function(){IDE.dirty();IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);for(var b=WinCode.getSelection(),c=0;c<b.length;c++){var d=b[c];if(!(d instanceof Label&&d.parent instanceof LabelInput&&d.parent.parent instanceof Label&&d.parent.parent.parent instanceof Block&&(d.parent.parent.parent.func=="registerFunction"&&d.func=="valueParam"||d.parent.parent.parent.func==
"blockControlScriptVar"&&d.func=="valueScriptVar"))){var e=d.getRoot();e&&Runtime.stopBlock(e);if(d instanceof Block){var f=d.detachSelected();if(f){WinCode._scripts.push(f);WinCode.updateWorldBody(f)}}else{d.detach();d.setSelected(false,true)}f=WinCode._scripts.indexOf(d);if(f>=0){WinCode._scripts.splice(f,1);Runtime.unregisterBlock(d)}WinCode._broadcastChange("delete",d);e&&WinCode.updateWorldBody(e)}}WinCode.computeAll();WinCode.draw()},cutSelection:function(){if(WinCode._enableCutCopyPaste){IDE.dirty();
IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);for(var b=WinCode.getSelection(),c=[],d=0;d<b.length;d++)if(b[d]instanceof Block)c.push(b[d].copySelection());else{b[d].setSelected(false,true);c.push(b[d].copy())}IDE.Clipboard.clear();IDE.Clipboard.add("blocks",c);for(d=0;d<b.length;d++){c=b[d];if(!(c instanceof Label&&c.parent instanceof LabelInput&&c.parent.parent instanceof Label&&c.parent.parent.parent instanceof Block&&(c.parent.parent.parent.func=="registerFunction"&&
c.func=="valueParam"||c.parent.parent.parent.func=="blockControlScriptVar"&&c.func=="valueScriptVar"))){var e=c.getRoot();e&&Runtime.stopBlock(e);if(c instanceof Block){var f=c.detachSelected();if(f){WinCode._scripts.push(f);WinCode.updateWorldBody(f)}}else{c.detach();c.setSelected(false,true)}f=WinCode._scripts.indexOf(c);if(f>=0){WinCode._scripts.splice(f,1);Runtime.unregisterBlock(c)}WinCode._broadcastChange("delete",c);e&&WinCode.updateWorldBody(e)}}WinCode.computeAll();WinCode.draw()}},copySelection:function(){if(WinCode._enableCutCopyPaste){for(var b=
WinCode.getSelection(),c=[],d=0;d<b.length;d++)if(b[d]instanceof Block)c.push(b[d].copySelection());else{b[d].setSelected(false,true);c.push(b[d].copy())}IDE.Clipboard.clear();IDE.Clipboard.add("blocks",c)}},pasteSelection:function(){if(WinCode._enableCutCopyPaste){IDE.dirty();IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);var b=IDE.Clipboard.get("blocks");if(b)for(var c=0;c<b.length;c++){var d=b[c].copy();d.x=-WinCode.context.offsetX+WinCode.canvas.width/4;d.y=
-WinCode.context.offsetY+WinCode.canvas.height/4;d._computeBounds();WinCode._scripts.push(d);WinCode.updateWorldBody(d);if(b[c].func.substring(0,8)=="register"){var e=IDE.editingActor?IDE.editingActor:Runtime.background;if(e.id&&e.classname)for(c=0;c<Runtime.sprites.length;c++){var f=Runtime.sprites[c];if(f.id==e.id&&f.classname==e.classname){Runtime.unregisterScripts(f);Runtime.registerScripts(f)}}else{e=new Script({sprite:e,scriptBlock:d});e.currentBlock=e.scriptBlock;e.invokeStep()}}WinCode._broadcastChange("attachTo",
d);WinCode._getScrollBounds()}WinCode.computeAll();WinCode.draw()}},mousedown:function(b){var c=findPos(WinCode.canvas),d=b.pageX-c.left,c=b.pageY-c.top;WinCode._xStart=d-WinCode.context.offsetX;WinCode._yStart=c-WinCode.context.offsetY;var e=WinCode.getBlockAt(d,c);if(e){if(e.func=="blockComment"&&WinCode._xStart>=(e.x+e.width-20)*Blocks._scale&&WinCode._yStart>=(e.y+e.height-20)*Blocks._scale)WinCode._resizing={block:e,x:b.pageX,y:b.pageY}}else{WinCode.clearSelection();WinCode.draw();WinCode._scrolling=
{scrollX:WinCode.context.offsetX,scrollY:WinCode.context.offsetY,x:d,y:c}}},mouseup:function(b){if(b.which!=3){b.shiftKey||WinCode.clearSelection();WinCode._mousedown=false;WinCode._resizing=null;WinCode._scrolling=null;var c=findPos(WinCode.canvas),d=b.pageX-c.left,e=b.pageY-c.top;WinCode._xStart=d/Blocks._scale-WinCode.context.offsetX;WinCode._yStart=e/Blocks._scale-WinCode.context.offsetY;c=WinCode.getBlockAt(d,e);if(!WinCode._readOnly&&c!=null&&(!WinCode._enableSandbox||!c.getRoot().hiddenInSandbox&&
!c.lockedInSandbox)){var f;c instanceof Label?f=c.getInputAtPoint(d/Blocks._scale-WinCode.context.offsetX,e/Blocks._scale-WinCode.context.offsetY):c instanceof Block&&(f=c.getInputAtPoint(d/Blocks._scale-WinCode.context.offsetX,e/Blocks._scale-WinCode.context.offsetY));if(f!=null&&WinCode._enableFieldEdit){FocusManager.setFocus(f,{x:d-WinCode.context.offsetX,y:e-WinCode.context.offsetY});WinCode.context.save();WinCode.context.translate(WinCode.context.offsetX+0.5,WinCode.context.offsetY+0.5);f.draw(WinCode.context);
WinCode.context.restore()}if(c){d=c.x+slotBegin+slotWidth;if(c instanceof Block&&c.label){if((f=c.label.getSocketAtChild(0))&&f.x>d)d=f.x}else if(c instanceof Label)if((f=c.getSocketAtChild(0))&&f.x>d)d=f.x;if(b.shiftKey){WinCode._assignIds();(b=WinCode.findSelected())?b.setSelected(true,c.id):c instanceof Block&&WinCode._xStart>=c.x&&WinCode._xStart<=d?c.setSelected(true,true):c.setSelected(true,false)}else{c instanceof Block&&WinCode._xStart>=c.x&&WinCode._xStart<=d?c.setSelected(true,true):c.setSelected(true,
false);if(!$("#win-code .codeview").hasClass("hidden")){c=c.getRoot();b=-1;d=WinCode._sortScripts(WinCode._scripts);for(f=0;f<d.length;f++)if(d[f]==c){b=f;break}if(b>=0){c=RegExp(/this\s*\.\s*[a-zA-Z0-9_]+.*function\s*\(\s*\)\s*{/g);d=WinCode.editor.getValue();e=0;do if(f=c.exec(d)){var g=f.index;c.lastIndex=f.index+f[0].length;if(b==e)for(var h=WinCode.editor.session.getDocument().$lines,j=WinCode.editor.session.doc.getNewLineCharacter(),k=0,l=0;l<h.length;l++){var m=WinCode.editor.session.getLine(l).length;
if(k+m>=g){WinCode.editor.gotoLine(l+1,0,true);break}k=k+(m+j.length)}e++}while(f)}}}WinCode.draw()}}}},mouseover:function(b){var c=b.pageX,b=b.pageY,d=findPos(WinCode.canvas);if(WinCode._resizing){c=c-(d.left+WinCode.context.offsetX);b=b-(d.top+WinCode.context.offsetY);d=WinCode._resizing.block;d.width=c-d.x;if(d.width<20)d.width=20;d.height=b-d.y;if(d.height<20)d.height=20;WinCode.draw();WinCode._getScrollBounds()}else if(WinCode._scrolling){if(WinCode._enableScrolling){c=c-d.left;b=b-d.top;WinCode.context.offsetX=
WinCode._scrolling.scrollX-(WinCode._scrolling.x-c)/Blocks._scale;WinCode.context.offsetY=WinCode._scrolling.scrollY-(WinCode._scrolling.y-b)/Blocks._scale;if(WinCode.context.offsetX>0)WinCode.context.offsetX=0;if(WinCode.rightExtreme>0&&-WinCode.context.offsetX>WinCode.rightExtreme)WinCode.context.offsetX=-WinCode.rightExtreme/Blocks._scale;if(WinCode.context.offsetY>0)WinCode.context.offsetY=0;if(WinCode.bottomExtreme>0&&-WinCode.context.offsetY>WinCode.bottomExtreme)WinCode.context.offsetY=-WinCode.bottomExtreme/
Blocks._scale;WinCode.draw()}}else if(!DragLayer._draggingObj&&!WinCode._readOnly&&!$("#win-code").hasClass("hidden")){var e=$("#win-code");if(c>=e.offset().left&&c<=e.offset().left+e.outerWidth()&&b>=e.offset().top&&b<=e.offset().top+e.outerHeight()){c=c-d.left;b=b-d.top;c=WinCode.getBlockAt(c,b);if(c!=null&&(c instanceof Block||c instanceof Label)&&(!WinCode._enableSandbox||!c.getRoot().hiddenInSandbox&&!c.lockedInSandbox)){if(WinCode._lastHoverBlock)WinCode._lastHoverBlock.showDragHandle=false;
WinCode._lastHoverBlock=c;c.showDragHandle=true;WinCode.draw();$("#win-code").css("cursor","pointer")}else if(WinCode._lastHoverBlock){WinCode._lastHoverBlock.showDragHandle=false;WinCode._lastHoverBlock=null;WinCode.draw();$("#win-code").css("cursor","pointer")}else $("#win-code").css("cursor","move")}}},dragOver:function(b,c,d,e){if(!WinCode._readOnly&&!$("#win-code").hasClass("hidden")&&!$("#win-code .blockview").hasClass("hidden")){var d=$("#win-code"),f=b+e.x,g=c+e.y,h=b+e.x+e.width,j=e instanceof
Label?c+e.y+e.height:c+e.y+e.totalHeight,k=d.find(".trash");if(WinCode._enableDragToDelete&&(WinCode._enableDeleteStart||!WinCode._enableDeleteStart&&e.hasFlap)&&!k.hasClass("hidden")&&h>=k.offset().left&&f<=k.offset().left+k.outerWidth()&&j>=k.offset().top&&g<=k.offset().top+k.outerHeight())k.addClass("hover");else if(b>=d.offset().left&&b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight()){k.removeClass("hover");d=findPos(WinCode.canvas);b=b-d.left;c=c-d.top;if(WinCode._enableScrolling&&
c<20){WinCode.context.offsetY=WinCode.context.offsetY+20;if(WinCode.context.offsetY>0)WinCode.context.offsetY=0;WinCode.draw()}else if(WinCode._enableScrolling&&b<20){WinCode.context.offsetX=WinCode.context.offsetX+20;if(WinCode.context.offsetX>0)WinCode.context.offsetX=0;WinCode.draw()}else if(WinCode._enableScrolling&&b>WinCode.canvas.width-20){WinCode.context.offsetX=WinCode.context.offsetX-20;WinCode.draw()}if((e instanceof Block||e instanceof Label)&&b>=0&&b<WinCode.canvas.width&&c>=0&&c<WinCode.canvas.height){WinCode.draw();
d=e.x;f=e.y;e.x=e.x+(b/Blocks._scale-WinCode.context.offsetX);e.y=e.y+(c/Blocks._scale-WinCode.context.offsetY);if(e instanceof Label)for(g=0;g<WinCode._scripts.length;g++){if(!WinCode._scripts[g].hidden&&(!WinCode._enableSandbox||!WinCode._scripts[g].hiddenInSandbox)){b=WinCode._scripts[g].objNearValue(e);if(b!=null){e.setDisabled(true);g=b._child;b._child=e;e.parent=b;b._computeBounds();WinCode.draw();e.setDisabled(false);b._child=g;e.parent=null;b._computeBounds();break}}}else if(e instanceof Block){c=
false;if(e.hasFlap)for(g=0;g<WinCode._scripts.length;g++)if(WinCode._scripts[g]instanceof Block&&!WinCode._scripts[g].hidden&&(!WinCode._enableSandbox||!WinCode._scripts[g].hiddenInSandbox)){b=WinCode._scripts[g].blockNearSlot(e);if(b!=null){c=true;if(b[0]<0){e.setDisabled(true);g=b[1].next;b[1].next=e;e.parent=b[1];h=e.getLastBlock();if(h.next=g)g.parent=h;b[1]._computeBounds();WinCode.draw();e.setDisabled(false);b[1].next=g}else{e.setDisabled(true);g=b[1]._containers[b[0]];b[1]._containers[b[0]]=
e;e.parent=b[1];h=e.getLastBlock();if(h.next=g)g.parent=h;b[1]._computeBounds();WinCode.draw();e.setDisabled(false);b[1]._containers[b[0]]=g}e.parent=null;h.next=null;if(g)g.parent=b[1];b[1]._computeBounds();break}if(!e.next&&(WinCode._convertFuncValue&&e.func=="blockControlCall"||WinCode._convertLibValue&&e.func=="blockControlCallLibrary"||e.func=="blockControlJS")){b=WinCode._scripts[g].objNearValue(e);if(b!=null){h=e.convertToLabel();h.func=e.func=="blockControlJS"?"valueControlJS":e.func=="blockControlCall"?
"valueControlCall":"valueControlCallLibrary";h.setDisabled(true);g=b._child;b._child=h;h.parent=b;b._computeBounds();WinCode.draw();h.setDisabled(false);b._child=g;h.parent=null;b._computeBounds();break}}}if(!c&&e.hasSlot)for(g=0;g<WinCode._scripts.length;g++)if(WinCode._scripts[g]instanceof Block&&!WinCode._scripts[g].hidden&&(!WinCode._enableSandbox||!WinCode._scripts[g].hiddenInSandbox)){b=WinCode._scripts[g].blockNearFlap(e);if(b!=null){if(b[0]<0&&!b[1].parent){e.setDisabled(true);WinCode.draw();
WinCode.context.save();WinCode.context.scale(Blocks._scale*2,Blocks._scale*2);WinCode.context.translate(WinCode.context.offsetX+0.5,WinCode.context.offsetY+0.5);e.x=b[2];e.y=b[3]-e.totalHeight;e._computeBounds();e.draw(WinCode.context);WinCode.context.restore();e.setDisabled(false)}break}}}e.x=d;e.y=f;e._computeBounds();return true}}else k.removeClass("hover")}return false},drop:function(b,c,d,e,f){if(!WinCode._readOnly&&!$("#win-code").hasClass("hidden")&&!$("#win-code .blockview").hasClass("hidden")){var d=
$("#win-code"),g=b+e.x,h=c+e.y,j=b+e.x+e.width,k=e instanceof Label?c+e.y+e.height:c+e.y+e.totalHeight,l=d.find(".trash");if(WinCode._enableDragToDelete&&(WinCode._enableDeleteStart||!WinCode._enableDeleteStart&&e.hasFlap)&&!l.hasClass("hidden")&&j>=l.offset().left&&g<=l.offset().left+l.outerWidth()&&k>=l.offset().top&&h<=l.offset().top+l.outerHeight()){Runtime.unregisterBlock(e);WinCode.updateWorldBody(null);WinCode._broadcastChange("delete",e);l.removeClass("hover")}else if(b>=d.offset().left&&
b<=d.offset().left+d.outerWidth()&&c>=d.offset().top&&c<=d.offset().top+d.outerHeight()){d=findPos(WinCode.canvas);b=b-d.left;c=c-d.top;if((e instanceof Block||e instanceof Label)&&b>=0&&b<WinCode.canvas.width&&c>=0&&c<WinCode.canvas.height){IDE.dirty();e.x=e.x+(b/Blocks._scale-WinCode.context.offsetX);e.y=e.y+(c/Blocks._scale-WinCode.context.offsetY);if(e.x<0)e.x=0;if(e.y<0)e.y=0;g=e.hidden=false;if(e instanceof Label)for(b=0;b<WinCode._scripts.length;b++){if(!WinCode._scripts[b].hidden&&(!WinCode._enableSandbox||
!WinCode._scripts[b].hiddenInSandbox)){c=WinCode._scripts[b].objNearValue(e);if(c!=null){f!=WinCode&&IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);if(c._child!=null){c._child.x=c._child.x+20;c._child.y=c._child.y+20;c._child.parent=null;c._child._computeBounds();WinCode.hilightBlock();WinCode._broadcastChange("detach",c._child);WinCode._scripts.push(c._child);WinCode.updateWorldBody(c._child);WinCode.hilightBlock();WinCode._broadcastChange("attachTo",c._child)}else if(e.func==
"valueControlLanguageWithDefault"&&e._children[3].label==e._children[3].defaultLabel){e._children[1].label="<enter ID>";e._children[3].label=c.label}c._child=e;c._child.parent=c;c.parent._computeBounds();WinCode.hilightBlock();WinCode._broadcastChange("attachTo",c._child);WinCode.updateWorldBody(c.getRoot());g=true;break}}}else if(e instanceof Block){d=false;if(e.hasFlap)for(b=0;b<WinCode._scripts.length;b++)if(WinCode._scripts[b]instanceof Block&&!WinCode._scripts[b].hidden&&(!WinCode._enableSandbox||
!WinCode._scripts[b].hiddenInSandbox)){c=WinCode._scripts[b].blockNearSlot(e);if(c!=null){f!=WinCode&&IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);d=true;if(c[0]<0)c[1].add(e);else{c[1].getBlockAtContainer(c[0]);c[1].addToContainer(c[0],e)}WinCode.hilightBlock();WinCode._broadcastChange("attachTo",e);g=true;WinCode.updateWorldBody(e.getRoot());break}if(!e.next&&(WinCode._convertFuncValue&&e.func=="blockControlCall"||WinCode._convertLibValue&&e.func=="blockControlCallLibrary"||
e.func=="blockControlJS")){c=WinCode._scripts[b].objNearValue(e);if(c!=null){f!=WinCode&&IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);b=e.func;e=e.convertToLabel();e.func=b=="blockControlJS"?"valueControlJS":b=="blockControlCall"?"valueControlCall":"valueControlCallLibrary";if(c._child!=null){c._child.x=c._child.x+20;c._child.y=c._child.y+20;c._child.parent=null;c._child._computeBounds();WinCode.hilightBlock();WinCode._broadcastChange("detach",c._child);WinCode._scripts.push(c._child);
WinCode.updateWorldBody(c._child);WinCode.hilightBlock();WinCode._broadcastChange("attachTo",c._child)}c._child=e;c._child.parent=c;c.parent._computeBounds();WinCode.hilightBlock();WinCode._broadcastChange("attachTo",c._child);WinCode.updateWorldBody(c.getRoot());g=true;break}}}if(!d&&e.hasSlot)for(b=0;b<WinCode._scripts.length;b++)if(WinCode._scripts[b]instanceof Block&&!WinCode._scripts[b].hidden&&(!WinCode._enableSandbox||!WinCode._scripts[b].hiddenInSandbox)){c=WinCode._scripts[b].blockNearFlap(e);
if(c!=null){if(c[0]<0&&!c[1].parent){f!=WinCode&&IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);WinCode._scripts.splice(b,1);e.append(c[1]);WinCode.updateWorldBody(e.getRoot())}break}}}if(!g){e._computeBounds();c=false;if(f!=WinCode&&e.func=="registerFunction"){d=false;for(b=0;b<WinCode._scripts.length;b++)if(WinCode._scripts[b].func=="registerFunction"&&e.name==WinCode._scripts[b].name){d=true;break}if(d)IDE.confirmDialog(g_loc.getText("wincode.funcoverwrite"),
function(){f!=WinCode&&IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);for(var b=0;b<WinCode._scripts.length;b++)if(WinCode._scripts[b].func=="registerFunction"&&e.name==WinCode._scripts[b].name){WinCode._scripts.splice(b,1);break}WinCode._ensureVarExists(e);WinCode._scripts.push(e);var c=IDE.editingActor?IDE.editingActor:Runtime.background;if(c.id&&c.classname)for(b=0;b<Runtime.sprites.length;b++){var d=Runtime.sprites[b];if(d.id==c.id&&d.classname==c.classname){Runtime.unregisterScripts(d);
Runtime.registerScripts(d)}}else{b=new Script({sprite:c,scriptBlock:e});b.currentBlock=b.scriptBlock;b.invokeStep()}WinCode._getScrollBounds();WinCode.draw()});else{f!=WinCode&&IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);c=true;WinCode._scripts.push(e);d=IDE.editingActor?IDE.editingActor:Runtime.background;if(d.id&&d.classname)for(b=0;b<Runtime.sprites.length;b++){g=Runtime.sprites[b];if(g.id==d.id&&g.classname==d.classname){Runtime.unregisterScripts(g);Runtime.registerScripts(g)}}else{b=
new Script({sprite:IDE.editingActor?IDE.editingActor:Runtime.background,scriptBlock:e});b.currentBlock=b.scriptBlock;b.invokeStep()}}}else{if(e.func=="valueControlCall"){b=e.convertToBlock();b.func="blockControlCall";b.x=e.x;b.y=e.y;e=b;e._computeBounds()}else if(e.func=="valueControlJS"){b=e.convertToBlock();b.func="blockControlJS";b.x=e.x;b.y=e.y;e=b;e._computeBounds()}f!=WinCode&&IDE.Clipboard.undoBlockAction(IDE.editingActor?IDE.editingActor:Runtime.background);c=true;WinCode._scripts.push(e);
if(e.func.substring(0,8)=="register"){d=IDE.editingActor?IDE.editingActor:Runtime.background;if(d.id&&d.classname)for(b=0;b<Runtime.sprites.length;b++){g=Runtime.sprites[b];if(g.id==d.id&&g.classname==d.classname){Runtime.unregisterScripts(g);Runtime.registerScripts(g)}}else{b=new Script({sprite:IDE.editingActor?IDE.editingActor:Runtime.background,scriptBlock:e});b.currentBlock=b.scriptBlock;b.invokeStep()}}}if(c){WinCode._ensureVarExists(e);if(f==WinCode){WinCode.hilightBlock();WinCode._broadcastChange("move",
e)}else{WinCode.hilightBlock();WinCode._broadcastChange("attachTo",e)}}WinCode.updateWorldBody(e.getRoot())}WinCode._getScrollBounds();WinCode.draw();return true}}}return false},dragCanceled:function(){IDE.Clipboard.doUndo()},_onKeyPress:function(b,c){var d=false;if(!WinCode._readOnly){d=FocusManager._onKeyPress(b,c);if(!d&&b==8&&WinCode._enableDelete&&WinCode._enableDeleteStart&&WinCode.getSelection().length>0){WinCode.deleteSelection();d=true}WinCode.draw()}return d}},DragLayer={cDragThreshold:4,
cDoubleClickTimeout:500,cClickTimeout:2E3,_draggingObj:null,_draggingSource:null,_ignoreEvents:!1,_listeners:[],init:function(){$(document).mousedown(DragLayer.onMouseDown);$(document).mouseup(DragLayer.onMouseUp);$(document).mousemove(DragLayer.onMouseMove)},addDragListener:function(b){this._listeners.indexOf(b)<0&&this._listeners.push(b)},removeDragListener:function(b){b=this._listeners.indexOf(b);b>=0&&this._listeners.splice(b,1)},removeAllDragListeners:function(){this._listeners=[]},_isDialogOpen:function(b){var c=
false;if($.modal.isActive())return true;if(!$.modal.isActive()&&b){$(".mask").each(function(d,f){if(!$(f).hasClass("hidden")&&b.pageX>$(f).offset().left&&b.pageX<$(f).offset().left+$(f).outerWidth()&&b.pageY>$(f).offset().top&&b.pageY<$(f).offset().top+$(f).outerHeight()){c=true;return false}});$(".idedialog:visible").each(function(d,f){if(b.pageX>$(f).offset().left&&b.pageX<$(f).offset().left+$(f).outerWidth()&&b.pageY>$(f).offset().top&&b.pageY<$(f).offset().top+$(f).outerHeight()){c=true;return false}})}c||
$("#win-paint").hasClass("hidden")||(c=true);c||$("#win-spine").length>0&&!$("#win-spine").hasClass("hidden")&&(c=true);if(!c){var d=$(".choice-chooser");if(d.length>0)c=true;else{d=$(".color-chooser");$("#stage-canvas");if(d.length>0&&d.css("display")!="none")c=true;else{d=$(".angle-chooser");if(d.length>0&&d.css("display")!="none")c=true;else{d=$(".number-chooser");if(d.length>0&&d.css("display")!="none")c=true;else{d=$(".blockpicker");d.length>0&&d.css("display")!="none"&&(c=true)}}}}}return c},
_dismissIfOutsideChooser:function(b){var c=false;if(b){if($("li.wincmd-help").hasClass("active")){var d=b.pageX,e=b.pageY,f=$("li.wincmd-help div.popover div.helpbox");if(d>=f.offset().left&&d<=f.offset().left+f.outerWidth()&&e>=0&&e<=f.offset().top+f.outerHeight()||WinTools.canDrag(d,e,b.which))return false}$(b.target).parents("#wintool-help").length==0&&$("#wintool-help").detach();$("li.wincmd-help").removeClass("active");d=$(".choice-chooser");if(d.length>0){(b.pageX<d.offset().left||b.pageX>d.offset().left+
d.outerWidth()||b.pageY<d.offset().top||b.pageY>d.offset().top+d.outerHeight())&&d.detach();c=true}else{d=$(".color-chooser");e=$("#stage-canvas");if(d.length>0&&d.css("display")!="none"){if(!(b.pageX>=d.offset().left&&b.pageX<=d.offset().left+d.outerWidth()&&b.pageY>=d.offset().top&&b.pageY<=d.offset().top+d.outerHeight())){b.pageX>=e.offset().left&&(b.pageX<=e.offset().left+e.outerWidth()&&b.pageY>=e.offset().top&&b.pageY<=e.offset().top+e.outerHeight())&&ColorPicker.updateColorStage(b);d.css("display",
"none")}c=true}else{d=$(".angle-chooser");if(d.length>0&&d.css("display")!="none"){b.pageX>=d.offset().left&&b.pageX<=d.offset().left+d.outerWidth()&&b.pageY>=d.offset().top&&b.pageY<=d.offset().top+d.outerHeight()||d.css("display","none");c=true}else{d=$(".number-chooser");if(d.length>0&&d.css("display")!="none"){c=$(".scrubber");b.pageX>=c.offset().left&&b.pageX<=c.offset().left+c.outerWidth()&&b.pageY>=c.offset().top-20&&b.pageY<=c.offset().top+c.outerHeight()||d.css("display","none");c=true}else{d=
$(".blockpicker");if(d.length>0&&d.css("display")!="none"){b.pageX>=d.offset().left&&b.pageX<=d.offset().left+d.outerWidth()&&b.pageY>=d.offset().top&&b.pageY<=d.offset().top+d.outerHeight()||d.css("display","none");c=true}}}}}}return c},_showDragLayer:function(){if(DragLayer._canvas==null){DragLayer._canvas=$("<canvas></canvas>");DragLayer._canvas.css("position","absolute");DragLayer._canvas.css("left","0px");DragLayer._canvas.css("top","0px");DragLayer._canvas.css("z-index","50000");DragLayer._canvas[0].width=
$(window).innerWidth();DragLayer._canvas[0].height=$(window).innerHeight();$("body").append(DragLayer._canvas);DragLayer._context=DragLayer._canvas[0].getContext("2d");DragLayer._context.translateX=0;DragLayer._context.translateY=0;DragLayer._context.offsetX=0;DragLayer._context.offsetY=0}},_hideDragLayer:function(){if(DragLayer._canvas!=null){DragLayer._canvas.detach();DragLayer._canvas=null}},onMouseDown:function(b){if(DragLayer._ignoreEvents)return false;DragLayer._dismissIfOutsideChooser(b);if(!DragLayer._isDialogOpen(b))for(var c=
DragLayer._listeners,d=0;d<c.length;d++){var e=c[d];if(e.canDrag&&e.canDrag(b.pageX,b.pageY,b.which)){if(Date.now()-DragLayer._timestamp<DragLayer.cDoubleClickTimeout){DragLayer._dragStarted=false;if(e.doubleClick){e.doubleClick(b.pageX,b.pageY,b.which);break}}DragLayer._dragStarted=true;DragLayer._timestamp=Date.now();DragLayer._startingX=b.pageX;DragLayer._startingY=b.pageY;DragLayer._startingWhich=b.which;break}}},onMouseMove:function(b){if(!DragLayer._ignoreEvents&&!DragLayer._isDialogOpen()){if(DragLayer._dragStarted&&
(Math.abs(b.pageX-DragLayer._startingX)>DragLayer.cDragThreshold||Math.abs(b.pageY-DragLayer._startingY)>DragLayer.cDragThreshold)){DragLayer._dragStarted=false;DragLayer._timestamp=0;for(var c=DragLayer._listeners,d=0;d<c.length;d++){var e=c[d];if(e.canDrag&&e.getDragObj&&e.canDrag(DragLayer._startingX,DragLayer._startingY,DragLayer._startingWhich)){DragLayer._draggingObj=e.getDragObj(DragLayer._startingX,DragLayer._startingY,DragLayer._startingWhich);if(DragLayer._draggingObj!=null){DragLayer._draggingSource=
e;DragLayer._showDragLayer();if(DragLayer._draggingObj instanceof Block||DragLayer._draggingObj instanceof Label){DragLayer._context.translateX=b.pageX/Blocks._scale;DragLayer._context.translateY=b.pageY/Blocks._scale}else{DragLayer._context.translateX=b.pageX;DragLayer._context.translateY=b.pageY}DragLayer.draw();for(d=0;d<c.length;d++){e=c[d];e.hilightAccept&&e.hilightAccept(DragLayer._draggingObj,DragLayer._draggingSource)}}break}}}if(DragLayer._draggingObj!=null&&DragLayer._draggingSource!=null){if(DragLayer._draggingObj instanceof
Block||DragLayer._draggingObj instanceof Label){DragLayer._context.translateX=b.pageX/Blocks._scale;DragLayer._context.translateY=b.pageY/Blocks._scale}else{DragLayer._context.translateX=b.pageX;DragLayer._context.translateY=b.pageY}DragLayer.draw();if(DragLayer._draggingObj!=null&&DragLayer._draggingSource)for(d=0;d<DragLayer._listeners.length;d++){e=DragLayer._listeners[d];e.dragOver&&e.dragOver(b.pageX,b.pageY,b.which,DragLayer._draggingObj,DragLayer._draggingSource)}b.preventDefault();b.stopPropagation();
b.stopImmediatePropagation()}}},onMouseUp:function(b){DragLayer._dragStarted=false;if(DragLayer._dragStarted&&Date.now()-DragLayer._timestamp>DragLayer.cDoubleClickTimeout)DragLayer._dragStarted=false;else if(!DragLayer._ignoreEvents){var c=false;if(!DragLayer._isDialogOpen(b)&&DragLayer._draggingObj!=null&&DragLayer._draggingSource)for(var d=0;d<DragLayer._listeners.length;d++){var e=DragLayer._listeners[d];if(e.canDrop&&e.drop&&e.canDrop(b.pageX,b.pageY,b.which,DragLayer._draggingObj,DragLayer._draggingSource)){c=
true;e.drop(b.pageX,b.pageY,b.which,DragLayer._draggingObj,DragLayer._draggingSource);DragLayer._draggingSource.dragCompleted!=null&&DragLayer._draggingSource.dragCompleted(DragLayer._draggingObj,e);break}}if(DragLayer._draggingObj!=null&&DragLayer._draggingSource!=null){DragLayer._draggingSource.dragCanceled!=null&&!c&&DragLayer._draggingSource.dragCanceled(DragLayer._draggingObj);DragLayer._hideDragLayer();DragLayer._draggingObj=null;DragLayer._draggingSource=null}b=DragLayer._listeners;for(d=0;d<
b.length;d++){e=b[d];e.hilightAccept&&e.hilightAccept(null)}}},draw:function(){var b=DragLayer._canvas[0],c=DragLayer._context;c.font=defaultLabelFontWeight+" "+defaultLabelFontSize+"px "+defaultLabelFont;c.clearRect(0,0,b.width,b.height);c.save();c.globalAlpha=0.7;(DragLayer._draggingObj instanceof Block||DragLayer._draggingObj instanceof Label)&&c.scale(Blocks._scale,Blocks._scale);c.translate(c.translateX,c.translateY);DragLayer._draggingObj.draw(c);c.restore()},showDragging:function(b,c,d,e,f,
g,h){DragLayer._ignoreEvents=true;DragLayer._showDragLayer();DragLayer._draggingSource=null;DragLayer._draggingObj=b;animate(g,function(b){DragLayer._context.translateX=c+(e-c)*b/g;DragLayer._context.translateY=d+(f-d)*b/g;DragLayer.draw()},function(){DragLayer._ignoreEvents=false;DragLayer._hideDragLayer();DragLayer._draggingObj=null;h&&typeof h=="function"&&h(e,f)})}};"undefined"==typeof window.WinMediaAssets&&(WinMediaAssets={showSearch:!0,currentPath:"",init:function(){}});
WinMediaAssets.DragObject=function(b,c,d){this.path=b.substring(0,5)=="ide/"?b:mediaTreeRoot+b;this.ext=getFileExt(b).substring(1);this.file=getFilename(d);this.img=new Image;this.img.src=c};WinMediaAssets.DragObject.prototype.draw=function(b){var c=this.img.width,d=this.img.height;if(c>128){d=d*128/c;c=128}if(d>128){c=c*128/d;d=128}b.drawImage(this.img,-c/2,-d/2,c,d)};IDE.Clipboard={undoStack:[],redoIndex:0,item:{}};IDE.Clipboard.init=function(){IDE.Clipboard.item={}};
IDE.Clipboard.clear=function(){IDE.Clipboard.item={}};IDE.Clipboard.add=function(b,c){IDE.Clipboard.item[b]=c};IDE.Clipboard.remove=function(b){IDE.Clipboard.item[b]=null};IDE.Clipboard.get=function(b){return IDE.Clipboard.item[b]};
IDE.Clipboard.addUndo=function(b){IDE.Clipboard.undoStack.length>0&&IDE.Clipboard.redoIndex<IDE.Clipboard.undoStack.length&&IDE.Clipboard.undoStack.splice(IDE.Clipboard.redoIndex,IDE.Clipboard.undoStack.length-IDE.Clipboard.redoIndex);IDE.Clipboard.undoStack.push(b);IDE.Clipboard.undoStack.length>undoLimit?IDE.Clipboard.undoStack.splice(0,1):IDE.Clipboard.redoIndex++};IDE.Clipboard.popUndo=function(){IDE.Clipboard.undoStack.length>0&&IDE.Clipboard.redoIndex>0&&IDE.Clipboard.redoIndex--};
IDE.Clipboard.doUndo=function(){if(IDE.Clipboard.undoStack.length>0&&IDE.Clipboard.redoIndex>0){IDE.Clipboard.undoStack[IDE.Clipboard.redoIndex-1].doUndo();IDE.Clipboard.redoIndex--}$("#win-assets .actors > ul > li.stacked").each(function(){var b=$(this).data("sprite");$(this).find("li").each(function(){var c=$(this).data("sprite");Runtime.unregisterScripts(c);c.scripts=b.scripts;Runtime.registerScripts(c)})})};
IDE.Clipboard.doRedo=function(){if(IDE.Clipboard.undoStack.length>0&&IDE.Clipboard.redoIndex<IDE.Clipboard.undoStack.length){IDE.Clipboard.undoStack[IDE.Clipboard.redoIndex].doRedo();IDE.Clipboard.redoIndex++}$("#win-assets .actors > ul > li.stacked").each(function(){var b=$(this).data("sprite");$(this).find("li").each(function(){var c=$(this).data("sprite");Runtime.unregisterScripts(c);c.scripts=b.scripts;Runtime.registerScripts(c)})})};
IDE.Clipboard.undoDeleteActor=function(b){IDE.Clipboard.addUndo({sprite:b,doRedo:function(){this.sprite.deleteActor()},doUndo:function(){Runtime.sprites.push(this.sprite);Runtime.registerScripts(this.sprite);Runtime.stage.add(this.sprite.spriteObj);Runtime.stage.draw();Physics.addBody({},this.sprite.spriteObj);Sprites._broadcastSpriteListeners("add",this.sprite);IDE.selectAsset(this.sprite)}})};
IDE.Clipboard.undoCloneActor=function(b){IDE.Clipboard.addUndo({sprite:b,doRedo:function(){Runtime.sprites.push(this.sprite);Runtime.registerScripts(this.sprite);Runtime.stage.add(this.sprite.spriteObj);Runtime.stage.draw();Physics.addBody({},this.sprite.spriteObj);WinAssets.trackActor(this.sprite);WinTools.trackActor(this.sprite);IDE.selectAsset(this.sprite);Sprites._broadcastSpriteListeners("add",this.sprite)},doUndo:function(){this.sprite.deleteActor()}})};
IDE.Clipboard.undoAddActor=function(b){IDE.Clipboard.addUndo({sprite:b,doRedo:function(){Runtime.sprites.push(this.sprite);Runtime.registerScripts(this.sprite);Runtime.stage.add(this.sprite.spriteObj);Runtime.stage.draw();Physics.addBody({},this.sprite.spriteObj);WinAssets.trackActor(this.sprite);WinTools.trackActor(this.sprite);IDE.selectAsset(this.sprite);Sprites._broadcastSpriteListeners("add",this.sprite)},doUndo:function(){this.sprite.deleteActor()}})};
IDE.Clipboard.undoAddSound=function(b,c){IDE.Clipboard.addUndo({sprite:b,sound:c,doRedo:function(){this.soundIndex!==void 0&&this.soundIndex<this.sprite.sounds.length?this.sprite.sounds.splice(this.soundIndex,0,this.sound):this.sprite.sounds.push(this.sound);Sprites._broadcastSpriteListeners("updateAddSound",this.sprite,this.sound)},doUndo:function(){for(var b=0;b<this.sprite.sounds.length;b++)if(this.sprite.sounds[b]==this.sound){this.soundIndex=b;this.sprite.sounds.splice(b,1);Sprites._broadcastSpriteListeners("updateDeleteSound",
this.sprite,this.sound);break}}})};
IDE.Clipboard.undoDeleteSound=function(b,c,d){IDE.Clipboard.addUndo({sprite:b,sound:c,soundIndex:d,doRedo:function(){for(var b=0;b<this.sprite.sounds.length;b++)if(this.sprite.sounds[b]==this.sound){this.soundIndex=b;this.sprite.sounds.splice(b,1);Sprites._broadcastSpriteListeners("updateDeleteSound",this.sprite,this.sound);break}},doUndo:function(){this.soundIndex!==void 0&&this.soundIndex<this.sprite.sounds.length?this.sprite.sounds.splice(this.soundIndex,0,this.sound):this.sprite.sounds.push(this.sound);
this.sprite==Runtime.background?IDE.selectAsset(null):IDE.selectAsset(this.sprite);Sprites._broadcastSpriteListeners("updateAddSound",this.sprite,this.sound)}})};
IDE.Clipboard.undoAddCostume=function(b,c){IDE.Clipboard.addUndo({sprite:b,costume:c,doRedo:function(){if(this.costumeIndex!==void 0&&this.costumeIndex<this.sprite.costumes.length)this.sprite.costumes.splice(this.costumeIndex,0,this.costume);else{this.sprite.costumes.push(this.costume);this.sprite.setCostumeByName(this.costume.name)}this.sprite==Runtime.background?IDE.selectAsset(null):IDE.selectAsset(this.sprite);Sprites._broadcastSpriteListeners("updateAddCostume",this.sprite,this.costume)},doUndo:function(){for(var b=
0;b<this.sprite.costumes.length;b++)if(this.sprite.costumes[b]==this.costume){this.costumeIndex=b;this.sprite.costumes.splice(b,1);b>0?this.sprite.setCostumeByName(this.sprite.costumes[b-1].name):this.sprite.setCostumeByName("");Sprites._broadcastSpriteListeners("updateDeleteCostume",this.sprite,this.costume);break}}})};
IDE.Clipboard.undoDeleteCostume=function(b,c,d){IDE.Clipboard.addUndo({sprite:b,costume:c,costumeIndex:d,doRedo:function(){for(var b=0;b<this.sprite.costumes.length;b++)if(this.sprite.costumes[b]==this.costume){this.costumeIndex=b;this.sprite.costumes.splice(b,1);b>0?this.sprite.setCostumeByName(this.sprite.costumes[b-1].name):this.sprite.setCostumeByName("");Sprites._broadcastSpriteListeners("updateDeleteCostume",this.sprite,this.costume);break}},doUndo:function(){if(this.costumeIndex!==void 0&&
this.costumeIndex<this.sprite.costumes.length)this.sprite.costumes.splice(this.costumeIndex,0,this.costume);else{this.sprite.costumes.push(this.costume);this.sprite.setCostumeByName(this.costume.name)}this.sprite==Runtime.background?IDE.selectAsset(null):IDE.selectAsset(this.sprite);Sprites._broadcastSpriteListeners("updateAddCostume",this.sprite,this.costume)}})};
IDE.Clipboard.undoStage=function(b){IDE.Clipboard.addUndo({sprite:b.sprite,x:b.x,y:b.y,scale:b.scale,rotation:b.rotation,newX:b.sprite.spriteObj.x,newY:b.sprite.spriteObj.y,newScale:b.sprite.spriteObj.scale.x,newRotation:b.sprite.spriteObj.rotation,doRedo:function(){this.sprite.spriteObj.setPosition(this.newX,this.newY);this.sprite.spriteObj.setScale(this.newScale);this.sprite.spriteObj.setRotation(this.newRotation);Runtime.stage.draw()},doUndo:function(){this.sprite.spriteObj.setPosition(this.x,
this.y);this.sprite.spriteObj.setScale(this.scale);this.sprite.spriteObj.setRotation(this.rotation);Runtime.stage.draw()}})};
IDE.Clipboard.undoBlockAction=function(b){var c=ObjectIO.serializeScripts(b);IDE.Clipboard.addUndo({sprite:b,scripts:c,current:null,doRedo:function(){for(var b=0;b<this.sprite.scripts.length;b++)Runtime.unregisterBlock(this.sprite.scripts[b]);var b=WinCode.context.offsetX,c=WinCode.context.offsetY;this.sprite.scripts=[];ObjectIO.deserializeScripts(this.sprite,this.current,this.sprite.locked);WinCode._editBlocks(this.sprite.scripts);WinCode.computeAll();WinCode.context.offsetX=b;WinCode.context.offsetY=
c;WinCode.draw()},doUndo:function(){this.current=ObjectIO.serializeScripts(this.sprite);for(var b=0;b<this.sprite.scripts.length;b++)Runtime.unregisterBlock(this.sprite.scripts[b]);var b=WinCode.context.offsetX,c=WinCode.context.offsetY;this.sprite.scripts=[];ObjectIO.deserializeScripts(this.sprite,this.scripts,this.sprite.locked);WinCode._editBlocks(this.sprite.scripts);WinCode.computeAll();WinCode.context.offsetX=b;WinCode.context.offsetY=c;WinCode.draw()}})};
IDE.Clipboard.undoBlockAttach=function(b,c,d,e){IDE.Clipboard.addUndo({sprite:b,from:c,to:d,block:e,doRedo:function(){IDE.Clipboard._blockDetach(this.sprite,this.block,this.from.next!==void 0);IDE.Clipboard._blockAttach(this.sprite,this.to,this.block)},doUndo:function(){IDE.Clipboard._blockDetach(this.sprite,this.block,this.from.next!==void 0);IDE.Clipboard._blockAttach(this.sprite,this.from,this.block)}})};
IDE.Clipboard.undoBlockDelete=function(b,c,d){IDE.Clipboard.addUndo({sprite:b,save:c,block:d,doRedo:function(){IDE.Clipboard._blockDetach(this.sprite,this.block)},doUndo:function(){IDE.Clipboard._blockAttach(this.sprite,this.save,this.block)}})};
IDE.Clipboard._saveAttachment=function(b){var c={};c.parent=b.parent;c.containerIdx=-1;if(b instanceof Block)if(b.parent!=null){if(b.parent.next!=b){b=b.parent.indexForBlockInContainer(b);if(b>=0)c.containerIdx=b}}else{c.x=b.x;c.y=b.y}else if(b.parent==null){c.x=b.x;c.y=b.y}return c};
IDE.Clipboard._saveAttachmentMiddle=function(b){var c={};c.parent=b.parent;c.next=b.next;c.containerIdx=-1;if(b instanceof Block)if(b.parent!=null){if(b.parent.next!=b){b=b.parent.indexForBlockInContainer(b);if(b>=0)c.containerIdx=b}}else{c.x=b.x;c.y=b.y}else if(b.parent==null){c.x=b.x;c.y=b.y}return c};
IDE.Clipboard._blockDetach=function(b,c,d){if(d){d=null;if(c.next){c.next.parent=c.parent;d=c.next}if(c.parent){for(var d=c.parent,e=false,f=0;f<c.parent._containers.length;f++)if(c.parent._containers[f]==c){c.parent._containers[f]=c.next;e=true;break}if(!e)c.parent.next=c.next}d&&d._computeBounds();c.next=null;c.parent=null}else c.detach();d=b.scripts.indexOf(c);d>=0&&b.scripts.splice(d,1);Runtime.unregisterBlock(c);WinCode.computeAll();WinCode.draw()};
IDE.Clipboard._blockAttach=function(b,c,d){IDE.Clipboard._blockDetach(b,d);if(c)if(c.parent){d.parent=c.parent;if(d instanceof Block){c.containerIdx<0?d.parent.next=d:d.parent.addToContainer(c.containerIdx,d);if(c.next){d.next=c.next;c.next.parent=d;var e=b.scripts.indexOf(c.next);e>=0&&b.scripts.splice(e,1);Runtime.unregisterBlock(c.next)}}else{d.parent=c.parent;c.parent._child=d}}else{d.x=c.x;d.y=c.y;b.scripts.push(d);if(c.next){d.next=c.next;c.next.parent=d;e=b.scripts.indexOf(c.next);e>=0&&b.scripts.splice(e,
1);Runtime.unregisterBlock(c.next)}if(d.func.substring(0,8)=="register"){b=new Script({sprite:b,scriptBlock:d});b.currentBlock=b.scriptBlock;b.invokeStep()}}WinCode.computeAll();WinCode.draw()};
var AnglePicker={init:function(){AnglePicker.angles=$('<canvas class="angle-chooser" style="display:none;width:100px;height:100px;" width="100" height="100"></canvas>');$("body").append(AnglePicker.angles);AnglePicker.ctx=AnglePicker.angles[0].getContext("2d");AnglePicker.angle=0;AnglePicker.angles.mousedown(function(b){AnglePicker.mousedown=true;AnglePicker.updateAngle(b)});AnglePicker.angles.mouseup(function(){if(AnglePicker.mousedown){AnglePicker.mousedown=false;AnglePicker.hide();if(AnglePicker.fnDone){if(AnglePicker.isMath)var b=
(360-Math.round(AnglePicker.angle*180/Math.PI)+360)%360;else{b=(Math.round(AnglePicker.angle*180/Math.PI)+90)%360;b>180&&(b=b-360)}AnglePicker.fnDone(b)}}});$(AnglePicker.angles).mousemove(function(b){AnglePicker.updateAngle(b)})},draw:function(){AnglePicker.ctx.strokeStyle="#000000";AnglePicker.ctx.fillStyle="#ffffff";AnglePicker.ctx.clearRect(0,0,AnglePicker.ctx.canvas.width,AnglePicker.ctx.canvas.height);var b=AnglePicker.ctx.canvas.width/2,c=AnglePicker.ctx.canvas.height/2;AnglePicker.ctx.save();
AnglePicker.ctx.translate(b,c);AnglePicker.ctx.beginPath();AnglePicker.ctx.arc(0,0,AnglePicker.ctx.canvas.width/2,0,2*Math.PI,false);AnglePicker.ctx.fill();AnglePicker.ctx.stroke();AnglePicker.ctx.closePath();AnglePicker.ctx.restore();AnglePicker.ctx.save();AnglePicker.ctx.font="bold 10px Arial";AnglePicker.ctx.strokeStyle="#000";AnglePicker.ctx.fillStyle="#000";for(var d=0;d<360;d=d+10){AnglePicker.ctx.save();AnglePicker.ctx.beginPath();AnglePicker.ctx.translate(b,c);AnglePicker.ctx.rotate(-(90-
d)*Math.PI/180);AnglePicker.ctx.moveTo(b,0);AnglePicker.ctx.lineTo(b-4,0);AnglePicker.ctx.stroke();AnglePicker.ctx.closePath();AnglePicker.ctx.restore()}if(AnglePicker.isMath){AnglePicker.ctx.textAlign="left";AnglePicker.ctx.textBaseline="middle";AnglePicker.ctx.fillText("180",6,c);AnglePicker.ctx.textAlign="right";AnglePicker.ctx.textBaseline="middle";AnglePicker.ctx.fillText("0",AnglePicker.ctx.canvas.width-6,c);AnglePicker.ctx.textAlign="center";AnglePicker.ctx.textBaseline="top";AnglePicker.ctx.fillText("90",
b,6);AnglePicker.ctx.textAlign="center";AnglePicker.ctx.textBaseline="bottom";AnglePicker.ctx.fillText("270",b,AnglePicker.ctx.canvas.height-6)}else{AnglePicker.ctx.textAlign="left";AnglePicker.ctx.textBaseline="middle";AnglePicker.ctx.fillText("-90",6,c);AnglePicker.ctx.textAlign="right";AnglePicker.ctx.textBaseline="middle";AnglePicker.ctx.fillText("90",AnglePicker.ctx.canvas.width-6,c);AnglePicker.ctx.textAlign="center";AnglePicker.ctx.textBaseline="top";AnglePicker.ctx.fillText("0",b,6);AnglePicker.ctx.textAlign=
"center";AnglePicker.ctx.textBaseline="bottom";AnglePicker.ctx.fillText("180",b,AnglePicker.ctx.canvas.height-6)}AnglePicker.ctx.beginPath();AnglePicker.ctx.translate(b,c);AnglePicker.ctx.rotate(AnglePicker.angle);AnglePicker.ctx.moveTo(0,0);AnglePicker.ctx.lineTo(b-4,0);AnglePicker.ctx.stroke();AnglePicker.ctx.moveTo(b-4,0);AnglePicker.ctx.lineTo(b-8,4);AnglePicker.ctx.lineTo(b-8,-4);AnglePicker.ctx.lineTo(b-4,0);AnglePicker.ctx.fill();AnglePicker.ctx.closePath();AnglePicker.ctx.restore()},show:function(b,
c,d,e,f,g,h){c=c-$(AnglePicker.angles).outerWidth()/2;c+$(AnglePicker.angles).outerWidth()>window.innerWidth&&(c=window.innerWidth-$(AnglePicker.angles).outerWidth());d+$(AnglePicker.angles).outerHeight()>window.innerHeight&&(d=e-$(AnglePicker.angles).outerHeight());AnglePicker.isMath=h===true;AnglePicker.angle=h?(360-parseFloat(b))*Math.PI/180:-(90-parseFloat(b))*Math.PI/180;AnglePicker.angles.css("left",c+"px");AnglePicker.angles.css("top",d+"px");AnglePicker.angles.css("display","block");AnglePicker.draw();
AnglePicker.fnUpdate=f;AnglePicker.fnDone=g;AnglePicker.mousedown=false},hide:function(){AnglePicker.angles.css("display","none")},updateAngle:function(b){if(AnglePicker.mousedown){var c=b.pageX-AnglePicker.angles.offset().left,b=b.pageY-AnglePicker.angles.offset().top;AnglePicker.angle=Math.atan2(b-AnglePicker.ctx.canvas.height/2,c-AnglePicker.ctx.canvas.width/2);c=Math.round(AnglePicker.angle*180/Math.PI/5)*5;AnglePicker.angle=c*Math.PI/180;AnglePicker.draw();if(AnglePicker.fnUpdate){if(AnglePicker.isMath)c=
(360-Math.round(AnglePicker.angle*180/Math.PI)+360)%360;else{c=(Math.round(AnglePicker.angle*180/Math.PI)+90)%360;c>180&&(c=c-360)}AnglePicker.fnUpdate(c)}}}};$(document).ready(function(){AnglePicker.init()});
var ColorPicker={init:function(){if($(".color-chooser").length==0){ColorPicker.colors=$('<canvas class="color-chooser" style="display:none;cursor:crosshair;" width="320" height="220"></canvas>');$("body").append(ColorPicker.colors);ColorPicker.ctx=ColorPicker.colors[0].getContext("2d");ColorPicker.ctx.fillStyle="#ffffff";ColorPicker.ctx.fillRect(0,0,ColorPicker.ctx.canvas.width,ColorPicker.ctx.canvas.height);var b=ColorPicker.ctx.createLinearGradient(0,0,ColorPicker.colors.width()-120,0);b.addColorStop(0,
"rgb(255,   0,   0)");b.addColorStop(0.15,"rgb(255,   0, 255)");b.addColorStop(0.33,"rgb(0,     0, 255)");b.addColorStop(0.49,"rgb(0,   255, 255)");b.addColorStop(0.67,"rgb(0,   255,   0)");b.addColorStop(0.84,"rgb(255, 255,   0)");b.addColorStop(1,"rgb(255,   0,   0)");ColorPicker.ctx.fillStyle=b;ColorPicker.ctx.fillRect(0,0,ColorPicker.ctx.canvas.width-120,ColorPicker.ctx.canvas.height);b=ColorPicker.ctx.createLinearGradient(0,0,0,ColorPicker.colors.height());b.addColorStop(0,"rgba(255, 255, 255, 1)");
b.addColorStop(0.5,"rgba(255, 255, 255, 0)");b.addColorStop(0.5,"rgba(0,     0,   0, 0)");b.addColorStop(1,"rgba(0,     0,   0, 1)");ColorPicker.ctx.fillStyle=b;ColorPicker.ctx.fillRect(0,0,ColorPicker.ctx.canvas.width-120,ColorPicker.ctx.canvas.height);b=ColorPicker.ctx.createLinearGradient(0,0,0,ColorPicker.colors.height());b.addColorStop(0,"rgb(255, 255, 255)");b.addColorStop(1,"rgb(0,     0,   0)");ColorPicker.ctx.fillStyle=b;ColorPicker.ctx.fillRect(ColorPicker.ctx.canvas.width-120,0,20,ColorPicker.ctx.canvas.height);
b=["#000000","Black","#0000ff","Blue","#996633","Brown","#00ffff","Cyan","#00ff00","Green","#ff00ff","Magenta","#ff8000","Orange","#800080","Purple","#ff0000","Red","#ffff00","Yellow","#ffffff","White"];ColorPicker.ctx.textAlign="left";ColorPicker.ctx.textBaseline="middle";ColorPicker.ctx.font="normal 14px Arial";for(var c=0;c<b.length;c=c+2){ColorPicker.ctx.fillStyle=b[c];ColorPicker.ctx.fillRect(ColorPicker.ctx.canvas.width-96,c*20/2,20,20);ColorPicker.ctx.strokeStyle="#000";ColorPicker.ctx.fillStyle=
"#000";ColorPicker.ctx.fillText(b[c+1],ColorPicker.ctx.canvas.width-72,c*20/2+10)}ColorPicker.ctx.strokeStyle="#000000";ColorPicker.ctx.strokeRect(0,0,ColorPicker.ctx.canvas.width,ColorPicker.ctx.canvas.height);ColorPicker.mousedown=false;ColorPicker.colors.mousedown(function(b){ColorPicker.mousedown=true;ColorPicker.updateColor(b)});ColorPicker.colors.mouseup(function(b){if(ColorPicker.mousedown){ColorPicker.commitColor(b);ColorPicker.mousedown=false;ColorPicker.hide()}});$(ColorPicker.colors).mousemove(function(b){ColorPicker.updateColor(b)})}},
show:function(b,c,d,e,f){b+$(ColorPicker.colors).outerWidth()>window.innerWidth&&(b=window.innerWidth-$(ColorPicker.colors).outerWidth());c+$(ColorPicker.colors).outerHeight()>window.innerHeight&&(c=d-$(ColorPicker.colors).outerHeight());ColorPicker.colors.css("left",b+"px");ColorPicker.colors.css("top",c+"px");ColorPicker.colors.css("display","block");ColorPicker.fnSelect=e;ColorPicker.fnCommit=f?f:e},hide:function(){ColorPicker.colors.css("display","none")},updateColor:function(b){if(ColorPicker.mousedown){var c=
b.pageX-ColorPicker.colors.offset().left,b=b.pageY-ColorPicker.colors.offset().top,d=ColorPicker.ctx.getImageData(c,b,1,1),c=Math.floor(d.data[0]).toString(16);c.length<2&&(c="0"+c);b=Math.floor(d.data[1]).toString(16);b.length<2&&(b="0"+b);d=Math.floor(d.data[2]).toString(16);d.length<2&&(d="0"+d);ColorPicker.selectedColor="#"+c+b+d;ColorPicker.fnSelect&&ColorPicker.fnSelect(ColorPicker.selectedColor)}},commitColor:function(b){if(ColorPicker.mousedown){var c=b.pageX-ColorPicker.colors.offset().left,
b=b.pageY-ColorPicker.colors.offset().top,d=ColorPicker.ctx.getImageData(c,b,1,1),c=Math.floor(d.data[0]).toString(16);c.length<2&&(c="0"+c);b=Math.floor(d.data[1]).toString(16);b.length<2&&(b="0"+b);d=Math.floor(d.data[2]).toString(16);d.length<2&&(d="0"+d);ColorPicker.selectedColor="#"+c+b+d;ColorPicker.fnCommit&&ColorPicker.fnCommit(ColorPicker.selectedColor)}},updateColorStage:function(b){var c=Runtime.stage.getBuffer(),d=b.pageX-$(Runtime.stage.container).offset().left,b=b.pageY-$(Runtime.stage.container).offset().top,
e=Runtime.stage.getWidth(),f=Runtime.stage.getHeight(),d=Math.floor(d*e/$("#stage-canvas").outerWidth()),b=Math.floor(b*f/$("#stage-canvas").outerHeight()),f=Math.floor(c[d*4+b*4*e]).toString(16);f.length<2&&(f="0"+f);var g=Math.floor(c[d*4+b*4*e+1]).toString(16);g.length<2&&(g="0"+g);c=Math.floor(c[d*4+b*4*e+2]).toString(16);c.length<2&&(c="0"+c);ColorPicker.selectedColor="#"+f+g+c;ColorPicker.fnSelect&&ColorPicker.fnSelect(ColorPicker.selectedColor)}};$(document).ready(function(){ColorPicker.init()});
var System={ready:0,avatar:null,avatarid:null,restoreIde:function(){$("#wincmd-restoreide").addClass("hidden");WinProperties.enable(true);WinTools.enable(true);WinCode.enableDecorations(true);WinCode.enable(true);WinStage.enable(true);WinStage.enableDecorations(true);WinAssets.enable(true);WinAssets.enableDecorations(true);$(".toolbar-top .nav.left .puzzlelabel").detach();$(".toolbar-top .nav.right .puzzlebutton").detach();WinToolbar.enable(true);WinAssets._enableContextMenu=true;WinAssets.enableDelete(true);
IDE._enableKeyboardShortcuts=true;WinCode._enableRun=true;WinCode._enableContextMenu=true;WinCode._enableFieldEdit=true;WinCode._enableDragToDelete=true;WinCode._enableCutCopyPaste=true;for(var b=0;b<g_palette.length;b++)g_palette[b].hidden=false;WinTools.reset();IDE.adjustPanels()},loadActorInto:function(b){System.ready++;getPreference("avatarid",function(c){if(c){System.avatarid=c;ObjectIO.loadSprite("/assets/code/"+System.avatarid+".actor",function(c){System.avatar=c;Runtime.background.variables["runtime.vars.avatarname"]=
c.classname;var e=null;b&&(e=Sprites.getSpriteByName(b));if(e){c.spriteObj.setPosition(e.spriteObj.x+c.costumes[0].cx,e.spriteObj.y+c.costumes[0].cy);for(var f=0;f<c.scripts.length;f++)Runtime.unregisterBlock(c.scripts[f]);c.scripts=[];for(f=0;f<e.scripts.length;f++){var g=e.scripts[f].copy();c.scripts.push(g);if(g.func.substring(0,8)=="register"){g=new Script({sprite:c,scriptBlock:g});g.currentBlock=g.scriptBlock;g.invokeStep()}}e.deleteActor();c.changeSpriteName(b)}Runtime.sendEvent("runtime.actor.initialize",
b,"");System.ready--})}})}};
Script.prototype.blockSystem=function(b){var c=b[0],d=b[1];d=="true"?d="true":d=="false"&&(d="false");$("#wincmd-restoreide").removeClass("hidden");switch(c){case "runtime":d=="start"?Runtime.triggerFlag():d=="stop"&&Runtime.stopScripts();break;case "toolbar":WinToolbar.enable(d);break;case "code":WinCode.enable(d);break;case "code.decorations":WinCode.enableDecorations(d);break;case "code.run":WinCode._enableRun=d;break;case "code.search":WinCode._enableSearch=d;break;case "code.contextmenu":WinCode._enableContextMenu=
d;break;case "code.textfields":WinCode._enableFieldEdit=d;break;case "code.dragdelete":WinCode._enableDragToDelete=d;WinCode._enableDelete=d;break;case "code.cutcopypaste":WinCode._enableCutCopyPaste=d;break;case "tools":WinTools.enable(d);break;case "tools.showcat":WinTools.showCat(d,true);break;case "tools.hidecat":WinTools.showCat(d,false);break;case "properties":WinProperties.enable(d);break;case "stage":WinStage.enable(d);break;case "stage.toolbar":WinStage.enableToolbar(d);break;case "stage.decorations":WinStage.enableDecorations(d);
break;case "assets":WinAssets.enable(d);break;case "assets.decorations":WinAssets.enableDecorations(d);break;case "assets.contextmenu":WinAssets._enableContextMenu=d;break;case "assets.delete":WinAssets.enableDelete(d);break;case "puzzle":if(d=="start"){WinPuzzle.puzzleBegin();WinPuzzle.toolbarRemoveButtons()}else{WinPuzzle.puzzleEnd();WinCode.enable(false);WinProperties.enable(false)}break;case "puzzle.toolbar.title":WinPuzzle.toolbarTitle(d);break;case "puzzle.toolbar.text":WinPuzzle.toolbarText(d);
break;case "puzzle.toolbar.button":WinPuzzle.toolbarButton(d,function(){Runtime.sendEvent("runtime.puzzle.toolbar.buttonclick","any",d)});break;case "story.next":IDE._clearDirty();IDE._doActorSave(System.avatar,System.avatar.classname,"Avatar","My Avatar",false,true,function(){$.ajax({url:"/api/projectid",data:{n:d},success:function(b){if(b)window.location="ide/?director="+escape("directorbook?id="+b)}})});break;case "loadavatarinto":System.loadActorInto(d);break;case "avatar.loadpose":for(b=0;b<
Runtime.sprites.length;b++){c=Runtime.sprites[b];if(c.avatarid){for(var e="avatar://"+c.avatarid+"/"+d+"/",f=false,g=0;g<c.costumes.length;g++)if(c.costumes[g].img.indexOf(e)==0){f=true;break}if(!f)for(g=1;g<Avatar.totalFrames;g++)c.addCostume({img:e+g,name:d+g})}}case "hilighttext":IDE.showAnnotation({text:d,show:IDE.showAnnotation({isVisible:true})});break;case "hilightblock":if(f=Runtime.findBlockWithTag(d)){f.actor?IDE.selectAsset(f.actor):IDE.selectAsset(null);WinCode.showAnnotation(f.block,
null,function(){console.log("closed")})}}};
var RenderCode={_supported:["tynker","javascript","python","swift"],codeType:"tynker",mappings:{},COLOR_KEYWORD:"{color:fcafff}",COLOR_NUMBER_CONSTANT:"{color:ffe875}",COLOR_STRING_CONSTANT:"{color:ffe875}",COLOR_IDENTIFIER:"{color:37daff}",COLOR_RESET:"{color:reset}",reIdent:RegExp(/[^a-zA-Z0-9_]/g),reClean:RegExp(/_+/g),reClean2:RegExp(/_*$/g),reParams:RegExp(/{((choice:)?([a-zA-Z0-9 ]+):?([-a-zA-Z0-9#_./!? ]+)?)}/g),setCodeType:function(b){if(this._supported.indexOf(b)>=0){var c=this.codeType;
this.codeType=b;if(c!=b){$(".code-selector li").removeClass("selected");$(".code-selector li."+this.codeType).addClass("selected");window.WinCode&&WinCode.reRender();window.WinTools&&WinTools.reRender()}}},getCodeType:function(){return this.codeType},startRequiresClosingBracket:function(b){return this.codeType!="tynker"&&!b.hasFlap},ensureIdentifier:function(b){b=b.replace(this.reParams,"");b=b.replace(this.reIdent,"_");b[0]>="0"&&b[0]<="9"&&(b="_"+b);b=b.replace(this.reClean,"_");return b=b.replace(this.reClean2,
"")},getNamedParameters:function(b){var c=[],d;do{d=this.reParams.exec(b);d!=null&&(d[2]=="choice:"?d[4]?c.push([d[3],"choice:"+d[3]+":"+d[4],d[1]]):c.push([d[3],"choice:"+d[3],d[1]]):d[4]?d[3]!="image"&&c.push([d[4],d[3]+":"+d[4],d[1]]):d[3]=="boolean"?c.push([d[3],d[3]+":false",d[1]]):d[3]=="number"?c.push([d[3],d[3]+":0",d[1]]):d[3]=="color"?d[4]?c.push([d[3],d[3]+":"+d[4],d[1]]):c.push([d[3],d[3],d[1]]):c.push([d[3],d[3],d[1]]))}while(d!=null);return c},getCodeStartLabel:function(b){var c=b.labelText;
if(this.isCode()){if(b.func){var d=this.mappings[this.codeType];if(d){var e=d[b.func];if(e){c=e[0];if(b.name){c=b.labelText?c.replace("%s",this.ensureIdentifier(b.labelText)):c.replace("%s",this.ensureIdentifier(b.name));d="";b=this.getNamedParameters(b.labelText);for(e=0;e<b.length;e++){var f=b[e],g=this.ensureIdentifier(f[0]),d=this.codeType=="swift"?d+(RenderCode.COLOR_IDENTIFIER+g+RenderCode.COLOR_RESET+":{"+f[1]+"}"):d+("{"+f[1]+"}");e<b.length-1&&(d=d+", ")}c=c.replace("%s",d)}}else if(b.func&&
b.func!="nop"){e=b.value?d.valueControlCall:d.blockControlCall;c=e[0];c=c.replace("%s",this.ensureIdentifier(b.labelText));d="";b=this.getNamedParameters(b.labelText);for(e=0;e<b.length;e++){f=b[e];g=this.ensureIdentifier(f[0]);d=this.codeType=="swift"?d+(RenderCode.COLOR_IDENTIFIER+g+RenderCode.COLOR_RESET+":{"+f[2]+"}"):d+("{"+f[2]+"}");e<b.length-1&&(d=d+", ")}c=c.replace("%s",d)}}}}else c=b.labelText;return c},getCodeEndLabel:function(b){var c;switch(this.codeType){case "javascript":case "swift":c=
"}";break;default:c=""}if(this.isCode()&&b.func){var d=RenderCode.mappings[RenderCode.codeType];if(d)(b=d[b.func])&&(c=b[1])}return c},getElseIfLabel:function(){var b="";switch(this.codeType){case "python":b=RenderCode.COLOR_KEYWORD+"elif "+RenderCode.COLOR_RESET+"({boolean}) {button:remove}:";break;case "javascript":b="} "+RenderCode.COLOR_KEYWORD+"else if "+RenderCode.COLOR_RESET+"({boolean}) {button:remove} {";break;case "swift":b="} "+RenderCode.COLOR_KEYWORD+"else if "+RenderCode.COLOR_RESET+
"{boolean} {button:remove} {";break;default:b="else if {boolean} then {button:remove}"}return b},getElseLabel:function(){var b="";switch(this.codeType){case "python":b=RenderCode.COLOR_KEYWORD+"else "+RenderCode.COLOR_RESET+"{button:add}:";break;case "javascript":case "swift":b="} "+RenderCode.COLOR_KEYWORD+"else "+RenderCode.COLOR_RESET+"{button:add} {";break;default:b="else {button:add}"}return b},isCode:function(){return this.codeType!="tynker"}};
RenderCode.mappings.javascript={registerFlagTrigger:[RenderCode.COLOR_KEYWORD+"function "+RenderCode.COLOR_IDENTIFIER+"main"+RenderCode.COLOR_RESET+"() {","}"],registerSpriteTrigger:[RenderCode.COLOR_KEYWORD+"function "+RenderCode.COLOR_IDENTIFIER+"when_clicked"+RenderCode.COLOR_RESET+"() {","}"],registerBroadcastTrigger:[RenderCode.COLOR_IDENTIFIER+"when_receive"+RenderCode.COLOR_RESET+'("'+RenderCode.COLOR_STRING_CONSTANT+"{events}"+RenderCode.COLOR_RESET+'", '+RenderCode.COLOR_KEYWORD+"function"+
RenderCode.COLOR_RESET+"() {","});"],registerKeyTrigger:[RenderCode.COLOR_IDENTIFIER+"when_key_pressed"+RenderCode.COLOR_RESET+'("'+RenderCode.COLOR_STRING_CONSTANT+"{choice:keys}"+RenderCode.COLOR_RESET+'", '+RenderCode.COLOR_KEYWORD+"function"+RenderCode.COLOR_RESET+"() {","});"],registerFunction:[RenderCode.COLOR_KEYWORD+"function "+RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s) {","}"],blockControlIf:[RenderCode.COLOR_KEYWORD+"if "+RenderCode.COLOR_RESET+"({boolean}) {","}"],blockControlIfElse:[RenderCode.COLOR_KEYWORD+
"if "+RenderCode.COLOR_RESET+"({boolean}) {","}"],blockControlWhile:[RenderCode.COLOR_KEYWORD+"while "+RenderCode.COLOR_RESET+"({boolean}) {","}"],blockControlRepeatUntil:[RenderCode.COLOR_KEYWORD+"while "+RenderCode.COLOR_RESET+"(!{boolean}) {","}"],blockControlRepeat:[RenderCode.COLOR_KEYWORD+"for "+RenderCode.COLOR_RESET+"("+RenderCode.COLOR_KEYWORD+"var "+RenderCode.COLOR_IDENTIFIER+"i"+RenderCode.COLOR_RESET+" = "+RenderCode.COLOR_NUMBER_CONSTANT+"0"+RenderCode.COLOR_RESET+"; "+RenderCode.COLOR_IDENTIFIER+
"i "+RenderCode.COLOR_RESET+"< "+RenderCode.COLOR_NUMBER_CONSTANT+"{number:9}"+RenderCode.COLOR_RESET+"; "+RenderCode.COLOR_IDENTIFIER+"i"+RenderCode.COLOR_RESET+"++) {","}"],blockControlForever:[RenderCode.COLOR_KEYWORD+"while "+RenderCode.COLOR_RESET+"("+RenderCode.COLOR_KEYWORD+"true"+RenderCode.COLOR_RESET+") {","}"],blockControlCall:[RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s);",""],valueControlCall:[RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s)",""],blockControlCallLibrary:[RenderCode.COLOR_IDENTIFIER+
"%s"+RenderCode.COLOR_RESET+"(%s);",""],valueControlCallLibrary:[RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s)",""],valueOpAdd:["{number} + {number}",""],valueOpSubtract:["{number} - {number}",""],valueOpMultiply:["{number} * {number}",""],valueOpDivide:["{number} / {number}",""],valueOpRandom:["Math.randomNumber({number}, {number})",""],valueOpLess:["{string} < {string}",""],valueOpEqual:["{string} == {string}",""],valueOpGreater:["{string} > {string}",""],valueOpAnd:["{boolean} && {boolean}",
""],valueOpOr:["{boolean} || {boolean}",""],valueOpNot:["!{boolean}",""],valueOpJoin:["{string} + {string}",""],valueOpLetter:["{string}[{number}]",""],valueOpLength:["{string}.length",""],valueOpMod:["{number} % {number}",""],valueOpRound:["Math.round({number})",""],valueOpMath:["Math.{string}({number})",""],valueOpMath2:["Math.{string}({number}, {number})",""],valueOpConstants:["Math.{string}",""],valueOpBinary:["{number} {choice:operator} {number}",""],valueOpBitNot:["~{number}",""],blockControlWait:[RenderCode.COLOR_IDENTIFIER+
"wait"+RenderCode.COLOR_RESET+"({number});",""],blockControlBroadcast:[RenderCode.COLOR_IDENTIFIER+"broadcastMessage"+RenderCode.COLOR_RESET+"({string});",""],blockControlBroadcastWait:[RenderCode.COLOR_IDENTIFIER+"broadcastMessageAndWait"+RenderCode.COLOR_RESET+"({string});",""],blockControlPostMessage:[RenderCode.COLOR_IDENTIFIER+"postMessage"+RenderCode.COLOR_RESET+"({string}, {string}, {string});",""],blockControlPostMessageAndWait:[RenderCode.COLOR_IDENTIFIER+"postMessageAndWait"+RenderCode.COLOR_RESET+
"({string}, {string}, {string});",""]};
RenderCode.mappings.python={registerFlagTrigger:[RenderCode.COLOR_KEYWORD+"def "+RenderCode.COLOR_IDENTIFIER+"main"+RenderCode.COLOR_RESET+"():",""],registerSpriteTrigger:[RenderCode.COLOR_KEYWORD+"def "+RenderCode.COLOR_IDENTIFIER+"clicked"+RenderCode.COLOR_RESET+"():",""],registerBroadcastTrigger:[RenderCode.COLOR_KEYWORD+"if "+RenderCode.COLOR_IDENTIFIER+"msg_received "+RenderCode.COLOR_RESET+'== "'+RenderCode.COLOR_STRING_CONSTANT+"{events}"+RenderCode.COLOR_RESET+'":',""],registerKeyTrigger:[RenderCode.COLOR_KEYWORD+
"if "+RenderCode.COLOR_IDENTIFIER+"key_pressed "+RenderCode.COLOR_RESET+'== "'+RenderCode.COLOR_STRING_CONSTANT+"{choice:keys}"+RenderCode.COLOR_RESET+'":',""],registerFunction:[RenderCode.COLOR_KEYWORD+"def "+RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s):",""],blockControlIf:[RenderCode.COLOR_KEYWORD+"if "+RenderCode.COLOR_RESET+"({boolean}):",""],blockControlIfElse:[RenderCode.COLOR_KEYWORD+"if "+RenderCode.COLOR_RESET+"({boolean}):",""],blockControlWhile:[RenderCode.COLOR_KEYWORD+
"while "+RenderCode.COLOR_RESET+"({boolean}):",""],blockControlRepeatUntil:[RenderCode.COLOR_KEYWORD+"while "+RenderCode.COLOR_RESET+"("+RenderCode.COLOR_KEYWORD+"not "+RenderCode.COLOR_RESET+"{boolean}):",""],blockControlRepeat:[RenderCode.COLOR_KEYWORD+"for "+RenderCode.COLOR_IDENTIFIER+"i"+RenderCode.COLOR_RESET+" in "+RenderCode.COLOR_KEYWORD+"range"+RenderCode.COLOR_RESET+"("+RenderCode.COLOR_NUMBER_CONSTANT+"0"+RenderCode.COLOR_RESET+", "+RenderCode.COLOR_NUMBER_CONSTANT+"{number:9}"+RenderCode.COLOR_RESET+
"):",""],blockControlForever:[RenderCode.COLOR_KEYWORD+"while "+RenderCode.COLOR_KEYWORD+"true"+RenderCode.COLOR_RESET+":",""],blockControlCall:[RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s)",""],valueControlCall:[RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s)",""],blockControlCallLibrary:[RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s)",""],valueControlCallLibrary:[RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s)",""],valueOpAdd:["{number} + {number}",
""],valueOpSubtract:["{number} - {number}",""],valueOpMultiply:["{number} * {number}",""],valueOpDivide:["{number} / {number}",""],valueOpRandom:["random({number}, {number})",""],valueOpLess:["{string} < {string}",""],valueOpEqual:["{string} == {string}",""],valueOpGreater:["{string} > {string}",""],valueOpAnd:["{boolean} and {boolean}",""],valueOpOr:["{boolean} or {boolean}",""],valueOpNot:["not {boolean}",""],valueOpJoin:["{string} + {string}",""],valueOpLetter:["{string}[{number}]",""],valueOpLength:["len({string})",
""],valueOpMod:["{number} % {number}",""],valueOpRound:["round({number})",""],valueOpMath:["{string}({number})",""],valueOpMath2:["{string}({number}, {number})",""],valueOpConstants:["{string}",""],valueOpBinary:["{number} {choice:operator} {number}",""],valueOpBitNot:["~{number}",""],blockControlWait:[RenderCode.COLOR_IDENTIFIER+"sleep"+RenderCode.COLOR_RESET+"({number});",""],blockControlBroadcast:[RenderCode.COLOR_IDENTIFIER+"broadcastMessage"+RenderCode.COLOR_RESET+"({string});",""],blockControlBroadcastWait:[RenderCode.COLOR_IDENTIFIER+
"broadcastMessageAndWait"+RenderCode.COLOR_RESET+"({string});",""],blockControlPostMessage:[RenderCode.COLOR_IDENTIFIER+"postMessage"+RenderCode.COLOR_RESET+"({string}, {string}, {string});",""],blockControlPostMessageAndWait:[RenderCode.COLOR_IDENTIFIER+"postMessageAndWait"+RenderCode.COLOR_RESET+"({string}, {string}, {string});",""]};
RenderCode.mappings.swift={registerFlagTrigger:[RenderCode.COLOR_KEYWORD+"func "+RenderCode.COLOR_IDENTIFIER+"main"+RenderCode.COLOR_RESET+"() {","}"],registerSpriteTrigger:[RenderCode.COLOR_KEYWORD+"func "+RenderCode.COLOR_IDENTIFIER+"when_touched"+RenderCode.COLOR_RESET+"() {","}"],registerBroadcastTrigger:[RenderCode.COLOR_IDENTIFIER+"when_receive"+RenderCode.COLOR_RESET+'(event:"'+RenderCode.COLOR_STRING_CONSTANT+"{events}"+RenderCode.COLOR_RESET+'", '+RenderCode.COLOR_IDENTIFIER+"closure"+RenderCode.COLOR_RESET+
": {{ () -> "+RenderCode.COLOR_STRING_CONSTANT+"Void "+RenderCode.COLOR_KEYWORD+"in"+RenderCode.COLOR_RESET,"});"],registerKeyTrigger:[RenderCode.COLOR_IDENTIFIER+"when_key_pressed"+RenderCode.COLOR_RESET+'(keyName:"'+RenderCode.COLOR_STRING_CONSTANT+"{choice:keys}"+RenderCode.COLOR_RESET+'", '+RenderCode.COLOR_IDENTIFIER+"closure"+RenderCode.COLOR_RESET+": {{ () -> "+RenderCode.COLOR_STRING_CONSTANT+"Void "+RenderCode.COLOR_KEYWORD+"in"+RenderCode.COLOR_RESET,"});"],registerFunction:[RenderCode.COLOR_KEYWORD+
"func "+RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s) {","}"],blockControlIf:[RenderCode.COLOR_KEYWORD+"if"+RenderCode.COLOR_RESET+" {boolean} {","}"],blockControlIfElse:[RenderCode.COLOR_KEYWORD+"if"+RenderCode.COLOR_RESET+" {boolean} {","}"],blockControlWhile:[RenderCode.COLOR_KEYWORD+"while"+RenderCode.COLOR_RESET+" {boolean} {","}"],blockControlRepeatUntil:[RenderCode.COLOR_KEYWORD+"while "+RenderCode.COLOR_RESET+"(!{boolean}) {","}"],blockControlRepeat:[RenderCode.COLOR_KEYWORD+
"for"+RenderCode.COLOR_RESET+" _ "+RenderCode.COLOR_KEYWORD+"in "+RenderCode.COLOR_NUMBER_CONSTANT+"1"+RenderCode.COLOR_RESET+"..."+RenderCode.COLOR_NUMBER_CONSTANT+"{number:9} "+RenderCode.COLOR_RESET+"{","}"],blockControlForever:[RenderCode.COLOR_KEYWORD+"while "+RenderCode.COLOR_RESET+"("+RenderCode.COLOR_KEYWORD+"true"+RenderCode.COLOR_RESET+") {","}"],blockControlCall:[RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s)",""],valueControlCall:[RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+
"(%s)",""],blockControlCallLibrary:[RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s)",""],valueControlCallLibrary:[RenderCode.COLOR_IDENTIFIER+"%s"+RenderCode.COLOR_RESET+"(%s)",""],valueOpAdd:["{number} + {number}",""],valueOpSubtract:["{number} - {number}",""],valueOpMultiply:["{number} * {number}",""],valueOpDivide:["{number} / {number}",""],valueOpRandom:["Math.randomNumber({number}, {number})",""],valueOpLess:["{string} < {string}",""],valueOpEqual:["{string} == {string}",""],valueOpGreater:["{string} > {string}",
""],valueOpAnd:["{boolean} && {boolean}",""],valueOpOr:["{boolean} || {boolean}",""],valueOpNot:["!{boolean}",""],valueOpJoin:["{string} + {string}",""],valueOpLetter:["{string}[{number}]",""],valueOpLength:["{string}.length",""],valueOpMod:["{number} % {number}",""],valueOpRound:["Math.round({number})",""],valueOpMath:["Math.{string}({number})",""],valueOpMath2:["Math.{string}({number}, {number})",""],valueOpConstants:["Math.{string}",""],valueOpBinary:["{number} {choice:operator} {number}",""],
valueOpBitNot:["~{number}",""],blockControlWait:[RenderCode.COLOR_IDENTIFIER+"delay"+RenderCode.COLOR_RESET+"(seconds:{number});",""],blockControlBroadcast:[RenderCode.COLOR_IDENTIFIER+"broadcastMessage"+RenderCode.COLOR_RESET+"(message:{string});",""],blockControlBroadcastWait:[RenderCode.COLOR_IDENTIFIER+"broadcastMessageAndWait"+RenderCode.COLOR_RESET+"(message:{string});",""],blockControlPostMessage:[RenderCode.COLOR_IDENTIFIER+"postMessage"+RenderCode.COLOR_RESET+"(message:{string}, actor:{string}, withValue:{string});",
""],blockControlPostMessageAndWait:[RenderCode.COLOR_IDENTIFIER+"postMessageAndWait"+RenderCode.COLOR_RESET+"(message:{string}, actor:{string}, withValue:{string});",""]};
var g_fnMapping={"this.broadcast":"blockControlBroadcast","this.broadcastAndWait":"blockControlBroadcastWait","this.post":"blockControlPostMessage","this.postAndWait":"blockControlPostMessageAndWait","this.getMessageValue":"valueControlMessageValue","this.getMessageSource":"valueControlMessageSource","this.isClone":"valueControlIsClone","this.wait":"blockControlWait","this.waitUntil":"blockControlWaitUntil","this.clone":"blockControlCloneActor","this.getLastClonedActor":"valueControlLastClonedActor",
"this.getOriginalNameFromClone":"valueControlCloneName","this.deleteActor":"blockControlDeleteActor","this.print":"blockControlPrint","this.terminate":"blockControlStop","this.motion.move":"blockMotionMove","this.motion.turnCW":"blockMotionTurnCW","this.motion.turnCCW":"blockMotionTurnCCW","this.motion.pointDirection":"blockMotionPointDirection","this.motion.setAngle":"blockMotionPointAngle","this.motion.pointTowards":"blockMotionPointTowards","this.motion.moveTo":"blockMotionGoTo","this.motion.follow":"blockMotionGoTowards",
"this.motion.glide":"blockMotionGlide","this.motion.changeXBy":"blockMotionChangeXBy","this.motion.setX":"blockMotionSetX","this.motion.changeYBy":"blockMotionChangeYBy","this.motion.setY":"blockMotionSetY","this.motion.bounceOnEdge":"blockMotionBounceOnEdge","this.motion.setRotationStyle":"blockMotionRotationStyle","this.motion.getX":"valueMotionXPosition","this.motion.getY":"valueMotionYPosition","this.motion.getDirection":"valueMotionDirection","this.motion.getAngle":"valueMotionAngle","this.animation.setSpeed":"blockAnimationSetSpeed",
"this.animation.setPart":"blockLooksSetCharacterPart","this.animation.getPart":"valueLooksGetCharacterPart","this.animation.waitFor":"blockAnimationWaitFor","this.animation.stop":"blockAnimationStop","this.animation.isRunning":"valueAnimationIsRunning","this.animation.animationLength":"valueAnimationTime","this.animation.whenDone":"registerAnimationDone","this.animation.animate":"blockAnimationAnimate","this.animation.simpleMoveTo":"blockAnimationSimpleMoveTo","this.animation.simpleMoveBy":"blockAnimationSimpleMoveBy",
"this.animation.simpleRotateTo":"blockAnimationSimpleRotateTo","this.animation.simpleRotateBy":"blockAnimationSimpleRotateBy","this.animation.simpleScaleTo":"blockAnimationSimpleScaleTo","this.animation.simpleScaleBy":"blockAnimationSimpleScaleBy","this.animation.simpleBezierTo":"blockAnimationSimpleBezierTo","this.animation.simpleBezierBy":"blockAnimationSimpleBezierBy","this.animation.simpleEffectTo":"blockAnimationSimpleEffectTo","this.animation.simpleEffectBy":"blockAnimationSimpleEffectBy","this.animation.simpleSwitchCostume":"blockAnimationSimpleSwitchCostume",
"this.animation.simpleSwitchCostumeAndWait":"blockAnimationSimpleSwitchCostumeAndWait","this.animation.rotateTo":"blockAnimationRotateTo","this.animation.rotateBy":"blockAnimationRotateBy","this.animation.moveTo":"blockAnimationMoveTo","this.animation.moveBy":"blockAnimationMoveBy","this.animation.scaleTo":"blockAnimationScaleTo","this.animation.scaleBy":"blockAnimationScaleBy","this.animation.bezierBy":"blockAnimationBezierBy","this.animation.bezierTo":"blockAnimationBezierTo","this.animation.effectBy":"blockAnimationEffectBy",
"this.animation.effectTo":"blockAnimationEffectTo","this.animation.changeCostumes":"blockAnimationSwitchCostume","this.looks.setCostume":"blockLooksSwitchCostume","this.looks.nextCostume":"blockLooksNextCostume","this.looks.firstCostumeInGroup":"blockLooksFirstCostumeInGroup","this.looks.nextCostumeInGroup":"blockLooksNextCostumeInGroup","this.looks.getCostumeIndex":"valueLooksCostumeNum","this.looks.getCostume":"valueLooksCostumeName","this.looks.setBackgroundColor":"blockLooksBackgroundColor","this.looks.setBackground":"blockLooksSwitchBackground",
"this.looks.setBackgroundAndWait":"blockLooksSwitchBackgroundAndWait","this.looks.nextBackground":"blockLooksNextBackground","this.looks.firstBackgroundInGroup":"blockLooksFirstBackgroundInGroup","this.looks.nextBackgroundInGroup":"blockLooksNextBackgroundInGroup","this.looks.getBackgroundIndex":"valueLooksBackground","this.looks.getBackground":"valueLooksBackgroundName","this.looks.setLabel":"blockLooksSetLabel","this.looks.setBubbleStyle":"blockLooksSetBubble","this.looks.setBubbleDock":"blockLooksSetBubbleDock",
"this.looks.setBubbleWidth":"blockLooksSetBubbleWidth","this.looks.say":"blockLooksSay","this.looks.sayFor":"blockLooksSayFor","this.looks.think":"blockLooksThink","this.looks.thinkFor":"blockLooksThinkFor","this.looks.changeEffect":"blockLooksChangeEffect","this.looks.setEffect":"blockLooksSetEffect","this.looks.resetEffects":"blockLooksClearEffects","this.looks.changeSize":"blockLooksChangeSizeBy","this.looks.setSize":"blockLooksSetSize","this.looks.getSize":"valueLooksSize","this.looks.show":"blockLooksShow",
"this.looks.hide":"blockLooksHide","this.looks.isHidden":"valueLooksIsHidden","this.looks.setLayer":"blockLooksLayer","this.looks.getLayer":"valueLooksLayer","this.looks.bringToFront":"blockLooksGoFront","this.looks.sendToBack":"blockLooksGoBack","this.looks.moveBackward":"blockLooksMoveBack","this.looks.bringForward":"blockLooksMoveFront","this.looks.dialog":"blockLooksDialog","this.looks.prompt":"blockLooksPromptChoices","this.looks.setViewportCamera":"blockLooksViewportCamera","this.looks.showVideo":"blockLooksVideo",
"this.looks.setVideoTransparency":"blockLooksVideoTransparency","this.looks.setLevel":"blockLooksSetLevel","this.looks.getLevel":"valueLooksGetLevel","this.looks.getLevelIndex":"valueLooksGetLevelNum","this.looks.getNumLevels":"valueLooksNumLevels","this.looks.getTile":"valueLooksGetTileAt","this.looks.getTileAtPoint":"valueLooksGetTileAtPoint","this.looks.setTile":"blockLooksSetTileAt","this.looks.setTileAtPoint":"blockLooksSetTileAtPoint","this.sensing.getVideo":"valueSensingVideo","this.sensing.isTouching":"valueSensingTouchingSprite",
"this.sensing.isTouchingClone":"valueSensingTouchingCloneOf","this.sensing.isTouchingColor":"valueSensingTouchingColor","this.sensing.isColorTouchingColor":"valueSensingSeeColor","this.sensing.ask":"blockSensingAskAndWait","this.sensing.askChoices":"blockSensingAskChoices","this.sensing.getAnswer":"valueSensingAnswer","this.sensing.getTiltAngle":"valueSensingTiltAngle","this.sensing.getTiltAmount":"valueSensingTiltAmount","this.sensing.getTiltX":"valueSensingAccelerometerX","this.sensing.getTiltY":"valueSensingAccelerometerY",
"this.sensing.getMouseX":"valueSensingMouseX","this.sensing.getMouseY":"valueSensingMouseY","this.sensing.isMouseDown":"valueSensingMouseDown","this.sensing.isKeyPressed":"valueSensingKeyPressed","this.sensing.getDistance":"valueSensingDistanceToSprite","this.sensing.resetTimer":"blockSensingResetTimer","this.sensing.getTimer":"valueSensingTimer","this.sensing.setSpriteProperty":"blockSensingSpriteProperty","this.sensing.getSpriteProperty":"valueSensingSpriteProperty","this.sensing.getActorName":"valueSensingActorName",
"this.sensing.getActorNameAtIndex":"valueSensingActorNameAt","this.sensing.getActorCount":"valueSensingNumActors","this.sensing.getTouchedActorName":"valueSensingTouchedActorName","this.sensing.getDateTime":"valueSensingDateTime","this.sensing.getScreenLeft":"valueSensingScreenLeft","this.sensing.getScreenRight":"valueSensingScreenRight","this.sensing.getScreenTop":"valueSensingScreenTop","this.sensing.getScreenBottom":"valueSensingScreenBottom","this.sensing.getScreenProperty":"valueSensingStageProperty",
"this.sensing.setTag":"blockSensingSetTag","this.sensing.getTag":"valueSensingGetTag","this.sensing.getUserId":"valueSensingUserId","this.sensing.getUserFirstName":"valueSensingUserFirstName","this.sound.play":"blockSoundPlay","this.sound.playUntilDone":"blockSoundPlayUntilDone","this.sound.stopAll":"blockSoundStopAll","this.sound.playDrum":"blockSoundPlayDrum","this.sound.playRest":"blockSoundRest","this.sound.playNote":"blockSoundPlayNote","this.sound.setInstrument":"blockSoundSetInstrument","this.sound.changeVolume":"blockSoundChangeVolume",
"this.sound.setVolume":"blockSoundSetVolume","this.sound.getVolume":"valueSoundVolume","this.sound.changeTempo":"blockSoundChangeTempo","this.sound.setTempo":"blockSoundSetTempo","this.sound.getTempo":"valueSoundTempo","this.canvas.clear":"blockPenClear","this.canvas.penDown":"blockPenDown","this.canvas.penUp":"blockPenUp","this.canvas.setColor":"blockPenSetColor","this.canvas.changeHue":"blockPenChangeHue","this.canvas.setHue":"blockPenSetHue","this.canvas.changeShade":"blockPenChangeShade","this.canvas.setShade":"blockPenSetShade",
"this.canvas.changePenSize":"blockPenChangeSize","this.canvas.setPenSize":"blockPenSetSize","this.canvas.stamp":"blockPenStamp","this.canvas.setFont":"blockPenSetFont","this.canvas.setFontColor":"blockPenSetFontColor","this.canvas.drawText":"blockPenDrawText","this.canvas.redraw":"blockPenRedraw","this.canvas.setFillColor":"blockPenSetFillColor","this.canvas.setNoFill":"blockPenSetNoFill","this.canvas.drawBezier":"blockPenDrawBezier","this.canvas.drawPoint":"blockPenDrawPoint","this.canvas.drawLine":"blockPenDrawLine",
"this.canvas.drawRect":"blockPenDrawRectangle","this.canvas.drawTriangle":"blockPenDrawTriangle","this.canvas.drawEllipse":"blockPenDrawEllipse","this.canvas.drawTextAt":"blockPenDrawTextAt","this.canvas.drawLocalRect":"blockPenDrawRectangleLocal","this.canvas.drawLocalEllipse":"blockPenDrawRectangleLocal","this.physics.getProperty":"blockPhysicsGetProperty","this.physics.apply":"blockPhysicsApply","this.physics.applyXY":"blockPhysicsApplyXY","this.physics.applyActive":"blockPhysicsSetActorActive",
"this.physics.applyStatic":"blockPhysicsSetActorStatic","this.physics.applyGeometry":"blockPhysicsSetActorGeometry","this.physics.isCollidedWith":"valuePhysicsCollidedWithSprite","this.physics.getCollidedName":"valuePhysicsCollidedWithName","this.physics.applyForce":"blockPhysicsApplyForce","this.physics.applyImpulse":"blockPhysicsApplyImpulse","this.physics.applyForceAtAngle":"blockPhysicsApplyForceAngle","this.physics.applyImpulseAtAngle":"blockPhysicsApplyImpulseAngle","this.physics.applyForceAtXY":"blockPhysicsApplyForceXY",
"this.physics.applyImpulseAtXY":"blockPhysicsApplyImpulseXY","this.physics.applyTorque":"blockPhysicsApplyTorque","this.physics.setActive":"blockPhysicsSetActive","this.physics.setStatic":"blockPhysicsSetStatic","this.physics.setGeometry":"blockPhysicsSetGeometry","this.physics.setDensity":"blockPhysicsSetDensity","this.physics.setFriction":"blockPhysicsSetFriction","this.physics.setRestitution":"blockPhysicsSetRestitution","this.physics.setAngularDamping":"blockPhysicsSetAngularDamping","this.physics.setAngularVelocity":"blockPhysicsSetAngularVelocity",
"this.physics.setLinearDamping":"blockPhysicsSetLinearDamping","this.physics.setLinearVelocity":"blockPhysicsSetLinearVelocity","this.physics.getDensity":"valuePhysicsDensity","this.physics.getFriction":"valuePhysicsFriction","this.physics.getRestitution":"valuePhysicsRestitution","this.physics.getAngularVelocity":"valuePhysicsAngularVelocity","this.physics.getInertia":"valuePhysicsInertia","this.physics.isAwake":"valuePhysicsIsAwake","this.physics.getVelocityX":"valuePhysicsXVelocity","this.physics.getVelocityY":"valuePhysicsYVelocity",
"this.physics.getAngularDamping":"valuePhysicsAngularDamping","this.physics.getLinearDamping":"valuePhysicsLinearDamping","this.physics.setGravity":"blockPhysicsSetGravity","this.physics.getGravityX":"valuePhysicsXGravity","this.physics.getGravityY":"valuePhysicsYGravity","this.physics.start":"blockPhysicsStart","this.physics.stop":"blockPhysicsStop","this.net.saveValue":"blockNetworkSaveValue","this.net.loadValue":"blockNetworkLoadValue","this.net.fetch":"blockNetworkAPI","this.net.parse":"valueNetworkParse",
"this.net.getResult":"valueNetworkResult","mc.onPlayerDied":"registerMCPEEventDied","mc.onPlayerTravelled":"registerMCPEEventPlayer","mc.onPlayerTeleported":"registerMCPEEventTeleported","mc.onPlayerBounced":"registerMCPEEventBounced","mc.onBlockPlaced":"registerMCPEEventBlockPlaced","mc.onBlockBroken":"registerMCPEEventBlockBroken","mc.onMobKilled":"registerMCPEEventMobKilled","mc.onEntitySpawned":"registerMCPEEventEntitySpawned","mc.onItemAcquired":"registerMCPEEventItemAcquired","mc.onItemDropped":"registerMCPEEventItemDropped",
"mc.onChat":"registerMCPEEventChat","mc.onTell":"registerMCPEEventTell","mc.onAnyBlockPlaced":"registerMCPEEventBlockPlacedAny","mc.onAnyBlockBroken":"registerMCPEEventBlockBrokenAny","mc.onAnyMobKilled":"registerMCPEEventMobKilledAny","mc.onAnyEntitySpawned":"registerMCPEEventEntitySpawnedAny","mc.onAnyItemAcquired":"registerMCPEEventItemAcquiredAny","mc.onAnyItemDropped":"registerMCPEEventItemDroppedAny","mc.bot.start":"blockMCPEBotStart","mc.bot.flush":"blockMCPEBotFlush","mc.bot.clear":"blockMCPEBotClear",
"mc.bot.moveBy":"blockMCPEBotMoveBy","mc.bot.moveTo":"blockMCPEBotMoveTo","mc.bot.moveToPlayer":"blockMCPEBotMoveToPlayer","mc.bot.testForBlock":"blockMCPEBotTestForBlock","mc.bot.result":"valueMCPEResult","mc.bot.move":"blockMCPEBotMove","mc.bot.turnLeft":"blockMCPEBotTurnLeft","mc.bot.turnRight":"blockMCPEBotTurnRight","mc.bot.pointTowards":"blockMCPEBotPointDirection","mc.bot.saveCheckpoint":"blockMCPEBotSaveCheckpoint","mc.bot.restoreCheckpoint":"blockMCPEBotRestoreCheckpoint","mc.bot.place":"blockMCPEBotPlaceBlock",
"mc.bot.box":"blockMCPEBotBox","mc.bot.summon":"blockMCPEBotSummon","mc.bot.teleport":"blockMCPEBotTeleport","mc.enchant":"blockMCPEEnchant","mc.give":"blockMCPEGive","mc.teleport":"blockMCPETeleport","mc.setTime":"blockMCPESetTime","mc.kill":"blockMCPEKill","mc.setGameMode":"blockMCPEGameMode","mc.say":"blockMCPESay","mc.tell":"blockMCPETell","mc.setWeather":"blockMCPESetWeather","mc.summon":"blockMCPESummon","mc.agent.move":"blockMCPEAgentMove","mc.agent.turn":"blockMCPEAgentTurn","mc.agent.place":"blockMCPEAgentPlace",
"mc.agent.detect":"blockMCPEAgentDetect","mc.agent.attack":"blockMCPEAgentAttack","mc.agent.destroy":"blockMCPEAgentDestroy","mc.agent.collect":"blockMCPEAgentCollect","mc.agent.till":"blockMCPEAgentTill","mc.agent.dropAll":"blockMCPEAgentDropall","mc.agent.teleport":"blockMCPEAgentTeleport","mc.agent.setFast":"blockMCPEAgentFast"},g_revFnMapping={},key;for(key in g_fnMapping)g_revFnMapping[g_fnMapping[key]]=key;
var g_builtinsCompletion=["this.setState({})","this.onStart(function(){\n});","this.onCondition(function(){return condition;}, function(){\n});","this.onActorClick(function(){\n});",'this.onKeyPress("space", function(){\n});',"this.onSceneChange(function(){\n})","this.onMessageReceived(message, function(){\n})","this.onClone(function(){\n})","this.onDraw(function(){\n})","this.onCollision(function(){\n})","this.onAnimationDone(function(){\n})","this.requestBlock(function(){\n})","Math.abs(theta)",
"Math.acos(theta)","Math.asin(theta)","Math.atan(theta)","Math.atan2(y, x)","Math.ceil(n)","Math.cos(n)","Math.exp(n)","Math.floor(n)","Math.log(n)","Math.max(n, m)","Math.min(n, m)","Math.pow(x, y)","Math.random()","Math.randomRange(min, max)","Math.round(n)","Math.sin(theta)","Math.sqrt(n)","Math.tan(theta)","Math.E","Math.PI","Math.SQRT2","Math.SQRT1_2","Math.LN2","Math.LN10","Math.LOG2E","Math.LOG10E"],g_fnCompletion="this.broadcast(event);this.broadcastAndWait(event);this.post(event, target arg);this.postAndWait(event, target, arg);this.getMessageValue();this.getMessageSource();this.isClone();this.wait(seconds);this.waitUntil(condition);this.clone(actorName);this.getLastClonedActor();this.getOriginalNameFromClone(actorName);this.deleteActor();this.terminate(type);this.motion.move(d);this.motion.turnCW(degrees);this.motion.turnCCW(degrees);this.motion.pointDirection(degrees);this.motion.setAngle(degrees);this.motion.pointTowards(actorName);this.motion.moveTo(x, y);this.motion.follow(actorName);this.motion.glide(seconds, x, y);this.motion.changeXBy(x);this.motion.setX(x);this.motion.changeYBy(y);this.motion.setY(y);this.motion.bounceOnEdge();this.motion.setRotationStyle(style);this.motion.getX();this.motion.getY();this.motion.getDirection();this.motion.getAngle();this.animation.rotateTo(time, theta, easing, name);this.animation.rotateBy(time, theta, easing, name);this.animation.moveTo(time, x, y, easing, name);this.animation.moveBy(time, x, y, easing, name);this.animation.scaleTo(time, scale, easing, name);this.animation.scaleBy(time, scale, easing, name);this.animation.bezierBy(time, x, y, cx1, cy1, cx2, cy2, easing, name);this.animation.bezierTo(time, x, y, cx1, cy1, cx2, cy2, easing, name);this.animation.effectBy(time, effect, value, easing, name);this.animation.effectTo(time, effect, value, easing, name);this.animation.changeCostumes(time, fps, prefix, easing, name);this.animation.waitFor(name);this.animation.stop(name);this.animation.isRunning(name);this.looks.setCostume(name);this.looks.nextCostume();this.looks.firstCostumeInGroup(prefix);this.looks.nextCostumeInGroup(prefix);this.looks.getCostumeIndex();this.looks.getCostume();this.looks.setBackground(scene);this.looks.setBackgroundAndWait(scene);this.looks.nextBackground();this.looks.firstBackgroundInGroup(prefix);this.looks.nextBackgroundInGroup(prefix);this.looks.getBackgroundIndex();this.looks.getBackground();this.looks.setLabel(text);this.looks.setBubbleStyle(style);this.looks.setBubbleDock(dock);this.looks.say(text);this.looks.sayFor(text, seconds);this.looks.think(text);this.looks.thinkFor(text, seconds);this.looks.changeEffect(effect, n);this.looks.setEffect(effect, n);this.looks.resetEffects();this.looks.changeSize(scale);this.looks.setSize();this.looks.getSize();this.looks.show();this.looks.hide();this.looks.isHidden();this.looks.setLayer(n);this.looks.getLayer();this.looks.bringToFront();this.looks.sendToBack();this.looks.moveBackward(n);this.looks.bringForward(n);this.looks.dialog(text);this.looks.prompt(text, button1, button2);this.sensing.isTouching(actorName);this.sensing.isTouchingClone(actorName);this.sensing.isTouchingColor(color);this.sensing.isColorTouchingColor(color1, color2);this.sensing.ask(text);this.sensing.askChoices(text, choice1, choice2);this.sensing.getAnswer();this.sensing.getMouseX();this.sensing.getMouseY();this.sensing.isMouseDown();this.sensing.isKeyPressed(keyName);this.sensing.getDistance(actorName);this.sensing.resetTimer();this.sensing.getTimer();this.sensing.getSpriteProperty(prop, actorName);this.sensing.getActorName();this.sensing.getActorNameAtIndex(n);this.sensing.getActorCount();this.sensing.getTouchedActorName();this.sensing.getDateTime(which);this.sensing.getScreenLeft();this.sensing.getScreenRight();this.sensing.getScreenTop();this.sensing.getScreenBottom();this.sensing.getScreenProperty(which);this.sensing.getUserId();this.sensing.getUserFirstName();this.sound.play(name);this.sound.playUntilDone(name);this.sound.stopAll();this.sound.playDrum(drumIdx, beats);this.sound.playRest(beats);this.sound.playNote(noteIdx);this.sound.setInstrument(instrumentIdx);this.sound.changeVolume(n);this.sound.setVolume(n);this.sound.getVolume();this.sound.changeTempo(n);this.sound.setTempo(n);this.sound.getTempo();this.canvas.clear();this.canvas.penDown();this.canvas.penUp();this.canvas.setColor(color);this.canvas.changeHue(n);this.canvas.setHue(n);this.canvas.changeShade(n);this.canvas.setShade(n);this.canvas.changePenSize(n);this.canvas.setPenSize(n);this.canvas.stamp();this.canvas.setFont(size, style, fontName);this.canvas.setFontColor(color);this.canvas.drawText(text);this.canvas.redraw();this.canvas.setFillColor(color);this.canvas.setNoFill();this.canvas.drawBezier(x1, y1, x2, y2, cx1, cy1, cx2, cy2);this.canvas.drawPoint(x, y);this.canvas.drawLine(x1, y1, x2, y2);this.canvas.drawRect(x, y, width, height);this.canvas.drawTriangle(x1, y1, x2, y2, x3, y3);this.canvas.drawEllipse(x, y, width, height);this.canvas.drawTextAt(text, x, y);this.canvas.drawLocalRect(width, height);this.canvas.drawLocalEllipse(width, height);this.physics.getProperty(name, actor);this.physics.apply(name, actor, value);this.physics.applyXY(name, actor, x, y);this.physics.applyActive(actor, boolean);this.physics.applyStatic(actor, boolean);this.physics.applyGeometry(actor, geometry);this.physics.isCollidedWith(actorName);this.physics.getCollidedName();this.physics.applyForce(n);this.physics.applyImpulse(n);this.physics.applyForceAtAngle(n, degrees);this.physics.applyImpulseAtAngle(n, degrees);this.physics.applyForceAtXY(x, y);this.physics.applyImpulseAtXY(x, y);this.physics.applyTorque(n);this.physics.setActive(b);this.physics.setStatic(b);this.physics.setGeometry(geometry);this.physics.setDensity(n);this.physics.setFriction(n);this.physics.setRestitution(n);this.physics.setAngularDamping(n);this.physics.setAngularVelocity(n);this.physics.setLinearDamping(n);this.physics.setLinearVelocity(x, y);this.physics.getDensity();this.physics.getFriction();this.physics.getRestitution();this.physics.getAngularVelocity();this.physics.getInertia();this.physics.isAwake();this.physics.getVelocityX();this.physics.getVelocityY();this.physics.getAngularDamping();this.physics.getLinearDamping();this.physics.setGravity(x, y);this.physics.getGravityX();this.physics.getGravityY();this.physics.start();this.physics.stop();this.net.saveValue(name,value,access);this.net.loadValue(name);this.net.fetch(url);this.net.parse(json);this.net.getResult()".split(";"),
g_keywords="null true false break case catch const default finally for instanceof new var continue function return void delete if this do while else in switch throw try typeof with debugger".split(" "),g_properties="background #;scene #;scene name;x gravity;y gravity;x position;y position;direction;costume #;costume name;say;visible;size;volume;density;friction;restitution;angular velocity;angular damping;linear damping;x linear velocity;y linear velocity;inertia;awake;width;height;effect/nnn".split(";"),
g_parser=function(){function b(){this.yy={}}var c={trace:function(){},yy:{},symbols_:{error:2,Literal:3,NULL:4,TRUE:5,FALSE:6,NUMBER:7,STRING:8,Property:9,IDENTIFIER:10,":":11,AssignmentExpr:12,PropertyList:13,",":14,PrimaryExpr:15,PrimaryExprNoBrace:16,"{":17,"}":18,THIS:19,ArrayLiteral:20,"(":21,Expr:22,")":23,"[":24,ElisionOpt:25,"]":26,ElementList:27,Elision:28,MemberExpr:29,FunctionExpr:30,".":31,NEW:32,Arguments:33,MemberExprNoBF:34,NewExpr:35,NewExprNoBF:36,CallExpr:37,CallExprNoBF:38,ArgumentList:39,
LeftHandSideExpr:40,LeftHandSideExprNoBF:41,PostfixExpr:42,"++":43,"--":44,PostfixExprNoBF:45,UnaryExprCommon:46,DELETE:47,UnaryExpr:48,VOID:49,TYPEOF:50,"+":51,"-":52,"~":53,"!":54,UnaryExprNoBF:55,MultiplicativeExpr:56,"*":57,"/":58,"%":59,MultiplicativeExprNoBF:60,AdditiveExpr:61,AdditiveExprNoBF:62,ShiftExpr:63,"<<":64,">>":65,">>>":66,ShiftExprNoBF:67,RelationalExpr:68,"<":69,">":70,"<=":71,">=":72,INSTANCEOF:73,IN:74,RelationalExprNoIn:75,RelationalExprNoBF:76,EqualityExpr:77,"==":78,"!=":79,
"===":80,"!==":81,EqualityExprNoIn:82,EqualityExprNoBF:83,BitwiseANDExpr:84,"&":85,BitwiseANDExprNoIn:86,BitwiseANDExprNoBF:87,BitwiseXORExpr:88,"^":89,BitwiseXORExprNoIn:90,BitwiseXORExprNoBF:91,BitwiseORExpr:92,"|":93,BitwiseORExprNoIn:94,BitwiseORExprNoBF:95,LogicalANDExpr:96,"&&":97,LogicalANDExprNoIn:98,LogicalANDExprNoBF:99,LogicalORExpr:100,"||":101,LogicalORExprNoIn:102,LogicalORExprNoBF:103,ConditionalExpr:104,"?":105,ConditionalExprNoIn:106,AssignmentExprNoIn:107,ConditionalExprNoBF:108,
AssignmentOperator:109,AssignmentExprNoBF:110,"=":111,"+=":112,"-=":113,"*=":114,"/=":115,"<<=":116,">>=":117,">>>=":118,"&=":119,"^=":120,"|=":121,"%=":122,ExprNoIn:123,ExprNoBF:124,Statement:125,Block:126,InlineComment:127,VariableStatement:128,ConstStatement:129,FunctionDeclaration:130,EmptyStatement:131,ExprStatement:132,IfStatement:133,IterationStatement:134,ContinueStatement:135,BreakStatement:136,ReturnStatement:137,WithStatement:138,SwitchStatement:139,LabelledStatement:140,ThrowStatement:141,
TryStatement:142,DebuggerStatement:143,LINECOMMENT:144,SourceElements:145,VAR:146,VariableDeclarationList:147,";":148,Initializer:149,VariableDeclarationListNoIn:150,InitializerNoIn:151,CONST:152,ConstDeclarationList:153,ConstDeclaration:154,IF:155,ELSE:156,DO:157,WHILE:158,FOR:159,ExprNoInOpt:160,ExprOpt:161,CONTINUE:162,BREAK:163,RETURN:164,WITH:165,SWITCH:166,CaseBlock:167,CaseClausesOpt:168,DefaultClause:169,CaseClauses:170,CaseClause:171,CASE:172,DEFAULT:173,THROW:174,TRY:175,FINALLY:176,CATCH:177,
DEBUGGER:178,FUNCTION:179,FunctionBody:180,FormalParameterList:181,Program:182,$accept:0,$end:1},terminals_:{2:"error",4:"NULL",5:"TRUE",6:"FALSE",7:"NUMBER",8:"STRING",10:"IDENTIFIER",11:":",14:",",17:"{",18:"}",19:"THIS",21:"(",23:")",24:"[",26:"]",31:".",32:"NEW",43:"++",44:"--",47:"DELETE",49:"VOID",50:"TYPEOF",51:"+",52:"-",53:"~",54:"!",57:"*",58:"/",59:"%",64:"<<",65:">>",66:">>>",69:"<",70:">",71:"<=",72:">=",73:"INSTANCEOF",74:"IN",78:"==",79:"!=",80:"===",81:"!==",85:"&",89:"^",93:"|",97:"&&",
101:"||",105:"?",111:"=",112:"+=",113:"-=",114:"*=",115:"/=",116:"<<=",117:">>=",118:">>>=",119:"&=",120:"^=",121:"|=",122:"%=",144:"LINECOMMENT",146:"VAR",148:";",152:"CONST",155:"IF",156:"ELSE",157:"DO",158:"WHILE",159:"FOR",162:"CONTINUE",163:"BREAK",164:"RETURN",165:"WITH",166:"SWITCH",172:"CASE",173:"DEFAULT",174:"THROW",175:"TRY",176:"FINALLY",177:"CATCH",178:"DEBUGGER",179:"FUNCTION"},productions_:[0,[3,1],[3,1],[3,1],[3,1],[3,1],[9,3],[9,3],[9,3],[13,1],[13,3],[15,1],[15,2],[15,3],[15,4],
[16,1],[16,1],[16,1],[16,1],[16,3],[20,3],[20,3],[20,5],[27,2],[27,4],[25,0],[25,1],[28,1],[28,2],[29,1],[29,1],[29,4],[29,3],[29,3],[34,1],[34,4],[34,3],[34,3],[35,1],[35,2],[36,1],[36,2],[37,2],[37,2],[37,4],[37,3],[38,2],[38,2],[38,4],[38,3],[33,2],[33,3],[39,1],[39,3],[40,1],[40,1],[41,1],[41,1],[42,1],[42,2],[42,2],[45,1],[45,2],[45,2],[46,2],[46,2],[46,2],[46,2],[46,2],[46,2],[46,2],[46,2],[46,2],[48,1],[48,1],[55,1],[55,1],[56,1],[56,3],[56,3],[56,3],[60,1],[60,3],[60,3],[60,3],[61,1],[61,
3],[61,3],[62,1],[62,3],[62,3],[63,1],[63,3],[63,3],[63,3],[67,1],[67,3],[67,3],[67,3],[68,1],[68,3],[68,3],[68,3],[68,3],[68,3],[68,3],[75,1],[75,3],[75,3],[75,3],[75,3],[75,3],[76,1],[76,3],[76,3],[76,3],[76,3],[76,3],[76,3],[77,1],[77,3],[77,3],[77,3],[77,3],[82,1],[82,3],[82,3],[82,3],[82,3],[83,1],[83,3],[83,3],[83,3],[83,3],[84,1],[84,3],[86,1],[86,3],[87,1],[87,3],[88,1],[88,3],[90,1],[90,3],[91,1],[91,3],[92,1],[92,3],[94,1],[94,3],[95,1],[95,3],[96,1],[96,3],[98,1],[98,3],[99,1],[99,3],[100,
1],[100,3],[102,1],[102,3],[103,1],[103,3],[104,1],[104,5],[106,1],[106,5],[108,1],[108,5],[12,1],[12,3],[107,1],[107,3],[110,1],[110,3],[109,1],[109,1],[109,1],[109,1],[109,1],[109,1],[109,1],[109,1],[109,1],[109,1],[109,1],[109,1],[22,1],[22,3],[123,1],[123,3],[124,1],[124,3],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[125,1],[127,1],[126,2],[126,3],[128,3],[128,3],[147,1],[147,2],[147,3],[147,4],[150,1],
[150,2],[150,3],[150,4],[129,3],[129,3],[153,1],[153,3],[154,1],[154,2],[149,2],[151,2],[131,1],[132,2],[132,2],[133,5],[133,7],[134,7],[134,7],[134,5],[134,9],[134,10],[134,7],[134,8],[134,9],[161,0],[161,1],[160,0],[160,1],[135,2],[135,2],[135,3],[135,3],[136,2],[136,2],[136,3],[136,3],[137,2],[137,2],[137,3],[137,3],[138,5],[139,5],[167,3],[167,5],[168,0],[168,1],[170,1],[170,2],[171,3],[171,4],[169,2],[169,3],[140,3],[141,3],[141,3],[142,4],[142,7],[142,9],[143,2],[143,2],[130,7],[130,8],[30,
6],[30,7],[30,7],[30,8],[181,1],[181,3],[180,0],[180,1],[182,0],[182,1],[145,1],[145,2]],performAction:function(b,c,d,h,j,k){b=k.length-1;switch(j){case 1:this.$=new Node("null");break;case 2:this.$=new Node("true");break;case 3:this.$=new Node("false");break;case 4:this.$=new Node("number",k[b]);break;case 5:this.$=new Node("string",k[b].substring(1,k[b].length-1).replace(/\\"/g,'"'));break;case 6:this.$=new Node("JsonProperty",k[b-2],k[b]);break;case 7:this.$=new Node("JsonProperty",k[b-2].substring(1,
k[b-2].length-1).replace(/\\"/g,'"'),k[b]);break;case 8:this.$=new Node("JsonProperty",k[b-2],k[b]);break;case 9:this.$=[k[b]];break;case 10:if(k[b-2]instanceof Array){k[b-2].push(k[b]);this.$=k[b-2]}else this.$=[k[b-2],k[b]];break;case 12:this.$=new Node("Json");break;case 13:this.$=new Node("Json");this.$.children=k[b-1];break;case 14:this.$=new Node("Json");this.$.children=k[b-2];break;case 15:this.$=new Node("this");break;case 18:this.$=new Node("identifier",k[b]);break;case 19:this.$=k[b-1];
break;case 20:this.$=new Node("ArrayLiteral");break;case 21:if(k[b-1].name=="ArrayLiteral")this.$=k[b-1];else{this.$=new Node("ArrayLiteral");this.$.addChild(k[b-1])}break;case 22:if(k[b-3].name=="ArrayLiteral")this.$=k[b-3];else{this.$=new Node("ArrayLiteral");this.$.addChild(k[b-3])}break;case 23:this.$=new Node("ArrayLiteral");this.$.addChild(k[b]);break;case 24:if(k[b-3].name=="ArrayLiteral"){k[b-3].addChild(k[b]);this.$=k[b-3]}break;case 26:this.$="";break;case 27:this.$="";break;case 28:this.$=
"";break;case 31:this.$=new Node("ArrayProperty",k[b-3],k[b-1]);break;case 32:this.$=new Node("Property",k[b-2],new Node("identifier",k[b]));break;case 33:this.$=new Node("New",k[b-1],k[b]);break;case 35:this.$=new Node("ArrayProperty",k[b-3],k[b-1]);break;case 36:this.$=new Node("Property",k[b-2],new Node("identifier",k[b]));break;case 37:this.$=new Node("New",k[b-1],k[b]);break;case 39:this.$=new Node("New",k[b],new Node("FunctionArguments"));break;case 41:this.$=new Node("New",k[b],new Node("FunctionArguments"));
break;case 42:this.$=new Node("FunctionCall",k[b-1],k[b]);break;case 43:this.$=new Node("FunctionCall",k[b-1],k[b]);break;case 44:this.$=new Node("ArrayProperty",k[b-3],k[b-1]);break;case 45:this.$=new Node("Property",k[b-2],new Node("identifier",k[b]));break;case 46:this.$=new Node("FunctionCall",k[b-1],k[b]);break;case 47:this.$=new Node("FunctionCall",k[b-1],k[b]);break;case 48:this.$=new Node("ArrayProperty",k[b-3],k[b-1]);break;case 49:this.$=new Node("Property",k[b-2],new Node("identifier",
k[b]));break;case 50:this.$=new Node("FunctionArguments");break;case 51:this.$=new Node("FunctionArguments");this.$.children=k[b-1];break;case 52:this.$=[k[b]];break;case 53:if(k[b-2]instanceof Array){k[b-2].push(k[b]);this.$=k[b-2]}else this.$=[k[b-2],k[b]];break;case 59:this.$=new Node("PostIncrement",k[b-1]);break;case 60:this.$=new Node("PostIncrement",k[b-1]);break;case 62:this.$=new Node("PostIncrement",k[b-1]);break;case 63:this.$=new Node("PostDecrement",k[b-1]);break;case 64:this.$=new Node("Delete",
k[b-1]);break;case 65:this.$=new Node("Void",k[b-1]);break;case 66:this.$=new Node("TypeOf",k[b-1]);break;case 67:this.$=new Node("PreIncrement",k[b]);break;case 68:this.$=new Node("PreDecrement",k[b]);break;case 69:this.$=k[b];break;case 70:this.$=k[b].name=="number"?new Node("number",-k[b].getChild(0)):new Node("Negative",k[b]);break;case 71:this.$=new Node("BitwiseNot",k[b]);break;case 72:this.$=new Node("LogicalNot",k[b]);break;case 78:this.$=new Node("Multiply",k[b-2],k[b]);break;case 79:this.$=
new Node("Divide",k[b-2],k[b]);break;case 80:this.$=new Node("Remainder",k[b-2],k[b]);break;case 82:this.$=new Node("Multiply",k[b-2],k[b]);break;case 83:this.$=new Node("Divide",k[b-2],k[b]);break;case 84:this.$=new Node("Remainder",k[b-2],k[b]);break;case 86:this.$=new Node("Add",k[b-2],k[b]);break;case 87:this.$=new Node("Subtract",k[b-2],k[b]);break;case 89:this.$=new Node("Add",k[b-2],k[b]);break;case 90:this.$=new Node("Subtract",k[b-2],k[b]);break;case 92:this.$=new Node("ShiftLeft",k[b-2],
k[b]);break;case 93:this.$=new Node("ShiftRight",k[b-2],k[b]);break;case 94:this.$=new Node("UnsignedShiftRight",k[b-2],k[b]);break;case 96:this.$=new Node("ShiftLeft",k[b-2],k[b]);break;case 97:this.$=new Node("ShiftRight",k[b-2],k[b]);break;case 98:this.$=new Node("UnsignedShiftRight",k[b-2],k[b]);break;case 100:this.$=new Node("LessThan",k[b-2],k[b]);break;case 101:this.$=new Node("GreaterThan",k[b-2],k[b]);break;case 102:this.$=new Node("LessThanOrEqual",k[b-2],k[b]);break;case 103:this.$=new Node("GreaterThanOrEqual",
k[b-2],k[b]);break;case 104:this.$=new Node("InstanceOf",k[b-2],k[b]);break;case 105:this.$=new Node("In",k[b-2],k[b]);break;case 107:this.$=new Node("LessThan",k[b-2],k[b]);break;case 108:this.$=new Node("GreaterThan",k[b-2],k[b]);break;case 109:this.$=new Node("LessThanOrEqual",k[b-2],k[b]);break;case 110:this.$=new Node("GreaterThanOrEqual",k[b-2],k[b]);break;case 111:this.$=new Node("InstanceOf",k[b-2],k[b]);break;case 113:this.$=new Node("LessThan",k[b-2],k[b]);break;case 114:this.$=new Node("GreaterThan",
k[b-2],k[b]);break;case 115:this.$=new Node("LessThanOrEqual",k[b-2],k[b]);break;case 116:this.$=new Node("GreaterThanOrEqual",k[b-2],k[b]);break;case 117:this.$=new Node("InstanceOf",k[b-2],k[b]);break;case 118:this.$=new Node("In",k[b-2],k[b]);break;case 120:this.$=new Node("Equal",k[b-2],k[b]);break;case 121:this.$=new Node("NotEqual",k[b-2],k[b]);break;case 122:this.$=new Node("StrictEqual",k[b-2],k[b]);break;case 123:this.$=new Node("StrictNotEqual",k[b-2],k[b]);break;case 125:this.$=new Node("Equal",
k[b-2],k[b]);break;case 126:this.$=new Node("NotEqual",k[b-2],k[b]);break;case 127:this.$=new Node("StrictEqual",k[b-2],k[b]);break;case 128:this.$=new Node("StrictNotEqual",k[b-2],k[b]);break;case 130:this.$=new Node("Equal",k[b-2],k[b]);break;case 131:this.$=new Node("NotEqual",k[b-2],k[b]);break;case 132:this.$=new Node("StrictEqual",k[b-2],k[b]);break;case 133:this.$=new Node("StrictNotEqual",k[b-2],k[b]);break;case 135:this.$=new Node("BitwiseAnd",k[b-2],k[b]);break;case 137:this.$=new Node("BitwiseAnd",
k[b-2],k[b]);break;case 139:this.$=new Node("BitwiseAnd",k[b-2],k[b]);break;case 141:this.$=new Node("BitwiseXor",k[b-2],k[b]);break;case 143:this.$=new Node("BitwiseXor",k[b-2],k[b]);break;case 145:this.$=new Node("BitwiseXor",k[b-2],k[b]);break;case 147:this.$=new Node("BitwiseOr",k[b-2],k[b]);break;case 149:this.$=new Node("BitwiseOr",k[b-2],k[b]);break;case 151:this.$=new Node("BitwiseOr",k[b-2],k[b]);break;case 153:this.$=new Node("LogicalAnd",k[b-2],k[b]);break;case 155:this.$=new Node("LogicalAnd",
k[b-2],k[b]);break;case 157:this.$=new Node("LogicalAnd",k[b-2],k[b]);break;case 159:this.$=new Node("LogicalOr",k[b-2],k[b]);break;case 161:this.$=new Node("LogicalOr",k[b-2],k[b]);break;case 163:this.$=new Node("LogicalOr",k[b-2],k[b]);break;case 165:this.$=new Node("Conditional",k[b-4],k[b-2],k[b]);break;case 167:this.$=new Node("Conditional",k[b-4],k[b-2],k[b]);break;case 169:this.$=new Node("Conditional",k[b-4],k[b-2],k[b]);break;case 171:this.$=new Node("Assignment",k[b-2],k[b-1],k[b]);break;
case 173:this.$=new Node("Assignment",k[b-2],k[b-1],k[b]);break;case 175:this.$=new Node("Assignment",k[b-2],k[b-1],k[b]);break;case 189:this.$=new Node(",",k[b-2],k[b]);break;case 191:this.$=new Node(",",k[b-2],k[b]);break;case 193:this.$=new Node(",",k[b-2],k[b]);break;case 212:this.$=new Node("linecomment",k[b].substring(2));break;case 213:this.$=new Node("Block");break;case 214:this.$=new Node("Block",k[b-1]);break;case 215:this.$=new Node("Block");this.$.children=k[b-1];break;case 216:console.log("error at var statement");
break;case 217:this.$=[new Node("VarDeclaration",k[b])];break;case 218:this.$=[new Node("VarDeclarationAssignment",k[b-1],k[b])];break;case 219:j=new Node("VarDeclaration",k[b]);if(k[b-2]instanceof Array){k[b-2].push(j);this.$=k[b-2]}else this.$=[k[b-2],j];break;case 220:j=new Node("VarDeclarationAssignment",k[b-1],k[b]);if(k[b-3]instanceof Array){k[b-3].push(j);this.$=k[b-3]}else this.$=[k[b-3],j];break;case 221:this.$=[new Node("VarDeclaration",k[b])];break;case 222:this.$=[new Node("VarDeclarationAssignment",
k[b-1],k[b])];break;case 223:j=new Node("VarDeclaration",k[b]);if(k[b-2]instanceof Array){k[b-2].push(j);this.$=k[b-2]}else this.$=[k[b-2],j];break;case 224:j=new Node("VarDeclarationAssignment",k[b-1],k[b]);if(k[b-3]instanceof Array){k[b-3].push(j);this.$=k[b-3]}else this.$=[k[b-3],j];break;case 225:this.$=new Node("ConstList");this.$.children=k[b-1];break;case 226:console.log("error at const statement");break;case 227:this.$=[k[b]];break;case 228:if(k[b-2]instanceof Array){k[b-2].push(k[b]);this.$=
k[b-2]}else this.$=[k[b-2],k[b]];break;case 229:this.$=new Node("Const");this.$.addChild(k[b]);break;case 230:this.$=new Node("ConstAssignment");this.$.addChild(k[b-1]);this.$.addChild(k[b]);break;case 231:this.$=k[b];break;case 232:this.$=k[b];break;case 233:this.$=new Node("EmptyStatement");break;case 235:console.log("error at ExprNoBF");break;case 236:this.$=new Node("If",k[b-2],k[b]);break;case 237:this.$=new Node("IfElse",k[b-4],k[b-2],k[b]);break;case 238:this.$=new Node("DoWhile",k[b-2],k[b-
5]);break;case 239:console.log("error at do-while statement");break;case 240:this.$=new Node("While",k[b-2],k[b]);break;case 241:this.$=new Node("For",k[b-6],k[b-4],k[b-2],k[b]);break;case 242:this.$=new Node("ForScoped",k[b-6],k[b-4],k[b-2],k[b]);break;case 243:this.$=new Node("ForIn",k[b-4],k[b-2],k[b]);break;case 244:this.$=new Node("ForInScoped",new Node("identifier",k[b-4]),k[b-2],k[b]);break;case 245:this.$=new Node("ForInScoped",new Node("identifier",k[b-5]),k[b-2],k[b]);break;case 250:this.$=
new Node("Continue");break;case 251:console.log("error at continue statement");break;case 252:this.$=new Node("Continue",new Node("identifier",k[b-1]));break;case 253:console.log("error at continue with identifier statement");break;case 254:this.$=new Node("Break");break;case 255:console.log("error at break statement");break;case 256:this.$=new Node("Break",new Node("identifier",k[b-1]));break;case 257:console.log("error at break with identifier statement");break;case 258:this.$=new Node("Return");
break;case 259:console.log("error at return statement");break;case 260:this.$=new Node("Return",k[b-1]);break;case 261:console.log("error at return with expr statement");break;case 262:this.$=new Node("With",k[b-2],k[b]);break;case 263:this.$=new Node("Switch",k[b-2],k[b]);break;case 264:this.$=new Node("CaseBlock");this.$.children=k[b-1];break;case 265:j=[];if(k[b-3]instanceof Array){j=k[b-3];j.push(k[b-2]);j=j.concat(k[b-1]);this.$=new Node("CaseBlock",j)}else console.log("could not construct case list");
break;case 268:this.$=[k[b]];break;case 269:if(k[b-1]instanceof Array){k[b-1].push(k[b]);this.$=k[b-1]}else this.$=[k[b-1],k[b]];break;case 270:this.$=new Node("Case",k[b-1]);break;case 271:this.$=new Node("Case",k[b-2],k[b]);break;case 272:this.$=new Node("Default");break;case 273:this.$=new Node("Default",k[b]);break;case 274:this.$=new Node("Label",k[b-2],k[b]);break;case 275:this.$=new Node("Throw",k[b-1]);break;case 276:console.log("error at throw");break;case 277:this.$=new Node("TryCatch",
k[b-2],null,null,k[b]);break;case 278:this.$=new Node("TryCatch",k[b-5],new Node("identifier",k[b-2]),k[b],null);break;case 279:this.$=new Node("TryCatch",k[b-7],new Node("identifier",k[b-4]),k[b-2],k[b]);break;case 282:this.$=new Node("Function",k[b-5],null,k[b-1]);break;case 283:this.$=new Node("Function",k[b-6],k[b-4],k[b-1]);break;case 284:this.$=new Node("FunctionExpr",null,null,k[b-1]);break;case 285:this.$=new Node("FunctionExpr",null,k[b-4],k[b-1]);break;case 286:this.$=new Node("FunctionExpr",
k[b-5],null,k[b-1]);break;case 287:this.$=new Node("FunctionExpr",k[b-6],k[b-4],k[b-1]);break;case 288:this.$=new Node("FunctionArguments",k[b]);break;case 289:if(k[b-2].name=="FunctionArguments"){k[b-2].addChild(k[b]);this.$=k[b-2]}else this.$=new Node("FunctionArguments",k[b-2],k[b]);break;case 291:this.$=k[b];break;case 293:this.$=k[b];return k[b];case 294:this.$=new Node("Block",k[b]);break;case 295:if(k[b-1].name=="Block"){k[b-1].addChild(k[b]);this.$=k[b-1]}else this.$=new Node("Block",k[b-
1],k[b])}},table:[{1:[2,292],3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:3,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],
145:2,146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26],182:1},{1:[3]},{1:[2,293],3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,
95:51,99:48,103:45,108:43,110:42,124:28,125:82,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{1:[2,294],4:[2,294],5:[2,294],6:[2,294],7:[2,294],8:[2,294],10:[2,294],17:[2,294],18:[2,294],19:[2,294],21:[2,294],24:[2,294],32:[2,294],43:[2,294],
44:[2,294],47:[2,294],49:[2,294],50:[2,294],51:[2,294],52:[2,294],53:[2,294],54:[2,294],144:[2,294],146:[2,294],148:[2,294],152:[2,294],155:[2,294],157:[2,294],158:[2,294],159:[2,294],162:[2,294],163:[2,294],164:[2,294],165:[2,294],166:[2,294],172:[2,294],173:[2,294],174:[2,294],175:[2,294],178:[2,294],179:[2,294]},{1:[2,194],4:[2,194],5:[2,194],6:[2,194],7:[2,194],8:[2,194],10:[2,194],17:[2,194],18:[2,194],19:[2,194],21:[2,194],24:[2,194],32:[2,194],43:[2,194],44:[2,194],47:[2,194],49:[2,194],50:[2,
194],51:[2,194],52:[2,194],53:[2,194],54:[2,194],144:[2,194],146:[2,194],148:[2,194],152:[2,194],155:[2,194],156:[2,194],157:[2,194],158:[2,194],159:[2,194],162:[2,194],163:[2,194],164:[2,194],165:[2,194],166:[2,194],172:[2,194],173:[2,194],174:[2,194],175:[2,194],178:[2,194],179:[2,194]},{1:[2,195],4:[2,195],5:[2,195],6:[2,195],7:[2,195],8:[2,195],10:[2,195],17:[2,195],18:[2,195],19:[2,195],21:[2,195],24:[2,195],32:[2,195],43:[2,195],44:[2,195],47:[2,195],49:[2,195],50:[2,195],51:[2,195],52:[2,195],
53:[2,195],54:[2,195],144:[2,195],146:[2,195],148:[2,195],152:[2,195],155:[2,195],156:[2,195],157:[2,195],158:[2,195],159:[2,195],162:[2,195],163:[2,195],164:[2,195],165:[2,195],166:[2,195],172:[2,195],173:[2,195],174:[2,195],175:[2,195],178:[2,195],179:[2,195]},{1:[2,196],4:[2,196],5:[2,196],6:[2,196],7:[2,196],8:[2,196],10:[2,196],17:[2,196],18:[2,196],19:[2,196],21:[2,196],24:[2,196],32:[2,196],43:[2,196],44:[2,196],47:[2,196],49:[2,196],50:[2,196],51:[2,196],52:[2,196],53:[2,196],54:[2,196],144:[2,
196],146:[2,196],148:[2,196],152:[2,196],155:[2,196],156:[2,196],157:[2,196],158:[2,196],159:[2,196],162:[2,196],163:[2,196],164:[2,196],165:[2,196],166:[2,196],172:[2,196],173:[2,196],174:[2,196],175:[2,196],178:[2,196],179:[2,196]},{1:[2,197],4:[2,197],5:[2,197],6:[2,197],7:[2,197],8:[2,197],10:[2,197],17:[2,197],18:[2,197],19:[2,197],21:[2,197],24:[2,197],32:[2,197],43:[2,197],44:[2,197],47:[2,197],49:[2,197],50:[2,197],51:[2,197],52:[2,197],53:[2,197],54:[2,197],144:[2,197],146:[2,197],148:[2,
197],152:[2,197],155:[2,197],156:[2,197],157:[2,197],158:[2,197],159:[2,197],162:[2,197],163:[2,197],164:[2,197],165:[2,197],166:[2,197],172:[2,197],173:[2,197],174:[2,197],175:[2,197],178:[2,197],179:[2,197]},{1:[2,198],4:[2,198],5:[2,198],6:[2,198],7:[2,198],8:[2,198],10:[2,198],17:[2,198],18:[2,198],19:[2,198],21:[2,198],24:[2,198],32:[2,198],43:[2,198],44:[2,198],47:[2,198],49:[2,198],50:[2,198],51:[2,198],52:[2,198],53:[2,198],54:[2,198],144:[2,198],146:[2,198],148:[2,198],152:[2,198],155:[2,
198],156:[2,198],157:[2,198],158:[2,198],159:[2,198],162:[2,198],163:[2,198],164:[2,198],165:[2,198],166:[2,198],172:[2,198],173:[2,198],174:[2,198],175:[2,198],178:[2,198],179:[2,198]},{1:[2,199],4:[2,199],5:[2,199],6:[2,199],7:[2,199],8:[2,199],10:[2,199],17:[2,199],18:[2,199],19:[2,199],21:[2,199],24:[2,199],32:[2,199],43:[2,199],44:[2,199],47:[2,199],49:[2,199],50:[2,199],51:[2,199],52:[2,199],53:[2,199],54:[2,199],144:[2,199],146:[2,199],148:[2,199],152:[2,199],155:[2,199],156:[2,199],157:[2,
199],158:[2,199],159:[2,199],162:[2,199],163:[2,199],164:[2,199],165:[2,199],166:[2,199],172:[2,199],173:[2,199],174:[2,199],175:[2,199],178:[2,199],179:[2,199]},{1:[2,200],4:[2,200],5:[2,200],6:[2,200],7:[2,200],8:[2,200],10:[2,200],17:[2,200],18:[2,200],19:[2,200],21:[2,200],24:[2,200],32:[2,200],43:[2,200],44:[2,200],47:[2,200],49:[2,200],50:[2,200],51:[2,200],52:[2,200],53:[2,200],54:[2,200],144:[2,200],146:[2,200],148:[2,200],152:[2,200],155:[2,200],156:[2,200],157:[2,200],158:[2,200],159:[2,
200],162:[2,200],163:[2,200],164:[2,200],165:[2,200],166:[2,200],172:[2,200],173:[2,200],174:[2,200],175:[2,200],178:[2,200],179:[2,200]},{1:[2,201],4:[2,201],5:[2,201],6:[2,201],7:[2,201],8:[2,201],10:[2,201],17:[2,201],18:[2,201],19:[2,201],21:[2,201],24:[2,201],32:[2,201],43:[2,201],44:[2,201],47:[2,201],49:[2,201],50:[2,201],51:[2,201],52:[2,201],53:[2,201],54:[2,201],144:[2,201],146:[2,201],148:[2,201],152:[2,201],155:[2,201],156:[2,201],157:[2,201],158:[2,201],159:[2,201],162:[2,201],163:[2,
201],164:[2,201],165:[2,201],166:[2,201],172:[2,201],173:[2,201],174:[2,201],175:[2,201],178:[2,201],179:[2,201]},{1:[2,202],4:[2,202],5:[2,202],6:[2,202],7:[2,202],8:[2,202],10:[2,202],17:[2,202],18:[2,202],19:[2,202],21:[2,202],24:[2,202],32:[2,202],43:[2,202],44:[2,202],47:[2,202],49:[2,202],50:[2,202],51:[2,202],52:[2,202],53:[2,202],54:[2,202],144:[2,202],146:[2,202],148:[2,202],152:[2,202],155:[2,202],156:[2,202],157:[2,202],158:[2,202],159:[2,202],162:[2,202],163:[2,202],164:[2,202],165:[2,
202],166:[2,202],172:[2,202],173:[2,202],174:[2,202],175:[2,202],178:[2,202],179:[2,202]},{1:[2,203],4:[2,203],5:[2,203],6:[2,203],7:[2,203],8:[2,203],10:[2,203],17:[2,203],18:[2,203],19:[2,203],21:[2,203],24:[2,203],32:[2,203],43:[2,203],44:[2,203],47:[2,203],49:[2,203],50:[2,203],51:[2,203],52:[2,203],53:[2,203],54:[2,203],144:[2,203],146:[2,203],148:[2,203],152:[2,203],155:[2,203],156:[2,203],157:[2,203],158:[2,203],159:[2,203],162:[2,203],163:[2,203],164:[2,203],165:[2,203],166:[2,203],172:[2,
203],173:[2,203],174:[2,203],175:[2,203],178:[2,203],179:[2,203]},{1:[2,204],4:[2,204],5:[2,204],6:[2,204],7:[2,204],8:[2,204],10:[2,204],17:[2,204],18:[2,204],19:[2,204],21:[2,204],24:[2,204],32:[2,204],43:[2,204],44:[2,204],47:[2,204],49:[2,204],50:[2,204],51:[2,204],52:[2,204],53:[2,204],54:[2,204],144:[2,204],146:[2,204],148:[2,204],152:[2,204],155:[2,204],156:[2,204],157:[2,204],158:[2,204],159:[2,204],162:[2,204],163:[2,204],164:[2,204],165:[2,204],166:[2,204],172:[2,204],173:[2,204],174:[2,
204],175:[2,204],178:[2,204],179:[2,204]},{1:[2,205],4:[2,205],5:[2,205],6:[2,205],7:[2,205],8:[2,205],10:[2,205],17:[2,205],18:[2,205],19:[2,205],21:[2,205],24:[2,205],32:[2,205],43:[2,205],44:[2,205],47:[2,205],49:[2,205],50:[2,205],51:[2,205],52:[2,205],53:[2,205],54:[2,205],144:[2,205],146:[2,205],148:[2,205],152:[2,205],155:[2,205],156:[2,205],157:[2,205],158:[2,205],159:[2,205],162:[2,205],163:[2,205],164:[2,205],165:[2,205],166:[2,205],172:[2,205],173:[2,205],174:[2,205],175:[2,205],178:[2,
205],179:[2,205]},{1:[2,206],4:[2,206],5:[2,206],6:[2,206],7:[2,206],8:[2,206],10:[2,206],17:[2,206],18:[2,206],19:[2,206],21:[2,206],24:[2,206],32:[2,206],43:[2,206],44:[2,206],47:[2,206],49:[2,206],50:[2,206],51:[2,206],52:[2,206],53:[2,206],54:[2,206],144:[2,206],146:[2,206],148:[2,206],152:[2,206],155:[2,206],156:[2,206],157:[2,206],158:[2,206],159:[2,206],162:[2,206],163:[2,206],164:[2,206],165:[2,206],166:[2,206],172:[2,206],173:[2,206],174:[2,206],175:[2,206],178:[2,206],179:[2,206]},{1:[2,
207],4:[2,207],5:[2,207],6:[2,207],7:[2,207],8:[2,207],10:[2,207],17:[2,207],18:[2,207],19:[2,207],21:[2,207],24:[2,207],32:[2,207],43:[2,207],44:[2,207],47:[2,207],49:[2,207],50:[2,207],51:[2,207],52:[2,207],53:[2,207],54:[2,207],144:[2,207],146:[2,207],148:[2,207],152:[2,207],155:[2,207],156:[2,207],157:[2,207],158:[2,207],159:[2,207],162:[2,207],163:[2,207],164:[2,207],165:[2,207],166:[2,207],172:[2,207],173:[2,207],174:[2,207],175:[2,207],178:[2,207],179:[2,207]},{1:[2,208],4:[2,208],5:[2,208],
6:[2,208],7:[2,208],8:[2,208],10:[2,208],17:[2,208],18:[2,208],19:[2,208],21:[2,208],24:[2,208],32:[2,208],43:[2,208],44:[2,208],47:[2,208],49:[2,208],50:[2,208],51:[2,208],52:[2,208],53:[2,208],54:[2,208],144:[2,208],146:[2,208],148:[2,208],152:[2,208],155:[2,208],156:[2,208],157:[2,208],158:[2,208],159:[2,208],162:[2,208],163:[2,208],164:[2,208],165:[2,208],166:[2,208],172:[2,208],173:[2,208],174:[2,208],175:[2,208],178:[2,208],179:[2,208]},{1:[2,209],4:[2,209],5:[2,209],6:[2,209],7:[2,209],8:[2,
209],10:[2,209],17:[2,209],18:[2,209],19:[2,209],21:[2,209],24:[2,209],32:[2,209],43:[2,209],44:[2,209],47:[2,209],49:[2,209],50:[2,209],51:[2,209],52:[2,209],53:[2,209],54:[2,209],144:[2,209],146:[2,209],148:[2,209],152:[2,209],155:[2,209],156:[2,209],157:[2,209],158:[2,209],159:[2,209],162:[2,209],163:[2,209],164:[2,209],165:[2,209],166:[2,209],172:[2,209],173:[2,209],174:[2,209],175:[2,209],178:[2,209],179:[2,209]},{1:[2,210],4:[2,210],5:[2,210],6:[2,210],7:[2,210],8:[2,210],10:[2,210],17:[2,210],
18:[2,210],19:[2,210],21:[2,210],24:[2,210],32:[2,210],43:[2,210],44:[2,210],47:[2,210],49:[2,210],50:[2,210],51:[2,210],52:[2,210],53:[2,210],54:[2,210],144:[2,210],146:[2,210],148:[2,210],152:[2,210],155:[2,210],156:[2,210],157:[2,210],158:[2,210],159:[2,210],162:[2,210],163:[2,210],164:[2,210],165:[2,210],166:[2,210],172:[2,210],173:[2,210],174:[2,210],175:[2,210],178:[2,210],179:[2,210]},{1:[2,211],4:[2,211],5:[2,211],6:[2,211],7:[2,211],8:[2,211],10:[2,211],17:[2,211],18:[2,211],19:[2,211],21:[2,
211],24:[2,211],32:[2,211],43:[2,211],44:[2,211],47:[2,211],49:[2,211],50:[2,211],51:[2,211],52:[2,211],53:[2,211],54:[2,211],144:[2,211],146:[2,211],148:[2,211],152:[2,211],155:[2,211],156:[2,211],157:[2,211],158:[2,211],159:[2,211],162:[2,211],163:[2,211],164:[2,211],165:[2,211],166:[2,211],172:[2,211],173:[2,211],174:[2,211],175:[2,211],178:[2,211],179:[2,211]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[1,83],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,
36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:3,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],145:84,146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,
40],178:[1,41],179:[1,26]},{1:[2,212],4:[2,212],5:[2,212],6:[2,212],7:[2,212],8:[2,212],10:[2,212],17:[2,212],18:[2,212],19:[2,212],21:[2,212],24:[2,212],32:[2,212],43:[2,212],44:[2,212],47:[2,212],49:[2,212],50:[2,212],51:[2,212],52:[2,212],53:[2,212],54:[2,212],144:[2,212],146:[2,212],148:[2,212],152:[2,212],155:[2,212],156:[2,212],157:[2,212],158:[2,212],159:[2,212],162:[2,212],163:[2,212],164:[2,212],165:[2,212],166:[2,212],172:[2,212],173:[2,212],174:[2,212],175:[2,212],178:[2,212],179:[2,212]},
{10:[1,86],147:85},{10:[1,89],153:87,154:88},{10:[1,90]},{1:[2,233],4:[2,233],5:[2,233],6:[2,233],7:[2,233],8:[2,233],10:[2,233],17:[2,233],18:[2,233],19:[2,233],21:[2,233],24:[2,233],32:[2,233],43:[2,233],44:[2,233],47:[2,233],49:[2,233],50:[2,233],51:[2,233],52:[2,233],53:[2,233],54:[2,233],144:[2,233],146:[2,233],148:[2,233],152:[2,233],155:[2,233],156:[2,233],157:[2,233],158:[2,233],159:[2,233],162:[2,233],163:[2,233],164:[2,233],165:[2,233],166:[2,233],172:[2,233],173:[2,233],174:[2,233],175:[2,
233],178:[2,233],179:[2,233]},{2:[1,92],14:[1,93],148:[1,91]},{21:[1,94]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:95,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,
139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{21:[1,96]},{21:[1,97]},{2:[1,99],10:[1,100],148:[1,98]},{2:[1,102],10:[1,103],148:[1,101]},{2:[1,105],3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:106,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,
40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,148:[1,104],179:[1,122]},{21:[1,133]},{21:[1,134]},{2:[2,18],11:[1,135],14:[2,18],21:[2,18],24:[2,18],31:[2,18],43:[2,18],44:[2,18],51:[2,18],52:[2,18],57:[2,18],58:[2,18],59:[2,18],64:[2,18],65:[2,18],66:[2,18],69:[2,18],70:[2,18],71:[2,18],72:[2,18],73:[2,18],74:[2,18],78:[2,18],79:[2,18],80:[2,18],81:[2,
18],85:[2,18],89:[2,18],93:[2,18],97:[2,18],101:[2,18],105:[2,18],111:[2,18],112:[2,18],113:[2,18],114:[2,18],115:[2,18],116:[2,18],117:[2,18],118:[2,18],119:[2,18],120:[2,18],121:[2,18],122:[2,18],148:[2,18]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:136,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],
56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{17:[1,22],126:137},{2:[1,139],148:[1,138]},{2:[2,192],14:[2,192],148:[2,192]},{2:[2,174],14:[2,174],148:[2,174]},{2:[2,61],14:[2,61],43:[1,141],44:[1,142],51:[2,61],52:[2,61],57:[2,61],58:[2,61],59:[2,61],64:[2,61],65:[2,61],66:[2,61],69:[2,61],70:[2,61],71:[2,61],72:[2,61],73:[2,61],74:[2,61],78:[2,61],79:[2,61],80:[2,61],81:[2,61],85:[2,61],89:[2,61],93:[2,61],97:[2,61],101:[2,61],105:[2,61],109:140,111:[1,
143],112:[1,144],113:[1,145],114:[1,146],115:[1,147],116:[1,148],117:[1,149],118:[1,150],119:[1,151],120:[1,152],121:[1,153],122:[1,154],148:[2,61]},{2:[2,168],14:[2,168],101:[1,156],105:[1,155],148:[2,168]},{2:[2,56],14:[2,56],43:[2,56],44:[2,56],51:[2,56],52:[2,56],57:[2,56],58:[2,56],59:[2,56],64:[2,56],65:[2,56],66:[2,56],69:[2,56],70:[2,56],71:[2,56],72:[2,56],73:[2,56],74:[2,56],78:[2,56],79:[2,56],80:[2,56],81:[2,56],85:[2,56],89:[2,56],93:[2,56],97:[2,56],101:[2,56],105:[2,56],111:[2,56],
112:[2,56],113:[2,56],114:[2,56],115:[2,56],116:[2,56],117:[2,56],118:[2,56],119:[2,56],120:[2,56],121:[2,56],122:[2,56],148:[2,56]},{2:[2,57],14:[2,57],21:[1,160],24:[1,158],31:[1,159],33:157,43:[2,57],44:[2,57],51:[2,57],52:[2,57],57:[2,57],58:[2,57],59:[2,57],64:[2,57],65:[2,57],66:[2,57],69:[2,57],70:[2,57],71:[2,57],72:[2,57],73:[2,57],74:[2,57],78:[2,57],79:[2,57],80:[2,57],81:[2,57],85:[2,57],89:[2,57],93:[2,57],97:[2,57],101:[2,57],105:[2,57],111:[2,57],112:[2,57],113:[2,57],114:[2,57],115:[2,
57],116:[2,57],117:[2,57],118:[2,57],119:[2,57],120:[2,57],121:[2,57],122:[2,57],148:[2,57]},{2:[2,162],14:[2,162],97:[1,161],101:[2,162],105:[2,162],148:[2,162]},{2:[2,40],14:[2,40],21:[1,160],24:[1,163],31:[1,164],33:162,43:[2,40],44:[2,40],51:[2,40],52:[2,40],57:[2,40],58:[2,40],59:[2,40],64:[2,40],65:[2,40],66:[2,40],69:[2,40],70:[2,40],71:[2,40],72:[2,40],73:[2,40],74:[2,40],78:[2,40],79:[2,40],80:[2,40],81:[2,40],85:[2,40],89:[2,40],93:[2,40],97:[2,40],101:[2,40],105:[2,40],111:[2,40],112:[2,
40],113:[2,40],114:[2,40],115:[2,40],116:[2,40],117:[2,40],118:[2,40],119:[2,40],120:[2,40],121:[2,40],122:[2,40],148:[2,40]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:166,30:118,32:[1,115],35:165,179:[1,122]},{2:[2,156],14:[2,156],93:[1,167],97:[2,156],101:[2,156],105:[2,156],148:[2,156]},{2:[2,34],14:[2,34],21:[2,34],24:[2,34],31:[2,34],43:[2,34],44:[2,34],51:[2,34],52:[2,34],57:[2,34],58:[2,34],59:[2,34],64:[2,
34],65:[2,34],66:[2,34],69:[2,34],70:[2,34],71:[2,34],72:[2,34],73:[2,34],74:[2,34],78:[2,34],79:[2,34],80:[2,34],81:[2,34],85:[2,34],89:[2,34],93:[2,34],97:[2,34],101:[2,34],105:[2,34],111:[2,34],112:[2,34],113:[2,34],114:[2,34],115:[2,34],116:[2,34],117:[2,34],118:[2,34],119:[2,34],120:[2,34],121:[2,34],122:[2,34],148:[2,34]},{2:[2,150],14:[2,150],89:[1,168],93:[2,150],97:[2,150],101:[2,150],105:[2,150],148:[2,150]},{2:[2,15],11:[2,15],14:[2,15],18:[2,15],21:[2,15],23:[2,15],24:[2,15],26:[2,15],
31:[2,15],43:[2,15],44:[2,15],51:[2,15],52:[2,15],57:[2,15],58:[2,15],59:[2,15],64:[2,15],65:[2,15],66:[2,15],69:[2,15],70:[2,15],71:[2,15],72:[2,15],73:[2,15],74:[2,15],78:[2,15],79:[2,15],80:[2,15],81:[2,15],85:[2,15],89:[2,15],93:[2,15],97:[2,15],101:[2,15],105:[2,15],111:[2,15],112:[2,15],113:[2,15],114:[2,15],115:[2,15],116:[2,15],117:[2,15],118:[2,15],119:[2,15],120:[2,15],121:[2,15],122:[2,15],148:[2,15]},{2:[2,16],11:[2,16],14:[2,16],18:[2,16],21:[2,16],23:[2,16],24:[2,16],26:[2,16],31:[2,
16],43:[2,16],44:[2,16],51:[2,16],52:[2,16],57:[2,16],58:[2,16],59:[2,16],64:[2,16],65:[2,16],66:[2,16],69:[2,16],70:[2,16],71:[2,16],72:[2,16],73:[2,16],74:[2,16],78:[2,16],79:[2,16],80:[2,16],81:[2,16],85:[2,16],89:[2,16],93:[2,16],97:[2,16],101:[2,16],105:[2,16],111:[2,16],112:[2,16],113:[2,16],114:[2,16],115:[2,16],116:[2,16],117:[2,16],118:[2,16],119:[2,16],120:[2,16],121:[2,16],122:[2,16],148:[2,16]},{2:[2,17],11:[2,17],14:[2,17],18:[2,17],21:[2,17],23:[2,17],24:[2,17],26:[2,17],31:[2,17],43:[2,
17],44:[2,17],51:[2,17],52:[2,17],57:[2,17],58:[2,17],59:[2,17],64:[2,17],65:[2,17],66:[2,17],69:[2,17],70:[2,17],71:[2,17],72:[2,17],73:[2,17],74:[2,17],78:[2,17],79:[2,17],80:[2,17],81:[2,17],85:[2,17],89:[2,17],93:[2,17],97:[2,17],101:[2,17],105:[2,17],111:[2,17],112:[2,17],113:[2,17],114:[2,17],115:[2,17],116:[2,17],117:[2,17],118:[2,17],119:[2,17],120:[2,17],121:[2,17],122:[2,17],148:[2,17]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],
20:56,21:[1,57],22:169,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{2:[2,144],14:[2,144],85:[1,170],89:[2,144],93:[2,144],97:[2,144],101:[2,144],105:[2,144],148:[2,144]},{2:[2,1],11:[2,1],14:[2,1],18:[2,1],21:[2,1],23:[2,1],24:[2,1],26:[2,1],31:[2,1],43:[2,1],44:[2,1],51:[2,1],52:[2,1],
57:[2,1],58:[2,1],59:[2,1],64:[2,1],65:[2,1],66:[2,1],69:[2,1],70:[2,1],71:[2,1],72:[2,1],73:[2,1],74:[2,1],78:[2,1],79:[2,1],80:[2,1],81:[2,1],85:[2,1],89:[2,1],93:[2,1],97:[2,1],101:[2,1],105:[2,1],111:[2,1],112:[2,1],113:[2,1],114:[2,1],115:[2,1],116:[2,1],117:[2,1],118:[2,1],119:[2,1],120:[2,1],121:[2,1],122:[2,1],148:[2,1]},{2:[2,2],11:[2,2],14:[2,2],18:[2,2],21:[2,2],23:[2,2],24:[2,2],26:[2,2],31:[2,2],43:[2,2],44:[2,2],51:[2,2],52:[2,2],57:[2,2],58:[2,2],59:[2,2],64:[2,2],65:[2,2],66:[2,2],
69:[2,2],70:[2,2],71:[2,2],72:[2,2],73:[2,2],74:[2,2],78:[2,2],79:[2,2],80:[2,2],81:[2,2],85:[2,2],89:[2,2],93:[2,2],97:[2,2],101:[2,2],105:[2,2],111:[2,2],112:[2,2],113:[2,2],114:[2,2],115:[2,2],116:[2,2],117:[2,2],118:[2,2],119:[2,2],120:[2,2],121:[2,2],122:[2,2],148:[2,2]},{2:[2,3],11:[2,3],14:[2,3],18:[2,3],21:[2,3],23:[2,3],24:[2,3],26:[2,3],31:[2,3],43:[2,3],44:[2,3],51:[2,3],52:[2,3],57:[2,3],58:[2,3],59:[2,3],64:[2,3],65:[2,3],66:[2,3],69:[2,3],70:[2,3],71:[2,3],72:[2,3],73:[2,3],74:[2,3],
78:[2,3],79:[2,3],80:[2,3],81:[2,3],85:[2,3],89:[2,3],93:[2,3],97:[2,3],101:[2,3],105:[2,3],111:[2,3],112:[2,3],113:[2,3],114:[2,3],115:[2,3],116:[2,3],117:[2,3],118:[2,3],119:[2,3],120:[2,3],121:[2,3],122:[2,3],148:[2,3]},{2:[2,4],11:[2,4],14:[2,4],18:[2,4],21:[2,4],23:[2,4],24:[2,4],26:[2,4],31:[2,4],43:[2,4],44:[2,4],51:[2,4],52:[2,4],57:[2,4],58:[2,4],59:[2,4],64:[2,4],65:[2,4],66:[2,4],69:[2,4],70:[2,4],71:[2,4],72:[2,4],73:[2,4],74:[2,4],78:[2,4],79:[2,4],80:[2,4],81:[2,4],85:[2,4],89:[2,4],
93:[2,4],97:[2,4],101:[2,4],105:[2,4],111:[2,4],112:[2,4],113:[2,4],114:[2,4],115:[2,4],116:[2,4],117:[2,4],118:[2,4],119:[2,4],120:[2,4],121:[2,4],122:[2,4],148:[2,4]},{2:[2,5],11:[2,5],14:[2,5],18:[2,5],21:[2,5],23:[2,5],24:[2,5],26:[2,5],31:[2,5],43:[2,5],44:[2,5],51:[2,5],52:[2,5],57:[2,5],58:[2,5],59:[2,5],64:[2,5],65:[2,5],66:[2,5],69:[2,5],70:[2,5],71:[2,5],72:[2,5],73:[2,5],74:[2,5],78:[2,5],79:[2,5],80:[2,5],81:[2,5],85:[2,5],89:[2,5],93:[2,5],97:[2,5],101:[2,5],105:[2,5],111:[2,5],112:[2,
5],113:[2,5],114:[2,5],115:[2,5],116:[2,5],117:[2,5],118:[2,5],119:[2,5],120:[2,5],121:[2,5],122:[2,5],148:[2,5]},{4:[2,25],5:[2,25],6:[2,25],7:[2,25],8:[2,25],10:[2,25],14:[1,174],17:[2,25],19:[2,25],21:[2,25],24:[2,25],25:171,26:[2,25],27:172,28:173,32:[2,25],43:[2,25],44:[2,25],47:[2,25],49:[2,25],50:[2,25],51:[2,25],52:[2,25],53:[2,25],54:[2,25],179:[2,25]},{2:[2,138],14:[2,138],78:[1,175],79:[1,176],80:[1,177],81:[1,178],85:[2,138],89:[2,138],93:[2,138],97:[2,138],101:[2,138],105:[2,138],148:[2,
138]},{2:[2,129],14:[2,129],69:[1,179],70:[1,180],71:[1,181],72:[1,182],73:[1,183],74:[1,184],78:[2,129],79:[2,129],80:[2,129],81:[2,129],85:[2,129],89:[2,129],93:[2,129],97:[2,129],101:[2,129],105:[2,129],148:[2,129]},{2:[2,112],14:[2,112],64:[1,185],65:[1,186],66:[1,187],69:[2,112],70:[2,112],71:[2,112],72:[2,112],73:[2,112],74:[2,112],78:[2,112],79:[2,112],80:[2,112],81:[2,112],85:[2,112],89:[2,112],93:[2,112],97:[2,112],101:[2,112],105:[2,112],148:[2,112]},{2:[2,95],14:[2,95],51:[1,188],52:[1,
189],64:[2,95],65:[2,95],66:[2,95],69:[2,95],70:[2,95],71:[2,95],72:[2,95],73:[2,95],74:[2,95],78:[2,95],79:[2,95],80:[2,95],81:[2,95],85:[2,95],89:[2,95],93:[2,95],97:[2,95],101:[2,95],105:[2,95],148:[2,95]},{2:[2,88],14:[2,88],51:[2,88],52:[2,88],57:[1,190],58:[1,191],59:[1,192],64:[2,88],65:[2,88],66:[2,88],69:[2,88],70:[2,88],71:[2,88],72:[2,88],73:[2,88],74:[2,88],78:[2,88],79:[2,88],80:[2,88],81:[2,88],85:[2,88],89:[2,88],93:[2,88],97:[2,88],101:[2,88],105:[2,88],148:[2,88]},{2:[2,81],14:[2,
81],51:[2,81],52:[2,81],57:[2,81],58:[2,81],59:[2,81],64:[2,81],65:[2,81],66:[2,81],69:[2,81],70:[2,81],71:[2,81],72:[2,81],73:[2,81],74:[2,81],78:[2,81],79:[2,81],80:[2,81],81:[2,81],85:[2,81],89:[2,81],93:[2,81],97:[2,81],101:[2,81],105:[2,81],148:[2,81]},{2:[2,75],14:[2,75],51:[2,75],52:[2,75],57:[2,75],58:[2,75],59:[2,75],64:[2,75],65:[2,75],66:[2,75],69:[2,75],70:[2,75],71:[2,75],72:[2,75],73:[2,75],74:[2,75],78:[2,75],79:[2,75],80:[2,75],81:[2,75],85:[2,75],89:[2,75],93:[2,75],97:[2,75],101:[2,
75],105:[2,75],148:[2,75]},{2:[2,76],14:[2,76],51:[2,76],52:[2,76],57:[2,76],58:[2,76],59:[2,76],64:[2,76],65:[2,76],66:[2,76],69:[2,76],70:[2,76],71:[2,76],72:[2,76],73:[2,76],74:[2,76],78:[2,76],79:[2,76],80:[2,76],81:[2,76],85:[2,76],89:[2,76],93:[2,76],97:[2,76],101:[2,76],105:[2,76],148:[2,76]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,
47:[1,73],48:193,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:195,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,
64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:196,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:197,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,
62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:198,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:199,49:[1,74],50:[1,75],51:[1,
78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:200,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,
40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:201,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:202,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{1:[2,295],4:[2,295],5:[2,295],6:[2,295],7:[2,295],8:[2,295],10:[2,295],17:[2,
295],18:[2,295],19:[2,295],21:[2,295],24:[2,295],32:[2,295],43:[2,295],44:[2,295],47:[2,295],49:[2,295],50:[2,295],51:[2,295],52:[2,295],53:[2,295],54:[2,295],144:[2,295],146:[2,295],148:[2,295],152:[2,295],155:[2,295],157:[2,295],158:[2,295],159:[2,295],162:[2,295],163:[2,295],164:[2,295],165:[2,295],166:[2,295],172:[2,295],173:[2,295],174:[2,295],175:[2,295],178:[2,295],179:[2,295]},{1:[2,213],4:[2,213],5:[2,213],6:[2,213],7:[2,213],8:[2,213],10:[2,213],17:[2,213],18:[2,213],19:[2,213],21:[2,213],
24:[2,213],32:[2,213],43:[2,213],44:[2,213],47:[2,213],49:[2,213],50:[2,213],51:[2,213],52:[2,213],53:[2,213],54:[2,213],144:[2,213],146:[2,213],148:[2,213],152:[2,213],155:[2,213],156:[2,213],157:[2,213],158:[2,213],159:[2,213],162:[2,213],163:[2,213],164:[2,213],165:[2,213],166:[2,213],172:[2,213],173:[2,213],174:[2,213],175:[2,213],176:[2,213],177:[2,213],178:[2,213],179:[2,213]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[1,203],19:[1,54],20:56,21:[1,57],24:[1,
64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:82,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,
39],175:[1,40],178:[1,41],179:[1,26]},{2:[1,205],14:[1,206],148:[1,204]},{2:[2,217],14:[2,217],111:[1,208],148:[2,217],149:207},{2:[1,210],14:[1,211],148:[1,209]},{2:[2,227],14:[2,227],148:[2,227]},{2:[2,229],14:[2,229],111:[1,208],148:[2,229],149:212},{21:[1,213]},{1:[2,234],4:[2,234],5:[2,234],6:[2,234],7:[2,234],8:[2,234],10:[2,234],17:[2,234],18:[2,234],19:[2,234],21:[2,234],24:[2,234],32:[2,234],43:[2,234],44:[2,234],47:[2,234],49:[2,234],50:[2,234],51:[2,234],52:[2,234],53:[2,234],54:[2,234],
144:[2,234],146:[2,234],148:[2,234],152:[2,234],155:[2,234],156:[2,234],157:[2,234],158:[2,234],159:[2,234],162:[2,234],163:[2,234],164:[2,234],165:[2,234],166:[2,234],172:[2,234],173:[2,234],174:[2,234],175:[2,234],178:[2,234],179:[2,234]},{1:[2,235],4:[2,235],5:[2,235],6:[2,235],7:[2,235],8:[2,235],10:[2,235],17:[2,235],18:[2,235],19:[2,235],21:[2,235],24:[2,235],32:[2,235],43:[2,235],44:[2,235],47:[2,235],49:[2,235],50:[2,235],51:[2,235],52:[2,235],53:[2,235],54:[2,235],144:[2,235],146:[2,235],
148:[2,235],152:[2,235],155:[2,235],156:[2,235],157:[2,235],158:[2,235],159:[2,235],162:[2,235],163:[2,235],164:[2,235],165:[2,235],166:[2,235],172:[2,235],173:[2,235],174:[2,235],175:[2,235],178:[2,235],179:[2,235]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:214,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],
56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:215,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{158:[1,216]},{3:55,4:[1,
59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:217,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,
30:118,32:[1,115],35:111,37:112,40:220,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:230,82:229,86:228,90:227,94:226,98:225,102:224,106:223,107:222,123:221,146:[1,219],148:[2,248],160:218,179:[1,122]},{1:[2,250],4:[2,250],5:[2,250],6:[2,250],7:[2,250],8:[2,250],10:[2,250],17:[2,250],18:[2,250],19:[2,250],21:[2,250],24:[2,250],32:[2,250],43:[2,250],44:[2,250],47:[2,250],49:[2,250],50:[2,250],51:[2,250],52:[2,250],
53:[2,250],54:[2,250],144:[2,250],146:[2,250],148:[2,250],152:[2,250],155:[2,250],156:[2,250],157:[2,250],158:[2,250],159:[2,250],162:[2,250],163:[2,250],164:[2,250],165:[2,250],166:[2,250],172:[2,250],173:[2,250],174:[2,250],175:[2,250],178:[2,250],179:[2,250]},{1:[2,251],4:[2,251],5:[2,251],6:[2,251],7:[2,251],8:[2,251],10:[2,251],17:[2,251],18:[2,251],19:[2,251],21:[2,251],24:[2,251],32:[2,251],43:[2,251],44:[2,251],47:[2,251],49:[2,251],50:[2,251],51:[2,251],52:[2,251],53:[2,251],54:[2,251],144:[2,
251],146:[2,251],148:[2,251],152:[2,251],155:[2,251],156:[2,251],157:[2,251],158:[2,251],159:[2,251],162:[2,251],163:[2,251],164:[2,251],165:[2,251],166:[2,251],172:[2,251],173:[2,251],174:[2,251],175:[2,251],178:[2,251],179:[2,251]},{2:[1,233],148:[1,232]},{1:[2,254],4:[2,254],5:[2,254],6:[2,254],7:[2,254],8:[2,254],10:[2,254],17:[2,254],18:[2,254],19:[2,254],21:[2,254],24:[2,254],32:[2,254],43:[2,254],44:[2,254],47:[2,254],49:[2,254],50:[2,254],51:[2,254],52:[2,254],53:[2,254],54:[2,254],144:[2,
254],146:[2,254],148:[2,254],152:[2,254],155:[2,254],156:[2,254],157:[2,254],158:[2,254],159:[2,254],162:[2,254],163:[2,254],164:[2,254],165:[2,254],166:[2,254],172:[2,254],173:[2,254],174:[2,254],175:[2,254],178:[2,254],179:[2,254]},{1:[2,255],4:[2,255],5:[2,255],6:[2,255],7:[2,255],8:[2,255],10:[2,255],17:[2,255],18:[2,255],19:[2,255],21:[2,255],24:[2,255],32:[2,255],43:[2,255],44:[2,255],47:[2,255],49:[2,255],50:[2,255],51:[2,255],52:[2,255],53:[2,255],54:[2,255],144:[2,255],146:[2,255],148:[2,
255],152:[2,255],155:[2,255],156:[2,255],157:[2,255],158:[2,255],159:[2,255],162:[2,255],163:[2,255],164:[2,255],165:[2,255],166:[2,255],172:[2,255],173:[2,255],174:[2,255],175:[2,255],178:[2,255],179:[2,255]},{2:[1,235],148:[1,234]},{1:[2,258],4:[2,258],5:[2,258],6:[2,258],7:[2,258],8:[2,258],10:[2,258],17:[2,258],18:[2,258],19:[2,258],21:[2,258],24:[2,258],32:[2,258],43:[2,258],44:[2,258],47:[2,258],49:[2,258],50:[2,258],51:[2,258],52:[2,258],53:[2,258],54:[2,258],144:[2,258],146:[2,258],148:[2,
258],152:[2,258],155:[2,258],156:[2,258],157:[2,258],158:[2,258],159:[2,258],162:[2,258],163:[2,258],164:[2,258],165:[2,258],166:[2,258],172:[2,258],173:[2,258],174:[2,258],175:[2,258],178:[2,258],179:[2,258]},{1:[2,259],4:[2,259],5:[2,259],6:[2,259],7:[2,259],8:[2,259],10:[2,259],17:[2,259],18:[2,259],19:[2,259],21:[2,259],24:[2,259],32:[2,259],43:[2,259],44:[2,259],47:[2,259],49:[2,259],50:[2,259],51:[2,259],52:[2,259],53:[2,259],54:[2,259],144:[2,259],146:[2,259],148:[2,259],152:[2,259],155:[2,
259],156:[2,259],157:[2,259],158:[2,259],159:[2,259],162:[2,259],163:[2,259],164:[2,259],165:[2,259],166:[2,259],172:[2,259],173:[2,259],174:[2,259],175:[2,259],178:[2,259],179:[2,259]},{2:[1,237],14:[1,238],148:[1,236]},{2:[2,188],11:[2,188],14:[2,188],23:[2,188],26:[2,188],148:[2,188]},{2:[2,170],11:[2,170],14:[2,170],18:[2,170],23:[2,170],26:[2,170],148:[2,170]},{2:[2,58],11:[2,58],14:[2,58],18:[2,58],23:[2,58],26:[2,58],43:[1,240],44:[1,241],51:[2,58],52:[2,58],57:[2,58],58:[2,58],59:[2,58],64:[2,
58],65:[2,58],66:[2,58],69:[2,58],70:[2,58],71:[2,58],72:[2,58],73:[2,58],74:[2,58],78:[2,58],79:[2,58],80:[2,58],81:[2,58],85:[2,58],89:[2,58],93:[2,58],97:[2,58],101:[2,58],105:[2,58],109:239,111:[1,143],112:[1,144],113:[1,145],114:[1,146],115:[1,147],116:[1,148],117:[1,149],118:[1,150],119:[1,151],120:[1,152],121:[1,153],122:[1,154],148:[2,58]},{2:[2,164],11:[2,164],14:[2,164],18:[2,164],23:[2,164],26:[2,164],101:[1,243],105:[1,242],148:[2,164]},{2:[2,54],11:[2,54],14:[2,54],18:[2,54],23:[2,54],
26:[2,54],43:[2,54],44:[2,54],51:[2,54],52:[2,54],57:[2,54],58:[2,54],59:[2,54],64:[2,54],65:[2,54],66:[2,54],69:[2,54],70:[2,54],71:[2,54],72:[2,54],73:[2,54],74:[2,54],78:[2,54],79:[2,54],80:[2,54],81:[2,54],85:[2,54],89:[2,54],93:[2,54],97:[2,54],101:[2,54],105:[2,54],111:[2,54],112:[2,54],113:[2,54],114:[2,54],115:[2,54],116:[2,54],117:[2,54],118:[2,54],119:[2,54],120:[2,54],121:[2,54],122:[2,54],148:[2,54]},{2:[2,55],11:[2,55],14:[2,55],18:[2,55],21:[1,160],23:[2,55],24:[1,245],26:[2,55],31:[1,
246],33:244,43:[2,55],44:[2,55],51:[2,55],52:[2,55],57:[2,55],58:[2,55],59:[2,55],64:[2,55],65:[2,55],66:[2,55],69:[2,55],70:[2,55],71:[2,55],72:[2,55],73:[2,55],74:[2,55],78:[2,55],79:[2,55],80:[2,55],81:[2,55],85:[2,55],89:[2,55],93:[2,55],97:[2,55],101:[2,55],105:[2,55],111:[2,55],112:[2,55],113:[2,55],114:[2,55],115:[2,55],116:[2,55],117:[2,55],118:[2,55],119:[2,55],120:[2,55],121:[2,55],122:[2,55],148:[2,55]},{2:[2,158],11:[2,158],14:[2,158],18:[2,158],23:[2,158],26:[2,158],97:[1,247],101:[2,
158],105:[2,158],148:[2,158]},{2:[2,38],11:[2,38],14:[2,38],18:[2,38],21:[1,160],23:[2,38],24:[1,249],26:[2,38],31:[1,250],33:248,43:[2,38],44:[2,38],51:[2,38],52:[2,38],57:[2,38],58:[2,38],59:[2,38],64:[2,38],65:[2,38],66:[2,38],69:[2,38],70:[2,38],71:[2,38],72:[2,38],73:[2,38],74:[2,38],78:[2,38],79:[2,38],80:[2,38],81:[2,38],85:[2,38],89:[2,38],93:[2,38],97:[2,38],101:[2,38],105:[2,38],111:[2,38],112:[2,38],113:[2,38],114:[2,38],115:[2,38],116:[2,38],117:[2,38],118:[2,38],119:[2,38],120:[2,38],
121:[2,38],122:[2,38],148:[2,38]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:252,30:118,32:[1,115],35:251,179:[1,122]},{2:[2,152],11:[2,152],14:[2,152],18:[2,152],23:[2,152],26:[2,152],93:[1,253],97:[2,152],101:[2,152],105:[2,152],148:[2,152]},{2:[2,29],11:[2,29],14:[2,29],18:[2,29],21:[2,29],23:[2,29],24:[2,29],26:[2,29],31:[2,29],43:[2,29],44:[2,29],51:[2,29],52:[2,29],57:[2,29],58:[2,29],59:[2,29],64:[2,29],65:[2,
29],66:[2,29],69:[2,29],70:[2,29],71:[2,29],72:[2,29],73:[2,29],74:[2,29],78:[2,29],79:[2,29],80:[2,29],81:[2,29],85:[2,29],89:[2,29],93:[2,29],97:[2,29],101:[2,29],105:[2,29],111:[2,29],112:[2,29],113:[2,29],114:[2,29],115:[2,29],116:[2,29],117:[2,29],118:[2,29],119:[2,29],120:[2,29],121:[2,29],122:[2,29],148:[2,29]},{2:[2,30],11:[2,30],14:[2,30],18:[2,30],21:[2,30],23:[2,30],24:[2,30],26:[2,30],31:[2,30],43:[2,30],44:[2,30],51:[2,30],52:[2,30],57:[2,30],58:[2,30],59:[2,30],64:[2,30],65:[2,30],66:[2,
30],69:[2,30],70:[2,30],71:[2,30],72:[2,30],73:[2,30],74:[2,30],78:[2,30],79:[2,30],80:[2,30],81:[2,30],85:[2,30],89:[2,30],93:[2,30],97:[2,30],101:[2,30],105:[2,30],111:[2,30],112:[2,30],113:[2,30],114:[2,30],115:[2,30],116:[2,30],117:[2,30],118:[2,30],119:[2,30],120:[2,30],121:[2,30],122:[2,30],148:[2,30]},{2:[2,146],11:[2,146],14:[2,146],18:[2,146],23:[2,146],26:[2,146],89:[1,254],93:[2,146],97:[2,146],101:[2,146],105:[2,146],148:[2,146]},{2:[2,11],11:[2,11],14:[2,11],18:[2,11],21:[2,11],23:[2,
11],24:[2,11],26:[2,11],31:[2,11],43:[2,11],44:[2,11],51:[2,11],52:[2,11],57:[2,11],58:[2,11],59:[2,11],64:[2,11],65:[2,11],66:[2,11],69:[2,11],70:[2,11],71:[2,11],72:[2,11],73:[2,11],74:[2,11],78:[2,11],79:[2,11],80:[2,11],81:[2,11],85:[2,11],89:[2,11],93:[2,11],97:[2,11],101:[2,11],105:[2,11],111:[2,11],112:[2,11],113:[2,11],114:[2,11],115:[2,11],116:[2,11],117:[2,11],118:[2,11],119:[2,11],120:[2,11],121:[2,11],122:[2,11],148:[2,11]},{7:[1,260],8:[1,259],9:257,10:[1,258],13:256,18:[1,255]},{10:[1,
262],21:[1,261]},{2:[2,140],11:[2,140],14:[2,140],18:[2,140],23:[2,140],26:[2,140],85:[1,263],89:[2,140],93:[2,140],97:[2,140],101:[2,140],105:[2,140],148:[2,140]},{2:[2,18],11:[2,18],14:[2,18],18:[2,18],21:[2,18],23:[2,18],24:[2,18],26:[2,18],31:[2,18],43:[2,18],44:[2,18],51:[2,18],52:[2,18],57:[2,18],58:[2,18],59:[2,18],64:[2,18],65:[2,18],66:[2,18],69:[2,18],70:[2,18],71:[2,18],72:[2,18],73:[2,18],74:[2,18],78:[2,18],79:[2,18],80:[2,18],81:[2,18],85:[2,18],89:[2,18],93:[2,18],97:[2,18],101:[2,
18],105:[2,18],111:[2,18],112:[2,18],113:[2,18],114:[2,18],115:[2,18],116:[2,18],117:[2,18],118:[2,18],119:[2,18],120:[2,18],121:[2,18],122:[2,18],148:[2,18]},{2:[2,134],11:[2,134],14:[2,134],18:[2,134],23:[2,134],26:[2,134],78:[1,264],79:[1,265],80:[1,266],81:[1,267],85:[2,134],89:[2,134],93:[2,134],97:[2,134],101:[2,134],105:[2,134],148:[2,134]},{2:[2,119],11:[2,119],14:[2,119],18:[2,119],23:[2,119],26:[2,119],69:[1,268],70:[1,269],71:[1,270],72:[1,271],73:[1,272],74:[1,273],78:[2,119],79:[2,119],
80:[2,119],81:[2,119],85:[2,119],89:[2,119],93:[2,119],97:[2,119],101:[2,119],105:[2,119],148:[2,119]},{2:[2,99],11:[2,99],14:[2,99],18:[2,99],23:[2,99],26:[2,99],64:[1,274],65:[1,275],66:[1,276],69:[2,99],70:[2,99],71:[2,99],72:[2,99],73:[2,99],74:[2,99],78:[2,99],79:[2,99],80:[2,99],81:[2,99],85:[2,99],89:[2,99],93:[2,99],97:[2,99],101:[2,99],105:[2,99],148:[2,99]},{2:[2,91],11:[2,91],14:[2,91],18:[2,91],23:[2,91],26:[2,91],51:[1,277],52:[1,278],64:[2,91],65:[2,91],66:[2,91],69:[2,91],70:[2,91],
71:[2,91],72:[2,91],73:[2,91],74:[2,91],78:[2,91],79:[2,91],80:[2,91],81:[2,91],85:[2,91],89:[2,91],93:[2,91],97:[2,91],101:[2,91],105:[2,91],148:[2,91]},{2:[2,85],11:[2,85],14:[2,85],18:[2,85],23:[2,85],26:[2,85],51:[2,85],52:[2,85],57:[1,279],58:[1,280],59:[1,281],64:[2,85],65:[2,85],66:[2,85],69:[2,85],70:[2,85],71:[2,85],72:[2,85],73:[2,85],74:[2,85],78:[2,85],79:[2,85],80:[2,85],81:[2,85],85:[2,85],89:[2,85],93:[2,85],97:[2,85],101:[2,85],105:[2,85],148:[2,85]},{2:[2,77],11:[2,77],14:[2,77],
18:[2,77],23:[2,77],26:[2,77],51:[2,77],52:[2,77],57:[2,77],58:[2,77],59:[2,77],64:[2,77],65:[2,77],66:[2,77],69:[2,77],70:[2,77],71:[2,77],72:[2,77],73:[2,77],74:[2,77],78:[2,77],79:[2,77],80:[2,77],81:[2,77],85:[2,77],89:[2,77],93:[2,77],97:[2,77],101:[2,77],105:[2,77],148:[2,77]},{2:[2,73],11:[2,73],14:[2,73],18:[2,73],23:[2,73],26:[2,73],51:[2,73],52:[2,73],57:[2,73],58:[2,73],59:[2,73],64:[2,73],65:[2,73],66:[2,73],69:[2,73],70:[2,73],71:[2,73],72:[2,73],73:[2,73],74:[2,73],78:[2,73],79:[2,73],
80:[2,73],81:[2,73],85:[2,73],89:[2,73],93:[2,73],97:[2,73],101:[2,73],105:[2,73],148:[2,73]},{2:[2,74],11:[2,74],14:[2,74],18:[2,74],23:[2,74],26:[2,74],51:[2,74],52:[2,74],57:[2,74],58:[2,74],59:[2,74],64:[2,74],65:[2,74],66:[2,74],69:[2,74],70:[2,74],71:[2,74],72:[2,74],73:[2,74],74:[2,74],78:[2,74],79:[2,74],80:[2,74],81:[2,74],85:[2,74],89:[2,74],93:[2,74],97:[2,74],101:[2,74],105:[2,74],148:[2,74]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],
19:[1,54],20:56,21:[1,57],22:282,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:283,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],
46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,
124:28,125:284,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{2:[1,286],14:[1,238],148:[1,285]},{176:[1,287],177:[1,288]},{1:[2,280],4:[2,280],5:[2,280],6:[2,280],7:[2,280],8:[2,280],10:[2,280],17:[2,280],18:[2,280],19:[2,280],21:[2,280],24:[2,
280],32:[2,280],43:[2,280],44:[2,280],47:[2,280],49:[2,280],50:[2,280],51:[2,280],52:[2,280],53:[2,280],54:[2,280],144:[2,280],146:[2,280],148:[2,280],152:[2,280],155:[2,280],156:[2,280],157:[2,280],158:[2,280],159:[2,280],162:[2,280],163:[2,280],164:[2,280],165:[2,280],166:[2,280],172:[2,280],173:[2,280],174:[2,280],175:[2,280],178:[2,280],179:[2,280]},{1:[2,281],4:[2,281],5:[2,281],6:[2,281],7:[2,281],8:[2,281],10:[2,281],17:[2,281],18:[2,281],19:[2,281],21:[2,281],24:[2,281],32:[2,281],43:[2,281],
44:[2,281],47:[2,281],49:[2,281],50:[2,281],51:[2,281],52:[2,281],53:[2,281],54:[2,281],144:[2,281],146:[2,281],148:[2,281],152:[2,281],155:[2,281],156:[2,281],157:[2,281],158:[2,281],159:[2,281],162:[2,281],163:[2,281],164:[2,281],165:[2,281],166:[2,281],172:[2,281],173:[2,281],174:[2,281],175:[2,281],178:[2,281],179:[2,281]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:289,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,
42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{2:[2,62],14:[2,62],51:[2,62],52:[2,62],57:[2,62],58:[2,62],59:[2,62],64:[2,62],65:[2,62],66:[2,62],69:[2,62],70:[2,62],71:[2,62],72:[2,62],73:[2,62],74:[2,62],78:[2,62],79:[2,62],80:[2,62],81:[2,62],85:[2,62],89:[2,62],93:[2,62],97:[2,62],101:[2,62],105:[2,62],148:[2,62]},{2:[2,63],14:[2,63],51:[2,
63],52:[2,63],57:[2,63],58:[2,63],59:[2,63],64:[2,63],65:[2,63],66:[2,63],69:[2,63],70:[2,63],71:[2,63],72:[2,63],73:[2,63],74:[2,63],78:[2,63],79:[2,63],80:[2,63],81:[2,63],85:[2,63],89:[2,63],93:[2,63],97:[2,63],101:[2,63],105:[2,63],148:[2,63]},{4:[2,176],5:[2,176],6:[2,176],7:[2,176],8:[2,176],10:[2,176],17:[2,176],19:[2,176],21:[2,176],24:[2,176],32:[2,176],43:[2,176],44:[2,176],47:[2,176],49:[2,176],50:[2,176],51:[2,176],52:[2,176],53:[2,176],54:[2,176],179:[2,176]},{4:[2,177],5:[2,177],6:[2,
177],7:[2,177],8:[2,177],10:[2,177],17:[2,177],19:[2,177],21:[2,177],24:[2,177],32:[2,177],43:[2,177],44:[2,177],47:[2,177],49:[2,177],50:[2,177],51:[2,177],52:[2,177],53:[2,177],54:[2,177],179:[2,177]},{4:[2,178],5:[2,178],6:[2,178],7:[2,178],8:[2,178],10:[2,178],17:[2,178],19:[2,178],21:[2,178],24:[2,178],32:[2,178],43:[2,178],44:[2,178],47:[2,178],49:[2,178],50:[2,178],51:[2,178],52:[2,178],53:[2,178],54:[2,178],179:[2,178]},{4:[2,179],5:[2,179],6:[2,179],7:[2,179],8:[2,179],10:[2,179],17:[2,179],
19:[2,179],21:[2,179],24:[2,179],32:[2,179],43:[2,179],44:[2,179],47:[2,179],49:[2,179],50:[2,179],51:[2,179],52:[2,179],53:[2,179],54:[2,179],179:[2,179]},{4:[2,180],5:[2,180],6:[2,180],7:[2,180],8:[2,180],10:[2,180],17:[2,180],19:[2,180],21:[2,180],24:[2,180],32:[2,180],43:[2,180],44:[2,180],47:[2,180],49:[2,180],50:[2,180],51:[2,180],52:[2,180],53:[2,180],54:[2,180],179:[2,180]},{4:[2,181],5:[2,181],6:[2,181],7:[2,181],8:[2,181],10:[2,181],17:[2,181],19:[2,181],21:[2,181],24:[2,181],32:[2,181],
43:[2,181],44:[2,181],47:[2,181],49:[2,181],50:[2,181],51:[2,181],52:[2,181],53:[2,181],54:[2,181],179:[2,181]},{4:[2,182],5:[2,182],6:[2,182],7:[2,182],8:[2,182],10:[2,182],17:[2,182],19:[2,182],21:[2,182],24:[2,182],32:[2,182],43:[2,182],44:[2,182],47:[2,182],49:[2,182],50:[2,182],51:[2,182],52:[2,182],53:[2,182],54:[2,182],179:[2,182]},{4:[2,183],5:[2,183],6:[2,183],7:[2,183],8:[2,183],10:[2,183],17:[2,183],19:[2,183],21:[2,183],24:[2,183],32:[2,183],43:[2,183],44:[2,183],47:[2,183],49:[2,183],
50:[2,183],51:[2,183],52:[2,183],53:[2,183],54:[2,183],179:[2,183]},{4:[2,184],5:[2,184],6:[2,184],7:[2,184],8:[2,184],10:[2,184],17:[2,184],19:[2,184],21:[2,184],24:[2,184],32:[2,184],43:[2,184],44:[2,184],47:[2,184],49:[2,184],50:[2,184],51:[2,184],52:[2,184],53:[2,184],54:[2,184],179:[2,184]},{4:[2,185],5:[2,185],6:[2,185],7:[2,185],8:[2,185],10:[2,185],17:[2,185],19:[2,185],21:[2,185],24:[2,185],32:[2,185],43:[2,185],44:[2,185],47:[2,185],49:[2,185],50:[2,185],51:[2,185],52:[2,185],53:[2,185],
54:[2,185],179:[2,185]},{4:[2,186],5:[2,186],6:[2,186],7:[2,186],8:[2,186],10:[2,186],17:[2,186],19:[2,186],21:[2,186],24:[2,186],32:[2,186],43:[2,186],44:[2,186],47:[2,186],49:[2,186],50:[2,186],51:[2,186],52:[2,186],53:[2,186],54:[2,186],179:[2,186]},{4:[2,187],5:[2,187],6:[2,187],7:[2,187],8:[2,187],10:[2,187],17:[2,187],19:[2,187],21:[2,187],24:[2,187],32:[2,187],43:[2,187],44:[2,187],47:[2,187],49:[2,187],50:[2,187],51:[2,187],52:[2,187],53:[2,187],54:[2,187],179:[2,187]},{3:55,4:[1,59],5:[1,
60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:290,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,
115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:291,179:[1,122]},{2:[2,47],14:[2,47],21:[2,47],24:[2,47],31:[2,47],43:[2,47],44:[2,47],51:[2,47],52:[2,47],57:[2,47],58:[2,47],59:[2,47],64:[2,47],65:[2,47],66:[2,47],69:[2,47],70:[2,47],71:[2,47],72:[2,47],73:[2,47],74:[2,47],78:[2,47],79:[2,47],80:[2,47],81:[2,47],85:[2,47],89:[2,47],93:[2,47],97:[2,47],
101:[2,47],105:[2,47],111:[2,47],112:[2,47],113:[2,47],114:[2,47],115:[2,47],116:[2,47],117:[2,47],118:[2,47],119:[2,47],120:[2,47],121:[2,47],122:[2,47],148:[2,47]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:292,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,
88:119,92:116,96:113,100:110,104:108,179:[1,122]},{10:[1,293]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:296,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],23:[1,294],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,39:295,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],
8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:297,179:[1,122]},{2:[2,46],14:[2,46],21:[2,46],24:[2,46],31:[2,46],43:[2,46],44:[2,46],51:[2,46],52:[2,46],57:[2,46],58:[2,46],59:[2,46],64:[2,46],65:[2,46],66:[2,46],69:[2,46],70:[2,46],71:[2,46],72:[2,46],73:[2,
46],74:[2,46],78:[2,46],79:[2,46],80:[2,46],81:[2,46],85:[2,46],89:[2,46],93:[2,46],97:[2,46],101:[2,46],105:[2,46],111:[2,46],112:[2,46],113:[2,46],114:[2,46],115:[2,46],116:[2,46],117:[2,46],118:[2,46],119:[2,46],120:[2,46],121:[2,46],122:[2,46],148:[2,46]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:298,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],
50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{10:[1,299]},{2:[2,41],14:[2,41],43:[2,41],44:[2,41],51:[2,41],52:[2,41],57:[2,41],58:[2,41],59:[2,41],64:[2,41],65:[2,41],66:[2,41],69:[2,41],70:[2,41],71:[2,41],72:[2,41],73:[2,41],74:[2,41],78:[2,41],79:[2,41],80:[2,41],81:[2,41],85:[2,41],89:[2,41],93:[2,41],97:[2,41],101:[2,41],105:[2,41],111:[2,41],112:[2,41],113:[2,41],114:[2,41],115:[2,41],116:[2,41],
117:[2,41],118:[2,41],119:[2,41],120:[2,41],121:[2,41],122:[2,41],148:[2,41]},{2:[2,38],14:[2,38],21:[1,160],24:[1,249],31:[1,250],33:300,43:[2,38],44:[2,38],51:[2,38],52:[2,38],57:[2,38],58:[2,38],59:[2,38],64:[2,38],65:[2,38],66:[2,38],69:[2,38],70:[2,38],71:[2,38],72:[2,38],73:[2,38],74:[2,38],78:[2,38],79:[2,38],80:[2,38],81:[2,38],85:[2,38],89:[2,38],93:[2,38],97:[2,38],101:[2,38],105:[2,38],111:[2,38],112:[2,38],113:[2,38],114:[2,38],115:[2,38],116:[2,38],117:[2,38],118:[2,38],119:[2,38],120:[2,
38],121:[2,38],122:[2,38],148:[2,38]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:301,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],
29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:302,179:[1,122]},{14:[1,238],23:[1,303]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,
80],54:[1,81],56:129,61:128,63:127,68:126,77:304,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:306,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],26:[1,305],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{14:[1,308],26:[1,307]},{4:[2,26],5:[2,26],6:[2,26],
7:[2,26],8:[2,26],10:[2,26],14:[1,309],17:[2,26],19:[2,26],21:[2,26],24:[2,26],26:[2,26],32:[2,26],43:[2,26],44:[2,26],47:[2,26],49:[2,26],50:[2,26],51:[2,26],52:[2,26],53:[2,26],54:[2,26],179:[2,26]},{4:[2,27],5:[2,27],6:[2,27],7:[2,27],8:[2,27],10:[2,27],14:[2,27],17:[2,27],19:[2,27],21:[2,27],24:[2,27],26:[2,27],32:[2,27],43:[2,27],44:[2,27],47:[2,27],49:[2,27],50:[2,27],51:[2,27],52:[2,27],53:[2,27],54:[2,27],179:[2,27]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,
17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:310,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,
79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:311,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:312,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,
64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:313,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:314,
179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:315,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,
43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:316,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:317,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],
10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:318,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],
51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:319,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:320,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],
29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:321,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:322,179:[1,122]},{3:55,4:[1,
59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:323,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],
48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:324,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:325,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],
29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:326,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:327,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{2:[2,64],11:[2,64],14:[2,64],18:[2,64],
23:[2,64],26:[2,64],51:[2,64],52:[2,64],57:[2,64],58:[2,64],59:[2,64],64:[2,64],65:[2,64],66:[2,64],69:[2,64],70:[2,64],71:[2,64],72:[2,64],73:[2,64],74:[2,64],78:[2,64],79:[2,64],80:[2,64],81:[2,64],85:[2,64],89:[2,64],93:[2,64],97:[2,64],101:[2,64],105:[2,64],148:[2,64]},{2:[2,58],11:[2,58],14:[2,58],18:[2,58],23:[2,58],26:[2,58],43:[1,240],44:[1,241],51:[2,58],52:[2,58],57:[2,58],58:[2,58],59:[2,58],64:[2,58],65:[2,58],66:[2,58],69:[2,58],70:[2,58],71:[2,58],72:[2,58],73:[2,58],74:[2,58],78:[2,
58],79:[2,58],80:[2,58],81:[2,58],85:[2,58],89:[2,58],93:[2,58],97:[2,58],101:[2,58],105:[2,58],148:[2,58]},{2:[2,65],11:[2,65],14:[2,65],18:[2,65],23:[2,65],26:[2,65],51:[2,65],52:[2,65],57:[2,65],58:[2,65],59:[2,65],64:[2,65],65:[2,65],66:[2,65],69:[2,65],70:[2,65],71:[2,65],72:[2,65],73:[2,65],74:[2,65],78:[2,65],79:[2,65],80:[2,65],81:[2,65],85:[2,65],89:[2,65],93:[2,65],97:[2,65],101:[2,65],105:[2,65],148:[2,65]},{2:[2,66],11:[2,66],14:[2,66],18:[2,66],23:[2,66],26:[2,66],51:[2,66],52:[2,66],
57:[2,66],58:[2,66],59:[2,66],64:[2,66],65:[2,66],66:[2,66],69:[2,66],70:[2,66],71:[2,66],72:[2,66],73:[2,66],74:[2,66],78:[2,66],79:[2,66],80:[2,66],81:[2,66],85:[2,66],89:[2,66],93:[2,66],97:[2,66],101:[2,66],105:[2,66],148:[2,66]},{2:[2,67],11:[2,67],14:[2,67],18:[2,67],23:[2,67],26:[2,67],51:[2,67],52:[2,67],57:[2,67],58:[2,67],59:[2,67],64:[2,67],65:[2,67],66:[2,67],69:[2,67],70:[2,67],71:[2,67],72:[2,67],73:[2,67],74:[2,67],78:[2,67],79:[2,67],80:[2,67],81:[2,67],85:[2,67],89:[2,67],93:[2,67],
97:[2,67],101:[2,67],105:[2,67],148:[2,67]},{2:[2,68],11:[2,68],14:[2,68],18:[2,68],23:[2,68],26:[2,68],51:[2,68],52:[2,68],57:[2,68],58:[2,68],59:[2,68],64:[2,68],65:[2,68],66:[2,68],69:[2,68],70:[2,68],71:[2,68],72:[2,68],73:[2,68],74:[2,68],78:[2,68],79:[2,68],80:[2,68],81:[2,68],85:[2,68],89:[2,68],93:[2,68],97:[2,68],101:[2,68],105:[2,68],148:[2,68]},{2:[2,69],11:[2,69],14:[2,69],18:[2,69],23:[2,69],26:[2,69],51:[2,69],52:[2,69],57:[2,69],58:[2,69],59:[2,69],64:[2,69],65:[2,69],66:[2,69],69:[2,
69],70:[2,69],71:[2,69],72:[2,69],73:[2,69],74:[2,69],78:[2,69],79:[2,69],80:[2,69],81:[2,69],85:[2,69],89:[2,69],93:[2,69],97:[2,69],101:[2,69],105:[2,69],148:[2,69]},{2:[2,70],11:[2,70],14:[2,70],18:[2,70],23:[2,70],26:[2,70],51:[2,70],52:[2,70],57:[2,70],58:[2,70],59:[2,70],64:[2,70],65:[2,70],66:[2,70],69:[2,70],70:[2,70],71:[2,70],72:[2,70],73:[2,70],74:[2,70],78:[2,70],79:[2,70],80:[2,70],81:[2,70],85:[2,70],89:[2,70],93:[2,70],97:[2,70],101:[2,70],105:[2,70],148:[2,70]},{2:[2,71],11:[2,71],
14:[2,71],18:[2,71],23:[2,71],26:[2,71],51:[2,71],52:[2,71],57:[2,71],58:[2,71],59:[2,71],64:[2,71],65:[2,71],66:[2,71],69:[2,71],70:[2,71],71:[2,71],72:[2,71],73:[2,71],74:[2,71],78:[2,71],79:[2,71],80:[2,71],81:[2,71],85:[2,71],89:[2,71],93:[2,71],97:[2,71],101:[2,71],105:[2,71],148:[2,71]},{2:[2,72],11:[2,72],14:[2,72],18:[2,72],23:[2,72],26:[2,72],51:[2,72],52:[2,72],57:[2,72],58:[2,72],59:[2,72],64:[2,72],65:[2,72],66:[2,72],69:[2,72],70:[2,72],71:[2,72],72:[2,72],73:[2,72],74:[2,72],78:[2,72],
79:[2,72],80:[2,72],81:[2,72],85:[2,72],89:[2,72],93:[2,72],97:[2,72],101:[2,72],105:[2,72],148:[2,72]},{1:[2,214],4:[2,214],5:[2,214],6:[2,214],7:[2,214],8:[2,214],10:[2,214],17:[2,214],18:[2,214],19:[2,214],21:[2,214],24:[2,214],32:[2,214],43:[2,214],44:[2,214],47:[2,214],49:[2,214],50:[2,214],51:[2,214],52:[2,214],53:[2,214],54:[2,214],144:[2,214],146:[2,214],148:[2,214],152:[2,214],155:[2,214],156:[2,214],157:[2,214],158:[2,214],159:[2,214],162:[2,214],163:[2,214],164:[2,214],165:[2,214],166:[2,
214],172:[2,214],173:[2,214],174:[2,214],175:[2,214],176:[2,214],177:[2,214],178:[2,214],179:[2,214]},{1:[2,215],4:[2,215],5:[2,215],6:[2,215],7:[2,215],8:[2,215],10:[2,215],17:[2,215],18:[2,215],19:[2,215],21:[2,215],24:[2,215],32:[2,215],43:[2,215],44:[2,215],47:[2,215],49:[2,215],50:[2,215],51:[2,215],52:[2,215],53:[2,215],54:[2,215],144:[2,215],146:[2,215],148:[2,215],152:[2,215],155:[2,215],156:[2,215],157:[2,215],158:[2,215],159:[2,215],162:[2,215],163:[2,215],164:[2,215],165:[2,215],166:[2,
215],172:[2,215],173:[2,215],174:[2,215],175:[2,215],178:[2,215],179:[2,215]},{1:[2,216],4:[2,216],5:[2,216],6:[2,216],7:[2,216],8:[2,216],10:[2,216],17:[2,216],18:[2,216],19:[2,216],21:[2,216],24:[2,216],32:[2,216],43:[2,216],44:[2,216],47:[2,216],49:[2,216],50:[2,216],51:[2,216],52:[2,216],53:[2,216],54:[2,216],144:[2,216],146:[2,216],148:[2,216],152:[2,216],155:[2,216],156:[2,216],157:[2,216],158:[2,216],159:[2,216],162:[2,216],163:[2,216],164:[2,216],165:[2,216],166:[2,216],172:[2,216],173:[2,
216],174:[2,216],175:[2,216],178:[2,216],179:[2,216]},{10:[1,328]},{2:[2,218],14:[2,218],148:[2,218]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:329,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{1:[2,225],4:[2,225],
5:[2,225],6:[2,225],7:[2,225],8:[2,225],10:[2,225],17:[2,225],18:[2,225],19:[2,225],21:[2,225],24:[2,225],32:[2,225],43:[2,225],44:[2,225],47:[2,225],49:[2,225],50:[2,225],51:[2,225],52:[2,225],53:[2,225],54:[2,225],144:[2,225],146:[2,225],148:[2,225],152:[2,225],155:[2,225],156:[2,225],157:[2,225],158:[2,225],159:[2,225],162:[2,225],163:[2,225],164:[2,225],165:[2,225],166:[2,225],172:[2,225],173:[2,225],174:[2,225],175:[2,225],178:[2,225],179:[2,225]},{1:[2,226],4:[2,226],5:[2,226],6:[2,226],7:[2,
226],8:[2,226],10:[2,226],17:[2,226],18:[2,226],19:[2,226],21:[2,226],24:[2,226],32:[2,226],43:[2,226],44:[2,226],47:[2,226],49:[2,226],50:[2,226],51:[2,226],52:[2,226],53:[2,226],54:[2,226],144:[2,226],146:[2,226],148:[2,226],152:[2,226],155:[2,226],156:[2,226],157:[2,226],158:[2,226],159:[2,226],162:[2,226],163:[2,226],164:[2,226],165:[2,226],166:[2,226],172:[2,226],173:[2,226],174:[2,226],175:[2,226],178:[2,226],179:[2,226]},{10:[1,89],154:330},{2:[2,230],14:[2,230],148:[2,230]},{10:[1,333],23:[1,
331],181:332},{2:[2,193],14:[2,193],148:[2,193]},{14:[1,238],23:[1,334]},{21:[1,335]},{14:[1,238],23:[1,336]},{148:[1,337]},{10:[1,339],150:338},{14:[2,58],43:[1,240],44:[1,241],51:[2,58],52:[2,58],57:[2,58],58:[2,58],59:[2,58],64:[2,58],65:[2,58],66:[2,58],69:[2,58],70:[2,58],71:[2,58],72:[2,58],73:[2,58],74:[1,340],78:[2,58],79:[2,58],80:[2,58],81:[2,58],85:[2,58],89:[2,58],93:[2,58],97:[2,58],101:[2,58],105:[2,58],109:341,111:[1,143],112:[1,144],113:[1,145],114:[1,146],115:[1,147],116:[1,148],
117:[1,149],118:[1,150],119:[1,151],120:[1,152],121:[1,153],122:[1,154],148:[2,58]},{14:[1,342],148:[2,249]},{14:[2,190],148:[2,190]},{11:[2,172],14:[2,172],74:[2,172],148:[2,172]},{11:[2,166],14:[2,166],74:[2,166],101:[1,344],105:[1,343],148:[2,166]},{11:[2,160],14:[2,160],74:[2,160],97:[1,345],101:[2,160],105:[2,160],148:[2,160]},{11:[2,154],14:[2,154],74:[2,154],93:[1,346],97:[2,154],101:[2,154],105:[2,154],148:[2,154]},{11:[2,148],14:[2,148],74:[2,148],89:[1,347],93:[2,148],97:[2,148],101:[2,
148],105:[2,148],148:[2,148]},{11:[2,142],14:[2,142],74:[2,142],85:[1,348],89:[2,142],93:[2,142],97:[2,142],101:[2,142],105:[2,142],148:[2,142]},{11:[2,136],14:[2,136],74:[2,136],78:[1,349],79:[1,350],80:[1,351],81:[1,352],85:[2,136],89:[2,136],93:[2,136],97:[2,136],101:[2,136],105:[2,136],148:[2,136]},{11:[2,124],14:[2,124],69:[1,353],70:[1,354],71:[1,355],72:[1,356],73:[1,357],74:[2,124],78:[2,124],79:[2,124],80:[2,124],81:[2,124],85:[2,124],89:[2,124],93:[2,124],97:[2,124],101:[2,124],105:[2,124],
148:[2,124]},{11:[2,106],14:[2,106],64:[1,274],65:[1,275],66:[1,276],69:[2,106],70:[2,106],71:[2,106],72:[2,106],73:[2,106],74:[2,106],78:[2,106],79:[2,106],80:[2,106],81:[2,106],85:[2,106],89:[2,106],93:[2,106],97:[2,106],101:[2,106],105:[2,106],148:[2,106]},{1:[2,252],4:[2,252],5:[2,252],6:[2,252],7:[2,252],8:[2,252],10:[2,252],17:[2,252],18:[2,252],19:[2,252],21:[2,252],24:[2,252],32:[2,252],43:[2,252],44:[2,252],47:[2,252],49:[2,252],50:[2,252],51:[2,252],52:[2,252],53:[2,252],54:[2,252],144:[2,
252],146:[2,252],148:[2,252],152:[2,252],155:[2,252],156:[2,252],157:[2,252],158:[2,252],159:[2,252],162:[2,252],163:[2,252],164:[2,252],165:[2,252],166:[2,252],172:[2,252],173:[2,252],174:[2,252],175:[2,252],178:[2,252],179:[2,252]},{1:[2,253],4:[2,253],5:[2,253],6:[2,253],7:[2,253],8:[2,253],10:[2,253],17:[2,253],18:[2,253],19:[2,253],21:[2,253],24:[2,253],32:[2,253],43:[2,253],44:[2,253],47:[2,253],49:[2,253],50:[2,253],51:[2,253],52:[2,253],53:[2,253],54:[2,253],144:[2,253],146:[2,253],148:[2,
253],152:[2,253],155:[2,253],156:[2,253],157:[2,253],158:[2,253],159:[2,253],162:[2,253],163:[2,253],164:[2,253],165:[2,253],166:[2,253],172:[2,253],173:[2,253],174:[2,253],175:[2,253],178:[2,253],179:[2,253]},{1:[2,256],4:[2,256],5:[2,256],6:[2,256],7:[2,256],8:[2,256],10:[2,256],17:[2,256],18:[2,256],19:[2,256],21:[2,256],24:[2,256],32:[2,256],43:[2,256],44:[2,256],47:[2,256],49:[2,256],50:[2,256],51:[2,256],52:[2,256],53:[2,256],54:[2,256],144:[2,256],146:[2,256],148:[2,256],152:[2,256],155:[2,
256],156:[2,256],157:[2,256],158:[2,256],159:[2,256],162:[2,256],163:[2,256],164:[2,256],165:[2,256],166:[2,256],172:[2,256],173:[2,256],174:[2,256],175:[2,256],178:[2,256],179:[2,256]},{1:[2,257],4:[2,257],5:[2,257],6:[2,257],7:[2,257],8:[2,257],10:[2,257],17:[2,257],18:[2,257],19:[2,257],21:[2,257],24:[2,257],32:[2,257],43:[2,257],44:[2,257],47:[2,257],49:[2,257],50:[2,257],51:[2,257],52:[2,257],53:[2,257],54:[2,257],144:[2,257],146:[2,257],148:[2,257],152:[2,257],155:[2,257],156:[2,257],157:[2,
257],158:[2,257],159:[2,257],162:[2,257],163:[2,257],164:[2,257],165:[2,257],166:[2,257],172:[2,257],173:[2,257],174:[2,257],175:[2,257],178:[2,257],179:[2,257]},{1:[2,260],4:[2,260],5:[2,260],6:[2,260],7:[2,260],8:[2,260],10:[2,260],17:[2,260],18:[2,260],19:[2,260],21:[2,260],24:[2,260],32:[2,260],43:[2,260],44:[2,260],47:[2,260],49:[2,260],50:[2,260],51:[2,260],52:[2,260],53:[2,260],54:[2,260],144:[2,260],146:[2,260],148:[2,260],152:[2,260],155:[2,260],156:[2,260],157:[2,260],158:[2,260],159:[2,
260],162:[2,260],163:[2,260],164:[2,260],165:[2,260],166:[2,260],172:[2,260],173:[2,260],174:[2,260],175:[2,260],178:[2,260],179:[2,260]},{1:[2,261],4:[2,261],5:[2,261],6:[2,261],7:[2,261],8:[2,261],10:[2,261],17:[2,261],18:[2,261],19:[2,261],21:[2,261],24:[2,261],32:[2,261],43:[2,261],44:[2,261],47:[2,261],49:[2,261],50:[2,261],51:[2,261],52:[2,261],53:[2,261],54:[2,261],144:[2,261],146:[2,261],148:[2,261],152:[2,261],155:[2,261],156:[2,261],157:[2,261],158:[2,261],159:[2,261],162:[2,261],163:[2,
261],164:[2,261],165:[2,261],166:[2,261],172:[2,261],173:[2,261],174:[2,261],175:[2,261],178:[2,261],179:[2,261]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:358,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,
59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:359,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{2:[2,59],11:[2,59],14:[2,59],18:[2,59],23:[2,59],26:[2,59],51:[2,59],52:[2,59],57:[2,59],58:[2,59],59:[2,59],64:[2,59],65:[2,59],66:[2,
59],69:[2,59],70:[2,59],71:[2,59],72:[2,59],73:[2,59],74:[2,59],78:[2,59],79:[2,59],80:[2,59],81:[2,59],85:[2,59],89:[2,59],93:[2,59],97:[2,59],101:[2,59],105:[2,59],148:[2,59]},{2:[2,60],11:[2,60],14:[2,60],18:[2,60],23:[2,60],26:[2,60],51:[2,60],52:[2,60],57:[2,60],58:[2,60],59:[2,60],64:[2,60],65:[2,60],66:[2,60],69:[2,60],70:[2,60],71:[2,60],72:[2,60],73:[2,60],74:[2,60],78:[2,60],79:[2,60],80:[2,60],81:[2,60],85:[2,60],89:[2,60],93:[2,60],97:[2,60],101:[2,60],105:[2,60],148:[2,60]},{3:55,4:[1,
59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:360,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,
32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:361,179:[1,122]},{2:[2,43],11:[2,43],14:[2,43],18:[2,43],21:[2,43],23:[2,43],24:[2,43],26:[2,43],31:[2,43],43:[2,43],44:[2,43],51:[2,43],52:[2,43],57:[2,43],58:[2,43],59:[2,43],64:[2,43],65:[2,43],66:[2,43],69:[2,43],70:[2,43],71:[2,43],72:[2,43],73:[2,43],74:[2,43],78:[2,43],79:[2,43],80:[2,43],81:[2,
43],85:[2,43],89:[2,43],93:[2,43],97:[2,43],101:[2,43],105:[2,43],111:[2,43],112:[2,43],113:[2,43],114:[2,43],115:[2,43],116:[2,43],117:[2,43],118:[2,43],119:[2,43],120:[2,43],121:[2,43],122:[2,43],148:[2,43]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:362,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],
56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{10:[1,363]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:364,179:[1,122]},{2:[2,42],11:[2,42],14:[2,42],18:[2,42],21:[2,42],
23:[2,42],24:[2,42],26:[2,42],31:[2,42],43:[2,42],44:[2,42],51:[2,42],52:[2,42],57:[2,42],58:[2,42],59:[2,42],64:[2,42],65:[2,42],66:[2,42],69:[2,42],70:[2,42],71:[2,42],72:[2,42],73:[2,42],74:[2,42],78:[2,42],79:[2,42],80:[2,42],81:[2,42],85:[2,42],89:[2,42],93:[2,42],97:[2,42],101:[2,42],105:[2,42],111:[2,42],112:[2,42],113:[2,42],114:[2,42],115:[2,42],116:[2,42],117:[2,42],118:[2,42],119:[2,42],120:[2,42],121:[2,42],122:[2,42],148:[2,42]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,
124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:365,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{10:[1,366]},{2:[2,39],11:[2,39],14:[2,39],18:[2,39],23:[2,39],26:[2,39],43:[2,39],44:[2,39],51:[2,39],52:[2,39],57:[2,39],58:[2,39],59:[2,39],64:[2,39],65:[2,39],66:[2,39],
69:[2,39],70:[2,39],71:[2,39],72:[2,39],73:[2,39],74:[2,39],78:[2,39],79:[2,39],80:[2,39],81:[2,39],85:[2,39],89:[2,39],93:[2,39],97:[2,39],101:[2,39],105:[2,39],111:[2,39],112:[2,39],113:[2,39],114:[2,39],115:[2,39],116:[2,39],117:[2,39],118:[2,39],119:[2,39],120:[2,39],121:[2,39],122:[2,39],148:[2,39]},{2:[2,38],11:[2,38],14:[2,38],18:[2,38],21:[1,160],23:[2,38],24:[1,249],26:[2,38],31:[1,250],33:367,43:[2,38],44:[2,38],51:[2,38],52:[2,38],57:[2,38],58:[2,38],59:[2,38],64:[2,38],65:[2,38],66:[2,
38],69:[2,38],70:[2,38],71:[2,38],72:[2,38],73:[2,38],74:[2,38],78:[2,38],79:[2,38],80:[2,38],81:[2,38],85:[2,38],89:[2,38],93:[2,38],97:[2,38],101:[2,38],105:[2,38],111:[2,38],112:[2,38],113:[2,38],114:[2,38],115:[2,38],116:[2,38],117:[2,38],118:[2,38],119:[2,38],120:[2,38],121:[2,38],122:[2,38],148:[2,38]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,
77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:368,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:369,179:[1,122]},{2:[2,12],11:[2,
12],14:[2,12],18:[2,12],21:[2,12],23:[2,12],24:[2,12],26:[2,12],31:[2,12],43:[2,12],44:[2,12],51:[2,12],52:[2,12],57:[2,12],58:[2,12],59:[2,12],64:[2,12],65:[2,12],66:[2,12],69:[2,12],70:[2,12],71:[2,12],72:[2,12],73:[2,12],74:[2,12],78:[2,12],79:[2,12],80:[2,12],81:[2,12],85:[2,12],89:[2,12],93:[2,12],97:[2,12],101:[2,12],105:[2,12],111:[2,12],112:[2,12],113:[2,12],114:[2,12],115:[2,12],116:[2,12],117:[2,12],118:[2,12],119:[2,12],120:[2,12],121:[2,12],122:[2,12],148:[2,12]},{14:[1,371],18:[1,370]},
{14:[2,9],18:[2,9]},{11:[1,372]},{11:[1,373]},{11:[1,374]},{10:[1,333],23:[1,375],181:376},{21:[1,377]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:378,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,
16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:379,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],
52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:380,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:381,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,
57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:382,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,
63:383,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:384,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,
42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:385,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:386,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],
8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:387,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],
50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:388,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:389,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],
24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:390,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:391,179:[1,122]},
{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:392,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,
47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:393,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:394,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],
24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:395,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:396,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],179:[1,122]},{14:[1,238],23:[1,397]},{14:[1,
238],23:[1,398]},{1:[2,274],4:[2,274],5:[2,274],6:[2,274],7:[2,274],8:[2,274],10:[2,274],17:[2,274],18:[2,274],19:[2,274],21:[2,274],24:[2,274],32:[2,274],43:[2,274],44:[2,274],47:[2,274],49:[2,274],50:[2,274],51:[2,274],52:[2,274],53:[2,274],54:[2,274],144:[2,274],146:[2,274],148:[2,274],152:[2,274],155:[2,274],156:[2,274],157:[2,274],158:[2,274],159:[2,274],162:[2,274],163:[2,274],164:[2,274],165:[2,274],166:[2,274],172:[2,274],173:[2,274],174:[2,274],175:[2,274],178:[2,274],179:[2,274]},{1:[2,
275],4:[2,275],5:[2,275],6:[2,275],7:[2,275],8:[2,275],10:[2,275],17:[2,275],18:[2,275],19:[2,275],21:[2,275],24:[2,275],32:[2,275],43:[2,275],44:[2,275],47:[2,275],49:[2,275],50:[2,275],51:[2,275],52:[2,275],53:[2,275],54:[2,275],144:[2,275],146:[2,275],148:[2,275],152:[2,275],155:[2,275],156:[2,275],157:[2,275],158:[2,275],159:[2,275],162:[2,275],163:[2,275],164:[2,275],165:[2,275],166:[2,275],172:[2,275],173:[2,275],174:[2,275],175:[2,275],178:[2,275],179:[2,275]},{1:[2,276],4:[2,276],5:[2,276],
6:[2,276],7:[2,276],8:[2,276],10:[2,276],17:[2,276],18:[2,276],19:[2,276],21:[2,276],24:[2,276],32:[2,276],43:[2,276],44:[2,276],47:[2,276],49:[2,276],50:[2,276],51:[2,276],52:[2,276],53:[2,276],54:[2,276],144:[2,276],146:[2,276],148:[2,276],152:[2,276],155:[2,276],156:[2,276],157:[2,276],158:[2,276],159:[2,276],162:[2,276],163:[2,276],164:[2,276],165:[2,276],166:[2,276],172:[2,276],173:[2,276],174:[2,276],175:[2,276],178:[2,276],179:[2,276]},{17:[1,22],126:399},{21:[1,400]},{2:[2,175],14:[2,175],
148:[2,175]},{11:[1,401]},{2:[2,163],14:[2,163],97:[1,247],101:[2,163],105:[2,163],148:[2,163]},{14:[1,238],26:[1,402]},{2:[2,49],14:[2,49],21:[2,49],24:[2,49],31:[2,49],43:[2,49],44:[2,49],51:[2,49],52:[2,49],57:[2,49],58:[2,49],59:[2,49],64:[2,49],65:[2,49],66:[2,49],69:[2,49],70:[2,49],71:[2,49],72:[2,49],73:[2,49],74:[2,49],78:[2,49],79:[2,49],80:[2,49],81:[2,49],85:[2,49],89:[2,49],93:[2,49],97:[2,49],101:[2,49],105:[2,49],111:[2,49],112:[2,49],113:[2,49],114:[2,49],115:[2,49],116:[2,49],117:[2,
49],118:[2,49],119:[2,49],120:[2,49],121:[2,49],122:[2,49],148:[2,49]},{2:[2,50],11:[2,50],14:[2,50],18:[2,50],21:[2,50],23:[2,50],24:[2,50],26:[2,50],31:[2,50],43:[2,50],44:[2,50],51:[2,50],52:[2,50],57:[2,50],58:[2,50],59:[2,50],64:[2,50],65:[2,50],66:[2,50],69:[2,50],70:[2,50],71:[2,50],72:[2,50],73:[2,50],74:[2,50],78:[2,50],79:[2,50],80:[2,50],81:[2,50],85:[2,50],89:[2,50],93:[2,50],97:[2,50],101:[2,50],105:[2,50],111:[2,50],112:[2,50],113:[2,50],114:[2,50],115:[2,50],116:[2,50],117:[2,50],118:[2,
50],119:[2,50],120:[2,50],121:[2,50],122:[2,50],148:[2,50]},{14:[1,404],23:[1,403]},{14:[2,52],23:[2,52]},{2:[2,157],14:[2,157],93:[1,253],97:[2,157],101:[2,157],105:[2,157],148:[2,157]},{14:[1,238],26:[1,405]},{2:[2,36],14:[2,36],21:[2,36],24:[2,36],31:[2,36],43:[2,36],44:[2,36],51:[2,36],52:[2,36],57:[2,36],58:[2,36],59:[2,36],64:[2,36],65:[2,36],66:[2,36],69:[2,36],70:[2,36],71:[2,36],72:[2,36],73:[2,36],74:[2,36],78:[2,36],79:[2,36],80:[2,36],81:[2,36],85:[2,36],89:[2,36],93:[2,36],97:[2,36],
101:[2,36],105:[2,36],111:[2,36],112:[2,36],113:[2,36],114:[2,36],115:[2,36],116:[2,36],117:[2,36],118:[2,36],119:[2,36],120:[2,36],121:[2,36],122:[2,36],148:[2,36]},{2:[2,37],14:[2,37],21:[2,37],24:[2,37],31:[2,37],43:[2,37],44:[2,37],51:[2,37],52:[2,37],57:[2,37],58:[2,37],59:[2,37],64:[2,37],65:[2,37],66:[2,37],69:[2,37],70:[2,37],71:[2,37],72:[2,37],73:[2,37],74:[2,37],78:[2,37],79:[2,37],80:[2,37],81:[2,37],85:[2,37],89:[2,37],93:[2,37],97:[2,37],101:[2,37],105:[2,37],111:[2,37],112:[2,37],113:[2,
37],114:[2,37],115:[2,37],116:[2,37],117:[2,37],118:[2,37],119:[2,37],120:[2,37],121:[2,37],122:[2,37],148:[2,37]},{2:[2,151],14:[2,151],89:[1,254],93:[2,151],97:[2,151],101:[2,151],105:[2,151],148:[2,151]},{2:[2,145],14:[2,145],85:[1,263],89:[2,145],93:[2,145],97:[2,145],101:[2,145],105:[2,145],148:[2,145]},{2:[2,19],11:[2,19],14:[2,19],18:[2,19],21:[2,19],23:[2,19],24:[2,19],26:[2,19],31:[2,19],43:[2,19],44:[2,19],51:[2,19],52:[2,19],57:[2,19],58:[2,19],59:[2,19],64:[2,19],65:[2,19],66:[2,19],69:[2,
19],70:[2,19],71:[2,19],72:[2,19],73:[2,19],74:[2,19],78:[2,19],79:[2,19],80:[2,19],81:[2,19],85:[2,19],89:[2,19],93:[2,19],97:[2,19],101:[2,19],105:[2,19],111:[2,19],112:[2,19],113:[2,19],114:[2,19],115:[2,19],116:[2,19],117:[2,19],118:[2,19],119:[2,19],120:[2,19],121:[2,19],122:[2,19],148:[2,19]},{2:[2,139],14:[2,139],78:[1,264],79:[1,265],80:[1,266],81:[1,267],85:[2,139],89:[2,139],93:[2,139],97:[2,139],101:[2,139],105:[2,139],148:[2,139]},{2:[2,20],11:[2,20],14:[2,20],18:[2,20],21:[2,20],23:[2,
20],24:[2,20],26:[2,20],31:[2,20],43:[2,20],44:[2,20],51:[2,20],52:[2,20],57:[2,20],58:[2,20],59:[2,20],64:[2,20],65:[2,20],66:[2,20],69:[2,20],70:[2,20],71:[2,20],72:[2,20],73:[2,20],74:[2,20],78:[2,20],79:[2,20],80:[2,20],81:[2,20],85:[2,20],89:[2,20],93:[2,20],97:[2,20],101:[2,20],105:[2,20],111:[2,20],112:[2,20],113:[2,20],114:[2,20],115:[2,20],116:[2,20],117:[2,20],118:[2,20],119:[2,20],120:[2,20],121:[2,20],122:[2,20],148:[2,20]},{14:[2,23],26:[2,23]},{2:[2,21],11:[2,21],14:[2,21],18:[2,21],
21:[2,21],23:[2,21],24:[2,21],26:[2,21],31:[2,21],43:[2,21],44:[2,21],51:[2,21],52:[2,21],57:[2,21],58:[2,21],59:[2,21],64:[2,21],65:[2,21],66:[2,21],69:[2,21],70:[2,21],71:[2,21],72:[2,21],73:[2,21],74:[2,21],78:[2,21],79:[2,21],80:[2,21],81:[2,21],85:[2,21],89:[2,21],93:[2,21],97:[2,21],101:[2,21],105:[2,21],111:[2,21],112:[2,21],113:[2,21],114:[2,21],115:[2,21],116:[2,21],117:[2,21],118:[2,21],119:[2,21],120:[2,21],121:[2,21],122:[2,21],148:[2,21]},{4:[2,25],5:[2,25],6:[2,25],7:[2,25],8:[2,25],
10:[2,25],14:[1,174],17:[2,25],19:[2,25],21:[2,25],24:[2,25],25:406,26:[2,25],28:173,32:[2,25],43:[2,25],44:[2,25],47:[2,25],49:[2,25],50:[2,25],51:[2,25],52:[2,25],53:[2,25],54:[2,25],179:[2,25]},{4:[2,28],5:[2,28],6:[2,28],7:[2,28],8:[2,28],10:[2,28],14:[2,28],17:[2,28],19:[2,28],21:[2,28],24:[2,28],26:[2,28],32:[2,28],43:[2,28],44:[2,28],47:[2,28],49:[2,28],50:[2,28],51:[2,28],52:[2,28],53:[2,28],54:[2,28],179:[2,28]},{2:[2,130],14:[2,130],69:[1,268],70:[1,269],71:[1,270],72:[1,271],73:[1,272],
74:[1,273],78:[2,130],79:[2,130],80:[2,130],81:[2,130],85:[2,130],89:[2,130],93:[2,130],97:[2,130],101:[2,130],105:[2,130],148:[2,130]},{2:[2,131],14:[2,131],69:[1,268],70:[1,269],71:[1,270],72:[1,271],73:[1,272],74:[1,273],78:[2,131],79:[2,131],80:[2,131],81:[2,131],85:[2,131],89:[2,131],93:[2,131],97:[2,131],101:[2,131],105:[2,131],148:[2,131]},{2:[2,132],14:[2,132],69:[1,268],70:[1,269],71:[1,270],72:[1,271],73:[1,272],74:[1,273],78:[2,132],79:[2,132],80:[2,132],81:[2,132],85:[2,132],89:[2,132],
93:[2,132],97:[2,132],101:[2,132],105:[2,132],148:[2,132]},{2:[2,133],14:[2,133],69:[1,268],70:[1,269],71:[1,270],72:[1,271],73:[1,272],74:[1,273],78:[2,133],79:[2,133],80:[2,133],81:[2,133],85:[2,133],89:[2,133],93:[2,133],97:[2,133],101:[2,133],105:[2,133],148:[2,133]},{2:[2,113],14:[2,113],64:[1,274],65:[1,275],66:[1,276],69:[2,113],70:[2,113],71:[2,113],72:[2,113],73:[2,113],74:[2,113],78:[2,113],79:[2,113],80:[2,113],81:[2,113],85:[2,113],89:[2,113],93:[2,113],97:[2,113],101:[2,113],105:[2,113],
148:[2,113]},{2:[2,114],14:[2,114],64:[1,274],65:[1,275],66:[1,276],69:[2,114],70:[2,114],71:[2,114],72:[2,114],73:[2,114],74:[2,114],78:[2,114],79:[2,114],80:[2,114],81:[2,114],85:[2,114],89:[2,114],93:[2,114],97:[2,114],101:[2,114],105:[2,114],148:[2,114]},{2:[2,115],14:[2,115],64:[1,274],65:[1,275],66:[1,276],69:[2,115],70:[2,115],71:[2,115],72:[2,115],73:[2,115],74:[2,115],78:[2,115],79:[2,115],80:[2,115],81:[2,115],85:[2,115],89:[2,115],93:[2,115],97:[2,115],101:[2,115],105:[2,115],148:[2,115]},
{2:[2,116],14:[2,116],64:[1,274],65:[1,275],66:[1,276],69:[2,116],70:[2,116],71:[2,116],72:[2,116],73:[2,116],74:[2,116],78:[2,116],79:[2,116],80:[2,116],81:[2,116],85:[2,116],89:[2,116],93:[2,116],97:[2,116],101:[2,116],105:[2,116],148:[2,116]},{2:[2,117],14:[2,117],64:[1,274],65:[1,275],66:[1,276],69:[2,117],70:[2,117],71:[2,117],72:[2,117],73:[2,117],74:[2,117],78:[2,117],79:[2,117],80:[2,117],81:[2,117],85:[2,117],89:[2,117],93:[2,117],97:[2,117],101:[2,117],105:[2,117],148:[2,117]},{2:[2,118],
14:[2,118],64:[1,274],65:[1,275],66:[1,276],69:[2,118],70:[2,118],71:[2,118],72:[2,118],73:[2,118],74:[2,118],78:[2,118],79:[2,118],80:[2,118],81:[2,118],85:[2,118],89:[2,118],93:[2,118],97:[2,118],101:[2,118],105:[2,118],148:[2,118]},{2:[2,96],14:[2,96],51:[1,277],52:[1,278],64:[2,96],65:[2,96],66:[2,96],69:[2,96],70:[2,96],71:[2,96],72:[2,96],73:[2,96],74:[2,96],78:[2,96],79:[2,96],80:[2,96],81:[2,96],85:[2,96],89:[2,96],93:[2,96],97:[2,96],101:[2,96],105:[2,96],148:[2,96]},{2:[2,97],14:[2,97],
51:[1,277],52:[1,278],64:[2,97],65:[2,97],66:[2,97],69:[2,97],70:[2,97],71:[2,97],72:[2,97],73:[2,97],74:[2,97],78:[2,97],79:[2,97],80:[2,97],81:[2,97],85:[2,97],89:[2,97],93:[2,97],97:[2,97],101:[2,97],105:[2,97],148:[2,97]},{2:[2,98],14:[2,98],51:[1,277],52:[1,278],64:[2,98],65:[2,98],66:[2,98],69:[2,98],70:[2,98],71:[2,98],72:[2,98],73:[2,98],74:[2,98],78:[2,98],79:[2,98],80:[2,98],81:[2,98],85:[2,98],89:[2,98],93:[2,98],97:[2,98],101:[2,98],105:[2,98],148:[2,98]},{2:[2,89],14:[2,89],51:[2,89],
52:[2,89],57:[1,279],58:[1,280],59:[1,281],64:[2,89],65:[2,89],66:[2,89],69:[2,89],70:[2,89],71:[2,89],72:[2,89],73:[2,89],74:[2,89],78:[2,89],79:[2,89],80:[2,89],81:[2,89],85:[2,89],89:[2,89],93:[2,89],97:[2,89],101:[2,89],105:[2,89],148:[2,89]},{2:[2,90],14:[2,90],51:[2,90],52:[2,90],57:[1,279],58:[1,280],59:[1,281],64:[2,90],65:[2,90],66:[2,90],69:[2,90],70:[2,90],71:[2,90],72:[2,90],73:[2,90],74:[2,90],78:[2,90],79:[2,90],80:[2,90],81:[2,90],85:[2,90],89:[2,90],93:[2,90],97:[2,90],101:[2,90],
105:[2,90],148:[2,90]},{2:[2,82],14:[2,82],51:[2,82],52:[2,82],57:[2,82],58:[2,82],59:[2,82],64:[2,82],65:[2,82],66:[2,82],69:[2,82],70:[2,82],71:[2,82],72:[2,82],73:[2,82],74:[2,82],78:[2,82],79:[2,82],80:[2,82],81:[2,82],85:[2,82],89:[2,82],93:[2,82],97:[2,82],101:[2,82],105:[2,82],148:[2,82]},{2:[2,83],14:[2,83],51:[2,83],52:[2,83],57:[2,83],58:[2,83],59:[2,83],64:[2,83],65:[2,83],66:[2,83],69:[2,83],70:[2,83],71:[2,83],72:[2,83],73:[2,83],74:[2,83],78:[2,83],79:[2,83],80:[2,83],81:[2,83],85:[2,
83],89:[2,83],93:[2,83],97:[2,83],101:[2,83],105:[2,83],148:[2,83]},{2:[2,84],14:[2,84],51:[2,84],52:[2,84],57:[2,84],58:[2,84],59:[2,84],64:[2,84],65:[2,84],66:[2,84],69:[2,84],70:[2,84],71:[2,84],72:[2,84],73:[2,84],74:[2,84],78:[2,84],79:[2,84],80:[2,84],81:[2,84],85:[2,84],89:[2,84],93:[2,84],97:[2,84],101:[2,84],105:[2,84],148:[2,84]},{2:[2,219],14:[2,219],111:[1,208],148:[2,219],149:407},{2:[2,231],14:[2,231],148:[2,231]},{2:[2,228],14:[2,228],148:[2,228]},{17:[1,408]},{14:[1,410],23:[1,409]},
{14:[2,288],23:[2,288]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:411,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,
24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:412,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,
88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:413,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,
142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:415,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,
61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,148:[2,246],161:414,179:[1,122]},{14:[1,417],148:[1,416]},{14:[2,221],74:[1,418],111:[1,420],148:[2,221],151:419},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:421,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,
68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:423,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:230,82:229,86:228,90:227,94:226,98:225,102:224,106:223,107:422,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],
10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:423,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:230,82:229,86:228,90:227,94:226,98:225,102:224,106:223,107:424,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:423,42:131,
43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:230,82:229,86:228,90:227,94:226,98:225,102:224,106:223,107:425,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,
75:230,82:229,86:228,90:227,94:226,98:426,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:230,82:229,86:228,90:227,94:427,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],
20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:230,82:229,86:228,90:428,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,
79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:230,82:229,86:429,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:230,82:430,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],
20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:431,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],
56:129,61:128,63:231,75:432,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:433,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,
115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:434,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:435,179:[1,122]},{3:55,4:[1,
59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:436,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,
47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:437,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:438,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,
17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:194,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:439,179:[1,122]},{2:[2,189],11:[2,189],14:[2,189],23:[2,189],26:[2,189],148:[2,189]},{2:[2,171],11:[2,171],14:[2,171],18:[2,171],23:[2,171],26:[2,171],148:[2,171]},{11:[1,440]},{2:[2,159],11:[2,159],14:[2,159],18:[2,159],23:[2,159],26:[2,159],97:[1,247],101:[2,159],105:[2,159],148:[2,
159]},{14:[1,238],26:[1,441]},{2:[2,45],11:[2,45],14:[2,45],18:[2,45],21:[2,45],23:[2,45],24:[2,45],26:[2,45],31:[2,45],43:[2,45],44:[2,45],51:[2,45],52:[2,45],57:[2,45],58:[2,45],59:[2,45],64:[2,45],65:[2,45],66:[2,45],69:[2,45],70:[2,45],71:[2,45],72:[2,45],73:[2,45],74:[2,45],78:[2,45],79:[2,45],80:[2,45],81:[2,45],85:[2,45],89:[2,45],93:[2,45],97:[2,45],101:[2,45],105:[2,45],111:[2,45],112:[2,45],113:[2,45],114:[2,45],115:[2,45],116:[2,45],117:[2,45],118:[2,45],119:[2,45],120:[2,45],121:[2,45],
122:[2,45],148:[2,45]},{2:[2,153],11:[2,153],14:[2,153],18:[2,153],23:[2,153],26:[2,153],93:[1,253],97:[2,153],101:[2,153],105:[2,153],148:[2,153]},{14:[1,238],26:[1,442]},{2:[2,32],11:[2,32],14:[2,32],18:[2,32],21:[2,32],23:[2,32],24:[2,32],26:[2,32],31:[2,32],43:[2,32],44:[2,32],51:[2,32],52:[2,32],57:[2,32],58:[2,32],59:[2,32],64:[2,32],65:[2,32],66:[2,32],69:[2,32],70:[2,32],71:[2,32],72:[2,32],73:[2,32],74:[2,32],78:[2,32],79:[2,32],80:[2,32],81:[2,32],85:[2,32],89:[2,32],93:[2,32],97:[2,32],
101:[2,32],105:[2,32],111:[2,32],112:[2,32],113:[2,32],114:[2,32],115:[2,32],116:[2,32],117:[2,32],118:[2,32],119:[2,32],120:[2,32],121:[2,32],122:[2,32],148:[2,32]},{2:[2,33],11:[2,33],14:[2,33],18:[2,33],21:[2,33],23:[2,33],24:[2,33],26:[2,33],31:[2,33],43:[2,33],44:[2,33],51:[2,33],52:[2,33],57:[2,33],58:[2,33],59:[2,33],64:[2,33],65:[2,33],66:[2,33],69:[2,33],70:[2,33],71:[2,33],72:[2,33],73:[2,33],74:[2,33],78:[2,33],79:[2,33],80:[2,33],81:[2,33],85:[2,33],89:[2,33],93:[2,33],97:[2,33],101:[2,
33],105:[2,33],111:[2,33],112:[2,33],113:[2,33],114:[2,33],115:[2,33],116:[2,33],117:[2,33],118:[2,33],119:[2,33],120:[2,33],121:[2,33],122:[2,33],148:[2,33]},{2:[2,147],11:[2,147],14:[2,147],18:[2,147],23:[2,147],26:[2,147],89:[1,254],93:[2,147],97:[2,147],101:[2,147],105:[2,147],148:[2,147]},{2:[2,141],11:[2,141],14:[2,141],18:[2,141],23:[2,141],26:[2,141],85:[1,263],89:[2,141],93:[2,141],97:[2,141],101:[2,141],105:[2,141],148:[2,141]},{2:[2,13],11:[2,13],14:[2,13],18:[2,13],21:[2,13],23:[2,13],
24:[2,13],26:[2,13],31:[2,13],43:[2,13],44:[2,13],51:[2,13],52:[2,13],57:[2,13],58:[2,13],59:[2,13],64:[2,13],65:[2,13],66:[2,13],69:[2,13],70:[2,13],71:[2,13],72:[2,13],73:[2,13],74:[2,13],78:[2,13],79:[2,13],80:[2,13],81:[2,13],85:[2,13],89:[2,13],93:[2,13],97:[2,13],101:[2,13],105:[2,13],111:[2,13],112:[2,13],113:[2,13],114:[2,13],115:[2,13],116:[2,13],117:[2,13],118:[2,13],119:[2,13],120:[2,13],121:[2,13],122:[2,13],148:[2,13]},{7:[1,260],8:[1,259],9:444,10:[1,258],18:[1,443]},{3:55,4:[1,59],
5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:445,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:446,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,
30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:447,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,
79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{17:[1,448]},{14:[1,410],23:[1,449]},{10:[1,333],23:[1,450],181:451},{2:[2,135],11:[2,135],14:[2,135],18:[2,135],23:[2,135],26:[2,135],78:[1,264],79:[1,265],80:[1,266],81:[1,267],85:[2,135],89:[2,135],93:[2,135],97:[2,135],101:[2,135],105:[2,135],148:[2,135]},{2:[2,120],11:[2,120],14:[2,120],18:[2,120],23:[2,120],26:[2,120],69:[1,268],70:[1,269],71:[1,270],72:[1,271],73:[1,272],74:[1,
273],78:[2,120],79:[2,120],80:[2,120],81:[2,120],85:[2,120],89:[2,120],93:[2,120],97:[2,120],101:[2,120],105:[2,120],148:[2,120]},{2:[2,121],11:[2,121],14:[2,121],18:[2,121],23:[2,121],26:[2,121],69:[1,268],70:[1,269],71:[1,270],72:[1,271],73:[1,272],74:[1,273],78:[2,121],79:[2,121],80:[2,121],81:[2,121],85:[2,121],89:[2,121],93:[2,121],97:[2,121],101:[2,121],105:[2,121],148:[2,121]},{2:[2,122],11:[2,122],14:[2,122],18:[2,122],23:[2,122],26:[2,122],69:[1,268],70:[1,269],71:[1,270],72:[1,271],73:[1,
272],74:[1,273],78:[2,122],79:[2,122],80:[2,122],81:[2,122],85:[2,122],89:[2,122],93:[2,122],97:[2,122],101:[2,122],105:[2,122],148:[2,122]},{2:[2,123],11:[2,123],14:[2,123],18:[2,123],23:[2,123],26:[2,123],69:[1,268],70:[1,269],71:[1,270],72:[1,271],73:[1,272],74:[1,273],78:[2,123],79:[2,123],80:[2,123],81:[2,123],85:[2,123],89:[2,123],93:[2,123],97:[2,123],101:[2,123],105:[2,123],148:[2,123]},{2:[2,100],11:[2,100],14:[2,100],18:[2,100],23:[2,100],26:[2,100],64:[1,274],65:[1,275],66:[1,276],69:[2,
100],70:[2,100],71:[2,100],72:[2,100],73:[2,100],74:[2,100],78:[2,100],79:[2,100],80:[2,100],81:[2,100],85:[2,100],89:[2,100],93:[2,100],97:[2,100],101:[2,100],105:[2,100],148:[2,100]},{2:[2,101],11:[2,101],14:[2,101],18:[2,101],23:[2,101],26:[2,101],64:[1,274],65:[1,275],66:[1,276],69:[2,101],70:[2,101],71:[2,101],72:[2,101],73:[2,101],74:[2,101],78:[2,101],79:[2,101],80:[2,101],81:[2,101],85:[2,101],89:[2,101],93:[2,101],97:[2,101],101:[2,101],105:[2,101],148:[2,101]},{2:[2,102],11:[2,102],14:[2,
102],18:[2,102],23:[2,102],26:[2,102],64:[1,274],65:[1,275],66:[1,276],69:[2,102],70:[2,102],71:[2,102],72:[2,102],73:[2,102],74:[2,102],78:[2,102],79:[2,102],80:[2,102],81:[2,102],85:[2,102],89:[2,102],93:[2,102],97:[2,102],101:[2,102],105:[2,102],148:[2,102]},{2:[2,103],11:[2,103],14:[2,103],18:[2,103],23:[2,103],26:[2,103],64:[1,274],65:[1,275],66:[1,276],69:[2,103],70:[2,103],71:[2,103],72:[2,103],73:[2,103],74:[2,103],78:[2,103],79:[2,103],80:[2,103],81:[2,103],85:[2,103],89:[2,103],93:[2,103],
97:[2,103],101:[2,103],105:[2,103],148:[2,103]},{2:[2,104],11:[2,104],14:[2,104],18:[2,104],23:[2,104],26:[2,104],64:[1,274],65:[1,275],66:[1,276],69:[2,104],70:[2,104],71:[2,104],72:[2,104],73:[2,104],74:[2,104],78:[2,104],79:[2,104],80:[2,104],81:[2,104],85:[2,104],89:[2,104],93:[2,104],97:[2,104],101:[2,104],105:[2,104],148:[2,104]},{2:[2,105],11:[2,105],14:[2,105],18:[2,105],23:[2,105],26:[2,105],64:[1,274],65:[1,275],66:[1,276],69:[2,105],70:[2,105],71:[2,105],72:[2,105],73:[2,105],74:[2,105],
78:[2,105],79:[2,105],80:[2,105],81:[2,105],85:[2,105],89:[2,105],93:[2,105],97:[2,105],101:[2,105],105:[2,105],148:[2,105]},{2:[2,92],11:[2,92],14:[2,92],18:[2,92],23:[2,92],26:[2,92],51:[1,277],52:[1,278],64:[2,92],65:[2,92],66:[2,92],69:[2,92],70:[2,92],71:[2,92],72:[2,92],73:[2,92],74:[2,92],78:[2,92],79:[2,92],80:[2,92],81:[2,92],85:[2,92],89:[2,92],93:[2,92],97:[2,92],101:[2,92],105:[2,92],148:[2,92]},{2:[2,93],11:[2,93],14:[2,93],18:[2,93],23:[2,93],26:[2,93],51:[1,277],52:[1,278],64:[2,93],
65:[2,93],66:[2,93],69:[2,93],70:[2,93],71:[2,93],72:[2,93],73:[2,93],74:[2,93],78:[2,93],79:[2,93],80:[2,93],81:[2,93],85:[2,93],89:[2,93],93:[2,93],97:[2,93],101:[2,93],105:[2,93],148:[2,93]},{2:[2,94],11:[2,94],14:[2,94],18:[2,94],23:[2,94],26:[2,94],51:[1,277],52:[1,278],64:[2,94],65:[2,94],66:[2,94],69:[2,94],70:[2,94],71:[2,94],72:[2,94],73:[2,94],74:[2,94],78:[2,94],79:[2,94],80:[2,94],81:[2,94],85:[2,94],89:[2,94],93:[2,94],97:[2,94],101:[2,94],105:[2,94],148:[2,94]},{2:[2,86],11:[2,86],14:[2,
86],18:[2,86],23:[2,86],26:[2,86],51:[2,86],52:[2,86],57:[1,279],58:[1,280],59:[1,281],64:[2,86],65:[2,86],66:[2,86],69:[2,86],70:[2,86],71:[2,86],72:[2,86],73:[2,86],74:[2,86],78:[2,86],79:[2,86],80:[2,86],81:[2,86],85:[2,86],89:[2,86],93:[2,86],97:[2,86],101:[2,86],105:[2,86],148:[2,86]},{2:[2,87],11:[2,87],14:[2,87],18:[2,87],23:[2,87],26:[2,87],51:[2,87],52:[2,87],57:[1,279],58:[1,280],59:[1,281],64:[2,87],65:[2,87],66:[2,87],69:[2,87],70:[2,87],71:[2,87],72:[2,87],73:[2,87],74:[2,87],78:[2,87],
79:[2,87],80:[2,87],81:[2,87],85:[2,87],89:[2,87],93:[2,87],97:[2,87],101:[2,87],105:[2,87],148:[2,87]},{2:[2,78],11:[2,78],14:[2,78],18:[2,78],23:[2,78],26:[2,78],51:[2,78],52:[2,78],57:[2,78],58:[2,78],59:[2,78],64:[2,78],65:[2,78],66:[2,78],69:[2,78],70:[2,78],71:[2,78],72:[2,78],73:[2,78],74:[2,78],78:[2,78],79:[2,78],80:[2,78],81:[2,78],85:[2,78],89:[2,78],93:[2,78],97:[2,78],101:[2,78],105:[2,78],148:[2,78]},{2:[2,79],11:[2,79],14:[2,79],18:[2,79],23:[2,79],26:[2,79],51:[2,79],52:[2,79],57:[2,
79],58:[2,79],59:[2,79],64:[2,79],65:[2,79],66:[2,79],69:[2,79],70:[2,79],71:[2,79],72:[2,79],73:[2,79],74:[2,79],78:[2,79],79:[2,79],80:[2,79],81:[2,79],85:[2,79],89:[2,79],93:[2,79],97:[2,79],101:[2,79],105:[2,79],148:[2,79]},{2:[2,80],11:[2,80],14:[2,80],18:[2,80],23:[2,80],26:[2,80],51:[2,80],52:[2,80],57:[2,80],58:[2,80],59:[2,80],64:[2,80],65:[2,80],66:[2,80],69:[2,80],70:[2,80],71:[2,80],72:[2,80],73:[2,80],74:[2,80],78:[2,80],79:[2,80],80:[2,80],81:[2,80],85:[2,80],89:[2,80],93:[2,80],97:[2,
80],101:[2,80],105:[2,80],148:[2,80]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:452,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,
144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{17:[1,454],167:453},{1:[2,277],4:[2,277],5:[2,277],6:[2,277],7:[2,277],8:[2,277],10:[2,277],17:[2,277],18:[2,277],19:[2,277],21:[2,277],24:[2,277],32:[2,277],43:[2,277],44:[2,277],47:[2,277],49:[2,277],50:[2,277],51:[2,277],52:[2,277],53:[2,277],54:[2,277],144:[2,277],146:[2,277],148:[2,277],152:[2,277],155:[2,
277],156:[2,277],157:[2,277],158:[2,277],159:[2,277],162:[2,277],163:[2,277],164:[2,277],165:[2,277],166:[2,277],172:[2,277],173:[2,277],174:[2,277],175:[2,277],178:[2,277],179:[2,277]},{10:[1,455]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:456,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,
68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{2:[2,48],14:[2,48],21:[2,48],24:[2,48],31:[2,48],43:[2,48],44:[2,48],51:[2,48],52:[2,48],57:[2,48],58:[2,48],59:[2,48],64:[2,48],65:[2,48],66:[2,48],69:[2,48],70:[2,48],71:[2,48],72:[2,48],73:[2,48],74:[2,48],78:[2,48],79:[2,48],80:[2,48],81:[2,48],85:[2,48],89:[2,48],93:[2,48],97:[2,48],101:[2,48],105:[2,48],111:[2,48],112:[2,48],113:[2,48],114:[2,48],115:[2,48],116:[2,48],117:[2,48],118:[2,48],119:[2,48],120:[2,48],121:[2,48],
122:[2,48],148:[2,48]},{2:[2,51],11:[2,51],14:[2,51],18:[2,51],21:[2,51],23:[2,51],24:[2,51],26:[2,51],31:[2,51],43:[2,51],44:[2,51],51:[2,51],52:[2,51],57:[2,51],58:[2,51],59:[2,51],64:[2,51],65:[2,51],66:[2,51],69:[2,51],70:[2,51],71:[2,51],72:[2,51],73:[2,51],74:[2,51],78:[2,51],79:[2,51],80:[2,51],81:[2,51],85:[2,51],89:[2,51],93:[2,51],97:[2,51],101:[2,51],105:[2,51],111:[2,51],112:[2,51],113:[2,51],114:[2,51],115:[2,51],116:[2,51],117:[2,51],118:[2,51],119:[2,51],120:[2,51],121:[2,51],122:[2,
51],148:[2,51]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:457,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{2:[2,35],14:[2,35],21:[2,35],24:[2,35],31:[2,35],43:[2,35],44:[2,35],51:[2,35],52:[2,35],57:[2,35],58:[2,
35],59:[2,35],64:[2,35],65:[2,35],66:[2,35],69:[2,35],70:[2,35],71:[2,35],72:[2,35],73:[2,35],74:[2,35],78:[2,35],79:[2,35],80:[2,35],81:[2,35],85:[2,35],89:[2,35],93:[2,35],97:[2,35],101:[2,35],105:[2,35],111:[2,35],112:[2,35],113:[2,35],114:[2,35],115:[2,35],116:[2,35],117:[2,35],118:[2,35],119:[2,35],120:[2,35],121:[2,35],122:[2,35],148:[2,35]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:459,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],26:[1,458],29:114,30:118,
32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{2:[2,220],14:[2,220],148:[2,220]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[2,290],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,
79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:3,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],145:461,146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26],180:460},{17:[1,462]},{10:[1,463]},{1:[2,236],4:[2,236],5:[2,236],6:[2,
236],7:[2,236],8:[2,236],10:[2,236],17:[2,236],18:[2,236],19:[2,236],21:[2,236],24:[2,236],32:[2,236],43:[2,236],44:[2,236],47:[2,236],49:[2,236],50:[2,236],51:[2,236],52:[2,236],53:[2,236],54:[2,236],144:[2,236],146:[2,236],148:[2,236],152:[2,236],155:[2,236],156:[1,464],157:[2,236],158:[2,236],159:[2,236],162:[2,236],163:[2,236],164:[2,236],165:[2,236],166:[2,236],172:[2,236],173:[2,236],174:[2,236],175:[2,236],178:[2,236],179:[2,236]},{14:[1,238],23:[1,465]},{1:[2,240],4:[2,240],5:[2,240],6:[2,
240],7:[2,240],8:[2,240],10:[2,240],17:[2,240],18:[2,240],19:[2,240],21:[2,240],24:[2,240],32:[2,240],43:[2,240],44:[2,240],47:[2,240],49:[2,240],50:[2,240],51:[2,240],52:[2,240],53:[2,240],54:[2,240],144:[2,240],146:[2,240],148:[2,240],152:[2,240],155:[2,240],156:[2,240],157:[2,240],158:[2,240],159:[2,240],162:[2,240],163:[2,240],164:[2,240],165:[2,240],166:[2,240],172:[2,240],173:[2,240],174:[2,240],175:[2,240],178:[2,240],179:[2,240]},{148:[1,466]},{14:[1,238],23:[2,247],148:[2,247]},{3:55,4:[1,
59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:415,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,148:[2,246],161:467,179:[1,122]},{10:[1,468]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],
19:[1,54],20:56,21:[1,57],22:469,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{14:[2,222],74:[1,470],148:[2,222]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:423,42:131,
43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:231,75:230,82:229,86:228,90:227,94:226,98:225,102:224,106:223,107:471,179:[1,122]},{14:[1,238],23:[1,472]},{11:[2,173],14:[2,173],74:[2,173],148:[2,173]},{11:[2,58],14:[2,58],43:[1,240],44:[1,241],51:[2,58],52:[2,58],57:[2,58],58:[2,58],59:[2,58],64:[2,58],65:[2,58],66:[2,58],69:[2,58],70:[2,58],71:[2,58],72:[2,58],73:[2,58],74:[2,58],78:[2,58],79:[2,58],80:[2,58],81:[2,58],85:[2,
58],89:[2,58],93:[2,58],97:[2,58],101:[2,58],105:[2,58],109:341,111:[1,143],112:[1,144],113:[1,145],114:[1,146],115:[1,147],116:[1,148],117:[1,149],118:[1,150],119:[1,151],120:[1,152],121:[1,153],122:[1,154],148:[2,58]},{14:[2,191],148:[2,191]},{11:[1,473]},{11:[2,161],14:[2,161],74:[2,161],97:[1,345],101:[2,161],105:[2,161],148:[2,161]},{11:[2,155],14:[2,155],74:[2,155],93:[1,346],97:[2,155],101:[2,155],105:[2,155],148:[2,155]},{11:[2,149],14:[2,149],74:[2,149],89:[1,347],93:[2,149],97:[2,149],101:[2,
149],105:[2,149],148:[2,149]},{11:[2,143],14:[2,143],74:[2,143],85:[1,348],89:[2,143],93:[2,143],97:[2,143],101:[2,143],105:[2,143],148:[2,143]},{11:[2,137],14:[2,137],74:[2,137],78:[1,349],79:[1,350],80:[1,351],81:[1,352],85:[2,137],89:[2,137],93:[2,137],97:[2,137],101:[2,137],105:[2,137],148:[2,137]},{11:[2,125],14:[2,125],69:[1,353],70:[1,354],71:[1,355],72:[1,356],73:[1,357],74:[2,125],78:[2,125],79:[2,125],80:[2,125],81:[2,125],85:[2,125],89:[2,125],93:[2,125],97:[2,125],101:[2,125],105:[2,125],
148:[2,125]},{11:[2,126],14:[2,126],69:[1,353],70:[1,354],71:[1,355],72:[1,356],73:[1,357],74:[2,126],78:[2,126],79:[2,126],80:[2,126],81:[2,126],85:[2,126],89:[2,126],93:[2,126],97:[2,126],101:[2,126],105:[2,126],148:[2,126]},{11:[2,127],14:[2,127],69:[1,353],70:[1,354],71:[1,355],72:[1,356],73:[1,357],74:[2,127],78:[2,127],79:[2,127],80:[2,127],81:[2,127],85:[2,127],89:[2,127],93:[2,127],97:[2,127],101:[2,127],105:[2,127],148:[2,127]},{11:[2,128],14:[2,128],69:[1,353],70:[1,354],71:[1,355],72:[1,
356],73:[1,357],74:[2,128],78:[2,128],79:[2,128],80:[2,128],81:[2,128],85:[2,128],89:[2,128],93:[2,128],97:[2,128],101:[2,128],105:[2,128],148:[2,128]},{11:[2,107],14:[2,107],64:[1,274],65:[1,275],66:[1,276],69:[2,107],70:[2,107],71:[2,107],72:[2,107],73:[2,107],74:[2,107],78:[2,107],79:[2,107],80:[2,107],81:[2,107],85:[2,107],89:[2,107],93:[2,107],97:[2,107],101:[2,107],105:[2,107],148:[2,107]},{11:[2,108],14:[2,108],64:[1,274],65:[1,275],66:[1,276],69:[2,108],70:[2,108],71:[2,108],72:[2,108],73:[2,
108],74:[2,108],78:[2,108],79:[2,108],80:[2,108],81:[2,108],85:[2,108],89:[2,108],93:[2,108],97:[2,108],101:[2,108],105:[2,108],148:[2,108]},{11:[2,109],14:[2,109],64:[1,274],65:[1,275],66:[1,276],69:[2,109],70:[2,109],71:[2,109],72:[2,109],73:[2,109],74:[2,109],78:[2,109],79:[2,109],80:[2,109],81:[2,109],85:[2,109],89:[2,109],93:[2,109],97:[2,109],101:[2,109],105:[2,109],148:[2,109]},{11:[2,110],14:[2,110],64:[1,274],65:[1,275],66:[1,276],69:[2,110],70:[2,110],71:[2,110],72:[2,110],73:[2,110],74:[2,
110],78:[2,110],79:[2,110],80:[2,110],81:[2,110],85:[2,110],89:[2,110],93:[2,110],97:[2,110],101:[2,110],105:[2,110],148:[2,110]},{11:[2,111],14:[2,111],64:[1,274],65:[1,275],66:[1,276],69:[2,111],70:[2,111],71:[2,111],72:[2,111],73:[2,111],74:[2,111],78:[2,111],79:[2,111],80:[2,111],81:[2,111],85:[2,111],89:[2,111],93:[2,111],97:[2,111],101:[2,111],105:[2,111],148:[2,111]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:474,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,
64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,179:[1,122]},{2:[2,44],11:[2,44],14:[2,44],18:[2,44],21:[2,44],23:[2,44],24:[2,44],26:[2,44],31:[2,44],43:[2,44],44:[2,44],51:[2,44],52:[2,44],57:[2,44],58:[2,44],59:[2,44],64:[2,44],65:[2,44],66:[2,44],69:[2,44],70:[2,44],71:[2,44],72:[2,44],73:[2,44],74:[2,44],
78:[2,44],79:[2,44],80:[2,44],81:[2,44],85:[2,44],89:[2,44],93:[2,44],97:[2,44],101:[2,44],105:[2,44],111:[2,44],112:[2,44],113:[2,44],114:[2,44],115:[2,44],116:[2,44],117:[2,44],118:[2,44],119:[2,44],120:[2,44],121:[2,44],122:[2,44],148:[2,44]},{2:[2,31],11:[2,31],14:[2,31],18:[2,31],21:[2,31],23:[2,31],24:[2,31],26:[2,31],31:[2,31],43:[2,31],44:[2,31],51:[2,31],52:[2,31],57:[2,31],58:[2,31],59:[2,31],64:[2,31],65:[2,31],66:[2,31],69:[2,31],70:[2,31],71:[2,31],72:[2,31],73:[2,31],74:[2,31],78:[2,
31],79:[2,31],80:[2,31],81:[2,31],85:[2,31],89:[2,31],93:[2,31],97:[2,31],101:[2,31],105:[2,31],111:[2,31],112:[2,31],113:[2,31],114:[2,31],115:[2,31],116:[2,31],117:[2,31],118:[2,31],119:[2,31],120:[2,31],121:[2,31],122:[2,31],148:[2,31]},{2:[2,14],11:[2,14],14:[2,14],18:[2,14],21:[2,14],23:[2,14],24:[2,14],26:[2,14],31:[2,14],43:[2,14],44:[2,14],51:[2,14],52:[2,14],57:[2,14],58:[2,14],59:[2,14],64:[2,14],65:[2,14],66:[2,14],69:[2,14],70:[2,14],71:[2,14],72:[2,14],73:[2,14],74:[2,14],78:[2,14],79:[2,
14],80:[2,14],81:[2,14],85:[2,14],89:[2,14],93:[2,14],97:[2,14],101:[2,14],105:[2,14],111:[2,14],112:[2,14],113:[2,14],114:[2,14],115:[2,14],116:[2,14],117:[2,14],118:[2,14],119:[2,14],120:[2,14],121:[2,14],122:[2,14],148:[2,14]},{14:[2,10],18:[2,10]},{14:[2,6],18:[2,6]},{14:[2,7],18:[2,7]},{14:[2,8],18:[2,8]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[2,290],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,
47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:3,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],145:461,146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26],180:475},{17:[1,476]},
{17:[1,477]},{14:[1,410],23:[1,478]},{1:[2,262],4:[2,262],5:[2,262],6:[2,262],7:[2,262],8:[2,262],10:[2,262],17:[2,262],18:[2,262],19:[2,262],21:[2,262],24:[2,262],32:[2,262],43:[2,262],44:[2,262],47:[2,262],49:[2,262],50:[2,262],51:[2,262],52:[2,262],53:[2,262],54:[2,262],144:[2,262],146:[2,262],148:[2,262],152:[2,262],155:[2,262],156:[2,262],157:[2,262],158:[2,262],159:[2,262],162:[2,262],163:[2,262],164:[2,262],165:[2,262],166:[2,262],172:[2,262],173:[2,262],174:[2,262],175:[2,262],178:[2,262],
179:[2,262]},{1:[2,263],4:[2,263],5:[2,263],6:[2,263],7:[2,263],8:[2,263],10:[2,263],17:[2,263],18:[2,263],19:[2,263],21:[2,263],24:[2,263],32:[2,263],43:[2,263],44:[2,263],47:[2,263],49:[2,263],50:[2,263],51:[2,263],52:[2,263],53:[2,263],54:[2,263],144:[2,263],146:[2,263],148:[2,263],152:[2,263],155:[2,263],156:[2,263],157:[2,263],158:[2,263],159:[2,263],162:[2,263],163:[2,263],164:[2,263],165:[2,263],166:[2,263],172:[2,263],173:[2,263],174:[2,263],175:[2,263],178:[2,263],179:[2,263]},{18:[2,266],
168:479,170:480,171:481,172:[1,482],173:[2,266]},{23:[1,483]},{2:[2,169],14:[2,169],148:[2,169]},{14:[2,53],23:[2,53]},{2:[2,22],11:[2,22],14:[2,22],18:[2,22],21:[2,22],23:[2,22],24:[2,22],26:[2,22],31:[2,22],43:[2,22],44:[2,22],51:[2,22],52:[2,22],57:[2,22],58:[2,22],59:[2,22],64:[2,22],65:[2,22],66:[2,22],69:[2,22],70:[2,22],71:[2,22],72:[2,22],73:[2,22],74:[2,22],78:[2,22],79:[2,22],80:[2,22],81:[2,22],85:[2,22],89:[2,22],93:[2,22],97:[2,22],101:[2,22],105:[2,22],111:[2,22],112:[2,22],113:[2,22],
114:[2,22],115:[2,22],116:[2,22],117:[2,22],118:[2,22],119:[2,22],120:[2,22],121:[2,22],122:[2,22],148:[2,22]},{14:[2,24],26:[2,24]},{18:[1,484]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[2,291],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:82,
126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[2,290],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,
73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:3,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],145:461,146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26],180:485},{14:[2,289],23:[2,289]},
{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:486,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,
25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{2:[1,488],148:[1,487]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:415,23:[2,246],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,
77:125,84:123,88:119,92:116,96:113,100:110,104:108,161:489,179:[1,122]},{148:[1,490]},{14:[2,223],111:[1,420],148:[2,223],151:491},{14:[1,238],23:[1,492]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:493,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,
96:113,100:110,104:108,179:[1,122]},{14:[2,232],74:[2,232],148:[2,232]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:494,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,
139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:423,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],
56:129,61:128,63:231,75:230,82:229,86:228,90:227,94:226,98:225,102:224,106:223,107:495,179:[1,122]},{2:[2,165],11:[2,165],14:[2,165],18:[2,165],23:[2,165],26:[2,165],148:[2,165]},{18:[1,496]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[2,290],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,
99:48,103:45,108:43,110:42,124:28,125:3,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],145:461,146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26],180:497},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[2,290],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,
36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:3,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],145:461,146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,
40],178:[1,41],179:[1,26],180:498},{17:[1,499]},{18:[1,500],169:501,173:[1,502]},{18:[2,267],171:503,172:[1,482],173:[2,267]},{18:[2,268],172:[2,268],173:[2,268]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:504,24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,
92:116,96:113,100:110,104:108,179:[1,122]},{17:[1,22],126:505},{1:[2,282],4:[2,282],5:[2,282],6:[2,282],7:[2,282],8:[2,282],10:[2,282],17:[2,282],18:[2,282],19:[2,282],21:[2,282],24:[2,282],32:[2,282],43:[2,282],44:[2,282],47:[2,282],49:[2,282],50:[2,282],51:[2,282],52:[2,282],53:[2,282],54:[2,282],144:[2,282],146:[2,282],148:[2,282],152:[2,282],155:[2,282],156:[2,282],157:[2,282],158:[2,282],159:[2,282],162:[2,282],163:[2,282],164:[2,282],165:[2,282],166:[2,282],172:[2,282],173:[2,282],174:[2,282],
175:[2,282],178:[2,282],179:[2,282]},{18:[1,506]},{1:[2,237],4:[2,237],5:[2,237],6:[2,237],7:[2,237],8:[2,237],10:[2,237],17:[2,237],18:[2,237],19:[2,237],21:[2,237],24:[2,237],32:[2,237],43:[2,237],44:[2,237],47:[2,237],49:[2,237],50:[2,237],51:[2,237],52:[2,237],53:[2,237],54:[2,237],144:[2,237],146:[2,237],148:[2,237],152:[2,237],155:[2,237],156:[2,237],157:[2,237],158:[2,237],159:[2,237],162:[2,237],163:[2,237],164:[2,237],165:[2,237],166:[2,237],172:[2,237],173:[2,237],174:[2,237],175:[2,237],
178:[2,237],179:[2,237]},{1:[2,238],4:[2,238],5:[2,238],6:[2,238],7:[2,238],8:[2,238],10:[2,238],17:[2,238],18:[2,238],19:[2,238],21:[2,238],24:[2,238],32:[2,238],43:[2,238],44:[2,238],47:[2,238],49:[2,238],50:[2,238],51:[2,238],52:[2,238],53:[2,238],54:[2,238],144:[2,238],146:[2,238],148:[2,238],152:[2,238],155:[2,238],156:[2,238],157:[2,238],158:[2,238],159:[2,238],162:[2,238],163:[2,238],164:[2,238],165:[2,238],166:[2,238],172:[2,238],173:[2,238],174:[2,238],175:[2,238],178:[2,238],179:[2,238]},
{1:[2,239],4:[2,239],5:[2,239],6:[2,239],7:[2,239],8:[2,239],10:[2,239],17:[2,239],18:[2,239],19:[2,239],21:[2,239],24:[2,239],32:[2,239],43:[2,239],44:[2,239],47:[2,239],49:[2,239],50:[2,239],51:[2,239],52:[2,239],53:[2,239],54:[2,239],144:[2,239],146:[2,239],148:[2,239],152:[2,239],155:[2,239],156:[2,239],157:[2,239],158:[2,239],159:[2,239],162:[2,239],163:[2,239],164:[2,239],165:[2,239],166:[2,239],172:[2,239],173:[2,239],174:[2,239],175:[2,239],178:[2,239],179:[2,239]},{23:[1,507]},{3:55,4:[1,
59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,124],12:107,15:117,16:120,17:[1,121],19:[1,54],20:56,21:[1,57],22:415,23:[2,246],24:[1,64],29:114,30:118,32:[1,115],35:111,37:112,40:109,42:131,43:[1,76],44:[1,77],46:132,47:[1,73],48:130,49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],56:129,61:128,63:127,68:126,77:125,84:123,88:119,92:116,96:113,100:110,104:108,161:508,179:[1,122]},{14:[2,224],148:[2,224]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,
54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:509,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],
165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{14:[1,238],23:[1,510]},{1:[2,243],4:[2,243],5:[2,243],6:[2,243],7:[2,243],8:[2,243],10:[2,243],17:[2,243],18:[2,243],19:[2,243],21:[2,243],24:[2,243],32:[2,243],43:[2,243],44:[2,243],47:[2,243],49:[2,243],50:[2,243],51:[2,243],52:[2,243],53:[2,243],54:[2,243],144:[2,243],146:[2,243],148:[2,243],152:[2,243],155:[2,243],156:[2,243],157:[2,243],158:[2,243],159:[2,243],162:[2,243],163:[2,243],164:[2,243],165:[2,243],166:[2,243],172:[2,
243],173:[2,243],174:[2,243],175:[2,243],178:[2,243],179:[2,243]},{11:[2,167],14:[2,167],74:[2,167],148:[2,167]},{2:[2,284],11:[2,284],14:[2,284],18:[2,284],21:[2,284],23:[2,284],24:[2,284],26:[2,284],31:[2,284],43:[2,284],44:[2,284],51:[2,284],52:[2,284],57:[2,284],58:[2,284],59:[2,284],64:[2,284],65:[2,284],66:[2,284],69:[2,284],70:[2,284],71:[2,284],72:[2,284],73:[2,284],74:[2,284],78:[2,284],79:[2,284],80:[2,284],81:[2,284],85:[2,284],89:[2,284],93:[2,284],97:[2,284],101:[2,284],105:[2,284],111:[2,
284],112:[2,284],113:[2,284],114:[2,284],115:[2,284],116:[2,284],117:[2,284],118:[2,284],119:[2,284],120:[2,284],121:[2,284],122:[2,284],148:[2,284]},{18:[1,511]},{18:[1,512]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[2,290],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,
108:43,110:42,124:28,125:3,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],145:461,146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26],180:513},{1:[2,264],4:[2,264],5:[2,264],6:[2,264],7:[2,264],8:[2,264],10:[2,264],17:[2,264],18:[2,264],19:[2,264],21:[2,264],24:[2,264],32:[2,264],43:[2,264],44:[2,
264],47:[2,264],49:[2,264],50:[2,264],51:[2,264],52:[2,264],53:[2,264],54:[2,264],144:[2,264],146:[2,264],148:[2,264],152:[2,264],155:[2,264],156:[2,264],157:[2,264],158:[2,264],159:[2,264],162:[2,264],163:[2,264],164:[2,264],165:[2,264],166:[2,264],172:[2,264],173:[2,264],174:[2,264],175:[2,264],178:[2,264],179:[2,264]},{18:[2,266],168:514,170:480,171:481,172:[1,482]},{11:[1,515]},{18:[2,269],172:[2,269],173:[2,269]},{11:[1,516],14:[1,238]},{1:[2,278],4:[2,278],5:[2,278],6:[2,278],7:[2,278],8:[2,
278],10:[2,278],17:[2,278],18:[2,278],19:[2,278],21:[2,278],24:[2,278],32:[2,278],43:[2,278],44:[2,278],47:[2,278],49:[2,278],50:[2,278],51:[2,278],52:[2,278],53:[2,278],54:[2,278],144:[2,278],146:[2,278],148:[2,278],152:[2,278],155:[2,278],156:[2,278],157:[2,278],158:[2,278],159:[2,278],162:[2,278],163:[2,278],164:[2,278],165:[2,278],166:[2,278],172:[2,278],173:[2,278],174:[2,278],175:[2,278],176:[1,517],178:[2,278],179:[2,278]},{1:[2,283],4:[2,283],5:[2,283],6:[2,283],7:[2,283],8:[2,283],10:[2,
283],17:[2,283],18:[2,283],19:[2,283],21:[2,283],24:[2,283],32:[2,283],43:[2,283],44:[2,283],47:[2,283],49:[2,283],50:[2,283],51:[2,283],52:[2,283],53:[2,283],54:[2,283],144:[2,283],146:[2,283],148:[2,283],152:[2,283],155:[2,283],156:[2,283],157:[2,283],158:[2,283],159:[2,283],162:[2,283],163:[2,283],164:[2,283],165:[2,283],166:[2,283],172:[2,283],173:[2,283],174:[2,283],175:[2,283],178:[2,283],179:[2,283]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,
21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:518,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],
166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{23:[1,519]},{1:[2,244],4:[2,244],5:[2,244],6:[2,244],7:[2,244],8:[2,244],10:[2,244],17:[2,244],18:[2,244],19:[2,244],21:[2,244],24:[2,244],32:[2,244],43:[2,244],44:[2,244],47:[2,244],49:[2,244],50:[2,244],51:[2,244],52:[2,244],53:[2,244],54:[2,244],144:[2,244],146:[2,244],148:[2,244],152:[2,244],155:[2,244],156:[2,244],157:[2,244],158:[2,244],159:[2,244],162:[2,244],163:[2,244],164:[2,244],165:[2,244],166:[2,244],172:[2,244],173:[2,244],174:[2,
244],175:[2,244],178:[2,244],179:[2,244]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:520,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,
144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{2:[2,285],11:[2,285],14:[2,285],18:[2,285],21:[2,285],23:[2,285],24:[2,285],26:[2,285],31:[2,285],43:[2,285],44:[2,285],51:[2,285],52:[2,285],57:[2,285],58:[2,285],59:[2,285],64:[2,285],65:[2,285],66:[2,285],69:[2,285],70:[2,285],71:[2,285],72:[2,285],73:[2,285],74:[2,285],78:[2,285],79:[2,285],80:[2,285],81:[2,
285],85:[2,285],89:[2,285],93:[2,285],97:[2,285],101:[2,285],105:[2,285],111:[2,285],112:[2,285],113:[2,285],114:[2,285],115:[2,285],116:[2,285],117:[2,285],118:[2,285],119:[2,285],120:[2,285],121:[2,285],122:[2,285],148:[2,285]},{2:[2,286],11:[2,286],14:[2,286],18:[2,286],21:[2,286],23:[2,286],24:[2,286],26:[2,286],31:[2,286],43:[2,286],44:[2,286],51:[2,286],52:[2,286],57:[2,286],58:[2,286],59:[2,286],64:[2,286],65:[2,286],66:[2,286],69:[2,286],70:[2,286],71:[2,286],72:[2,286],73:[2,286],74:[2,286],
78:[2,286],79:[2,286],80:[2,286],81:[2,286],85:[2,286],89:[2,286],93:[2,286],97:[2,286],101:[2,286],105:[2,286],111:[2,286],112:[2,286],113:[2,286],114:[2,286],115:[2,286],116:[2,286],117:[2,286],118:[2,286],119:[2,286],120:[2,286],121:[2,286],122:[2,286],148:[2,286]},{18:[1,521]},{18:[1,522]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[2,272],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,
74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:3,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],145:523,146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],172:[2,272],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{3:55,4:[1,59],5:[1,60],6:[1,
61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[2,270],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:3,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],145:524,146:[1,24],148:[1,27],152:[1,25],155:[1,
29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],172:[2,270],173:[2,270],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{17:[1,22],126:525},{1:[2,241],4:[2,241],5:[2,241],6:[2,241],7:[2,241],8:[2,241],10:[2,241],17:[2,241],18:[2,241],19:[2,241],21:[2,241],24:[2,241],32:[2,241],43:[2,241],44:[2,241],47:[2,241],49:[2,241],50:[2,241],51:[2,241],52:[2,241],53:[2,241],54:[2,241],144:[2,241],146:[2,241],148:[2,241],152:[2,241],155:[2,241],156:[2,241],157:[2,241],
158:[2,241],159:[2,241],162:[2,241],163:[2,241],164:[2,241],165:[2,241],166:[2,241],172:[2,241],173:[2,241],174:[2,241],175:[2,241],178:[2,241],179:[2,241]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:526,
126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{1:[2,245],4:[2,245],5:[2,245],6:[2,245],7:[2,245],8:[2,245],10:[2,245],17:[2,245],18:[2,245],19:[2,245],21:[2,245],24:[2,245],32:[2,245],43:[2,245],44:[2,245],47:[2,245],49:[2,245],50:[2,245],
51:[2,245],52:[2,245],53:[2,245],54:[2,245],144:[2,245],146:[2,245],148:[2,245],152:[2,245],155:[2,245],156:[2,245],157:[2,245],158:[2,245],159:[2,245],162:[2,245],163:[2,245],164:[2,245],165:[2,245],166:[2,245],172:[2,245],173:[2,245],174:[2,245],175:[2,245],178:[2,245],179:[2,245]},{2:[2,287],11:[2,287],14:[2,287],18:[2,287],21:[2,287],23:[2,287],24:[2,287],26:[2,287],31:[2,287],43:[2,287],44:[2,287],51:[2,287],52:[2,287],57:[2,287],58:[2,287],59:[2,287],64:[2,287],65:[2,287],66:[2,287],69:[2,287],
70:[2,287],71:[2,287],72:[2,287],73:[2,287],74:[2,287],78:[2,287],79:[2,287],80:[2,287],81:[2,287],85:[2,287],89:[2,287],93:[2,287],97:[2,287],101:[2,287],105:[2,287],111:[2,287],112:[2,287],113:[2,287],114:[2,287],115:[2,287],116:[2,287],117:[2,287],118:[2,287],119:[2,287],120:[2,287],121:[2,287],122:[2,287],148:[2,287]},{1:[2,265],4:[2,265],5:[2,265],6:[2,265],7:[2,265],8:[2,265],10:[2,265],17:[2,265],18:[2,265],19:[2,265],21:[2,265],24:[2,265],32:[2,265],43:[2,265],44:[2,265],47:[2,265],49:[2,
265],50:[2,265],51:[2,265],52:[2,265],53:[2,265],54:[2,265],144:[2,265],146:[2,265],148:[2,265],152:[2,265],155:[2,265],156:[2,265],157:[2,265],158:[2,265],159:[2,265],162:[2,265],163:[2,265],164:[2,265],165:[2,265],166:[2,265],172:[2,265],173:[2,265],174:[2,265],175:[2,265],178:[2,265],179:[2,265]},{3:55,4:[1,59],5:[1,60],6:[1,61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[2,273],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],
49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:82,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],172:[2,273],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{3:55,4:[1,59],5:[1,60],6:[1,
61],7:[1,62],8:[1,63],10:[1,38],16:52,17:[1,22],18:[2,271],19:[1,54],20:56,21:[1,57],24:[1,64],32:[1,50],34:49,36:46,38:47,41:44,43:[1,76],44:[1,77],45:71,46:72,47:[1,73],49:[1,74],50:[1,75],51:[1,78],52:[1,79],53:[1,80],54:[1,81],55:70,60:69,62:68,67:67,76:66,83:65,87:58,91:53,95:51,99:48,103:45,108:43,110:42,124:28,125:82,126:4,127:5,128:6,129:7,130:8,131:9,132:10,133:11,134:12,135:13,136:14,137:15,138:16,139:17,140:18,141:19,142:20,143:21,144:[1,23],146:[1,24],148:[1,27],152:[1,25],155:[1,29],
157:[1,30],158:[1,31],159:[1,32],162:[1,33],163:[1,34],164:[1,35],165:[1,36],166:[1,37],172:[2,271],173:[2,271],174:[1,39],175:[1,40],178:[1,41],179:[1,26]},{1:[2,279],4:[2,279],5:[2,279],6:[2,279],7:[2,279],8:[2,279],10:[2,279],17:[2,279],18:[2,279],19:[2,279],21:[2,279],24:[2,279],32:[2,279],43:[2,279],44:[2,279],47:[2,279],49:[2,279],50:[2,279],51:[2,279],52:[2,279],53:[2,279],54:[2,279],144:[2,279],146:[2,279],148:[2,279],152:[2,279],155:[2,279],156:[2,279],157:[2,279],158:[2,279],159:[2,279],
162:[2,279],163:[2,279],164:[2,279],165:[2,279],166:[2,279],172:[2,279],173:[2,279],174:[2,279],175:[2,279],178:[2,279],179:[2,279]},{1:[2,242],4:[2,242],5:[2,242],6:[2,242],7:[2,242],8:[2,242],10:[2,242],17:[2,242],18:[2,242],19:[2,242],21:[2,242],24:[2,242],32:[2,242],43:[2,242],44:[2,242],47:[2,242],49:[2,242],50:[2,242],51:[2,242],52:[2,242],53:[2,242],54:[2,242],144:[2,242],146:[2,242],148:[2,242],152:[2,242],155:[2,242],156:[2,242],157:[2,242],158:[2,242],159:[2,242],162:[2,242],163:[2,242],
164:[2,242],165:[2,242],166:[2,242],172:[2,242],173:[2,242],174:[2,242],175:[2,242],178:[2,242],179:[2,242]}],defaultActions:{},parseError:function(b){throw Error(b);},parse:function(b){function c(){var b;b=d.lexer.lex()||1;typeof b!=="number"&&(b=d.symbols_[b]||b);return b}var d=this,h=[0],j=[null],k=[],l=this.table,m="",n=0,q=0,p=0;this.lexer.setInput(b);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc=="undefined")this.lexer.yylloc={};b=this.lexer.yylloc;
k.push(b);var s=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError==="function")this.parseError=this.yy.parseError;for(var r,o,t,u,w={},z,A;;){t=h[h.length-1];if(this.defaultActions[t])u=this.defaultActions[t];else{if(r===null||typeof r=="undefined")r=c();u=l[t]&&l[t][r]}if(typeof u==="undefined"||!u.length||!u[0]){u="";if(!p){o=[];for(z in l[t])this.terminals_[z]&&z>2&&o.push("'"+this.terminals_[z]+"'");u=this.lexer.showPosition?"Parse error on line "+(n+1)+":\n"+this.lexer.showPosition()+
"\nExpecting "+o.join(", ")+", got '"+(this.terminals_[r]||r)+"'":"Parse error on line "+(n+1)+": Unexpected "+(r==1?"end of input":"'"+(this.terminals_[r]||r)+"'");this.parseError(u,{text:this.lexer.match,token:this.terminals_[r]||r,line:this.lexer.yylineno,loc:b,expected:o})}if(p==3){if(r==1)throw Error(u||"Parsing halted.");q=this.lexer.yyleng;m=this.lexer.yytext;n=this.lexer.yylineno;b=this.lexer.yylloc;r=c()}for(;;){if((2).toString()in l[t])break;if(t===0)throw Error(u||"Parsing halted.");h.length=
h.length-2;j.length=j.length-1;k.length=k.length-1;t=h[h.length-1]}o=r==2?null:r;r=2;t=h[h.length-1];u=l[t]&&l[t][2];p=3}if(u[0]instanceof Array&&u.length>1)throw Error("Parse Error: multiple actions possible at state: "+t+", token: "+r);switch(u[0]){case 1:h.push(r);j.push(this.lexer.yytext);k.push(this.lexer.yylloc);h.push(u[1]);r=null;if(o){r=o;o=null}else{q=this.lexer.yyleng;m=this.lexer.yytext;n=this.lexer.yylineno;b=this.lexer.yylloc;p>0&&p--}break;case 2:A=this.productions_[u[1]][1];w.$=j[j.length-
A];w._$={first_line:k[k.length-(A||1)].first_line,last_line:k[k.length-1].last_line,first_column:k[k.length-(A||1)].first_column,last_column:k[k.length-1].last_column};if(s)w._$.range=[k[k.length-(A||1)].range[0],k[k.length-1].range[1]];t=this.performAction.call(w,m,q,n,this.yy,u[1],j,k);if(typeof t!=="undefined")return t;if(A){h=h.slice(0,A*-2);j=j.slice(0,-1*A);k=k.slice(0,-1*A)}h.push(this.productions_[u[1]][0]);j.push(w.$);k.push(w._$);t=l[h[h.length-2]][h[h.length-1]];h.push(t);break;case 3:return true}}return true}},
d=function(){return{EOF:1,parseError:function(b,c){if(this.yy.parser)this.yy.parser.parseError(b,c);else throw Error(b);},setInput:function(b){this._input=b;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges)this.yylloc.range=[0,0];this.offset=0;return this},input:function(){var b=this._input[0];this.yytext=this.yytext+b;this.yyleng++;
this.offset++;this.match=this.match+b;this.matched=this.matched+b;if(b.match(/(?:\r\n?|\n).*/g)){this.yylineno++;this.yylloc.last_line++}else this.yylloc.last_column++;this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return b},unput:function(b){var c=b.length,d=b.split(/(?:\r\n?|\n)/g);this._input=b+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-c-1);this.offset=this.offset-c;b=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-
1);this.matched=this.matched.substr(0,this.matched.length-1);if(d.length-1)this.yylineno=this.yylineno-(d.length-1);var h=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:d?(d.length===b.length?this.yylloc.first_column:0)+b[b.length-d.length].length-d[0].length:this.yylloc.first_column-c};if(this.options.ranges)this.yylloc.range=[h[0],h[0]+this.yyleng-c];return this},more:function(){this._more=true;return this},
less:function(b){this.unput(this.match.slice(b))},pastInput:function(){var b=this.matched.substr(0,this.matched.length-this.match.length);return(b.length>20?"...":"")+b.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var b=this.match;b.length<20&&(b=b+this._input.substr(0,20-b.length));return(b.substr(0,20)+(b.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var b=this.pastInput(),c=Array(b.length+1).join("-");return b+this.upcomingInput()+"\n"+c+"^"},next:function(){if(this.done)return this.EOF;
if(!this._input)this.done=true;var b,c,d;if(!this._more)this.match=this.yytext="";for(var h=this._currentRules(),j=0;j<h.length;j++)if((c=this._input.match(this.rules[h[j]]))&&(!b||c[0].length>b[0].length)){b=c;d=j;if(!this.options.flex)break}if(b){if(c=b[0].match(/(?:\r\n?|\n).*/g))this.yylineno=this.yylineno+c.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:c?c[c.length-1].length-c[c.length-1].match(/\r?\n?/)[0].length:
this.yylloc.last_column+b[0].length};this.yytext=this.yytext+b[0];this.match=this.match+b[0];this.matches=b;this.yyleng=this.yytext.length;if(this.options.ranges)this.yylloc.range=[this.offset,this.offset=this.offset+this.yyleng];this._more=false;this._input=this._input.slice(b[0].length);this.matched=this.matched+b[0];b=this.performAction.call(this,this.yy,this,h[d],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input)this.done=false;if(b)return b}else return this._input===
""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var b=this.next();return typeof b!=="undefined"?b:this.lex()},begin:function(b){this.conditionStack.push(b)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-
2]},pushState:function(b){this.begin(b)},options:{},performAction:function(b,c,d){switch(d){case 2:this.begin("ANNOTATION");break;case 3:this.begin("COMMENT");break;case 4:this.begin("SEQ");return"PARAM";case 5:return"PARAM";case 6:return 7;case 7:return 10;case 8:return 8;case 9:return 8;case 10:this.begin("INITIAL");break;case 11:this.begin("ANNOTATION");break;case 12:this.begin("INITIAL");break;case 14:this.begin("INITIAL");break;case 16:return 4;case 17:return 5;case 18:return 6;case 19:return 163;
case 20:return 172;case 21:return 177;case 22:return 152;case 23:return 173;case 24:return 176;case 25:return 159;case 26:return 73;case 27:return 32;case 28:return 146;case 29:return 162;case 30:return 179;case 31:return 164;case 32:return 49;case 33:return 47;case 34:return 155;case 35:return 19;case 36:return 157;case 37:return 158;case 38:return 156;case 39:return 74;case 40:return 166;case 41:return 174;case 42:return 175;case 43:return 50;case 44:return 165;case 45:return 178;case 46:return 7;
case 47:return 10;case 48:return 8;case 49:return 8;case 50:return 118;case 51:return 116;case 52:return 117;case 53:return 80;case 54:return 81;case 55:return 97;case 56:return 101;case 57:return 43;case 58:return 44;case 59:return 114;case 60:return 115;case 61:return 122;case 62:return 112;case 63:return 113;case 64:return 120;case 65:return 119;case 66:return 121;case 67:return 71;case 68:return 72;case 69:return 78;case 70:return 79;case 71:return 66;case 72:return 64;case 73:return 65;case 74:return 111;
case 75:return 57;case 76:return 58;case 77:return 59;case 78:return 52;case 79:return 51;case 80:return 89;case 81:return 21;case 82:return 23;case 83:return 24;case 84:return 26;case 85:return 17;case 86:return 18;case 87:return 69;case 88:return 70;case 89:return 53;case 90:return 54;case 91:return 89;case 92:return 85;case 93:return 93;case 94:return 14;case 95:return 148;case 96:return 31;case 97:return 105;case 98:return 11;case 99:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:\/\/.*)/,/^(?:\/\*\*)/,
/^(?:\/\*)/,/^(?:@param\b)/,/^(?:@param\b)/,/^(?:[0-9]+(\.[0-9]+)?\b)/,/^(?:[a-zA-Z_][a-zA-Z0-9_]*)/,/^(?:"(\\.|[^\"])*")/,/^(?:'(\\.|[^\'])*')/,/^(?:\*\/)/,/^(?:.)/,/^(?:\*\/)/,/^(?:.)/,/^(?:\*\/)/,/^(?:.)/,/^(?:null\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:break\b)/,/^(?:case\b)/,/^(?:catch\b)/,/^(?:const\b)/,/^(?:default\b)/,/^(?:finally\b)/,/^(?:for\b)/,/^(?:instanceof\b)/,/^(?:new\b)/,/^(?:var\b)/,/^(?:continue\b)/,/^(?:function\b)/,/^(?:return\b)/,/^(?:void\b)/,/^(?:delete\b)/,/^(?:if\b)/,/^(?:this\b)/,
/^(?:do\b)/,/^(?:while\b)/,/^(?:else\b)/,/^(?:in\b)/,/^(?:switch\b)/,/^(?:throw\b)/,/^(?:try\b)/,/^(?:typeof\b)/,/^(?:with\b)/,/^(?:debugger\b)/,/^(?:((((?:[0-9]|[1-9][0-9]+))((?:\.[0-9]+))?((?:[eE][-+]?[0-9]+))?)|(((?:\.[0-9]+))((?:[eE][-+]?[0-9]+))?))\b)/,/^(?:[a-zA-Z_][a-zA-Z0-9_]*)/,/^(?:"(\\.|[^\"])*")/,/^(?:'(\\.|[^\'])*')/,/^(?:>>>=)/,/^(?:<<=)/,/^(?:>>=)/,/^(?:===)/,/^(?:!==)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:\+\+)/,/^(?:--)/,/^(?:\*=)/,/^(?:\/=)/,/^(?:%=)/,/^(?:\+=)/,/^(?:-=)/,/^(?:\^=)/,/^(?:&=)/,
/^(?:\|=)/,/^(?:<=)/,/^(?:>=)/,/^(?:==)/,/^(?:!=)/,/^(?:>>>)/,/^(?:<<)/,/^(?:>>)/,/^(?:=)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\[)/,/^(?:\])/,/^(?:\{)/,/^(?:\})/,/^(?:<)/,/^(?:>)/,/^(?:~)/,/^(?:!)/,/^(?:\^)/,/^(?:&)/,/^(?:\|)/,/^(?:,)/,/^(?:;)/,/^(?:\.)/,/^(?:\?)/,/^(?::)/,/^(?:.)/],conditions:{SEQ:{rules:[0,1,2,3,5,6,7,8,9,10,11,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,
57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],inclusive:true},ANNOTATION:{rules:[0,1,2,3,4,12,13,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],inclusive:true},COMMENT:{rules:[0,1,2,3,14,15,16,17,18,19,20,21,22,
23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],inclusive:true},INITIAL:{rules:[0,1,2,3,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,
93,94,95,96,97,98,99],inclusive:true}}}}();c.lexer=d;b.prototype=c;c.Parser=b;return new b}();
"undefined"!==typeof require&&"undefined"!==typeof exports&&(exports.parser=g_parser,exports.Parser=g_parser.Parser,exports.parse=function(){return g_parser.parse.apply(g_parser,arguments)},exports.main=function(b){if(!b[1])throw Error("Usage: "+b[0]+" FILE");b=typeof process!=="undefined"?require("fs").readFileSync(require("path").resolve(b[1]),"utf8"):require("file").path(require("file").cwd()).join(b[1]).read({charset:"utf-8"});return exports.parser.parse(b)},"undefined"!==typeof module&&require.main===
module&&exports.main("undefined"!==typeof process?process.argv.slice(1):require("system").args));function Exception(b){console.log(b)}
var BlockGen={_fnStack:[{locals:[],params:[]}],pushFunction:function(b){this._fnStack.push(b)},peekFunction:function(){return this._fnStack.length>0?this._fnStack[this._fnStack.length-1]:null},popFunction:function(){return this._fnStack.pop()},stackSize:function(){return this._fnStack.length},generate:function(b){this.reset();b.generate()},reset:function(){this._fnStack.length=0;this._fnStack.push({locals:[],params:[]});this._sprites.length=0;this._background={variables:{}};this._inSprite=false},
_inSprite:!1,_background:{variables:{}},_sprites:[],startSprite:function(){this._sprites.push({variables:{}});this._inSprite=true},endSprite:function(){this._inSprite=false},getSprite:function(){return this._inSprite?this._sprites[this._sprites.length-1]:this._background},getBackground:function(){return this._background},getAllSprites:function(){return this._sprites}};
function Node(){this.children=[];if(arguments.length>=1){this.name=arguments[0];for(var b=1;b<arguments.length;b++)this.children.push(arguments[b])}else this.name=""}Node.prototype.setChild=function(b,c){if(this.children.length<b)for(var d=0;d<=b;d++)this.children.push(null);this.children[b]=c};Node.prototype.addChild=function(b){this.children.push(b)};Node.prototype.prependChild=function(b){this.children.unshift(b)};Node.prototype.getNumChildren=function(){return this.children.length};
Node.prototype.getChild=function(b){return b>=0&&b<this.children.length?this.children[b]:null};Node.prototype.generate=function(b){var c=this["generate_"+this.name];if(c)return c.apply(this,[b]);throw new Exception("unknown block: "+this.name);};Node.prototype.generate_linecomment=function(){var b=new Block({cat:"comment",func:"blockInlineComment",label:"//{string:comment}"});b.label.setValue(0,this.getChild(0));return b};Node.prototype.generate_number=function(){return parseFloat(this.getChild(0))};
Node.prototype.generate_string=function(){return this.getChild(0)};Node.prototype.generate_true=function(){return true};Node.prototype.generate_false=function(){return false};Node.prototype.generate_null=function(){return null};
Node.prototype.generate_identifier=function(b){if(b&&b.lvalue)b=this.getChild(0);else{b=BlockGen.peekFunction();b=b.locals.indexOf(this.getChild(0))>=0?new Label({cat:"localvar",func:"valueScriptVar",name:this.getChild(0)}):b.params.indexOf(this.getChild(0))>=0?new Label({cat:"functions",func:"valueParam",name:this.getChild(0)}):new Label({cat:"var",func:"valueVar",name:this.getChild(0)})}return b};
Node.prototype.generate_Block=function(){for(var b,c=0;c<this.children.length;c++)b?b.append(this.getChild(c).generate()):b=this.getChild(c).generate();return b};
Node.prototype.generate_Function=function(){var b=this.getChild(0),c=this.getChild(1),d=this.getChild(2),e={locals:[],params:[]};BlockGen.pushFunction(e);var f=null;if(b){var g=b;if(c)for(var h=0;h<c.children.length;h++){g=g+(" {string:"+c.children[h]+"}");e.params.indexOf(c.children[h])<0&&e.params.push(c.children[h])}f=new Block({cat:"functions",func:"registerFunction",hasFlap:false,name:b,label:g});if(c)for(h=0;h<c.children.length;h++){g=new Label({cat:"functions",func:"valueParam",name:c.children[h]});
f.label.setValue(h,g)}d&&f.add(d.generate())}c=BlockGen.popFunction().locals;if(c.length>0){g="script variables";for(h=0;h<c.length;h++)g=g+(" {scriptvar:"+c[h]+"}");h=new Block({cat:"localvar",label:g+"{varargs:valueScriptVar}",func:"blockControlScriptVar"});h.next=f.next;f.next=h;h.parent=f;h.next.parent=h}return f};Node.prototype.generate_Return=function(){var b=makeBlockByName("blockControlReturn");this.children.length>0&&b.label.setValue(0,this.getChild(0).generate({rvalue:true}));return b};
Node.prototype.generate_Break=function(){return makeBlockByName("blockControlBreak")};Node.prototype.generate_Continue=function(){return makeBlockByName("blockControlContinue")};
Node.prototype.generate_DoWhile=function(){var b,c=this.getChild(0).generate({rvalue:true});if(c===true){b=makeBlockByName("blockControlForever");this.getChild(1)&&b.appendToContainer(0,this.getChild(1).generate())}else if(c===false){b=makeBlockByName("blockControlForever");this.getChild(1)&&b.appendToContainer(0,this.getChild(1).generate());b.appendToContainer(0,makeBlockByName("blockControlBreak"))}else{b=makeBlockByName("blockControlForever");var d=makeBlockByName("blockControlIf"),e=makeBlockByName("valueOpNot");
e.setValue(0,c);d.label.setValue(0,e);d.appendToContainer(0,makeBlockByName("blockControlBreak"));this.getChild(1)&&b.appendToContainer(0,this.getChild(1).generate());b.appendToContainer(0,d)}return b};Node.prototype.generate_While=function(){var b,c=this.getChild(0).generate({rvalue:true});if(c===true)b=makeBlockByName("blockControlForever");else{b=makeBlockByName("blockControlWhile");b.label.setValue(0,c)}this.getChild(1)&&b.appendToContainer(0,this.getChild(1).generate());return b};
Node.prototype.generate_For=function(){var b,c=this.getChild(0);if(c)b=c=c.generate();var d=this.getChild(1);d&&(d=d.generate({rvalue:true}));(c=this.getChild(2))&&(c=c.generate({lvalue:true}));var e;if(d){e=makeBlockByName("blockControlWhile");d&&e.label.setValue(0,d)}else e=makeBlockByName("blockControlForever");(d=this.getChild(3))&&e.appendToContainer(0,d.generate());c&&e.appendToContainer(0,c);if(b){b.next=e;e.parent=b}else b=e;return b};
Node.prototype.generate_ForScoped=function(){var b,c,d=this.getChild(0);if(d)for(var e=0;e<d.length;e++){var f=d[e].generate();if(b){c.next=f;f.parent=c}else b=f;for(c=f;c&&c.next;)c=c.next}(f=this.getChild(1))&&(f=f.generate({rvalue:true}));(d=this.getChild(2))&&(d=d.generate({lvalue:true}));if(f){e=makeBlockByName("blockControlWhile");f&&e.label.setValue(0,f)}else e=makeBlockByName("blockControlForever");(f=this.getChild(3))&&e.appendToContainer(0,f.generate());d&&e.appendToContainer(0,d);if(c){c.next=
e;e.parent=c}else b=e;return b};Node.prototype.generate_If=function(){var b=makeBlockByName("blockControlIf");b.label.setValue(0,this.getChild(0).generate({rvalue:true}));this.getChild(1)&&b.appendToContainer(0,this.getChild(1).generate());return b};
Node.prototype.generate_IfElse=function(){var b=makeBlockByName("blockControlIfElse");b.label.setValue(0,this.getChild(0).generate({rvalue:true}));this.getChild(1)&&b.appendToContainer(0,this.getChild(1).generate());this.getChild(2)&&b.appendToContainer(1,this.getChild(2).generate());return b};Node.prototype.generate_VarDeclaration=function(){var b=BlockGen.peekFunction();b.locals.indexOf(this.getChild(0))<0&&b.locals.push(this.getChild(0));return null};
Node.prototype.generate_VarDeclarationAssignment=function(){var b=BlockGen.peekFunction();b.locals.indexOf(this.getChild(0))<0&&b.locals.push(this.getChild(0));if(b=this.getChild(1)){var c=makeBlockByName("blockVarSet");c.label.setValue(0,this.getChild(0));c.label.setValue(1,b.generate({rvalue:true}));return c}return null};
Node.prototype.generate_Json=function(){var b;if(this.children.length>0){var c=this.getPropertyValue(this);b=makeBlockByName("valueNetworkParse");b.setValue(0,JSON.stringify(c))}else b=makeBlockByName("valueListNew");return b};Node.prototype.generate_ArrayLiteral=function(){var b;if(this.children.length>0){var c=this.getPropertyValue(this);b=makeBlockByName("valueNetworkParse");b.setValue(0,JSON.stringify(c))}else b=makeBlockByName("valueListNew");return b};
Node.prototype.generateMath=function(b,c){var d;switch(b){case "abs":d=makeBlockByName("valueOpMath");d.setValue(0,"abs");d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "acos":d=makeBlockByName("valueOpMath");d.setValue(0,"acosrad");d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "asin":d=makeBlockByName("valueOpMath");d.setValue(0,"asinrad");d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "atan":d=makeBlockByName("valueOpMath");d.setValue(0,"atanrad");
d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "atan2":d=makeBlockByName("valueOpMath2");d.setValue(0,"atan2rad");d.setValue(1,c.getChild(0).generate({rvalue:true}));d.setValue(2,c.getChild(1).generate({rvalue:true}));break;case "ceil":d=makeBlockByName("valueOpMath");d.setValue(0,"ceiling");d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "cos":d=makeBlockByName("valueOpMath");d.setValue(0,"cosrad");d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "exp":d=
makeBlockByName("valueOpMath");d.setValue(0,"e^");d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "floor":d=makeBlockByName("valueOpMath");d.setValue(0,"floor");d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "log":d=makeBlockByName("valueOpMath");d.setValue(0,"ln");d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "max":d=prev=makeBlockByName("valueOpMath2");d.setValue(0,"max");prev.setValue(1,c.getChild(0).generate({rvalue:true}));for(var e=1;e<c.children.length-
1;e++){var f=makeBlockByName("valueOpMath2");f.setValue(0,"max");f.setValue(1,c.getChild(e).generate({rvalue:true}));prev.setValue(2,f);prev=f}prev.setValue(2,c.getChild(c.children.length-1).generate({rvalue:true}));break;case "min":d=prev=makeBlockByName("valueOpMath2");d.setValue(0,"min");prev.setValue(1,c.getChild(0).generate({rvalue:true}));for(e=1;e<c.children.length-1;e++){f=makeBlockByName("valueOpMath2");f.setValue(0,"min");f.setValue(1,c.getChild(e).generate({rvalue:true}));prev.setValue(2,
f);prev=f}prev.setValue(2,c.getChild(c.children.length-1).generate({rvalue:true}));break;case "pow":d=makeBlockByName("valueOpMath2");d.setValue(0,"pow");d.setValue(1,c.getChild(0).generate({rvalue:true}));d.setValue(2,c.getChild(1).generate({rvalue:true}));break;case "random":d=makeBlockByName("valueOpRandom");d.setValue(0,0);d.setValue(1,1);break;case "randomRange":d=makeBlockByName("valueOpRandom");d.setValue(0,c.getChild(0).generate({rvalue:true}));d.setValue(1,c.getChild(1).generate({rvalue:true}));
break;case "round":d=makeBlockByName("valueOpRound");d.setValue(0,c.getChild(0).generate({rvalue:true}));break;case "sin":d=makeBlockByName("valueOpMath");d.setValue(0,"sinrad");d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "sqrt":d=makeBlockByName("valueOpMath");d.setValue(0,"sqrt");d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "tan":d=makeBlockByName("valueOpMath");d.setValue(0,"tanrad");d.setValue(1,c.getChild(0).generate({rvalue:true}));break;case "sign":d=makeBlockByName("valueOpMath");
d.setValue(0,"sign");d.setValue(1,c.getChild(0).generate({rvalue:true}))}return d};
Node.prototype.generateGlobalFunc=function(b,c,d,e){var f=null;switch(b){case "Math":if(!e||!e.rvalue)throw new Exception("Math must be used as an r-value");f=this.generateMath(c,d);break;case "Runtime":if(e&&e.rvalue)throw new Exception("Runtime must be l-value");if(c=="defineActor"){b=[];if(d.getNumChildren()>0&&d.getChild(0).name!="Json")throw new Exception("Runtime.defineActor needs a JSON");BlockGen.startSprite();this.setSpriteState(d.getChild(0));if(d=d.getChild(1).getChild(2))if(d.name=="Block")for(var g=
0;g<d.getNumChildren();g++)(f=d.getChild(g).generate())&&b.push(f);else(f=d.generate())&&b.push(f);BlockGen.getSprite().scripts=b;BlockGen.endSprite();f=null}else if(c=="defineScene"){b=[];if(d.getNumChildren()>0&&d.getChild(0).name!="Json")throw new Exception("Runtime.defineScene needs a JSON");this.setSpriteState(d.getChild(0));if(d=d.getChild(1).getChild(2))if(d.name=="Block")for(g=0;g<d.getNumChildren();g++)(f=d.getChild(g).generate())&&b.push(f);else(f=d.generate())&&b.push(f);BlockGen.getBackground().scripts=
b;f=null}else throw new Exception("unknown function Runtime."+c);break;case "Net":f=this.generateNetFunc(c,d);break;default:f="{string}.{string} (";for(g=0;g<d.children.length;g++)f=f+"{string}";f=f+"{varargs})";if(e&&e.rvalue){f=new Label({cat:"functions",func:"valueControlCallMember",label:f});f.setValue(0,b);f.setValue(1,c);for(g=0;g<d.children.length;g++)f.setValue(g+2,d.getChild(g).generate({rvalue:true}))}else{f=new Block({cat:"functions",func:"blockControlCallMember",label:f});f.label.setValue(0,
b);f.label.setValue(1,c);for(g=0;g<d.children.length;g++)f.label.setValue(g+2,d.getChild(g).generate({rvalue:true}))}}return f};
Node.prototype.generateLocalFunc=function(b,c,d,e){var f=null;if(b){f=e?e+"."+b+"."+c:"this."+b+"."+c;if(g_fnMapping[f]){if(f=makeBlockByName(g_fnMapping[f])){c=f instanceof Label?f:f.label;b=d.children.length-c.getNumSockets();if(b>0)for(e=0;e<b;e++)c.addArg();for(e=0;e<d.children.length;e++)c.setValue(e,d.getChild(e).generate({rvalue:true}))}}else throw new Exception(f+" not found");}else{BlockGen.pushFunction({locals:[],params:[]});f=e?e+"."+c:"this."+c;switch(c){case "onStart":if(d.getChild(0).name!=
"FunctionExpr")throw new Exception("this.onStart needs a function");f=makeBlockByName("registerFlagTrigger");(c=d.getChild(0).getChild(2))&&f.add(c.generate());break;case "onKeyPress":if(d.children.length!=2)throw new Exception("this.onKeyPress needs 2 parameters");if(d.getChild(0).name!="string"&&d.getChild(0).name!="number")throw new Exception("this.onKeyPress needs a key name");if(d.getChild(1).name!="FunctionExpr")throw new Exception("this.onKeyPress needs a function");f=makeBlockByName("registerKeyTrigger");
f.label.setValue(0,d.getChild(0).generate({rvalue:true}));(c=d.getChild(1).getChild(2))&&f.add(c.generate());break;case "onCondition":if(d.children.length!=2)throw new Exception("this.onCondition needs 2 parameters");if(d.getChild(0).name!="FunctionExpr")throw new Exception("this.onCondition needs an expression");if(d.getChild(1).name!="FunctionExpr")throw new Exception("this.onCondition needs a function");f=makeBlockByName("registerTrigger");(c=d.getChild(1).getChild(2))&&f.add(c.generate());break;
case "onActorClick":f=makeBlockByName("registerSpriteTrigger");(c=d.getChild(0).getChild(2))&&f.add(c.generate());break;case "onSceneChange":if(d.children.length!=2)throw new Exception("this.onSceneChange needs 2 parameters");if(d.getChild(0).name!="string"&&d.getChild(0).name!="number")throw new Exception("this.onSceneChange needs a scene name");if(d.getChild(1).name!="FunctionExpr")throw new Exception("this.onSceneChange needs a function");f=makeBlockByName("registerBackgroundChange");f.label.setValue(0,
d.getChild(0).generate({rvalue:true}));(c=d.getChild(1).getChild(2))&&f.add(c.generate());break;case "onMessageReceived":if(d.children.length!=2)throw new Exception("this.onMessageReceived needs 2 parameters");if(d.getChild(0).name!="string"&&d.getChild(0).name!="number")throw new Exception("this.onMessageReceived needs a message");if(d.getChild(1).name!="FunctionExpr")throw new Exception("this.onMessageReceived needs a function");f=makeBlockByName("registerBroadcastTrigger");f.label.setValue(0,d.getChild(0).generate({rvalue:true}));
(c=d.getChild(1).getChild(2))&&f.add(c.generate());break;case "onClone":if(d.children.length!=1)throw new Exception("this.onClone needs 1 parameter");if(d.getChild(0).name!="FunctionExpr")throw new Exception("this.onClone needs a function");f=makeBlockByName("registerCloned");(c=d.getChild(0).getChild(2))&&f.add(c.generate());break;case "onDraw":if(d.children.length!=1)throw new Exception("this.onDraw needs 1 parameter");if(d.getChild(0).name!="FunctionExpr")throw new Exception("this.onDraw needs a function");
f=makeBlockByName("registerDraw");(c=d.getChild(0).getChild(2))&&f.add(d.getChild(0).getChild(2).generate());break;case "onCollision":if(d.children.length!=1)throw new Exception("this.onCollision needs 1 parameter");if(d.getChild(0).name!="FunctionExpr")throw new Exception("this.onCollision needs a function");f=makeBlockByName("registerSpriteCollision");(c=d.getChild(0).getChild(2))&&f.add(c.generate());break;case "onAnimationDone":if(d.children.length!=2)throw new Exception("this.onAnimationDone needs 2 parameters");
if(d.getChild(0).name!="string"&&d.getChild(0).name!="number")throw new Exception("this.onAnimationDone needs an animation name");if(d.getChild(1).name!="FunctionExpr")throw new Exception("this.onAnimationDone needs a function");f=makeBlockByName("registerAnimationDone");f.label.setValue(0,d.getChild(0).generate({rvalue:true}));(c=d.getChild(1).getChild(2))&&f.add(c.generate());break;case "requestBlock":if(d.children.length!=1)throw new Exception("this.requestBlock needs 1 parameter");if(d.getChild(0).name!=
"FunctionExpr")throw new Exception("this.requestBlock needs a function");f=makeBlockByName("blockControlBlock");(c=d.getChild(0).getChild(2))&&f.appendToContainer(0,c.generate());break;case "onPlayerTravelled":case "onBlockPlaced":case "onBlockBroken":case "onMobKilled":case "onEntitySpawned":case "onItemAcquired":case "onItemDropped":e={onPlayerTravelled:"registerMCPEEventPlayer",onBlockPlaced:"registerMCPEEventBlockPlaced",onBlockBroken:"registerMCPEEventBlockBroken",onMobKilled:"registerMCPEEventMobKilled",
onEntitySpawned:"registerMCPEEventEntitySpawned",onItemAcquired:"registerMCPEEventItemAcquired",onItemDropped:"registerMCPEEventItemDropped"};if(d.children.length!=2)throw new Exception(f+" needs 2 parameters");if(d.getChild(0).name!="string"&&d.getChild(0).name!="number")throw new Exception(f+" needs a message");if(d.getChild(1).name!="FunctionExpr")throw new Exception(f+" needs a function");f=makeBlockByName(e[c]);f.label.setValue(0,d.getChild(0).generate({rvalue:true}));(c=d.getChild(1).getChild(2))&&
f.add(c.generate());break;case "onChat":case "onTell":case "onPlayerDied":case "onPlayerTeleported":case "onPlayerBounced":case "onAnyBlockPlaced":case "onAnyBlockBroken":case "onAnyMobKilled":case "onAnyEntitySpawned":case "onAnyItemAcquired":case "onAnyItemDropped":e={onChat:"registerMCPEEventChat",onTell:"registerMCPEEventTell",onPlayerDied:"registerMCPEEventDied",onPlayerTeleported:"registerMCPEEventTeleported",onPlayerBounced:"registerMCPEEventBounced",onAnyBlockPlaced:"registerMCPEEventBlockPlacedAny",
onAnyBlockBroken:"registerMCPEEventBlockBrokenAny",onAnyMobKilled:"registerMCPEEventMobKilledAny",onAnyEntitySpawned:"registerMCPEEventEntitySpawnedAny",onAnyItemAcquired:"registerMCPEEventItemAcquiredAny",onAnyItemDropped:"registerMCPEEventItemDroppedAny"};if(d.children.length!=1)throw new Exception(f+" needs 1 parameter");if(d.getChild(0).name!="FunctionExpr")throw new Exception(f+" needs a function");f=makeBlockByName(e[c]);(c=d.getChild(0).getChild(2))&&f.add(c.generate());break;default:f=e?e+
"."+c:"this."+c;if(g_fnMapping[f]){f=makeBlockByName(g_fnMapping[f]);if(f instanceof Label)for(e=0;e<d.children.length;e++)f.setValue(e,d.getChild(e).generate({rvalue:true}));else for(e=0;e<d.children.length;e++)f.label.setValue(e,d.getChild(e).generate({rvalue:true}))}else throw new Exception(f+" not found");}d=BlockGen.popFunction().locals;if(f&&d.length>0){c="script variables";for(e=0;e<d.length;e++)c=c+(" {scriptvar:"+d[e]+"}");d=new Block({cat:"localvar",label:c+"{varargs:valueScriptVar}",func:"blockControlScriptVar"});
d.next=f.next;f.next=d;d.parent=f;d.next.parent=d}}return f};
Node.prototype.generate_FunctionCall=function(b){var c=this.getChild(0),d=this.getChild(1),e,f,g;if(c.name=="Property")if(c.getChild(0).name=="Property")if(c.getChild(0).getChild(0).name=="this"&&c.getChild(0).getChild(1).name=="identifier"){g=c.getChild(0).getChild(1).getChild(0);e=c.getChild(1).getChild(0);f=this.generateLocalFunc(g,e,d)}else if(c.getChild(0).getChild(0).name=="identifier"&&c.getChild(0).getChild(0).getChild(0)=="mc"&&c.getChild(0).getChild(1).name=="identifier"){g=c.getChild(0).getChild(1).getChild(0);
e=c.getChild(1).getChild(0);f=this.generateLocalFunc(g,e,d,"mc")}else throw new Exception("must be this.namespace.function");else if(c.getChild(0).name=="this"&&c.getChild(1).name=="identifier"){e=c.getChild(1).getChild(0);f=this.generateLocalFunc(null,e,d)}else if(c.getChild(0).name=="identifier"&&c.getChild(0).getChild(0)=="mc"&&c.getChild(1).name=="identifier"){e=c.getChild(1).getChild(0);f=this.generateLocalFunc(null,e,d,"mc")}else if(c.getChild(0).name=="identifier"&&c.getChild(1).name=="identifier"){g=
c.getChild(0).getChild(0);e=c.getChild(1).getChild(0);if(e=="push"){f=makeBlockByName("blockListAdd");f.label.setValue(0,d.getChild(0).generate({rvalue:true}));c=1;for(b=d.getNumChildren();c<b;c++){f.label.addArg();f.label.setValue(c,d.getChild(c).generate({rvalue:true}))}f.label.setValue(d.getNumChildren(),g)}else if(e=="contains"){f=makeBlockByName("valueListContains");f.setValue(0,g);f.setValue(1,d.getChild(0).generate({rvalue:true}))}else if(e=="splice")if(d.getChild(1).getChild(0)=="0"){f=makeBlockByName("blockListInsert");
f.label.setValue(0,d.getChild(2).generate({rvalue:true}));b=d.getChild(0);if(b.name=="number")b=parseInt(b.getChild(0))+1;else if(b.name=="Subtract"&&(b.getChild(0).name=="number"&&b.getChild(0).getChild(0)=="1"||b.getChild(1).name=="number"&&b.getChild(1).getChild(0)=="1"))b=b.getChild(0).name=="number"?b.getChild(1).generate({rvalue:true}):b.getChild(0).generate({rvalue:true});else{c=makeBlockByName("valueOpBinary");c.setValue(0,b.generate({rvalue:true}));c.setValue(1,"+");c.setValue(2,1);b=c}f.label.setValue(1,
b);f.label.setValue(2,g)}else{if(d.getChild(1).getChild(0)=="1")if(d.getChild(2)==null){f=makeBlockByName("blockListDel");b=d.getChild(0);if(b.name=="number")b=parseInt(b.getChild(0))+1;else if(b.name=="Subtract"&&(b.getChild(0).name=="number"&&b.getChild(0).getChild(0)=="1"||b.getChild(1).name=="number"&&b.getChild(1).getChild(0)=="1"))b=b.getChild(0).name=="number"?b.getChild(1).generate({rvalue:true}):b.getChild(0).generate({rvalue:true});else{c=makeBlockByName("valueOpBinary");c.setValue(0,b.generate({rvalue:true}));
c.setValue(1,"+");c.setValue(2,1);b=c}f.label.setValue(0,b);f.label.setValue(1,g)}else{f=makeBlockByName("blockListReplace");b=d.getChild(0);if(b.name=="number")b=parseInt(b.getChild(0))+1;else if(b.name=="Subtract"&&(b.getChild(0).name=="number"&&b.getChild(0).getChild(0)=="1"||b.getChild(1).name=="number"&&b.getChild(1).getChild(0)=="1"))b=b.getChild(0).name=="number"?b.getChild(1).generate({rvalue:true}):b.getChild(0).generate({rvalue:true});else{c=makeBlockByName("valueOpBinary");c.setValue(0,
b.generate({rvalue:true}));c.setValue(1,"+");c.setValue(2,1);b=c}f.label.setValue(0,b);f.label.setValue(1,g);f.label.setValue(2,d.getChild(2).generate({rvalue:true}))}}else f=this.generateGlobalFunc(g,e,d,b)}else throw new Exception("must be namespace.function or this.namespace.function");else if(c.name=="identifier"){e=c.getChild(0);if(e=="parseInt"){f=makeBlockByName("valueOpMath");f.setValue(0,"int");f.setValue(1,d.getChild(0).generate({rvalue:true}))}else if(f=makeBlockByName(e)){g=f instanceof
Label?f:f.label;var h=d.children.length-g.getNumSockets();if(h>0)for(c=0;c<h;c++)g.addArg();for(c=0;c<d.children.length;c++)g.setValue(c,d.getChild(c).generate({rvalue:true}))}if(!f){g=e;for(c=0;c<d.children.length;c++)g=g+" {string}";if(b&&b.rvalue){f=new Label({cat:"functions",func:"valueControlCall",name:e,label:g});for(c=0;c<d.children.length;c++)f.setValue(c,d.getChild(c).generate({rvalue:true}))}else{f=new Block({cat:"functions",func:"blockControlCall",name:e,label:g});for(c=0;c<d.children.length;c++)f.label.setValue(c,
d.getChild(c).generate({rvalue:true}))}}}else throw new Exception("unknown function");return f};Node.prototype.setSpriteState=function(b){b=this.getPropertyValue(b);if(b.angle!==void 0)b.angle=(360-b.angle)%360;BlockGen.getSprite().state=b};
Node.prototype.getPropertyValue=function(b){if(b.name=="number")return parseFloat(b.getChild(0));if(b.name=="false")return false;if(b.name=="true")return true;if(b.name!="null"){if(b.name=="string"||b.name=="identifier")return b.getChild(0);if(b.name=="Json"){for(var c={},d=0;d<b.children.length;d++){var e=b.children[d];if(e.name=="JsonProperty"){var f=e.getChild(0),e=this.getPropertyValue(e.getChild(1));c[f]=e}}return c}if(b.name=="ArrayLiteral"){c=[];for(d=0;d<b.children.length;d++)c.push(this.getPropertyValue(b.children[d]));
return c}}return null};
Node.prototype.generate_PostIncrement=function(){var b,c=this.getChild(0);if(c.name=="identifier"){b=makeBlockByName("blockVarChangeBy");b.label.setValue(0,c.generate({lvalue:true}));b.label.setValue(1,1)}else if(c.name=="Property"&&c.getChild(0).name=="this"){b=makeBlockByName("blockVarChangeBy");b.label.setValue(0,c.getChild(1).generate({lvalue:true}));b.label.setValue(1,1)}else if(c.name=="ArrayProperty"){b=makeBlockByName("blockObjSet");b.label.setValue(0,c.getChild(0).generate({rvalue:true}));b.label.setValue(1,
c.getChild(1).generate({rvalue:true}));var d=makeBlockByName("valueOpBinary");d.setValue(0,c.generate({rvalue:true}));d.setValue(1,"+");d.setValue(2,1);b.label.setValue(setIdx,d)}return b};
Node.prototype.generate_PostDecrement=function(){var b,c=this.getChild(0);if(c.name=="identifier"){b=makeBlockByName("blockVarChangeBy");b.label.setValue(0,c.generate({lvalue:true}));b.label.setValue(1,-1)}else if(c.name=="Property"&&c.getChild(0).name=="this"){b=makeBlockByName("blockVarChangeBy");b.label.setValue(0,c.getChild(1).generate({lvalue:true}));b.label.setValue(1,-1)}else if(c.name=="ArrayProperty"){b=makeBlockByName("blockObjSet");b.label.setValue(0,c.getChild(0).generate({rvalue:true}));
b.label.setValue(1,c.getChild(1).generate({rvalue:true}));var d=makeBlockByName("valueOpBinary");d.setValue(0,c.generate({rvalue:true}));d.setValue(1,"-");d.setValue(2,1);b.label.setValue(setIdx,d)}return b};Node.prototype.generate_PreIncrement=function(){return this.generate_PostIncrement()};Node.prototype.generate_PreDecrement=function(){return this.generate_PostDecrement()};
Node.prototype.generate_Negative=function(){var b=makeBlockByName("valueOpMultiply");b.setValue(0,-1);b.setValue(1,this.getChild(0).generate({rvalue:true}));return b};Node.prototype.generate_BitwiseNot=function(){var b=makeBlockByName("valueOpBitNot");b.setValue(0,this.getChild(0).generate({rvalue:true}));return b};Node.prototype.generate_LogicalNot=function(){var b=makeBlockByName("valueOpNot");b.setValue(0,this.getChild(0).generate({rvalue:true}));return b};
Node.prototype.generate_Multiply=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"*");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};Node.prototype.generate_Divide=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"/");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};
Node.prototype.generate_Remainder=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"%");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};Node.prototype.generate_Add=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"+");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};
Node.prototype.generate_Subtract=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"-");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};Node.prototype.generate_ShiftLeft=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"<<");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};
Node.prototype.generate_ShiftRight=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,">>");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};Node.prototype.generate_UnsignedShiftRight=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,">>>");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};
Node.prototype.generate_LessThan=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"<");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};Node.prototype.generate_GreaterThan=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,">");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};
Node.prototype.generate_LessThanOrEqual=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"<=");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};Node.prototype.generate_GreaterThanOrEqual=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,">=");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};
Node.prototype.generate_Equal=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"=");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};Node.prototype.generate_NotEqual=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"!=");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};
Node.prototype.generate_StrictEqual=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"=");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};Node.prototype.generate_StrictNotEqual=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"!=");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};
Node.prototype.generate_BitwiseAnd=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"&");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};Node.prototype.generate_BitwiseXor=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"xor");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};
Node.prototype.generate_BitwiseOr=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"|");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};Node.prototype.generate_LogicalAnd=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"and");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};
Node.prototype.generate_LogicalOr=function(){var b=makeBlockByName("valueOpBinary");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,"or");b.setValue(2,this.getChild(1).generate({rvalue:true}));return b};Node.prototype.generate_Conditional=function(){var b=makeBlockByName("valueControlIfElse");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,this.getChild(1).generate({rvalue:true}));b.setValue(2,this.getChild(2).generate({rvalue:true}));return b};
Node.prototype.generate_Assignment=function(){var b,c,d=this.getChild(0),e=this.getChild(1);if(d.name=="identifier"){b=makeBlockByName("blockVarSet");b.label.setValue(0,d.generate({lvalue:true}));c=1;if(e=="+="){b=makeBlockByName("blockVarChangeBy");b.label.setValue(0,d.generate({lvalue:true}));c=this.getChild(2);c.name=="number"?b.label.setValue(1,c.getChild(0)):b.label.setValue(1,c.generate({rvalue:true}));return b}if(e=="-="){b=makeBlockByName("blockVarChangeBy");b.label.setValue(0,d.generate({lvalue:true}));
c=this.getChild(2);if(c.name=="number")b.label.setValue(1,-c.getChild(0));else{d=makeBlockByName("valueOpMultiply");d.setValue(0,-1);d.setValue(1,c.generate({rvalue:true}));b.label.setValue(1,d)}return b}}else if(d.name=="ArrayProperty"){b=makeBlockByName("blockObjSet");b.label.setValue(0,d.getChild(0).generate({rvalue:true}));b.label.setValue(1,d.getChild(1).generate({rvalue:true}));c=2}else if(d.name=="Property"){if(d.getChild(0).name=="identifier"&&d.getChild(1).name=="identifier"&&d.getChild(1).getChild(0)==
"length"&&this.getChild(2).getChild(0)=="0"){b=makeBlockByName("blockListDel");b.label.setValue(0,"all");b.label.setValue(1,d.getChild(0).getChild(0));return b}if(d.getChild(0).name=="this"){if(BlockGen.stackSize()==1&&e=="="){b=d.getChild(1).generate({lvalue:true});c=this.getPropertyValue(this.getChild(2));BlockGen.getSprite().variables[b]=c;return null}b=makeBlockByName("blockVarSet");b.label.setValue(0,d.getChild(1).generate({lvalue:true}));c=1}else{b=makeBlockByName("blockObjSet");b.label.setValue(0,
d.getChild(0).generate({rvalue:true}));b.label.setValue(1,d.getChild(1).generate({lvalue:true}));c=2}}else return null;switch(e){case "=":b.label.setValue(c,this.getChild(2).generate({rvalue:true}));break;case "+=":d=makeBlockByName("valueOpBinary");d.setValue(0,this.getChild(0).generate({rvalue:true}));d.setValue(1,"+");d.setValue(2,this.getChild(2).generate({rvalue:true}));b.label.setValue(c,d);break;case "-=":d=makeBlockByName("valueOpBinary");d.setValue(0,this.getChild(0).generate({rvalue:true}));
d.setValue(1,"-");d.setValue(2,this.getChild(2).generate({rvalue:true}));b.label.setValue(c,d);break;case "*=":d=makeBlockByName("valueOpBinary");d.setValue(0,this.getChild(0).generate({rvalue:true}));d.setValue(1,"*");d.setValue(2,this.getChild(2).generate({rvalue:true}));b.label.setValue(c,d);break;case "/=":d=makeBlockByName("valueOpBinary");d.setValue(0,this.getChild(0).generate({rvalue:true}));d.setValue(1,"/");d.setValue(2,this.getChild(2).generate({rvalue:true}));b.label.setValue(c,d);break;
case "<<=":d=makeBlockByName("valueOpBinary");d.setValue(0,this.getChild(0).generate({rvalue:true}));d.setValue(1,"<<");d.setValue(2,this.getChild(2).generate({rvalue:true}));b.label.setValue(c,d);break;case ">>=":d=makeBlockByName("valueOpBinary");d.setValue(0,this.getChild(0).generate({rvalue:true}));d.setValue(1,">>");d.setValue(2,this.getChild(2).generate({rvalue:true}));b.label.setValue(c,d);break;case ">>>=":d=makeBlockByName("valueOpBinary");d.setValue(0,this.getChild(0).generate({rvalue:true}));
d.setValue(1,">>>");d.setValue(2,this.getChild(2).generate({rvalue:true}));b.label.setValue(c,d);break;case "&=":d=makeBlockByName("valueOpBinary");d.setValue(0,this.getChild(0).generate({rvalue:true}));d.setValue(1,"&");d.setValue(2,this.getChild(2).generate({rvalue:true}));b.label.setValue(c,d);break;case "^=":d=makeBlockByName("valueOpBinary");d.setValue(0,this.getChild(0).generate({rvalue:true}));d.setValue(1,"xor");d.setValue(2,this.getChild(2).generate({rvalue:true}));b.label.setValue(c,d);
break;case "|=":d=makeBlockByName("valueOpBinary");d.setValue(0,this.getChild(0).generate({rvalue:true}));d.setValue(1,"|");d.setValue(2,this.getChild(2).generate({rvalue:true}));b.label.setValue(c,d);break;case "%=":d=makeBlockByName("valueOpBinary");d.setValue(0,this.getChild(0).generate({rvalue:true}));d.setValue(1,"%");d.setValue(2,this.getChild(2).generate({rvalue:true}));b.label.setValue(c,d)}return b};
Node.prototype.generate_Property=function(b){if(b&&b.lvalue)if(this.getChild(0).name=="this"){b=makeBlockByName("blockVarSet");b.label.setValue(0,this.getChild(1).generate());b.label.setValue(1,this.getChild(2).generate())}else{b=makeBlockByName("blockObjSet");b.label.setValue(0,this.getChild(0).generate());b.label.setValue(1,this.getChild(1).generate());b.label.setValue(2,this.getChild(2).generate())}else if(this.getChild(0).name=="identifier"&&this.getChild(1).name=="identifier"&&this.getChild(1).getChild(0)==
"length"){b=makeBlockByName("valueListLength");b.setValue(0,this.getChild(0).getChild(0))}else if(this.getChild(0).name=="identifier"&&this.getChild(0).getChild(0)=="Math"&&this.getChild(1).name=="identifier"){var b=makeBlockByName("valueOpConstants"),c="";switch(this.getChild(1).getChild(0)){case "PI":c="pi";break;case "E":c="e";break;case "LN2":c="ln2";break;case "LN10":c="ln10";break;case "LOG2E":c="log2e";break;case "LOG10E":c="log10e";break;case "SQRT1_2":c="sqrt1/2";break;case "SQRT2":c="sqrt2"}b.setValue(0,
c)}else if(this.getChild(0).name=="this")b=this.getChild(1).generate({rvalue:true});else{b=makeBlockByName("valueObjGet");b.setValue(0,this.getChild(0).generate({rvalue:true}));b.setValue(1,this.getChild(1).generate({lvalue:true}))}return b};
Node.prototype.generate_ArrayProperty=function(b){if(b&&b.lvalue){b=makeBlockByName("blockObjSet");b.label.setValue(0,this.getChild(0).generate());b.label.setValue(1,this.getChild(1).generate())}else{b=makeBlockByName("valueObjGet");b.setValue(0,this.getChild(0).generate());b.setValue(1,this.getChild(1).generate())}return b};Node.prototype.generate_InstanceOf=function(){console.log('"instanceof" not implemented')};Node.prototype.generate_In=function(){console.log('"in" not implemented')};
Node.prototype.generate_Delete=function(){console.log('"delete" not implemented')};Node.prototype.generate_Void=function(){console.log('"void" not implemented')};Node.prototype.generate_TypeOf=function(){console.log('"typeof" not implemented')};Node.prototype.generate_Switch=function(){console.log('"switch" not implemented')};Node.prototype.generate_Case=function(){console.log('"case" not implemented')};Node.prototype.generate_Default=function(){console.log('"default" not implemented')};
Node.prototype.generate_TryCatch=function(){console.log('"trycatch" not implemented')};Node.prototype.generate_Throw=function(){console.log('"throw" not implemented')};Node.prototype.generate_Label=function(){console.log('"label" not implemented')};Node.prototype.generate_With=function(){console.log('"with" not implemented')};function CodeGen(){this._loopLevel=this.indentLevel=0}CodeGen.prototype.reset=function(){this._loopLevel=0};CodeGen.prototype.isIdentifier=function(b){return/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(b)};
CodeGen.prototype.reset=function(){this._loopLevel=0};CodeGen.prototype.pushLoop=function(){this._loopLevel++};CodeGen.prototype.peekLoop=function(){return this._loopLevel};CodeGen.prototype.popLoop=function(){this._loopLevel--};CodeGen.prototype.emit=function(b){for(var c="",d=0;d<this.indentLevel;d++)c=c+"    ";return c+b+"\n"};CodeGen.prototype.emitPartial=function(b){for(var c="",d=0;d<this.indentLevel;d++)c=c+"    ";return c+b};CodeGen.prototype.emitInline=function(b){return b};
CodeGen.prototype.emitNumber=function(b){return b};CodeGen.prototype.emitString=function(b){return'"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'};CodeGen.prototype.pushLevel=function(){this.indentLevel++};CodeGen.prototype.popLevel=function(){if(--this.indentLevel<0)this.indentLevel=0};
CodeGen.prototype.generateScene=function(b){var c="";if(!b){c=this.emit("// Define scene");c=c+this.emit("Runtime.defineScene({");this.pushLevel();c=c+this.generateState(Runtime.background);this.popLevel();c=c+this.emit("}, function() {");this.pushLevel();c=c+this.generateJsVars(Runtime.background)}for(var d=[],e=0;e<Runtime.background.scripts.length;e++)d.push({block:Runtime.background.scripts[e],bounds:WinCode._findExtremes(true,true,Runtime.background.scripts[e])});d.sort(function(b,c){return(b.block.hidden||
b.block.hiddenInSandbox)&&(!c.block.hidden||!c.block.hiddenInSandbox)?1:(!b.block.hidden||!b.block.hiddenInSandbox)&&(c.block.hidden||c.block.hiddenInSandbox)?-1:b.block.value&&!c.block.value?1:!b.block.value&&c.block.value?-1:b.block.hasFlap&&!c.block.hasFlap?1:!b.block.hasFlap&&c.block.hasFlap||b.block.y<c.block.y?-1:b.block.y>c.block.y?1:b.block.x<c.block.x?-1:b.block.y>c.block.y?1:0});for(e=0;e<d.length;e++){var f=d[e].block;if(f instanceof Block&&!f.hidden&&!f.hasFlap)try{this.reset();c=c+this.generate(f)}catch(g){console.log("generator error");
console.log(g.stack)}}if(!b){this.popLevel();c=c+this.emit("});\n")}return c};
CodeGen.prototype.generateActor=function(b,c){var d="";if(!c){d=this.emit('// Define "'+b.label+'"');d=d+this.emit("Runtime.defineActor({");this.pushLevel();d=d+this.generateState(b);this.popLevel();d=d+this.emit("}, function() {");this.pushLevel();d=d+this.generateJsVars(b)}for(var e=[],f=0;f<b.scripts.length;f++)e.push({block:b.scripts[f],bounds:WinCode._findExtremes(true,true,b.scripts[f])});e.sort(function(b,c){return(b.block.hidden||b.block.hiddenInSandbox)&&(!c.block.hidden||!c.block.hiddenInSandbox)?
1:(!b.block.hidden||!b.block.hiddenInSandbox)&&(c.block.hidden||c.block.hiddenInSandbox)?-1:b.block.value&&!c.block.value?1:!b.block.value&&c.block.value?-1:b.block.hasFlap&&!c.block.hasFlap?1:!b.block.hasFlap&&c.block.hasFlap||b.block.y<c.block.y?-1:b.block.y>c.block.y?1:b.block.x<c.block.x?-1:b.block.y>c.block.y?1:0});for(f=0;f<e.length;f++){var g=e[f].block;if(g instanceof Block&&!g.hasFlap)try{this.reset();d=d+this.generate(g)}catch(h){console.log("generator error");console.log(h.stack)}}if(!c){this.popLevel();
d=d+this.emit("});\n")}return d};
CodeGen.prototype.generateState=function(b){var c="";if(!b||b==Runtime.background){b=Runtime.background;c=c+this.emit('"name" : '+this.emitString(b.label)+",");c=c+this.emitPartial('"expand" : '+(Runtime.stage.expand?true:false)+", ");c=c+this.emitPartial('"width" : '+Runtime.stage.width+", ");c=c+this.emitInline('"height" : '+Runtime.stage.height+",\n");c=c+this.emitPartial('"penWidth" : '+b.penWidth+",");c=c+this.emitInline('"penColor" : '+this.emitString(b.penColor)+", ");c=c+this.emitInline('"fillColor" : '+
this.emitString(b.fillColor)+", ");c=c+this.emitInline('"font" : '+this.emitString(b.font)+", ");c=c+this.emitInline('"fontColor" : '+this.emitString(b.fontColor)+",\n");c=c+this.emit('"physics" : '+JSON.stringify({enabled:Physics.isSimulationRunning(),gravityx:Physics.getWorld().GetGravity().x,gravityy:Physics.getWorld().GetGravity().y})+",")}else{c=c+this.emitPartial('"class" : '+this.emitString(b.classname)+", ");c=c+this.emitInline('"name" : '+this.emitString(b.label)+",\n");c=c+this.emitPartial('"x" : '+
(b.spriteObj.x-Runtime.stage.width/2)+", ");c=c+this.emitInline('"y" : '+-(b.spriteObj.y-Runtime.stage.height/2)+", ");c=c+this.emitInline('"scale" : '+b.spriteObj.scale.x+", ");c=c+this.emitInline('"angle" : '+(360-b.spriteObj.rotation)%360+", ");c=c+this.emitInline('"layer" : '+b.spriteObj.zIndex+", ");c=c+this.emitInline('"rotateLock" : '+b.spriteObj.rotateLock+",\n");c=c+this.emitPartial('"hidden" : '+(!b.spriteObj.visible?true:false)+", ");c=c+this.emitInline('"draggable" : '+(b.spriteObj.draggable?
true:false)+",\n");c=c+this.emitPartial('"penWidth" : '+b.penWidth+", ");c=c+this.emitInline('"penColor" : '+this.emitString(b.penColor)+", ");c=c+this.emitInline('"fillColor" : '+this.emitString(b.fillColor)+", ");c=c+this.emitInline('"font" : '+this.emitString(b.font)+", ");c=c+this.emitInline('"fontColor" : '+this.emitString(b.fontColor)+",\n");if(b.skeleton.type&&b.skeleton.parts){c=c+this.emitInline('"skelType" : '+this.emitString(b.skeleton.type)+",\n");c=c+this.emitInline('"skelParts" : '+
JSON.stringify(b.skeleton.parts)+",\n")}b.spriteObj.bubble&&(c=c+this.emit('"bubble" : '+JSON.stringify(b.spriteObj.bubble)+","));var d=Physics.getSpriteProperties(b.spriteObj),c=c+this.emit('"physics" : '+JSON.stringify({isStatic:d.isStatic?true:false,isActive:d.isActive?true:false,geometry:d.geometry,density:d.density,friction:d.friction,restitution:d.restitution})+",")}c=c+this.emit('"currentCostume" : '+b.currentCostume+",");if(b.costumes.length>0){c=c+this.emit('"costumes" : [');this.pushLevel();
c=c+this.generateCostumes(b);this.popLevel();c=c+this.emit("],")}else c=c+this.emit('"costumes" : [ ],');c=c+this.emit('"volume" : '+b.volume+",");if(b.sounds.length>0){c=c+this.emit('"sounds" : [');this.pushLevel();c=c+this.generateSounds(b);this.popLevel();c=c+this.emit("],")}else c=c+this.emit('"sounds" : [ ],');return c};
CodeGen.prototype.generateCostumes=function(b){for(var c="",d=0;d<b.costumes.length;d++){var e=b.costumes[d],e='{"name":"'+e.name+'", "img":"'+e.img.replace(/"/g,'\\"')+'", "cx":'+e.cx+', "cy":'+e.cy+"}";d<b.costumes.length-1&&(e=e+",");c=c+this.emit(e)}return c};CodeGen.prototype.generateSounds=function(b){for(var c="",d=0;d<b.sounds.length;d++){var e=b.sounds[d],e='{"name":"'+e.name+'", "sound":"'+e.sound+'"}';d<b.sounds.length-1&&(e=e+",");c=c+this.emit(e)}return c};
CodeGen.prototype.generateJsVars=function(b){var c="",d;for(d in b.lists)c=c+this.emit("this."+this.generateIdentifier(d)+" = "+JSON.stringify(b.lists[d])+";");for(d in b.variables)b.lists[d]===void 0&&(c=c+this.emit("this."+this.generateIdentifier(d)+" = "+JSON.stringify(b.variables[d])+";"));c&&(c=c+this.emit(""));return c};CodeGen.prototype.generateCode=function(b){for(var c="",d=0;d<b.length;d++)c=c+this.generate(b[d]);return c};
CodeGen.prototype.generate=function(b){if(b){if(b instanceof LabelInput){if(b._child)return this.generate(b._child);b=valueToNative(b.label);return typeof b=="number"?this.emitNumber(b):typeof b=="string"?b=="true"?true:b=="false"?false:this.emitString(b):typeof b=="boolean"?b:this.emitString(""+b)}var c=this["generate_"+b.func];if(c)return c.apply(this,[b]);c=g_revFnMapping[b.func]?g_revFnMapping[b.func]+"(":b.func+"(";if(b instanceof Label){for(var d=0,e=b.getNumSockets();d<e;d++){d>0&&(c=c+", ");
c=c+this.generate(b.getSocketAtChild(d))}c=this.emitInline(c+")")}else{d=0;for(e=b.label.getNumSockets();d<e;d++){d>0&&(c=c+", ");c=c+this.generate(b.label.getSocketAtChild(d))}c=this.emit(c+");");c=c+this.generate(b.next)}return c}return""};
CodeGen.prototype.generateIdentifier=function(b){var c=""+b;if(b&&b instanceof LabelInput){b=valueToNative(b.label);typeof b=="number"?c="_"+this.emitNumber(b):typeof b=="string"&&(c=b)}c=c.replace(/[^a-zA-Z0-9_]/g,"_");if(!c||c[0]>="0"&&c[0]<="9")c="_"+c;g_keywords.indexOf(c)>=0&&(c="_"+c);return c};CodeGen.prototype.generate_registerFlagTrigger=function(b){var c=this.emit("this.onStart(function() {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerKeyTrigger=function(b){var c=this.emit("this.onKeyPress("+this.generate(b.label.getSocketAtChild(0))+", function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_registerTrigger=function(b){var c=this.emit("this.onCondition(function() {"),c=c+this.emit("}, function() {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerSpriteTrigger=function(b){var c=this.emit("this.onActorClick(function() {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_registerBackgroundChange=function(b){var c=this.emit("this.onSceneChange("+this.generate(b.label.getSocketAtChild(0))+", function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerBroadcastTrigger=function(b){var c=this.emit("this.onMessageReceived("+this.generate(b.label.getSocketAtChild(0))+", function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_registerCloned=function(b){var c=this.emit("this.onClone(function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerDraw=function(b){var c=this.emit("this.onDraw(function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});")};CodeGen.prototype.generate_registerSpriteCollision=function(b){var c=this.emit("this.onCollision(function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});")};
CodeGen.prototype.generate_registerAnimationDone=function(b){var c=this.emit("this.onAnimationDone("+this.generate(b.label.getSocketAtChild(0))+", function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});")};CodeGen.prototype.generate_blockControlBlock=function(b){var c=this.emit("this.requestBlock(function () {");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("});");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_registerFunction=function(b){for(var c="function "+this.generateIdentifier(b.name)+"(",d=0,e=b.label.getNumSockets();d<e;d++){d>0&&(c=c+", ");c=c+this.generate(b.label.getSocketAtChild(d))}c=this.emit(c+") {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("}\n")};
CodeGen.prototype.generate_blockControlCall=function(b){for(var c=this.generateIdentifier(b.name)+"(",d=0,e=b.label.getNumSockets();d<e;d++){d>0&&(c=c+", ");c=c+this.generate(b.label.getSocketAtChild(d))}c=this.emit(c+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_valueControlCall=function(b){for(var c=this.generateIdentifier(b.name)+"(",d=0,e=b.getNumSockets();d<e;d++){d>0&&(c=c+", ");c=c+this.generate(b.getSocketAtChild(d))}return c=this.emitInline(c+")")};
CodeGen.prototype.generate_blockControlCallMember=function(b){for(var c=this.generateIdentifier(b.label.getSocketAtChild(0)),d=this.generateIdentifier(b.label.getSocketAtChild(1)),c=c+"."+d+"(",d=2,e=b.label.getNumSockets();d<e;d++){d>2&&(c=c+", ");c=c+this.generate(b.label.getSocketAtChild(d))}c=this.emit(c+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_valueControlCallMember=function(b){for(var c=this.generateIdentifier(b.getSocketAtChild(0)),d=this.generateIdentifier(b.getSocketAtChild(1)),c=c+"."+d+"(",d=b.getNumSockets(),e=2;e<d;e++){e>2&&(c=c+", ");c=c+this.generate(b.getSocketAtChild(e))}return c+")"};
CodeGen.prototype.generate_blockControlCallLibrary=function(b){for(var c=b.name.split("::"),d=this.generateIdentifier(c[1]),c=c[0],c="lib."+c+"."+d+"(",d=0,e=b.label.getNumSockets();d<e;d++){d>0&&(c=c+", ");c=c+this.generate(b.label.getSocketAtChild(d))}c=this.emit(c+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_valueControlCallLibrary=function(b){for(var c=b.name.split("::"),d=this.generateIdentifier(c[1]),c=c[0],c="lib."+c+"."+d+"(",d=0,e=b.getNumSockets();d<e;d++){d>0&&(c=c+", ");c=c+this.generate(b.getSocketAtChild(d))}return c=this.emitInline(c+")")};CodeGen.prototype.generate_blockControlForever=function(b){var c=this.emit("while (true) {");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockControlRepeat=function(b){this.pushLoop();var c="_repeatIdx"+this.peekLoop(),c=this.emit("for (var "+c+"=0; "+c+"<"+this.generate(b.label.getSocketAtChild(0))+"; "+c+"++) {");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockControlForeverIf=function(b){var c;c=b.label.getSocketAtChild(0);c=c._child&&c._child.func=="valueOpNot"?this.emit("while ("+this.generate(c._child.getSocketAtChild(0))+") { "):this.emit("while (!"+this.generate(c)+") { ");this.pushLevel();c=c+this.emit("while (true) { ");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockControlIf=function(b,c){var d;d=c?this.emitInline("if ("+this.generate(b.label.getSocketAtChild(0))+") {\n"):this.emit("if ("+this.generate(b.label.getSocketAtChild(0))+") {");this.pushLevel();d=d+this.generate(b.getBlockAtContainer(0));this.popLevel();d=d+this.emit("}");return d=d+this.generate(b.next)};
CodeGen.prototype.generate_blockControlIfElse=function(b,c){var d;d=c?this.emitInline("if ("+this.generate(b.label.getSocketAtChild(0))+") {\n"):this.emit("if ("+this.generate(b.label.getSocketAtChild(0))+") {");this.pushLevel();d=d+this.generate(b.getBlockAtContainer(0));this.popLevel();for(var e=1;e<b.getNumContainers()-1;e++){var f=b.getLabelAtContainer(e);d=d+this.emit("} else if ("+this.generate(f.getSocketAtChild(0))+") {");this.pushLevel();d=d+this.generate(b.getBlockAtContainer(e));this.popLevel()}if((e=
b.getBlockAtContainer(b.getNumContainers()-1))&&e.func=="blockControlIf"&&!e.next){d=d+this.emitPartial("} else ");d=d+this.generate_blockControlIf(e,true)}else if(e&&e.func=="blockControlIfElse"&&!e.next){d=d+this.emitPartial("} else ");d=d+this.generate_blockControlIfElse(e,true)}else{d=d+this.emit("} else {");this.pushLevel();d=d+this.generate(e);this.popLevel();d=d+this.emit("}")}return d=d+this.generate(b.next)};
CodeGen.prototype.generate_valueControlIfElse=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+" ? "+this.generate(b.getSocketAtChild(1))+" : "+this.generate(b.getSocketAtChild(2)))};CodeGen.prototype.generate_blockControlWhile=function(b){var c=this.emit("while ("+this.generate(b.label.getSocketAtChild(0))+") { ");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockControlRepeatUntil=function(b){var c;c=b.label.getSocketAtChild(0);c=c._child&&c._child.func=="valueOpNot"?this.emit("while ("+this.generate(c._child.getSocketAtChild(0))+") { "):this.emit("while (!"+this.generate(c)+") { ");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockControlReturn=function(b){var c;c=(c=b.label.getSocketAtChild(0))&&(c._child||c.label)?this.emit("return "+this.generate(c)+";"):this.emit("return;");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockControlStop=function(b){return this.emit("this.terminate("+this.generate(b.label.getSocketAtChild(0))+");")};CodeGen.prototype.generate_blockControlStopScript=function(){return this.emit("blockControlStopScript();")};
CodeGen.prototype.generate_blockControlStopAll=function(){return this.emit("blockControlStopAll();")};CodeGen.prototype.generate_blockControlScriptVar=function(b){for(var c="var ",d=0;d<b.label.getNumSockets();d++){d>0&&(c=c+", ");c=c+this.generate(b.label.getSocketAtChild(d))}c=this.emit(c+";");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockControlFor=function(b){var c=this.generateIdentifier(b.label.getSocketAtChild(0)),c=this.emit("for (var "+c+"="+this.generate(b.label.getSocketAtChild(1))+"; "+c+"<="+this.generate(b.label.getSocketAtChild(2))+"; "+c+"+="+this.generate(b.label.getSocketAtChild(3))+") {");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockControlForEach=function(b){var c=this.emit(this.generate(b.label.getSocketAtChild(0))+".forEach(function("+this.generateIdentifier(b.label.getSocketAtChild(1))+") {");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockControlBreak=function(b){var c=this.emit("break;");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockControlContinue=function(b){var c=this.emit("continue;");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockComment=function(b){var c=this.emit("/*"),c=c+this.emit(b.label.getSocketAtChild(0).label);return c=c+this.emit("*/")};CodeGen.prototype.generate_blockInlineComment=function(b){var c=this.emit("//"+b.label.getSocketAtChild(0).label);return c=c+this.generate(b.next)};
CodeGen.prototype.generate_valueOpAdd=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" + "+this.generate(b.getSocketAtChild(1))+")")};CodeGen.prototype.generate_valueOpSubtract=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" - "+this.generate(b.getSocketAtChild(1))+")")};CodeGen.prototype.generate_valueOpMultiply=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" * "+this.generate(b.getSocketAtChild(1))+")")};
CodeGen.prototype.generate_valueOpDivide=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" / "+this.generate(b.getSocketAtChild(1))+")")};CodeGen.prototype.generate_valueOpRandom=function(b){return this.emitInline("Math.randomRange("+this.generate(b.getSocketAtChild(0))+", "+this.generate(b.getSocketAtChild(1))+")")};
CodeGen.prototype.generate_valueOpLess=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" < "+this.generate(b.getSocketAtChild(1))+")")};CodeGen.prototype.generate_valueOpEqual=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" == "+this.generate(b.getSocketAtChild(1))+")")};CodeGen.prototype.generate_valueOpGreater=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" > "+this.generate(b.getSocketAtChild(1))+")")};
CodeGen.prototype.generate_valueOpAnd=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" && "+this.generate(b.getSocketAtChild(1))+")")};CodeGen.prototype.generate_valueOpOr=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" || "+this.generate(b.getSocketAtChild(1))+")")};
CodeGen.prototype.generate_valueOpNot=function(b){b=b.getSocketAtChild(0);return b._child&&b._child.func=="valueOpNot"?this.generate(b._child.getSocketAtChild(0)):this.emitInline("!"+this.generate(b))};CodeGen.prototype.generate_valueOpJoin=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" + "+this.generate(b.getSocketAtChild(1))+")")};
CodeGen.prototype.generate_valueOpLetter=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".charAt("+this.generate(b.getSocketAtChild(1))+")")};CodeGen.prototype.generate_valueOpLength=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".length")};CodeGen.prototype.generate_valueOpMod=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" % "+this.generate(b.getSocketAtChild(1))+")")};
CodeGen.prototype.generate_valueOpRound=function(b){return this.emitInline("Math.round("+this.generate(b.getSocketAtChild(0))+")")};
CodeGen.prototype.generate_valueOpMath=function(b){switch(b.getSocketAtChild(0).label){case "abs":return this.emitInline("Math.abs("+this.generate(b.getSocketAtChild(1))+")");case "floor":return this.emitInline("Math.floor("+this.generate(b.getSocketAtChild(1))+")");case "ceiling":return this.emitInline("Math.ceil("+this.generate(b.getSocketAtChild(1))+")");case "int":return this.emitInline("parseInt("+this.generate(b.getSocketAtChild(1))+")");case "sqrt":return this.emitInline("Math.sqrt("+this.generate(b.getSocketAtChild(1))+
")");case "sin":return this.emitInline("Math.sin("+this.generate(b.getSocketAtChild(1))+" * Math.PI / 180)");case "sinrad":return this.emitInline("Math.sin("+this.generate(b.getSocketAtChild(1))+")");case "cos":return this.emitInline("Math.cos("+this.generate(b.getSocketAtChild(1))+" * Math.PI / 180)");case "cosrad":return this.emitInline("Math.cos("+this.generate(b.getSocketAtChild(1))+")");case "tan":return this.emitInline("Math.tan("+this.generate(b.getSocketAtChild(1))+" * Math.PI / 180)");case "tanrad":return this.emitInline("Math.tan("+
this.generate(b.getSocketAtChild(1))+")");case "asin":return this.emitInline("Math.asin("+this.generate(b.getSocketAtChild(1))+" * 180 / Math.PI)");case "asinrad":return this.emitInline("Math.asin("+this.generate(b.getSocketAtChild(1))+")");case "acos":return this.emitInline("Math.acos("+this.generate(b.getSocketAtChild(1))+" * 180 / Math.PI)");case "acosrad":return this.emitInline("Math.acos("+this.generate(b.getSocketAtChild(1))+")");case "atan":return this.emitInline("Math.atan("+this.generate(b.getSocketAtChild(1))+
" * 180 / Math.PI)");case "atanrad":return this.emitInline("Math.atan("+this.generate(b.getSocketAtChild(1))+")");case "ln":return this.emitInline("Math.log("+this.generate(b.getSocketAtChild(1))+")");case "log":return this.emitInline("Math.log("+this.generate(b.getSocketAtChild(1))+") / Math.LN10");case "e^":return this.emitInline("Math.exp("+this.generate(b.getSocketAtChild(1))+")");case "10^":return this.emitInline("Math.pow(10, "+this.generate(b.getSocketAtChild(1))+")");case "sign":return this.emitInline("Math.sign("+
this.generate(b.getSocketAtChild(1))+")")}return""};
CodeGen.prototype.generate_valueOpMath2=function(b){switch(b.getSocketAtChild(0).label){case "atan2":return this.emitInline("Math.atan2("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+") * 180 / Math.PI");case "atan2rad":return this.emitInline("Math.atan2("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+")");case "max":return this.emitInline("Math.max("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+")");
case "min":return this.emitInline("Math.min("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+")");case "pow":return this.emitInline("Math.pow("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+")")}return""};
CodeGen.prototype.generate_valueOpConstants=function(b){switch(b.getSocketAtChild(0).label){case "pi":return this.emitInline("Math.PI");case "e":return this.emitInline("Math.E");case "ln2":return this.emitInline("Math.LN2");case "ln10":return this.emitInline("Math.LN10");case "log2e":return this.emitInline("Math.LOG2E");case "log10e":return this.emitInline("Math.LOG10E");case "sqrt1/2":return this.emitInline("Math.SQRT1_2");case "sqrt2":return this.emitInline("Math.SQRT2")}return""};
CodeGen.prototype.generate_valueOpBinary=function(b){switch(b.getSocketAtChild(1).label){case "+":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" + "+this.generate(b.getSocketAtChild(2))+")");case "-":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" - "+this.generate(b.getSocketAtChild(2))+")");case "*":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" * "+this.generate(b.getSocketAtChild(2))+")");case "/":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+
" / "+this.generate(b.getSocketAtChild(2))+")");case "%":case "mod":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" % "+this.generate(b.getSocketAtChild(2))+")");case "=":case "==":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" == "+this.generate(b.getSocketAtChild(2))+")");case "<":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" < "+this.generate(b.getSocketAtChild(2))+")");case "<=":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+
" <= "+this.generate(b.getSocketAtChild(2))+")");case ">":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" > "+this.generate(b.getSocketAtChild(2))+")");case ">=":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" >= "+this.generate(b.getSocketAtChild(2))+")");case "!=":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" != "+this.generate(b.getSocketAtChild(2))+")");case "&":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" & "+this.generate(b.getSocketAtChild(2))+
")");case "and":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" && "+this.generate(b.getSocketAtChild(2))+")");case "|":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" | "+this.generate(b.getSocketAtChild(2))+")");case "or":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" || "+this.generate(b.getSocketAtChild(2))+")");case "^":case "xor":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" ^ "+this.generate(b.getSocketAtChild(2))+")");
case "<<":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" << "+this.generate(b.getSocketAtChild(2))+")");case ">>":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" >> "+this.generate(b.getSocketAtChild(2))+")");case ">>>":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" >>> "+this.generate(b.getSocketAtChild(2))+")")}return""};CodeGen.prototype.generate_valueOpBitNot=function(b){return this.emitInline("~"+this.generate(b.getSocketAtChild(0)))};
CodeGen.prototype.generate_valueOpExpression=function(b){return this.generate(b.getSocketAtChild(0))};CodeGen.prototype.generate_valueOpTextSplit=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".split("+this.generate(b.getSocketAtChild(1))+")")};CodeGen.prototype.generate_valueOpTextReplace=function(b){return this.emitInline(this.generate(b.getSocketAtChild(1))+".replace("+this.generate(b.getSocketAtChild(0))+", "+this.generate(b.getSocketAtChild(2))+")")};
CodeGen.prototype.generate_valueOpTextIndex=function(b){return this.emitInline(this.generate(b.getSocketAtChild(1))+".indexOf("+this.generate(b.getSocketAtChild(0))+")")};CodeGen.prototype.generate_valueOpTextLastIndex=function(b){return this.emitInline(this.generate(b.getSocketAtChild(1))+".lastIndexOf("+this.generate(b.getSocketAtChild(0))+")")};
CodeGen.prototype.generate_valueOpTextSubstring=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".substring("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+")")};
CodeGen.prototype.generate_valueOpTextTransform=function(b){var c=b.getSocketAtChild(1);switch(b.getSocketAtChild(0).label){case "uppercase":return this.emitInline(this.generate(c)+".toUpperCase()");case "lowercase":return this.emitInline(this.generate(c)+".toLowerCase()");case "trim":return this.emitInline(this.generate(c)+".trim()");default:return this.generate(c)}};
CodeGen.prototype.generate_blockVarPropSet=function(b){var c;c=false;var d=b.label.getSocketAtChild(1);d._child?c=true:d.label!="self"&&(c=true);var e=b.label.getSocketAtChild(0);e._child?c=true:g_properties.indexOf(e.label)>=0&&(c=true);c=c?this.emit("this.sensing.setSpriteProperty("+this.generate(e)+", "+this.generate(d)+", "+this.generate(b.label.getSocketAtChild(2))+");"):this.emit(this.generateIdentifier(e)+" = "+this.generate(b.label.getSocketAtChild(2))+";");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_valueSensingSpriteProperty=function(b){return this.generate_valueVarPropGet(b)};CodeGen.prototype.generate_valueVarPropGet=function(b){var c=false,d=b.getSocketAtChild(1);d._child?c=true:d.label!="self"&&(c=true);b=b.getSocketAtChild(0);b._child?c=true:g_properties.indexOf(b.label)>=0&&(c=true);return c?this.emitInline("this.sensing.getSpriteProperty("+this.generate(b)+", "+this.generate(d)+")"):this.generateIdentifier(b)};
CodeGen.prototype.generate_blockVarSet=function(b){var c=this.emit(this.generateIdentifier(b.label.getSocketAtChild(0))+" = "+this.generate(b.label.getSocketAtChild(1))+";");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockVarChangeBy=function(b){var c,d=b.label.getSocketAtChild(1);if(!d._child)if(d.label=="1"||d.label==1)c=this.emit(this.generateIdentifier(b.label.getSocketAtChild(0))+"++;");else if(d.label=="-1"||d.label==-1)c=this.emit(this.generateIdentifier(b.label.getSocketAtChild(0))+"--;");c||(c=this.emit(this.generateIdentifier(b.label.getSocketAtChild(0))+" += "+this.generate(b.label.getSocketAtChild(1))+";"));return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockVarShow=function(b){return this.generate(b.next)};CodeGen.prototype.generate_blockVarHide=function(b){return this.generate(b.next)};CodeGen.prototype.generate_valueListNew=function(){return this.emitInline("[]")};
CodeGen.prototype.generate_blockListAdd=function(b){for(var c=b.label.getNumSockets(),d=this.generateIdentifier(b.label.getSocketAtChild(c-1)),d=d+".push(",e=0;e<c-1;e++){e>0&&(d=d+", ");d=d+this.generate(b.label.getSocketAtChild(e))}d=this.emit(d+");");return d=d+this.generate(b.next)};
CodeGen.prototype.generate_blockListDel=function(b){var c=this.generateIdentifier(b.label.getSocketAtChild(1)),d=b.label.getSocketAtChild(0);if(d.label=="all")c=c+".length = 0;";else{d=b.label.getSocketAtChild(0);if(d._child){d=d._child;d=d.func=="valueOpBinary"?d.getSocketAtChild(1).label=="+"&&(!d.getSocketAtChild(0)._child&&""+d.getSocketAtChild(0).label=="1"||!d.getSocketAtChild(2)._child&&""+d.getSocketAtChild(2).label=="1")?d.getSocketAtChild(0)._child?this.generate(d.getSocketAtChild(0)):this.generate(d.getSocketAtChild(2)):
this.generate(d)+" - 1":d.func=="valueOpAdd"?!d.getSocketAtChild(0)._child&&""+d.getSocketAtChild(0).label=="1"||!d.getSocketAtChild(1)._child&&""+d.getSocketAtChild(1).label=="1"?d.getSocketAtChild(0)._child?this.generate(d.getSocketAtChild(0)):this.generate(d.getSocketAtChild(1)):this.generate(d)+" - 1":this.generate(d)+" - 1"}else d=valueToNative(d.label)-1;c=c+(".splice("+d+", 1);")}c=this.emit(c);return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockListInsert=function(b){var c=b.label.getNumSockets(),d=this.generateIdentifier(b.label.getSocketAtChild(c-1)),e=b.label.getSocketAtChild(c-2);if(e._child){e=e._child;e=e.func=="valueOpBinary"?e.getSocketAtChild(1).label=="+"&&(!e.getSocketAtChild(0)._child&&""+e.getSocketAtChild(0).label=="1"||!e.getSocketAtChild(2)._child&&""+e.getSocketAtChild(2).label=="1")?e.getSocketAtChild(0)._child?this.generate(e.getSocketAtChild(0)):this.generate(e.getSocketAtChild(2)):this.generate(e)+
" - 1":e.func=="valueOpAdd"?!e.getSocketAtChild(0)._child&&""+e.getSocketAtChild(0).label=="1"||!e.getSocketAtChild(1)._child&&""+e.getSocketAtChild(1).label=="1"?e.getSocketAtChild(0)._child?this.generate(e.getSocketAtChild(0)):this.generate(e.getSocketAtChild(1)):this.generate(e)+" - 1":this.generate(e)+" - 1"}else e=valueToNative(e.label)-1;d=d+(".splice("+e+", 0, ");for(e=0;e<c-2;e++){e>0&&(d=d+", ");d=d+this.generate(b.label.getSocketAtChild(e))}d=this.emit(d+");");return d=d+this.generate(b.next)};
CodeGen.prototype.generate_blockListReplace=function(b){b.label.getNumSockets();var c=this.generateIdentifier(b.label.getSocketAtChild(1)),d=b.label.getSocketAtChild(0);if(d._child){d=d._child;d=d.func=="valueOpBinary"?d.getSocketAtChild(1).label=="+"&&(!d.getSocketAtChild(0)._child&&""+d.getSocketAtChild(0).label=="1"||!d.getSocketAtChild(2)._child&&""+d.getSocketAtChild(2).label=="1")?d.getSocketAtChild(0)._child?this.generate(d.getSocketAtChild(0)):this.generate(d.getSocketAtChild(2)):this.generate(d)+
" - 1":d.func=="valueOpAdd"?!d.getSocketAtChild(0)._child&&""+d.getSocketAtChild(0).label=="1"||!d.getSocketAtChild(1)._child&&""+d.getSocketAtChild(1).label=="1"?d.getSocketAtChild(0)._child?this.generate(d.getSocketAtChild(0)):this.generate(d.getSocketAtChild(1)):this.generate(d)+" - 1":this.generate(d)+" - 1"}else d=valueToNative(d.label)-1;c=c+(".splice("+d+", 1, ")+this.generate(b.label.getSocketAtChild(2));c=this.emit(c+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_valueListItem=function(b){var c=b.getSocketAtChild(0);if(c._child){c=c._child;c=c.func=="valueOpBinary"?c.getSocketAtChild(1).label=="+"&&(!c.getSocketAtChild(0)._child&&""+c.getSocketAtChild(0).label=="1"||!c.getSocketAtChild(2)._child&&""+c.getSocketAtChild(2).label=="1")?c.getSocketAtChild(0)._child?this.generate(c.getSocketAtChild(0)):this.generate(c.getSocketAtChild(2)):this.generate(c)+" - 1":c.func=="valueOpAdd"?!c.getSocketAtChild(0)._child&&""+c.getSocketAtChild(0).label==
"1"||!c.getSocketAtChild(1)._child&&""+c.getSocketAtChild(1).label=="1"?c.getSocketAtChild(0)._child?this.generate(c.getSocketAtChild(0)):this.generate(c.getSocketAtChild(1)):this.generate(c)+" - 1":this.generate(c)+" - 1"}else c=c.label=="last"?this.generateIdentifier(b.getSocketAtChild(1))+".length - 1":c.label=="any"?"Math.randomRange(1, "+this.generateIdentifier(b.getSocketAtChild(1))+".length) - 1":valueToNative(c.label)-1;return this.emitInline(this.generateIdentifier(b.getSocketAtChild(1))+
"["+c+"]")};CodeGen.prototype.generate_valueListLength=function(b){return this.emitInline(this.generateIdentifier(b.getSocketAtChild(0))+".length")};CodeGen.prototype.generate_valueListContains=function(b){return this.emitInline(this.generateIdentifier(b.getSocketAtChild(0))+".contains("+this.generate(b.getSocketAtChild(1))+")")};
CodeGen.prototype.generate_blockObjSet=function(b){var c=b.label.getSocketAtChild(0),d=b.label.getSocketAtChild(1),e=b.label.getSocketAtChild(2),c=!d._child&&this.isIdentifier(d.label)?this.emit(this.generate(c)+"."+d.label+" = "+this.generate(e)+";"):this.emit(this.generate(c)+"["+this.generate(d)+"] = "+this.generate(e)+";");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_valueObjGet=function(b){var c=b.getSocketAtChild(0),b=b.getSocketAtChild(1);return!b._child&&this.isIdentifier(b.label)?this.emitInline(this.generate(c)+"."+b.label):this.emitInline(this.generate(c)+"["+this.generate(b)+"]")};CodeGen.prototype.generate_valueObjLength=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".length")};CodeGen.prototype.generate_valueObjKeys=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".keys()")};
CodeGen.prototype.generate_valueObjValues=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".values()")};CodeGen.prototype.generate_valueScriptVar=function(b){return this.generateIdentifier(b.name)};CodeGen.prototype.generate_valueParam=function(b){return this.generateIdentifier(b.name)};CodeGen.prototype.generate_valueVar=function(b){return this.emitInline("this.")+this.generateIdentifier(b.name)};
CodeGen.prototype.generate_valueList=function(b){return this.emitInline("this.")+this.generateIdentifier(b.name)};CodeGen.prototype.generate_valueNetworkParse=function(b){return this.emitInline(b.getSocketAtChild(0).label)};CodeGen.prototype.generate_registerMCPEEventChat=function(b){var c=this.emit("mc.onChat(function (message) {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerMCPEEventTell=function(b){var c=this.emit("mc.onTell(function (message) {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_registerMCPEEventDied=function(b){var c=this.emit("mc.onPlayerDied(function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerMCPEEventPlayer=function(b){var c=this.emit("mc.onPlayerTravelled(function (traveltype) {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_registerMCPEEventTeleported=function(b){var c=this.emit("mc.onPlayerTeleported(function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerMCPEEventBounced=function(b){var c=this.emit("mc.onPlayerBounced(function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_registerMCPEEventBlockPlaced=function(b){var c=this.emit("mc.onBlockPlaced("+this.generate(b.label.getSocketAtChild(0))+", function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerMCPEEventBlockPlacedAny=function(b){var c=this.emit("mc.onAnyBlockPlaced(function (block) {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_registerMCPEEventBlockBroken=function(b){var c=this.emit("mc.onBlockBroken("+this.generate(b.label.getSocketAtChild(0))+", function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerMCPEEventBlockBrokenAny=function(b){var c=this.emit("mc.onAnyBlockBroken(function (block) {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_registerMCPEEventMobKilled=function(b){var c=this.emit("mc.onMobKilled("+this.generate(b.label.getSocketAtChild(0))+", function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerMCPEEventMobKilledAny=function(b){var c=this.emit("mc.onAnyMobKilled(function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_registerMCPEEventEntitySpawned=function(b){var c=this.emit("mc.onEntitySpawned("+this.generate(b.label.getSocketAtChild(0))+", function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerMCPEEventEntitySpawnedAny=function(b){var c=this.emit("mc.onAnyEntitySpawned(function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_registerMCPEEventItemAcquired=function(b){var c=this.emit("mc.onItemAcquired("+this.generate(b.label.getSocketAtChild(0))+", function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerMCPEEventItemAcquiredAny=function(b){var c=this.emit("mc.onAnyItemAcquired(function (item) {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_registerMCPEEventItemDropped=function(b){var c=this.emit("mc.onItemDropped("+this.generate(b.label.getSocketAtChild(0))+", function () {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};
CodeGen.prototype.generate_registerMCPEEventItemDroppedAny=function(b){var c=this.emit("mc.onAnyItemDropped(function (item) {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("});\n")};CodeGen.prototype.generate_blockMCPEBotStart=function(b){var c=this.emit("mc.bot.start();");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEBotFlush=function(b){var c=this.emit("mc.bot.flush();");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEBotClear=function(b){var c=this.emit("mc.bot.clear();");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEBotMoveBy=function(b){var c=this.emit("mc.bot.moveBy("+this.generate(b.label.getSocketAtChild(0))+", "+this.generate(b.label.getSocketAtChild(1))+", "+this.generate(b.label.getSocketAtChild(2))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEBotMoveTo=function(b){var c=this.emit("mc.bot.moveTo("+this.generate(b.label.getSocketAtChild(0))+", "+this.generate(b.label.getSocketAtChild(1))+", "+this.generate(b.label.getSocketAtChild(2))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEBotMoveToPlayer=function(b){var c=this.emit("mc.bot.moveToPlayer();");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEBotTestForBlock=function(b){var c=this.emit("mc.bot.testForBlock("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_valueMCPEResult=function(){return this.emitInline("mc.bot.result")};CodeGen.prototype.generate_blockMCPEBotMove=function(b){var c=this.emit("mc.bot.move("+this.generate(b.label.getSocketAtChild(0))+", "+this.generate(b.label.getSocketAtChild(1))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEBotTurnLeft=function(b){var c=this.emit("mc.bot.turnLeft();");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEBotTurnRight=function(b){var c=this.emit("mc.bot.turnRight();");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEBotPointDirection=function(b){var c=this.emit("mc.bot.pointTowards("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEBotSaveCheckpoint=function(b){var c=this.emit("mc.bot.saveCheckpoint("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEBotRestoreCheckpoint=function(b){var c=this.emit("mc.bot.restoreCheckpoint("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEBotPlaceBlock=function(b){var c=this.emit("mc.bot.place("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEBotBox=function(b){var c=this.emit("mc.bot.box("+this.generate(b.label.getSocketAtChild(0))+", "+this.generate(b.label.getSocketAtChild(1))+", "+this.generate(b.label.getSocketAtChild(2))+", "+this.generate(b.label.getSocketAtChild(3))+", "+this.generate(b.label.getSocketAtChild(4))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEBotSummon=function(b){var c=this.emit("mc.bot.summon("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEBotTeleport=function(b){var c=this.emit("mc.bot.teleport("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEEnchant=function(b){var c=this.emit("mc.teleport("+this.generate(b.label.getSocketAtChild(0))+", "+this.generate(b.label.getSocketAtChild(1))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEGive=function(b){var c=this.emit("mc.give("+this.generate(b.label.getSocketAtChild(0))+", "+this.generate(b.label.getSocketAtChild(1))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPETeleport=function(b){var c=this.emit("mc.teleport("+this.generate(b.label.getSocketAtChild(0))+", "+this.generate(b.label.getSocketAtChild(1))+", "+this.generate(b.label.getSocketAtChild(2))+", "+this.generate(b.label.getSocketAtChild(3))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPESetTime=function(b){var c=this.emit("mc.setTime("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEKill=function(b){var c=this.emit("mc.kill("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEGameMode=function(b){var c=this.emit("mc.setGameMode("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPESay=function(b){var c=this.emit("mc.say("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPETell=function(b){var c=this.emit("mc.say("+this.generate(b.label.getSocketAtChild(0))+", "+this.generate(b.label.getSocketAtChild(1))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPESetWeather=function(b){var c=this.emit("mc.setWeather("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPESummon=function(b){var c=this.emit("mc.summon("+this.generate(b.label.getSocketAtChild(0))+", "+this.generate(b.label.getSocketAtChild(1))+", "+this.generate(b.label.getSocketAtChild(2))+", "+this.generate(b.label.getSocketAtChild(3))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEAgentMove=function(b){var c=this.emit("mc.agent.move("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEAgentTurn=function(b){var c=this.emit("mc.agent.turn("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEAgentPlace=function(b){var c=this.emit("mc.agent.place("+this.generate(b.label.getSocketAtChild(0))+", "+this.generate(b.label.getSocketAtChild(1))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEAgentDetect=function(b){var c=this.emit("mc.agent.detect("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEAgentAttack=function(b){var c=this.emit("mc.agent.attack("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEAgentDestroy=function(b){var c=this.emit("mc.agent.destroy("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEAgentCollect=function(b){var c=this.emit("mc.agent.collect("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEAgentTill=function(b){var c=this.emit("mc.agent.till("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEAgentDropall=function(b){var c=this.emit("mc.agent.dropAll("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};CodeGen.prototype.generate_blockMCPEAgentTeleport=function(b){var c=this.emit("mc.agent.teleport();");return c=c+this.generate(b.next)};
CodeGen.prototype.generate_blockMCPEAgentFast=function(b){var c=this.emit("mc.agent.setFast("+this.generate(b.label.getSocketAtChild(0))+");");return c=c+this.generate(b.next)};
var g_fnSwiftMapping={"self.broadcast":"blockControlBroadcast","self.broadcastAndWait":"blockControlBroadcastWait","self.post":"blockControlPostMessage","self.postAndWait":"blockControlPostMessageAndWait","self.getMessageValue":"valueControlMessageValue","self.getMessageSource":"valueControlMessageSource","self.isClone":"valueControlIsClone","self.wait":"blockControlWait","self.waitUntil":"blockControlWaitUntil","self.clone":"blockControlCloneActor","self.getLastClonedActor":"valueControlLastClonedActor",
"self.getOriginalNameFromClone":"valueControlCloneName","self.deleteActor":"blockControlDeleteActor","self.print":"blockControlPrint","self.terminate":"blockControlStop","self.motion.move":"blockMotionMove","self.motion.turnCW":"blockMotionTurnCW","self.motion.turnCCW":"blockMotionTurnCCW","self.motion.pointDirection":"blockMotionPointDirection","self.motion.setAngle":"blockMotionPointAngle","self.motion.pointTowards":"blockMotionPointTowards","self.motion.moveTo":"blockMotionGoTo","self.motion.follow":"blockMotionGoTowards",
"self.motion.glide":"blockMotionGlide","self.motion.changeXBy":"blockMotionChangeXBy","self.motion.setX":"blockMotionSetX","self.motion.changeYBy":"blockMotionChangeYBy","self.motion.setY":"blockMotionSetY","self.motion.bounceOnEdge":"blockMotionBounceOnEdge","self.motion.setRotationStyle":"blockMotionRotationStyle","self.motion.getX":"valueMotionXPosition","self.motion.getY":"valueMotionYPosition","self.motion.getDirection":"valueMotionDirection","self.motion.getAngle":"valueMotionAngle","self.animation.setSpeed":"blockAnimationSetSpeed",
"self.animation.setPart":"blockLooksSetCharacterPart","self.animation.getPart":"valueLooksGetCharacterPart","self.animation.waitFor":"blockAnimationWaitFor","self.animation.stop":"blockAnimationStop","self.animation.isRunning":"valueAnimationIsRunning","self.animation.animationLength":"valueAnimationTime","self.animation.whenDone":"registerAnimationDone","self.animation.animate":"blockAnimationAnimate","self.animation.simpleMoveTo":"blockAnimationSimpleMoveTo","self.animation.simpleMoveBy":"blockAnimationSimpleMoveBy",
"self.animation.simpleRotateTo":"blockAnimationSimpleRotateTo","self.animation.simpleRotateBy":"blockAnimationSimpleRotateBy","self.animation.simpleScaleTo":"blockAnimationSimpleScaleTo","self.animation.simpleScaleBy":"blockAnimationSimpleScaleBy","self.animation.simpleBezierTo":"blockAnimationSimpleBezierTo","self.animation.simpleBezierBy":"blockAnimationSimpleBezierBy","self.animation.simpleEffectTo":"blockAnimationSimpleEffectTo","self.animation.simpleEffectBy":"blockAnimationSimpleEffectBy","self.animation.simpleSwitchCostume":"blockAnimationSimpleSwitchCostume",
"self.animation.simpleSwitchCostumeAndWait":"blockAnimationSimpleSwitchCostumeAndWait","self.animation.rotateTo":"blockAnimationRotateTo","self.animation.rotateBy":"blockAnimationRotateBy","self.animation.moveTo":"blockAnimationMoveTo","self.animation.moveBy":"blockAnimationMoveBy","self.animation.scaleTo":"blockAnimationScaleTo","self.animation.scaleBy":"blockAnimationScaleBy","self.animation.bezierBy":"blockAnimationBezierBy","self.animation.bezierTo":"blockAnimationBezierTo","self.animation.effectBy":"blockAnimationEffectBy",
"self.animation.effectTo":"blockAnimationEffectTo","self.animation.changeCostumes":"blockAnimationSwitchCostume","self.looks.setCostume":"blockLooksSwitchCostume","self.looks.nextCostume":"blockLooksNextCostume","self.looks.firstCostumeInGroup":"blockLooksFirstCostumeInGroup","self.looks.nextCostumeInGroup":"blockLooksNextCostumeInGroup","self.looks.getCostumeIndex":"valueLooksCostumeNum","self.looks.getCostume":"valueLooksCostumeName","self.looks.setBackgroundColor":"blockLooksBackgroundColor","self.looks.setBackground":"blockLooksSwitchBackground",
"self.looks.setBackgroundAndWait":"blockLooksSwitchBackgroundAndWait","self.looks.nextBackground":"blockLooksNextBackground","self.looks.firstBackgroundInGroup":"blockLooksFirstBackgroundInGroup","self.looks.nextBackgroundInGroup":"blockLooksNextBackgroundInGroup","self.looks.getBackgroundIndex":"valueLooksBackground","self.looks.getBackground":"valueLooksBackgroundName","self.looks.setLabel":"blockLooksSetLabel","self.looks.setBubbleStyle":"blockLooksSetBubble","self.looks.setBubbleDock":"blockLooksSetBubbleDock",
"self.looks.setBubbleWidth":"blockLooksSetBubbleWidth","self.looks.say":"blockLooksSay","self.looks.sayFor":"blockLooksSayFor","self.looks.think":"blockLooksThink","self.looks.thinkFor":"blockLooksThinkFor","self.looks.changeEffect":"blockLooksChangeEffect","self.looks.setEffect":"blockLooksSetEffect","self.looks.resetEffects":"blockLooksClearEffects","self.looks.changeSize":"blockLooksChangeSizeBy","self.looks.setSize":"blockLooksSetSize","self.looks.getSize":"valueLooksSize","self.looks.show":"blockLooksShow",
"self.looks.hide":"blockLooksHide","self.looks.isHidden":"valueLooksIsHidden","self.looks.setLayer":"blockLooksLayer","self.looks.getLayer":"valueLooksLayer","self.looks.bringToFront":"blockLooksGoFront","self.looks.sendToBack":"blockLooksGoBack","self.looks.moveBackward":"blockLooksMoveBack","self.looks.bringForward":"blockLooksMoveFront","self.looks.dialog":"blockLooksDialog","self.looks.prompt":"blockLooksPromptChoices","self.looks.setViewportCamera":"blockLooksViewportCamera","self.looks.showVideo":"blockLooksVideo",
"self.looks.setVideoTransparency":"blockLooksVideoTransparency","self.looks.setLevel":"blockLooksSetLevel","self.looks.getLevel":"valueLooksGetLevel","self.looks.getLevelIndex":"valueLooksGetLevelNum","self.looks.getNumLevels":"valueLooksNumLevels","self.looks.getTile":"valueLooksGetTileAt","self.looks.getTileAtPoint":"valueLooksGetTileAtPoint","self.looks.setTile":"blockLooksSetTileAt","self.looks.setTileAtPoint":"blockLooksSetTileAtPoint","self.sensing.getVideo":"valueSensingVideo","self.sensing.isTouching":"valueSensingTouchingSprite",
"self.sensing.isTouchingClone":"valueSensingTouchingCloneOf","self.sensing.isTouchingColor":"valueSensingTouchingColor","self.sensing.isColorTouchingColor":"valueSensingSeeColor","self.sensing.ask":"blockSensingAskAndWait","self.sensing.askChoices":"blockSensingAskChoices","self.sensing.getAnswer":"valueSensingAnswer","self.sensing.getTiltAngle":"valueSensingTiltAngle","self.sensing.getTiltAmount":"valueSensingTiltAmount","self.sensing.getTiltX":"valueSensingAccelerometerX","self.sensing.getTiltY":"valueSensingAccelerometerY",
"self.sensing.getMouseX":"valueSensingMouseX","self.sensing.getMouseY":"valueSensingMouseY","self.sensing.isMouseDown":"valueSensingMouseDown","self.sensing.isKeyPressed":"valueSensingKeyPressed","self.sensing.getDistance":"valueSensingDistanceToSprite","self.sensing.resetTimer":"blockSensingResetTimer","self.sensing.getTimer":"valueSensingTimer","self.sensing.setSpriteProperty":"blockSensingSpriteProperty","self.sensing.getSpriteProperty":"valueSensingSpriteProperty","self.sensing.getActorName":"valueSensingActorName",
"self.sensing.getActorNameAtIndex":"valueSensingActorNameAt","self.sensing.getActorCount":"valueSensingNumActors","self.sensing.getTouchedActorName":"valueSensingTouchedActorName","self.sensing.getDateTime":"valueSensingDateTime","self.sensing.getScreenLeft":"valueSensingScreenLeft","self.sensing.getScreenRight":"valueSensingScreenRight","self.sensing.getScreenTop":"valueSensingScreenTop","self.sensing.getScreenBottom":"valueSensingScreenBottom","self.sensing.getScreenProperty":"valueSensingStageProperty",
"self.sensing.setTag":"blockSensingSetTag","self.sensing.getTag":"valueSensingGetTag","self.sensing.getUserId":"valueSensingUserId","self.sensing.getUserFirstName":"valueSensingUserFirstName","self.sound.play":"blockSoundPlay","self.sound.playUntilDone":"blockSoundPlayUntilDone","self.sound.stopAll":"blockSoundStopAll","self.sound.playDrum":"blockSoundPlayDrum","self.sound.playRest":"blockSoundRest","self.sound.playNote":"blockSoundPlayNote","self.sound.setInstrument":"blockSoundSetInstrument","self.sound.changeVolume":"blockSoundChangeVolume",
"self.sound.setVolume":"blockSoundSetVolume","self.sound.getVolume":"valueSoundVolume","self.sound.changeTempo":"blockSoundChangeTempo","self.sound.setTempo":"blockSoundSetTempo","self.sound.getTempo":"valueSoundTempo","self.canvas.clear":"blockPenClear","self.canvas.penDown":"blockPenDown","self.canvas.penUp":"blockPenUp","self.canvas.setColor":"blockPenSetColor","self.canvas.changeHue":"blockPenChangeHue","self.canvas.setHue":"blockPenSetHue","self.canvas.changeShade":"blockPenChangeShade","self.canvas.setShade":"blockPenSetShade",
"self.canvas.changePenSize":"blockPenChangeSize","self.canvas.setPenSize":"blockPenSetSize","self.canvas.stamp":"blockPenStamp","self.canvas.setFont":"blockPenSetFont","self.canvas.setFontColor":"blockPenSetFontColor","self.canvas.drawText":"blockPenDrawText","self.canvas.redraw":"blockPenRedraw","self.canvas.setFillColor":"blockPenSetFillColor","self.canvas.setNoFill":"blockPenSetNoFill","self.canvas.drawBezier":"blockPenDrawBezier","self.canvas.drawPoint":"blockPenDrawPoint","self.canvas.drawLine":"blockPenDrawLine",
"self.canvas.drawRect":"blockPenDrawRectangle","self.canvas.drawTriangle":"blockPenDrawTriangle","self.canvas.drawEllipse":"blockPenDrawEllipse","self.canvas.drawTextAt":"blockPenDrawTextAt","self.canvas.drawLocalRect":"blockPenDrawRectangleLocal","self.canvas.drawLocalEllipse":"blockPenDrawRectangleLocal","self.physics.getProperty":"blockPhysicsGetProperty","self.physics.apply":"blockPhysicsApply","self.physics.applyXY":"blockPhysicsApplyXY","self.physics.applyActive":"blockPhysicsSetActorActive",
"self.physics.applyStatic":"blockPhysicsSetActorStatic","self.physics.applyGeometry":"blockPhysicsSetActorGeometry","self.physics.isCollidedWith":"valuePhysicsCollidedWithSprite","self.physics.getCollidedName":"valuePhysicsCollidedWithName","self.physics.applyForce":"blockPhysicsApplyForce","self.physics.applyImpulse":"blockPhysicsApplyImpulse","self.physics.applyForceAtAngle":"blockPhysicsApplyForceAngle","self.physics.applyImpulseAtAngle":"blockPhysicsApplyImpulseAngle","self.physics.applyForceAtXY":"blockPhysicsApplyForceXY",
"self.physics.applyImpulseAtXY":"blockPhysicsApplyImpulseXY","self.physics.applyTorque":"blockPhysicsApplyTorque","self.physics.setActive":"blockPhysicsSetActive","self.physics.setStatic":"blockPhysicsSetStatic","self.physics.setGeometry":"blockPhysicsSetGeometry","self.physics.setDensity":"blockPhysicsSetDensity","self.physics.setFriction":"blockPhysicsSetFriction","self.physics.setRestitution":"blockPhysicsSetRestitution","self.physics.setAngularDamping":"blockPhysicsSetAngularDamping","self.physics.setAngularVelocity":"blockPhysicsSetAngularVelocity",
"self.physics.setLinearDamping":"blockPhysicsSetLinearDamping","self.physics.setLinearVelocity":"blockPhysicsSetLinearVelocity","self.physics.getDensity":"valuePhysicsDensity","self.physics.getFriction":"valuePhysicsFriction","self.physics.getRestitution":"valuePhysicsRestitution","self.physics.getAngularVelocity":"valuePhysicsAngularVelocity","self.physics.getInertia":"valuePhysicsInertia","self.physics.isAwake":"valuePhysicsIsAwake","self.physics.getVelocityX":"valuePhysicsXVelocity","self.physics.getVelocityY":"valuePhysicsYVelocity",
"self.physics.getAngularDamping":"valuePhysicsAngularDamping","self.physics.getLinearDamping":"valuePhysicsLinearDamping","self.physics.setGravity":"blockPhysicsSetGravity","self.physics.getGravityX":"valuePhysicsXGravity","self.physics.getGravityY":"valuePhysicsYGravity","self.physics.start":"blockPhysicsStart","self.physics.stop":"blockPhysicsStop","self.net.saveValue":"blockNetworkSaveValue","self.net.loadValue":"blockNetworkLoadValue","self.net.fetch":"blockNetworkAPI","self.net.parse":"valueNetworkParse",
"self.net.getResult":"valueNetworkResult"},g_revFnSwiftMapping={};for(key in g_fnSwiftMapping)g_revFnSwiftMapping[g_fnSwiftMapping[key]]=key;
g_builtinsCompletion=["self.setState({})","self.onStart(function(){\n});","self.onCondition(function(){return condition;}, function(){\n});","self.onActorClick(function(){\n});",'self.onKeyPress("space", function(){\n});',"self.onSceneChange(function(){\n})","self.onMessageReceived(message, function(){\n})","self.onClone(function(){\n})","self.onDraw(function(){\n})","self.onCollision(function(){\n})","self.onAnimationDone(function(){\n})","self.requestBlock(function(){\n})","Math.abs(theta)","Math.acos(theta)",
"Math.asin(theta)","Math.atan(theta)","Math.atan2(y, x)","Math.ceil(n)","Math.cos(n)","Math.exp(n)","Math.floor(n)","Math.log(n)","Math.max(n, m)","Math.min(n, m)","Math.pow(x, y)","Math.random()","Math.randomRange(min, max)","Math.round(n)","Math.sin(theta)","Math.sqrt(n)","Math.tan(theta)","Math.E","Math.PI","Math.SQRT2","Math.SQRT1_2","Math.LN2","Math.LN10","Math.LOG2E","Math.LOG10E"];g_fnCompletion="self.broadcast(event);self.broadcastAndWait(event);self.post(event, target arg);self.postAndWait(event, target, arg);self.getMessageValue();self.getMessageSource();self.isClone();self.wait(seconds);self.waitUntil(condition);self.clone(actorName);self.getLastClonedActor();self.getOriginalNameFromClone(actorName);self.deleteActor();self.terminate(type);self.motion.move(d);self.motion.turnCW(degrees);self.motion.turnCCW(degrees);self.motion.pointDirection(degrees);self.motion.setAngle(degrees);self.motion.pointTowards(actorName);self.motion.moveTo(x, y);self.motion.follow(actorName);self.motion.glide(seconds, x, y);self.motion.changeXBy(x);self.motion.setX(x);self.motion.changeYBy(y);self.motion.setY(y);self.motion.bounceOnEdge();self.motion.setRotationStyle(style);self.motion.getX();self.motion.getY();self.motion.getDirection();self.motion.getAngle();self.animation.rotateTo(time, theta, easing, name);self.animation.rotateBy(time, theta, easing, name);self.animation.moveTo(time, x, y, easing, name);self.animation.moveBy(time, x, y, easing, name);self.animation.scaleTo(time, scale, easing, name);self.animation.scaleBy(time, scale, easing, name);self.animation.bezierBy(time, x, y, cx1, cy1, cx2, cy2, easing, name);self.animation.bezierTo(time, x, y, cx1, cy1, cx2, cy2, easing, name);self.animation.effectBy(time, effect, value, easing, name);self.animation.effectTo(time, effect, value, easing, name);self.animation.changeCostumes(time, fps, prefix, easing, name);self.animation.waitFor(name);self.animation.stop(name);self.animation.isRunning(name);self.looks.setCostume(name);self.looks.nextCostume();self.looks.firstCostumeInGroup(prefix);self.looks.nextCostumeInGroup(prefix);self.looks.getCostumeIndex();self.looks.getCostume();self.looks.setBackground(scene);self.looks.setBackgroundAndWait(scene);self.looks.nextBackground();self.looks.firstBackgroundInGroup(prefix);self.looks.nextBackgroundInGroup(prefix);self.looks.getBackgroundIndex();self.looks.getBackground();self.looks.setLabel(text);self.looks.setBubbleStyle(style);self.looks.setBubbleDock(dock);self.looks.say(text);self.looks.sayFor(text, seconds);self.looks.think(text);self.looks.thinkFor(text, seconds);self.looks.changeEffect(effect, n);self.looks.setEffect(effect, n);self.looks.resetEffects();self.looks.changeSize(scale);self.looks.setSize();self.looks.getSize();self.looks.show();self.looks.hide();self.looks.isHidden();self.looks.setLayer(n);self.looks.getLayer();self.looks.bringToFront();self.looks.sendToBack();self.looks.moveBackward(n);self.looks.bringForward(n);self.looks.dialog(text);self.looks.prompt(text, button1, button2);self.sensing.isTouching(actorName);self.sensing.isTouchingClone(actorName);self.sensing.isTouchingColor(color);self.sensing.isColorTouchingColor(color1, color2);self.sensing.ask(text);self.sensing.askChoices(text, choice1, choice2);self.sensing.getAnswer();self.sensing.getMouseX();self.sensing.getMouseY();self.sensing.isMouseDown();self.sensing.isKeyPressed(keyName);self.sensing.getDistance(actorName);self.sensing.resetTimer();self.sensing.getTimer();self.sensing.getSpriteProperty(prop, actorName);self.sensing.getActorName();self.sensing.getActorNameAtIndex(n);self.sensing.getActorCount();self.sensing.getTouchedActorName();self.sensing.getDateTime(which);self.sensing.getScreenLeft();self.sensing.getScreenRight();self.sensing.getScreenTop();self.sensing.getScreenBottom();self.sensing.getScreenProperty(which);self.sensing.getUserId();self.sensing.getUserFirstName();self.sound.play(name);self.sound.playUntilDone(name);self.sound.stopAll();self.sound.playDrum(drumIdx, beats);self.sound.playRest(beats);self.sound.playNote(noteIdx);self.sound.setInstrument(instrumentIdx);self.sound.changeVolume(n);self.sound.setVolume(n);self.sound.getVolume();self.sound.changeTempo(n);self.sound.setTempo(n);self.sound.getTempo();self.canvas.clear();self.canvas.penDown();self.canvas.penUp();self.canvas.setColor(color);self.canvas.changeHue(n);self.canvas.setHue(n);self.canvas.changeShade(n);self.canvas.setShade(n);self.canvas.changePenSize(n);self.canvas.setPenSize(n);self.canvas.stamp();self.canvas.setFont(size, style, fontName);self.canvas.setFontColor(color);self.canvas.drawText(text);self.canvas.redraw();self.canvas.setFillColor(color);self.canvas.setNoFill();self.canvas.drawBezier(x1, y1, x2, y2, cx1, cy1, cx2, cy2);self.canvas.drawPoint(x, y);self.canvas.drawLine(x1, y1, x2, y2);self.canvas.drawRect(x, y, width, height);self.canvas.drawTriangle(x1, y1, x2, y2, x3, y3);self.canvas.drawEllipse(x, y, width, height);self.canvas.drawTextAt(text, x, y);self.canvas.drawLocalRect(width, height);self.canvas.drawLocalEllipse(width, height);self.physics.getProperty(name, actor);self.physics.apply(name, actor, value);self.physics.applyXY(name, actor, x, y);self.physics.applyActive(actor, boolean);self.physics.applyStatic(actor, boolean);self.physics.applyGeometry(actor, geometry);self.physics.isCollidedWith(actorName);self.physics.getCollidedName();self.physics.applyForce(n);self.physics.applyImpulse(n);self.physics.applyForceAtAngle(n, degrees);self.physics.applyImpulseAtAngle(n, degrees);self.physics.applyForceAtXY(x, y);self.physics.applyImpulseAtXY(x, y);self.physics.applyTorque(n);self.physics.setActive(b);self.physics.setStatic(b);self.physics.setGeometry(geometry);self.physics.setDensity(n);self.physics.setFriction(n);self.physics.setRestitution(n);self.physics.setAngularDamping(n);self.physics.setAngularVelocity(n);self.physics.setLinearDamping(n);self.physics.setLinearVelocity(x, y);self.physics.getDensity();self.physics.getFriction();self.physics.getRestitution();self.physics.getAngularVelocity();self.physics.getInertia();self.physics.isAwake();self.physics.getVelocityX();self.physics.getVelocityY();self.physics.getAngularDamping();self.physics.getLinearDamping();self.physics.setGravity(x, y);self.physics.getGravityX();self.physics.getGravityY();self.physics.start();self.physics.stop();self.net.saveValue(name,value,access);self.net.loadValue(name);self.net.fetch(url);self.net.parse(json);self.net.getResult()".split(";");
g_keywords="null true false break case catch const default finally for instanceof new var continue function return void delete if this self do while else in switch throw try typeof with debugger".split(" ");g_properties="background #;scene #;scene name;x gravity;y gravity;x position;y position;direction;costume #;costume name;say;visible;size;volume;density;friction;restitution;angular velocity;angular damping;linear damping;x linear velocity;y linear velocity;inertia;awake;width;height;effect/nnn".split(";");
function SwiftCodeGen(){this._loopLevel=this.indentLevel=0;this._onAnimationDoneCount=this._onCollisionCount=this._onDrawCount=this._onCloneCount=this._onMessageCount=this._onSceneChangeCount=this._onActorClickCount=this._onKeyPressCount=this._onStartCount=1}SwiftCodeGen.prototype.reset=function(){this._loopLevel=0};SwiftCodeGen.prototype.isIdentifier=function(b){return/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(b)};SwiftCodeGen.prototype.reset=function(){this._loopLevel=0};SwiftCodeGen.prototype.pushLoop=function(){this._loopLevel++};
SwiftCodeGen.prototype.peekLoop=function(){return this._loopLevel};SwiftCodeGen.prototype.popLoop=function(){this._loopLevel--};SwiftCodeGen.prototype.emit=function(b){for(var c="",d=0;d<this.indentLevel;d++)c=c+"    ";return c+b+"\n"};SwiftCodeGen.prototype.emitPartial=function(b){for(var c="",d=0;d<this.indentLevel;d++)c=c+"    ";return c+b};SwiftCodeGen.prototype.emitInline=function(b){return b};SwiftCodeGen.prototype.emitNumber=function(b){return b};
SwiftCodeGen.prototype.emitString=function(b){return'"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'};SwiftCodeGen.prototype.pushLevel=function(){this.indentLevel++};SwiftCodeGen.prototype.popLevel=function(){if(--this.indentLevel<0)this.indentLevel=0};
SwiftCodeGen.prototype.generateScene=function(b){var c="";if(!b){c=this.emit("// Define scene");c=c+this.emit("class Scene : BaseScene {");this.pushLevel();c=c+this.generateState(Runtime.background);c=c+this.generateJsVars(Runtime.background)}for(var d=0;d<Runtime.background.scripts.length;d++){var e=Runtime.background.scripts[d];if(e instanceof Block&&!e.hidden&&!e.hasFlap)try{this.reset();c=c+this.generate(e)}catch(f){console.log("generator error");console.log(f.stack)}}if(!b){this.popLevel();c=
c+this.emit("}\n")}return c};SwiftCodeGen.prototype.generateActor=function(b,c){var d="";if(!c){d=this.emit('// Define "'+b.label+'"');d=d+this.emit("class "+this.generateIdentifier(b.label)+" : BaseActor {");this.pushLevel();d=d+this.generateState(b);d=d+this.generateJsVars(b)}for(var e=0;e<b.scripts.length;e++){var f=b.scripts[e];if(f instanceof Block&&!f.hasFlap)try{this.reset();d=d+this.generate(f)}catch(g){console.log("generator error");console.log(g.stack)}}if(!c){this.popLevel();d=d+this.emit("}\n")}return d};
SwiftCodeGen.prototype.generateState=function(b){var c="";if(!b||b==Runtime.background){b=Runtime.background;c=c+this.emit("let _name = "+this.emitString(b.label)+";");c=c+this.emit("let _expand = "+(Runtime.stage.expand?true:false)+";");c=c+this.emit("var _width = "+Runtime.stage.width+";");c=c+this.emit("var _height = "+Runtime.stage.height+";");c=c+this.emit("var _penWidth = "+b.penWidth+";");c=c+this.emit("var _penColor = "+this.emitString(b.penColor)+";");c=c+this.emit("var _fillColor = "+this.emitString(b.fillColor)+
";");c=c+this.emit("var _font = "+this.emitString(b.font)+";");c=c+this.emit("var _fontColor = "+this.emitString(b.fontColor)+";");c=c+this.emit("var _physicsEnabled = "+(Physics.isSimulationRunning()?true:false)+";");c=c+this.emit("var _gravityX = "+Physics.getWorld().GetGravity().x+";");c=c+this.emit("var _gravityY = "+Physics.getWorld().GetGravity().y+";")}else{c=c+this.emit("let _class = "+this.emitString(b.classname)+";");c=c+this.emit("let _name = "+this.emitString(b.label)+";");c=c+this.emit("var _x = "+
(b.spriteObj.x-Runtime.stage.width/2)+";");c=c+this.emit("var _y = "+-(b.spriteObj.y-Runtime.stage.height/2)+";");c=c+this.emit("var _scale = "+b.spriteObj.scale.x+";");c=c+this.emit("var _angle = "+(360-b.spriteObj.rotation)%360+";");c=c+this.emit("var _layer = "+b.spriteObj.zIndex+";");c=c+this.emit("var _rotateLock = "+b.spriteObj.rotateLock+";");c=c+this.emit("var _hidden = "+(!b.spriteObj.visible?true:false)+";");c=c+this.emit("var _draggable = "+(b.spriteObj.draggable?true:false)+";");c=c+this.emit("var _penWidth = "+
b.penWidth+";");c=c+this.emit("var _penColor = "+this.emitString(b.penColor)+";");c=c+this.emit("var _fillColor = "+this.emitString(b.fillColor)+";");c=c+this.emit("var _font = "+this.emitString(b.font)+";");c=c+this.emit("var _fontColor = "+this.emitString(b.fontColor)+";");if(b.skeleton.type&&b.skeleton.parts){c=c+this.emit("var _skelType = "+this.emitString(b.skeleton.type)+";");c=c+this.emit("var _skelParts = "+this.emitString(JSON.stringify(b.skeleton.parts))+";")}b.spriteObj.bubble&&(c=c+this.emit("var _bubble = "+
JSON.stringify(b.spriteObj.bubble)+";"));var d=Physics.getSpriteProperties(b.spriteObj),c=c+this.emit("var _physicsStatic = "+(d.isStatic?true:false)+";"),c=c+this.emit("var _physicsActive = "+(d.isActive?true:false)+";"),c=c+this.emit("var _physicsGeometry = "+this.emitString(d.geometry)+";"),c=c+this.emit("var _physicsDensity = "+d.density+";"),c=c+this.emit("var _physicsFriction = "+d.friction+";"),c=c+this.emit("var _physicsRestitution = "+d.restitution+";")}c=c+this.emit("var _currentCostume = "+
b.currentCostume+";");if(b.costumes.length>0){c=c+this.emit("var _costumes = [");this.pushLevel();c=c+this.generateCostumes(b);this.popLevel();c=c+this.emit("];")}else c=c+this.emit("var _costumes = [ ];");c=c+this.emit("var _volume = "+b.volume+";");if(b.sounds.length>0){c=c+this.emit("var _sounds = [");this.pushLevel();c=c+this.generateSounds(b);this.popLevel();c=c+this.emit("];")}else c=c+this.emit("var _sounds = [ ];");return c};
SwiftCodeGen.prototype.generateCostumes=function(b){for(var c="",d=0;d<b.costumes.length;d++){var e=b.costumes[d],e='Costume(name:"'+e.name+'", img:"'+e.img+'", cx:'+e.cx+", cy:"+e.cy+")";d<b.costumes.length-1&&(e=e+",");c=c+this.emit(e)}return c};SwiftCodeGen.prototype.generateSounds=function(b){for(var c="",d=0;d<b.sounds.length;d++){var e=b.sounds[d],e='Sound(name:"'+e.name+'", sound:"'+e.sound+'")';d<b.sounds.length-1&&(e=e+",");c=c+this.emit(e)}return c};
SwiftCodeGen.prototype.generateJsVars=function(b){var c="",d;for(d in b.lists)c=c+this.emit("var "+this.generateIdentifier(d)+" = "+JSON.stringify(b.lists[d])+";");for(d in b.variables)b.lists[d]===void 0&&(c=c+this.emit("var "+this.generateIdentifier(d)+" = "+JSON.stringify(b.variables[d])+";"));c&&(c=c+this.emit(""));return c};SwiftCodeGen.prototype.generateCode=function(b){for(var c="",d=0;d<b.length;d++)c=c+this.generate(b[d]);return c};
SwiftCodeGen.prototype.generate=function(b){if(b){if(b instanceof LabelInput){if(b._child)return this.generate(b._child);b=valueToNative(b.label);return typeof b=="number"?this.emitNumber(b):typeof b=="string"?b=="true"?true:b=="false"?false:this.emitString(b):typeof b=="boolean"?b:this.emitString(""+b)}var c=this["generate_"+b.func];if(c)return c.apply(this,[b]);c=g_revFnSwiftMapping[b.func]?g_revFnSwiftMapping[b.func]+"(":b.func+"(";if(b instanceof Label){for(var d=0,e=b.getNumSockets();d<e;d++){d>
0&&(c=c+(", p"+d+":"));c=c+this.generate(b.getSocketAtChild(d))}c=this.emitInline(c+")")}else{d=0;for(e=b.label.getNumSockets();d<e;d++){d>0&&(c=c+(", p"+d+":"));c=c+this.generate(b.label.getSocketAtChild(d))}c=this.emit(c+");");c=c+this.generate(b.next)}return c}return""};
SwiftCodeGen.prototype.generateIdentifier=function(b){var c=""+b;if(b&&b instanceof LabelInput){b=valueToNative(b.label);typeof b=="number"?c="_"+this.emitNumber(b):typeof b=="string"&&(c=b)}c=c.replace(/[^a-zA-Z0-9_]/g,"_");if(!c||c[0]>="0"&&c[0]<="9")c="_"+c;g_keywords.indexOf(c)>=0&&(c="_"+c);return c};
SwiftCodeGen.prototype.generate_registerFlagTrigger=function(b){var c=this.emit("func onStart"+this._onStartCount++ +"() -> Void {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("}\n")};
SwiftCodeGen.prototype.generate_registerKeyTrigger=function(b){var c=this.emit("func onKeyPress"+this._onKeyPressCount++ +"(key:String) -> Void {");this.pushLevel();c=c+this.emit("if (key == "+this.generate(b.label.getSocketAtChild(0))+") {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();c=c+this.emit("}");this.popLevel();return c=c+this.emit("}\n")};
SwiftCodeGen.prototype.generate_registerTrigger=function(b){var c=this.emit("func onCondition() -> Void {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("}\n")};SwiftCodeGen.prototype.generate_registerSpriteTrigger=function(b){var c=this.emit("func onActorClick"+this._onActorClickCount++ +"() -> Void {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("}\n")};
SwiftCodeGen.prototype.generate_registerBackgroundChange=function(b){var c=this.generate(b.label.getSocketAtChild(0)),d=this.emit("func onSceneChange"+this._onSceneChangeCount++ +"(scene:String) -> Void {");this.pushLevel();d=d+this.emit("if (scene == "+this.emitString(c)+") {");this.pushLevel();d=d+this.generate(b.next);this.popLevel();d=d+this.emit("}");this.popLevel();return d=d+this.emit("}\n")};
SwiftCodeGen.prototype.generate_registerBroadcastTrigger=function(b){var c=this.generate(b.label.getSocketAtChild(0)),d=this.emit("func onMessageReceived"+this._onMessageCount++ +"(message:String) -> Void {");this.pushLevel();d=d+this.emit("if (message == "+c+") {");this.pushLevel();d=d+this.generate(b.next);this.popLevel();d=d+this.emit("}");this.popLevel();return d=d+this.emit("}\n")};
SwiftCodeGen.prototype.generate_registerCloned=function(b){var c=this.emit("func onClone"+this._onCloneCount++ +"() -> Void {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("}\n")};SwiftCodeGen.prototype.generate_registerDraw=function(b){var c=this.emit("func onDraw"+this._onDrawCount++ +"() -> Void {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("}\n")};
SwiftCodeGen.prototype.generate_registerSpriteCollision=function(b){var c=this.emit("func onCollision"+this._onCollisionCount++ +"() -> Void {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("}\n")};
SwiftCodeGen.prototype.generate_registerAnimationDone=function(b){var c=this.generate(b.label.getSocketAtChild(0)),d=this.emit("func onAnimationDone"+this._onAnimationDoneCount++ +"(animName:String) -> Void {");this.pushLevel();d=d+this.emit("if (animName == "+this.emitString(c)+") {");this.pushLevel();d=d+this.generate(b.next);this.popLevel();d=d+this.emit("}");this.popLevel();return d=d+this.emit("}\n")};
SwiftCodeGen.prototype.generate_blockControlBlock=function(b){var c="";this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_registerFunction=function(b){for(var c="func "+this.generateIdentifier(b.name)+"(",d=0,e=b.label.getNumSockets();d<e;d++){d>0&&(c=c+", ");c=c+(this.generate(b.label.getSocketAtChild(d))+":Value")}c=this.emit(c+") {");this.pushLevel();c=c+this.generate(b.next);this.popLevel();return c=c+this.emit("}\n")};
SwiftCodeGen.prototype.generate_blockControlCall=function(b){for(var c=this.generateIdentifier(b.name)+"(",d=0,e=b.label.getNumSockets();d<e;d++){d>0&&(c=c+", ");c=c+this.generate(b.label.getSocketAtChild(d))}c=this.emit(c+");");return c=c+this.generate(b.next)};SwiftCodeGen.prototype.generate_valueControlCall=function(b){for(var c=this.generateIdentifier(b.name)+"(",d=0,e=b.getNumSockets();d<e;d++){d>0&&(c=c+", ");c=c+this.generate(b.getSocketAtChild(d))}return c=this.emitInline(c+")")};
SwiftCodeGen.prototype.generate_blockControlCallMember=function(b){for(var c=this.generateIdentifier(b.label.getSocketAtChild(0)),d=this.generateIdentifier(b.label.getSocketAtChild(1)),c=c+"."+d+"(",d=2,e=b.label.getNumSockets();d<e;d++){d>2&&(c=c+", ");c=c+this.generate(b.label.getSocketAtChild(d))}c=this.emit(c+");");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_valueControlCallMember=function(b){for(var c=this.generateIdentifier(b.getSocketAtChild(0)),d=this.generateIdentifier(b.getSocketAtChild(1)),c=c+"."+d+"(",d=b.getNumSockets(),e=2;e<d;e++){e>2&&(c=c+", ");c=c+this.generate(b.getSocketAtChild(e))}return c+")"};
SwiftCodeGen.prototype.generate_blockControlCallLibrary=function(b){for(var c=b.name.split("::"),d=this.generateIdentifier(c[1]),c=c[0],c="lib."+c+"."+d+"(",d=0,e=b.label.getNumSockets();d<e;d++){d>0&&(c=c+", ");c=c+this.generate(b.label.getSocketAtChild(d))}c=this.emit(c+");");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_valueControlCallLibrary=function(b){for(var c=b.name.split("::"),d=this.generateIdentifier(c[1]),c=c[0],c="lib."+c+"."+d+"(",d=0,e=b.getNumSockets();d<e;d++){d>0&&(c=c+", ");c=c+this.generate(b.getSocketAtChild(d))}return c=this.emitInline(c+")")};SwiftCodeGen.prototype.generate_blockControlForever=function(b){var c=this.emit("while (true) {");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockControlRepeat=function(b){this.pushLoop();var c="_repeatIdx"+this.peekLoop(),c=this.emit("for (var "+c+" = 0; "+c+"<"+this.generate(b.label.getSocketAtChild(0))+"; "+c+"++) {");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockControlForeverIf=function(b){var c;c=b.label.getSocketAtChild(0);c=c._child&&c._child.func=="valueOpNot"?this.emit("while ("+this.generate(c._child.getSocketAtChild(0))+") { "):this.emit("while (!"+this.generate(c)+") { ");this.pushLevel();c=c+this.emit("while (true) { ");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockControlIf=function(b,c){var d;d=c?this.emitInline("if ("+this.generate(b.label.getSocketAtChild(0))+") {\n"):this.emit("if ("+this.generate(b.label.getSocketAtChild(0))+") {");this.pushLevel();d=d+this.generate(b.getBlockAtContainer(0));this.popLevel();d=d+this.emit("}");return d=d+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockControlIfElse=function(b,c){var d;d=c?this.emitInline("if ("+this.generate(b.label.getSocketAtChild(0))+") {\n"):this.emit("if ("+this.generate(b.label.getSocketAtChild(0))+") {");this.pushLevel();d=d+this.generate(b.getBlockAtContainer(0));this.popLevel();for(var e=1;e<b.getNumContainers()-1;e++){var f=b.getLabelAtContainer(e);d=d+this.emit("} else if ("+this.generate(f.getSocketAtChild(0))+") {");this.pushLevel();d=d+this.generate(b.getBlockAtContainer(e));this.popLevel()}if((e=
b.getBlockAtContainer(b.getNumContainers()-1))&&e.func=="blockControlIf"&&!e.next){d=d+this.emitPartial("} else ");d=d+this.generate_blockControlIf(e,true)}else if(e&&e.func=="blockControlIfElse"&&!e.next){d=d+this.emitPartial("} else ");d=d+this.generate_blockControlIfElse(e,true)}else{d=d+this.emit("} else {");this.pushLevel();d=d+this.generate(e);this.popLevel();d=d+this.emit("}")}return d=d+this.generate(b.next)};
SwiftCodeGen.prototype.generate_valueControlIfElse=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+" ? "+this.generate(b.getSocketAtChild(1))+" : "+this.generate(b.getSocketAtChild(2)))};SwiftCodeGen.prototype.generate_blockControlWhile=function(b){var c=this.emit("while ("+this.generate(b.label.getSocketAtChild(0))+") { ");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockControlRepeatUntil=function(b){var c;c=b.label.getSocketAtChild(0);c=c._child&&c._child.func=="valueOpNot"?this.emit("while ("+this.generate(c._child.getSocketAtChild(0))+") { "):this.emit("while (!"+this.generate(c)+") { ");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockControlReturn=function(b){var c;c=(c=b.label.getSocketAtChild(0))&&(c._child||c.label)?this.emit("return "+this.generate(c)+";"):this.emit("return;");return c=c+this.generate(b.next)};SwiftCodeGen.prototype.generate_blockControlStop=function(b){return this.emit("self.terminate("+this.generate(b.label.getSocketAtChild(0))+");")};SwiftCodeGen.prototype.generate_blockControlStopScript=function(){return this.emit("blockControlStopScript();")};
SwiftCodeGen.prototype.generate_blockControlStopAll=function(){return this.emit("blockControlStopAll();")};SwiftCodeGen.prototype.generate_blockControlScriptVar=function(b){for(var c="var ",d=0;d<b.label.getNumSockets();d++){d>0&&(c=c+", ");c=c+(this.generate(b.label.getSocketAtChild(d))+":Int")}c=this.emit(c+";");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockControlFor=function(b){var c=this.generateIdentifier(b.label.getSocketAtChild(0)),c=this.emit("for (var "+c+"="+this.generate(b.label.getSocketAtChild(1))+"; "+c+"<="+this.generate(b.label.getSocketAtChild(2))+"; "+c+"+="+this.generate(b.label.getSocketAtChild(3))+") {");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockControlForEach=function(b){var c=this.emit("for ("+this.generateIdentifier(b.label.getSocketAtChild(1)+" in "+this.generate(b.label.getSocketAtChild(0)))+") {");this.pushLevel();c=c+this.generate(b.getBlockAtContainer(0));this.popLevel();c=c+this.emit("}");return c=c+this.generate(b.next)};SwiftCodeGen.prototype.generate_blockControlBreak=function(b){var c=this.emit("break;");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockControlContinue=function(b){var c=this.emit("continue;");return c=c+this.generate(b.next)};SwiftCodeGen.prototype.generate_blockComment=function(b){var c=this.emit("/*"),c=c+this.emit(b.label.getSocketAtChild(0).label);return c=c+this.emit("*/")};SwiftCodeGen.prototype.generate_blockInlineComment=function(b){var c=this.emit("//"+b.label.getSocketAtChild(0).label);return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_valueOpAdd=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" + "+this.generate(b.getSocketAtChild(1))+")")};SwiftCodeGen.prototype.generate_valueOpSubtract=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" - "+this.generate(b.getSocketAtChild(1))+")")};
SwiftCodeGen.prototype.generate_valueOpMultiply=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" * "+this.generate(b.getSocketAtChild(1))+")")};SwiftCodeGen.prototype.generate_valueOpDivide=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" / "+this.generate(b.getSocketAtChild(1))+")")};
SwiftCodeGen.prototype.generate_valueOpRandom=function(b){return this.emitInline("Math.randomRange("+this.generate(b.getSocketAtChild(0))+", "+this.generate(b.getSocketAtChild(1))+")")};SwiftCodeGen.prototype.generate_valueOpLess=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" < "+this.generate(b.getSocketAtChild(1))+")")};
SwiftCodeGen.prototype.generate_valueOpEqual=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" == "+this.generate(b.getSocketAtChild(1))+")")};SwiftCodeGen.prototype.generate_valueOpGreater=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" > "+this.generate(b.getSocketAtChild(1))+")")};
SwiftCodeGen.prototype.generate_valueOpAnd=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" && "+this.generate(b.getSocketAtChild(1))+")")};SwiftCodeGen.prototype.generate_valueOpOr=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" || "+this.generate(b.getSocketAtChild(1))+")")};
SwiftCodeGen.prototype.generate_valueOpNot=function(b){b=b.getSocketAtChild(0);return b._child&&b._child.func=="valueOpNot"?this.generate(b._child.getSocketAtChild(0)):this.emitInline("!"+this.generate(b))};SwiftCodeGen.prototype.generate_valueOpJoin=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" + "+this.generate(b.getSocketAtChild(1))+")")};
SwiftCodeGen.prototype.generate_valueOpLetter=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".charAt("+this.generate(b.getSocketAtChild(1))+")")};SwiftCodeGen.prototype.generate_valueOpLength=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".length")};SwiftCodeGen.prototype.generate_valueOpMod=function(b){return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" % "+this.generate(b.getSocketAtChild(1))+")")};
SwiftCodeGen.prototype.generate_valueOpRound=function(b){return this.emitInline("Math.round("+this.generate(b.getSocketAtChild(0))+")")};
SwiftCodeGen.prototype.generate_valueOpMath=function(b){switch(b.getSocketAtChild(0).label){case "abs":return this.emitInline("Math.abs("+this.generate(b.getSocketAtChild(1))+")");case "floor":return this.emitInline("Math.floor("+this.generate(b.getSocketAtChild(1))+")");case "ceiling":return this.emitInline("Math.ceil("+this.generate(b.getSocketAtChild(1))+")");case "int":return this.emitInline("Math.parseInt("+this.generate(b.getSocketAtChild(1))+")");case "sqrt":return this.emitInline("Math.sqrt("+
this.generate(b.getSocketAtChild(1))+")");case "sin":return this.emitInline("Math.sin("+this.generate(b.getSocketAtChild(1))+" * Math.PI / 180)");case "sinrad":return this.emitInline("Math.sin("+this.generate(b.getSocketAtChild(1))+")");case "cos":return this.emitInline("Math.cos("+this.generate(b.getSocketAtChild(1))+" * Math.PI / 180)");case "cosrad":return this.emitInline("Math.cos("+this.generate(b.getSocketAtChild(1))+")");case "tan":return this.emitInline("Math.tan("+this.generate(b.getSocketAtChild(1))+
" * Math.PI / 180)");case "tanrad":return this.emitInline("Math.tan("+this.generate(b.getSocketAtChild(1))+")");case "asin":return this.emitInline("Math.asin("+this.generate(b.getSocketAtChild(1))+" * 180 / Math.PI)");case "asinrad":return this.emitInline("Math.asin("+this.generate(b.getSocketAtChild(1))+")");case "acos":return this.emitInline("Math.acos("+this.generate(b.getSocketAtChild(1))+" * 180 / Math.PI)");case "acosrad":return this.emitInline("Math.acos("+this.generate(b.getSocketAtChild(1))+
")");case "atan":return this.emitInline("Math.atan("+this.generate(b.getSocketAtChild(1))+" * 180 / Math.PI)");case "atanrad":return this.emitInline("Math.atan("+this.generate(b.getSocketAtChild(1))+")");case "ln":return this.emitInline("Math.log("+this.generate(b.getSocketAtChild(1))+")");case "log":return this.emitInline("Math.log("+this.generate(b.getSocketAtChild(1))+") / Math.LN10");case "e^":return this.emitInline("Math.exp("+this.generate(b.getSocketAtChild(1))+")");case "10^":return this.emitInline("Math.pow(10, "+
this.generate(b.getSocketAtChild(1))+")");case "sign":return this.emitInline("Math.sign("+this.generate(b.getSocketAtChild(1))+")")}return""};
SwiftCodeGen.prototype.generate_valueOpMath2=function(b){switch(b.getSocketAtChild(0).label){case "atan2":return this.emitInline("Math.atan2("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+") * 180 / Math.PI");case "atan2rad":return this.emitInline("Math.atan2("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+")");case "max":return this.emitInline("Math.max("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+
")");case "min":return this.emitInline("Math.min("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+")");case "pow":return this.emitInline("Math.pow("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+")")}return""};
SwiftCodeGen.prototype.generate_valueOpConstants=function(b){switch(b.getSocketAtChild(0).label){case "pi":return this.emitInline("Math.PI");case "e":return this.emitInline("Math.E");case "ln2":return this.emitInline("Math.LN2");case "ln10":return this.emitInline("Math.LN10");case "log2e":return this.emitInline("Math.LOG2E");case "log10e":return this.emitInline("Math.LOG10E");case "sqrt1/2":return this.emitInline("Math.SQRT1_2");case "sqrt2":return this.emitInline("Math.SQRT2")}return""};
SwiftCodeGen.prototype.generate_valueOpBinary=function(b){switch(b.getSocketAtChild(1).label){case "+":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" + "+this.generate(b.getSocketAtChild(2))+")");case "-":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" - "+this.generate(b.getSocketAtChild(2))+")");case "*":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" * "+this.generate(b.getSocketAtChild(2))+")");case "/":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+
" / "+this.generate(b.getSocketAtChild(2))+")");case "%":case "mod":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" % "+this.generate(b.getSocketAtChild(2))+")");case "=":case "==":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" == "+this.generate(b.getSocketAtChild(2))+")");case "<":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" < "+this.generate(b.getSocketAtChild(2))+")");case "<=":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+
" <= "+this.generate(b.getSocketAtChild(2))+")");case ">":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" > "+this.generate(b.getSocketAtChild(2))+")");case ">=":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" >= "+this.generate(b.getSocketAtChild(2))+")");case "!=":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" != "+this.generate(b.getSocketAtChild(2))+")");case "&":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" & "+this.generate(b.getSocketAtChild(2))+
")");case "and":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" && "+this.generate(b.getSocketAtChild(2))+")");case "|":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" | "+this.generate(b.getSocketAtChild(2))+")");case "or":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" || "+this.generate(b.getSocketAtChild(2))+")");case "^":case "xor":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" ^ "+this.generate(b.getSocketAtChild(2))+")");
case "<<":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" << "+this.generate(b.getSocketAtChild(2))+")");case ">>":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" >> "+this.generate(b.getSocketAtChild(2))+")");case ">>>":return this.emitInline("("+this.generate(b.getSocketAtChild(0))+" >>> "+this.generate(b.getSocketAtChild(2))+")")}return""};SwiftCodeGen.prototype.generate_valueOpBitNot=function(b){return this.emitInline("~"+this.generate(b.getSocketAtChild(0)))};
SwiftCodeGen.prototype.generate_valueOpExpression=function(b){return this.generate(b.getSocketAtChild(0))};SwiftCodeGen.prototype.generate_valueOpTextSplit=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".split("+this.generate(b.getSocketAtChild(1))+")")};SwiftCodeGen.prototype.generate_valueOpTextReplace=function(b){return this.emitInline(this.generate(b.getSocketAtChild(1))+".replace("+this.generate(b.getSocketAtChild(0))+", "+this.generate(b.getSocketAtChild(2))+")")};
SwiftCodeGen.prototype.generate_valueOpTextIndex=function(b){return this.emitInline(this.generate(b.getSocketAtChild(1))+".indexOf("+this.generate(b.getSocketAtChild(0))+")")};SwiftCodeGen.prototype.generate_valueOpTextLastIndex=function(b){return this.emitInline(this.generate(b.getSocketAtChild(1))+".lastIndexOf("+this.generate(b.getSocketAtChild(0))+")")};
SwiftCodeGen.prototype.generate_valueOpTextSubstring=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".substring("+this.generate(b.getSocketAtChild(1))+", "+this.generate(b.getSocketAtChild(2))+")")};
SwiftCodeGen.prototype.generate_valueOpTextTransform=function(b){var c=b.getSocketAtChild(1);switch(b.getSocketAtChild(0).label){case "uppercase":return this.emitInline(this.generate(c)+".toUpperCase()");case "lowercase":return this.emitInline(this.generate(c)+".toLowerCase()");case "trim":return this.emitInline(this.generate(c)+".trim()");default:return this.generate(c)}};
SwiftCodeGen.prototype.generate_blockVarPropSet=function(b){var c;c=false;var d=b.label.getSocketAtChild(1);d._child?c=true:d.label!="self"&&(c=true);var e=b.label.getSocketAtChild(0);e._child?c=true:g_properties.indexOf(e.label)>=0&&(c=true);c=c?this.emit("self.sensing.setSpriteProperty("+this.generate(e)+", actor:"+this.generate(d)+", value:"+this.generate(b.label.getSocketAtChild(2))+");"):this.emit(this.generateIdentifier(e)+" = "+this.generate(b.label.getSocketAtChild(2))+";");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_valueSensingSpriteProperty=function(b){return this.generate_valueVarPropGet(b)};SwiftCodeGen.prototype.generate_valueVarPropGet=function(b){var c=false,d=b.getSocketAtChild(1);d._child?c=true:d.label!="self"&&(c=true);b=b.getSocketAtChild(0);b._child?c=true:g_properties.indexOf(b.label)>=0&&(c=true);return c?this.emitInline("self.sensing.getSpriteProperty("+this.generate(b)+", actor:"+this.generate(d)+")"):this.generateIdentifier(b)};
SwiftCodeGen.prototype.generate_blockVarSet=function(b){var c=this.emit(this.generateIdentifier(b.label.getSocketAtChild(0))+" = "+this.generate(b.label.getSocketAtChild(1))+";");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockVarChangeBy=function(b){var c,d=b.label.getSocketAtChild(1);if(!d._child)if(d.label=="1"||d.label==1)c=this.emit(this.generateIdentifier(b.label.getSocketAtChild(0))+"++;");else if(d.label=="-1"||d.label==-1)c=this.emit(this.generateIdentifier(b.label.getSocketAtChild(0))+"--;");c||(c=this.emit(this.generateIdentifier(b.label.getSocketAtChild(0))+" += "+this.generate(b.label.getSocketAtChild(1))+";"));return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockVarShow=function(b){return this.generate(b.next)};SwiftCodeGen.prototype.generate_blockVarHide=function(b){return this.generate(b.next)};SwiftCodeGen.prototype.generate_valueListNew=function(){return this.emitInline("[]")};
SwiftCodeGen.prototype.generate_blockListAdd=function(b){for(var c=b.label.getNumSockets(),d=this.generateIdentifier(b.label.getSocketAtChild(c-1)),d=d+".push(",e=0;e<c-1;e++){e>0&&(d=d+", ");d=d+this.generate(b.label.getSocketAtChild(e))}d=this.emit(d+");");return d=d+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockListDel=function(b){var c=this.generateIdentifier(b.label.getSocketAtChild(1)),d=b.label.getSocketAtChild(0);if(d.label=="all")c=c+".length = 0;";else{d=b.label.getSocketAtChild(0);if(d._child){d=d._child;d=d.func=="valueOpBinary"?d.getSocketAtChild(1).label=="+"&&(!d.getSocketAtChild(0)._child&&""+d.getSocketAtChild(0).label=="1"||!d.getSocketAtChild(2)._child&&""+d.getSocketAtChild(2).label=="1")?d.getSocketAtChild(0)._child?this.generate(d.getSocketAtChild(0)):
this.generate(d.getSocketAtChild(2)):this.generate(d)+" - 1":d.func=="valueOpAdd"?!d.getSocketAtChild(0)._child&&""+d.getSocketAtChild(0).label=="1"||!d.getSocketAtChild(1)._child&&""+d.getSocketAtChild(1).label=="1"?d.getSocketAtChild(0)._child?this.generate(d.getSocketAtChild(0)):this.generate(d.getSocketAtChild(1)):this.generate(d)+" - 1":this.generate(d)+" - 1"}else d=valueToNative(d.label)-1;c=c+(".splice("+d+", 1);")}c=this.emit(c);return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockListInsert=function(b){var c=b.label.getNumSockets(),d=this.generateIdentifier(b.label.getSocketAtChild(c-1)),e=b.label.getSocketAtChild(c-2);if(e._child){e=e._child;e=e.func=="valueOpBinary"?e.getSocketAtChild(1).label=="+"&&(!e.getSocketAtChild(0)._child&&""+e.getSocketAtChild(0).label=="1"||!e.getSocketAtChild(2)._child&&""+e.getSocketAtChild(2).label=="1")?e.getSocketAtChild(0)._child?this.generate(e.getSocketAtChild(0)):this.generate(e.getSocketAtChild(2)):
this.generate(e)+" - 1":e.func=="valueOpAdd"?!e.getSocketAtChild(0)._child&&""+e.getSocketAtChild(0).label=="1"||!e.getSocketAtChild(1)._child&&""+e.getSocketAtChild(1).label=="1"?e.getSocketAtChild(0)._child?this.generate(e.getSocketAtChild(0)):this.generate(e.getSocketAtChild(1)):this.generate(e)+" - 1":this.generate(e)+" - 1"}else e=valueToNative(e.label)-1;d=d+(".splice("+e+", 0, ");for(e=0;e<c-2;e++){e>0&&(d=d+", ");d=d+this.generate(b.label.getSocketAtChild(e))}d=this.emit(d+");");return d=
d+this.generate(b.next)};
SwiftCodeGen.prototype.generate_blockListReplace=function(b){b.label.getNumSockets();var c=this.generateIdentifier(b.label.getSocketAtChild(1)),d=b.label.getSocketAtChild(0);if(d._child){d=d._child;d=d.func=="valueOpBinary"?d.getSocketAtChild(1).label=="+"&&(!d.getSocketAtChild(0)._child&&""+d.getSocketAtChild(0).label=="1"||!d.getSocketAtChild(2)._child&&""+d.getSocketAtChild(2).label=="1")?d.getSocketAtChild(0)._child?this.generate(d.getSocketAtChild(0)):this.generate(d.getSocketAtChild(2)):this.generate(d)+
" - 1":d.func=="valueOpAdd"?!d.getSocketAtChild(0)._child&&""+d.getSocketAtChild(0).label=="1"||!d.getSocketAtChild(1)._child&&""+d.getSocketAtChild(1).label=="1"?d.getSocketAtChild(0)._child?this.generate(d.getSocketAtChild(0)):this.generate(d.getSocketAtChild(1)):this.generate(d)+" - 1":this.generate(d)+" - 1"}else d=valueToNative(d.label)-1;c=c+(".splice("+d+", 1, ")+this.generate(b.label.getSocketAtChild(2));c=this.emit(c+");");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_valueListItem=function(b){var c=b.getSocketAtChild(0);if(c._child){c=c._child;c=c.func=="valueOpBinary"?c.getSocketAtChild(1).label=="+"&&(!c.getSocketAtChild(0)._child&&""+c.getSocketAtChild(0).label=="1"||!c.getSocketAtChild(2)._child&&""+c.getSocketAtChild(2).label=="1")?c.getSocketAtChild(0)._child?this.generate(c.getSocketAtChild(0)):this.generate(c.getSocketAtChild(2)):this.generate(c)+" - 1":c.func=="valueOpAdd"?!c.getSocketAtChild(0)._child&&""+c.getSocketAtChild(0).label==
"1"||!c.getSocketAtChild(1)._child&&""+c.getSocketAtChild(1).label=="1"?c.getSocketAtChild(0)._child?this.generate(c.getSocketAtChild(0)):this.generate(c.getSocketAtChild(1)):this.generate(c)+" - 1":this.generate(c)+" - 1"}else c=c.label=="last"?this.generateIdentifier(b.getSocketAtChild(1))+".length - 1":c.label=="any"?"Math.randomRange(1, "+this.generateIdentifier(b.getSocketAtChild(1))+".length) - 1":valueToNative(c.label)-1;return this.emitInline(this.generateIdentifier(b.getSocketAtChild(1))+
"["+c+"]")};SwiftCodeGen.prototype.generate_valueListLength=function(b){return this.emitInline(this.generateIdentifier(b.getSocketAtChild(0))+".length")};SwiftCodeGen.prototype.generate_valueListContains=function(b){return this.emitInline(this.generateIdentifier(b.getSocketAtChild(0))+".contains("+this.generate(b.getSocketAtChild(1))+")")};
SwiftCodeGen.prototype.generate_blockObjSet=function(b){var c=b.label.getSocketAtChild(0),d=b.label.getSocketAtChild(1),e=b.label.getSocketAtChild(2),c=!d._child&&this.isIdentifier(d.label)?this.emit(this.generate(c)+"."+d.label+" = "+this.generate(e)+";"):this.emit(this.generate(c)+"["+this.generate(d)+"] = "+this.generate(e)+";");return c=c+this.generate(b.next)};
SwiftCodeGen.prototype.generate_valueObjGet=function(b){var c=b.getSocketAtChild(0),b=b.getSocketAtChild(1);return!b._child&&this.isIdentifier(b.label)?this.emitInline(this.generate(c)+"."+b.label):this.emitInline(this.generate(c)+"["+this.generate(b)+"]")};SwiftCodeGen.prototype.generate_valueObjLength=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".length")};
SwiftCodeGen.prototype.generate_valueObjKeys=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".keys()")};SwiftCodeGen.prototype.generate_valueObjValues=function(b){return this.emitInline(this.generate(b.getSocketAtChild(0))+".values()")};SwiftCodeGen.prototype.generate_valueScriptVar=function(b){return this.generateIdentifier(b.name)};SwiftCodeGen.prototype.generate_valueParam=function(b){return this.generateIdentifier(b.name)};
SwiftCodeGen.prototype.generate_valueVar=function(b){return this.emitInline("self.")+this.generateIdentifier(b.name)};SwiftCodeGen.prototype.generate_valueList=function(b){return this.emitInline("self.")+this.generateIdentifier(b.name)};SwiftCodeGen.prototype.generate_valueNetworkParse=function(b){return this.emitInline(b.getSocketAtChild(0).label)};
(function(b){function c(c,e){this.$element=b(c);this.options=e;this.enabled=true;this.fixTitle()}c.prototype={show:function(){var c=this.getTitle();if(c&&this.enabled){var e=this.tip();e.find(".tipsy-inner")[this.options.html?"html":"text"](c);e[0].className="tipsy";e.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var c=b.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),f=e[0].offsetWidth,g=e[0].offsetHeight,
h=typeof this.options.gravity=="function"?this.options.gravity.call(this.$element[0]):this.options.gravity,j;switch(h.charAt(0)){case "n":j={top:c.top+c.height+this.options.offset,left:c.left+c.width/2-f/2};break;case "s":j={top:c.top-g-this.options.offset,left:c.left+c.width/2-f/2};break;case "e":j={top:c.top+c.height/2-g/2,left:c.left-f-this.options.offset};break;case "w":j={top:c.top+c.height/2-g/2,left:c.left+c.width+this.options.offset}}if(h.length==2)j.left=h.charAt(1)=="w"?c.left+c.width/2-
15:c.left+c.width/2-f+15;e.css(j).addClass("tipsy-"+h);e.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+h.charAt(0);this.options.className&&e.addClass(typeof this.options.className=="function"?this.options.className.call(this.$element[0]):this.options.className);this.options.fade?e.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):e.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){b(this).remove()}):
this.tip().remove()},fixTitle:function(){var b=this.$element;if(b.attr("title")||typeof b.attr("original-title")!="string")b.attr("original-title",b.attr("title")||"").removeAttr("title")},getTitle:function(){var b,c=this.$element,f=this.options;this.fixTitle();f=this.options;typeof f.title=="string"?b=c.attr(f.title=="title"?"original-title":f.title):typeof f.title=="function"&&(b=f.title.call(c[0]));return(b=(""+b).replace(/(^\s*|\s*$)/,""))||f.fallback},tip:function(){if(!this.$tip){this.$tip=
b('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>');this.$tip.data("tipsy-pointee",this.$element[0])}return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();this.options=this.$element=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};b.fn.tipsy=function(d){function e(e){var f=b.data(e,"tipsy");if(!f){f=new c(e,b.fn.tipsy.elementOptions(e,
d));b.data(e,"tipsy",f)}return f}function f(){var b=e(this);b.hoverState="in";if(d.delayIn==0)b.show();else{b.fixTitle();setTimeout(function(){b.hoverState=="in"&&b.show()},d.delayIn)}}function g(){var b=e(this);b.hoverState="out";d.delayOut==0?b.hide():setTimeout(function(){b.hoverState=="out"&&b.hide()},d.delayOut)}if(d===true)return this.data("tipsy");if(typeof d=="string"){var h=this.data("tipsy");if(h)h[d]();return this}d=b.extend({},b.fn.tipsy.defaults,d);d.live||this.each(function(){e(this)});
if(d.trigger!="manual"){var h=d.live?"live":"bind",j=d.trigger=="hover"?"mouseleave":"blur";this[h](d.trigger=="hover"?"mouseenter":"focus",f)[h](j,g)}return this};b.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:false,fallback:"",gravity:"n",html:false,live:false,offset:0,opacity:0.8,title:"title",trigger:"hover"};b.fn.tipsy.revalidate=function(){b(".tipsy").each(function(){var c=b.data(this,"tipsy-pointee"),e;if(!(e=!c)){a:{for(;c=c.parentNode;)if(c==document){c=true;break a}c=false}e=
!c}e&&b(this).remove()})};b.fn.tipsy.elementOptions=function(c,e){return b.metadata?b.extend({},e,b(c).metadata()):e};b.fn.tipsy.autoNS=function(){return b(this).offset().top>b(document).scrollTop()+b(window).height()/2?"s":"n"};b.fn.tipsy.autoWE=function(){return b(this).offset().left>b(document).scrollLeft()+b(window).width()/2?"e":"w"};b.fn.tipsy.autoBounds=function(c,e){return function(){var f=e[0],g=e.length>1?e[1]:false,h=b(document).scrollTop()+c,j=b(document).scrollLeft()+c,k=b(this);k.offset().top<
h&&(f="n");k.offset().left<j&&(g="w");b(window).width()+b(document).scrollLeft()-k.offset().left<c&&(g="e");b(window).height()+b(document).scrollTop()-k.offset().top<c&&(f="s");return f+(g?g:"")}}})(jQuery);(function(){angular.module("common.account",["common"])})();(function(){angular.module("common",["common.account","common.projects","common.rating","common.sharing"])})();(function(){angular.module("common.projects",[])})();(function(){angular.module("common.rating",[])})();
(function(){angular.module("common.sharing",[])})();(function(){angular.module("ide",["ui.router","common","components","ide.account"])})();angular.element(document).ready(function(){angular.bootstrap(".ide-app",["ide"])});
(function(){angular.module("common.account").controller("AccountCtrl",["$scope","$http","$state","api","externalAuth",function(b,c,d,e,f){b.state=d;b.error=null;b.busy=false;b.signupUser=function(c){b.busy=true;return e.addUser(c).then(function(){b.busy=false;b.onLoginSuccess()},function(c){b.busy=false;b.error=c})};b.validateUsername=function(b,d){b?b.length<6?d("Screen name must have at least 6 characters"):c({method:"GET",url:"/api/validateusername",params:{u:b}}).success(function(b){b=="true"?
d("Looking good!"):d("Sorry, that screen name is already taken.")}):d("You must provide a screen name")};b.validatePassword=function(b,c){b?b.length<6?c("Password must have at least 6 characters"):c("Ok!"):c("You must provide a password.")};b.validateEmail=function(b,d){b?b.indexOf("@")==-1?d("Doesn't look like a valid email"):c({method:"GET",url:"/api/validateemail?email="+b}).success(function(b){b.is_valid?d("Ok"):d("Doesn't look like a valid email")}):d("You must provide a valid email address")};
b.googleLogin=function(){f.googleLogin().then(function(){b.onLoginSuccess()},function(c){b.error=c})};b.onLoginSuccess=function(){$(document).trigger("common.account.loggedIn")};b.$on("$viewContentLoaded",function(){setTimeout(function(){$("#signup-view > .modal").modal()},0)})}])})();
(function(){angular.module("common.account").controller("AskParentCtrl",["$scope","$stateParams","api",function(b,c,d){b.activitySlug=c.activitySlug?c.activitySlug:null;b.error=null;b.parentEmail=null;b.sent=false;b.askParent=function(c,f){b.error=null;b.isLoading=true;d.sendParentPermissionRequest(c,f).then(function(){b.isLoading=false;b.sent=true;angular.element.cookie("submitted_ask_parent",true,{expires:3650,path:"/"})},function(c){b.isLoading=false;b.error=c})}}]).controller("JoinNewsletterCtrl",
["$scope","$stateParams","api",function(b,c,d){b.email=null;b.error=null;b.role=c.role?c.role:"parent";b.sent=false;b.steps=["join","profile","thanks"];b.step="join";b.fname=null;b.lname=null;b.joined=false;b.joining=false;b.init=function(c){b.email=c};b.join=function(c){d.addSubscription({email:c.email,role:c.role,strict:false,type:"email-collector-modal"}).then(function(c){b.subscriptionId=c;b.step="profile";b.error=null;ga("send","event","Join Newsletter Modal","Submit");angular.element.cookie("submitted_join_newsletter",
true,{expires:3650})},function(c){b.error=c})};b.updateProfile=function(c){d.updateSubscription(b.subscriptionId,{fname:c.fname,lname:c.lname,email:c.email,role:c.role,strict:false,type:"email-collector-modal"}).then(function(){b.error=null;b.step="thanks";ga("send","event","Join Newsletter Modal","Complete")})};b.joinFull=function(){b.joining=true;d.addSubscription({email:b.email,role:b.role,strict:false,type:"email-collector-modal"}).then(function(){console.info("worked");b.error=null;b.joining=
false;b.joined=true;ga("send","event","Hour of Code Congrats Page","Join Newsletter")},function(c){console.info(c);b.error=c;b.joining=false})}}])})();
(function(){angular.module("common").factory("externalAuth",["$http","$q",function(b,c){function d(){return c(function(c){b({method:"GET",url:"/api/isloggedin"}).success(function(b){c(b.is_logged_in)}).error(function(){c(false)})})}return{_externalLogin:function(b,f,g){var g=g!==void 0?g:{},h=g.popup!==void 0?g.popup:false,j=g.childConfCode!==void 0?g.childConfCode:null,k=g.next!==void 0?g.next:null,l=g.role!==void 0?g.role:null,m=g.campaign!==void 0?g.campaign:null,g=g.source!==void 0?g.source:null;
h&&k&&console.warn('Popup mode invoked with next "'+k+'", will be ignored');h&&(k="/api/closewindow");var n=[];j&&n.push("childConfCode="+encodeURIComponent(j));k&&n.push("next="+encodeURIComponent(k));l&&n.push("role="+encodeURIComponent(l));m&&n.push("campaign="+encodeURIComponent(m));g&&n.push("source="+encodeURIComponent(g));var q=n.join("&").replace(/%20/g,"+");if(h)return c(function(c,g){b=b+("?next="+encodeURIComponent("/auth/externallogin?"+q));var h=window.open(b,f,"width=580, height=496"),
j=window.setInterval(function(){if(h.closed){clearInterval(j);d().then(function(b){b===true?c():g("Could not log-in, please try again")})}},500)});if(l||g||m)b=b+("?next="+encodeURIComponent("/auth/externallogin?"+q));else if(k){h="/auth/externallogin?next="+encodeURIComponent(k);b=b+("?next="+encodeURIComponent(h))}window.location=b},facebookLogin:function(b){return this._externalLogin("/auth/facebooklogin","Facebook Login",b)},googleLogin:function(b){return this._externalLogin("/auth/googlelogin",
"Google Login",b)}}}])})();
(function(){function b(b){return{open:function(e){e=e!==void 0?e:{};return b.open({controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/common/account/modal-forgot-password.factory.html",locals:{useRoutes:e.useRoutes!==void 0?e.useRoutes:false}})}}}function c(b,c,f,g){var h=this;h.busy=false;h.error=null;h.userId=null;h.resetEmail=null;h.email=null;h.resetCode=null;h.password=null;h.confirmPassword=null;h.step="generate_reset_code";h.changePassword=function(){if(h.password!=h.confirmPassword)h.error=
"Passwords do not match!";else{h.busy=true;c.changePassword(h.userId,h.resetCode,h.password).then(function(){h.busy=false;h.error=null;h.step="success";setTimeout(function(){h.onLoginSuccess()},500)},function(b){h.busy=false;h.error=b=="invalid_password"?"Invalid password please try again":b?b:"Could not validate the reset code. Please try again."})}};h.generateResetCode=function(){h.busy=true;c.generateResetCode(h.email).then(function(b){h.busy=false;h.error=null;h.userId=b.userId;h.resetEmail=b.resetEmail;
h.step="validate_reset_code"},function(b){h.busy=false;h.error=b=="invalid_email"?"Sorry, this email address is not registered.":b=="google_account"?"You used Google when creating your account. We are not able to change the password.":b=="facebook_account"?"You used Facebook when creating your account. We are not able to change the password.":b?"We are not able to change the password: "+b:"Could not initiate the recovery process. Please review your email address and try again."})};h.signIn=function(){g?
b.go("signIn"):f.open()};h.validateResetCode=function(){h.busy=true;c.validateResetCode(h.userId,h.resetCode).then(function(){h.busy=false;h.error=null;h.step="reset_password"},function(b){h.busy=false;h.error=b=="invalid_reset_code"?"Invalid reset code. Please find your code in the email you've received":b?b:"Could not validate the reset code. Please try again."})}}angular.module("common.account").factory("modalForgotPassword",b);b.$inject=["modal"];c.$inject=["$state","api","modalSignIn","useRoutes"]})();
(function(){function b(b){return{open:function(e){e=e!==void 0?e:{};return b.open({controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/common/account/modal-join.factory.html",locals:{options:{role:e.role!==void 0?e.role:null,source:e.source!==void 0?e.source:null,useRoutes:e.useRoutes!==void 0?e.useRoutes:false}}})}}}function c(b,c,f,g,h,j){var k=this,l=j.useRoutes;k.init=function(){j.role=="parent"?k.joinParent():j.role=="student"?k.joinStudent():j.role=="teacher"&&k.joinTeacher()};k.signIn=function(){l?
b.go("signIn"):h.open()};k.source=j.source;k.joinParent=function(){l?b.go("joinParent"):c.open()};k.joinStudent=function(c){l?b.go("joinStudent",c):f.open(c)};k.joinTeacher=function(){l?b.go("joinTeacher"):g.open()};k.init()}angular.module("common.account").factory("modalJoin",b);b.$inject=["modal"];c.$inject=["$state","modalJoinParent","modalJoinStudent","modalJoinTeacher","modalSignInSelectRole","options"]})();
(function(){function b(b){return{open:function(e){e=e!==void 0?e:{};return b.open({controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/common/account/modal-join-parent.factory.html",locals:{campaign:e.campaign,email:e.email,fireRemarketingTag:e.fireRemarketingTag,source:e.source,useRoutes:e.useRoutes}})}}}function c(b,c,f,g,h,j,k,l,m,n,q,p,s){var r=this;r.addUser=function(){r.loading=true;return g.addUser(r.user).then(function(){r.onLoginSuccess();try{f.optimizely=f.optimizely||[];f.optimizely.push(["trackEvent",
user.role+"_account_created"])}catch(b){console.log(b)}},function(b){r.step=r.steps[0];r.error=b;r.loading=false})};r.facebookLogin=function(b){b=b!==void 0?b:{};b.source=b.source!==void 0?b.source:"join";h.facebookLogin(b).then(function(){r.onLoginSuccess()},function(b){r.error=b})};r.googleLogin=function(b){b=b!==void 0?b:{};b.source=b.source!==void 0?b.source:"join";h.googleLogin(b).then(function(){r.onLoginSuccess()},function(b){r.error=b})};r.hasPrevious=function(){return r.steps.indexOf(r.step)>
-1};r.hasNext=function(){return r.steps.indexOf(r.step)+1<r.steps.length};r.init=function(){r.loading=true;g.getAddUserFlash().then(function(b){r.error=b.error;if(b.user){if(b.user.username)r.user.username=b.user.username;if(b.user.password){r.user.password=b.user.password;r.user.confirm_password=b.user.password}if(b.user.fname)r.user.fname=b.user.fname;if(b.user.lname)r.user.lname=b.user.lname}r.loading=false},function(b){r.error=b;r.loading=false});q&&f.google_trackConversion({google_conversion_id:981959151,
google_custom_params:f.google_tag_params,google_remarketing_only:true})};r.join=function(){s?c.go("join"):j.open({campaign:m,email:n,fireRemarketingTag:q,source:p})};r.joinStudent=function(){s?c.go("joinStudent"):k.open({campaign:m,email:n,fireRemarketingTag:q,source:p})};r.next=function(){var b=r.steps.indexOf(r.step);b==r.steps.length-1?r.addUser():r.step=r.steps[b+1]};r.onLoginSuccess=function(b){angular.element(document).trigger("common.account.loggedIn",[b])};r.previous=function(){var b=r.steps.indexOf(r.step);
b==0&&r.join();r.step=r.steps[b-1]};r.setShowTynkerSignup=function(c){r.showTynkerSignup=c;b(function(){$.modal.resize()})};r.signIn=function(){s?c.go("signIn"):l.open({role:"parent"})};r.showPassword=false;r.showTynkerSignup=false;r.steps=["account","details"];r.step="account";r.user={campaign:m!==void 0?m:null,username:n,role:"parent",log_in:true,convert:true,source:p!==void 0?p:"join"};r.init()}angular.module("common").factory("modalJoinParent",b);b.$inject=["modal"];c.$inject=["$timeout","$state",
"$window","api","externalAuth","modalJoin","modalJoinStudent","modalSignIn","campaign","email","fireRemarketingTag","source","useRoutes"]})();
(function(){function b(b){return{open:function(e){var e=e!==void 0?e:{},f=e.activitySlug,g=e.skinId,h=e.source,j=e.useRoutes,k=e.unlockMessage,l="/js/ng-app/common/account/modal-join-student.factory.html";e.templateModifier?l="/js/ng-app/common/account/modal-join-student-"+e.templateModifier+".factory.html":e.activitySlug&&(l="/js/ng-app/common/account/modal-join-student-puzzles.factory.html");return b.open({closeOnClick:e.closeOnClick,closeOnEsc:e.closeOnEsc,controller:c,controllerAs:"vm",templateUrl:l,
locals:{activitySlug:f,skinId:g,source:h,useRoutes:j,unlockMessage:k}})}}}function c(b,c,f,g,h,j,k,l,m,n,q,p,s,r){var o=this;o.activitySlug=n;o.addUser=function(){o.loading=true;var b=JSON.parse(JSON.stringify(o.user));if(b.age>=13){delete b.parent_name;delete b.parent_email}else delete b.email;return h.addUser(b).then(function(){o.onLoginSuccess();try{g.optimizely=g.optimizely||[];g.optimizely.push(["trackEvent",b.role+"_account_created"])}catch(c){console.log(c)}},function(b){o.step=o.steps[0];
o.error=b;o.loading=false})};o.checkForBlockImgRender=function(){$(".canvas-frame-modal").length>0?o.skinId?setupBlockViewer(o.skinId,o.skinId,{},".canvas-frame-modal"):window.g_paramData&&setupBlockViewer(g_paramData.id,g_paramData.blockid,g_paramData.blockData,".canvas-frame-modal"):setTimeout(o.checkForBlockImgRender,1E3)};o.checkForEntityImgRender=function(){$(".canvas-frame-modal").length>0?o.skinId?setupEntityViewer(o.skinId,".canvas-frame-modal"):window.g_paramData&&setupEntityViewer(g_paramData.model,
g_paramData.imageid,g_paramData.dist,".canvas-frame-modal"):setTimeout(o.checkForEntityImgRender,1E3)};o.checkForItemImgRender=function(){$(".canvas-frame-modal").length>0?o.skinId?setupItemViewer(o.skinId,o.skinId,[],".canvas-frame-modal"):window.g_paramData&&setupItemViewer(g_paramData.id,g_paramData.itemid,g_paramData.itemData,".canvas-frame-modal"):setTimeout(o.checkForItemImgRender,1E3)};o.checkForSkinImgRender=function(){$(".canvas-frame-modal").length>0?o.skinId?setupSkinViewer(o.skinId,".canvas-frame-modal"):
window.g_paramData&&setupSkinViewer(g_paramData.skinid,".canvas-frame-modal"):setTimeout(o.checkForSkinImgRender,1E3)};o.skinId=q;o.activity=null;o.generateUsernameAvatar=function(){o.generateUsername();o.generateAvatar()};o.generateUsername=function(){m.fetchRandom().then(function(b){o.user.username=b})};o.generateAvatar=function(){o.selectAvatar(j.getRandom())};o.googleLogin=function(){var b={role:o.user.role};if(o.user.campaign)b.campaign=o.user.campaign;if(o.user.source)b.source=o.user.source;
k.googleLogin(b)};o.hasNext=function(){return o.steps.indexOf(o.step)+1<o.steps.length};o.hasPrevious=function(){return o.steps.indexOf(o.step)>0};o.init=function(){c.$watch("step",function(){$(".tipsy").remove();b(function(){$.modal.resize()})});c.$watch("activitySlug",function(){if(o.user.sourceActivity=o.activitySlug){o.isLoading=true;o.activity={slug:o.activitySlug,title:o.activitySlug.replace(/-/g," ")};h.getActivity(o.activitySlug).then(function(b){o.isLoading=false;o.activity=b},function(){o.isLoading=
false})}else o.activity=null});o.loading=true;h.getUser().then(function(f){if(f.user){o.user.preferences.avatar=f.user.preferences.avatar;o.user.preferences["user-avatar"]=f.user.preferences["user-avatar"]}o.hasAvatarChooser&&AvatarChooser.init();o.hasAvatarChooser&&c.$watch("userAvatarCharacter",function(){if(o.userAvatarCharacter){var c=o.userAvatarCharacter.type,e=o.userAvatarCharacter.parts,f=angular.element(".avatar-selector-current");b(function(){AvatarChooser.showAvatar(c,e,f)})}});o.user.preferences["user-avatar"]||
o.generateAvatar();$(".editor .skin").length>0?o.loadSkinViewer():$(".editor .item").length>0?o.loadItemViewer():$(".editor .block").length>0?o.loadBlockViewer():$(".editor .entity").length>0&&o.loadEntityViewer();o.loading=false})};o.isLoading=false;o.loadBlockViewer=function(){$.getScript("/minecraft/js/blockviewer.js").done(function(){o.checkForBlockImgRender()})};o.loadEntityViewer=function(){$.getScript("/minecraft/js/entityviewer.js").done(function(){o.checkForEntityImgRender()})};o.loadItemViewer=
function(){$.getScript("/minecraft/js/itemviewer.js").done(function(){o.checkForItemImgRender()})};o.loadSkinViewer=function(){$.getScript("/minecraft/js/skinviewer.js").done(function(){o.checkForSkinImgRender()})};o.next=function(){var b=o.steps.indexOf(o.step);b==o.steps.length-1?o.addUser():o.step=o.steps[b+1]};o.onLoginSuccess=function(b){angular.element(document).trigger("common.account.loggedIn",[b])};o.previous=function(){var b=o.steps.indexOf(o.step);b==0?o.activitySlug?f.go("joinUnlock",
{activitySlug:o.activitySlug}):f.go("join"):o.step=o.steps[b-1]};o.selectAvatar=function(b){o.user.preferences.avatar=b;if(b=j.mapCharacter(b)){o.user.preferences["user-avatar"]=JSON.stringify(b);o.userAvatarCharacter=b}else{o.user.preferences["user-avatar"]=null;o.userAvatarCharacter=null}};o.setShowTynkerSignup=function(c){o.showTynkerSignup=c;b(function(){$.modal.resize()})};o.signInStudent=function(){s?f.go("signInStudent"):l.open({role:"student",useRoutes:s})};o.user={age:null,preferences:{avatar:null,
"user-avatar":null},role:"student",log_in:true,convert:true,source:p?p:"join",sourceActivity:o.activitySlug};o.showPassword=true;o.safeUsernames=[];o.safeUsernameIndex=0;o.steps=["profile","consent_contact"];o.step="profile";o.avatarChoices=j.getAll();o.lockedAvatarChoices=j.getLocked();o.userAvatarCharacter=null;o.hasAvatarChooser=false;o.hasProfileIcon=false;o.showTynkerSignup=false;o.unlockMessage=r;o.init()}angular.module("common").factory("modalJoinStudent",b);b.$inject=["modal"];c.$inject=["$timeout",
"$scope","$state","$window","api","avatar","externalAuth","modalSignIn","username","activitySlug","skinId","source","useRoutes","unlockMessage"]})();
(function(){function b(b){return{open:function(e){var e=e!==void 0?e:{},f=e.campaign,g=e.source;return b.open({controller:c,controllerAs:"vm",templateUrl:g=="camp"?"/js/ng-app/common/account/modal-join-teacher-camp.factory.html":f=="edcamp"?"/js/ng-app/common/account/modal-join-teacher-campaign-edcamp.factory.html":"/js/ng-app/common/account/modal-join-teacher.factory.html",locals:{campaign:f,email:e.email,fireRemarketingTag:e.fireRemarketingTag,source:g,useRoutes:e.useRoutes}})}}}function c(b,c,
f,g,h,j,k,l,m,n,q,p,s){var r=this;r.addUser=function(){r.loading=true;return g.addUser(r.user).then(function(){r.onLoginSuccess();try{f.optimizely=f.optimizely||[];f.optimizely.push(["trackEvent",user.role+"_account_created"])}catch(b){console.log(b)}},function(b){r.step=r.steps[0];r.error=b;r.loading=false})};r.facebookLogin=function(){var b={role:r.user.role};if(r.user.campaign)b.campaign=r.user.campaign;if(r.user.source)b.source=r.user.source;h.facebookLogin(b).then(function(){r.onLoginSuccess()},
function(b){r.error=b})};r.googleLogin=function(){var b={role:r.user.role};if(r.user.campaign)b.campaign=r.user.campaign;if(r.user.source)b.source=r.user.source;h.googleLogin(b).then(function(){r.onLoginSuccess()},function(b){r.error=b})};r.hasPrevious=function(){return r.steps.indexOf(r.step)>-1};r.hasNext=function(){return r.steps.indexOf(r.step)+1<r.steps.length};r.init=function(){r.loading=true;g.getAddUserFlash().then(function(b){r.error=b.error;if(b.user){if(b.user.username)r.user.username=
b.user.username;if(b.user.password){r.user.password=b.user.password;r.user.confirm_password=b.user.password}if(b.user.fname)r.user.fname=b.user.fname;if(b.user.lname)r.user.lname=b.user.lname}r.loading=false},function(b){r.error=b;r.loading=false});q&&f.google_trackConversion({google_conversion_id:981959151,google_custom_params:f.google_tag_params,google_remarketing_only:true})};r.joinStudent=function(){s?c.go("joinStudent"):k.open()};r.next=function(){var b=r.steps.indexOf(r.step);b==r.steps.length-
1?r.addUser():r.step=r.steps[b+1]};r.onLoginSuccess=function(b){angular.element(document).trigger("common.account.loggedIn",[b])};r.previous=function(){var b=r.steps.indexOf(r.step);b==0?s?c.go("join"):j.open():r.step=r.steps[b-1]};r.setShowTynkerSignup=function(c){r.showTynkerSignup=c;b(function(){$.modal.resize()})};r.signIn=function(){s?c.go("signIn"):l.open({role:"teacher"})};r.showPassword=false;r.showTynkerSignup=false;r.steps=["account","profile"];r.step="account";r.user={campaign:m!==void 0?
m:null,username:n,role:"teacher",log_in:true,convert:true,source:p!==void 0?p:"join"};r.init()}angular.module("common").factory("modalJoinTeacher",b);b.$inject=["modal"];c.$inject=["$timeout","$state","$window","api","externalAuth","modalJoin","modalJoinStudent","modalSignIn","campaign","email","fireRemarketingTag","source","useRoutes"]})();
(function(){function b(b){return{open:function(e){e=e!==void 0?e:{};return b.open({controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/common/account/modal-sign-in.factory.html",locals:{next:e.next!==void 0?e.next:null,role:e.role!==void 0?e.role:null,useRoutes:e.useRoutes!==void 0?e.useRoutes:false}})}}}function c(b,c,f,g,h,j,k,l,m){var n=this;n.busy=false;n.error=null;n.role=l;n.user={};n.facebookLogin=function(b){b=b!==void 0?b:{};if(!b.next&&k)b.next=k;g.facebookLogin(b).then(function(){n.onLoginSuccess(k)},
function(b){n.error=b})};n.forgotPassword=function(){m?b.go("forgotPassword"):h.open()};n.googleLogin=function(b){b=b!==void 0?b:{};if(!b.next&&k)b.next=k;g.googleLogin(b).then(function(){n.onLoginSuccess(k)},function(b){n.error=b})};n.join=function(){m?b.go("join"):j.open()};n.login=function(){n.busy=true;f.login(n.user.u,n.user.p).then(function(){n.onLoginSuccess(k)},function(b){n.busy=false;n.error=b})};n.onLoginSuccess=function(b){angular.element(document).trigger("common.account.loggedIn",[b])}}
angular.module("common.account").factory("modalSignIn",b);b.$inject=["modal"];c.$inject=["$state","$window","api","externalAuth","modalForgotPassword","modalJoin","next","role","useRoutes"]})();
(function(){function b(b){return{open:function(e){e=e!==void 0?e:{};return b.open({controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/common/account/modal-sign-in-select-role.factory.html",locals:{useRoutes:e.useRoutes!=="undefined"?e.useRoutes:false}})}}}function c(b,c,f,g){this.join=function(){g?b.go("join"):c.open()};this.signInParent=function(){g?b.go("signInParent"):f.open({role:"parent"})};this.signInStudent=function(){g?b.go("signInStudent"):f.open({role:"student"})};this.signInTeacher=
function(){g?b.go("signInTeacher"):f.open({role:"teacher"})}}angular.module("common.account").factory("modalSignInSelectRole",b);b.$inject=["modal"];c.$inject=["$state","modalJoin","modalSignIn","useRoutes"]})();
(function(){function b(b,d,e){var f=this;f.showStarted=d;f.showCompleted=e;f.hocStartedImageUrl="/image/certificate-thumbnail/certificate-getting-started.jpg";f.hocCompletedImageUrl="/image/certificate-thumbnail/certificate-hoc-2016.jpg";f.suggestedActivities=[];f.loading=false;f.missingStarted=0;f.missingCompleted=0;f.missing=0;f.init=function(){f.loading=true;b.hocGetStatus().then(function(b){f.suggestedActivities=b.suggested_activities;f.missingStarted=b.missing_started;f.missingCompleted=b.missing_completed;
if(f.showStarted)f.missing=f.missingStarted;else if(f.showCompleted)f.missing=f.missingCompleted;f.loading=false})};f.init()}angular.module("common.account").factory("modalStudentCertificateEarn",["api","modal",function(c,d){return{open:function(c,f){return d.open({controller:b,controllerAs:"vm",locals:{showStarted:c,showCompleted:f},templateUrl:"/js/ng-app/common/account/modal-student-certificate-earn.factory.html"})}}}]);b.$inject=["api","showStarted","showCompleted"]})();
(function(){function b(b,d,e,f,g,h,j,k,l,m,n){var q=this;q.activitySlug=e.activitySlug?e.activitySlug:null;q.skinId=e.skinId?e.skinId:null;q.activity=null;q.isLoading=false;q.user={age:null,preferences:{avatar:null,"user-avatar":null},role:"student",log_in:true,convert:true,source:"join",sourceActivity:q.activitySlug};q.showPassword=true;q.safeUsernames=[];q.safeUsernameIndex=0;q.steps=["personalize","share","profile","consent_contact"];q.step=null;q.avatarChoices=h.getAll();q.lockedAvatarChoices=
h.getLocked();q.userAvatarCharacter=null;q.hasAvatarChooser=false;q.hasProfileIcon=false;q.showTynkerSignup=false;q.hocStarted=false;q.hocCompleted=false;q.hocCertificateId=null;q.hocStartedVisible=false;q.hocCompletedVisible=false;q.hocStartedImageUrl="/image/certificate-thumbnail/certificate-getting-started.jpg";q.hocCompletedImageUrl="/image/certificate-thumbnail/certificate-hoc-2016.jpg";q.hocParentEmail=null;q.hocShareEmail="";q.hocShareEmailEditable=true;q.hocStartedShared=false;q.hocCompletedShared=
false;q.hocSharingCertificate=false;q.hocPersonalizingCertificate=false;q.name="";q.anonymous=false;q.loggedIn=false;q.init=function(){q.hasAvatarChooser&&AvatarChooser.init();b.$watch("step",function(){$(".tipsy").remove();f(function(){$.modal.resize()})});b.$watch("activitySlug",function(){if(q.user.sourceActivity=q.activitySlug){q.isLoading=true;q.activity={slug:q.activitySlug,title:q.activitySlug.replace(/-/g," ")};g.getActivity(q.activitySlug).then(function(b){q.isLoading=false;q.activity=b},
function(){q.isLoading=false})}else q.activity=null});q.hasAvatarChooser&&b.$watch("userAvatarCharacter",function(){if(q.userAvatarCharacter){var b=q.userAvatarCharacter.type,c=q.userAvatarCharacter.parts,d=angular.element(".avatar-selector-current");f(function(){AvatarChooser.showAvatar(b,c,d)})}});q.generateAvatar();$(".editor .skin").length>0?q.loadSkinViewer():$(".editor .item").length>0?q.loadItemViewer():$(".editor .block").length>0?q.loadBlockViewer():$(".editor .entity").length>0&&q.loadEntityViewer();
g.hocGetStatus().then(function(b){q.hocStarted=b.started;q.hocCompleted=b.completed;q.hocCertificateId=b.certificate_id;q.hocCertificateType=b.certificate_type;q.name=b.full_name;q.anonymous=b.anonymous;q.loggedIn=b.logged_in;q.hocParentEmail=b.parent_email;if(!q.hocParentEmail)q.hocParentEmail="";q.step=!q.name?"personalize":"share";q.hocStartedVisible=q.hocCompleted?false:l;q.hocCompletedVisible=q.hocCompleted?m:false;if(!q.hocStartedVisible&&!q.hocCompletedVisible)q.hocStartedVisible=true;q.hocShareEmailEditable=
q.hocParentEmail?false:true;q.hocShareEmail=q.hocParentEmail})};q.generateUsernameAvatar=function(){q.generateUsername();q.generateAvatar()};q.generateUsername=function(){k.fetchRandom().then(function(b){q.user.username=b})};q.generateAvatar=function(){q.selectAvatar(h.getRandom())};q.loadSkinViewer=function(){$.getScript("/minecraft/js/skinviewer.js").done(function(){q.checkForSkinImgRender()})};q.checkForSkinImgRender=function(){$(".canvas-frame-modal").length>0?q.skinId?setupSkinViewer(q.skinId,
".canvas-frame-modal"):window.g_paramData&&setupSkinViewer(g_paramData.skinid,".canvas-frame-modal"):setTimeout(q.checkForSkinImgRender,1E3)};q.loadItemViewer=function(){$.getScript("/minecraft/js/itemviewer.js").done(function(){q.checkForItemImgRender()})};q.checkForItemImgRender=function(){$(".canvas-frame-modal").length>0?q.skinId?setupItemViewer(q.skinId,q.skinId,[],".canvas-frame-modal"):window.g_paramData&&setupItemViewer(g_paramData.id,g_paramData.itemid,g_paramData.itemData,".canvas-frame-modal"):
setTimeout(q.checkForItemImgRender,1E3)};q.loadBlockViewer=function(){$.getScript("/minecraft/js/blockviewer.js").done(function(){q.checkForBlockImgRender()})};q.checkForBlockImgRender=function(){$(".canvas-frame-modal").length>0?q.skinId?setupBlockViewer(q.skinId,q.skinId,{},".canvas-frame-modal"):window.g_paramData&&setupBlockViewer(g_paramData.id,g_paramData.blockid,g_paramData.blockData,".canvas-frame-modal"):setTimeout(q.checkForBlockImgRender,1E3)};q.loadEntityViewer=function(){$.getScript("/minecraft/js/entityviewer.js").done(function(){q.checkForEntityImgRender()})};
q.checkForEntityImgRender=function(){$(".canvas-frame-modal").length>0?q.skinId?setupEntityViewer(q.skinId,".canvas-frame-modal"):window.g_paramData&&setupEntityViewer(g_paramData.model,g_paramData.imageid,g_paramData.dist,".canvas-frame-modal"):setTimeout(q.checkForEntityImgRender,1E3)};q.previous=function(){var b=q.steps.indexOf(q.step);b==0?q.activitySlug?d.go("joinUnlock",{activitySlug:q.activitySlug}):d.go("join"):q.step=q.steps[b-1]};q.move=function(b){b=q.steps.indexOf(b);q.step=q.steps[b]};
q.next=function(){var b=q.steps.indexOf(q.step);q.step=="personalize"?q.name&&q.personalizeCertificate(function(){q.step=q.steps[b+1]}):q.step=="share"?q.hocShareEmail&&q.shareCertificate():q.step=="consent_contact"?q.signup():q.step=q.steps[b+1]};q.hasPrevious=function(){return q.steps.indexOf(q.step)>1};q.hasNext=function(){return q.steps.indexOf(q.step)+1<q.steps.length};q.selectAvatar=function(b){q.user.preferences.avatar=b;if(b=h.mapCharacter(b)){q.user.preferences["user-avatar"]=JSON.stringify(b);
q.userAvatarCharacter=b}else{q.user.preferences["user-avatar"]=null;q.userAvatarCharacter=null}};q.setShowTynkerSignup=function(b){q.showTynkerSignup=b;f(function(){$.modal.resize()})};q.showHocStarted=function(){q.hocCompletedVisible=false;q.hocStartedVisible=true};q.showHocCompleted=function(){q.hocStartedVisible=false;q.hocCompletedVisible=true};q.signup=function(){q.busy=true;return g.addUser(q.user).then(function(){n.sendEvent("Action","Signed Up","Certificates Redeem Modal: Signup");q.busy=
false;$(document).trigger("common.account.loggedIn")},function(b){q.busy=false;q.error=b})};q.shareCertificate=function(){q.hocSharingCertificate=true;var b=q.hocStartedVisible?"default":"2016";g.hocSendCertificate(b,q.hocShareEmail).then(function(){n.sendEvent("Action","Shared","Certificates Redeem Modal: Share");if(b=="default")q.hocStartedShared=true;if(b=="2016")q.hocCompletedShared=true;q.hocSharingCertificate=false},function(){q.hocSharingCertificate=false})};q.shareStartedAgain=function(){q.hocShareEmail=
"";q.hocStartedShared=false};q.shareCompletedAgain=function(){q.hocShareEmail="";q.hocCompletedShared=false};q.personalizeCertificate=function(b){q.hocPersonalizingCertificate=true;g.hocPersonalizeCertificate(q.name).then(function(){n.sendEvent("Action","Personalized","Certificates Redeem Modal: Personalize");q.hocPersonalizingCertificate=false;b?b():q.next()},function(){q.hocPersonalizingCertificate=false})};q.googleLogin=function(){j.googleLogin().then(function(){q.onLoginSuccess()},function(b){q.error=
b})};q.init()}angular.module("common.account").factory("modalStudentCertificateRedeem",["api","modal",function(c,d){return{open:function(c,f){return d.open({controller:b,controllerAs:"vm",locals:{initStarted:c,initCompleted:f},templateUrl:"/js/ng-app/common/account/modal-student-certificate-redeem.factory.html"})}}}]);b.$inject=["$scope","$state","$stateParams","$timeout","api","avatar","externalAuth","username","initStarted","initCompleted","googleAnalytics"]})();
(function(){function b(){return{controller:c,controllerAs:"vm",restrict:"A",link:function(b,c,f,g){c.click(function(){g.open({role:f.openModalJoin})})}}}function c(b){this.open=function(c){b.open(c)}}angular.module("common.account").directive("openModalJoin",b);b.$inject=[];c.$inject=["modalJoin"]})();
(function(){function b(){return{controller:c,controllerAs:"vm",restrict:"A",link:function(b,c,f,g){c.click(function(){g.open()})}}}function c(b){this.open=function(){b.open()}}angular.module("common.account").directive("openModalSignIn",b);b.$inject=[];c.$inject=["modalSignInSelectRole"]})();
(function(){function b(b,d,e,f){var g=this;g.facebookLogin=function(){f.facebookLogin({childConfCode:g.user.childConfCode,role:"parent",source:"verify-parent"}).then(function(){g.onLoginSuccess()},function(b){g.error=b})};g.googleLogin=function(){f.googleLogin({childConfCode:g.user.childConfCode,role:"parent",source:"verify-parent"}).then(function(){g.onLoginSuccess()},function(b){g.error=b})};g.hasNext=function(){return g.steps.indexOf(g.step)+1<g.steps.length};g.hasPrevious=function(){return g.steps.indexOf(g.step)>
0};g.init=function(d,f){e.ga("send","event","Sign-up Modal","Parent Verified Student");g.step="welcome";g.user.username=d;g.user.childConfCode=f;b.$watch("step",function(){angular.element("body").animate({scrollTop:0},"slow")})};g.next=function(){var b=g.steps.indexOf(g.step);b==g.steps.length-1?g.signupUser(g.user):g.step=g.steps[b+1]};g.previous=function(){var b=g.steps.indexOf(g.step);b==0?d.go("join"):g.step=g.steps[b-1]};g.setShowTynkerSignup=function(b){g.showTynkerSignup=b};g.showTynkerSignup=
false;g.steps=["welcome","account","details"];g.step=null;g.user={role:"parent",log_in:true,convert:true,confirmed:true,source:"verify-parent"}}angular.module("common.account").controller("ParentVerifyController",b);b.$inject=["$scope","$state","$window","externalAuth"]})();
(function(){function b(b,d,e){var f=this;f.activitySlug=d.activitySlug?d.activitySlug:null;f.activity=null;f.init=function(){b.$watch("activitySlug",function(){f.activitySlug?e.getActivity(f.activitySlug).then(function(b){f.activity=b}):f.activity=null})};f.init()}angular.module("common.account").controller("UnlockController",b);b.$inject=["$scope","$stateParams","api"]})();
(function(){angular.module("common.account").controller("VerifyEmailCtrl",["$scope","api",function(b,c){b.email=null;b.error=null;b.userId=null;b.busy=false;b.isEditing=false;b.firstEdit=true;b.init=function(d){b.userId=d;c.getMyEmail().then(function(c){b.email=c;b.error=null},function(c){b.email="Could not retrieve email";b.error="Problem retrieving email: "+c;b.busy=true})};b.resend=function(){b.busy=true;c.resendVerificationEmail(b.userId,b.email).then(function(){b.busy=false;b.error=null;b.notice=
"Sent!";b.isEditing=false},function(c){b.busy=false;b.error=c})};b.edit=function(){b.isEditing=true;b.firstEdit=false;b.error=false;b.notice=false}}])})();
(function(){function b(b,d,e,f,g,h,j,k,l){var m=this;m.areControlsVisible=false;m.createdOnDate=m.project.createdOn?new Date(m.project.createdOn*1E3):null;m.enableOptions=m.enableOptions!==void 0?m.enableOptions:true;m.enableLike=m.enableLike!==void 0?m.enableLike:true;m.enableShare=true;m.init=function(){};m.like=function(){m.project.userLiked||(m.project.projectActivity?f.likeProjectActivity(m.project.cid).then(function(){m.project.userLiked=true;m.project.likes=m.project.likes+1}):f.communityProjects.like(m.project.cid).then(function(){m.project.userLiked=
true;m.project.likes=m.project.likes+1}))};m.onMouseleave=function(){if(m.areControlsVisible)m.areControlsVisible=false};m.play=function(){j(m.project,{embeddedShowViewCode:true,enableGoToProjectPage:true,enableOpen:false,enableSharing:true,showProjectConcepts:true,showProjectInformation:true,projects:m.projects})};m.remix=function(){e.location="/ide?p="+m.project.id};m.report=function(){m.project.projectActivity?h.confirm('You can report projects that use bad words, contain personal information, or are rude or mean. Are you sure you want to report <strong>"'+
m.project.name+'"</strong>?').then(function(){f.reportProject(m.project.id).then(function(){b.$emit("projectReported",m.project);g("We will review this project based on our publishing guidelines.","Thank you for your feedback")})}):l.confirm("project",m.project).then(function(){b.$emit("projectReported",m.project)})};m.share=function(){k(m.project.id,m.project.name)};m.toggleControls=function(b){m.areControlsVisible=!m.areControlsVisible;if(m.areControlsVisible)angular.element("body").one("click",
function(){d(function(){m.areControlsVisible=false})});b.stopPropagation()};m.unlike=function(){m.project.userLiked&&(m.project.projectActivity?f.unlikeProjectActivity(m.project.cid).then(function(){m.project.userLiked=false;m.project.likes=m.project.likes-1}):f.communityProjects.unlike(m.project.cid).then(function(){m.project.userLiked=false;m.project.likes=m.project.likes-1}))};m.getPublisherName=function(){if(m.project.publisherName)return m.project.publisherName;var b=m.project.username,c=b.indexOf("@");
return c==-1?b:b.slice(0,c)};m.isFeatured=function(){return m.forceFeatured!=null?m.forceFeatured:false};m.init()}angular.module("common.projects").directive("communityProject",function(){return{bindToController:{project:"=",enableLike:"=?",enableOptions:"=?",forceFeatured:"=?"},controller:b,controllerAs:"vm",restrict:"E",scope:{},templateUrl:"/js/ng-app/common/projects/community-project.directive.html"}}).directive("communityProjectOld",function(){return{bindToController:{project:"=",projects:"=?",
enableLike:"=?",enableOptions:"=?"},controller:b,controllerAs:"vm",restrict:"E",scope:{},templateUrl:"/js/ng-app/common/projects/community-project-old.directive.html"}});b.$inject=["$scope","$timeout","$window","api","modalAlert","modalConfirm","modalPlayProject","modalShareProject","modalReportCommunityAsset"]})();
(function(){function b(b,d,e,f,g,h,j){var k=this;k.areControlsVisible=false;k.createdOnDate=k.notebook.createdOn?new Date(k.notebook.createdOn*1E3):null;k.enableOptions=k.enableOptions!==void 0?k.enableOptions:true;k.enableLike=k.enableLike!==void 0?k.enableLike:true;k.enableShare=true;k.getImageUrl=function(){return j(k.notebook)};k.init=function(){};k.like=function(){k.notebook.userLiked||f.communityNotebooks.like(k.notebook.cid).then(function(){k.notebook.userLiked=true;k.notebook.likes=k.notebook.likes+
1})};k.onMouseleave=function(){if(k.areControlsVisible)k.areControlsVisible=false};k.remix=function(){f.redirectExperienceTop("/nb/project/"+k.notebook.id+"/")};k.report=function(){h.confirm("notebook",k.notebook).then(function(){b.$emit("notebookReported",k.notebook)})};k.share=function(){g(k.notebook)};k.toggleControls=function(b){k.areControlsVisible=!k.areControlsVisible;if(k.areControlsVisible)angular.element("body").one("click",function(){d(function(){k.areControlsVisible=false})});b.stopPropagation()};
k.unlike=function(){k.notebook.userLiked&&+f.communityNotebooks.unlike(k.notebook.cid).then(function(){k.notebook.userLiked=false;k.notebook.likes=k.notebook.likes-1})};k.init()}angular.module("common.projects").directive("communityNotebook",function(){return{bindToController:{notebook:"=",enableLike:"=?",enableOptions:"=?"},controller:b,controllerAs:"vm",restrict:"E",scope:{},templateUrl:"/js/ng-app/common/projects/community-notebook.directive.html"}});b.$inject=["$scope","$timeout","$window","api",
"modalShareNotebook","modalReportCommunityAsset","renderNotebook"]})();
(function(){function b(b,e){return{confirm:function(f,g){return b(function(b,d){var k=false;e.open({controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/common/projects/modal-report-community-asset.factory.html",locals:{assetType:f,asset:g,resolve:function(){k=true;b()},reject:function(){d()}}}).closed.then(function(){k||d()})})}}}function c(b,c,f,g){var h=this;h.reason=null;h.asset=f;h.report=function(){c=="project"?b.communityProjects.report(h.asset.cid,h.reason).then(function(){h.reported=true;
g()}):c=="notebook"?b.communityNotebooks.report(h.asset.cid,h.reason).then(function(){h.reported=true;g()}):console.warn("Reporting not implemented for asset type '"+c+"'")};h.reported=false}angular.module("common.projects").factory("modalReportCommunityAsset",b);b.$inject=["$q","modal"];c.$inject=["api","assetType","asset","resolve","reject"]})();
(function(){function b(b,d,e,f,g,h,j){var k=this;k.addToHomeGallery=function(b){f.addToGallery(b.id,"home",null).then(function(){b.in_gallery=true},function(b){k.error=b})};k.areControlsVisible=false;k.confirmDelete=function(){g.confirm('Are you sure you want to delete <strong>"'+k.project.name+'"</strong>?').then(function(){f.deleteProject(k.project.id).then(function(){b.$emit("project.deleted",[k.project.id])},function(b){alert("Failed to remove project: "+b)})})};k.defaultAction=k.defaultAction!==
void 0?k.defaultAction:"play";k.enableLike=k.enableLike!==void 0?k.enableLike:false;k.enableOptions=k.enableOptions!==void 0?k.enableOptions:true;k.enablePublish=k.enablePublish!==void 0?k.enablePublish:false;k.enableToggleInHomeGallery=k.enableToggleInHomeGallery!==void 0?k.enableToggleInHomeGallery:false;k.enableView=k.enableView!==void 0?k.enableView:false;k.edit=function(){f.redirectExperienceTop("ide/?p="+k.project.id,k.editReturnUrl)};k.getLikesString=function(){var b=k.project.likes;if(b<
1E3)return b;b=(b/100).toFixed(1);b.endsWith(".0")&&(b=b.slice(0,b.length-2));return b+"k"};k.getViewsString=function(){var b=k.project.views;if(b<1E3)return b;b=(b/100).toFixed(1);b.endsWith(".0")&&(b=b.slice(0,b.length-2));return b+"k"};k.like=function(){k.enableLike&&(k.project.userLiked||f.communityProjects.like(k.project.id).then(function(){k.project.userLiked=true;k.project.likes=k.project.likes+1}))};k.onClick=function(){k.defaultAction=="edit"?k.edit():k.play()};k.onMouseleave=function(){if(k.areControlsVisible)k.areControlsVisible=
false};k.play=function(){h(k.project,{enableEdit:true,enableLike:false,enableRemix:false,enableReport:false,showProjectInformation:true})};k.publish=function(){k.share()};k.removeFromHomeGallery=function(b){f.removeFromGallery("home",null,b.id,null).then(function(){b.in_gallery=false},function(b){k.error=b})};k.share=function(){j(k.project.id,k.project.name,k.project.published)};k.showLikes=true;k.showViews=true;k.toggleControls=function(b){k.areControlsVisible=!k.areControlsVisible;if(k.areControlsVisible)angular.element("body").one("click",
function(){d(function(){k.areControlsVisible=false})});b.stopPropagation()};k.togglePublish=function(){k.project.published?k.unpublish():k.publish()};k.unlike=function(){k.enableLike&&k.project.userLiked&&f.communityProjects.unlike(k.project.id).then(function(){k.project.userLiked=false;k.project.likes=k.project.likes-1})};k.unpublish=function(){e.ga("send","event","Project Card","Unshare","Community");k.busy=true;f.unshareFromCommunity(k.project.id).then(function(){k.busy=false;k.error="";k.success=
"Successfully unpublished!";k.project.published=false;b.$emit("project.unpublished",[k.project.id])},function(b){k.busy=false;k.success="";k.error=b})}}angular.module("common.projects").directive("projectCard",function(){return{bindToController:{defaultAction:"@?",editReturnUrl:"=?",enableLike:"=?",enableOptions:"=?",enablePublish:"=?",enableToggleInHomeGallery:"=?",enableView:"=?",project:"=",userId:"@",userAvatar:"@"},controller:b,controllerAs:"vm",restrict:"E",scope:{},templateUrl:"/js/ng-app/common/projects/project-card.directive.html"}}).directive("projectCardOld",
function(){return{bindToController:{enablePublish:"=?",enableToggleInHomeGallery:"=?",project:"=",userId:"@",userAvatar:"@"},controller:b,controllerAs:"vm",restrict:"E",scope:{},templateUrl:"/js/ng-app/common/projects/project-card-old.directive.html"}});b.$inject=["$rootScope","$timeout","$window","api","modalConfirm","modalPlayProject","modalShareProject"]})();
(function(){function b(b){this.report=function(d,e){return b.confirm(d,e)}}angular.module("common.projects").directive("reportCommunityAsset",function(){return{controller:b,restrict:"A",link:function(b,d,e,f){d.click(function(){f.report(e.assetType,{cid:e.reportCommunityAsset}).then(function(){d.parents(".project-card").detach()})})}}});b.$inject=["modalReportCommunityAsset"]})();
(function(){function b(b,d,e,f,g){var h=this;h.activity=f;h.busy=false;h.done=function(){h.rate().then(function(){g()})};h.rating={};h.rate=function(){return b(function(b,c){e.rateActivity(h.activity.type,h.activity.id,h.rating).then(function(){h.busy=false;h.sent=true;b()},function(){h.busy=false;h.error="Problem sending feedback";c()})})};h.rateOverall=function(b){d.ga("send","event","Rate Activity Modal","Rate",h.activity.title,b);h.rating.overall=b;h.rate()}}angular.module("common.rating").factory("modalRateActivity",
["$q","$window","api","modal",function(c,d,e,f){return function(e){return c(function(c,j){var k=f.open({controller:b,controllerAs:"vm",templateUrl:"/js/ng-app/common/rating/modalRateActivity.factory.html",locals:{activity:e,resolve:c}});k.opened.then(function(){d.ga("send","event","Rate Activity Modal","Open",e.title)});k.closed.then(function(){d.ga("send","event","Rate Activity Modal","Close",e.title);j()})})}}]);b.$inject=["$q","$window","api","activity","resolve"]})();
(function(){angular.module("common.rating").directive("rateActivity",["$window",function(b){return{controller:["modalRateActivity",function(b){var d=this;d.doneUrl=null;d.setDoneUrl=function(b){d.doneUrl=b};d.open=function(e,f,g){b({type:e,id:f,title:g}).then(function(){window.location=d.doneUrl},function(){window.location=d.doneUrl})}}],restrict:"A",link:function(c,d,e,f){d.unbind("click");d.click(function(c){c.preventDefault();c.stopPropagation();var d=e.activityId?e.activityId:null;if(!d&&b.IDE&&
b.IDE.currentProjectId)d=b.IDE.currentProjectId;if(!d&&b.WinLessons&&b.WinLessons.lessonId)d=b.WinLessons.lessonId;var j=e.activityTitle!=void 0?e.activityTitle:null;if(!j&&b.IDE&&b.IDE.currentProjectName)j=b.IDE.currentProjectName;var k=angular.element(".editor-title > h1");k.size()&&(j=k.text().trim());j||(j="this activity");c.delegateTarget?f.setDoneUrl($(c.delegateTarget).attr("href")):f.setDoneUrl(e.href);f.open(e.rateActivity,d,j)})}}}])})();
(function(){angular.module("common.sharing").controller("PuzzleSharingCtrl",["$scope","$http","$location",function(b,c,d){b.shareUrl=null;b.screenShot=null;b.facebookAppId=null;b.imageKey=null;b.init=function(c){b.facebookAppId=c};b.show=function(c,d,g){b.puzzleTitle=c;b.shareUrl=d;b.screenShot=g;$("#sharing").modal()};b.hide=function(){$.modal.close()};b.reset=function(){b.error=null;b.success=null};b.facebookShare=function(){shareFacebook(b.shareUrl,{appId:b.facebookAppId,serverName:d.host()})};
b.twitterShare=function(){shareTwitter(b.shareUrl,"I enjoyed solving "+b.puzzleTitle+", a coding puzzle. Try it here",{serverName:d.host(),hashTags:"hourofcode,tynker"})};b.googlePlusShare=function(){shareGooglePlus(b.shareUrl,{serverName:d.host()})}}])})();
(function(){angular.module("common.sharing").directive("shareNotebook",function(){return{controller:["modalShareNotebook",function(b){this.share=function(c,d){b({id:c,name:d})}}],restrict:"A",link:function(b,c,d,e){c.click(function(){e.share(d.shareNotebook,d.notebookName)})}}})})();
(function(){angular.module("common.sharing").directive("shareProject",[function(){return{controller:["modalShareProject",function(b){this.share=function(c,d){b(c,d)}}],restrict:"A",link:function(b,c,d,e){c.click(function(){e.share(d.shareProject,d.projectName)})}}}])})();
(function(){angular.module("common.sharing").controller("ShareAssetPopupCtrl",["$scope","$http","$location","$window","api",function(b,c,d,e,f){function g(b){b=b.trim().toLowerCase();b=b.replace(/[^a-zA-Z0-9]/g,"-");(b=b.replace(/--+/g,"-"))||(b="default");return b}function h(b,c,d,e){switch(b){case "skin":return"/minecraft/skins/view/"+g(d)+"/"+c;case "item":return"/minecraft/texture-packs/items/view/"+e+"/"+g(d)+"/"+c;case "block":return"/minecraft/texture-packs/blocks/view/"+e+"/"+g(d)+"/"+c;case "entity":return"/minecraft/texture-packs/mobs/view/"+
e+"/"+g(d)+"/"+c}}function j(b,c){switch(b){case "skin":return"/minecraft/api/skin?id="+c+"&w=40&h=35";case "block":return"/minecraft/api/block?id="+c+"&w=40&h=35";case "item":return"/minecraft/api/item?id="+c+"&w=40&h=35";case "entity":if(e.g_entityCapture)return e.g_entityCapture();default:return null}}b.assetId=null;b.assetName=null;b.assetTitle=null;b.assetType=null;b.assetImage=null;b.shared=false;b.captchaCode=null;b.captchaRandom=null;b.currentTab=null;b.tabs={};b.serverName=null;b.busy=false;
b.generateCaptcha=function(){b.captchaRandom="/api/captcha?r="+Math.random();b.captchaCode=null};b.init=function(c,e,f,g,h){b.facebookAppId=c;b.serverName=d.host();if(e=="student"&&!f){b.tabs={community:"Community"};b.currentTab="community";if(g||h)b.tabs.connections="Connected to Me"}else{b.tabs={social:"Social"};b.currentTab="social"}};b.show=function(c,d,g,n,q){e.ga("send","event","Minecraft Share Modal","Open",c=="entity"?"mob":c);b.error="";b.success="";b.assetId=d;b.assetName=q;b.assetTitle=
g;b.assetType=c;b.assetImage=n?n:j(c,d);b.assetShareUrl="https://"+b.serverName+h(c,d,g,q);b.generateCaptcha();c=="entity"?f.saveImage(d,b.assetImage).then(function(){$("#share-asset-popup").modal()},function(){$("#share-asset-popup").modal()}):$("#share-asset-popup").modal()};b.hide=function(){$.modal.close()};b.reset=function(){b.error=null;b.success=null};b.setCurrentTab=function(c){b.currentTab=c};b.communityShare=function(){e.ga("send","event","Minecraft Share Modal","Share","Community");b.busy=
true;f.shareAssetToCommunity(b.assetType,b.assetId).then(function(){b.busy=false;b.error="";b.success="Successfully published!";b.shared=true},function(c){b.busy=false;b.success="";b.error=c})};b.communityUnshare=function(){e.ga("send","event","Minecraft Share Modal","Unshare","Community");b.busy=true;f.unshareAssetFromCommunity(b.assetType,b.assetId).then(function(){b.busy=false;b.error="";b.success="Successfully unpublished!";b.shared=false},function(c){b.busy=false;b.success="";b.error=c})};b.emailParent=
function(){e.ga("send","event","Minecraft Share Modal","Share","Email Parent");b.busy=true;f.sendMinecraftAssetEmail(b.assetId).then(function(){b.busy=false;b.error="";b.success="Shared successfully!"},function(c){b.busy=false;b.success="";b.error=c})};b.emailShare=function(){e.ga("send","event","Minecraft Share Modal","Share","Email");b.busy=true;f.sendMinecraftAssetEmail(b.assetId,b.displayName,b.email,b.captchaCode,b.assetShareUrl,b.assetImage).then(function(){b.busy=false;b.success="Shared successfully!"},
function(c){b.busy=false;b.error=c;b.generateCaptcha()})};b.facebookShare=function(){e.ga("send","event","Minecraft Share Modal","Share","Facebook");shareFacebook(b.assetShareUrl,{appId:b.facebookAppId,serverName:d.host()})};b.twitterShare=function(){e.ga("send","event","Minecraft Share Modal","Share","Twitter");shareTwitter(b.assetShareUrl,b.assetTitle,{serverName:d.host(),hashTags:"tynker,minecraft,"+(b.assetType=="entity"?"mob":b.assetType)})};b.googlePlusShare=function(){e.ga("send","event","Minecraft Share Modal",
"Share","Google+");shareGooglePlus(b.assetShareUrl)}}])})();
(function(){angular.module("common.sharing").directive("shareBar",[function(){return{controller:["$scope",function(b){b.shareEmail=function(){shareEmail(b.text,b.url)};b.shareFacebook=function(){shareFacebook(b.url,{appId:b.facebookAppId})};b.shareGooglePlus=function(){shareGooglePlus(b.url)};b.shareTwitter=function(){shareTwitter(b.url,b.text,{serverName:b.serverName})}}],restrict:"E",scope:{facebookAppId:"@",serverName:"@",text:"=",url:"="},templateUrl:"/js/ng-app/common/sharing/shareBar.directive.html"}}])})();
(function(){angular.module("common.sharing").directive("sharePageEmail",[function(){return{controller:["$location","social",function(b,c){this.share=function(d,e,f){d=d?d:b.absUrl();c.shareEmail(e,f+("\n"+d))}}],restrict:"A",link:function(b,c,d,e){c.click(function(){e.share(d.url,d.subject,d.body)})}}}])})();
(function(){angular.module("common.sharing").directive("sharePageFacebook",[function(){return{controller:["$location","social",function(b,c){this.share=function(d){d=d?d:b.absUrl();c.shareFacebook(d)}}],restrict:"A",link:function(b,c,d,e){c.click(function(){e.share(d.url)})}}}])})();
(function(){angular.module("common.sharing").directive("sharePageGooglePlus",[function(){return{controller:["$location","social",function(b,c){this.share=function(d){d=d?d:b.absUrl();c.shareGooglePlus(d)}}],restrict:"A",link:function(b,c,d,e){c.click(function(){e.share(d.url)})}}}])})();
(function(){angular.module("common.sharing").directive("sharePageTwitter",[function(){return{controller:["$location","social",function(b,c){this.share=function(d,e,f){var d=d?d:b.absUrl(),g={};if(f)g.hashTags=f;c.shareTwitter(d,e,g)}}],restrict:"A",link:function(b,c,d,e){c.click(function(){e.share(d.url,d.text,d.hashTags)})}}}])})();
(function(){angular.module("common.sharing").controller("SharePopupCtrl",["$scope","$http","$location","$window","api",function(b,c,d,e,f){b.projectId=null;b.projectName=null;b.projectScreenShot=null;b.currentTab=null;b.tabs={};b.captchaCode=null;b.captchaRandom=null;b.displayName=null;b.email=null;b.serverName=null;b.facebookAppId=null;b.stageWidth=660;b.stageHeight=408;b.shared=false;b.busy=false;b.init=function(c,e,f,k,l){b.facebookAppId=c;b.serverName=d.host();if(e=="student"){b.tabs={embed:"Embed"};
b.currentTab="email";if(k||l){b.tabs.connections="Connected to Me";b.currentTab="connections"}b.tabs.community="Community";b.currentTab="community";f&&(b.tabs.email="Email")}else{b.tabs={community:"Community",email:"Email",embed:"Embed",social:"Social"};b.currentTab="social"}};b.show=function(c,d,f){f=f?f:"https://"+b.serverName+"/play?p="+c;e.ga("send","event","Project Share Modal","Open",d);b.error="";b.success="";b.projectId=c;b.projectName=d;b.projectShareUrl=f;b.projectScreenShot="/assets/pscreenshot/"+
c+".png?f=true";b.generateCaptcha();$("#share-popup").modal()};b.hide=function(){$.modal.close()};b.reset=function(){b.error=null;b.success=null;b.email=null;b.generateCaptcha()};b.setCurrentTab=function(c){b.currentTab=c};b.emailParent=function(){e.ga("send","event","Project Share Modal","Share","Email Parent");b.busy=true;f.sendProjectEmail(b.projectId).then(function(){b.busy=false;b.error="";b.success="Shared successfully!"},function(c){b.busy=false;b.success="";b.error=c})};b.communityShare=function(){e.ga("send",
"event","Project Share Modal","Share","Community");b.busy=true;f.shareToCommunity(b.projectId).then(function(){b.busy=false;b.error="";b.success="Successfully published!";b.shared=true},function(c){b.busy=false;b.success="";b.error=c})};b.communityUnshare=function(){e.ga("send","event","Project Share Modal","Unshare","Community");b.busy=true;f.unshareFromCommunity(b.projectId).then(function(){b.busy=false;b.error="";b.success="Successfully unpublished!";b.shared=false},function(c){b.busy=false;b.success=
"";b.error=c})};b.parentShare=function(){e.ga("send","event","Project Share Modal","Share","Parent");b.busy=true;f.addToGallery(b.projectId,"home").then(function(){b.busy=false;b.error="";b.success="Shared successfully!"},function(c){b.busy=false;b.success="";b.error=c})};b.classShare=function(){e.ga("send","event","Project Share Modal","Share","Class");b.busy=true;f.addToGallery(b.projectId,"class").then(function(){b.busy=false;b.error="";b.success="Shared successfully!"},function(c){b.busy=false;
b.success="";b.error=c})};b.emailShare=function(){e.ga("send","event","Project Share Modal","Share","Email");b.busy=true;f.sendProjectEmail(b.projectId,b.displayName,b.email,b.captchaCode,b.projectShareUrl).then(function(){b.busy=false;b.success="Shared successfully!"},function(c){b.busy=false;b.error=c;b.generateCaptcha()})};b.facebookShare=function(){e.ga("send","event","Project Share Modal","Share","Facebook");shareProjectFacebook(b.projectId,{appId:b.facebookAppId,serverName:d.host(),shareUrl:b.projectShareUrl})};
b.twitterShare=function(){e.ga("send","event","Project Share Modal","Share","Twitter");shareProjectTwitter(b.projectId,b.projectName,b.projectDescription,{serverName:d.host(),shareUrl:b.projectShareUrl})};b.googlePlusShare=function(){e.ga("send","event","Project Share Modal","Share","Google+");shareProjectGooglePlus(b.projectId,{serverName:d.host(),shareUrl:b.projectShareUrl})};b.generateCaptcha=function(){b.captchaRandom="/api/captcha?r="+Math.random();b.captchaCode=null}}])})();
(function(){angular.module("common.sharing").controller("SharingCtrl",["$scope","$http","$location","api",function(b,c,d,e){b.projectId=null;b.projectName=null;b.projectScreenShot=null;b.currentTab=null;b.tabs={};b.captchaCode=null;b.captchaRandom=null;b.displayName=null;b.email=null;b.facebookAppId=null;b.stageWidth=null;b.stageHeight=null;b.busy=false;b.init=function(c,d){b.facebookAppId=c;if(d=="student"){b.tabs={community:"Community",embed:"Embed"};b.currentTab="email";if(prefs.defaultGalleryId){b.tabs.gallery=
"Showcase";b.currentTab="gallery"}if(prefs.hasClass||prefs.hasParent){b.tabs.connections="Connected to Me";b.currentTab="connections"}prefs.isAnon&&(b.tabs.email="Email")}else{b.tabs={community:"Community",email:"Email",embed:"Embed",social:"Social"};b.currentTab="social";if(prefs.defaultGalleryId){b.tabs.gallery="Showcase";b.currentTab="gallery"}}b.currentTab="community"};b.show=function(){if(!IDE.currentProjectId||!IDE.currentProjectName){var c=$("#sharing-set-title").scope();c&&c.show()}else if(IDE.isDirty){Runtime.stage.selectActor(null);
c=Runtime.stage.captureScreenshot();IDE._doProjectSave(null,null,c,true,true,function(c){c&&d.search({p:IDE.currentProjectId});b._show()})}else b._show()};b._show=function(){Runtime.stage.selectActor(null);var c=Runtime.stage.captureScreenshot();b.generateCaptcha();b.stageWidth=Runtime.stage.getWidth();b.stageHeight=Runtime.stage.getHeight();b.projectId=IDE.currentProjectId;b.projectName=IDE.currentProjectName;b.projectDescription=IDE.currentProjectDescription;b.projectScreenShot=c;$("#sharing").modal()};
b.hide=function(){$.modal.close()};b.reset=function(){b.error=null;b.success=null;b.email=null;b.generateCaptcha()};b.setCurrentTab=function(c){b.currentTab=c};b.communityShare=function(c){b.busy=true;e.shareToCommunity(b.projectId,c).then(function(){b.busy=false;b.error="";b.success2="Successfully published!";b.published=true},function(c){b.busy=false;b.success2="";b.error=c})};b.ideCommunityShare=function(){IDE.cmdProjectSubmitEntry()};b.communityUnshare=function(){b.busy=true;e.unshareFromCommunity(b.projectId).then(function(){b.busy=
false;b.error="";b.success2="Successfully unpublished!";b.published=false},function(c){b.busy=false;b.success2="";b.error=c})};b.emailParent=function(){b.busy=true;e.sendProjectEmail(b.projectId).then(function(){b.busy=false;b.error="";b.success="Shared successfully!"},function(c){b.busy=false;b.success="";b.error=c})};b.parentShare=function(){b.busy=true;e.addToGallery(b.projectId,"home").then(function(){b.busy=false;b.error="";b.success="Shared successfully!"},function(c){b.busy=false;b.success=
"";b.error=c})};b.classShare=function(){b.busy=true;e.addToGallery(b.projectId,"class").then(function(){b.busy=false;b.error="";b.success="Shared successfully!"},function(c){b.busy=false;b.success="";b.error=c})};b.defaultGalleryShare=function(){b.busy=true;e.addToGallery(b.projectId,"gallery",prefs.defaultGalleryId).then(function(){b.busy=false;b.error="";b.success="Shared successfully!"},function(c){b.busy=false;b.success="";b.error=c})};b.emailShare=function(){b.busy=true;e.sendProjectEmail(b.projectId,
b.displayName,b.email,b.captchaCode).then(function(){b.busy=false;b.success="Shared successfully!"},function(c){b.busy=false;b.error=c;b.generateCaptcha()})};b.facebookShare=function(){shareProjectFacebook(b.projectId,{appId:b.facebookAppId,serverName:d.host()})};b.twitterShare=function(){shareProjectTwitter(b.projectId,b.projectName,b.projectDescription,{serverName:d.host()})};b.googlePlusShare=function(){shareProjectGooglePlus(b.projectId,{serverName:d.host()})};b.generateCaptcha=function(){b.captchaRandom=
"/api/captcha?r="+Math.random();b.captchaCode=null}}])})();(function(){angular.module("common.sharing").controller("SharingSetTitleCtrl",["$scope","$location",function(b,c){b.show=function(){$("#sharing-set-title").modal()};b.setTitle=function(b){IDE.setTitle(b);Runtime.stage.selectActor(null);var e=Runtime.stage.captureScreenshot();IDE._doProjectSave(b,null,e,true,true,function(b){b&&c.search({p:IDE.currentProjectId});b=$("#sharing").scope();b.show();b.$apply()})}}])})();
(function(){angular.module("common").factory("social",["$location","facebookAppId",function(b,c){function d(d,e){var e=e?e:{},f=e.appId?e.appId:c,g=e.serverName?e.serverName:b.host(),f="https://www.facebook.com/dialog/share?"+$.param({app_id:f,display:"popup",href:d,redirect_uri:"http://"+g+"/api/closewindow"});window.open(f,"Share","toolbar=0,status=0,width=626,height=436")}function e(b,c,d){d=d?d:{};d=d.hashTags!==void 0?d.hashTags:"HourOfCode";b={url:b,text:c};d&&(b.hashtags=d);b="https://twitter.com/intent/tweet?"+
$.param(b);window.open(b,"Tweet","toolbar=0,status=0,width=626,height=436")}function f(b){b="https://plus.google.com/share?"+$.param({url:b});window.open(b,"Share on Google+","toolbar=0,status=0,width=626,height=436")}function g(b,c){var d="mailto:?subject="+encodeURIComponent(b)+"&body="+encodeURIComponent(c);window.open(d,"Share using e-mail","toolbar=0,status=0,width=626,height=436")}return{shareFacebook:d,shareTwitter:e,shareGooglePlus:f,shareEmail:g,shareProjectEmail:function(c,d,e,f){var f=
f?f:{},m=f.serverName?f.serverName:b.host();g(d,"\n\nTynker project made by "+e+"\n"+(f.shareUrl?f.shareUrl:"http://"+m+"/play?p="+c)+"\n")},shareProjectFacebook:function(c,e){var e=e?e:{},f=e.serverName?e.serverName:b.host();d(e.shareUrl?e.shareUrl:"http://"+f+"/play?p="+c,e)},shareProjectTwitter:function(c,d,f,g){g=g?g:{};f=g.serverName?g.serverName:b.host();g.hashTags=g.hashTags?g.hashTags:"tynker";e(g.shareUrl?g.shareUrl:"http://"+f+"/play?p="+c,"Check out "+d+" a coding project created with Tynker",
g)},shareProjectGooglePlus:function(c,d){var d=d?d:{},e=d.serverName?d.serverName:b.host();f(d.shareUrl?d.shareUrl:"http://"+e+"/play?p="+c)},shareMyHocProjectTwitter:function(c,d,f,g){g=g?g:{};g.hashTags=g.hashTags?g.hashTags:"hourofcode,tynker";g.serverName||b.host();f=g.serverName;e(g.shareUrl?g.shareUrl:"http://"+f+"/play?p="+c,"I made "+d+" using code. Try it at",g)},shareMyHocProjectEmail:function(c,d,e,f){f=f?f:{};f.serverName=f.serverName?f.serverName:b.host();e=f.serverName;g(d,"\n\nI made "+
d+" using code. Try it at "+(f.shareUrl?f.shareUrl:"http://"+e+"/play?p="+c))}}}])})();
(function(){angular.module("common").value("facebookAppId","682472498534700").factory("api",["$http","$q","$window","$timeout","resourceCache","requests",function(b,c,d,e,f,g){return{SHOP_URL:"/courses/",SUBSCRIBE_URL:"/courses/#/#pricing-plans",addImportedDistrict:function(d){return c(function(c,e){var f=new FormData;f.append("f",d);b.post("/admin/api/add-imported-district",f,{withCredentials:true,transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(b){if(b.status==
"error")e(b.error);else{b.valid||e(b.error);c(b.message)}}).error(function(b){e(b)})})},validateDistrictCsv:function(d){return c(function(c,e){var f=new FormData;f.append("f",d);b.post("/admin/api/validate-district-csv",f,{withCredentials:true,transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(b){(new FormData).append("f",d.f);b.status=="error"?e(b.error):c(b)}).error(function(b){e(b)})})},addLead:function(d){return c(function(c,e){b({method:"POST",url:"/api/leads/new",
data:$.param(d),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="error"?e(b.error):c()}).error(function(b){e(b.error)})})},addLesson:function(d,e,f){return c(function(c,g){b({method:"POST",url:"/api/addlesson",data:$.param({id:d,classid:e,lessonid:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.result?c():g()}).error(function(){g()})})},addSubscription:function(d){return c(function(c,e){b({method:"POST",url:"/forms/subscribe",
data:$.param(d),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.error?e(b.error):c(b.subscription_id)}).error(function(b){e(b.error)})})},shareToCommunity:function(d,e){return c(function(c,f){var g={c:"publish",id:d};e&&(g.t=e);b({method:"POST",url:"/api/publishproject",type:"json",data:$.param(g),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b&&b.success?c():f(b.message)}).error(function(b){f(b)})})},unshareFromCommunity:function(d){return c(function(c,
e){b({method:"POST",url:"/api/publishproject",type:"json",data:$.param({c:"unpublish",id:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b&&b.success?c():e(b.message)}).error(function(b){e(b)})})},shareAssetToCommunity:function(b,c){return g.post("/api/publishasset",{c:"publish",id:c,t:b})},unshareAssetFromCommunity:function(b,c){return g.post("/api/publishasset",{c:"unpublish",id:c,t:b})},addToGallery:function(d,e,f,g){f=f!==void 0?f:null;return c(function(c,
n){var q={pid:d,c:e};if(f)q.gid=f;g=g!==void 0?g:{};for(var p in g)q[p]=g[p];b({method:"POST",url:"/api/addtogallery",type:"json",data:$.param(q),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b?c(b):n("Already shared")}).error(function(b){n(b)})})},addUser:function(d){return c(function(c,e){b({method:"POST",url:"/api/adduser",data:$.param(d),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c(b.userId):e(b.error)}).error(function(b){e(b.error)})})},
assignProject:function(b,c,d,e){return this.saveLessonSend(c,d,[{projectid:b,name:c,message:d,screenshot:""}],[],e)},canSend:function(d,e){return c(function(c,f){b({url:"/api/cansend",method:"GET",params:{emailTemplate:d,toEmail:e}}).success(function(b){b.status=="success"?c(b.canSend):f(b.error)}).error(function(){f()})})},changeDisplayName:function(d){return c(function(c,e){b({url:"/myclasses/api/changedisplayname",method:"POST",data:$.param({nickname:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status==
"success"?c():e(b.error)}).error(function(){e()})})},changeMyPassword:function(d,e,f){console.log(d,e,f);return c(function(c,g){b({url:"/myclasses/api/changepassword",method:"POST",data:$.param({cpass:d,newpass:e,confpass:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c():g(b.error)}).error(function(){g()})})},changePassword:function(d,e,f){return c(function(c,g){b({method:"POST",url:"/api/changepasswordjson",data:$.param({id:d,reset_code:e,
password:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c():g(b.error)}).error(function(){g()})})},checkoutRedeemParent:function(){return g.get("/api/store/checkoutredeemparent",{},f)},checkoutRedeemStudent:function(){return g.get("/api/store/checkoutredeemstudent",{},f)},communityNotebooks:{list:function(d,e,f,g){var m={c:"list",page:d,limit:e,type:f},g=g!==void 0?g:{},n;for(n in g)m[n]=g[n];return c(function(c,d){b({method:"GET",url:"/api/communitynotebooks",
params:m,headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"}}).success(function(b){b?c(b):d()}).error(function(){d()})})},like:function(d){return c(function(c,e){b({method:"GET",url:"/api/communitynotebooks",params:{c:"like",cid:d,t:"xhr"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b?c(b):e()}).error(function(){e()})})},report:function(b,c){return g.get("/api/communitynotebooks",{c:"report",cid:b,desc:c,t:"xhr"})},unlike:function(d){return c(function(c,
e){b({method:"GET",url:"/api/communitynotebooks",params:{c:"unlike",cid:d,t:"xhr"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b?c(b):e()}).error(function(){e()})})}},communityProjects:{list:function(d,e,f,g){var m={c:"list",page:d,limit:e,type:f},g=g!==void 0?g:{},n;for(n in g)m[n]=g[n];return c(function(c,d){b({method:"GET",url:"/api/communityprojects",params:m,headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"}}).success(function(b){b?
c(b):d()}).error(function(){d()})})},like:function(d){return c(function(c,e){b({method:"GET",url:"/api/communityprojects",params:{c:"like",cid:d,t:"xhr"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b?c(b):e()}).error(function(){e()})})},report:function(d,e){return c(function(c,f){b({method:"GET",url:"/api/communityprojects",params:{c:"report",cid:d,desc:e,t:"xhr"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.success?c():
f(b.error)}).error(function(b){f(b.error)})})},unlike:function(d){return c(function(c,e){b({method:"GET",url:"/api/communityprojects",params:{c:"unlike",cid:d,t:"xhr"},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b?c(b):e()}).error(function(){e()})})}},deleteLesson:function(d,e,f){return c(function(c,g){b({method:"POST",url:"/api/deletelesson",data:$.param({id:d,cid:e,lessonid:f.join(",")}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.result?
c():g()}).error(function(){g()})})},deleteNotebook:function(d){return c(function(c,e){b({method:"POST",url:"/nb/api/notebooks",data:$.param({c:"delete",id:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.result?c():e()}).error(function(){e()})})},deleteProject:function(d){return c(function(c,e){b({method:"POST",url:"/api/projectdelete",data:$.param({p:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.result?c():e()}).error(function(){e()})})},
generateResetCode:function(d){return c(function(c,e){b({method:"POST",url:"/api/generateresetcode",data:$.param({email:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c({userId:b.user_id,resetEmail:b.reset_email}):e(b.error)}).error(function(){e(null)})})},getActivities:function(d,e){var d=d!==void 0?d:null,e=e!==void 0?e:null,f={};if(d)f.search=d;if(e)f.type=e;return c(function(c,d){b({method:"GET",url:"/api/getactivities",params:f}).success(function(b){c(b)}).error(function(){d()})})},
getActivity:function(d){return c(function(c,e){b({method:"GET",url:"/home/api/get-activity",params:{s:d}}).success(function(b){c(b.activity)}).error(function(){e()})})},getBadge:function(d,e){return c(function(c,f){b({method:"GET",url:"/home/api/get-badge",params:{n:d,cat:e}}).success(function(b){c(b)}).error(function(){f()})})},getBadgesByType:function(d){return c(function(c,e){b({method:"GET",url:"/home/api/get-badges-by-type",params:{cat:d}}).success(function(b){c(b.badges_by_type)}).error(function(b,
c){e(c)})})},getBundle:function(d){return c(function(c,e){b({method:"GET",url:"/home/api/get-bundle",params:{s:d}}).success(function(b){c(b.bundle)}).error(function(){e()})})},getChildDisplayName:function(d){return c(function(c,e){b({method:"GET",url:"/api/getchilddisplayname",params:{cid:d}}).success(function(b){c(b.child_display_name)}).error(function(){e()})})},getSchoolBundle:function(d){return c(function(c,e){b({method:"GET",url:"/school/api/get-bundle",params:{s:d}}).success(function(b){c(b.bundle)}).error(function(){e()})})},
getClassLesson:function(d,e,f){return c(function(c,g){b({method:"GET",url:"/myclasses/api/getclasslesson",params:{id:d,lessonid:e,chapterid:f}}).success(function(b){b.lesson||g();c(b.lesson)}).error(function(){g()})})},getClassLessons:function(d){return c(function(c,e){b({method:"GET",url:"/myclasses/api/getclasslessons",params:{id:d}}).success(function(b){c(b)}).error(function(){e()})})},getClassName:function(d){return c(function(c,e){b({method:"GET",url:"/myclasses/api/getclassname",params:{id:d}}).success(function(b){c(b.classname)}).error(function(){e()})})},
getIsExternal:function(d){return c(function(c,e){b({method:"GET",url:"/myclasses/api/getisexternal",params:{id:d}}).success(function(b){c(b.isExternal)}).error(function(){e()})})},getCourses:function(d,e,f){return c(function(c,g){b({method:"GET",url:"/api/getcourses",params:{category:d,page:e,limit:f}}).success(function(b){c(b)}).error(function(){g()})})},getCourse:function(d,e){var e=e!==void 0?e:null,f={s:d};if(e)f.cid=e;return c(function(c,d){b({method:"GET",url:"/home/api/get-course",params:f}).success(function(b){c(b.course)}).error(function(){d()})})},
getRequiredPlanForCourse:function(d){var e={courseSlug:d};return c(function(c,d){b({method:"GET",url:"/home/api/get-required-plan-for-course",params:e}).success(function(b){c(b.requiredPlan)}).error(function(){d()})})},getDistrictClasses:function(d,e,f,g){return c(function(c,n){b({method:"GET",url:"/admin/api/get-district-classes?"+$.param({limit:g,page:f,search:d,sort:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="error"?n(b.status):c({district_classes:b.district_classes,
total:b.total})}).error(function(b,c){n(c)})})},getNotebookTemplates:function(d){d=d!==void 0?d:"default";return c(function(c,e){b({method:"GET",url:"/nb/api/notebooktemplates",params:{id:d},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){c(b)}).error(function(){e("Problem retrieving notebook templates")})})},getProjectInfo:function(d){return c(function(c,e){b({method:"POST",url:"/api/projectinfo",data:$.param({p:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.error?
e(b.error):c(b)}).error(function(){e("Problem loading project info")})})},getProjectTemplates:function(d){d=d!==void 0?d:"default";return c(function(c,e){b({method:"GET",url:"api/templates.aspx",params:{id:d},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){c(b)}).error(function(){e("Problem retrieving project templates")})})},getSchoolClasses:function(){return c(function(c,d){b({method:"GET",url:"/myclasses/admin/api/get-school-classes",data:$.param({})}).success(function(b){b.status==
"error"?d(b.status):c(b.school_classes)}).error(function(b,c){d(c)})})},getTeacherAccountType:function(){return c(function(c,d){b({method:"GET",url:"/myclasses/api/getteacheraccounttype"}).success(function(b){c(b.teacherAccountType)}).error(function(){d()})})},getTrainingVideos:function(d){return c(function(c,e){b({method:"GET",url:"/api/dashboard/trainingvideos",params:{section:d}}).success(function(b){c(b)}).error(function(){e()})})},getDistrictSchools:function(){return c(function(c,d){b({method:"GET",
url:"/admin/api/get-district-schools",data:$.param({})}).success(function(b){b.status=="error"?d(b.status):c(b.district_schools)}).error(function(b,c){d(c)})})},getDistrictStudents:function(d,e,f,g){return c(function(c,n){b({method:"GET",url:"/admin/api/get-district-students?"+$.param({limit:g,page:f,search:d,sort:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="error"?n(b.status):c({district_students:b.district_students,total:b.total})}).error(function(b,
c){n(c)})})},checkoutPayment:function(){return c(function(c,d){b({method:"GET",url:"/api/store/checkoutpayment",data:$.param({}),cache:f}).success(function(b){b.status=="error"?d(b.status):c(b)}).error(function(b,c){d(c)})})},getSchoolStudents:function(){return c(function(c,d){b({method:"GET",url:"/myclasses/admin/api/get-school-students",data:$.param({})}).success(function(b){b.status=="error"?d(b.status):c(b.school_students)}).error(function(b,c){d(c)})})},getDistrictTeachers:function(){return c(function(c,
d){b({method:"GET",url:"/admin/api/get-district-teachers",data:$.param({})}).success(function(b){b.status=="error"?d(b.status):c(b.district_teachers)}).error(function(b,c){d(c)})})},getProjectActivities:function(d,e,f){return c(function(c,g){b({method:"GET",url:"/api/hour-of-code/getprojectactivities",params:{cat:d,limit:e,skip:f},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){if(b.status=="success"){b.project_activities||c([]);c(b.project_activities)}else g(b)}).error(function(b){g(b)})})},
getSchoolTeachers:function(){return c(function(c,d){b({method:"GET",url:"/myclasses/admin/api/get-school-teachers",data:$.param({})}).success(function(b){b.status=="error"?d(b.status):c(b.school_teachers)}).error(function(b,c){d(c)})})},getDontShowAgain:function(d){return c(function(c,e){b({method:"GET",url:"/api/dontshowagain?name="+d}).success(function(b){c(b.value)}).error(function(){e()})})},getExploreCategories:function(){return c(function(c,d){b({method:"GET",url:"/api/getexplorecategories"}).success(function(b){c(b.categories)}).error(function(){d()})})},
getClassGallery:function(d){return c(function(c,e){b({method:"GET",url:"/api/getclassgallery?id="+d}).success(function(b){c(b)}).error(function(){e()})})},getGalleryProjects:function(d,e,f,g,m){var e=e!==void 0?e:null,f=f!==void 0?f:null,g=g!==void 0?g:null,m=m!==void 0?m:null,n={id:d};if(e)n.query=e;if(f)n.sort=f;if(g)n.skip=g;if(m)n.limit=m;return c(function(c,d){b({method:"GET",url:"/api/getgalleryprojects?"+$.param(n)}).success(function(b){c(b)}).error(function(){d()})})},getHomeGalleryInfo:function(){return c(function(c,
d){b({method:"GET",url:"/api/gethomegalleryinfo"}).success(function(b){b.status=="error"?d(b.error):c(b.gallery)}).error(function(){d()})})},getLessonPlan:function(d){return c(function(c,e){b({method:"GET",url:"/myclasses/api/getlessonplan",params:{courseid:d}}).success(function(b){c(b.lessons)}).error(function(){e()})})},getLicense:function(d){return c(function(c,e){b({method:"GET",url:"/api/getlicense",params:{licenseid:d}}).success(function(b){b.error?e(b.error):c(b.license)}).error(function(){e()})})},
globalFeedback:function(d,e,f,g){return c(function(c,n){b({method:"POST",url:"/api/globalfeedback",data:$.param({e:d,s:e,m:f,c:g}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(){c()}).error(function(){n()})})},joinClass:function(d){return c(function(c,e){b({method:"POST",url:"/api/dashboard/student/joinclass",data:$.param({groupCode:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.error?e(b.error):c()}).error(function(){e()})})},
redirectExperienceTop:function(b,c){e(function(){var e="/api/redirectexperiencetop?next="+d.encodeURIComponent(b);c&&(e=e+("&experienceTop="+d.encodeURIComponent(c)));d.location=e})},getAddUserFlash:function(){return g.get("/api/getadduserflash")},getTeacherGuideByChapterId:function(d){return c(function(c,e){b({method:"GET",url:"/api/teacher-guides/get-teacher-guide-by-chapter-id?chapterid="+d}).success(function(b){c(b.teacher_guide)}).error(function(){e()})})},getUserBadges:function(d,e,f,g){return c(function(c,
n){b({method:"GET",url:"/home/api/get-user-badges",params:{cat:d,m:e,me:f,ml:g}}).success(function(b){c(b.badges)}).error(function(){n()})})},getMyEmail:function(){return c(function(c,d){b({method:"GET",url:"/api/getmyemail"}).success(function(b){b.error&&d(b.error);c(b.email)}).error(function(){d()})})},getMyParentEmail:function(){return c(function(c,d){b({method:"GET",url:"/api/getmyparentemail"}).success(function(b){b.error&&d(b.error);c(b.email)}).error(function(){d()})})},getPlans:function(){return c(function(c,
d){b({method:"GET",url:"/api/getsubscriptionplans"}).success(function(b){b.error&&d(b.error);c(b.subscription_plans)}).error(function(){d()})})},getDiscounts:function(){return c(function(c,d){b({method:"GET",url:"/api/getdiscounts"}).success(function(b){b.error&&d(b.error);c(b)}).error(function(){d()})})},importCourse:function(d,e,f,g){return c(function(c,n){b({method:"POST",url:"/api/importcourse",data:$.param({assetid:e,classid:d,licenseid:f,voucher_licenseid:g}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status==
"success"?c(b):n(b.error)}).error(function(){n("Problem importing courses")})})},likeProject:function(d){return c(function(c,e){b({method:"POST",url:"/api/likeproject",data:$.param({id:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.result==false&&e(b.error);b.status=="error"&&e(b.error);c()}).error(function(){e("Could not like project. Please try again.")})})},unlikeProject:function(d){return c(function(c,e){b({method:"POST",url:"/api/unlikeproject",data:$.param({id:d}),
headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.result==false&&e(b.error);b.status=="error"&&e(b.error);c()}).error(function(){e("Could not like project. Please try again.")})})},likeProjectActivity:function(d){return c(function(c,e){b({method:"GET",url:"/hour-of-code/api/likeprojectactivity",params:{id:d},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c():e(b)}).error(function(b){e(b)})})},unlikeProjectActivity:function(d){return c(function(c,
e){b({method:"GET",url:"/hour-of-code/api/unlikeprojectactivity",params:{id:d},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c():e(b)}).error(function(b){e(b)})})},updateParent:function(d,e,f){return c(function(c,g){b({method:"GET",url:"/api/updateparent",params:{child_username:d,child_password:e,parentid:f},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c(b.childid):g(b.error)}).error(function(b){g(b)})})},
login:function(d,e){return c(function(c,f){b({method:"POST",url:"/api/login",data:$.param({u:d,p:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c(b.userinfo):f(b.error)}).error(function(){f("Could not log-in, please try again")})})},logMessage:function(d){return c(function(c,e){b({method:"POST",url:"/myclasses/api/logMessage",data:$.param({message:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status==
"success"?c():e(b.error)}).error(function(){e("Could not log message, please try again")})})},mobileExplore:function(d,e,f,g){g=g!==void 0?g:null;return c(function(c,n){b({method:"POST",url:"/api/mobileexplore",params:{cat:d,page:e,limit:f,templates:g}}).success(function(b){c(b)}).error(function(){n()})})},mobileChildList:function(){return c(function(c,d){b({method:"POST",url:"/api/mobilechildlist"}).success(function(b){c(b)}).error(function(){d()})})},mobileClassList:function(d){d=d!==void 0?d:null;
return c(function(c,e){var f={};if(d)f.id=d;b({method:"POST",url:"/api/mobileclasslist",params:f}).success(function(b){c(b)}).error(function(){e()})})},mobileFavoriteList:function(d,e,f,g,m){return c(function(c,q){var p={page:f,limit:g};d&&(p.id=d);e&&(p.cid=e);m&&(p.q=m);b({method:"POST",url:"/api/mobilefavoritelist",params:p}).success(function(b){c({list:b.list,current:b.current,total:b.total,username:b.username})}).error(function(b){q(b)})})},mobileProjectList:function(d,e,f,g,m,n,q,p){return c(function(c,
r){var o={page:f,limit:g};d&&(o.id=d);e&&(o.cid=e);m&&(o.q=m);n&&(o.t=n);q!=null&&(o.pub=q?"1":"0");p=p!==void 0?p:{};for(var t in p)o[t]=p[t];b({method:"POST",url:"/api/mobileprojectlist",params:o}).success(function(b){c(b)}).error(function(b){r(b)})})},modalShare:function(b,c){return g.get("/api/components/modalshare",{assetId:b,assetType:c!==void 0?c:"project"})},moveClass:function(d,e){return c(function(c,f){b({method:"POST",url:"/myclasses/admin/api/move-class",data:$.param({id:d,classid:e}),
headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.error&&f(b.error);c(b.message)}).error(function(){f()})})},orderLessons:function(b,d){return c(function(c,e){$.ajax({url:"/api/orderlessons",type:"POST",data:{classid:b,lessonids:JSON.stringify(d)},success:function(b){c(b)},error:function(){e()}})})},payOrder:function(d,e){return c(function(c,f){b({method:"POST",url:"/api/orders/pay",data:$.param({method:d,options:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status==
"error"&&f(b.error);c(b.order)}).error(function(){f()})})},rateActivity:function(d,e,f){return c(function(c,g){b({method:"POST",url:"/api/activityrate",data:$.param({activityType:d,activityId:e,rating:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.error?g(b.error):c()}).error(function(b){g(b)})})},removeFromGallery:function(d,e,f,g){return c(function(c,n){b({method:"POST",url:"/api/removefromgallery",data:$.param({c:d,classid:e,pid:f,gid:g}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.error?
n(b.error):c()}).error(function(b){n(b)})})},removeSchool:function(d){return c(function(c,e){b({method:"POST",url:"/admin/api/remove-school",data:$.param({id:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.error?e(b.error):c()}).error(function(b){e(b)})})},removeLesson:function(d,e,f){return c(function(c,g){b({method:"POST",url:"/api/removelesson",data:$.param({id:d,classid:e,lessonid:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.result?
c():b.error?g(b.error):g()}).error(function(){g()})})},removeTeacher:function(d){return c(function(c,e){b({method:"POST",url:"/myclasses/admin/api/remove-teacher",data:$.param({id:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.error?e(b.error):c()}).error(function(b){e(b)})})},reportProject:function(d){return c(function(c,e){b({method:"POST",url:"/api/reportproject",data:$.param({pid:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.error?
e(b.error):c()}).error(function(b){e(b)})})},resendParentVerificationEmail:function(b,c,d,e){var d=d!==void 0?d:null,e=e!==void 0?e:null,f={};if(b)f.userId=b;if(d)f.fname=d;if(e)f.parentName=e;if(c)f.parentEmail=c;return g.post("/api/resendparentverificationemail",f)},resendVerificationEmail:function(d,e){var f={id:d,email:e};return c(function(c,d){b({method:"POST",url:"/api/resendverificationemail",data:$.param(f),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status==
"success"?c():d(b.error)}).error(function(){d("Could not resend, please check and try again")})})},addLessonAssign:function(d,e,f){var g={c:"assign",lessonid:d,classid:e,courseid:f!==void 0?f:null};return c(function(c,d){b({method:"POST",url:"/api/addlesson-assign",data:$.param(g),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){if(b.status=="error")d();else{b.list&&b.list.length>0&&b.list.forEach(function(b){postAssignment(b.classid,b.chapterid,b.lessonid,b.externalid,
b.lesson_number,b.title,b.description,true)});c(b)}}).error(function(){d()})})},saveLessonAssign:function(d,e){var f={c:"assign",lessonid:d,to:e};return c(function(c,d){b({method:"POST",url:"/api/savelesson",data:$.param(f),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){if(b.error)d();else{b.list&&b.list.length>0&&b.list.forEach(function(b){postAssignment(b.classid,b.chapterid,b.lessonid,b.externalid,b.lesson_number,b.title,b.description,false)});c(b)}}).error(function(){d()})})},
saveImage:function(d,e){var f={c:"save",i:e,k:d};return c(function(c,d){b({method:"POST",url:"/api/image",data:$.param(f),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.error?d():c(b)}).error(function(){d()})})},saveLessonSend:function(d,e,f,g,m,n,q){var n=n!==void 0?n:null,q=q!==void 0?q:null,p={c:"send",name:d,desc:e,to:m,watch:JSON.stringify(f),"do":JSON.stringify(g)};n&&(p.message=n);q&&(p.tags=JSON.stringify(q));return c(function(c,d){b({method:"POST",url:"/api/savelesson",
data:$.param(p),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){if(b.error)d();else{b.list&&b.list.length>0&&b.list.forEach(function(b){postAssignment(b.classid,b.chapterid,b.lessonid,b.externalid,b.lesson_number,b.title,b.description,true)});c(b)}}).error(function(){d()})})},savePreference:function(d,e){return c(function(c,f){b({method:"POST",url:"/api/savepreference",data:$.param({name:d,value:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status==
"success"?c():f(b.error)}).error(function(){f("Could not save preference")})})},saveTurnIn:function(d,e,f,g,m){return c(function(c,q){b({method:"POST",url:"/myclasses/api/saveturnin",data:$.param({id:d,classid:e,lessonid:f,studentid:g,submissionid:m}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c():q(b.error)}).error(function(){q("Could not save turn in")})})},saveUserFile:function(d,e,f){return c(function(c,g){b({method:"POST",url:"/api/system-media/save-user-file",
data:$.param({name:d,content:e,contentType:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c(b.file_id):g(b.error)}).error(function(){g("Could not save file")})})},searchClassroom:function(d){return c(function(c,e){b.get("/api/searchclassroom",{params:{q:d}}).success(c).error(e)})},searchSchool:function(d){return c(function(c,e){b.get("/api/searchschool",{params:{q:d,i:"true"}}).success(c).error(e)})},sendMinecraftAssetEmail:function(d,e,
f,g,m,n){var q={id:d};if(e!==void 0)q.name=e;if(f!==void 0)q.email=f;if(g!==void 0)q.code=g;if(m!==void 0)q.url=m;if(n!==void 0)q.image=n;return c(function(c,d){b({method:"POST",url:"api/sendminecraftassetemail.aspx",data:$.param(q),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b=="OK"?c():d(b)}).error(function(b){d(b)})})},sendParentJoinRequest:function(d,e){return c(function(c,f){b({url:"/api/sendparentjoinrequest",method:"POST",data:$.param({courseSlug:e,parentEmail:d}),
headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c():f(b.error)}).error(function(){f()})})},sendParentPermissionRequest:function(d,e){return c(function(c,f){b({url:"/api/sendparentpermissionrequest",method:"POST",data:$.param({courseSlug:e,parentEmail:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c():f(b.error)}).error(function(){f()})})},sendParentSubscriptionRequest:function(d,e,f){return c(function(c,
g){b({url:"/api/sendparentsubscriptionrequest",method:"POST",data:$.param({courseSlug:e,parentEmail:d,requiredPlanId:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c():g(b.error)}).error(function(){g()})})},sendNotebookEmail:function(b,c,d,e,f){b={p:b};if(c!==void 0)b.name=c;if(d!==void 0)b.email=d;if(e!==void 0)b.code=e;if(f!==void 0)b.url=f;return g.post("api/sendnotebookemail.aspx",b)},sendProjectEmail:function(d,e,f,g,m){var n={p:d};
if(e!==void 0)n.name=e;if(f!==void 0)n.email=f;if(g!==void 0)n.code=g;if(m!==void 0)n.url=m;return c(function(c,d){b({method:"POST",url:"api/sendprojectemail.aspx",data:$.param(n),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b=="OK"?c():d(b)}).error(function(b){d(b)})})},setDontShowAgain:function(d,e){return c(function(c,f){b({method:"POST",url:"/api/dontshowagain",data:$.param({name:d,value:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status==
"success"?c():f(b.error)}).error(function(){f(null)})})},showCaseName:function(d,e){return c(function(c,f){b({method:"POST",url:"/home/api/showcasename",data:$.param({id:d,name:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(){c()}).error(function(){f(null)})})},showCaseDesc:function(d,e){return c(function(c,f){b({method:"POST",url:"/home/api/showcasedesc",data:$.param({id:d,desc:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(){c()}).error(function(){f(null)})})},
sylvan:{convergenceAuthenticateUser:function(d,e){return c(function(c,f){b({method:"POST",url:"/partners/sylvan/api/convergence-authenticate-user",data:$.param({u:d,p:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.convergence_authenticate_user_result&&b.convergence_authenticate_user_result.IsValidUser?c(b.convergence_authenticate_user_result):f(b.error)}).error(function(){f("Could not log-in, please try again")})})},loginCenter:function(d){return c(function(c,
e){b({method:"POST",url:"/partners/sylvan/api/login-center",params:{center_number:d},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c():e(b.error)}).error(function(){$scope.error="Could not log-in, please try again"})})}},tagProjectActivity:function(d,e){return c(function(c,f){b({method:"GET",url:"/hour-of-code/api/tagprojectactivity",params:{id:d,tag:e},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status==
"success"?c(b.tags):f(b.error)}).error(function(b){f(b.error)})})},unassignLesson:function(d,e){return c(function(c,f){b({method:"GET",url:"/api/unassignlesson?"+$.param({cid:d,lid:e})}).success(function(b){b.result?c():f()}).error(function(){f("Problem unassigning lesson")})})},updateChildPassword:function(d,e,f){return c(function(c,g){b({method:"POST",url:"/home/api/updatechildpassword",data:$.param({cid:d,p:e,cp:f}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status==
"error"?g(b.error):c()}).error(function(){g("Problem updating password")})})},updateMyParentEmail:function(d){return c(function(c,e){b({method:"POST",url:"/home/api/updatemyparentemail",data:$.param({parentEmail:d}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="error"?e(b.error):c()}).error(function(){e("Problem updating parent email")})})},updateSubscription:function(d,e){var f=$.param({id:d})+"&"+$.param(e);return c(function(c,d){b({method:"POST",
url:"/forms/subscribe",data:f,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.error?d(b.error):c(b.subscription_id)}).error(function(b){d(b)})})},updateTeacherGuideHtml:function(d,e){return c(function(c,f){b({method:"POST",url:"/api/teacher-guides/update-teacher-guide-html",data:$.param({chapterid:d,html:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="error"?f(b.error):c(b.teacher_guide)}).error(function(){f("Problem updating teacher guide")})})},
validateEmail:function(d){return c(function(c,e){b({method:"GET",url:"/api/validateemail?email="+d}).success(function(b){b.is_valid?c():e()})})},validateResetCode:function(d,e){return c(function(c,f){b({method:"POST",url:"/api/validateresetcode",data:$.param({id:d,reset_code:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c():f(b.error)}).error(function(){f()})})},validateUsername:function(d){return c(function(c,e){b({method:"GET",url:"/api/validateusername",
params:{u:d}}).success(function(b){b=="true"?c():e()})})},notebookCommunityList:function(d,e,f,g){return c(function(c,n){b({method:"POST",url:"/nb/api/notebooks",data:$.param({c:"list",page:d,limit:e,type:f,query:g}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){c({list:b.list,current:b.current,total:b.total,username:b.username})}).error(function(b){n(b)})})},verifyUsernamePassword:function(d,e){return c(function(c,f){b({method:"POST",url:"/api/verifyusernamepassword",
params:{u:d,p:e}}).success(function(b){b.status=="error"&&f(b.error);b.userId||f("Username and password do not match");c(b.userId)}).error(function(){f("Error checking username and password")})})},minecraftAssetsList:function(b,c,d,e,f){var f=f!==void 0?f:{},b={skip:b,limit:c,type:d,query:e},n;for(n in f)b[n]=f[n];return g.get("/api/dashboard/student/minecraft/assets",b)},communityAssetsList:function(b,c,d,e){return g.get("/api/dashboard/student/community/assets",{skip:b,limit:c,type:d,query:e,ignoreLikes:false,
markViewed:true})},modsCommunityList:function(d,e,f,g,m){return c(function(c,q){var p={c:"list",page:d,limit:e,type:f,query:g};m=m!==void 0?m:{};for(var s in m)p[s]=m[s];b({method:"GET",url:"/minecraft/api/communitymods",params:p,headers:{"Cache-Control":"no-cache"}}).success(function(b){c({list:b.list,current:b.current,total:b.total,username:b.username,has_server:b.has_server,has_verified_parent:b.has_verified_parent})}).error(function(b){q(b)})})},skinsCommunityList:function(d,e,f,g,m){return c(function(c,
q){var p={c:"list",page:d,limit:e,type:f,query:g};m=m!==void 0?m:{};for(var s in m)p[s]=m[s];b({method:"GET",url:"/minecraft/api/communityskins",params:p,headers:{"Cache-Control":"no-cache"}}).success(function(b){c({list:b.list,current:b.current,total:b.total,username:b.username,has_server:b.has_server,has_verified_parent:b.has_verified_parent})}).error(function(b){q(b)})})},itemsCommunityList:function(d,e,f,g,m){return c(function(c,q){var p={c:"list",page:d,limit:e,type:f,query:g};m=m!==void 0?m:
{};for(var s in m)p[s]=m[s];b({method:"GET",url:"/minecraft/api/communityitems",params:p,headers:{"Cache-Control":"no-cache"}}).success(function(b){c({list:b.list,current:b.current,total:b.total,username:b.username,has_server:b.has_server,has_verified_parent:b.has_verified_parent})}).error(function(b){q(b)})})},blocksCommunityList:function(d,e,f,g,m){return c(function(c,q){var p={c:"list",page:d,limit:e,type:f,query:g};m=m!==void 0?m:{};for(var s in m)p[s]=m[s];b({method:"GET",url:"/minecraft/api/communityblocks",
params:p,headers:{"Cache-Control":"no-cache"}}).success(function(b){c({list:b.list,current:b.current,total:b.total,username:b.username,has_server:b.has_server,has_verified_parent:b.has_verified_parent})}).error(function(b){q(b)})})},entityCommunityList:function(d,e,f,g,m){return c(function(c,q){var p={c:"list",page:d,limit:e,type:f,query:g};m=m!==void 0?m:{};for(var s in m)p[s]=m[s];b({method:"GET",url:"/minecraft/api/communityentities",params:p,headers:{"Cache-Control":"no-cache"}}).success(function(b){c({list:b.list,
current:b.current,total:b.total,username:b.username,has_server:b.has_server,has_verified_parent:b.has_verified_parent})}).error(function(b){q(b)})})},getDashboardActivityLogEntries:function(b){var c={};if(b)c.id=b;return g.get("/api/dashboard/activitylogentries",c)},getDashboardBadges:function(d,e){var f={};if(d)f.id=d;e!==void 0&&(f.showRecent=e);return c(function(c,d){b({cache:false,method:"GET",url:"/api/dashboard/badges",params:f}).success(function(b){c(b)}).error(function(b){d(b)})})},getDashboardCertificates:function(d){var e=
{};if(d)e.id=d;return c(function(c,d){b({cache:false,method:"GET",url:"/api/dashboard/certificates",params:e}).success(function(b){b.status!="success"?d(b.error):c(b)}).error(function(b){d(b)})})},getDashboardConcepts:function(d){var e={};if(d)e.id=d;return c(function(c,d){b({cache:false,method:"GET",url:"/api/dashboard/concepts",params:e}).success(function(b){b.status!="success"?d(b.error):c(b)}).error(function(b){d(b)})})},getDashboardEditProfile:function(){return c(function(c,d){b({cache:false,
method:"GET",url:"/api/dashboard/editprofile"}).success(function(b){c(b.result)}).error(function(b){d(b)})})},getLaunchpadActivities:function(){return g.get("/api/dashboard/student/launchpadactivities")},studentDashboardMarkMissionsRewardsShown:function(b){b={missionIds:b.join(";")};return g.post("/api/dashboard/student/markmissionsrewardsshown",b)},studentDashboardGetCompletedMissions:function(){return g.get("/api/dashboard/student/getcompletedmissions")},studentDashboardGetCompletedMissionsWithRewardsNotShown:function(){return g.get("/api/dashboard/student/getcompletedmissionswithrewardsnotshown")},
studentDashboardExtendSession:function(){return g.get("/api/dashboard/student/extendsession")},getStudentDashboardUserMeta:function(b,c){return g.get("/api/dashboard/student/getusermeta",{key:b,value:c})},setStudentDashboardUserMeta:function(b,c){return g.post("/api/dashboard/student/setusermeta",{key:b,value:c})},getUser:function(){return g.get("/api/user")},getStudentDashboardUser:function(){return g.get("/api/dashboard/student/user")},getStudentDashboardRewards:function(){return g.get("/api/dashboard/student/rewards")},
getStudentDashboardLaunchpad:function(){return g.get("/api/dashboard/student/launchpad")},getStudentDashboardLearn:function(){return g.get("/api/dashboard/student/learn")},getStudentDashboardClasses:function(){return c(function(c,d){b({cache:false,method:"GET",url:"/api/dashboard/student/classes"}).success(function(b){c({classes:b.classes,externalStudentId:b.externalStudentId,currentClassId:b.currentClassId})}).error(function(b){d(b)})})},getStudentDashboardClassGallery:function(d){return c(function(c,
e){b({cache:false,method:"GET",url:"/api/dashboard/student/classgallery?id="+d}).success(function(b){b.status!="success"&&e(b.error);c(b.gallery)}).error(function(b){e(b)})})},getStudentDashboardCommunityFeaturedProjects:function(d,e){return c(function(c,f){b({method:"GET",url:"/api/dashboard/student/community/featuredprojects?page="+d+"&limit="+e,headers:{"Cache-Control":"no-cache"}}).success(function(b){b.status!="success"&&f(b.error);c({list:b.list})}).error(function(b){f(b)})})},getStudentDashboardCourses:function(b,
c){var d={grouped:b!==void 0?b:false},c=c!==void 0?c:{},e;for(e in c)d[e]=c[e];return g.get("/api/dashboard/student/courses",d)},getStudentDashboardDailyMissions:function(){return c(function(c,d){b({cache:false,method:"GET",url:"/api/dashboard/student/dailymissions"}).success(function(b){c({list:b.list})}).error(function(b){d(b)})})},getStudentDashboardDiys:function(){return g.get("/api/dashboard/student/diys")},getStudentDashboardLessons:function(d){return c(function(c,e){b({cache:false,method:"GET",
url:"/api/dashboard/student/lessons?classId="+d}).success(function(b){c({list:b.list})}).error(function(b){e(b)})})},getStudentDashboardMinecraftCourses:function(){return c(function(c,d){b({cache:false,method:"GET",url:"/api/dashboard/student/minecraft/courses"}).success(function(b){c({list:b.list})}).error(function(b){d(b)})})},getStudentDashboardMinecraftServer:function(){return g.get("/api/dashboard/student/minecraft/server")},getStudentDashboardPuzzles:function(){return g.get("/api/dashboard/student/puzzles")},
getStudentDashboardProfile:function(){return g.get("/api/dashboard/student/profile")},getStudentDashboardVerificationBanner:function(){return g.get("/api/dashboard/student/verificationbanner")},getStudentDashboardGoogleApi:function(){return c(function(c,d){b({cache:false,method:"GET",url:"/api/dashboard/student/googleapi"}).success(function(b){b.status!="success"?d(b.error):c(b)}).error(function(b){d(b)})})},getStudentDashboardCourseLessons:function(d){return c(function(c,e){b({cache:false,method:"GET",
url:"/api/dashboard/student/courselessons",params:{courseid:d}}).success(function(b){b.status!="success"?e(b.error):c(b)}).error(function(b){e(b)})})},getStudentDashboardProfileWizard:function(b){return g.get("/api/dashboard/student/profilewizard",{ignoreCache:b})},getParentDashboardSubscriptions:function(b){return g.get("/api/dashboard/parent/subscriptions",{ignoreCache:b})},getParentDashboardPayments:function(b){return g.get("/api/dashboard/parent/payments",{ignoreCache:b})},getParentDashboardManageSubscriptionData:function(b){return g.get("/api/dashboard/parent/getmanagesubscriptiondata",
{subscription_id:b})},pauseSubscription:function(b){return g.post("/api/dashboard/parent/pausesubscription",{subscription_id:b})},subscriptionFeedback:function(b,c,d){return g.post("/api/dashboard/parent/subscriptionfeedback",{subscription_id:b,reason:c,comments:d})},resumeSubscription:function(b){return g.post("/api/dashboard/parent/resumesubscription",{subscription_id:b})},studentDashboardProfileUpdateUsername:function(b){return g.post("/api/dashboard/student/profile/updateusername",{username:b})},
upgradeSubscription:function(b,c){return g.post("/api/dashboard/parent/upgradesubscription",{subscription_id:b,upgrade_plan_id:c})},previewUpgradeSubscription:function(b,c){return g.post("/api/dashboard/parent/previewupgradesubscription",{subscription_id:b,upgrade_plan_id:c})},hocSendCertificate:function(d,e){return c(function(c,f){b({method:"GET",url:"/hour-of-code/api/sendcertificate",params:{ct:d,email:e,json:true},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status==
"success"?c(b):f(b.error)}).error(function(b){f(b.error)})})},hocGetStatus:function(){return c(function(c,d){b({method:"GET",url:"/hour-of-code/api/getstatus",params:{},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status=="success"?c(b):d(b.error)}).error(function(b){d(b.error)})})},hocPersonalizeCertificate:function(d){return c(function(c,e){b({method:"GET",url:"/hour-of-code/api/personalizecertificate",params:{name:d},headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){b.status==
"success"?c(b):e(b.error)}).error(function(b){e(b.error)})})}}}])})();
(function(){angular.module("common").factory("requests",["$http","$q",function(b,c){function d(d,f,g,h,j){j=j!==void 0?j:false;return c(function(c,l){var m={headers:{"Content-Type":"application/x-www-form-urlencoded"},cache:h!==void 0?h:false,method:d,url:f,params:g!==void 0?g:{}};if(d=="GET"){m["Content-Type"]="application/x-www-form-urlencoded";m.params=g!==void 0?g:{}}else if(d=="POST"){m["Content-Type"]="application/json";m.data=JSON.stringify(g!==void 0?g:{})}b(m).success(function(b){if(j)return c(b);
b.status=="success"?c(b):b.data&&b.data.status=="error"?l(b.data.error):l(b.error)}).error(function(b){l(b)})})}return{get:function(b,c,g,h){return d("GET",b,c,g,h)},post:function(b,c,g,h){return d("POST",b,c,g,h)},request:function(b,c,g,h,j){return d(b,c,g,h,j)}}}])})();(function(){angular.module("common").directive("autoFocus",["$timeout",function(b){return{restrict:"AC",link:function(c,d){b(function(){d[0].focus()},0)}}}])})();
(function(){angular.module("common").factory("avatar",[function(){return{getAll:function(){return["/image/avatar/girl-native.png","/image/avatar/girl-school.png","/image/avatar/girl-trooper.png","/image/avatar/girl-princess.png","/image/avatar/girl-witch.png","/image/avatar/boy-cowboy.png","/image/avatar/boy-prince.png","/image/avatar/boy-regular.png","/image/avatar/green-zombie.png","/image/avatar/pink-dragon.png","/image/avatar/red-troll.png","/image/avatar/codey.png"]},getLocked:function(){return["/image/avatar/blue-hawk.png",
"/image/avatar/blue-trooper.png","/image/avatar/green-dragon.png","/image/avatar/purple-troll.png","/image/avatar/knight-troll.png","/image/avatar/yellow-troll.png","/image/avatar/boy-adventurer.png","/image/avatar/boy-cop.png","/image/avatar/boy-native.png","/image/avatar/boy-ninja.png","/image/avatar/boy-pirate.png","/image/avatar/boy-superhero.png","/image/avatar/girl-adventurer.png","/image/avatar/girl-fairy.png","/image/avatar/girl-mummy.png","/image/avatar/girl-pirate.png","/image/avatar/girl-robinhood.png",
"/image/avatar/girl-superhero.png","/image/avatar/troll-ant.png","/image/avatar/troll-antbot.png","/image/avatar/troll-bat.png","/image/avatar/troll-block-head.png","/image/avatar/troll-disgust.png","/image/avatar/troll-fly-guy.png","/image/avatar/troll-flybot.png","/image/avatar/troll-happy-girl.png","/image/avatar/troll-mischief.png","/image/avatar/troll-ponytail-girl.png","/image/avatar/troll-slug.png","/image/avatar/troll-spider.png","/image/avatar/troll-spiderbot.png","/image/avatar/troll-tv-head.png"]},
getRandom:function(){var b=this.getAll(),c=Math.floor(Math.random()*12-1)+1;return b[c]},mapCharacter:function(b){return(b={"/image/avatar/girl-native.png":'{"type":"Female","parts":{"Left Arm":"native","Right Arm":"native","Left Hand":"native","Right Hand":"native","Legs":"native","Feet":"native","Chest":"native","Head":"native","Mouth":"native","Eyes":"native","Ears":"native","Hair":"native","Nose":"native","Hats":"native","Eyeware":"native","Capes":"native","Left Props":"blank","Right Props":"blank"}}',
"/image/avatar/girl-school.png":'{"type":"Female","parts":{"Left Arm":"regular","Right Arm":"regular","Left Hand":"regular","Right Hand":"regular","Legs":"regular","Feet":"regular","Chest":"regular","Head":"regular","Mouth":"regular","Eyes":"regular","Ears":"regular","Hair":"regular","Nose":"regular","Hats":"regular","Eyeware":"regular","Capes":"regular","Left Props":"blank","Right Props":"blank"}}',"/image/avatar/girl-trooper.png":'{"type":"Female","parts":{"Left Arm":"trooperred","Right Arm":"trooperred","Left Hand":"trooperred","Right Hand":"trooperred","Legs":"trooperred","Feet":"trooperred","Chest":"trooperred","Head":"trooperred","Mouth":"trooperred","Eyes":"trooperred","Ears":"trooperred","Hair":"trooperred","Nose":"trooperred","Hats":"trooperred","Eyeware":"trooperred","Capes":"trooperred","Left Props":"blank","Right Props":"blank"}}',
"/image/avatar/girl-princess.png":'{"type":"Female","parts":{"Left Arm":"valkyrie","Right Arm":"valkyrie","Left Hand":"valkyrie","Right Hand":"valkyrie","Legs":"valkyrie","Feet":"valkyrie","Chest":"valkyrie","Head":"valkyrie","Mouth":"valkyrie","Eyes":"valkyrie","Ears":"valkyrie","Hair":"valkyrie","Nose":"valkyrie","Hats":"valkyrie","Eyeware":"valkyrie","Capes":"valkyrie","Left Props":"blank","Right Props":"blank"}}',"/image/avatar/girl-witch.png":'{"type":"Female","parts":{"Left Arm":"witch","Right Arm":"witch","Left Hand":"witch","Right Hand":"witch","Legs":"witch","Feet":"witch","Chest":"witch","Head":"witch","Mouth":"witch","Eyes":"witch","Ears":"witch","Hair":"witch","Nose":"witch","Hats":"witch","Eyeware":"witch","Capes":"witch","Left Props":"blank","Right Props":"blank"}}',
"/image/avatar/boy-cowboy.png":'{"type":"Male","parts":{"Left Arm":"cowboy","Right Arm":"cowboy","Left Hand":"cowboy","Right Hand":"cowboy","Legs":"cowboy","Feet":"cowboy","Chest":"cowboy","Head":"cowboy","Mouth":"cowboy","Eyes":"cowboy","Ears":"cowboy","Hair":"cowboy","Nose":"cowboy","Beard":"cowboy","Hats":"cowboy","Eyeware":"cowboy","Capes":"cowboy","Left Props":"blank","Right Props":"blank"}}',"/image/avatar/boy-prince.png":'{"type":"Male","parts":{"Left Arm":"knight","Right Arm":"knight","Left Hand":"knight","Right Hand":"knight","Legs":"knight","Feet":"knight","Chest":"knight","Head":"knight","Mouth":"knight","Eyes":"knight","Ears":"knight","Hair":"knight","Nose":"knight","Beard":"knight","Hats":"knight","Eyeware":"knight","Capes":"knight","Left Props":"blank","Right Props":"blank"}}',
"/image/avatar/boy-regular.png":'{"type":"Male","parts":{"Left Arm":"regular","Right Arm":"regular","Left Hand":"regular","Right Hand":"regular","Legs":"regular","Feet":"regular","Chest":"regular","Head":"regular","Mouth":"regular","Eyes":"regular","Ears":"regular","Hair":"regular","Nose":"regular","Beard":"regular","Hats":"regular","Eyeware":"regular","Capes":"regular","Left Props":"blank","Right Props":"blank"}}',"/image/avatar/boy-trooper.png":'{"type":"Male","parts":{"Left Arm":"trooperred","Right Arm":"trooperred","Left Hand":"trooperred","Right Hand":"trooperred","Legs":"trooperred","Feet":"trooperred","Chest":"trooperred","Head":"trooperred","Mouth":"trooperred","Eyes":"trooperred","Ears":"trooperred","Hair":"trooperred","Nose":"trooperred","Beard":"trooperred","Hats":"trooperred","Eyeware":"trooperred","Capes":"trooperred","Left Props":"blank","Right Props":"blank"}}',
"/image/avatar/green-zombie.png":'{"type":"Male","parts":{"Left Arm":"zombie","Right Arm":"zombie","Left Hand":"zombie","Right Hand":"zombie","Legs":"zombie","Feet":"zombie","Chest":"zombie","Head":"zombie","Mouth":"zombie","Eyes":"zombie","Ears":"zombie","Hair":"zombie","Nose":"zombie","Beard":"zombie","Hats":"zombie","Eyeware":"zombie","Capes":"zombie","Left Props":"blank","Right Props":"blank"}}',"/image/avatar/pink-dragon.png":'{"type":"Quadruped","parts":{"Head":"Cute Pink","Ears Horns":"Cute Pink","Torso":"Cute Pink","Front Legs":"Cute Pink","Back Legs":"Cute Pink","Front Feet":"Cute Pink","Back Feet":"Cute Pink","Wings":"Cute Pink","Tail":"Cute Pink","Breath":"Cute Pink"}}',
"/image/avatar/red-troll.png":'{"type":"Troll","parts":{"Eyes":"Anger","Hat":"Anger","Head":"Anger","Horns":"Anger","Left Arm":"Anger","Left Leg":"Anger","Left Wing":"blank","Right Arm":"Anger","Right Leg":"Anger","Right Wing":"blank","Mouth":"Anger","Torso":"Anger"}}',"/image/avatar/codey.png":'{"type":"Troll","parts":{"Eyes":"Codey","Hat":"Codey","Head":"Codey","Horns":"Codey","Left Arm":"Codey","Left Leg":"Codey","Left Wing":"blank","Right Arm":"Codey","Right Leg":"Codey","Right Wing":"blank","Mouth":"Codey","Torso":"Codey"}}'}[b])?
JSON.parse(b):null}}}])})();(function(){angular.module("common").filter("billingInterval",function(){return function(b){return b=="year"?"annually":b+"ly"}})})();(function(){angular.module("common").directive("bind",function(){return{restrict:"A",link:function(b,c,d){b.vm[d.bind]=c}}})})();
(function(){function b(){return{ensureArray:function(b){if(Array.isArray(b))return b;return b=Object.keys(b).map(function(d){return b[d]})},shuffle:function(b){var d,e,f;for(f=b.length;f;f--){d=Math.floor(Math.random()*f);e=b[f-1];b[f-1]=b[d];b[d]=e}return b}}}angular.module("common").factory("arrayUtils",b);b.$inject=[]})();
(function(){function b(b,d,e){return{getContext:function(b){var c=b.getContext("2d");c==null&&(c=b.getContext("webgl"));return c},isImage:function(b){return b.nodeName.toLowerCase()==="img"},getImageData:function(b){return this.getContext(b).getImageData(0,0,b.width,b.height)},create:function(d,e){var h=document.createElement("canvas");h._id=b.v4();if(d!==void 0)h.width=d;if(e!==void 0)h.height=e;return h},clone:function(b,c){var c=c!==void 0?c:true,d=this.getRegion(b,0,0,b.width,b.height);if(c&&
b._id!==void 0)d._id=b._id;return d},resize:function(b,c,d){console.assert(c%1===0&&d%1===0);if(!(b.width==c&&b.height==d)){var e=this.clone(b);b.width=c;b.height=d;this.getContext(b).drawImage(e,0,0,b.width,b.height);return b}},getRegion:function(b,c,d,e,k){console.assert(c%1===0&&d%1===0&&e%1===0&&k%1===0);var l=document.createElement("canvas");l.width=e;l.height=k;this.getContext(l).drawImage(b,c,d,e,k,0,0,e,k);return l},getColorHex:function(b,c,e){if(!(c<0||c>=b.width))if(!(e<0||e>=b.height)){b=
this.getContext(b).getImageData(c,e,1,1).data;return d.rgbaToHex({r:b[0],g:b[1],b:b[2],a:b[3]})}},setColorHex:function(b,c,e,j){if(!(c<0||c>=b.width))if(!(e<0||e>=b.height)){b=this.getContext(b);j=d.hexToRgba(j);j="rgba("+j.r+", "+j.g+", "+j.b+", "+j.a/255+")";b.strokeStyle=j;b.fillStyle=j;b.fillRect(c,e,1,1)}},getPositionOfColorInCanvas:function(b,c){var d=this.getImageData(b);return e.getPositionOfColorInCanvas(d,c,b.width)},getIndexOfColorInCanvas:function(b,c){var d=this.getImageData(b);return e.getIndexOfColorInCanvas(d,
c)},getGradientCanvas:function(b,c,d){var e=document.createElement("canvas");e.width=c;e.height=d;for(var c=this.getContext(e),d=c.createLinearGradient(0,0,e.width,e.height),k=0;k<b.length;k++){var l=k/(b.length-1),m="#"+b[k].slice(0,6);d.addColorStop(l,m)}c.fillStyle=d;c.fillRect(0,0,e.width,e.height);return e},crawlPixels:function(b,c,d,j,k,l){b=this.getImageData(b);e.crawlPixels(b,c,d,j,k,l)},cropImage:function(b){var c=b.width,d=b.height,e=[],k=[],l=this.getImageData(b),m,n,q;for(n=0;n<d;n++)for(m=
0;m<c;m++){q=(n*c+m)*4;if(l.data[q+3]>0){e.push(m);k.push(n)}}e.sort(function(b,c){return b-c});k.sort(function(b,c){return b-c});d=e.length-1;c=e[d]-e[0];d=k[d]-k[0];e=this.getContext(b).getImageData(e[0],k[0],c,d);k=document.createElement("canvas");b=this.getContext(b);k.width=c;k.height=d;b.putImageData(e,0,0);return k}}}angular.module("common").factory("canvasUtils",b);b.$inject=["uuid","colorUtils","imageDataUtils"]})();
(function(){function b(){return{applyOpacity:function(b,d){var e=this.hexToRgba(b);e.a=d*255;return this.rgbaToHex(e)},getRandomColor:function(){return this.rgbaToHex({r:Math.random()*255,g:Math.random()*255,b:Math.random()*255,a:255})},getColorsDistanceHex:function(b,d){var b=this.hexToRgba(b),d=this.hexToRgba(d),e=b.r>d.r?b.r-d.r:d.r-b.r,e=e+(b.g>d.g?b.g-d.g:d.g-b.g),e=e+(b.b>d.b?b.b-d.b:d.b-b.b);return e=e+(b.a>d.a?b.a-d.a:d.a-b.a)},getColorsSimilarityHex:function(b,d){return 1-this.getColorsDistanceHex(b,
d)/1020},isColorSimilarHex:function(b,d,e){return this.getColorsSimilarityHex(b,d)>=(e!==void 0?e:1)},isTransparentHex:function(b){return this.hexToRgba(b).a==0},isTranslucentHex:function(b){return this.hexToRgba(b).a!=255},isOpaqueHex:function(b){return this.isTranslucentHex(b)===false},lighter:function(b,d){var d=d!==void 0?d:0.1,e=this.hexToRgba(b);e.r=e.r+Math.round(e.r*d);if(e.r>255)e.r=255;e.g=e.g+Math.round(e.g*d);if(e.g>255)e.g=255;e.b=e.b+Math.round(e.b*d);if(e.b>255)e.b=255;return this.rgbaToHex(e)},
darker:function(b,d){var d=d!==void 0?d:0.1,e=this.hexToRgba(b);e.r=e.r-Math.round(e.r*d);if(e.r<0)e.r=0;e.g=e.g-Math.round(e.g*d);if(e.g<0)e.g=0;e.b=e.b-Math.round(e.b*d);if(e.b<0)e.b=0;return this.rgbaToHex(e)},hexToInt:function(b,d){d!==void 0&&d||(b=b.slice(0,6));return parseInt(b,16)},rgbToHex:function(b){var d=parseInt(b.r).toString(16),e=parseInt(b.g).toString(16),b=parseInt(b.b).toString(16),d=d.length==2?d:"0"+d,e=e.length==2?e:"0"+e,b=b.length==2?b:"0"+b;return d+e+b},rgbaToHex:function(b){var d=
parseInt(b.r).toString(16),e=parseInt(b.g).toString(16),f=parseInt(b.b).toString(16),b=parseInt(b.a).toString(16),d=d.length==2?d:"0"+d,e=e.length==2?e:"0"+e,f=f.length==2?f:"0"+f,b=b.length==2?b:"0"+b;return d+e+f+b},hexToRgb:function(b){return(b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b))?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null},hexToRgba:function(b){return(b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b))?{r:parseInt(b[1],16),g:parseInt(b[2],
16),b:parseInt(b[3],16),a:parseInt(b[4],16)}:null},hueToRgb:function(b,d,e){e<0&&(e=e+1);e>1&&(e=e-1);return e<1/6?b+(d-b)*6*e:e<0.5?d:e<2/3?b+(d-b)*(2/3-e)*6:b},hexToHsl:function(b){b=this.hexToRgba(b);return this.rgbToHsl(b.r,b.g,b.b)},hslToHex:function(b){return this.rgbaToHex(this.hslToRgba(b.h,b.s,b.l))},rgbToHsl:function(b,d,e){var b=b/255,d=d/255,e=e/255,f=Math.max(b,d,e),g=Math.min(b,d,e),h,j=(f+g)/2;if(f==g)h=g=0;else{var k=f-g,g=j>0.5?k/(2-f-g):k/(f+g);switch(f){case b:h=(d-e)/k+(d<e?6:
0);break;case d:h=(e-b)/k+2;break;case e:h=(b-d)/k+4}h=h/6}return{h:h,s:g,l:j}},hslToRgba:function(b,d,e){if(d==0)e=d=b=e;else var f=e<0.5?e*(1+d):e+d-e*d,g=2*e-f,e=this.hueToRgb(g,f,b+1/3),d=this.hueToRgb(g,f,b),b=this.hueToRgb(g,f,b-1/3);return{r:e*255,g:d*255,b:b*255,a:255}},rgbToHsv:function(b,d,e){var b=b/255,d=d/255,e=e/255,f=Math.max(b,d,e),g=Math.min(b,d,e),h,j=f-g;if(f==g)h=0;else{switch(f){case b:h=(d-e)/j+(d<e?6:0);break;case d:h=(e-b)/j+2;break;case e:h=(b-d)/j+4}h=h/6}return{h:h,s:f==
0?0:j/f,v:f}},hsvToHex:function(b){return this.rgbToHex(this.hsvToRgb(b.h,b.s,b.v))+"ff"},hexToHsv:function(b){b=this.hexToRgba(b);return this.rgbToHsv(b.r,b.g,b.b)},hsvToRgb:function(b,d,e){var f,g,h,j=Math.floor(b*6),k=b*6-j,b=e*(1-d),l=e*(1-k*d),d=e*(1-(1-k)*d);switch(j%6){case 0:f=e;g=d;h=b;break;case 1:f=l;g=e;h=b;break;case 2:f=b;g=e;h=d;break;case 3:f=b;g=l;h=e;break;case 4:f=d;g=b;h=e;break;case 5:f=e;g=b;h=l}return{r:f*255,g:g*255,b:h*255}}}}angular.module("common").factory("colorUtils",
b);b.$inject=[]})();
(function(){function b(b){return{getColorHex:function(d,e,f){if(!(e<0||e>=d.width))if(!(f<0||f>=d.height)){e=(f*d.width+e)*4;d=d.data;return b.rgbaToHex({r:d[e],g:d[e+1],b:d[e+2],a:d[e+3]})}},setColorHex:function(d,e,f,g,h){if(!(e<0||e>=d.width))if(!(f<0||f>=d.height)){if(h!==void 0&&h&&this.getColorHex(d,e,f)==g)return false;e=(f*d.width+e)*4;g=b.hexToRgba(g);d=d.data;d[e]=g.r;d[e+1]=g.g;d[e+2]=g.b;d[e+3]=g.a;return true}},getPositionOfColorInCanvas:function(b,c,f){b=this.getIndexOfColorInCanvas(b,c);
if(b!=-1){b=b/4;return{x:b%f,y:b/f}}},getIndexOfColorInCanvas:function(d,e){for(var f=b.hexToRgba(e),g=d.data,h=0,j=false,h=0;h<g.length;h=h+4){var k=g[h+1],l=g[h+2],m=g[h+3];if(g[h]==f.r&&k==f.g&&l==f.b&&m==f.a){j=true;break}}if(!j){console.assert(false,"color not found");return-1}return h},crawlPixels:function(b,c,f,g,h,j,k){this._crawlPixels(b,c,f,g,h,j,k,void 0,0,{})},_crawlPixels:function(d,e,f,g,h,j,k,l,m,n){var j=j!==void 0?j:true,q=e+","+f;if(n[q]===void 0){n[q]=true;if(q=this.getColorHex(d,
e,f)){l===void 0&&(l=q);if((!j||!b.isTransparentHex(q))&&b.isColorSimilarHex(l,q,g)){k(e,f);var e={top:{position:[e,f-1],increment:1},"top-right":{position:[e+1,f-1],increment:1},right:{position:[e+1,f],increment:1},"bottom-right":{position:[e+1,f+1],increment:1},bottom:{position:[e,f+1],increment:1},"bottom-left":{position:[e-1,f+1],increment:1},left:{position:[e-1,f],increment:1},"top-left":{position:[e-1,f-1],increment:1}},p;for(p in e){var q=e[p],f=q.position,q=q.increment!==void 0?q.increment:
1,s=f[0],f=f[1];h!==void 0&&m+q>=h-1||this._crawlPixels(d,s,f,g,h,j,k,l,m+q,n)}}}}}}}angular.module("common").factory("imageDataUtils",b);b.$inject=["colorUtils"]})();(function(){angular.module("common").filter("currency",function(){return function(b){b=b/100;try{var c=b.toFixed(2)}catch(d){c=parseFloat(b)}return c=c.replace(".00","")}})})();
(function(){function b(){return{bindToController:{endsOn:"@"},controller:c,controllerAs:"vm",restrict:"E",scope:{},templateUrl:"/js/ng-app/common/countdown.directive.html"}}function c(b){function c(){g=moment.duration(g-h,"milliseconds");f.timeLeft=g.humanize()}var f=this,g=null,h=1E3;f.daysLeft=null;f.hoursLeft=null;f.init=function(){var j=Date.now(),j=parseFloat(f.endsOn)*1E3-j;g=moment.duration(j,"milliseconds");b(c,h);c()};f.minutesLeft=null;f.secondsLeft=null;f.init()}angular.module("common").directive("countdown",
b);b.$inject=[];c.$inject=["$interval","$window"]})();(function(){angular.module("common").directive("myDdslick",["$parse",function(b){return{restrict:"A",link:function(c,d,e){var f=b(e.ngModel),g=f.assign,h=true;d.ddslick({showSelectedHTML:false,onSelected:function(b){if(h)h=false;else if(f(c)!=b.selectedData.value){g(c,b.selectedData.value);c.load()}}});c.$watch(e.ngModel,function(b){var c=d.attr("id")+"-dd-placeholder";$("#"+c).ddslick("select",{id:b})})}}}])})();
(function(){angular.module("common").directive("fileRead",[function(){return{scope:{fileRead:"="},link:function(b,c){c.bind("change",function(c){b.$apply(function(){b.fileRead=c.target.files[0]})})}}}])})();
(function(){function b(){return{bindToController:{gaEventClickCategory:"=?",gaEventClickLabel:"=?",gaEventClickPostUrl:"=?",gaEventClickPostHandler:"=?"},controller:c,controllerAs:"vm",restrict:"A",scope:{},link:function(b,c){b.vm.element=c}}}function c(b,c,f,g){var h=this;h.eventsRegistered=false;h.init=function(){f.$watch("vm.element",function(){if(h.element&&!h.eventsRegistered){h.eventsRegistered=true;h.element.bind("click",function(){var c=h.gaEventClickCategory!==void 0?h.gaEventClickCategory:
"UI Element",e=h.gaEventClickLabel!==void 0?h.gaEventClickLabel:null;h.assertCategory(c);g.sendEvent(c,"Clicked",e,function(){h.gaEventClickPostUrl?b.location=h.gaEventClickPostUrl:h.gaEventClickPostHandler&&h.gaEventClickPostHandler()})})}})};h.assertCategory=function(b){console.assert(["UI Element","Activity Tile","Mission"].indexOf(b)!=-1,"unknown ga event category: "+b)};h.init()}angular.module("common").directive("gaEventClick",b);b.$inject=[];c.$inject=["$window","$timeout","$scope","googleAnalytics"]})();
(function(){function b(){return{bindToController:{gaEventModalInitialize:"=?",gaEventModalLabel:"="},controller:c,controllerAs:"vm",restrict:"A",scope:{},link:function(b,c){b.vm.element=c}}}function c(b,c){var f=this;f.registeredEvents=false;f.init=function(){f.gaEventModalInitialize=f.gaEventModalInitialize!==void 0?f.gaEventModalInitialize:true;b.$watch("vm.element",function(){f.element&&f.gaEventModalInitialize&&f._initEvents()});b.$watch("vm.gaEventModalInitialize",function(){f.gaEventModalInitialize&&
f.element&&f._initEvents()})};f._initEvents=function(){if(!f.registeredEvents){f.registeredEvents=true;var b=f.gaEventModalLabel!==void 0?f.gaEventModalLabel:null;c.sendEvent("Modal","Opened",b);angular.element("[data-close]",f.element).bind("click",function(){c.sendEvent("Modal","Closed",b)})}};f.init()}angular.module("common").directive("gaEventModal",b);b.$inject=[];c.$inject=["$scope","googleAnalytics"]})();
(function(){var b=/^\-?\d+$/;angular.module("common").directive("integer",function(){return{require:"ngModel",link:function(c,d,e,f){f.$validators.integer=function(c,d){return f.$isEmpty(c)||b.test(d)?true:false}}}})})();
(function(){function b(b,e,f){return{open:function(){return b(function(b,d){function j(e){e=f.open({controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/common/modal-feedback-form.factory.html",locals:{email:e}});e.opened.then(b);e.closed.then(d)}e.getMyEmail().then(function(b){j(b)},function(){j(null)})})}}}function c(b,c){var f=this;f.busy=false;f.email=c!==void 0?c:null;f.hasEmail=c!=null;f.error=null;f.send=function(){f.busy=true;b.globalFeedback(f.email,f.subject,f.message,f.context).then(function(){f.busy=
false;f.sent=true},function(){f.busy=false;f.error="Problem sending feedback"})}}angular.module("common").factory("modalFeedbackForm",b);b.$inject=["$q","api","modal"];c.$inject=["api","email"]})();
(function(){function b(b){return{open:function(){return b.open({controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/common/modal-plans.factory.html"})}}}function c(b,c){var f=this;f.loading=false;f.sessionCoupons=[];f.getCallout=function(b){if(b.amount_off)return"$"+c(b.amount_off)+" OFF";if(b.percent_off)return b.percent_off+"% OFF";if(b.savings_percent){f.needsDisclaimer=true;return"*Save "+b.savings_percent+"%"}return null};f.hasAnyCoupon=function(b){for(var c in b)if(f.hasCoupon(b[c]))return true;
return false};f.hasCoupon=function(b){for(var c in f.sessionCoupons)if(f.sessionCoupons[c]==b)return true;return false};f.init=function(){f.loading=true;b.getPlans().then(function(c){f.plansMap=c;f.plans=[f.plansMap["quarterly-48"],f.plansMap["yearly-96"],f.plansMap.lifetime];f.plansForSmall=[f.plansMap["yearly-96"],f.plansMap["quarterly-48"],f.plansMap.lifetime];b.getDiscounts().then(function(b){f.globalSale=b.global_sale;f.globalSaleCoupons=b.global_sale_coupons;f.globalSaleName=b.global_sale_name;
f.globalSaleDiscount=b.global_sale_discount;f.globalSaleEndDate=b.global_sale_end_date;f.globalSaleEndsOn=b.global_sale_ends_on;f.globalSaleMonthlyPrice=b.global_sale_monthly_price;f.sessionCoupons=b.session_coupons;f.loading=false})})};f.needsDisclaimer=false;f.init()}angular.module("common").factory("modalPlans",b);b.$inject=["modal"];c.$inject=["api","currencyFilter"]})();
(function(){function b(b){return{open:function(e){var e=e!==void 0?e:{},f={closeOnClick:e.closeOnClick,controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/common/modal-unlock.factory.html",locals:{close:function(){h.close()},showCloseButton:e.showCloseButton!==void 0?e.showCloseButton:true,activitiesRemaining:e.activitiesRemaining!==void 0?e.activitiesRemaining:null}},g;for(g in e)f[g]=e[g];var h=b.open(f)}}}function c(b,c,f,g){this.showPlans=function(){c();b.open()};this.showCloseButton=f;this.images=
[{url:"/image/dashboard/student/placeholder/unlock-everything.png",caption:"Access Minecraft, and all home courses with a premium plan."},{videoUrl:"//www.youtube.com/embed/m0b5rcutFpU",caption:"Minecraft Block Editor"},{videoUrl:"//www.youtube.com/embed/EzDoEFi7mP8",caption:"Minecraft Make it Rain Mod"},{videoUrl:"//www.youtube.com/embed/qYJM2ppZwKo",caption:"Tynker Minecraft Mini-Games"},{videoUrl:"//www.youtube.com/embed/YLixZnZfBEU",caption:"Glitch Manor"},{videoUrl:"//www.youtube.com/embed/GoVHUVbYw9M",
caption:"Goblin Quest"},{videoUrl:"//www.youtube.com/embed/1ztO3F-2QhA",caption:"Turing's Tower"},{url:"/image/course/school/P411-Promo-4.png",caption:"Python / JavaScript"},{url:"/image/course/school/programming-301-puzzle.jpg",caption:"Puzzles"}];this.activitiesRemaining=g}angular.module("common").factory("modalUnlock",b);b.$inject=["modal"];c.$inject=["modalPlans","close","showCloseButton","activitiesRemaining"]})();
(function(){function b(){return{bindToController:{items:"="},controller:c,controllerAs:"vm",scope:{},templateUrl:"/js/ng-app/common/modal-unlock-gallery.directive.html"}}function c(b,c){var f=this;f.videoUrl=null;f.hasVideo=false;f.init=function(){c.$watch("vm.items",function(){for(var b in f.items){var c=f.items[b];if(c.videoUrl&&c.videoUrl.indexOf("youtube.com")!=-1){var d=c.videoUrl.replace(/\/\/www.youtube.com\/embed\//,"");c.thumbnailUrl="//img.youtube.com/vi/"+d+"/0.jpg"}}if(f.items)f.item=
f.items[0]});c.$watch("vm.item",function(){if(f.item&&f.item.videoUrl){var c={autoplay:1};if(f.item.videoUrl.indexOf("youtube.com")!=-1){c.controls=1;c.rel=1;c.showinfo=1}var e=f.item.videoUrl,e=e+("?"+angular.element.param(c));f.hasVideo=true;f.videoUrl=b.trustAsResourceUrl(e)}else{f.hasVideo=false;f.videoUrl="ide/imgs/blank.png"}})};f.item=null;f.init()}angular.module("common").directive("modalUnlockGallery",b);b.$inject=[];c.$inject=["$sce","$scope"]})();
(function(){angular.module("common").directive("ngTooltipValidator",["$parse",function(b){return{restrict:"A",link:function(c,d,e){b(e.ngModel);var f=b(e.ngTooltipValidator);d.tipsy({trigger:"manual",gravity:"w"});c.$watch(e.ngModel,function(b){f(c)&&b&&f(c)(b,function(b){d.attr("title",b);d.tipsy("show")})})}}}])})();
(function(){angular.module("common").directive("openFeedbackForm",function(){return{controller:["modalFeedbackForm",function(b){this.open=function(){b.open()}}],restrict:"A",link:function(b,c,d,e){c.click(function(){e.open()})}}})})();
(function(){function b(){return{controller:c,restrict:"A",link:function(b,c,f,g){console.log(arguments);c.click(function(){var b=angular.element("#"+f.openLightbox);b.find(".slider").slick("slickGoTo",f.slide);angular.element(window).resize();b.foundation("open")})}}}function c(){}angular.module("common").directive("openLightbox",b);b.$inject=[];c.$inject=[]})();
(function(){function b(){return{controller:c,restrict:"A",link:function(b,c,f,g){c.click(function(){g.show()})}}}function c(b){this.show=function(){b.open()}}angular.module("common").directive("openModalUpgrade",b);b.$inject=[];c.$inject=["modalUnlock"]})();(function(){angular.module("common").directive("preloadResource",["resourceCache",function(b){return{link:function(c,d,e){b.put(e.preloadResource,d.html())}}}])})();
(function(){angular.module("common").factory("resourceCache",["$cacheFactory",function(b){return b("resourceCache")}])})();
(function(){angular.module("common").directive("studentActivityPreview",[function(){return{controller:["$scope","$timeout","api",function(b,c,d){b.activity=null;b.isLoading=false;b.showActivity=function(e,f){b.isLoading=true;d.getActivity(e).then(function(d){b.isLoading=false;b.isLocked=f?true:false;b.activity=d;$(".activity-preview").modal();c(function(){$.modal.resize()});$(document).one($.modal.CLOSE,function(){b.activity=null;b.$apply()})},function(){b.isLoading=false})};b.resendParentVerificationEmail=
function(){ga("send","event","Account Verification","Verification Request","U13 Account Verification Request: "+b.activity.slug);b.isLoading=true;d.resendParentVerificationEmail().then(function(){b.isLoading=false;b.sent=true},function(){b.isLoading=false})}}],restrict:"E",scope:{sent:"="},templateUrl:"/js/ng-app/common/studentActivityPreview.directive.html"}}])})();
(function(){angular.module("common").directive("studentCoursePreview",[function(){return{controller:["$scope","$timeout","api","modalPlans",function(b,c,d,e){b.course=null;b.sent=false;b.requiredPlan=null;b.addToCart=function(){ga("send","event","Student Course Popup","Link Click","Add to Cart: "+b.course.slug);window.location="/cart/api/addtocart?sku="+b.course.licenseid};b.buy=function(){ga("send","event","Student Course Popup","Link Click","Buy: "+b.course.slug);window.location="/purchase/?c=buy&licenseid="+
b.course.licenseid};b.showCourse=function(e,g){b.isLoading=true;d.getCourse(e).then(function(h){d.getRequiredPlanForCourse(e).then(function(d){b.isLoading=false;b.isSubscription=g?true:false;b.course=h;b.galleryItems=h.kid_screenshots?h.kid_screenshots:h.screenshots;b.requiredPlan=d;$(".course-preview").modal();c(function(){$.modal.resize()});$(document).one($.modal.CLOSE,function(){b.course=null;b.galleryItems=null;b.$apply()})})},function(){b.isLoading=false})};b.showCourseDetails=function(){ga("send",
"event","Student Course Popup","Button Click","Course Details: "+b.course.slug);window.location="/courses/show?s="+b.course.slug};b.showPlans=function(){ga("send","event","Course Detail Page","Link Click","Subscribe: "+b.course.slug);e.open()};b.subscribe=function(){ga("send","event","Student Course Popup","Button Click","Subscribe Now");window.location=d.SHOP_URL};b.sendParentSubscriptionRequest=function(c){ga("send","event","Student Course Popup","Button Click","Ask Parents to Enroll: "+b.course.slug);
b.isLoading=true;d.sendParentSubscriptionRequest(c,b.course.slug).then(function(){b.isLoading=false;b.sent=true},function(){b.isLoading=false})};d.getMyParentEmail().then(function(c){b.parentEmail=c})}],restrict:"E",templateUrl:"/js/ng-app/common/studentCoursePreview.directive.html"}}])})();
(function(){function b(b){return{open:function(e,f){return b.open({controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/common/modal-course-details-student.factory.html",locals:{slug:e,showRequestForm:f}})}}}function c(b,c,f,g,h,j){var k=this;k.initialized=false;k.course=null;k.init=function(){k.loading=true;c.getCourse(g).then(function(b){c.getRequiredPlanForCourse(g).then(function(c){k.course=b;k.course.points=b.kid_subgoals&&b.kid_subgoals.length>0?b.kid_subgoals:b.mini_selling_points&&b.mini_selling_points.length>
0?b.mini_selling_points:b.selling_points;k.galleryItems=[];var d=b.kid_screenshots?b.kid_screenshots:b.screenshots,e;for(e in d){var f=d[e];k.galleryItems.push({url:f.image,caption:f.caption,videoUrl:f.video})}k.requiredPlan=c;k.loading=false;k.initialized=true})})};k.loading=false;k.galleryItems=[];k.requiredPlan=null;k.showCourseDetails=function(){ga("send","event","Student Course Quick Look","Button Click","Course Details: "+k.course.slug);window.location="/courses/"+k.course.slug};k.showPlans=
function(){ga("send","event","Course Detail Page","Link Click","Subscribe: "+k.course.slug);f.open()};k.showRequestForm=h!==void 0?h:true;k.subscribeUrl=c.SUBSCRIBE_URL;k.signup=function(){b.get("joinStudent",{activitySlug:k.course.slug})?b.go("joinStudent",{activitySlug:k.course.slug}):j.open({role:"student"})};k.init()}angular.module("common").factory("modalCourseDetailsStudent",b);b.$inject=["modal"];c.$inject=["$state","api","modalPlans","slug","showRequestForm","modalJoin"]})();
(function(){function b(){return{bindToController:{endsOn:"@"},controller:c,controllerAs:"vm",restrict:"E",scope:{},templateUrl:"/js/ng-app/common/sale-countdown.directive.html"}}function c(b){function c(){g=g-h;if(g<1){f.isOver=true;b.cancel(f.promise)}else f.isOver=false}var f=this,g=null,h=1E3;f.init=function(){var j=Date.now();g=parseFloat(f.endsOn)*1E3-j;f.promise=b(c,h);c()};f.isOver=null;f.init()}angular.module("common").directive("saleCountdown",b);b.$inject=[];c.$inject=["$interval","$timeout"]})();
(function(){angular.module("common").directive("submitButton",function(){return{link:function(b,c){c.attr("class",null)},restrict:"E",templateUrl:"scripts/ng-app/common/submit-button.directive.html",scope:{busy:"=","class":"@",disabledClass:"@",enabledClass:"@",form:"=",value:"@"}}})})();
(function(){function b(b,d,e){b.autoPlay=false;b.currentIndex=null;b.hasVideo=false;b.items=[];b.slideShowPromise=null;b.slideShow=b.slideShow!==void 0?b.slideShow:true;b.videoUrl="ide/imgs/blank.png";b.iframeWidth=360;b.iframeHeight=240;b.youtubeRelated=false;b.youtubeControls=false;b.youtubeShowinfo=false;b.addToGallery=function(d,e,h,j){j=j!==void 0?j:false;b.items.push({image:d,caption:e,video:h});j&&b._select(b.items.length-1)};b.init=function(){b.reset();b.$watch("items",b.reset)};b.reset=
function(){b._select(0);b.slideShow&&b.startSlideShow()};b.select=function(e){b.slideShowPromise&&d.cancel(b.slideShowPromise);b._select(e)};b._select=function(d){b.currentIndex=d;if((d=b.items?b.items[b.currentIndex]:null)&&d.video){b.hasVideo=true;var d=d.video,g=d.indexOf("youtube.com")!=-1,h={};h.autoplay=b.autoPlay?0:1;if(g){h.controls=b.youtubeControls?0:1;h.rel=b.youtubeRelated?0:1;h.showinfo=b.youtubeShowinfo?0:1}d=d+("?"+$.param(h));b.videoUrl=e.trustAsResourceUrl(d)}else{b.hasVideo=false;
b.videoUrl="ide/imgs/blank.png"}return false};b.startSlideShow=function(){b.slideShowPromise&&d.cancel(b.slideShowPromise);if(b.items&&!(b.items.length<1))b.slideShowPromise=d(function(){b.currentIndex=b.currentIndex<b.items.length?b.currentIndex+1:0;b._select(b.currentIndex)},8E3)};b.init()}angular.module("common").directive("thumbnailGallery",function(){return{controller:["$scope","$interval","$sce",b],scope:{autoPlay:"@",items:"=",iframeWidth:"@",iframeHeight:"@",slideShow:"=?"},restrict:"E",
templateUrl:"/js/ng-app/common/thumbnailGallery.directive.html"}}).directive("thumbnailGalleryImg",function(){return{controller:["$scope","$interval","$sce",b],link:function(b,d,e){console.log(e);d.find("ng-transclude > img").each(function(d,e){b.addToGallery(e.attributes.src.nodeValue,e.attributes.caption?e.attributes.caption.nodeValue:null,e.attributes.video?e.attributes.video.nodeValue:null,e.attributes.selected!=null);e.remove()})},restrict:"E",scope:{autoPlay:"@",iframeWidth:"@",iframeHeight:"@",
slideShow:"="},templateUrl:"/js/ng-app/common/thumbnailGalleryImg.directive.html",transclude:true}})})();(function(){angular.module("common").filter("trustAsHtml",["$sce",function(b){return function(c){return b.trustAsHtml(c)}}])})();(function(){angular.module("common").directive("uniqueUsername",["api",function(b){return{require:"ngModel",link:function(c,d,e,f){f.$asyncValidators.uniqueUsername=function(c,d){return b.validateUsername(c||d)}}}}])})();
(function(){function b(){return{buildUrl:function(b,d){var e=this.buildQuery(d);return b+"?"+e},buildQuery:function(b){return jQuery.param(b)}}}angular.module("common").factory("urlHelper",b);b.$inject=[]})();(function(){angular.module("common").factory("uuid",function(){return{v4:function(){var b="",c;for(c=0;c<36;c++)b=c===14?b+"4":c===19?b+"89ab".charAt(Math.random()*4):c===8||c===13||c===18||c===23?b+"-":b+"0123456789abcdef".charAt(Math.random()*16);return b}}})})();
(function(){angular.module("common").factory("username",["$http","$q",function(b,c){return{safeUsernameIndex:0,safeUsernames:[],fetchSafeUsernames:function(){var d=c.defer();b({method:"GET",url:"/api/generateusernames",data:$.param({n:20}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){if(b.status=="success"){this.safeUsernames=b.safe_usernames;d.resolve()}else d.reject()}.bind(this)).error(function(){d.reject()});return d.promise},fetchRandom:function(){var b=
c.defer();this.safeUsernameIndex++;this.safeUsernameIndex>=this.safeUsernames.length?this.fetchSafeUsernames().then(function(){this.safeUsernameIndex=0;b.resolve(this.safeUsernames[this.safeUsernameIndex])}.bind(this)):b.resolve(this.safeUsernames[this.safeUsernameIndex]);return b.promise}}}])})();
(function(){angular.module("common").directive("wizardActions",function(){return{restrict:"E",templateUrl:"/js/ng-app/common/wizardActions.directive.html",scope:{busy:"=",hasPrevious:"=",hasNext:"=",previous:"=",next:"=",form:"="}}})})();(function(){angular.module("components",[])})();
(function(){angular.module("common").directive("codeySlider",[function(){return{controller:["$scope","$timeout",function(b,c){b.labels=[];b.values=[];b.value=null;b.index=null;b.cursorMarginLeft=null;b.cursorLeft=null;b.cursorX=null;b.draggingCursor=false;b.cursorMousedown=function(d){b.draggingCursor=true;b.lastX=d.pageX;angular.element("body").one("mouseup",function(){c(function(){b.draggingCursor=false;b.cursorMouseup()})})};b.cursorMouseup=function(){b.draggingCursor=false;var d=Math.round(b.cursorX/
100*b.values.length);c(function(){b.setIndex(d)})};b.cursorMousemove=function(d){if(b.draggingCursor){c(function(){b.deltaX=(d.pageX-b.lastX)/b.lastX;b.lastX=d.pageX;b.setCursorX(b.cursorX+b.deltaX*100)});console.log(b.cursorX)}};b.init=function(){b.index=0;angular.element("body").keyup(function(d){var e=b.index;d.keyCode==37&&e--;d.keyCode==39&&e++;c(function(){b.setIndex(e)})})};b.setCursorX=function(c){c<0&&(c=0);c>100&&(c=100);b.cursorX=c};b.setIndex=function(c){c<0&&(c=0);c>b.values.length-1&&
(c=b.values.length-1);b.value=b.values[c];b.cursorX=b.index/(b.values.length-1)*100};b.$watch("value",function(){b.index=b.values.indexOf(b.value);b.label=b.labels[b.index];b.model=b.value});b.$watch("model",function(){b.value=b.model});b.$watch("index",function(){b.cursorX=b.index/(b.values.length-1)*100});b.$watch("cursorX",function(){b.cursorLeft=b.cursorX+"%";b.cursorMarginLeft="0 0 0 "+-8*(6+b.index)+"px"});b.init()}],link:function(b,c){b.sticky&&c.find(".codey-slider").waypoint("sticky",{offset:60})},
restrict:"E",scope:{model:"=",sticky:"="},transclude:true,templateUrl:"/js/ng-app/components/codeySlider.directive.html"}}]).directive("codeySliderOption",function(){return{controller:["$scope",function(b){b.setSliderValue=function(c){b.$parent.$parent.value=c};b.$watch("$parent.$parent.value",function(c){b.selected=c==b.value})}],link:function(b,c,d){c=c.find("[ng-transclude]").find("span").text();b.$parent.$parent.values.push(b.value);b.$parent.$parent.labels.push(c);d.selected!==void 0&&d.selected!==
"false"&&b.setSliderValue(b.value)},restrict:"E",scope:{value:"@"},transclude:true,templateUrl:"/js/ng-app/components/codeySliderOption.directive.html"}})})();
(function(){angular.module("common").directive("collapsiblePanel",function(){return{controller:["$scope","$parse",function(b,c){var d=c(b.collapse),e=c(b.expand);b.collapsePanel=function(){b.collapsed=true;d(b.$parent)};b.expandPanel=function(){b.collapsed=false;e(b.$parent)};b.init=function(){b.collapsed=angular.isDefined(b.collapsed)?b.collapsed:false;b.collapseLabel=angular.isDefined(b.collapseLabel)?b.collapseLabel:"Collapse";b.expandLabel=angular.isDefined(b.expandLabel)?b.expandLabel:"Expand"};
b.init()}],transclude:true,restrict:"E",scope:{collapseIconClass:"@",collapseLabel:"@",expandLabel:"@",expandIconClass:"@",collapse:"@",collapsed:"=?",expand:"@"},templateUrl:"/js/ng-app/components/collapsiblePanel.directive.html"}})})();(function(){angular.module("common").directive("collectEmail",["collectEmail",function(b){return{restrict:"A",link:function(c,d){d.click(function(){b.open()})}}}])})();
(function(){function b(b,e){return{open:function(f){f=e.open({controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/components/collect-email-v3.factory.html",locals:{role:f!==void 0?f:"parent"}});f.opened.then(function(){b.ga("send","event","Email Collector Modal","Show");new Foundation.Equalizer(angular.element(".collect-email-v2 > .zf-row"))});f.closed.then(function(){b.ga("send","event","Email Collector Modal","Dismiss");angular.element.cookie("dismissed_email_collector_modal",true)});return f}}}
function c(b,c,f,g){var h=this;c.optimizely=c.optimizely||[];h.join=function(){f.addSubscription({email:h.email,role:h.role,strict:false,type:"email-collector-modal"}).then(function(b){h.subscriptionId=b;h.step="profile";h.error=null;c.ga("send","event","Email Collector Modal","Submit");angular.element.cookie("submitted_email_collector_modal",true,{expires:3650})},function(b){h.error=b});c.optimizely.push(["trackEvent","emailCollectorFormSubmitted"]);c.optimizely.push(["trackEvent",h.role+" EmailCollectorFormSubmitted"])};
h.role=g;h.step="join";h.steps=["join","profile","thanks"];h.subscriptionId=null;h.updateProfile=function(){f.updateSubscription(h.subscriptionId,{fname:h.fname,lname:h.lname,email:h.email,role:h.role,strict:false,type:"email-collector-modal"}).then(function(){h.error=null;h.step="thanks";c.ga("send","event","Email Collector Modal","Complete")});c.optimizely.push(["trackEvent","emailCollectorFormCompleted"]);c.optimizely.push(["trackEvent",b.role+"EmailCollectorFormCompleted"])}}angular.module("common").factory("collectEmail",
b);b.$inject=["$window","modal"];c.$inject=["$scope","$window","api","role"]})();
(function(){function b(b,d,e){var f=this;b.optimizely=b.optimizely||[];var g,h=f.mouseout!==void 0?f.mouseout!="false":true,j;if(f.timeout===void 0){g=45;j=true}else if(f.timeout==="true"){g=45;j=true}else if(f.timeout==="false")j=false;else if(f.timeout){g=f.timeout;j=true}f.canOpen=function(){var b=angular.element("meta[name=enable_collector_modal]").attr("content")=="false"?false:true,c=angular.element.cookie("dismissed_email_collector_modal")||angular.element.cookie("submitted_email_collector_modal"),
d=angular.element.modal.isActive()||angular.element("body").hasClass("is-reveal-open");return b&&!c&&!d};f.init=function(){if(f.canOpen()){f.isOpen=false;h&&angular.element(document).bind("mouseout",function(b){b=b?b:window.event;b=b.relatedTarget||b.toElement;(!b||b.nodeName==="HTML")&&f.openModal()});j&&setTimeout(function(){f.openModal()},g*1E3)}};f.onClose=function(){f.isOpen=false};f.openModal=function(){if(!f.isOpen&&f.canOpen()){f.isOpen=true;e.open(f.role).closed.then(f.onClose)}};f.init()}
angular.module("common").directive("collectEmailOnEvent",function(){return{bindToController:{role:"@",mouseout:"@?",timeout:"@?"},controller:b,controllerAs:"vm",restrict:"E"}});b.$inject=["$window","api","collectEmail"]})();
(function(){function b(b,d,e){d.optimizely=d.optimizely||[];b.subscriptionId=null;b.steps=["join","profile","thanks"];b.step="join";b.role="parent";b.join=function(){e.addSubscription({email:b.email,role:b.role,strict:false,type:"email-collector-banner"}).then(function(d){b.subscriptionId=d;b.step="profile";b.error=null;ga("send","event","Email Collector Banner","Submit")},function(d){b.error=d});d.optimizely.push(["trackEvent","emailCollectorFormSubmitted"]);d.optimizely.push(["trackEvent",b.role+
"EmailCollectorFormSubmitted"])};b.updateProfile=function(){e.updateSubscription(b.subscriptionId,{fname:b.fname,lname:b.lname,email:b.email,role:b.role,strict:false,type:"email-collector-banner"}).then(function(){b.error=null;b.step="thanks";ga("send","event","Email Collector Banner","Complete")});d.optimizely.push(["trackEvent","emailCollectorFormCompleted"]);d.optimizely.push(["trackEvent",b.role+"EmailCollectorFormCompleted"])}}angular.module("common").directive("emailCollectorBanner",function(){return{controller:["$scope",
"$window","api",b],templateUrl:"/js/ng-app/components/emailCollectorBanner.directive.html",restrict:"E",scope:{role:"@"}}})})();
(function(){angular.module("components").directive("floatingLabelText",function(){function b(b){var e=b.prev("label");b.val()!==""?e.addClass(c):e.removeClass(c)}var c="show";return{link:function(c,e,f){e.attr("placeholder",f.floatingLabelText);e.wrap('<div class="input-floating-label"></div>');e.parent().prepend("<label>"+f.floatingLabelText+"</label>");e.bind("checkval",function(){var c=$(this);b(c)}).on("keyup",function(){var c=$(this);b(c)}).on("focus",function(){$(this).prev("label").addClass("focus")}).on("blur",
function(){$(this).prev("label").removeClass("focus")});b(e)},restrict:"A"}})})();(function(){function b(){}angular.module("common").directive("loadingIndicator",function(){return{bindToController:{},controller:b,controllerAs:"vm",restrict:"E",scope:{},templateUrl:"/js/ng-app/components/loading-indicator.directive.html"}});b.$inject=[]})();
(function(){angular.module("components").factory("modal",["$compile","$controller","$http","$q","$rootScope","$timeout","$templateCache",function(b,c,d,e,f,g,h){return{open:function(j){var k=e.defer(),l=null,m=e.defer(),n=j.controller,q=j.controllerAs,p=j.templateUrl,s={};if(j.locals)for(var r in j.locals)s[r]=j.locals[r];var o={};if(j.closeOnClick!==void 0)o.closeOnClick=j.closeOnClick;if(j.closeOnEsc!==void 0)o.closeOnEsc=j.closeOnEsc;var t=j.initFoundation!==void 0?j.initFoundation:false;d.get(p,
{cache:h}).then(function(d){var e=f.$new();if(n){s.$scope=e;var h=c(n,s);q&&(e[q]=h)}var j=b(d.data)(e);g(function(){var b=$(j);l=new Foundation.Reveal(b,o);l.open();l.$element.one("closed.zf.reveal",function(){k.resolve();g(function(){var b=l.$element;l.destroy();b.remove()})});t&&l.$element.find("> *").foundation();m.resolve(l.$element)})},function(){k.reject();m.reject()});return{close:function(){l.close()},closed:k.promise,opened:m.promise}}}}])})();
(function(){function b(b,d,e){this.message=b.trustAsHtml(d);this.title=e}angular.module("components").factory("modalAlert",["$q","$window","modal",function(c,d,e){return function(d,g){g=g!==void 0?g:"Alert";return c(function(c,j){var k=e.open({controller:b,controllerAs:"vm",templateUrl:"/js/ng-app/components/modalAlert.factory.html",locals:{message:d,title:g}});k.opened.then(function(){c()},function(){j()});k.closed.then(function(){c()})})}}]);b.$inject=["$sce","message","title"]})();
(function(){function b(b,e,f){return{confirm:function(g,h){return b(function(b,d){var l=false,m={controller:c,controllerAs:"vm",templateUrl:"/js/ng-app/components/modal-confirm.factory.html",locals:{confirm:function(){l=true;n.close();b()},message:g,options:h}};h=h!==void 0?h:{};if(h.closeOnClick!==void 0)m.closeOnClick=h.closeOnClick;if(h.closeOnEsc!==void 0)m.closeOnEsc=h.closeOnEsc;var n=f.open(m);n.opened.then(function(){},function(){e.confirm(g)?b():d()});n.closed.then(function(){angular.element(".reveal-overlay").hide();
l||d()})})}}}function c(b,c,f,g){this.options=g!==void 0?g:{};this.title=this.options.title!==void 0?this.options.title:"Please Confirm";this.confirmLabel=this.options.confirmLabel!==void 0?this.options.confirmLabel:"OK";this.cancelLabel=this.options.cancelLabel!==void 0?this.options.cancelLabel:"Cancel";this.showCloseButton=this.options.showCloseButton!==void 0?this.options.showCloseButton:true;this.message=b.trustAsHtml(f);this.confirm=c}angular.module("components").factory("modalConfirm",b);b.$inject=
["$q","$window","modal"];c.$inject=["$sce","confirm","message","options"]})();
(function(){function b(b,d,e,f,g,h,j,k,l){function m(){e.location="/ide?p="+n.project.id}var n=this,l=l!=null?l:{};n.edit=m;n.embeddedShowViewCode=l.embeddedShowViewCode!=null?l.embeddedShowViewCode:null;n.enableGoToProjectPage=l.enableGoToProjectPage!==void 0?l.enableGoToProjectPage:null;n.enableEdit=l.enableEdit!==void 0?l.enableEdit:false;n.enableLike=l.enableLike!==void 0?l.enableLike:true;n.enableNavigation=l.projects&&l.projects.length>1;n.enableOpen=l.enableOpen!==void 0?l.enableOpen:true;
n.enableRemix=l.enableRemix!==void 0?l.enableRemix:true;n.enableReport=l.enableReport!==void 0?l.enableReport:true;n.project=k;n.hasPrevious=function(){return n.projects.indexOf(n.project)>0};n.hasNext=function(){return n.projects.indexOf(n.project)<n.projects.length-1};n.iframeSrc="ide/imgs/blank.png";n.iframeHeight=392;n.like=function(){n.project.userLiked||(n.project.projectActivity?f.likeProjectActivity(n.project.cid).then(function(){n.project.userLiked=true;n.project.likes=n.project.likes+1}):
f.likeProject(n.project.id).then(function(){n.project.userLiked=true;n.project.likes=n.project.likes+1}))};n.next=function(){if(n.projects){var b=n.projects.indexOf(n.project);if(n.hasNext())n.project=n.projects[b+1]}};n.openProject=function(){window.location="ide/?p="+n.project.id};n.openProjectPage=function(){window.location="/play?p="+n.project.id};n.previous=function(){if(n.projects){var b=n.projects.indexOf(n.project);if(n.hasPrevious)n.project=n.projects[b-1]}};n.projects=l.projects!=null?
l.projects:null;n.remix=function(){m()};n.report=function(){n.project.projectActivity?g.confirm('You can report projects that use bad words, contain personal information, or are rude or mean. Are you sure you want to report <strong>"'+n.project.name+'"</strong>?').opened.then(function(){f.reportProject(n.project.id).then(function(){d.$emit("projectReported",n.project);modalAlert("We will review this project based on our publishing guidelines.","Thank you for your feedback")})}):j.confirm("project",
n.project).then(function(){d.$emit("projectReported",n.project)})};n.share=function(){h(n.project.id,n.project.name)};n.showProjectConcepts=l.showProjectConcepts!=null?l.showProjectConcepts:true;n.showProjectInformation=l.showProjectInformation!=null?l.showProjectInformation:true;n.showProjectOverview=l.showProjectOverview!=null?l.showProjectOverview:true;n.unlike=function(){n.project.userLiked&&(n.project.projectActivity?f.unlikeProjectActivity(n.project.cid).then(function(){n.project.userLiked=
false;n.project.likes=n.project.likes-1}):f.unlikeProject(n.project.id).then(function(){n.project.userLiked=false;n.project.likes=n.project.likes-1}))};n.getPublisherName=function(){if(n.project.publisherName)return n.project.publisherName;var b=n.project.username,c=b.indexOf("@");return c==-1?b:b.slice(0,c)};d.$watch("vm.project.id",function(){var d={p:n.project.id};if(n.embeddedShowViewCode!==null)d.svc=n.embeddedShowViewCode;n.iframesrc="ide/embedded?"+b(d);n.showProjectInformation&&f.getProjectInfo(n.project.id).then(function(b){n.project.details=
b.details;n.project.description=!(!b.description||b.description=="Please add a description for your lesson"||b.description=="Enter your project description here")?b.description:null;if(n.showProjectConcepts&&b.concepts){var c="  ",d=0;$.each(b.concepts,function(b){c=c+(b+", ");d++});if(d>0)n.conceptsStr=c}n.project.actors=b.actors;n.project.costumer=b.costumes;n.project.lines=b.lines;n.project.scripts=b.scripts;n.project.tynkerblocks=b.tynkerblocks;n.showOverview=n.project.actors||n.project.costumes||
n.project.lines||n.project.scripts||n.project.tynkerblocks})})}angular.module("components").factory("modalPlayProject",["$q","modal",function(c,d){return function(e,f){return c(function(){d.open({controller:b,controllerAs:"vm",templateUrl:"/js/ng-app/components/modal-play-project.factory.html",locals:{project:e,options:f}})})}}]);b.$inject=["$httpParamSerializer","$scope","$window","api","modalConfirm","modalShareProject","modalReportCommunityAsset","project","options"]})();
(function(){function b(b,e,f){return function(g,h,j){return b(function(b,d){f.open({controllerAs:"vm",controller:c,templateUrl:"/js/ng-app/components/modal-share-minecraft-resource.factory.html",locals:{resourceType:g,resource:h,isAnon:false,hasClass:false,hasParent:false,role:"parent",shared:j}}).opened.then(function(){e.ga("send","event","Minecraft Share Modal","Open",g!="entity"?"mob":g);b.apply(arguments)},d)})}}function c(b,c,f,g,h,j,k,l,m,n,q,p){function s(b){b=b.trim().toLowerCase();b=b.replace(/[^a-zA-Z0-9]/g,
"-");(b=b.replace(/--+/g,"-"))||(b="default");return b}function r(){switch(o.resourceType){case "block":return"/minecraft/texture-packs/blocks/view/"+o.resource.blockid+"/"+s(o.resource.name)+"/"+o.resource.id;case "entity":return"/minecraft/texture-packs/mobs/view/"+o.resource.entityid+"/"+s(o.resource.name)+"/"+o.resource.id;case "item":return"/minecraft/texture-packs/items/view/"+o.resource.itemid+"/"+s(o.resource.name)+"/"+o.resource.id;case "skin":return"/minecraft/skins/view/"+s(o.resource.name)+
"/"+o.resource.id}}var o=this;o.assetId=n.id;o.assetName=null;o.assetTitle=n.name;o.assetType=q;o.assetImage=null;o.busy=false;o.facebookAppId=k;o.captchaCode=null;o.captchaRandom=null;o.currentTab=null;o.tabs={};o.resource=n;o.resourceType=q;o.resourceTypeDisplay=q=="entity"?"mob":q;o.shared=p!==void 0?p:false;o.communityShare=function(){g.ga("send","event","Minecraft Share Modal","Share","Community");o.busy=true;o.assetType=="mod"?h.shareToCommunity(o.assetId).then(function(){o.busy=false;o.error=
"";o.success="Successfully published!";o.shared=true;b.$emit("minecraftResource.shared",o.assetType,o.assetId)},function(b){o.busy=false;o.success="";o.error=b}):h.shareAssetToCommunity(o.assetType,o.assetId).then(function(){o.busy=false;o.error="";o.success="Successfully published!";o.shared=true;b.$emit("minecraftResource.shared",o.assetType,o.assetId)},function(b){o.busy=false;o.success="";o.error=b})};o.communityUnshare=function(){g.ga("send","event","Minecraft Share Modal","Unshare","Community");
o.busy=true;o.assetType=="mod"?h.unshareFromCommunity(o.assetId).then(function(){o.busy=false;o.error="";o.success="Successfully unpublished!";o.shared=false;b.$emit("minecraftResource.unshared",o.assetType,o.assetId)},function(b){o.busy=false;o.success="";o.error=b}):h.unshareAssetFromCommunity(o.assetType,o.assetId).then(function(){o.busy=false;o.error="";o.success="Successfully unpublished!";o.shared=false;b.$emit("minecraftResource.unshared",o.assetType,o.assetId)},function(b){o.busy=false;o.success=
"";o.error=b})};o.emailParent=function(){g.ga("send","event","Minecraft Share Modal","Share","Email Parent");o.busy=true;h.sendMinecraftAssetEmail(o.resource.id).then(function(){o.busy=false;o.error="";o.success="Shared successfully!"},function(b){o.busy=false;o.success="";o.error=b})};o.emailShare=function(){g.ga("send","event","Minecraft Share Modal","Share","Email");o.busy=true;h.sendMinecraftAssetEmail(o.assetId,o.displayName,o.email,o.captchaCode,o.resourceShareUrl,o.assetImage).then(function(){o.busy=
false;o.success="Shared successfully!"},function(b){o.busy=false;o.error=b;o.generateCaptcha()})};o.facebookShare=function(){g.ga("send","event","Minecraft Share Modal","Share","Facebook");shareFacebook(o.resourceShareUrl,{appId:o.facebookAppId,serverName:f.host()})};o.generateCaptcha=function(){o.captchaRandom="/api/captcha?r="+Math.random();o.captchaCode=null};o.googlePlusShare=function(){g.ga("send","event","Minecraft Share Modal","Share","Google+");shareGooglePlus(o.resourceShareUrl)};o.init=
function(){o.busy=true;h.modalShare().then(function(b){o.hasClass=b.hasClass;o.hasParent=b.hasParent;o.isAnon=b.isAnonymous;o.role=b.role;if(o.role=="student"&&!o.isAnon){o.tabs={community:"Community"};o.currentTab="community"}else{o.tabs={social:"Social"};o.currentTab="social"}o.busy=false});o._updateResourceImageUrl();o._updateResourceShareUrl()};o.setCurrentTab=function(b){o.currentTab=b};o.twitterShare=function(){g.ga("send","event","Minecraft Share Modal","Share","Twitter");var b=q!="entity"?
"mob":q;shareTwitter(o.resourceShareUrl,o.assetTitle,{serverName:f.host(),hashTags:"tynker,minecraft,"+b})};o.supportsPocket=function(){return o.resource.versions?o.resource.versions.indexOf("pocket")!=-1:o.version=="pocket"};o._updateResourceImageUrl=function(){var b="/minecraft/api/"+o.resourceType+"?id="+o.resource.id;o.resource.snapshotId?o.resourceImageUrl="/api/minecraft-editor/getfile?fileId="+o.resource.snapshotId:o.resourceType=="skin"?m(o.resource).then(function(b){o.resourceImageUrl=b}):
o.resourceType=="entity"?l(o.resource).then(function(b){o.resourceImageUrl=b}):o.resourceImageUrl=o.resourceType=="mod"?o.resource.screenshot?o.resource.screenshot:"/assets/pscreenshot/"+o.resource.id+".png":b};o._updateResourceShareUrl=function(){if(o.supportsPocket()){var b=o.resourceType;b=="entity"&&(b="mob");b={resourceType:b,resourceId:o.resource.resourceId,resourceAssetId:o.resource.id,resourceName:o.resource.name,version:"pocket"};o.resourceShareUrl="https://"+f.host()+j.buildUrl("/minecraft/editor/",
b)}else o.resourceShareUrl="https://"+f.host()+r()};o.init()}angular.module("components").factory("modalShareMinecraftResource",b);b.$inject=["$q","$window","modal"];c.$inject=["$rootScope","$http","$location","$window","api","urlHelper","facebookAppId","renderMinecraftEntity","renderMinecraftSkin","resource","resourceType","shared"]})();
(function(){function b(b,e){return function(f){return b(function(b,d){e.open({controllerAs:"vm",controller:c,templateUrl:"/js/ng-app/components/modal-share-notebook.factory.html",locals:{notebook:f}}).opened.then(b,d)})}}function c(b,c,f,g,h,j,k){var l=this;l.busy=false;l.captchaCode=null;l.captchaRandom=null;l.currentTab=null;l.displayName=null;l.email=null;l.hasClass=null;l.hasParent=null;l.isAnonymous=null;l.isOwner=false;l.notebook=j;l.role=null;l.serverName=null;l.stageWidth=660;l.stageHeight=
408;l.tabs={};l.communityShare=function(){f.ga("send","event","Notebook Share Modal","Share","Community");l.busy=true;g.shareAssetToCommunity("notebook",l.notebook.id).then(function(){l.busy=false;l.error="";l.success="Successfully published!";l.notebook.likes=0;l.notebook.published=true;l.notebook.views=0;b.$emit("project.published",[l.notebook.id])},function(b){l.busy=false;l.success="";l.error=b})};l.communityUnshare=function(){f.ga("send","event","Notebook Share Modal","Unshare","Community");
l.busy=true;g.unshareAssetFromCommunity("notebook",l.notebook.id).then(function(){l.busy=false;l.error="";l.success="Successfully unpublished!";l.notebook.likes=null;l.notebook.published=false;l.notebook.views=null;b.$emit("project.unpublished",[l.notebook.id])},function(b){l.busy=false;l.success="";l.error=b})};l.emailShare=function(){f.ga("send","event","Notebook Share Modal","Share","Email");l.busy=true;g.sendNotebookEmail(l.notebook.id,l.displayName,l.email,l.captchaCode,l.shareUrl).then(function(){l.busy=
false;l.error="";l.success="Shared successfully!"},function(b){l.busy=false;l.error=b;l.generateCaptcha()})};l.facebookShare=function(){f.ga("send","event","Notebook Share Modal","Share","Facebook");h.shareProjectFacebook(l.notebook.id)};l.getImageUrl=function(){return k(l.notebook)};l.googlePlusShare=function(){f.ga("send","event","Notebook Share Modal","Share","Google+");h.shareProjectGooglePlus(l.notebook.id)};l.init=function(){l.busy=true;l.error="";l.success="";g.modalShare(l.notebook.id,"notebook").then(function(b){l.notebook=
b.asset;l.hasClass=b.hasClass;l.hasParent=b.hasParent;l.isAnonymous=b.isAnonymous;l.role=b.role;l.isOwner=b.isOwner;if(l.role=="student"){l.tabs=[];if(l.isOwner){l.tabs.push({id:"community",title:"Community"});l.currentTab="community"}l.isAnonymous&&l.tabs.push({id:"email",title:"Email"});l.tabs.push({id:"embed",title:"Embed"});l.currentTab=l.tabs[0].id}else{l.tabs=[{id:"community",title:"Community"},{id:"email",title:"Email"},{id:"embed",title:"Embed"},{id:"social",title:"Social"}];l.currentTab=
"social"}l.busy=false;f.ga("send","event","Notebook Share Modal","Open",l.notebook.name)});l.serverName=c.host();l.shareUrl="https://"+l.serverName+"/nb/project/"+l.notebook.id+"/";l.generateCaptcha()};l.reset=function(){l.error=null;l.success=null;l.email=null;l.generateCaptcha()};l.setCurrentTab=function(b){l.currentTab=b};l.twitterShare=function(){f.ga("send","event","Notebook Share Modal","Share","Twitter");h.shareProjectTwitter(l.notebook.id,l.notebook.name,"")};l.generateCaptcha=function(){l.captchaRandom=
"/api/captcha?r="+Math.random();l.captchaCode=null};l.init()}angular.module("components").factory("modalShareNotebook",b);b.$inject=["$q","modal"];c.$inject=["$rootScope","$location","$window","api","social","notebook","renderNotebook"]})();
(function(){function b(b,e){return function(f,g,h){h=h!==void 0?h:false;return b(function(b,d){e.open({controllerAs:"vm",controller:c,templateUrl:"/js/ng-app/components/modal-share-project.factory.html",locals:{projectName:g,projectId:f,published:h}}).opened.then(b,d)})}}function c(b,c,f,g,h,j,k,l,m,n,q){var p=this;p.busy=false;p.captchaCode=null;p.captchaRandom=null;p.currentTab=null;p.displayName=null;p.email=null;p.hasClass=null;p.hasParent=null;p.isAnonymous=null;p.isOwner=false;p.projectId=m;
p.projectName=n;p.projectScreenShot=null;p.role=null;p.serverName=null;p.stageWidth=660;p.stageHeight=408;p.published=q!==void 0?q:false;p.tabs={};p.classShare=function(){h.ga("send","event","Project Share Modal","Share","Class");p.busy=true;j.addToGallery(p.projectId,"class",null,{resolveClass:true}).then(function(){p.busy=false;p.error="";p.success="Shared successfully!";b.$emit("project.shared.class",[p.projectId])},function(b){p.busy=false;p.success="";p.error=b})};p.communityShare=function(c){h.ga("send",
"event","Project Share Modal","Share","Community");p.busy=true;j.shareToCommunity(p.projectId,c).then(function(){p.busy=false;p.error="";p.success="Successfully published!";p.published=true;b.$emit("project.published",[p.projectId])},function(b){p.busy=false;p.success="";p.error=b})};p.communitySubmitEntry=function(){h.ga("send","event","Project Share Modal","Share","Community");p.busy=true;k.getData("summer-code-a-thon-2017").then(function(c){j.shareToCommunity(p.projectId,"system-summer-code-a-thon-2017,system-summer-code-a-thon-2017-week-"+
c.data.currentStage).then(function(){p.busy=false;p.error="";p.success="Successfully published!";p.published=true;b.$emit("project.published",[p.projectId])},function(b){p.busy=false;p.success="";p.error=b})})};p.communityUnshare=function(){h.ga("send","event","Project Share Modal","Unshare","Community");p.busy=true;j.unshareFromCommunity(p.projectId).then(function(){p.busy=false;p.error="";p.success="Successfully unpublished!";p.published=false;b.$emit("project.unpublished",[p.projectId])},function(b){p.busy=
false;p.success="";p.error=b})};p.emailParent=function(){h.ga("send","event","Project Share Modal","Share","Email Parent");p.busy=true;j.sendProjectEmail(p.projectId).then(function(){p.busy=false;p.error="";p.success="Shared successfully!"},function(b){p.busy=false;p.success="";p.error=b})};p.emailShare=function(){h.ga("send","event","Project Share Modal","Share","Email");p.busy=true;j.sendProjectEmail(p.projectId,p.displayName,p.email,p.captchaCode,p.shareUrl).then(function(){p.busy=false;p.error=
"";p.success="Shared successfully!"},function(b){p.busy=false;p.error=b;p.generateCaptcha()})};p.facebookShare=function(){h.ga("send","event","Project Share Modal","Share","Facebook");l.shareProjectFacebook(p.projectId)};p.googlePlusShare=function(){h.ga("send","event","Project Share Modal","Share","Google+");l.shareProjectGooglePlus(p.projectId)};p.init=function(){p.busy=true;j.modalShare(p.projectId).then(function(b){p.hasClass=b.hasClass;p.hasParent=b.hasParent;p.isAnonymous=b.isAnonymous;p.role=
b.role;p.isOwner=b.isOwner;if(p.role=="student"){p.tabs=[];if(p.isOwner){p.tabs.push({id:"community",title:"Community"});p.currentTab="community"}p.isOwner&&(p.hasClass||p.hasParent)&&p.tabs.push({id:"connections",title:"Connected to Me"});p.isAnonymous&&p.tabs.push({id:"email",title:"Email"});p.tabs.push({id:"embed",title:"Embed"});p.currentTab=p.tabs[0].id}else{p.tabs=[{id:"community",title:"Community"},{id:"email",title:"Email"},{id:"embed",title:"Embed"},{id:"social",title:"Social"}];p.currentTab=
"social"}p.busy=false});p.serverName=g.host();var b=b?b:"https://"+p.serverName+"/play?p="+m;h.ga("send","event","Project Share Modal","Open",n);p.error="";p.success="";p.projectId=m;p.projectName=n;p.shareUrl=b;p.projectScreenShot="/assets/pscreenshot/"+m+".png?f=true";p.generateCaptcha()};p.parentShare=function(){h.ga("send","event","Project Share Modal","Share","Parent");p.busy=true;j.addToGallery(p.projectId,"home").then(function(){p.busy=false;p.error="";p.success="Shared successfully!"},function(b){p.busy=
false;p.success="";p.error=b})};p.reset=function(){p.error=null;p.success=null;p.email=null;p.generateCaptcha()};p.setCurrentTab=function(b){p.currentTab=b};p.twitterShare=function(){h.ga("send","event","Project Share Modal","Share","Twitter");l.shareProjectTwitter(p.projectId,p.projectName,p.projectDescription)};p.generateCaptcha=function(){p.captchaRandom="/api/captcha?r="+Math.random();p.captchaCode=null};p.init()}angular.module("components").factory("modalShareProject",b);b.$inject=["$q","modal"];
c.$inject=["$rootScope","$scope","$http","$location","$window","api","hackathonApi","social","projectId","projectName","published"]})();
(function(){function b(b,d,e,f,g,h){e=e.replace("youtube.com","youtube-nocookie.com");d=e.replace("http://","//");d=d+(d.indexOf("?")>-1?"&":"?")+"autoplay=1&modestbranding=1&rel=0&showinfo=0";f!=null&&(g!=null&&h!=null)&&ga("send","event",f,g,h);this.iframeSrc=b.trustAsResourceUrl(d)}angular.module("components").factory("modalVideo",["$q","$window","modal",function(c,d,e){return{play:function(c,g,h,j){g=g!==void 0?g:"Site";c=e.open({controller:b,controllerAs:"vm",templateUrl:"/js/ng-app/components/modal-video.factory.html",
locals:{videoUrl:c,gaCategory:g,gaAction:h!==void 0?h:"Link Click",gaLabel:j!==void 0?j:"Modal: Video Play"}});c.closed.then(function(){d.ga("send","event",g,"Link Click","Close Video Modal")});return c}}}]);b.$inject=["$sce","$window","videoUrl","gaCategory","gaAction","gaLabel"]})();
(function(){function b(b){var d=this;d.play=function(){b.play(d.video,"Hour of Code Teacher Page")}}angular.module("common").directive("videoThumbnail",function(){return{bindToController:{thumb:"@",video:"@",comment:"@"},controller:b,controllerAs:"vm",replace:true,restrict:"E",templateUrl:"/js/ng-app/components/videoThumbnail.directive.html",scope:{}}});b.$inject=["modalVideo"]})();
(function(){angular.module("ide").config(["$locationProvider","$stateProvider",function(b,c){b.html5Mode({enabled:true,requireBase:false});c.state("index",{onEnter:["$timeout",function(b){b(function(){$.modal.close()})}]}).state("signIn",{data:{modalInstance:null},onEnter:["$state","$timeout","modalSignInSelectRole",function(b,c,f){var g=f.open({useRoutes:true});c(function(){b.current.data.modalInstance=g});g.closed.then(function(){b.current.name==this.name&&b.go("index")}.bind(this))}],onExit:["$state",
function(b){b.current.data.modalInstance.close()}]}).state("signInParent",{data:{modalInstance:null},onEnter:["$state","$stateParams","$timeout","$window","modalSignIn",function(b,c,f,g,h){g.ga("send","event","Sign-in Parent Modal","Open");var j=h.open({next:c.next,role:"parent",useRoutes:true});f(function(){b.current.data.modalInstance=j});j.closed.then(function(){b.current.name==this.name&&b.go("index")}.bind(this))}],onExit:["$state","$window",function(b,c){c.ga("send","event","Sign-in Parent Modal",
"Close");b.current.data.modalInstance.close()}]}).state("signInStudent",{data:{modalInstance:null},onEnter:["$state","$stateParams","$timeout","$window","modalSignIn",function(b,c,f,g,h){g.ga("send","event","Sign-in Student Modal","Open");var j=h.open({next:c.next,role:"student",useRoutes:true});f(function(){b.current.data.modalInstance=j});j.closed.then(function(){b.current.name==this.name&&b.go("index")}.bind(this))}],onExit:["$state","$window",function(b,c){c.ga("send","event","Sign-in Student Modal",
"Close");b.current.data.modalInstance.close()}]}).state("signInTeacher",{data:{modalInstance:null},onEnter:["$state","$stateParams","$timeout","$window","modalSignIn",function(b,c,f,g,h){g.ga("send","event","Sign-in Teacher Modal","Open");var j=h.open({next:c.next,role:"teacher",useRoutes:true});f(function(){b.current.data.modalInstance=j});j.closed.then(function(){b.current.name==this.name&&b.go("index")}.bind(this))}],onExit:["$state","$window",function(b,c){c.ga("send","event","Sign-in Teacher Modal",
"Close");b.current.data.modalInstance.close()}]}).state("join",{data:{modalInstance:null},url:"/join/?source",onEnter:["$state","$stateParams","$timeout","$window","modalJoin",function(b,c,f,g,h){g.ga("send","event","Sign-up Modal","Open");var j=h.open({source:c.source,useRoutes:true});f(function(){b.current.data.modalInstance=j});j.closed.then(function(){b.current.name==this.name&&b.go("index")}.bind(this))}],onExit:["$state","$window",function(b,c){c.ga("send","event","Sign-up Modal","Close");b.current.data.modalInstance.close()}]}).state("joinStudent",
{data:{modalInstance:null},onEnter:["$state","$compile","$http","$timeout","$window","modalJoinStudent",function(b,c,f,g,h,j){h.ga("send","event","Sign-up Modal","Open","Student");var k=j.open({useRoutes:true});g(function(){b.current.data.modalInstance=k});k.closed.then(function(){b.current.name==this.name&&b.go("index")}.bind(this))}],onExit:["$state","$window",function(b,c){c.ga("send","event","Sign-up Modal","Close","Student");b.current.data.modalInstance.close()}]}).state("joinTeacher",{data:{modalInstance:null},
onEnter:["$state","$timeout","$window","modalJoinTeacher",function(b,c,f,g){f.ga("send","event","Sign-up Modal","Open","Teacher");var h=g.open();c(function(){b.current.data.modalInstance=h});h.closed.then(function(){b.current.name==this.name&&b.go("index")}.bind(this))}],onExit:["$state","$window",function(b,c){c.ga("send","event","Sign-up Modal","Close","Teacher");b.current.data.modalInstance.close()}]}).state("joinParent",{data:{modalInstance:null},onEnter:["$state","$timeout","$window","modalJoinParent",
function(b,c,f,g){f.ga("send","event","Sign-up Modal","Open","Parent");var h=g.open();c(function(){b.current.data.modalInstance=h});h.closed.then(function(){b.current.name==this.name&&b.go("index")}.bind(this))}],onExit:["$state","$window",function(b,c){c.ga("send","event","Sign-up Modal","Close","Parent");b.current.data.modalInstance.close()}]}).state("joinUnlock",{data:{modalInstance:null},onEnter:["$state","$timeout","$window","modal",function(b,c,f,g){f.ga("send","event","Sign-up Modal","Open");
var h=g.open({controller:"UnlockController",controllerAs:"vm",templateUrl:"/join/index.html",locals:{}});c(function(){b.current.data.modalInstance=h})}],onExit:["$state","$window",function(b,c){c.ga("send","event","Sign-up Modal","Close");b.current.data.modalInstance.close()}]}).state("forgotPassword",{data:{modalInstance:null},onEnter:["$state","$timeout","modalForgotPassword",function(b,c,f){var g=f.open({useRoutes:true});c(function(){b.current.data.modalInstance=g});g.closed.then(function(){b.current.name==
this.name&&b.go("index")}.bind(this))}],onExit:["$state",function(b){b.current.data.modalInstance.close()}]}).state("upgradeUnlock",{data:{modalInstance:null},onEnter:["$state","$timeout","$window","modalUnlock",function(b,c,f,g){f.ga("send","event","Upgrade Modal","Open");var h=g.open({closeOnClick:false,closeOnEsc:false,showCloseButton:false});c(function(){b.current.data.modalInstance=h})}],onExit:["$state","$window",function(b,c){c.ga("send","event","Sign-up Modal","Close");b.current.data.modalInstance.close()}]})}]);
angular.element(document).bind("common.account.loggedIn",function(b,c){window.location=c?c:"/"}).bind($.modal.BEFORE_CLOSE,function(b,c){if(!$("#join-view").find(c.elm).size()>0)return true;$("#join-view").scope().$parent.state.go("index")})})();(function(){angular.module("ide.account",[])})();
(function(){angular.module("ide.account").controller("JoinCtrl",["$scope","$http","$state","$window","api","externalAuth",function(b,c,d,e,f,g){b.state=d;b.error=null;b.busy=false;b.signupUser=function(c){b.busy=true;return f.addUser(c).then(function(){b.onLoginSuccess();try{e.optimizely=e.optimizely||[];e.optimizely.push(["trackEvent",c.role+"_account_created"])}catch(d){console.log(d)}},function(c){b.busy=false;b.error=c})};b.validateUsername=function(b,d){b?b.length<6?d("Screen name must have at least 6 characters"):
c({method:"GET",url:"/api/validateusername",params:{u:b}}).success(function(b){b=="true"?d("Looking good!"):d("Sorry, that screen name is already taken.")}):d("You must provide a screen name")};b.validatePassword=function(b,c){b?b.length<6?c("Password must have at least 6 characters"):c("Ok!"):c("You must provide a password.")};b.validateEmail=function(b,d){b?b.indexOf("@")==-1?d("Doesn't look like a valid email"):c({method:"GET",url:"/api/validateemail?email="+b}).success(function(b){b.is_valid?
d("Ok"):d("Doesn't look like a valid email")}):d("You must provide a valid email address")};b.googleLogin=function(c){c=c!==void 0?c:{};c.popup=true;c.source=c.source!==void 0?c.source:"join";g.googleLogin(c).then(function(){b.onLoginSuccess()},function(c){b.error=c})};b.facebookLogin=function(c){c=c!==void 0?c:{};c.popup=true;c.source=c.source!==void 0?c.source:"join";g.facebookLogin(c).then(function(){b.onLoginSuccess()},function(c){b.error=c})};b.onLoginSuccess=function(){$(document).trigger("common.account.loggedIn")};
b.$on("$viewContentLoaded",function(){setTimeout(function(){$("#join-view > .modal").modal()},0)})}])})();
(function(){angular.module("ide.account").controller("SignInCtrl",["$scope","$http","api","externalAuth",function(b,c,d,e){b.error=null;b.user={};b.busy=false;b.login=function(){b.busy=true;d.login(b.user.u,b.user.p).then(function(){b.onLoginSuccess()},function(c){b.busy=false;b.error=c})};b.googleLogin=function(){e.googleLogin({popup:true}).then(function(){b.onLoginSuccess()},function(c){b.error=c})};b.facebookLogin=function(){e.facebookLogin({popup:true}).then(function(){b.onLoginSuccess()},function(c){b.error=
c})}}])})();
AvatarChooser={currentType:null,currentParts:null,init:function(){$.ajax({url:"api/userpref.aspx",data:{n:"user-avatar"},success:function(b){if(b){b=JSON.parse(b);b.type&&b.parts&&AvatarChooser.showAvatar(b.type,b.parts)}}});$("#win-spine").on($.modal.OPEN,function(){AvatarChooser.updateId&&window.clearInterval(AvatarChooser.updateId);AvatarChooser.poseId&&window.clearInterval(AvatarChooser.poseId);WinSpine.init();WinSpine.showCreator(function(b,c){$.modal.close();AvatarChooser.currentType=b;AvatarChooser.currentParts=
c;$.ajax({url:"api/userpref.aspx",type:"POST",data:{n:"user-avatar",v:JSON.stringify({type:b,parts:c})}});AvatarChooser.showAvatar(b,c)},AvatarChooser.currentType,AvatarChooser.currentParts);WinSpine.adjustWindow()}).on($.modal.CLOSE,function(){AvatarChooser.showAvatar(AvatarChooser.currentType,AvatarChooser.currentParts)})},showAvatar:function(b,c,d){d=(d=d&&d.length>0?d:$("a[href='#win-spine']"))&&d.length>0?d:$(".avatar-selector-current");AvatarChooser.currentType=WinSpine.currentType=b;AvatarChooser.currentParts=
WinSpine.currentParts=c;WinSpine.loadCharacter(function(){AvatarChooser.updateId&&window.clearInterval(AvatarChooser.updateId);AvatarChooser.poseId&&window.clearInterval(AvatarChooser.poseId);var c=b=="Troll"?$('<canvas width="600" height="600"></canvas>'):$('<canvas width="1000" height="1000"></canvas>'),f=c[0].getContext("2d");if(d.length>0){d.empty().append(c);AvatarChooser.updateId=window.setInterval(function(){WinSpine.updateSkeleton(f)},1E3/60);AvatarChooser.poseId=window.setInterval(function(){for(;;){var b=
WinSpine.skeletonData.animations[Math.floor(Math.random()*WinSpine.skeletonData.animations.length)].name;if(b.indexOf("Fall")<0&&b.indexOf("Back 3/4")<0){WinSpine.state.setAnimationByName(1,b,false);WinSpine.state.addAnimationByName(0,WinSpine.defaultAnimation,true,0);break}}},3E3)}})}};$(document).ready(AvatarChooser.init);
